/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(
  // If the importer is in node compatibility mode or this is not an ESM
  // file that has been converted to a CommonJS file using a Babel-
  // compatible transform (i.e. "__esModule" has not been set), then set
  // "default" to the CommonJS "module.exports" for node compatibility.
  isNodeMode || !mod || !mod.__esModule ? __defProp(target, "default", { value: mod, enumerable: true }) : target,
  mod
));
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => KeepSidianPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian9 = require("obsidian");

// src/google/keep/import.ts
var import_obsidian2 = require("obsidian");

// src/config.ts
var KEEPSIDIAN_SERVER_URL = "https://keepsidianserver-i55qr5tvea-uc.a.run.app";

// src/google/keep/note.ts
function normalizeDate(dateString) {
  if (!dateString) {
    return null;
  }
  const date = new Date(dateString);
  return isNaN(date.getTime()) ? null : date;
}
function normalizeNote(note) {
  var _a, _b;
  const normalizedNote = {
    title: ((_a = note.title) == null ? void 0 : _a.trim()) || "",
    text: ((_b = note.text) == null ? void 0 : _b.trim()) || "",
    created: normalizeDate(note.created) || null,
    updated: normalizeDate(note.updated) || null,
    archived: note.archived || false,
    trashed: note.trashed || false,
    labels: Array.isArray(note.labels) ? note.labels : [],
    blobs: Array.isArray(note.blobs) ? note.blobs : [],
    blob_urls: Array.isArray(note.blob_urls) ? note.blob_urls : [],
    blob_names: Array.isArray(note.blob_names) ? note.blob_names : [],
    media: Array.isArray(note.media) ? note.media : [],
    header: note.header || "",
    body: "",
    frontmatter: "",
    frontmatterDict: {}
  };
  const [frontmatter, body, frontmatterDict] = extractFrontmatter(note.text || "");
  normalizedNote.frontmatter = frontmatter;
  normalizedNote.body = body;
  normalizedNote.frontmatterDict = frontmatterDict;
  return normalizedNote;
}
function extractFrontmatter(text) {
  let body = text;
  let frontmatter = "";
  let frontmatterDict = {};
  const splitText = text == null ? void 0 : text.split("---");
  if (splitText && splitText.length > 2) {
    frontmatter = splitText[1].trim();
    body = splitText[2].trim();
  }
  const frontmatter_parts = frontmatter == null ? void 0 : frontmatter.split("\n");
  if (frontmatter) {
    frontmatterDict = frontmatter_parts.reduce((acc, item) => {
      const [key, value] = item.split(": ");
      if (key && value) {
        const pascalKey = key.replace(/(^|-)([a-z])/g, (match, p1, p2) => p2.toUpperCase());
        acc[pascalKey] = value.trim();
      }
      return acc;
    }, {});
  }
  return [frontmatter, body, frontmatterDict];
}

// src/google/keep/import.ts
var import_obsidian3 = require("obsidian");

// src/google/keep/compare.ts
function getUpdatedFileInfo(incomingNote) {
  return {
    content: incomingNote.body,
    createdDate: incomingNote.created,
    updatedDate: incomingNote.updated
  };
}
async function getExistingFileInfo(noteFilePath, app) {
  const existingContent = await app.vault.adapter.read(noteFilePath);
  const [, existingBody, existingFrontMatterDict] = extractFrontmatter(existingContent);
  const existingCreatedDate = normalizeDate(existingFrontMatterDict.GoogleKeepCreatedDate);
  const existingUpdatedDate = normalizeDate(existingFrontMatterDict.GoogleKeepUpdatedDate);
  const existingLastSyncedDate = normalizeDate(existingFrontMatterDict.KeepSidianLastSyncedDate);
  const fsCreatedDateTimeStamp = await app.vault.adapter.stat(noteFilePath).then((stat) => stat == null ? void 0 : stat.ctime);
  const fsUpdatedDateTimeStamp = await app.vault.adapter.stat(noteFilePath).then((stat) => stat == null ? void 0 : stat.mtime);
  const fsCreatedDate = fsCreatedDateTimeStamp ? new Date(fsCreatedDateTimeStamp) : null;
  const fsUpdatedDate = fsUpdatedDateTimeStamp ? new Date(fsUpdatedDateTimeStamp) : null;
  return {
    // Read from noteFilePath
    content: existingBody,
    createdDate: existingCreatedDate,
    updatedDate: existingUpdatedDate,
    fsCreatedDate,
    fsUpdatedDate,
    lastSyncedDate: existingLastSyncedDate
  };
}
async function handleDuplicateNotes(saveLocation, incomingNote, app) {
  const noteFilePath = `${saveLocation}/${incomingNote.title}.md`;
  const fileExists = await app.vault.adapter.exists(noteFilePath);
  if (fileExists) {
    const updatedFileInfo = getUpdatedFileInfo(incomingNote);
    const existingFileInfo = await getExistingFileInfo(noteFilePath, app);
    return checkForDuplicateData(updatedFileInfo, existingFileInfo);
  } else {
    return "overwrite";
  }
}
function checkForDuplicateData(incomingFile, existingFile) {
  const currentDate = new Date();
  const incomingUpdatedDate = incomingFile.updatedDate || currentDate;
  const existingUpdatedDate = existingFile.fsUpdatedDate || existingFile.updatedDate || existingFile.fsCreatedDate;
  const lastSyncedDate = existingFile.lastSyncedDate || existingFile.fsCreatedDate;
  if (incomingFile.content === existingFile.content) {
    return "skip";
  }
  if (lastSyncedDate && existingUpdatedDate) {
    const incomingModified = incomingUpdatedDate > lastSyncedDate;
    const existingModified = existingUpdatedDate > lastSyncedDate;
    if (incomingModified && existingModified) {
      return "rename";
    }
    if (incomingModified && !existingModified) {
      return "overwrite";
    }
    if (!incomingModified && existingModified) {
      return "rename";
    }
    return "skip";
  }
  if (existingUpdatedDate) {
    if (incomingUpdatedDate > existingUpdatedDate) {
      return "overwrite";
    } else if (incomingUpdatedDate < existingUpdatedDate) {
      return "rename";
    } else {
      return "rename";
    }
  } else {
    return "rename";
  }
}

// src/google/keep/attachments.ts
var import_obsidian = require("obsidian");
async function processAttachments(plugin, blobUrls, saveLocation) {
  for (const blob_url of blobUrls) {
    try {
      let url;
      try {
        url = new URL(blob_url);
      } catch (e) {
        console.error(`Invalid URL format: ${blob_url}`);
        continue;
      }
      const blobResponse = await (0, import_obsidian.requestUrl)({
        url: blob_url,
        method: "GET"
      });
      const blobData = await blobResponse.arrayBuffer;
      const blobFileName = url.pathname.split("/").pop();
      if (blobFileName) {
        const blobFilePath = `${saveLocation}/media/${blobFileName}`;
        await plugin.app.vault.adapter.writeBinary(blobFilePath, blobData);
      }
    } catch (error) {
      console.error(error);
      throw new Error(`Failed to download blob from ${blob_url}.`);
    }
  }
}

// src/google/keep/import.ts
async function importGoogleKeepNotesBase(plugin, fetchFunction) {
  try {
    let offset = 0;
    const limit = 50;
    let hasError = false;
    while (!hasError) {
      try {
        const response = await fetchFunction(plugin, offset, limit);
        if (!response.notes || response.notes.length === 0) {
          break;
        }
        await processAndSaveNotes(plugin, response.notes);
        offset += limit;
      } catch (error) {
        console.error(`Error fetching notes at offset ${offset}:`, error);
        hasError = true;
      }
    }
    new import_obsidian2.Notice("Notes imported successfully.");
  } catch (error) {
    console.error(error);
    new import_obsidian2.Notice("Failed to import notes.");
  }
}
async function importGoogleKeepNotes(plugin) {
  await importGoogleKeepNotesBase(plugin, fetchNotes);
}
async function importGoogleKeepNotesWithOptions(plugin, options) {
  const featureFlags = convertOptionsToFeatureFlags(options);
  await importGoogleKeepNotesBase(
    plugin,
    (plugin2, offset, limit) => fetchNotesWithPremiumFeatures(plugin2, featureFlags, offset, limit)
  );
}
async function fetchNotes(plugin, offset = 0, limit = 100) {
  const response = await (0, import_obsidian2.requestUrl)({
    url: `${KEEPSIDIAN_SERVER_URL}/keep/sync?offset=${offset}&limit=${limit}`,
    method: "GET",
    headers: {
      "Content-Type": "application/json",
      "X-User-Email": plugin.settings.email,
      "Authorization": `Bearer ${plugin.settings.token}`
    }
  });
  return parseResponse(response);
}
async function fetchNotesWithPremiumFeatures(plugin, featureFlags, offset = 0, limit = 100) {
  const response = await (0, import_obsidian2.requestUrl)({
    url: `${KEEPSIDIAN_SERVER_URL}/keep/sync/premium?offset=${offset}&limit=${limit}`,
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "X-User-Email": plugin.settings.email,
      "Authorization": `Bearer ${plugin.settings.token}`
    },
    body: JSON.stringify({ feature_flags: featureFlags })
  });
  return parseResponse(response);
}
function parseResponse(response) {
  const result = typeof response.json === "function" ? response.json() : response.text ? JSON.parse(response.text) : response;
  return result;
}
function convertOptionsToFeatureFlags(options) {
  const featureFlags = {};
  if (options.includeNotesTerms && options.includeNotesTerms.length > 0) {
    featureFlags.filter_notes = {
      terms: options.includeNotesTerms
    };
  }
  if (options.excludeNotesTerms && options.excludeNotesTerms.length > 0) {
    featureFlags.skip_notes = {
      terms: options.excludeNotesTerms
    };
  }
  if (options.updateTitle) {
    featureFlags.suggest_title = {};
  }
  if (options.suggestTags) {
    featureFlags.suggest_tags = {
      max_tags: options.maxTags || 5,
      restrict_tags: options.limitToExistingTags || false,
      prefix: options.tagPrefix || "auto-"
    };
  }
  return featureFlags;
}
async function processAndSaveNotes(plugin, notes) {
  const saveLocation = plugin.settings.saveLocation;
  if (!await plugin.app.vault.adapter.exists(saveLocation)) {
    await plugin.app.vault.createFolder(saveLocation);
  }
  const mediaFolder = `${saveLocation}/media`;
  if (!await plugin.app.vault.adapter.exists(mediaFolder)) {
    await plugin.app.vault.createFolder(mediaFolder);
  }
  for (const note of notes) {
    await processAndSaveNote(plugin, note, saveLocation);
  }
}
async function processAndSaveNote(plugin, note, saveLocation) {
  const normalizedNote = normalizeNote(note);
  const noteTitle = normalizedNote.title;
  let noteFilePath = (0, import_obsidian3.normalizePath)(`${saveLocation}/${noteTitle}.md`);
  const lastSyncedDate = new Date().toISOString();
  const duplicateNotesAction = await handleDuplicateNotes(noteFilePath, normalizedNote, plugin.app);
  if (duplicateNotesAction === "skip") {
    return;
  } else if (duplicateNotesAction === "rename") {
    noteFilePath = noteFilePath.replace(/\.md$/, "");
    noteFilePath = `${noteFilePath}-conflict-${lastSyncedDate}.md`;
  }
  const mdFrontMatterDict = normalizedNote.frontmatterDict;
  mdFrontMatterDict.KeepSidianLastSyncedDate = lastSyncedDate;
  const mdFrontMatter = Object.entries(mdFrontMatterDict).map(([key, value]) => `${key}: ${value}`).join("\n");
  const mdContentWithSyncDate = `---
${mdFrontMatter}
---
${normalizedNote.body}`;
  await plugin.app.vault.adapter.write(noteFilePath, mdContentWithSyncDate);
  if (normalizedNote.blob_urls && normalizedNote.blob_urls.length > 0) {
    console.log("Processing attachments");
    await processAttachments(plugin, normalizedNote.blob_urls, saveLocation);
  }
}

// src/types/subscription.ts
var DEFAULT_PREMIUM_FEATURES = {
  autoSync: false,
  syncIntervalMinutes: 5,
  includeNotesTerms: [],
  excludeNotesTerms: [],
  updateTitle: false,
  suggestTags: false,
  maxTags: 5,
  tagPrefix: "",
  limitToExistingTags: false
};

// src/types/keepsidian-plugin-settings.ts
var DEFAULT_SETTINGS = {
  email: "",
  token: "",
  saveLocation: "Google Keep",
  subscriptionCache: void 0,
  premiumFeatures: DEFAULT_PREMIUM_FEATURES,
  gdriveToken: void 0,
  gdriveRefreshToken: void 0,
  gdriveSaveLocation: void 0
};

// src/components/SubscriptionSettingsTab.ts
var import_obsidian4 = require("obsidian");
var SubscriptionSettingsTab = class {
  constructor(containerEl, plugin) {
    this.containerEl = containerEl;
    this.plugin = plugin;
  }
  async display() {
    const { containerEl } = this;
    containerEl.createEl("h3", { text: "Premium Features" });
    new import_obsidian4.Setting(containerEl).setName("Premium Features").setDesc("Get access to advanced features like two-way sync, title suggestions, and automatic tag creation.").addExtraButton((button) => button.setIcon("refresh").setTooltip("Check subscription status").onClick(async () => {
    }));
    if (!await this.plugin.subscriptionService.isSubscriptionActive()) {
      await this.displayInactiveSubscriber();
    } else {
      await this.displayActiveSubscriber();
      await SubscriptionSettingsTab.displayPremiumFeatures(containerEl, this.plugin);
    }
  }
  static async displayPremiumFeatures(containerEl, plugin) {
    await this.displayPremiumFeaturesLocal(containerEl, plugin, plugin.settings.premiumFeatures);
    await this.displayPremiumFeaturesServer(containerEl, plugin, plugin.settings.premiumFeatures);
  }
  static async displayPremiumFeaturesLocal(containerEl, plugin, premiumFeatureValues) {
  }
  static async displayPremiumFeaturesServer(containerEl, plugin, premiumFeatureValues) {
    new import_obsidian4.Setting(containerEl).setName("Only include notes containing").setDesc("Terms to include (comma-separated).").addText((text) => text.setPlaceholder("term1, term2, ...").setValue(premiumFeatureValues.includeNotesTerms.join(", ")).onChange(async (value) => {
      premiumFeatureValues.includeNotesTerms = value.split(",").map((k) => k.trim()).filter((k) => k);
    }));
    new import_obsidian4.Setting(containerEl).setName("Exclude notes containing").setDesc("Terms to skip (comma-separated).").addText((text) => text.setPlaceholder("term1, term2, ...").setValue(premiumFeatureValues.excludeNotesTerms.join(", ")).onChange(async (value) => {
      premiumFeatureValues.excludeNotesTerms = value.split(",").map((k) => k.trim()).filter((k) => k);
    }));
    new import_obsidian4.Setting(containerEl).setName("Smart Titles").setDesc("Suggest titles based on note content. Original title will be saved in note.").addToggle((toggle) => toggle.setValue(premiumFeatureValues.updateTitle).onChange(async (value) => {
      premiumFeatureValues.updateTitle = value;
    }));
    new import_obsidian4.Setting(containerEl).setName("Auto-Tags").setDesc("Generate tags based on note content.").addToggle((toggle) => toggle.setValue(premiumFeatureValues.suggestTags).onChange(async (value) => {
      premiumFeatureValues.suggestTags = value;
    }));
    new import_obsidian4.Setting(containerEl).setName("Maximum tags").setDesc("Maximum number of tags to generate.").addSlider((slider) => slider.setLimits(1, 10, 1).setValue(premiumFeatureValues.maxTags).onChange(async (value) => {
      premiumFeatureValues.maxTags = value;
    })).setDisabled(!premiumFeatureValues.suggestTags);
    new import_obsidian4.Setting(containerEl).setName("Tag prefix").setDesc("Prefix to identify generated tags (leave empty for none).").addText((text) => text.setValue(premiumFeatureValues.tagPrefix).setPlaceholder("auto-").onChange(async (value) => {
      premiumFeatureValues.tagPrefix = value;
    })).setDisabled(!premiumFeatureValues.suggestTags);
    new import_obsidian4.Setting(containerEl).setName("Limit to existing tags").setDesc("Only generate tags that already exist in your vault.").addToggle((toggle) => toggle.setValue(premiumFeatureValues.limitToExistingTags).onChange(async (value) => {
      premiumFeatureValues.limitToExistingTags = value;
    })).setDisabled(!premiumFeatureValues.suggestTags);
  }
  async displayInactiveSubscriber() {
    const { containerEl } = this;
    containerEl.createEl("h4", { text: "Why Subscribe?" });
    const benefitsList = containerEl.createEl("ul", { attr: { style: "font-size: 0.9em" } });
    [
      "Smart Titles: Auto-suggestions from note content.",
      "Auto-Tags: Instant tag generation & management.",
      "Advanced Filters: Sync only what you need.",
      "Priority Support: Your questions answered first.",
      "Two-Way Sync: Keep notes updated, Coming soon.",
      "Early Access: First to get new features.",
      "And more!"
    ].forEach((benefit) => {
      const li = benefitsList.createEl("li");
      const [title, description] = benefit.split(":");
      if (description) {
        li.createSpan({ text: title, attr: { style: "font-weight: bold" } });
        li.createSpan({ text: ":" + description });
      } else {
        li.createSpan({ text: benefit });
      }
    });
    new import_obsidian4.Setting(containerEl).setName("Subscribe Now").setDesc("Get access to all premium features").addButton((button) => button.setButtonText("Subscribe").onClick(() => {
      window.open(`${KEEPSIDIAN_SERVER_URL}/subscribe`, "_blank");
    }));
  }
  async displayActiveSubscriber() {
    const { containerEl } = this;
    const subscriptionInfo = await this.plugin.subscriptionService.checkSubscription();
    new import_obsidian4.Setting(containerEl).setName("Subscription Status").setDesc("Active").setClass("subscription-active");
    if (subscriptionInfo == null ? void 0 : subscriptionInfo.plan_details) {
      new import_obsidian4.Setting(containerEl).setName("Plan").setDesc(subscriptionInfo.plan_details.plan_id);
    }
    if (subscriptionInfo == null ? void 0 : subscriptionInfo.metering_info) {
      new import_obsidian4.Setting(containerEl).setName("Usage").setDesc(`${subscriptionInfo.metering_info.usage} / ${subscriptionInfo.metering_info.limit} notes synced`);
    }
  }
};

// src/google/keep/token.ts
var obsidian = __toESM(require("obsidian"));
var import_obsidian5 = require("obsidian");
var sanitizeInput = (input) => {
  return input.replace(/[<>"'&]/g, (char) => {
    const entities = {
      "<": "&lt;",
      ">": "&gt;",
      '"': "&quot;",
      "'": "&#39;",
      "&": "&amp;"
    };
    return entities[char];
  });
};
var sanitizeForJS = (input) => {
  return input.replace(/[\\"']/g, "\\$&").replace(/\0/g, "\\0").replace(/\n/g, "\\n").replace(/\r/g, "\\r");
};
function isTokenResponse(obj) {
  return typeof obj === "object" && obj !== null && typeof obj.keep_token === "string";
}
async function getOAuthToken(settingsTab, plugin, retrieveTokenWebview) {
  const OAUTH_URL = "https://accounts.google.com/EmbeddedSetup";
  const GOOGLE_EMAIL = plugin.settings.email;
  const createButtonClickDetectionScript = (buttonText) => `
        (function() {
            const button = Array.from(document.querySelectorAll('button')).find(el => 
                ${buttonText.map((text) => `el.textContent.includes("${text}")`).join(" || ")}
            );
            if (button) {
                console.log("Found button.");
                button.addEventListener('click', () => console.log("buttonClicked"));
            } else {
                console.log("Button not found.");
            }
        })();
    `;
  const createOverlayScript = (title, message) => `
        (function() {
            let overlay = document.getElementById('oauth-guide-overlay');
            if (!overlay) {
                overlay = document.createElement('div');
                overlay.id = 'oauth-guide-overlay';
                Object.assign(overlay.style, {
                    position: 'fixed',
                    top: '10px',
                    right: '10px',
                    backgroundColor: 'rgba(0, 0, 0, 0.7)',
                    color: 'white',
                    padding: '20px',
                    borderRadius: '5px',
                    zIndex: '10000'
                });
                document.body.appendChild(overlay);
                const titleElement = document.createElement('h3');
                titleElement.id = 'oauth-guide-title';
                const messageElement = document.createElement('p');
                messageElement.id = 'oauth-guide-message';
                overlay.appendChild(titleElement);
                overlay.appendChild(messageElement);
            }
            document.getElementById('oauth-guide-title').textContent = '${sanitizeInput(title)}';
            document.getElementById('oauth-guide-message').textContent = '${sanitizeInput(message)}';
        })();
    `;
  const enterEmailScript = (email) => `
        (function() {
            const emailInput = document.querySelector('input[type="email"]');
            if (emailInput) {
                emailInput.value = '${sanitizeForJS(sanitizeInput(email))}';
                emailInput.dispatchEvent(new Event('input', { bubbles: true }));
                emailInput.focus();
            }
        })();
    `;
  const createDevToolsInstructionsScript = () => `
        (function() {
            const overlay = document.getElementById('oauth-guide-overlay');
            if (overlay) {
                document.getElementById('oauth-guide-title').textContent = 'Step 3 of 3: Identify the OAuth Token from Developer Tools';
                const messageElement = document.getElementById('oauth-guide-message');
                messageElement.textContent = 'Almost there! We will launch your Developer Tools momentarily. Follow the instructions below to find the OAuth Token.';

                const ol = document.createElement('ol');
                const instructions = [
                    'In the Developer Tools window, navigate to the Application Tab.',
                    'Expand the Cookies Section in the left sidebar and click google.com.',
                    'Find the cookie named "oauth_token", click it, and copy its value.',
                    'Paste the token into the field below.'
                ];

                instructions.forEach(instruction => {
                    const li = document.createElement('li');
                    li.textContent = instruction;
                    ol.appendChild(li);
                });

                messageElement.appendChild(ol);

                const input = document.createElement('input');
                input.type = 'text';
                input.placeholder = 'Paste OAuth Token here';
                input.style.width = '100%';
                input.style.marginTop = '10px';
                input.style.border = '1px solid #ccc';
                input.style.borderRadius = '5px';
                input.style.padding = '5px';
                input.style.height = '30px';
                input.style.backgroundColor = '#f0f0f0';
                input.style.opacity = '0.75';
                input.addEventListener('input', function() {
                    console.log('oauthToken: ' + this.value);
                });

                messageElement.appendChild(input);
            }
        })();
    `;
  return new Promise((resolve, reject) => {
    let intervalId;
    let messageHandler;
    let timeoutId;
    const cleanup = () => {
      if (intervalId) {
        clearInterval(intervalId);
        intervalId = void 0;
      }
      if (timeoutId) {
        clearTimeout(timeoutId);
        timeoutId = void 0;
      }
      if (messageHandler && retrieveTokenWebview) {
        retrieveTokenWebview.removeEventListener("console-message", messageHandler);
        messageHandler = void 0;
      }
    };
    const wrappedReject = (error) => {
      cleanup();
      reject(error);
    };
    (async () => {
      try {
        if (!retrieveTokenWebview) {
          throw new Error("Failed to create webview element.");
        }
        await retrieveTokenWebview.loadURL(OAUTH_URL);
        retrieveTokenWebview.show();
        let emailEntered = false;
        let stepTwoDisplayed = false;
        messageHandler = async (event) => {
          if (event.message === "buttonClicked") {
            retrieveTokenWebview.executeJavaScript(createDevToolsInstructionsScript());
            setTimeout(() => {
              retrieveTokenWebview.openDevTools();
              retrieveTokenWebview.focus();
            }, 3e3);
          } else if (event.message.startsWith("oauthToken: ")) {
            const oauthToken = event.message.split("oauthToken: ")[1];
            try {
              await exchangeOauthToken(settingsTab, plugin, oauthToken);
              cleanup();
              retrieveTokenWebview.closeDevTools();
              retrieveTokenWebview.hide();
              resolve(oauthToken);
            } catch (error) {
              wrappedReject(error);
            }
          }
        };
        retrieveTokenWebview.addEventListener("console-message", messageHandler);
        const startTime = Date.now();
        const timeout = 3e5;
        intervalId = setInterval(async () => {
          const currentUrl = retrieveTokenWebview.getURL();
          if (!emailEntered && currentUrl.includes("accounts.google.com")) {
            await retrieveTokenWebview.executeJavaScript(createOverlayScript("Step 1 of 3: Login Below.", "Please start by logging in with your Google Keep account below."));
            await retrieveTokenWebview.executeJavaScript(enterEmailScript(GOOGLE_EMAIL));
            emailEntered = true;
          }
          if (emailEntered && !stepTwoDisplayed && currentUrl.includes("embeddedsigninconsent")) {
            await retrieveTokenWebview.executeJavaScript(createOverlayScript("Step 2 of 3: Accept Service Terms.", "Great! Next, please review and agree to the terms below."));
            await new Promise((resolve2) => setTimeout(resolve2, 500));
            await retrieveTokenWebview.executeJavaScript(createButtonClickDetectionScript(["I agree", "Acepto"]));
            stepTwoDisplayed = true;
          }
          if (Date.now() - startTime >= timeout) {
            wrappedReject(new Error("Timeout: OAuth token retrieval process exceeded 5 minutes."));
          }
        }, 1e3);
        timeoutId = setTimeout(() => {
          wrappedReject(new Error("Timeout: OAuth token retrieval process exceeded 5 minutes."));
        }, 3e5);
      } catch (error) {
        wrappedReject(error);
      } finally {
        cleanup();
      }
    })();
  });
}
async function initRetrieveToken(settingsTab, plugin, retrieveTokenWebview) {
  try {
    await getOAuthToken(settingsTab, plugin, retrieveTokenWebview);
  } catch (error) {
    console.error("Failed to retrieve token:", error);
    new import_obsidian5.Notice(`Failed to retrieve token: ${error.message}`);
    throw error;
  }
}
async function exchangeOauthToken(settingsTab, plugin, oauthToken) {
  try {
    const response = await obsidian.requestUrl({
      url: `${KEEPSIDIAN_SERVER_URL}/register`,
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        email: plugin.settings.email,
        oauth_token: oauthToken
      })
    });
    if (!response.status || response.status < 200 || response.status >= 300) {
      throw new Error(`Server returned status ${response.status}`);
    }
    try {
      const result = await response.json;
      if (!isTokenResponse(result)) {
        throw new Error("Invalid response format");
      }
      if (!result.keep_token) {
        throw new Error("Server response missing keep_token");
      }
      plugin.settings.token = result.keep_token;
      await plugin.saveSettings();
      settingsTab.display();
      new import_obsidian5.Notice("Token exchanged successfully.");
    } catch (e) {
      throw new Error("Failed to parse server response: " + e);
    }
  } catch (error) {
    console.error("Error exchanging OAuth token:", error);
    new import_obsidian5.Notice(`Failed to exchange OAuth token: ${error.message}`);
    throw error;
  }
}

// src/components/KeepSidianSettingsTab.ts
var import_obsidian6 = require("obsidian");
var KeepSidianSettingsTab = class extends import_obsidian6.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  isValidEmail(email) {
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return emailRegex.test(email);
  }
  async display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "KeepSidian Settings" });
    this.addEmailSetting(containerEl);
    this.addSyncTokenSetting(containerEl);
    this.createRetrieveTokenWebView(containerEl);
    this.addSaveLocationSetting(containerEl);
    this.addSubscriptionSettings(containerEl);
  }
  addSubscriptionSettings(containerEl) {
    const subscriptionTab = new SubscriptionSettingsTab(
      containerEl,
      this.plugin
    );
    subscriptionTab.display();
  }
  addEmailSetting(containerEl) {
    new import_obsidian6.Setting(containerEl).setName("Email").setDesc("Your Google Keep email.").addText((text) => text.setPlaceholder("example@gmail.com").setValue(this.plugin.settings.email).onChange(async (value) => {
      this.plugin.settings.email = value;
      await this.plugin.saveSettings();
    }));
  }
  addSyncTokenSetting(containerEl) {
    new import_obsidian6.Setting(containerEl).setName("Sync token").setDesc('Your Google Keep sync token is a unique code that authorizes this plugin to access your Google Keep data. You can retrieve it by clicking the "Retrieve token" button.').addText((text) => {
      var _a;
      text.setPlaceholder("Your Google Keep sync token.").setValue(this.plugin.settings.token).onChange(async (value) => {
        this.plugin.settings.token = value;
        await this.plugin.saveSettings();
      });
      text.inputEl.addEventListener("paste", this.handleTokenPaste.bind(this));
      text.inputEl.type = "password";
      const toggleButton = (_a = text.inputEl.parentElement) == null ? void 0 : _a.createEl("button", { text: "Show" });
      toggleButton == null ? void 0 : toggleButton.addEventListener("click", (e) => {
        e.preventDefault();
        if (text.inputEl.type === "password") {
          text.inputEl.type = "text";
          toggleButton.textContent = "Hide";
        } else {
          text.inputEl.type = "password";
          toggleButton.textContent = "Show";
        }
      });
    }).addButton((button) => button.setButtonText("Retrieve token").onClick(this.handleRetrieveToken.bind(this)));
  }
  async handleTokenPaste(event) {
    var _a;
    event.preventDefault();
    const pastedText = (_a = event.clipboardData) == null ? void 0 : _a.getData("text");
    if (pastedText && pastedText.includes("oauth2_4")) {
      await exchangeOauthToken(this, this.plugin, pastedText);
      this.display();
    }
  }
  async handleRetrieveToken() {
    if (!this.plugin.settings.email || !this.isValidEmail(this.plugin.settings.email)) {
      new import_obsidian6.Notice("Please enter a valid email address before retrieving the token.");
      return;
    }
    await initRetrieveToken(this, this.plugin, this.retrieveTokenWebView);
    this.display();
  }
  addSaveLocationSetting(containerEl) {
    new import_obsidian6.Setting(containerEl).setName("Save location").setDesc("Where to save imported notes (relative to vault folder).").addText((text) => text.setPlaceholder("KeepSidian").setValue(this.plugin.settings.saveLocation).onChange(async (value) => {
      this.plugin.settings.saveLocation = value;
      await this.plugin.saveSettings();
    }));
  }
  createRetrieveTokenWebView(containerEl) {
    this.retrieveTokenWebView = containerEl.createEl("webview", {
      attr: { style: "width: 100%; height: 600px;" }
    });
    this.retrieveTokenWebView.src = "https://accounts.google.com/EmbeddedSetup";
    this.retrieveTokenWebView.setAttribute("disablewebsecurity", "true");
    this.retrieveTokenWebView.setAttribute("crossorigin", "anonymous");
    this.retrieveTokenWebView.hide();
  }
};

// src/services/subscription.ts
var import_obsidian7 = require("obsidian");
var CACHE_DURATION = 24 * 60 * 60 * 1e3;
var SubscriptionService = class {
  constructor(getEmail, getCache, setCache) {
    this.getEmail = getEmail;
    this.getCache = getCache;
    this.setCache = setCache;
  }
  async checkSubscription(forceRefresh = false) {
    const email = this.getEmail();
    if (!email) {
      return null;
    }
    const cache = this.getCache();
    if (!forceRefresh && cache && cache.email === email && Date.now() - cache.timestamp < CACHE_DURATION) {
      return cache.info;
    }
    try {
      const info = await this.fetchSubscriptionInfo(email);
      await this.setCache({
        info,
        timestamp: Date.now(),
        email
      });
      return info;
    } catch (error) {
      console.error("Failed to check subscription:", error);
      new import_obsidian7.Notice("Failed to check subscription status. Please try again later.");
      return null;
    }
  }
  async fetchSubscriptionInfo(email) {
    const response = await fetch(`${KEEPSIDIAN_SERVER_URL}/subscriber/info`, {
      method: "GET",
      headers: {
        "X-User-Email": email
      }
    });
    if (!response.ok) {
      const error = await response.json();
      throw new Error(error.error || "Failed to fetch subscription info");
    }
    return response.json();
  }
  async isSubscriptionActive(forceRefresh = false) {
    const info = await this.checkSubscription(forceRefresh);
    return (info == null ? void 0 : info.subscription_status) === "active";
  }
};

// src/components/NoteImportOptionsModal.ts
var import_obsidian8 = require("obsidian");
var NoteImportOptionsModal = class extends import_obsidian8.Modal {
  constructor(app, plugin, onSubmit) {
    super(app);
    this.plugin = plugin;
    this.onSubmit = onSubmit;
  }
  async onOpen() {
    const { contentEl } = this;
    contentEl.createEl("h2", { text: "Import Options" });
    contentEl.createEl("p", { text: "Thanks for subscribing! Update the premium options for this import below." });
    const premiumFeatureValues = { ...this.plugin.settings.premiumFeatures };
    await SubscriptionSettingsTab.displayPremiumFeaturesServer(contentEl, this.plugin, premiumFeatureValues);
    new import_obsidian8.Setting(contentEl).addButton((btn) => btn.setButtonText("Import").setCta().onClick(() => {
      this.onSubmit(premiumFeatureValues);
      this.close();
    })).addButton((btn) => btn.setButtonText("Cancel").onClick(() => {
      this.close();
    }));
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};

// src/main.ts
var KeepSidianPlugin = class extends import_obsidian9.Plugin {
  async onload() {
    await this.loadSettings();
    this.subscriptionService = new SubscriptionService(
      () => this.settings.email,
      () => this.settings.subscriptionCache,
      async (cache) => {
        this.settings.subscriptionCache = cache;
        await this.saveSettings();
      }
    );
    this.initializeRibbonIcon();
    this.initializeCommands();
    this.initializeSettings();
  }
  initializeRibbonIcon() {
    this.addRibbonIcon("folder-sync", "Import Google Keep notes.", (evt) => {
      this.importNotes();
    });
  }
  initializeCommands() {
    this.addCommand({
      id: "import-google-keep-notes",
      name: "Import Google Keep Notes",
      callback: async () => await this.importNotes()
    });
  }
  initializeSettings() {
    this.addSettingTab(new KeepSidianSettingsTab(this.app, this));
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  async showImportOptionsModal() {
    return new Promise((resolve) => {
      new NoteImportOptionsModal(
        this.app,
        this,
        async (options) => {
          await importGoogleKeepNotesWithOptions(this, options);
          new import_obsidian9.Notice("Imported Google Keep notes.");
          resolve();
        }
      ).open();
    });
  }
  async importNotes() {
    try {
      const isSubscriptionActive = await this.subscriptionService.isSubscriptionActive();
      if (isSubscriptionActive) {
        await this.showImportOptionsModal();
      } else {
        await importGoogleKeepNotes(this);
        new import_obsidian9.Notice("Imported Google Keep notes.");
      }
    } catch (error) {
      new import_obsidian9.Notice("Failed to import Google Keep notes: " + error.message);
    }
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL2dvb2dsZS9rZWVwL2ltcG9ydC50cyIsICJzcmMvY29uZmlnLnRzIiwgInNyYy9nb29nbGUva2VlcC9ub3RlLnRzIiwgInNyYy9nb29nbGUva2VlcC9jb21wYXJlLnRzIiwgInNyYy9nb29nbGUva2VlcC9hdHRhY2htZW50cy50cyIsICJzcmMvdHlwZXMvc3Vic2NyaXB0aW9uLnRzIiwgInNyYy90eXBlcy9rZWVwc2lkaWFuLXBsdWdpbi1zZXR0aW5ncy50cyIsICJzcmMvY29tcG9uZW50cy9TdWJzY3JpcHRpb25TZXR0aW5nc1RhYi50cyIsICJzcmMvZ29vZ2xlL2tlZXAvdG9rZW4udHMiLCAic3JjL2NvbXBvbmVudHMvS2VlcFNpZGlhblNldHRpbmdzVGFiLnRzIiwgInNyYy9zZXJ2aWNlcy9zdWJzY3JpcHRpb24udHMiLCAic3JjL2NvbXBvbmVudHMvTm90ZUltcG9ydE9wdGlvbnNNb2RhbC50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgTm90aWNlLCBQbHVnaW4gfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBpbXBvcnRHb29nbGVLZWVwTm90ZXMsIGltcG9ydEdvb2dsZUtlZXBOb3Rlc1dpdGhPcHRpb25zIH0gZnJvbSAnLi9nb29nbGUva2VlcC9pbXBvcnQnO1xuaW1wb3J0IHsgS2VlcFNpZGlhblBsdWdpblNldHRpbmdzLCBERUZBVUxUX1NFVFRJTkdTIH0gZnJvbSAnLi90eXBlcy9rZWVwc2lkaWFuLXBsdWdpbi1zZXR0aW5ncyc7XG5pbXBvcnQgeyBLZWVwU2lkaWFuU2V0dGluZ3NUYWIgfSBmcm9tICcuL2NvbXBvbmVudHMvS2VlcFNpZGlhblNldHRpbmdzVGFiJztcbmltcG9ydCB7IFN1YnNjcmlwdGlvblNlcnZpY2UgfSBmcm9tICcuL3NlcnZpY2VzL3N1YnNjcmlwdGlvbic7XG5pbXBvcnQgeyBOb3RlSW1wb3J0T3B0aW9ucywgTm90ZUltcG9ydE9wdGlvbnNNb2RhbCB9IGZyb20gJy4vY29tcG9uZW50cy9Ob3RlSW1wb3J0T3B0aW9uc01vZGFsJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgS2VlcFNpZGlhblBsdWdpbiBleHRlbmRzIFBsdWdpbiB7XG5cdHNldHRpbmdzOiBLZWVwU2lkaWFuUGx1Z2luU2V0dGluZ3M7XG5cdHN1YnNjcmlwdGlvblNlcnZpY2U6IFN1YnNjcmlwdGlvblNlcnZpY2U7XG5cblx0YXN5bmMgb25sb2FkKCkge1xuXHRcdGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG5cblx0XHR0aGlzLnN1YnNjcmlwdGlvblNlcnZpY2UgPSBuZXcgU3Vic2NyaXB0aW9uU2VydmljZShcblx0XHRcdFx0KCkgPT4gdGhpcy5zZXR0aW5ncy5lbWFpbCxcblx0XHRcdFx0KCkgPT4gdGhpcy5zZXR0aW5ncy5zdWJzY3JpcHRpb25DYWNoZSxcblx0XHRcdFx0YXN5bmMgKGNhY2hlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5zZXR0aW5ncy5zdWJzY3JpcHRpb25DYWNoZSA9IGNhY2hlO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMuc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH1cblx0XHQpO1xuXG5cdFx0dGhpcy5pbml0aWFsaXplUmliYm9uSWNvbigpO1xuXHRcdHRoaXMuaW5pdGlhbGl6ZUNvbW1hbmRzKCk7XG5cdFx0dGhpcy5pbml0aWFsaXplU2V0dGluZ3MoKTtcblx0fVxuXG5cdHByaXZhdGUgaW5pdGlhbGl6ZVJpYmJvbkljb24oKSB7XG5cdFx0dGhpcy5hZGRSaWJib25JY29uKCdmb2xkZXItc3luYycsICdJbXBvcnQgR29vZ2xlIEtlZXAgbm90ZXMuJywgKGV2dDogTW91c2VFdmVudCkgPT4ge1xuXHRcdFx0dGhpcy5pbXBvcnROb3RlcygpO1xuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSBpbml0aWFsaXplQ29tbWFuZHMoKSB7XG5cdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdGlkOiAnaW1wb3J0LWdvb2dsZS1rZWVwLW5vdGVzJyxcblx0XHRcdG5hbWU6ICdJbXBvcnQgR29vZ2xlIEtlZXAgTm90ZXMnLFxuXHRcdFx0Y2FsbGJhY2s6IGFzeW5jICgpID0+IGF3YWl0IHRoaXMuaW1wb3J0Tm90ZXMoKVxuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSBpbml0aWFsaXplU2V0dGluZ3MoKSB7XG5cdFx0dGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBLZWVwU2lkaWFuU2V0dGluZ3NUYWIodGhpcy5hcHAsIHRoaXMpKTtcblx0fVxuXG5cdGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcblx0XHR0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcblx0fVxuXG5cdGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcblx0XHRhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xuXHR9XG5cblx0YXN5bmMgc2hvd0ltcG9ydE9wdGlvbnNNb2RhbCgpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcblx0XHRcdG5ldyBOb3RlSW1wb3J0T3B0aW9uc01vZGFsKFxuXHRcdFx0XHR0aGlzLmFwcCxcblx0XHRcdFx0dGhpcyxcblx0XHRcdFx0YXN5bmMgKG9wdGlvbnM6IE5vdGVJbXBvcnRPcHRpb25zKSA9PiB7XG5cdFx0XHRcdFx0YXdhaXQgaW1wb3J0R29vZ2xlS2VlcE5vdGVzV2l0aE9wdGlvbnModGhpcywgb3B0aW9ucyk7XG5cdFx0XHRcdFx0bmV3IE5vdGljZSgnSW1wb3J0ZWQgR29vZ2xlIEtlZXAgbm90ZXMuJyk7XG5cdFx0XHRcdFx0cmVzb2x2ZSgpO1xuXHRcdFx0XHR9XG5cdFx0XHQpLm9wZW4oKTtcblx0XHR9KTtcblx0fVxuXG5cdGFzeW5jIGltcG9ydE5vdGVzKCkge1xuXHRcdHRyeSB7XG5cdFx0XHRjb25zdCBpc1N1YnNjcmlwdGlvbkFjdGl2ZSA9IGF3YWl0IHRoaXMuc3Vic2NyaXB0aW9uU2VydmljZS5pc1N1YnNjcmlwdGlvbkFjdGl2ZSgpO1xuXHRcdFx0XG5cdFx0XHRpZiAoaXNTdWJzY3JpcHRpb25BY3RpdmUpIHtcblx0XHRcdFx0YXdhaXQgdGhpcy5zaG93SW1wb3J0T3B0aW9uc01vZGFsKCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRhd2FpdCBpbXBvcnRHb29nbGVLZWVwTm90ZXModGhpcyk7XG5cdFx0XHRcdG5ldyBOb3RpY2UoJ0ltcG9ydGVkIEdvb2dsZSBLZWVwIG5vdGVzLicpO1xuXHRcdFx0fVxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRuZXcgTm90aWNlKCdGYWlsZWQgdG8gaW1wb3J0IEdvb2dsZSBLZWVwIG5vdGVzOiAnICsgZXJyb3IubWVzc2FnZSk7XG5cdFx0fVxuXHR9XG59IiwgImltcG9ydCB7IHJlcXVlc3RVcmwsIFJlcXVlc3RVcmxSZXNwb25zZSwgTm90aWNlIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgS0VFUFNJRElBTl9TRVJWRVJfVVJMIH0gZnJvbSAnLi4vLi4vY29uZmlnJztcbmltcG9ydCB7IG5vcm1hbGl6ZU5vdGUsIFByZU5vcm1hbGl6ZWROb3RlIH0gZnJvbSAnLi9ub3RlJztcbmltcG9ydCB7IG5vcm1hbGl6ZVBhdGggfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBLZWVwU2lkaWFuUGx1Z2luIGZyb20gJ21haW4nO1xuaW1wb3J0IHsgaGFuZGxlRHVwbGljYXRlTm90ZXMgfSBmcm9tICcuL2NvbXBhcmUnO1xuaW1wb3J0IHsgTm90ZUltcG9ydE9wdGlvbnMgfSBmcm9tICdjb21wb25lbnRzL05vdGVJbXBvcnRPcHRpb25zTW9kYWwnO1xuaW1wb3J0IHsgcHJvY2Vzc0F0dGFjaG1lbnRzIH0gZnJvbSAnLi9hdHRhY2htZW50cyc7XG5cbmludGVyZmFjZSBHb29nbGVLZWVwSW1wb3J0UmVzcG9uc2Uge1xuICAgIG5vdGVzOiBBcnJheTxQcmVOb3JtYWxpemVkTm90ZT47XG4gICAgLy8gQWRkIG90aGVyIHRvcC1sZXZlbCBwcm9wZXJ0aWVzIGlmIHRoZXkgZXhpc3QgaW4gdGhlIHJlc3BvbnNlXG59XG5cbmludGVyZmFjZSBQcmVtaXVtRmVhdHVyZUZsYWdzIHtcbiAgICBmaWx0ZXJfbm90ZXM/OiB7XG4gICAgICAgIHRlcm1zOiBzdHJpbmdbXTtcbiAgICB9O1xuICAgIHNraXBfbm90ZXM/OiB7XG4gICAgICAgIHRlcm1zOiBzdHJpbmdbXTtcbiAgICB9O1xuICAgIHN1Z2dlc3RfdGl0bGU/OiBSZWNvcmQ8c3RyaW5nLCBuZXZlcj47XG4gICAgc3VnZ2VzdF90YWdzPzoge1xuICAgICAgICBtYXhfdGFnczogbnVtYmVyO1xuICAgICAgICByZXN0cmljdF90YWdzOiBib29sZWFuO1xuICAgICAgICBwcmVmaXg6IHN0cmluZztcbiAgICB9O1xufVxuXG5hc3luYyBmdW5jdGlvbiBpbXBvcnRHb29nbGVLZWVwTm90ZXNCYXNlKFxuICAgIHBsdWdpbjogS2VlcFNpZGlhblBsdWdpbixcbiAgICBmZXRjaEZ1bmN0aW9uOiAocGx1Z2luOiBLZWVwU2lkaWFuUGx1Z2luLCBvZmZzZXQ6IG51bWJlciwgbGltaXQ6IG51bWJlcikgPT4gUHJvbWlzZTxHb29nbGVLZWVwSW1wb3J0UmVzcG9uc2U+XG4pIHtcbiAgICB0cnkge1xuICAgICAgICBsZXQgb2Zmc2V0ID0gMDtcbiAgICAgICAgY29uc3QgbGltaXQgPSA1MDtcbiAgICAgICAgbGV0IGhhc0Vycm9yID0gZmFsc2U7XG4gICAgICAgIFxuICAgICAgICB3aGlsZSAoIWhhc0Vycm9yKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2hGdW5jdGlvbihwbHVnaW4sIG9mZnNldCwgbGltaXQpO1xuICAgICAgICAgICAgICAgIGlmICghcmVzcG9uc2Uubm90ZXMgfHwgcmVzcG9uc2Uubm90ZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBhd2FpdCBwcm9jZXNzQW5kU2F2ZU5vdGVzKHBsdWdpbiwgcmVzcG9uc2Uubm90ZXMpO1xuICAgICAgICAgICAgICAgIG9mZnNldCArPSBsaW1pdDtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgZmV0Y2hpbmcgbm90ZXMgYXQgb2Zmc2V0ICR7b2Zmc2V0fTpgLCBlcnJvcik7XG4gICAgICAgICAgICAgICAgaGFzRXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgbmV3IE5vdGljZSgnTm90ZXMgaW1wb3J0ZWQgc3VjY2Vzc2Z1bGx5LicpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgICAgICBuZXcgTm90aWNlKCdGYWlsZWQgdG8gaW1wb3J0IG5vdGVzLicpO1xuICAgIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGltcG9ydEdvb2dsZUtlZXBOb3RlcyhwbHVnaW46IEtlZXBTaWRpYW5QbHVnaW4pIHtcbiAgICBhd2FpdCBpbXBvcnRHb29nbGVLZWVwTm90ZXNCYXNlKHBsdWdpbiwgZmV0Y2hOb3Rlcyk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbXBvcnRHb29nbGVLZWVwTm90ZXNXaXRoT3B0aW9ucyhwbHVnaW46IEtlZXBTaWRpYW5QbHVnaW4sIG9wdGlvbnM6IE5vdGVJbXBvcnRPcHRpb25zKSB7XG4gICAgY29uc3QgZmVhdHVyZUZsYWdzID0gY29udmVydE9wdGlvbnNUb0ZlYXR1cmVGbGFncyhvcHRpb25zKTtcbiAgICBhd2FpdCBpbXBvcnRHb29nbGVLZWVwTm90ZXNCYXNlKFxuICAgICAgICBwbHVnaW4sXG4gICAgICAgIChwbHVnaW4sIG9mZnNldCwgbGltaXQpID0+IGZldGNoTm90ZXNXaXRoUHJlbWl1bUZlYXR1cmVzKHBsdWdpbiwgZmVhdHVyZUZsYWdzLCBvZmZzZXQsIGxpbWl0KVxuICAgICk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmZXRjaE5vdGVzKHBsdWdpbjogS2VlcFNpZGlhblBsdWdpbiwgb2Zmc2V0ID0gMCwgbGltaXQgPSAxMDApOiBQcm9taXNlPEdvb2dsZUtlZXBJbXBvcnRSZXNwb25zZT4ge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdFVybCh7XG4gICAgICAgIHVybDogYCR7S0VFUFNJRElBTl9TRVJWRVJfVVJMfS9rZWVwL3N5bmM/b2Zmc2V0PSR7b2Zmc2V0fSZsaW1pdD0ke2xpbWl0fWAsXG4gICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICAnWC1Vc2VyLUVtYWlsJzogcGx1Z2luLnNldHRpbmdzLmVtYWlsLFxuICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7cGx1Z2luLnNldHRpbmdzLnRva2VufWBcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHBhcnNlUmVzcG9uc2UocmVzcG9uc2UpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZmV0Y2hOb3Rlc1dpdGhQcmVtaXVtRmVhdHVyZXMoXG4gICAgcGx1Z2luOiBLZWVwU2lkaWFuUGx1Z2luLCBcbiAgICBmZWF0dXJlRmxhZ3M6IFByZW1pdW1GZWF0dXJlRmxhZ3MsXG4gICAgb2Zmc2V0ID0gMCxcbiAgICBsaW1pdCA9IDEwMFxuKTogUHJvbWlzZTxHb29nbGVLZWVwSW1wb3J0UmVzcG9uc2U+IHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3RVcmwoe1xuICAgICAgICB1cmw6IGAke0tFRVBTSURJQU5fU0VSVkVSX1VSTH0va2VlcC9zeW5jL3ByZW1pdW0/b2Zmc2V0PSR7b2Zmc2V0fSZsaW1pdD0ke2xpbWl0fWAsXG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgJ1gtVXNlci1FbWFpbCc6IHBsdWdpbi5zZXR0aW5ncy5lbWFpbCxcbiAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3BsdWdpbi5zZXR0aW5ncy50b2tlbn1gXG4gICAgICAgIH0sXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgZmVhdHVyZV9mbGFnczogZmVhdHVyZUZsYWdzIH0pXG4gICAgfSk7XG5cbiAgICByZXR1cm4gcGFyc2VSZXNwb25zZShyZXNwb25zZSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZVJlc3BvbnNlKHJlc3BvbnNlOiBSZXF1ZXN0VXJsUmVzcG9uc2UpOiBHb29nbGVLZWVwSW1wb3J0UmVzcG9uc2Uge1xuICAgIGNvbnN0IHJlc3VsdCA9IHR5cGVvZiByZXNwb25zZS5qc29uID09PSAnZnVuY3Rpb24nXG4gICAgICAgID8gcmVzcG9uc2UuanNvbigpXG4gICAgICAgIDogcmVzcG9uc2UudGV4dCA/IEpTT04ucGFyc2UocmVzcG9uc2UudGV4dCkgOiByZXNwb25zZTtcbiAgICByZXR1cm4gcmVzdWx0IGFzIEdvb2dsZUtlZXBJbXBvcnRSZXNwb25zZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvbnZlcnRPcHRpb25zVG9GZWF0dXJlRmxhZ3Mob3B0aW9uczogTm90ZUltcG9ydE9wdGlvbnMpOiBQcmVtaXVtRmVhdHVyZUZsYWdzIHtcbiAgICBjb25zdCBmZWF0dXJlRmxhZ3M6IFByZW1pdW1GZWF0dXJlRmxhZ3MgPSB7fTtcbiAgICBcbiAgICBpZiAob3B0aW9ucy5pbmNsdWRlTm90ZXNUZXJtcyAmJiBvcHRpb25zLmluY2x1ZGVOb3Rlc1Rlcm1zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgZmVhdHVyZUZsYWdzLmZpbHRlcl9ub3RlcyA9IHtcbiAgICAgICAgICAgIHRlcm1zOiBvcHRpb25zLmluY2x1ZGVOb3Rlc1Rlcm1zXG4gICAgICAgIH07XG4gICAgfVxuICAgIFxuICAgIGlmIChvcHRpb25zLmV4Y2x1ZGVOb3Rlc1Rlcm1zICYmIG9wdGlvbnMuZXhjbHVkZU5vdGVzVGVybXMubGVuZ3RoID4gMCkge1xuICAgICAgICBmZWF0dXJlRmxhZ3Muc2tpcF9ub3RlcyA9IHtcbiAgICAgICAgICAgIHRlcm1zOiBvcHRpb25zLmV4Y2x1ZGVOb3Rlc1Rlcm1zXG4gICAgICAgIH07XG4gICAgfVxuICAgIFxuICAgIGlmIChvcHRpb25zLnVwZGF0ZVRpdGxlKSB7XG4gICAgICAgIGZlYXR1cmVGbGFncy5zdWdnZXN0X3RpdGxlID0ge307XG4gICAgfVxuICAgIFxuICAgIGlmIChvcHRpb25zLnN1Z2dlc3RUYWdzKSB7XG4gICAgICAgIGZlYXR1cmVGbGFncy5zdWdnZXN0X3RhZ3MgPSB7XG4gICAgICAgICAgICBtYXhfdGFnczogb3B0aW9ucy5tYXhUYWdzIHx8IDUsXG4gICAgICAgICAgICByZXN0cmljdF90YWdzOiBvcHRpb25zLmxpbWl0VG9FeGlzdGluZ1RhZ3MgfHwgZmFsc2UsXG4gICAgICAgICAgICBwcmVmaXg6IG9wdGlvbnMudGFnUHJlZml4IHx8ICdhdXRvLSdcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICByZXR1cm4gZmVhdHVyZUZsYWdzO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcHJvY2Vzc0FuZFNhdmVOb3RlcyhwbHVnaW46IEtlZXBTaWRpYW5QbHVnaW4sIG5vdGVzOiBQcmVOb3JtYWxpemVkTm90ZVtdKSB7XG4gICAgY29uc3Qgc2F2ZUxvY2F0aW9uID0gcGx1Z2luLnNldHRpbmdzLnNhdmVMb2NhdGlvbjtcbiAgICBcbiAgICAvLyBDcmVhdGUgc2F2ZUxvY2F0aW9uIGlmIGl0IGRvZXNuJ3QgZXhpc3RcbiAgICBpZiAoIShhd2FpdCBwbHVnaW4uYXBwLnZhdWx0LmFkYXB0ZXIuZXhpc3RzKHNhdmVMb2NhdGlvbikpKSB7XG4gICAgICAgIGF3YWl0IHBsdWdpbi5hcHAudmF1bHQuY3JlYXRlRm9sZGVyKHNhdmVMb2NhdGlvbik7XG4gICAgfVxuXG4gICAgLy8gQ3JlYXRlIG1lZGlhIHN1YmZvbGRlciBpZiBpdCBkb2Vzbid0IGV4aXN0XG4gICAgY29uc3QgbWVkaWFGb2xkZXIgPSBgJHtzYXZlTG9jYXRpb259L21lZGlhYDtcbiAgICBpZiAoIShhd2FpdCBwbHVnaW4uYXBwLnZhdWx0LmFkYXB0ZXIuZXhpc3RzKG1lZGlhRm9sZGVyKSkpIHtcbiAgICAgICAgYXdhaXQgcGx1Z2luLmFwcC52YXVsdC5jcmVhdGVGb2xkZXIobWVkaWFGb2xkZXIpO1xuICAgIH1cblxuICAgIGZvciAoY29uc3Qgbm90ZSBvZiBub3Rlcykge1xuICAgICAgICBhd2FpdCBwcm9jZXNzQW5kU2F2ZU5vdGUocGx1Z2luLCBub3RlLCBzYXZlTG9jYXRpb24pO1xuICAgIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHByb2Nlc3NBbmRTYXZlTm90ZShwbHVnaW46IEtlZXBTaWRpYW5QbHVnaW4sIG5vdGU6IFByZU5vcm1hbGl6ZWROb3RlLCBzYXZlTG9jYXRpb246IHN0cmluZykge1xuICAgIGNvbnN0IG5vcm1hbGl6ZWROb3RlID0gbm9ybWFsaXplTm90ZShub3RlKTtcbiAgICBjb25zdCBub3RlVGl0bGUgPSBub3JtYWxpemVkTm90ZS50aXRsZTtcbiAgICBsZXQgbm90ZUZpbGVQYXRoID0gbm9ybWFsaXplUGF0aChgJHtzYXZlTG9jYXRpb259LyR7bm90ZVRpdGxlfS5tZGApO1xuXG4gICAgY29uc3QgbGFzdFN5bmNlZERhdGUgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7XG5cbiAgICAvLyBDaGVjayBpZiB0aGUgbm90ZSBmaWxlIGFscmVhZHkgZXhpc3RzXG4gICAgY29uc3QgZHVwbGljYXRlTm90ZXNBY3Rpb24gPSBhd2FpdCBoYW5kbGVEdXBsaWNhdGVOb3Rlcyhub3RlRmlsZVBhdGgsIG5vcm1hbGl6ZWROb3RlLCBwbHVnaW4uYXBwKTtcbiAgICBpZiAoZHVwbGljYXRlTm90ZXNBY3Rpb24gPT09ICdza2lwJykge1xuICAgICAgICByZXR1cm47XG4gICAgfSBlbHNlIGlmIChkdXBsaWNhdGVOb3Rlc0FjdGlvbiA9PT0gJ3JlbmFtZScpIHtcbiAgICAgICAgbm90ZUZpbGVQYXRoID0gbm90ZUZpbGVQYXRoLnJlcGxhY2UoL1xcLm1kJC8sICcnKTtcbiAgICAgICAgbm90ZUZpbGVQYXRoID0gYCR7bm90ZUZpbGVQYXRofS1jb25mbGljdC0ke2xhc3RTeW5jZWREYXRlfS5tZGA7XG4gICAgfVxuXG4gICAgLy8gU2F2ZSB0aGUgbm90ZSBjb250ZW50XG4gICAgY29uc3QgbWRGcm9udE1hdHRlckRpY3QgPSBub3JtYWxpemVkTm90ZS5mcm9udG1hdHRlckRpY3Q7XG4gICAgbWRGcm9udE1hdHRlckRpY3QuS2VlcFNpZGlhbkxhc3RTeW5jZWREYXRlID0gbGFzdFN5bmNlZERhdGU7XG4gICAgY29uc3QgbWRGcm9udE1hdHRlciA9IE9iamVjdC5lbnRyaWVzKG1kRnJvbnRNYXR0ZXJEaWN0KS5tYXAoKFtrZXksIHZhbHVlXSkgPT4gYCR7a2V5fTogJHt2YWx1ZX1gKS5qb2luKCdcXG4nKTtcbiAgICBjb25zdCBtZENvbnRlbnRXaXRoU3luY0RhdGUgPSBgLS0tXFxuJHttZEZyb250TWF0dGVyfVxcbi0tLVxcbiR7bm9ybWFsaXplZE5vdGUuYm9keX1gO1xuXG4gICAgYXdhaXQgcGx1Z2luLmFwcC52YXVsdC5hZGFwdGVyLndyaXRlKG5vdGVGaWxlUGF0aCwgbWRDb250ZW50V2l0aFN5bmNEYXRlKTtcblxuICAgIC8vIFByb2Nlc3MgYXR0YWNobWVudHNcbiAgICAvLyBpZiAobm90ZS5ibG9iX3VybHMpIHtcbiAgICBpZiAobm9ybWFsaXplZE5vdGUuYmxvYl91cmxzICYmIG5vcm1hbGl6ZWROb3RlLmJsb2JfdXJscy5sZW5ndGggPiAwKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdQcm9jZXNzaW5nIGF0dGFjaG1lbnRzJyk7XG4gICAgICAgIGF3YWl0IHByb2Nlc3NBdHRhY2htZW50cyhwbHVnaW4sIG5vcm1hbGl6ZWROb3RlLmJsb2JfdXJscywgc2F2ZUxvY2F0aW9uKTtcbiAgICB9XG59IiwgIi8vIEtFRVBTSURJQU5fU0VSVkVSX1VSTCBpcyB0aGUgVVJMIG9mIHRoZSBLZWVwc2lkaWFuIHNlcnZlclxuLy8gSXQgc2hvdWxkIE5PVCBlbmQgd2l0aCBhIHNsYXNoXG4vLyBleHBvcnQgY29uc3QgS0VFUFNJRElBTl9TRVJWRVJfVVJMID0gJ2h0dHA6Ly9sb2NhbGhvc3Q6ODA4MCc7XG5leHBvcnQgY29uc3QgS0VFUFNJRElBTl9TRVJWRVJfVVJMID0gJ2h0dHBzOi8va2VlcHNpZGlhbnNlcnZlci1pNTVxcjV0dmVhLXVjLmEucnVuLmFwcCciLCAiaW50ZXJmYWNlIE5vcm1hbGl6ZWROb3RlIHtcbiAgICB0aXRsZTogc3RyaW5nO1xuICAgIHRleHQ6IHN0cmluZztcbiAgICBib2R5OiBzdHJpbmc7XG4gICAgY3JlYXRlZDogRGF0ZSB8IG51bGw7XG4gICAgdXBkYXRlZDogRGF0ZSB8IG51bGw7XG4gICAgZnJvbnRtYXR0ZXI6IHN0cmluZztcbiAgICBmcm9udG1hdHRlckRpY3Q6IHsgW2tleTogc3RyaW5nXTogc3RyaW5nIH07XG4gICAgYXJjaGl2ZWQ6IGJvb2xlYW47XG4gICAgdHJhc2hlZDogYm9vbGVhbjtcbiAgICBsYWJlbHM6IHN0cmluZ1tdO1xuICAgIGJsb2JzOiBzdHJpbmdbXTtcbiAgICBibG9iX3VybHM6IHN0cmluZ1tdO1xuICAgIGJsb2JfbmFtZXM6IHN0cmluZ1tdO1xuICAgIG1lZGlhOiBzdHJpbmdbXTtcbiAgICBoZWFkZXI6IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIFByZU5vcm1hbGl6ZWROb3RlIHtcbiAgICB0aXRsZT86IHN0cmluZztcbiAgICB0ZXh0Pzogc3RyaW5nO1xuICAgIGJvZHk/OiBzdHJpbmc7XG4gICAgY3JlYXRlZD86IHN0cmluZztcbiAgICB1cGRhdGVkPzogc3RyaW5nO1xuICAgIGZyb250bWF0dGVyPzogc3RyaW5nO1xuICAgIGZyb250bWF0dGVyRGljdD86IHsgW2tleTogc3RyaW5nXTogc3RyaW5nIH07XG4gICAgYXJjaGl2ZWQ/OiBib29sZWFuO1xuICAgIHRyYXNoZWQ/OiBib29sZWFuO1xuICAgIGxhYmVscz86IHN0cmluZ1tdO1xuICAgIGJsb2JzPzogc3RyaW5nW107XG4gICAgYmxvYl91cmxzPzogc3RyaW5nW107XG4gICAgYmxvYl9uYW1lcz86IHN0cmluZ1tdO1xuICAgIG1lZGlhPzogc3RyaW5nW107XG4gICAgaGVhZGVyPzogc3RyaW5nO1xufVxuXG5mdW5jdGlvbiBub3JtYWxpemVEYXRlKGRhdGVTdHJpbmc/OiBzdHJpbmcgfCBudWxsKTogRGF0ZSB8IG51bGwge1xuICAgIGlmICghZGF0ZVN0cmluZykge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKGRhdGVTdHJpbmcpO1xuICAgIHJldHVybiBpc05hTihkYXRlLmdldFRpbWUoKSkgPyBudWxsIDogZGF0ZTtcbn1cblxuZnVuY3Rpb24gbm9ybWFsaXplTm90ZShub3RlOiBQcmVOb3JtYWxpemVkTm90ZSk6IE5vcm1hbGl6ZWROb3RlIHtcbiAgICBjb25zdCBub3JtYWxpemVkTm90ZTogTm9ybWFsaXplZE5vdGUgPSB7XG4gICAgICAgIHRpdGxlOiBub3RlLnRpdGxlPy50cmltKCkgfHwgJycsXG4gICAgICAgIHRleHQ6IG5vdGUudGV4dD8udHJpbSgpIHx8ICcnLFxuICAgICAgICBjcmVhdGVkOiBub3JtYWxpemVEYXRlKG5vdGUuY3JlYXRlZCkgfHwgbnVsbCxcbiAgICAgICAgdXBkYXRlZDogbm9ybWFsaXplRGF0ZShub3RlLnVwZGF0ZWQpIHx8IG51bGwsXG4gICAgICAgIGFyY2hpdmVkOiBub3RlLmFyY2hpdmVkIHx8IGZhbHNlLFxuICAgICAgICB0cmFzaGVkOiBub3RlLnRyYXNoZWQgfHwgZmFsc2UsXG4gICAgICAgIGxhYmVsczogQXJyYXkuaXNBcnJheShub3RlLmxhYmVscykgPyBub3RlLmxhYmVscyA6IFtdLFxuICAgICAgICBibG9iczogQXJyYXkuaXNBcnJheShub3RlLmJsb2JzKSA/IG5vdGUuYmxvYnMgOiBbXSxcbiAgICAgICAgYmxvYl91cmxzOiBBcnJheS5pc0FycmF5KG5vdGUuYmxvYl91cmxzKSA/IG5vdGUuYmxvYl91cmxzIDogW10sXG4gICAgICAgIGJsb2JfbmFtZXM6IEFycmF5LmlzQXJyYXkobm90ZS5ibG9iX25hbWVzKSA/IG5vdGUuYmxvYl9uYW1lcyA6IFtdLFxuICAgICAgICBtZWRpYTogQXJyYXkuaXNBcnJheShub3RlLm1lZGlhKSA/IG5vdGUubWVkaWEgOiBbXSxcbiAgICAgICAgaGVhZGVyOiBub3RlLmhlYWRlciB8fCAnJyxcbiAgICAgICAgYm9keTogJycsXG4gICAgICAgIGZyb250bWF0dGVyOiAnJyxcbiAgICAgICAgZnJvbnRtYXR0ZXJEaWN0OiB7fSxcbiAgICB9XG5cbiAgICBjb25zdCBbZnJvbnRtYXR0ZXIsIGJvZHksIGZyb250bWF0dGVyRGljdF0gPSBleHRyYWN0RnJvbnRtYXR0ZXIobm90ZS50ZXh0IHx8ICcnKTtcbiAgICBub3JtYWxpemVkTm90ZS5mcm9udG1hdHRlciA9IGZyb250bWF0dGVyO1xuICAgIG5vcm1hbGl6ZWROb3RlLmJvZHkgPSBib2R5O1xuICAgIG5vcm1hbGl6ZWROb3RlLmZyb250bWF0dGVyRGljdCA9IGZyb250bWF0dGVyRGljdDtcblxuICAgIHJldHVybiBub3JtYWxpemVkTm90ZTtcbn1cblxuZnVuY3Rpb24gZXh0cmFjdEZyb250bWF0dGVyKHRleHQ6IHN0cmluZyk6IFtzdHJpbmcsIHN0cmluZywgeyBba2V5OiBzdHJpbmddOiBzdHJpbmcgfV0ge1xuICAgIC8vIEZyb250bWF0dGVyIGlzIGJldHdlZW4gLS0tIGFuZCAtLS0gYXQgdGhlIHN0YXJ0IG9mIHRoZSB0ZXh0IGlmIGl0IGV4aXN0c1xuICAgIGxldCBib2R5ID0gdGV4dFxuICAgIGxldCBmcm9udG1hdHRlciA9ICcnO1xuICAgIGxldCBmcm9udG1hdHRlckRpY3QgPSB7fTtcbiAgICBjb25zdCBzcGxpdFRleHQgPSB0ZXh0Py5zcGxpdCgnLS0tJyk7XG4gICAgaWYgKHNwbGl0VGV4dCAmJiBzcGxpdFRleHQubGVuZ3RoID4gMikge1xuICAgICAgICBmcm9udG1hdHRlciA9IHNwbGl0VGV4dFsxXS50cmltKCk7XG4gICAgICAgIGJvZHkgPSBzcGxpdFRleHRbMl0udHJpbSgpO1xuICAgIH1cblxuICAgIC8vIFNwbGl0IGZyb250bWF0dGVyIGludG8ga2V5IHZhbHVlIHBhaXJzXG4gICAgY29uc3QgZnJvbnRtYXR0ZXJfcGFydHMgPSBmcm9udG1hdHRlcj8uc3BsaXQoJ1xcbicpO1xuICAgIGlmIChmcm9udG1hdHRlcikge1xuICAgICAgICBmcm9udG1hdHRlckRpY3QgPSBmcm9udG1hdHRlcl9wYXJ0cy5yZWR1Y2UoKGFjYzogeyBba2V5OiBzdHJpbmddOiBzdHJpbmcgfSwgaXRlbTogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBba2V5LCB2YWx1ZV0gPSBpdGVtLnNwbGl0KCc6ICcpO1xuICAgICAgICAgICAgaWYgKGtleSAmJiB2YWx1ZSkge1xuICAgICAgICAgICAgICAgIC8vIENvbnZlcnQga2V5IHRvIFBhc2NhbENhc2VcbiAgICAgICAgICAgICAgICBjb25zdCBwYXNjYWxLZXkgPSBrZXkucmVwbGFjZSgvKF58LSkoW2Etel0pL2csIChtYXRjaCwgcDEsIHAyKSA9PiBwMi50b1VwcGVyQ2FzZSgpKTtcbiAgICAgICAgICAgICAgICBhY2NbcGFzY2FsS2V5XSA9IHZhbHVlLnRyaW0oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBhY2M7XG4gICAgICAgIH0sIHt9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gW2Zyb250bWF0dGVyLCBib2R5LCBmcm9udG1hdHRlckRpY3RdO1xufVxuXG5cbmV4cG9ydCB7IGV4dHJhY3RGcm9udG1hdHRlciwgbm9ybWFsaXplTm90ZSwgbm9ybWFsaXplRGF0ZSB9O1xuZXhwb3J0IHR5cGUgeyBOb3JtYWxpemVkTm90ZSwgUHJlTm9ybWFsaXplZE5vdGUgfTsiLCAiaW1wb3J0IHsgQXBwIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBOb3JtYWxpemVkTm90ZSwgbm9ybWFsaXplRGF0ZSwgZXh0cmFjdEZyb250bWF0dGVyIH0gZnJvbSBcIi4vbm90ZVwiO1xuXG5pbnRlcmZhY2UgVXBkYXRlZEZpbGVJbmZvIHtcbiAgICBjb250ZW50OiBzdHJpbmc7XG4gICAgY3JlYXRlZERhdGU6IERhdGUgfCBudWxsO1xuICAgIHVwZGF0ZWREYXRlOiBEYXRlIHwgbnVsbDtcbn1cblxuaW50ZXJmYWNlIEV4aXN0aW5nRmlsZUluZm8ge1xuICAgIGNvbnRlbnQ6IHN0cmluZztcbiAgICBjcmVhdGVkRGF0ZTogRGF0ZSB8IG51bGw7XG4gICAgdXBkYXRlZERhdGU6IERhdGUgfCBudWxsO1xuICAgIGZzQ3JlYXRlZERhdGU6IERhdGUgfCBudWxsO1xuICAgIGZzVXBkYXRlZERhdGU6IERhdGUgfCBudWxsO1xuICAgIGxhc3RTeW5jZWREYXRlOiBEYXRlIHwgbnVsbDtcbn1cblxuXG5mdW5jdGlvbiBnZXRVcGRhdGVkRmlsZUluZm8oaW5jb21pbmdOb3RlOiBOb3JtYWxpemVkTm90ZSk6IFVwZGF0ZWRGaWxlSW5mbyB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgY29udGVudDogaW5jb21pbmdOb3RlLmJvZHksXG4gICAgICAgIGNyZWF0ZWREYXRlOiBpbmNvbWluZ05vdGUuY3JlYXRlZCxcbiAgICAgICAgdXBkYXRlZERhdGU6IGluY29taW5nTm90ZS51cGRhdGVkLFxuICAgIH07XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGdldEV4aXN0aW5nRmlsZUluZm8obm90ZUZpbGVQYXRoOiBzdHJpbmcsIGFwcDogQXBwKTogUHJvbWlzZTxFeGlzdGluZ0ZpbGVJbmZvPiB7XG4gICAgY29uc3QgZXhpc3RpbmdDb250ZW50ID0gYXdhaXQgYXBwLnZhdWx0LmFkYXB0ZXIucmVhZChub3RlRmlsZVBhdGgpO1xuICAgIGNvbnN0IFssIGV4aXN0aW5nQm9keSwgZXhpc3RpbmdGcm9udE1hdHRlckRpY3RdID0gZXh0cmFjdEZyb250bWF0dGVyKGV4aXN0aW5nQ29udGVudCk7XG5cbiAgICBjb25zdCBleGlzdGluZ0NyZWF0ZWREYXRlID0gbm9ybWFsaXplRGF0ZShleGlzdGluZ0Zyb250TWF0dGVyRGljdC5Hb29nbGVLZWVwQ3JlYXRlZERhdGUpO1xuICAgIGNvbnN0IGV4aXN0aW5nVXBkYXRlZERhdGUgPSBub3JtYWxpemVEYXRlKGV4aXN0aW5nRnJvbnRNYXR0ZXJEaWN0Lkdvb2dsZUtlZXBVcGRhdGVkRGF0ZSk7XG4gICAgY29uc3QgZXhpc3RpbmdMYXN0U3luY2VkRGF0ZSA9IG5vcm1hbGl6ZURhdGUoZXhpc3RpbmdGcm9udE1hdHRlckRpY3QuS2VlcFNpZGlhbkxhc3RTeW5jZWREYXRlKTtcbiAgICAvLyBHZXQgZnNDcmVhdGVkRGF0ZSBhbmQgZnNVcGRhdGVkRGF0ZSBmcm9tIG5vdGVGaWxlUGF0aFxuICAgIGNvbnN0IGZzQ3JlYXRlZERhdGVUaW1lU3RhbXAgPSBhd2FpdCBhcHAudmF1bHQuYWRhcHRlci5zdGF0KG5vdGVGaWxlUGF0aCkudGhlbigoc3RhdCkgPT4gc3RhdD8uY3RpbWUpO1xuICAgIGNvbnN0IGZzVXBkYXRlZERhdGVUaW1lU3RhbXAgPSBhd2FpdCBhcHAudmF1bHQuYWRhcHRlci5zdGF0KG5vdGVGaWxlUGF0aCkudGhlbigoc3RhdCkgPT4gc3RhdD8ubXRpbWUpO1xuICAgIGNvbnN0IGZzQ3JlYXRlZERhdGUgPSBmc0NyZWF0ZWREYXRlVGltZVN0YW1wID8gbmV3IERhdGUoZnNDcmVhdGVkRGF0ZVRpbWVTdGFtcCkgOiBudWxsO1xuICAgIGNvbnN0IGZzVXBkYXRlZERhdGUgPSBmc1VwZGF0ZWREYXRlVGltZVN0YW1wID8gbmV3IERhdGUoZnNVcGRhdGVkRGF0ZVRpbWVTdGFtcCkgOiBudWxsO1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIC8vIFJlYWQgZnJvbSBub3RlRmlsZVBhdGhcbiAgICAgICAgY29udGVudDogZXhpc3RpbmdCb2R5LFxuICAgICAgICBjcmVhdGVkRGF0ZTogZXhpc3RpbmdDcmVhdGVkRGF0ZSxcbiAgICAgICAgdXBkYXRlZERhdGU6IGV4aXN0aW5nVXBkYXRlZERhdGUsXG4gICAgICAgIGZzQ3JlYXRlZERhdGU6IGZzQ3JlYXRlZERhdGUsXG4gICAgICAgIGZzVXBkYXRlZERhdGU6IGZzVXBkYXRlZERhdGUsXG4gICAgICAgIGxhc3RTeW5jZWREYXRlOiBleGlzdGluZ0xhc3RTeW5jZWREYXRlXG4gICAgfTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlRHVwbGljYXRlTm90ZXMoXG4gICAgc2F2ZUxvY2F0aW9uOiBzdHJpbmcsXG4gICAgaW5jb21pbmdOb3RlOiBOb3JtYWxpemVkTm90ZSxcbiAgICBhcHA6IEFwcFxuKTogUHJvbWlzZTwnc2tpcCcgfCAncmVuYW1lJyB8ICdvdmVyd3JpdGUnPiB7XG4gICAgY29uc3Qgbm90ZUZpbGVQYXRoID0gYCR7c2F2ZUxvY2F0aW9ufS8ke2luY29taW5nTm90ZS50aXRsZX0ubWRgO1xuICAgIGNvbnN0IGZpbGVFeGlzdHMgPSBhd2FpdCBhcHAudmF1bHQuYWRhcHRlci5leGlzdHMobm90ZUZpbGVQYXRoKTtcblxuICAgIGlmIChmaWxlRXhpc3RzKSB7XG4gICAgICAgIGNvbnN0IHVwZGF0ZWRGaWxlSW5mbzogVXBkYXRlZEZpbGVJbmZvID0gZ2V0VXBkYXRlZEZpbGVJbmZvKGluY29taW5nTm90ZSk7XG4gICAgICAgIGNvbnN0IGV4aXN0aW5nRmlsZUluZm86IEV4aXN0aW5nRmlsZUluZm8gPSBhd2FpdCBnZXRFeGlzdGluZ0ZpbGVJbmZvKG5vdGVGaWxlUGF0aCwgYXBwKTtcblxuICAgICAgICByZXR1cm4gY2hlY2tGb3JEdXBsaWNhdGVEYXRhKHVwZGF0ZWRGaWxlSW5mbywgZXhpc3RpbmdGaWxlSW5mbyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuICdvdmVyd3JpdGUnO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gY2hlY2tGb3JEdXBsaWNhdGVEYXRhKFxuICAgIGluY29taW5nRmlsZTogVXBkYXRlZEZpbGVJbmZvLFxuICAgIGV4aXN0aW5nRmlsZTogRXhpc3RpbmdGaWxlSW5mb1xuKTogJ3NraXAnIHwgJ3JlbmFtZScgfCAnb3ZlcndyaXRlJyB7XG4gICAgY29uc3QgY3VycmVudERhdGUgPSBuZXcgRGF0ZSgpO1xuXG4gICAgLy8gTm9ybWFsaXplIGRhdGVzIGZvciBpbmNvbWluZyBmaWxlXG4gICAgY29uc3QgaW5jb21pbmdVcGRhdGVkRGF0ZSA9IGluY29taW5nRmlsZS51cGRhdGVkRGF0ZSB8fCBjdXJyZW50RGF0ZTtcblxuICAgIC8vIE5vcm1hbGl6ZSBkYXRlcyBmb3IgZXhpc3RpbmcgZmlsZVxuICAgIGNvbnN0IGV4aXN0aW5nVXBkYXRlZERhdGUgPSBleGlzdGluZ0ZpbGUuZnNVcGRhdGVkRGF0ZSB8fCBleGlzdGluZ0ZpbGUudXBkYXRlZERhdGUgfHwgZXhpc3RpbmdGaWxlLmZzQ3JlYXRlZERhdGU7XG4gICAgY29uc3QgbGFzdFN5bmNlZERhdGUgPSBleGlzdGluZ0ZpbGUubGFzdFN5bmNlZERhdGUgfHwgZXhpc3RpbmdGaWxlLmZzQ3JlYXRlZERhdGU7XG5cbiAgICAvLyBTdGVwIDE6IENoZWNrIGlmIHRoZSBjb250ZW50cyBhcmUgZXhhY3RseSB0aGUgc2FtZVxuICAgIGlmIChpbmNvbWluZ0ZpbGUuY29udGVudCA9PT0gZXhpc3RpbmdGaWxlLmNvbnRlbnQpIHtcbiAgICAgICAgcmV0dXJuICdza2lwJztcbiAgICB9XG5cbiAgICAvLyBTdGVwIDI6IElmIGxhc3RTeW5jZWREYXRlIGV4aXN0cywgdXNlIGl0IHRvIGRldGVybWluZSBpZiBib3RoIGZpbGVzIGhhdmUgYmVlbiBtb2RpZmllZFxuICAgIGlmIChsYXN0U3luY2VkRGF0ZSAmJiBleGlzdGluZ1VwZGF0ZWREYXRlKSB7XG4gICAgICAgIGNvbnN0IGluY29taW5nTW9kaWZpZWQgPSBpbmNvbWluZ1VwZGF0ZWREYXRlID4gbGFzdFN5bmNlZERhdGU7XG4gICAgICAgIGNvbnN0IGV4aXN0aW5nTW9kaWZpZWQgPSBleGlzdGluZ1VwZGF0ZWREYXRlID4gbGFzdFN5bmNlZERhdGU7XG5cbiAgICAgICAgaWYgKGluY29taW5nTW9kaWZpZWQgJiYgZXhpc3RpbmdNb2RpZmllZCkge1xuICAgICAgICAgICAgcmV0dXJuICdyZW5hbWUnOyAgLy8gQm90aCBzaWRlcyBoYXZlIGJlZW4gZWRpdGVkIHNpbmNlIGxhc3Qgc3luYywgc28gd2UgcmVuYW1lXG4gICAgICAgIH1cblxuICAgICAgICBpZiAoaW5jb21pbmdNb2RpZmllZCAmJiAhZXhpc3RpbmdNb2RpZmllZCkge1xuICAgICAgICAgICAgcmV0dXJuICdvdmVyd3JpdGUnOyAgLy8gT25seSBpbmNvbWluZyBmaWxlIGhhcyBiZWVuIG1vZGlmaWVkIHNpbmNlIGxhc3Qgc3luY1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFpbmNvbWluZ01vZGlmaWVkICYmIGV4aXN0aW5nTW9kaWZpZWQpIHtcbiAgICAgICAgICAgIHJldHVybiAncmVuYW1lJzsgIC8vIE9ubHkgZXhpc3RpbmcgZmlsZSBoYXMgYmVlbiBtb2RpZmllZCBzaW5jZSBsYXN0IHN5bmNcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIElmIG5laXRoZXIgZmlsZSBoYXMgYmVlbiBtb2RpZmllZCBzaW5jZSBsYXN0IHN5bmMgKHNob3VsZG4ndCBoYXBwZW4gaWYgY29udGVudHMgZGlmZmVyLCBidXQganVzdCBpbiBjYXNlKVxuICAgICAgICByZXR1cm4gJ3NraXAnO1xuICAgIH1cblxuICAgIC8vIFN0ZXAgMzogSWYgbGFzdFN5bmNlZERhdGUgZG9lc24ndCBleGlzdCBvciBjb3VsZG4ndCBiZSBub3JtYWxpemVkLCBmYWxsIGJhY2sgdG8gY29tcGFyaW5nIGRhdGVzXG4gICAgaWYgKGV4aXN0aW5nVXBkYXRlZERhdGUpIHtcbiAgICAgICAgaWYgKGluY29taW5nVXBkYXRlZERhdGUgPiBleGlzdGluZ1VwZGF0ZWREYXRlKSB7XG4gICAgICAgICAgICByZXR1cm4gJ292ZXJ3cml0ZSc7XG4gICAgICAgIH0gZWxzZSBpZiAoaW5jb21pbmdVcGRhdGVkRGF0ZSA8IGV4aXN0aW5nVXBkYXRlZERhdGUpIHtcbiAgICAgICAgICAgIHJldHVybiAncmVuYW1lJztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIElmIGRhdGVzIGFyZSBlcXVhbCwgd2UgY2FuJ3QgZGV0ZXJtaW5lIHdoaWNoIGlzIG5ld2VyLCBzbyB3ZSByZW5hbWUgdG8gYmUgc2FmZVxuICAgICAgICAgICAgcmV0dXJuICdyZW5hbWUnO1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuICdyZW5hbWUnO1xuICAgIH1cbn1cblxuZXhwb3J0IHtub3JtYWxpemVEYXRlLCBoYW5kbGVEdXBsaWNhdGVOb3RlcywgY2hlY2tGb3JEdXBsaWNhdGVEYXRhLCBnZXRFeGlzdGluZ0ZpbGVJbmZvLCBnZXRVcGRhdGVkRmlsZUluZm8gfTsiLCAiLy8gYXR0YWNobWVudHMudHNcbmltcG9ydCBLZWVwU2lkaWFuUGx1Z2luIGZyb20gJ21haW4nO1xuaW1wb3J0IHsgcmVxdWVzdFVybCB9IGZyb20gJ29ic2lkaWFuJztcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHByb2Nlc3NBdHRhY2htZW50cyhwbHVnaW46IEtlZXBTaWRpYW5QbHVnaW4sIGJsb2JVcmxzOiBzdHJpbmdbXSwgc2F2ZUxvY2F0aW9uOiBzdHJpbmcpIHtcbiAgICBmb3IgKGNvbnN0IGJsb2JfdXJsIG9mIGJsb2JVcmxzKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSBVUkwgZm9ybWF0XG4gICAgICAgICAgICBsZXQgdXJsO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB1cmwgPSBuZXcgVVJMKGJsb2JfdXJsKTtcbiAgICAgICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEludmFsaWQgVVJMIGZvcm1hdDogJHtibG9iX3VybH1gKTtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgYmxvYlJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdFVybCh7XG4gICAgICAgICAgICAgICAgdXJsOiBibG9iX3VybCxcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjb25zdCBibG9iRGF0YSA9IGF3YWl0IGJsb2JSZXNwb25zZS5hcnJheUJ1ZmZlcjtcbiAgICAgICAgICAgIGNvbnN0IGJsb2JGaWxlTmFtZSA9IHVybC5wYXRobmFtZS5zcGxpdCgnLycpLnBvcCgpO1xuICAgICAgICAgICAgaWYgKGJsb2JGaWxlTmFtZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGJsb2JGaWxlUGF0aCA9IGAke3NhdmVMb2NhdGlvbn0vbWVkaWEvJHtibG9iRmlsZU5hbWV9YDtcbiAgICAgICAgICAgICAgICBhd2FpdCBwbHVnaW4uYXBwLnZhdWx0LmFkYXB0ZXIud3JpdGVCaW5hcnkoYmxvYkZpbGVQYXRoLCBibG9iRGF0YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIGRvd25sb2FkIGJsb2IgZnJvbSAke2Jsb2JfdXJsfS5gKTtcbiAgICAgICAgfVxuICAgIH1cbn0iLCAiZXhwb3J0IGludGVyZmFjZSBTdWJzY3JpcHRpb25JbmZvIHtcbiAgc3Vic2NyaXB0aW9uX3N0YXR1czogJ2FjdGl2ZScgfCAnaW5hY3RpdmUnIHwgJ2V4cGlyZWQnO1xuICBwbGFuX2RldGFpbHM6IHtcbiAgICBwbGFuX2lkOiBzdHJpbmc7XG4gICAgZmVhdHVyZXM6IHN0cmluZ1tdO1xuICB9O1xuICBtZXRlcmluZ19pbmZvOiB7XG4gICAgdXNhZ2U6IG51bWJlcjtcbiAgICBsaW1pdDogbnVtYmVyO1xuICB9O1xuICB0cmlhbF9vcl9wcm9tbzogYW55O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFN1YnNjcmlwdGlvbkNhY2hlIHtcbiAgaW5mbzogU3Vic2NyaXB0aW9uSW5mbztcbiAgdGltZXN0YW1wOiBudW1iZXI7XG4gIGVtYWlsOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU3Vic2NyaXB0aW9uU3RhdHVzIHtcbiAgICBpc0FjdGl2ZTogYm9vbGVhbjtcbiAgICBleHBpcmVzQXQ/OiBEYXRlO1xuICAgIHBsYW4/OiAnYmFzaWMnIHwgJ3ByZW1pdW0nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFByZW1pdW1GZWF0dXJlU2V0dGluZ3Mge1xuICAgIGF1dG9TeW5jOiBib29sZWFuO1xuICAgIHN5bmNJbnRlcnZhbE1pbnV0ZXM6IG51bWJlcjtcbiAgICBpbmNsdWRlTm90ZXNUZXJtczogc3RyaW5nW107XG4gICAgZXhjbHVkZU5vdGVzVGVybXM6IHN0cmluZ1tdO1xuICAgIHVwZGF0ZVRpdGxlOiBib29sZWFuO1xuICAgIHN1Z2dlc3RUYWdzOiBib29sZWFuO1xuICAgIG1heFRhZ3M6IG51bWJlcjtcbiAgICB0YWdQcmVmaXg6IHN0cmluZztcbiAgICBsaW1pdFRvRXhpc3RpbmdUYWdzOiBib29sZWFuO1xufSBcblxuZXhwb3J0IGNvbnN0IERFRkFVTFRfUFJFTUlVTV9GRUFUVVJFUzogUHJlbWl1bUZlYXR1cmVTZXR0aW5ncyA9IHtcbiAgICBhdXRvU3luYzogZmFsc2UsXG4gICAgc3luY0ludGVydmFsTWludXRlczogNSxcbiAgICBpbmNsdWRlTm90ZXNUZXJtczogW10sXG4gICAgZXhjbHVkZU5vdGVzVGVybXM6IFtdLFxuICAgIHVwZGF0ZVRpdGxlOiBmYWxzZSxcbiAgICBzdWdnZXN0VGFnczogZmFsc2UsXG4gICAgbWF4VGFnczogNSxcbiAgICB0YWdQcmVmaXg6ICcnLFxuICAgIGxpbWl0VG9FeGlzdGluZ1RhZ3M6IGZhbHNlXG59IiwgImltcG9ydCB7IERFRkFVTFRfUFJFTUlVTV9GRUFUVVJFUywgUHJlbWl1bUZlYXR1cmVTZXR0aW5ncywgU3Vic2NyaXB0aW9uQ2FjaGUgfSBmcm9tICcuL3N1YnNjcmlwdGlvbic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgS2VlcFNpZGlhblBsdWdpblNldHRpbmdzIHtcblx0ZW1haWw6IHN0cmluZztcblx0dG9rZW46IHN0cmluZztcblx0c2F2ZUxvY2F0aW9uOiBzdHJpbmc7XG5cdHN1YnNjcmlwdGlvbkNhY2hlPzogU3Vic2NyaXB0aW9uQ2FjaGU7XG5cdHByZW1pdW1GZWF0dXJlczogUHJlbWl1bUZlYXR1cmVTZXR0aW5ncztcblx0Z2RyaXZlVG9rZW4/OiBzdHJpbmc7XG5cdGdkcml2ZVJlZnJlc2hUb2tlbj86IHN0cmluZztcblx0Z2RyaXZlU2F2ZUxvY2F0aW9uPzogc3RyaW5nO1xufVxuXG5leHBvcnQgY29uc3QgREVGQVVMVF9TRVRUSU5HUzogS2VlcFNpZGlhblBsdWdpblNldHRpbmdzID0ge1xuXHRlbWFpbDogJycsXG5cdHRva2VuOiAnJyxcblx0c2F2ZUxvY2F0aW9uOiAnR29vZ2xlIEtlZXAnLFxuXHRzdWJzY3JpcHRpb25DYWNoZTogdW5kZWZpbmVkLFxuXHRwcmVtaXVtRmVhdHVyZXM6IERFRkFVTFRfUFJFTUlVTV9GRUFUVVJFUyxcblx0Z2RyaXZlVG9rZW46IHVuZGVmaW5lZCxcblx0Z2RyaXZlUmVmcmVzaFRva2VuOiB1bmRlZmluZWQsXG5cdGdkcml2ZVNhdmVMb2NhdGlvbjogdW5kZWZpbmVkXG59XG5cblxuIiwgImltcG9ydCB7IFNldHRpbmcgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBLZWVwU2lkaWFuUGx1Z2luIGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBQcmVtaXVtRmVhdHVyZVNldHRpbmdzIH0gZnJvbSBcInR5cGVzL3N1YnNjcmlwdGlvblwiO1xuaW1wb3J0IHsgS0VFUFNJRElBTl9TRVJWRVJfVVJMIH0gZnJvbSAnLi4vY29uZmlnJztcblxuZXhwb3J0IGNsYXNzIFN1YnNjcmlwdGlvblNldHRpbmdzVGFiIHtcbiAgICBwcml2YXRlIGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudDtcbiAgICBwcml2YXRlIHBsdWdpbjogS2VlcFNpZGlhblBsdWdpbjtcblxuICAgIGNvbnN0cnVjdG9yKGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCwgcGx1Z2luOiBLZWVwU2lkaWFuUGx1Z2luKSB7XG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwgPSBjb250YWluZXJFbDtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgfVxuXG4gICAgYXN5bmMgZGlzcGxheSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcblxuICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbCgnaDMnLCB7IHRleHQ6ICdQcmVtaXVtIEZlYXR1cmVzJyB9KTtcbiAgICAgICAgXG4gICAgICAgIC8vIEdlbmVyYWwgaW5mbyBhYm91dCBwcmVtaXVtIGZlYXR1cmVzXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ1ByZW1pdW0gRmVhdHVyZXMnKVxuICAgICAgICAgICAgLnNldERlc2MoJ0dldCBhY2Nlc3MgdG8gYWR2YW5jZWQgZmVhdHVyZXMgbGlrZSB0d28td2F5IHN5bmMsIHRpdGxlIHN1Z2dlc3Rpb25zLCBhbmQgYXV0b21hdGljIHRhZyBjcmVhdGlvbi4nKVxuICAgICAgICAgICAgLmFkZEV4dHJhQnV0dG9uKGJ1dHRvbiA9PiBidXR0b25cbiAgICAgICAgICAgICAgICAuc2V0SWNvbigncmVmcmVzaCcpXG4gICAgICAgICAgICAgICAgLnNldFRvb2x0aXAoJ0NoZWNrIHN1YnNjcmlwdGlvbiBzdGF0dXMnKVxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVE9ETzogSW1wbGVtZW50IHJlZnJlc2ggc3Vic2NyaXB0aW9uIGNoZWNrXG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFhd2FpdCB0aGlzLnBsdWdpbi5zdWJzY3JpcHRpb25TZXJ2aWNlLmlzU3Vic2NyaXB0aW9uQWN0aXZlKCkpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuZGlzcGxheUluYWN0aXZlU3Vic2NyaWJlcigpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5kaXNwbGF5QWN0aXZlU3Vic2NyaWJlcigpO1xuICAgICAgICAgICAgYXdhaXQgU3Vic2NyaXB0aW9uU2V0dGluZ3NUYWIuZGlzcGxheVByZW1pdW1GZWF0dXJlcyhjb250YWluZXJFbCwgdGhpcy5wbHVnaW4pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgc3RhdGljIGFzeW5jIGRpc3BsYXlQcmVtaXVtRmVhdHVyZXMoY29udGFpbmVyRWw6IEhUTUxFbGVtZW50LCBwbHVnaW46IEtlZXBTaWRpYW5QbHVnaW4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgYXdhaXQgdGhpcy5kaXNwbGF5UHJlbWl1bUZlYXR1cmVzTG9jYWwoY29udGFpbmVyRWwsIHBsdWdpbiwgcGx1Z2luLnNldHRpbmdzLnByZW1pdW1GZWF0dXJlcyk7XG4gICAgICAgIGF3YWl0IHRoaXMuZGlzcGxheVByZW1pdW1GZWF0dXJlc1NlcnZlcihjb250YWluZXJFbCwgcGx1Z2luLCBwbHVnaW4uc2V0dGluZ3MucHJlbWl1bUZlYXR1cmVzKTtcbiAgICB9XG5cbiAgICBzdGF0aWMgYXN5bmMgZGlzcGxheVByZW1pdW1GZWF0dXJlc0xvY2FsKGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCwgcGx1Z2luOiBLZWVwU2lkaWFuUGx1Z2luLCBwcmVtaXVtRmVhdHVyZVZhbHVlczogUHJlbWl1bUZlYXR1cmVTZXR0aW5ncyk6IFByb21pc2U8dm9pZD4ge1xuXG4gICAgICAgIC8vIDMuMSBBdXRvIFN5bmNcbiAgICAgICAgLy8gVE9ETzogSW1wbGVtZW50IGF1dG8gc3luY1xuICAgICAgICAvKiBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdBdXRvIFN5bmMnKVxuICAgICAgICAgICAgLnNldERlc2MoJ0F1dG9tYXRpY2FsbHkgc3luYyB5b3VyIG5vdGVzIGF0IHJlZ3VsYXIgaW50ZXJ2YWxzJylcbiAgICAgICAgICAgIC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZShwcmVtaXVtRmVhdHVyZVZhbHVlcy5hdXRvU3luYylcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHByZW1pdW1GZWF0dXJlVmFsdWVzLmF1dG9TeW5jID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIC8vIFRPRE86IFNhdmUgc2V0dGluZ3NcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnU3luYyBJbnRlcnZhbCcpXG4gICAgICAgICAgICAuc2V0RGVzYygnSG93IG9mdGVuIHRvIHN5bmMgKGluIG1pbnV0ZXMpJylcbiAgICAgICAgICAgIC5hZGRTbGlkZXIoc2xpZGVyID0+IHNsaWRlclxuICAgICAgICAgICAgICAgIC5zZXRMaW1pdHMoNSwgMTIwLCA1KVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZShwcmVtaXVtRmVhdHVyZVZhbHVlcy5zeW5jSW50ZXJ2YWxNaW51dGVzKVxuICAgICAgICAgICAgICAgIC5zZXREeW5hbWljVG9vbHRpcCgpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBwcmVtaXVtRmVhdHVyZVZhbHVlcy5zeW5jSW50ZXJ2YWxNaW51dGVzID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIC8vIFRPRE86IFNhdmUgc2V0dGluZ3NcbiAgICAgICAgICAgICAgICB9KSlcbiAgICAgICAgICAgIC5zZXREaXNhYmxlZCghcHJlbWl1bUZlYXR1cmVWYWx1ZXMuYXV0b1N5bmMpOyAqL1xuICAgIH1cblxuICAgIHN0YXRpYyBhc3luYyBkaXNwbGF5UHJlbWl1bUZlYXR1cmVzU2VydmVyKGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCwgcGx1Z2luOiBLZWVwU2lkaWFuUGx1Z2luLCBwcmVtaXVtRmVhdHVyZVZhbHVlczogUHJlbWl1bUZlYXR1cmVTZXR0aW5ncyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICAvLyAzLjIgRmlsdGVyIE5vdGVzXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ09ubHkgaW5jbHVkZSBub3RlcyBjb250YWluaW5nJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdUZXJtcyB0byBpbmNsdWRlIChjb21tYS1zZXBhcmF0ZWQpLicpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ3Rlcm0xLCB0ZXJtMiwgLi4uJylcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUocHJlbWl1bUZlYXR1cmVWYWx1ZXMuaW5jbHVkZU5vdGVzVGVybXMuam9pbignLCAnKSlcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHByZW1pdW1GZWF0dXJlVmFsdWVzLmluY2x1ZGVOb3Rlc1Rlcm1zID0gdmFsdWUuc3BsaXQoJywnKS5tYXAoayA9PiBrLnRyaW0oKSkuZmlsdGVyKGsgPT4gayk7XG4gICAgICAgICAgICAgICAgICAgIC8vIFRPRE86IFNhdmUgc2V0dGluZ3NcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnRXhjbHVkZSBub3RlcyBjb250YWluaW5nJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdUZXJtcyB0byBza2lwIChjb21tYS1zZXBhcmF0ZWQpLicpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ3Rlcm0xLCB0ZXJtMiwgLi4uJylcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUocHJlbWl1bUZlYXR1cmVWYWx1ZXMuZXhjbHVkZU5vdGVzVGVybXMuam9pbignLCAnKSlcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHByZW1pdW1GZWF0dXJlVmFsdWVzLmV4Y2x1ZGVOb3Rlc1Rlcm1zID0gdmFsdWUuc3BsaXQoJywnKS5tYXAoayA9PiBrLnRyaW0oKSkuZmlsdGVyKGsgPT4gayk7XG4gICAgICAgICAgICAgICAgICAgIC8vIFRPRE86IFNhdmUgc2V0dGluZ3NcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgLy8gMy4zIFRpdGxlIFVwZGF0ZXNcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnU21hcnQgVGl0bGVzJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdTdWdnZXN0IHRpdGxlcyBiYXNlZCBvbiBub3RlIGNvbnRlbnQuIE9yaWdpbmFsIHRpdGxlIHdpbGwgYmUgc2F2ZWQgaW4gbm90ZS4nKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHByZW1pdW1GZWF0dXJlVmFsdWVzLnVwZGF0ZVRpdGxlKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcHJlbWl1bUZlYXR1cmVWYWx1ZXMudXBkYXRlVGl0bGUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgLy8gVE9ETzogU2F2ZSBzZXR0aW5nc1xuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICAvLyAzLjQgVGFnIFN1Z2dlc3Rpb25zXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ0F1dG8tVGFncycpXG4gICAgICAgICAgICAuc2V0RGVzYygnR2VuZXJhdGUgdGFncyBiYXNlZCBvbiBub3RlIGNvbnRlbnQuJylcbiAgICAgICAgICAgIC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZShwcmVtaXVtRmVhdHVyZVZhbHVlcy5zdWdnZXN0VGFncylcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHByZW1pdW1GZWF0dXJlVmFsdWVzLnN1Z2dlc3RUYWdzID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIC8vIFRPRE86IFNhdmUgc2V0dGluZ3NcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnTWF4aW11bSB0YWdzJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdNYXhpbXVtIG51bWJlciBvZiB0YWdzIHRvIGdlbmVyYXRlLicpXG4gICAgICAgICAgICAuYWRkU2xpZGVyKHNsaWRlciA9PiBzbGlkZXJcbiAgICAgICAgICAgICAgICAuc2V0TGltaXRzKDEsIDEwLCAxKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZShwcmVtaXVtRmVhdHVyZVZhbHVlcy5tYXhUYWdzKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcHJlbWl1bUZlYXR1cmVWYWx1ZXMubWF4VGFncyA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIH0pKVxuICAgICAgICAuc2V0RGlzYWJsZWQoIXByZW1pdW1GZWF0dXJlVmFsdWVzLnN1Z2dlc3RUYWdzKTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdUYWcgcHJlZml4JylcbiAgICAgICAgICAgIC5zZXREZXNjKCdQcmVmaXggdG8gaWRlbnRpZnkgZ2VuZXJhdGVkIHRhZ3MgKGxlYXZlIGVtcHR5IGZvciBub25lKS4nKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHByZW1pdW1GZWF0dXJlVmFsdWVzLnRhZ1ByZWZpeClcbiAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ2F1dG8tJylcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHByZW1pdW1GZWF0dXJlVmFsdWVzLnRhZ1ByZWZpeCA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAvLyBUT0RPOiBTYXZlIHNldHRpbmdzXG4gICAgICAgICAgICAgICAgfSkpXG4gICAgICAgICAgICAuc2V0RGlzYWJsZWQoIXByZW1pdW1GZWF0dXJlVmFsdWVzLnN1Z2dlc3RUYWdzKTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdMaW1pdCB0byBleGlzdGluZyB0YWdzJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdPbmx5IGdlbmVyYXRlIHRhZ3MgdGhhdCBhbHJlYWR5IGV4aXN0IGluIHlvdXIgdmF1bHQuJylcbiAgICAgICAgICAgIC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZShwcmVtaXVtRmVhdHVyZVZhbHVlcy5saW1pdFRvRXhpc3RpbmdUYWdzKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcHJlbWl1bUZlYXR1cmVWYWx1ZXMubGltaXRUb0V4aXN0aW5nVGFncyA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAvLyBUT0RPOiBTYXZlIHNldHRpbmdzXG4gICAgICAgICAgICAgICAgfSkpXG4gICAgICAgICAgICAuc2V0RGlzYWJsZWQoIXByZW1pdW1GZWF0dXJlVmFsdWVzLnN1Z2dlc3RUYWdzKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIGRpc3BsYXlJbmFjdGl2ZVN1YnNjcmliZXIoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG5cbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoJ2g0JywgeyB0ZXh0OiAnV2h5IFN1YnNjcmliZT8nIH0pO1xuXG4gICAgICAgIGNvbnN0IGJlbmVmaXRzTGlzdCA9IGNvbnRhaW5lckVsLmNyZWF0ZUVsKCd1bCcsIHsgYXR0cjogeyBzdHlsZTogJ2ZvbnQtc2l6ZTogMC45ZW0nIH0gfSk7XG4gICAgICAgIFtcbiAgICAgICAgICAgICdTbWFydCBUaXRsZXM6IEF1dG8tc3VnZ2VzdGlvbnMgZnJvbSBub3RlIGNvbnRlbnQuJyxcbiAgICAgICAgICAgICdBdXRvLVRhZ3M6IEluc3RhbnQgdGFnIGdlbmVyYXRpb24gJiBtYW5hZ2VtZW50LicsXG4gICAgICAgICAgICAnQWR2YW5jZWQgRmlsdGVyczogU3luYyBvbmx5IHdoYXQgeW91IG5lZWQuJyxcbiAgICAgICAgICAgICdQcmlvcml0eSBTdXBwb3J0OiBZb3VyIHF1ZXN0aW9ucyBhbnN3ZXJlZCBmaXJzdC4nLFxuICAgICAgICAgICAgJ1R3by1XYXkgU3luYzogS2VlcCBub3RlcyB1cGRhdGVkLCBDb21pbmcgc29vbi4nLFxuICAgICAgICAgICAgJ0Vhcmx5IEFjY2VzczogRmlyc3QgdG8gZ2V0IG5ldyBmZWF0dXJlcy4nLFxuICAgICAgICAgICAgJ0FuZCBtb3JlISdcbiAgICAgICAgXS5mb3JFYWNoKGJlbmVmaXQgPT4ge1xuICAgICAgICAgICAgY29uc3QgbGkgPSBiZW5lZml0c0xpc3QuY3JlYXRlRWwoJ2xpJyk7XG4gICAgICAgICAgICBjb25zdCBbdGl0bGUsIGRlc2NyaXB0aW9uXSA9IGJlbmVmaXQuc3BsaXQoJzonKTtcbiAgICAgICAgICAgIGlmIChkZXNjcmlwdGlvbikge1xuICAgICAgICAgICAgICAgIGxpLmNyZWF0ZVNwYW4oe3RleHQ6IHRpdGxlLCBhdHRyOiB7c3R5bGU6ICdmb250LXdlaWdodDogYm9sZCd9fSk7XG4gICAgICAgICAgICAgICAgbGkuY3JlYXRlU3Bhbih7dGV4dDogJzonICsgZGVzY3JpcHRpb259KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbGkuY3JlYXRlU3Bhbih7dGV4dDogYmVuZWZpdH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdTdWJzY3JpYmUgTm93JylcbiAgICAgICAgICAgIC5zZXREZXNjKCdHZXQgYWNjZXNzIHRvIGFsbCBwcmVtaXVtIGZlYXR1cmVzJylcbiAgICAgICAgICAgIC5hZGRCdXR0b24oYnV0dG9uID0+IGJ1dHRvblxuICAgICAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KCdTdWJzY3JpYmUnKVxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgd2luZG93Lm9wZW4oYCR7S0VFUFNJRElBTl9TRVJWRVJfVVJMfS9zdWJzY3JpYmVgLCAnX2JsYW5rJyk7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgZGlzcGxheUFjdGl2ZVN1YnNjcmliZXIoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG4gICAgICAgIGNvbnN0IHN1YnNjcmlwdGlvbkluZm8gPSBhd2FpdCB0aGlzLnBsdWdpbi5zdWJzY3JpcHRpb25TZXJ2aWNlLmNoZWNrU3Vic2NyaXB0aW9uKCk7XG5cbiAgICAgICAgLy8gU2hvdyBzdWJzY3JpcHRpb24gZGV0YWlsc1xuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdTdWJzY3JpcHRpb24gU3RhdHVzJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdBY3RpdmUnKVxuICAgICAgICAgICAgLnNldENsYXNzKCdzdWJzY3JpcHRpb24tYWN0aXZlJyk7XG5cbiAgICAgICAgaWYgKHN1YnNjcmlwdGlvbkluZm8/LnBsYW5fZGV0YWlscykge1xuICAgICAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAgICAgLnNldE5hbWUoJ1BsYW4nKVxuICAgICAgICAgICAgICAgIC5zZXREZXNjKHN1YnNjcmlwdGlvbkluZm8ucGxhbl9kZXRhaWxzLnBsYW5faWQpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHN1YnNjcmlwdGlvbkluZm8/Lm1ldGVyaW5nX2luZm8pIHtcbiAgICAgICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgICAgIC5zZXROYW1lKCdVc2FnZScpXG4gICAgICAgICAgICAgICAgLnNldERlc2MoYCR7c3Vic2NyaXB0aW9uSW5mby5tZXRlcmluZ19pbmZvLnVzYWdlfSAvICR7c3Vic2NyaXB0aW9uSW5mby5tZXRlcmluZ19pbmZvLmxpbWl0fSBub3RlcyBzeW5jZWRgKTtcbiAgICAgICAgfVxuICAgIH1cbn0gIiwgImltcG9ydCAqIGFzIG9ic2lkaWFuIGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IEtlZXBTaWRpYW5TZXR0aW5nc1RhYiB9IGZyb20gJy4uLy4uL2NvbXBvbmVudHMvS2VlcFNpZGlhblNldHRpbmdzVGFiJztcbmltcG9ydCBLZWVwU2lkaWFuUGx1Z2luIGZyb20gJ21haW4nO1xuaW1wb3J0IHsgS0VFUFNJRElBTl9TRVJWRVJfVVJMIH0gZnJvbSAnLi4vLi4vY29uZmlnJztcbmltcG9ydCB7IFdlYnZpZXdUYWcsIENvbnNvbGVNZXNzYWdlRXZlbnQgfSBmcm9tICdlbGVjdHJvbic7XG5pbXBvcnQgeyBOb3RpY2UgfSBmcm9tICdvYnNpZGlhbic7XG5cbmRlY2xhcmUgZ2xvYmFsIHtcbiAgICBpbnRlcmZhY2UgV2luZG93IHtcbiAgICAgICAgcmVxdWlyZTogKG1vZHVsZTogc3RyaW5nKSA9PiBhbnk7XG4gICAgfVxufVxuXG5jb25zdCBzYW5pdGl6ZUlucHV0ID0gKGlucHV0OiBzdHJpbmcpOiBzdHJpbmcgPT4ge1xuICAgIHJldHVybiBpbnB1dC5yZXBsYWNlKC9bPD5cIicmXS9nLCAoY2hhcikgPT4ge1xuICAgICAgICBjb25zdCBlbnRpdGllczogeyBba2V5OiBzdHJpbmddOiBzdHJpbmcgfSA9IHtcbiAgICAgICAgICAgICc8JzogJyZsdDsnLFxuICAgICAgICAgICAgJz4nOiAnJmd0OycsXG4gICAgICAgICAgICAnXCInOiAnJnF1b3Q7JyxcbiAgICAgICAgICAgIFwiJ1wiOiAnJiMzOTsnLFxuICAgICAgICAgICAgJyYnOiAnJmFtcDsnXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBlbnRpdGllc1tjaGFyXTtcbiAgICB9KTtcbn07XG5cbmNvbnN0IHNhbml0aXplRm9ySlMgPSAoaW5wdXQ6IHN0cmluZyk6IHN0cmluZyA9PiB7XG4gICAgcmV0dXJuIGlucHV0LnJlcGxhY2UoL1tcXFxcXCInXS9nLCAnXFxcXCQmJylcbiAgICAgICAgICAgICAgICAucmVwbGFjZSgvXFwwL2csICdcXFxcMCcpXG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoL1xcbi9nLCAnXFxcXG4nKVxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKC9cXHIvZywgJ1xcXFxyJyk7XG59O1xuXG5pbnRlcmZhY2UgVG9rZW5SZXNwb25zZSB7XG4gICAga2VlcF90b2tlbjogc3RyaW5nO1xuICAgIFtrZXk6IHN0cmluZ106IGFueTtcbn1cblxuZnVuY3Rpb24gaXNUb2tlblJlc3BvbnNlKG9iajogYW55KTogb2JqIGlzIFRva2VuUmVzcG9uc2Uge1xuICAgIHJldHVybiB0eXBlb2Ygb2JqID09PSAnb2JqZWN0JyAmJiBvYmogIT09IG51bGwgJiYgdHlwZW9mIG9iai5rZWVwX3Rva2VuID09PSAnc3RyaW5nJztcbn1cblxuYXN5bmMgZnVuY3Rpb24gZ2V0T0F1dGhUb2tlbihzZXR0aW5nc1RhYjogS2VlcFNpZGlhblNldHRpbmdzVGFiLCBwbHVnaW46IEtlZXBTaWRpYW5QbHVnaW4sIHJldHJpZXZlVG9rZW5XZWJ2aWV3OiBXZWJ2aWV3VGFnKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICBjb25zdCBPQVVUSF9VUkwgPSBcImh0dHBzOi8vYWNjb3VudHMuZ29vZ2xlLmNvbS9FbWJlZGRlZFNldHVwXCI7XG4gICAgY29uc3QgR09PR0xFX0VNQUlMID0gcGx1Z2luLnNldHRpbmdzLmVtYWlsO1xuXG4gICAgY29uc3QgY3JlYXRlQnV0dG9uQ2xpY2tEZXRlY3Rpb25TY3JpcHQgPSAoYnV0dG9uVGV4dDogc3RyaW5nW10pOiBzdHJpbmcgPT4gYFxuICAgICAgICAoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBjb25zdCBidXR0b24gPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2J1dHRvbicpKS5maW5kKGVsID0+IFxuICAgICAgICAgICAgICAgICR7YnV0dG9uVGV4dC5tYXAodGV4dCA9PiBgZWwudGV4dENvbnRlbnQuaW5jbHVkZXMoXCIke3RleHR9XCIpYCkuam9pbignIHx8ICcpfVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGlmIChidXR0b24pIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkZvdW5kIGJ1dHRvbi5cIik7XG4gICAgICAgICAgICAgICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gY29uc29sZS5sb2coXCJidXR0b25DbGlja2VkXCIpKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJCdXR0b24gbm90IGZvdW5kLlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkoKTtcbiAgICBgO1xuXG4gICAgY29uc3QgY3JlYXRlT3ZlcmxheVNjcmlwdCA9ICh0aXRsZTogc3RyaW5nLCBtZXNzYWdlOiBzdHJpbmcpOiBzdHJpbmcgPT4gYFxuICAgICAgICAoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBsZXQgb3ZlcmxheSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvYXV0aC1ndWlkZS1vdmVybGF5Jyk7XG4gICAgICAgICAgICBpZiAoIW92ZXJsYXkpIHtcbiAgICAgICAgICAgICAgICBvdmVybGF5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICAgICAgb3ZlcmxheS5pZCA9ICdvYXV0aC1ndWlkZS1vdmVybGF5JztcbiAgICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKG92ZXJsYXkuc3R5bGUsIHtcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICdmaXhlZCcsXG4gICAgICAgICAgICAgICAgICAgIHRvcDogJzEwcHgnLFxuICAgICAgICAgICAgICAgICAgICByaWdodDogJzEwcHgnLFxuICAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6ICdyZ2JhKDAsIDAsIDAsIDAuNyknLFxuICAgICAgICAgICAgICAgICAgICBjb2xvcjogJ3doaXRlJyxcbiAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogJzIwcHgnLFxuICAgICAgICAgICAgICAgICAgICBib3JkZXJSYWRpdXM6ICc1cHgnLFxuICAgICAgICAgICAgICAgICAgICB6SW5kZXg6ICcxMDAwMCdcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKG92ZXJsYXkpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHRpdGxlRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gzJyk7XG4gICAgICAgICAgICAgICAgdGl0bGVFbGVtZW50LmlkID0gJ29hdXRoLWd1aWRlLXRpdGxlJztcbiAgICAgICAgICAgICAgICBjb25zdCBtZXNzYWdlRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgICAgICAgICAgICAgICBtZXNzYWdlRWxlbWVudC5pZCA9ICdvYXV0aC1ndWlkZS1tZXNzYWdlJztcbiAgICAgICAgICAgICAgICBvdmVybGF5LmFwcGVuZENoaWxkKHRpdGxlRWxlbWVudCk7XG4gICAgICAgICAgICAgICAgb3ZlcmxheS5hcHBlbmRDaGlsZChtZXNzYWdlRWxlbWVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb2F1dGgtZ3VpZGUtdGl0bGUnKS50ZXh0Q29udGVudCA9ICcke3Nhbml0aXplSW5wdXQodGl0bGUpfSc7XG4gICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb2F1dGgtZ3VpZGUtbWVzc2FnZScpLnRleHRDb250ZW50ID0gJyR7c2FuaXRpemVJbnB1dChtZXNzYWdlKX0nO1xuICAgICAgICB9KSgpO1xuICAgIGA7XG5cbiAgICBjb25zdCBlbnRlckVtYWlsU2NyaXB0ID0gKGVtYWlsOiBzdHJpbmcpOiBzdHJpbmcgPT4gYFxuICAgICAgICAoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBjb25zdCBlbWFpbElucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaW5wdXRbdHlwZT1cImVtYWlsXCJdJyk7XG4gICAgICAgICAgICBpZiAoZW1haWxJbnB1dCkge1xuICAgICAgICAgICAgICAgIGVtYWlsSW5wdXQudmFsdWUgPSAnJHtzYW5pdGl6ZUZvckpTKHNhbml0aXplSW5wdXQoZW1haWwpKX0nO1xuICAgICAgICAgICAgICAgIGVtYWlsSW5wdXQuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ2lucHV0JywgeyBidWJibGVzOiB0cnVlIH0pKTtcbiAgICAgICAgICAgICAgICBlbWFpbElucHV0LmZvY3VzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKCk7XG4gICAgYDtcblxuICAgIGNvbnN0IGNyZWF0ZURldlRvb2xzSW5zdHJ1Y3Rpb25zU2NyaXB0ID0gKCk6IHN0cmluZyA9PiBgXG4gICAgICAgIChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNvbnN0IG92ZXJsYXkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb2F1dGgtZ3VpZGUtb3ZlcmxheScpO1xuICAgICAgICAgICAgaWYgKG92ZXJsYXkpIHtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb2F1dGgtZ3VpZGUtdGl0bGUnKS50ZXh0Q29udGVudCA9ICdTdGVwIDMgb2YgMzogSWRlbnRpZnkgdGhlIE9BdXRoIFRva2VuIGZyb20gRGV2ZWxvcGVyIFRvb2xzJztcbiAgICAgICAgICAgICAgICBjb25zdCBtZXNzYWdlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvYXV0aC1ndWlkZS1tZXNzYWdlJyk7XG4gICAgICAgICAgICAgICAgbWVzc2FnZUVsZW1lbnQudGV4dENvbnRlbnQgPSAnQWxtb3N0IHRoZXJlISBXZSB3aWxsIGxhdW5jaCB5b3VyIERldmVsb3BlciBUb29scyBtb21lbnRhcmlseS4gRm9sbG93IHRoZSBpbnN0cnVjdGlvbnMgYmVsb3cgdG8gZmluZCB0aGUgT0F1dGggVG9rZW4uJztcblxuICAgICAgICAgICAgICAgIGNvbnN0IG9sID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb2wnKTtcbiAgICAgICAgICAgICAgICBjb25zdCBpbnN0cnVjdGlvbnMgPSBbXG4gICAgICAgICAgICAgICAgICAgICdJbiB0aGUgRGV2ZWxvcGVyIFRvb2xzIHdpbmRvdywgbmF2aWdhdGUgdG8gdGhlIEFwcGxpY2F0aW9uIFRhYi4nLFxuICAgICAgICAgICAgICAgICAgICAnRXhwYW5kIHRoZSBDb29raWVzIFNlY3Rpb24gaW4gdGhlIGxlZnQgc2lkZWJhciBhbmQgY2xpY2sgZ29vZ2xlLmNvbS4nLFxuICAgICAgICAgICAgICAgICAgICAnRmluZCB0aGUgY29va2llIG5hbWVkIFwib2F1dGhfdG9rZW5cIiwgY2xpY2sgaXQsIGFuZCBjb3B5IGl0cyB2YWx1ZS4nLFxuICAgICAgICAgICAgICAgICAgICAnUGFzdGUgdGhlIHRva2VuIGludG8gdGhlIGZpZWxkIGJlbG93LidcbiAgICAgICAgICAgICAgICBdO1xuXG4gICAgICAgICAgICAgICAgaW5zdHJ1Y3Rpb25zLmZvckVhY2goaW5zdHJ1Y3Rpb24gPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG4gICAgICAgICAgICAgICAgICAgIGxpLnRleHRDb250ZW50ID0gaW5zdHJ1Y3Rpb247XG4gICAgICAgICAgICAgICAgICAgIG9sLmFwcGVuZENoaWxkKGxpKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIG1lc3NhZ2VFbGVtZW50LmFwcGVuZENoaWxkKG9sKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgICAgICAgICAgICAgICBpbnB1dC50eXBlID0gJ3RleHQnO1xuICAgICAgICAgICAgICAgIGlucHV0LnBsYWNlaG9sZGVyID0gJ1Bhc3RlIE9BdXRoIFRva2VuIGhlcmUnO1xuICAgICAgICAgICAgICAgIGlucHV0LnN0eWxlLndpZHRoID0gJzEwMCUnO1xuICAgICAgICAgICAgICAgIGlucHV0LnN0eWxlLm1hcmdpblRvcCA9ICcxMHB4JztcbiAgICAgICAgICAgICAgICBpbnB1dC5zdHlsZS5ib3JkZXIgPSAnMXB4IHNvbGlkICNjY2MnO1xuICAgICAgICAgICAgICAgIGlucHV0LnN0eWxlLmJvcmRlclJhZGl1cyA9ICc1cHgnO1xuICAgICAgICAgICAgICAgIGlucHV0LnN0eWxlLnBhZGRpbmcgPSAnNXB4JztcbiAgICAgICAgICAgICAgICBpbnB1dC5zdHlsZS5oZWlnaHQgPSAnMzBweCc7XG4gICAgICAgICAgICAgICAgaW5wdXQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJyNmMGYwZjAnO1xuICAgICAgICAgICAgICAgIGlucHV0LnN0eWxlLm9wYWNpdHkgPSAnMC43NSc7XG4gICAgICAgICAgICAgICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ29hdXRoVG9rZW46ICcgKyB0aGlzLnZhbHVlKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIG1lc3NhZ2VFbGVtZW50LmFwcGVuZENoaWxkKGlucHV0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkoKTtcbiAgICBgO1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlPHN0cmluZz4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICBsZXQgaW50ZXJ2YWxJZDogTm9kZUpTLlRpbWVvdXQgfCB1bmRlZmluZWQ7XG4gICAgICAgIGxldCBtZXNzYWdlSGFuZGxlcjogKChldmVudDogQ29uc29sZU1lc3NhZ2VFdmVudCkgPT4gdm9pZCkgfCB1bmRlZmluZWQ7XG4gICAgICAgIGxldCB0aW1lb3V0SWQ6IE5vZGVKUy5UaW1lb3V0IHwgdW5kZWZpbmVkO1xuXG4gICAgICAgIGNvbnN0IGNsZWFudXAgPSAoKSA9PiB7XG4gICAgICAgICAgICBpZiAoaW50ZXJ2YWxJZCkge1xuICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWxJZCk7XG4gICAgICAgICAgICAgICAgaW50ZXJ2YWxJZCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aW1lb3V0SWQpIHtcbiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dElkKTtcbiAgICAgICAgICAgICAgICB0aW1lb3V0SWQgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobWVzc2FnZUhhbmRsZXIgJiYgcmV0cmlldmVUb2tlbldlYnZpZXcpIHtcbiAgICAgICAgICAgICAgICByZXRyaWV2ZVRva2VuV2Vidmlldy5yZW1vdmVFdmVudExpc3RlbmVyKCdjb25zb2xlLW1lc3NhZ2UnLCBtZXNzYWdlSGFuZGxlcik7XG4gICAgICAgICAgICAgICAgbWVzc2FnZUhhbmRsZXIgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gRW5zdXJlIGNsZWFudXAgaGFwcGVucyBvbiBwcm9taXNlIHJlamVjdGlvblxuICAgICAgICBjb25zdCB3cmFwcGVkUmVqZWN0ID0gKGVycm9yOiBFcnJvcikgPT4ge1xuICAgICAgICAgICAgY2xlYW51cCgpO1xuICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgfTtcblxuICAgICAgICAoYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBpZiAoIXJldHJpZXZlVG9rZW5XZWJ2aWV3KSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGNyZWF0ZSB3ZWJ2aWV3IGVsZW1lbnQuJyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgYXdhaXQgcmV0cmlldmVUb2tlbldlYnZpZXcubG9hZFVSTChPQVVUSF9VUkwpO1xuICAgICAgICAgICAgICAgIHJldHJpZXZlVG9rZW5XZWJ2aWV3LnNob3coKTtcblxuICAgICAgICAgICAgICAgIGxldCBlbWFpbEVudGVyZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBsZXQgc3RlcFR3b0Rpc3BsYXllZCA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgbWVzc2FnZUhhbmRsZXIgPSBhc3luYyAoZXZlbnQ6IENvbnNvbGVNZXNzYWdlRXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50Lm1lc3NhZ2UgPT09ICdidXR0b25DbGlja2VkJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0cmlldmVUb2tlbldlYnZpZXcuZXhlY3V0ZUphdmFTY3JpcHQoY3JlYXRlRGV2VG9vbHNJbnN0cnVjdGlvbnNTY3JpcHQoKSk7XG4gICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXRyaWV2ZVRva2VuV2Vidmlldy5vcGVuRGV2VG9vbHMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXRyaWV2ZVRva2VuV2Vidmlldy5mb2N1cygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgMzAwMCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnQubWVzc2FnZS5zdGFydHNXaXRoKCdvYXV0aFRva2VuOiAnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgb2F1dGhUb2tlbiA9IGV2ZW50Lm1lc3NhZ2Uuc3BsaXQoJ29hdXRoVG9rZW46ICcpWzFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBleGNoYW5nZU9hdXRoVG9rZW4oc2V0dGluZ3NUYWIsIHBsdWdpbiwgb2F1dGhUb2tlbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xlYW51cCgpOyAvLyBFbnN1cmUgY2xlYW51cCBoYXBwZW5zIGJlZm9yZSByZXNvbHZpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXRyaWV2ZVRva2VuV2Vidmlldy5jbG9zZURldlRvb2xzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0cmlldmVUb2tlbldlYnZpZXcuaGlkZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUob2F1dGhUb2tlbik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdyYXBwZWRSZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHJldHJpZXZlVG9rZW5XZWJ2aWV3LmFkZEV2ZW50TGlzdGVuZXIoJ2NvbnNvbGUtbWVzc2FnZScsIG1lc3NhZ2VIYW5kbGVyKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG4gICAgICAgICAgICAgICAgY29uc3QgdGltZW91dCA9IDMwMDAwMDsgLy8gNSBtaW51dGVzIHRpbWVvdXRcblxuICAgICAgICAgICAgICAgIGludGVydmFsSWQgPSBzZXRJbnRlcnZhbChhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRVcmwgPSByZXRyaWV2ZVRva2VuV2Vidmlldy5nZXRVUkwoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFlbWFpbEVudGVyZWQgJiYgY3VycmVudFVybC5pbmNsdWRlcyhcImFjY291bnRzLmdvb2dsZS5jb21cIikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHJldHJpZXZlVG9rZW5XZWJ2aWV3LmV4ZWN1dGVKYXZhU2NyaXB0KGNyZWF0ZU92ZXJsYXlTY3JpcHQoXCJTdGVwIDEgb2YgMzogTG9naW4gQmVsb3cuXCIsIFwiUGxlYXNlIHN0YXJ0IGJ5IGxvZ2dpbmcgaW4gd2l0aCB5b3VyIEdvb2dsZSBLZWVwIGFjY291bnQgYmVsb3cuXCIpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHJldHJpZXZlVG9rZW5XZWJ2aWV3LmV4ZWN1dGVKYXZhU2NyaXB0KGVudGVyRW1haWxTY3JpcHQoR09PR0xFX0VNQUlMKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbWFpbEVudGVyZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGVtYWlsRW50ZXJlZCAmJiAhc3RlcFR3b0Rpc3BsYXllZCAmJiBjdXJyZW50VXJsLmluY2x1ZGVzKFwiZW1iZWRkZWRzaWduaW5jb25zZW50XCIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCByZXRyaWV2ZVRva2VuV2Vidmlldy5leGVjdXRlSmF2YVNjcmlwdChjcmVhdGVPdmVybGF5U2NyaXB0KFwiU3RlcCAyIG9mIDM6IEFjY2VwdCBTZXJ2aWNlIFRlcm1zLlwiLCBcIkdyZWF0ISBOZXh0LCBwbGVhc2UgcmV2aWV3IGFuZCBhZ3JlZSB0byB0aGUgdGVybXMgYmVsb3cuXCIpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCA1MDApKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHJldHJpZXZlVG9rZW5XZWJ2aWV3LmV4ZWN1dGVKYXZhU2NyaXB0KGNyZWF0ZUJ1dHRvbkNsaWNrRGV0ZWN0aW9uU2NyaXB0KFtcIkkgYWdyZWVcIiwgXCJBY2VwdG9cIl0pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0ZXBUd29EaXNwbGF5ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKChEYXRlLm5vdygpIC0gc3RhcnRUaW1lKSA+PSB0aW1lb3V0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3cmFwcGVkUmVqZWN0KG5ldyBFcnJvcignVGltZW91dDogT0F1dGggdG9rZW4gcmV0cmlldmFsIHByb2Nlc3MgZXhjZWVkZWQgNSBtaW51dGVzLicpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sIDEwMDApO1xuXG4gICAgICAgICAgICAgICAgdGltZW91dElkID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHdyYXBwZWRSZWplY3QobmV3IEVycm9yKCdUaW1lb3V0OiBPQXV0aCB0b2tlbiByZXRyaWV2YWwgcHJvY2VzcyBleGNlZWRlZCA1IG1pbnV0ZXMuJykpO1xuICAgICAgICAgICAgICAgIH0sIDMwMDAwMCk7XG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIHdyYXBwZWRSZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICBjbGVhbnVwKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKCk7XG4gICAgfSk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbml0UmV0cmlldmVUb2tlbihzZXR0aW5nc1RhYjogS2VlcFNpZGlhblNldHRpbmdzVGFiLCBwbHVnaW46IEtlZXBTaWRpYW5QbHVnaW4sIHJldHJpZXZlVG9rZW5XZWJ2aWV3OiBXZWJ2aWV3VGFnKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgZ2V0T0F1dGhUb2tlbihzZXR0aW5nc1RhYiwgcGx1Z2luLCByZXRyaWV2ZVRva2VuV2Vidmlldyk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHJldHJpZXZlIHRva2VuOicsIGVycm9yKTtcbiAgICAgICAgbmV3IE5vdGljZShgRmFpbGVkIHRvIHJldHJpZXZlIHRva2VuOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGV4Y2hhbmdlT2F1dGhUb2tlbihzZXR0aW5nc1RhYjogS2VlcFNpZGlhblNldHRpbmdzVGFiLCBwbHVnaW46IEtlZXBTaWRpYW5QbHVnaW4sIG9hdXRoVG9rZW46IHN0cmluZykge1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlOiBvYnNpZGlhbi5SZXF1ZXN0VXJsUmVzcG9uc2UgPSBhd2FpdCBvYnNpZGlhbi5yZXF1ZXN0VXJsKHtcbiAgICAgICAgICAgIHVybDogYCR7S0VFUFNJRElBTl9TRVJWRVJfVVJMfS9yZWdpc3RlcmAsXG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICBlbWFpbDogcGx1Z2luLnNldHRpbmdzLmVtYWlsLFxuICAgICAgICAgICAgICAgIG9hdXRoX3Rva2VuOiBvYXV0aFRva2VuLFxuICAgICAgICAgICAgfSksXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIENoZWNrIHN0YXR1cyBiZWZvcmUgcGFyc2luZyBKU09OXG4gICAgICAgIGlmICghcmVzcG9uc2Uuc3RhdHVzIHx8IHJlc3BvbnNlLnN0YXR1cyA8IDIwMCB8fCByZXNwb25zZS5zdGF0dXMgPj0gMzAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFNlcnZlciByZXR1cm5lZCBzdGF0dXMgJHtyZXNwb25zZS5zdGF0dXN9YCk7XG4gICAgICAgIH1cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVzcG9uc2UuanNvbjtcbiAgICAgICAgICAgIGlmICghaXNUb2tlblJlc3BvbnNlKHJlc3VsdCkpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgcmVzcG9uc2UgZm9ybWF0Jyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICghcmVzdWx0LmtlZXBfdG9rZW4pIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1NlcnZlciByZXNwb25zZSBtaXNzaW5nIGtlZXBfdG9rZW4nKTtcbiAgICAgICAgICAgIH1cbiAgICBcbiAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy50b2tlbiA9IHJlc3VsdC5rZWVwX3Rva2VuO1xuICAgICAgICAgICAgYXdhaXQgcGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgc2V0dGluZ3NUYWIuZGlzcGxheSgpO1xuICAgICAgICAgICAgbmV3IE5vdGljZSgnVG9rZW4gZXhjaGFuZ2VkIHN1Y2Nlc3NmdWxseS4nKTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gcGFyc2Ugc2VydmVyIHJlc3BvbnNlOiAnICsgZSwpO1xuICAgICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZXhjaGFuZ2luZyBPQXV0aCB0b2tlbjonLCBlcnJvcik7XG4gICAgICAgIG5ldyBOb3RpY2UoYEZhaWxlZCB0byBleGNoYW5nZSBPQXV0aCB0b2tlbjogJHtlcnJvci5tZXNzYWdlfWApO1xuICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG59IiwgImltcG9ydCB7IFN1YnNjcmlwdGlvblNldHRpbmdzVGFiIH0gZnJvbSBcIi4vU3Vic2NyaXB0aW9uU2V0dGluZ3NUYWJcIjtcbmltcG9ydCB7IFdlYnZpZXdUYWcgfSBmcm9tIFwiZWxlY3Ryb25cIjtcbmltcG9ydCB7IGV4Y2hhbmdlT2F1dGhUb2tlbiwgaW5pdFJldHJpZXZlVG9rZW4gfSBmcm9tIFwiLi4vZ29vZ2xlL2tlZXAvdG9rZW5cIjtcbmltcG9ydCBLZWVwU2lkaWFuUGx1Z2luIGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBQbHVnaW5TZXR0aW5nVGFiLCBBcHAsIFNldHRpbmcsIE5vdGljZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuXG5leHBvcnQgY2xhc3MgS2VlcFNpZGlhblNldHRpbmdzVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XG5cdHByaXZhdGUgcmV0cmlldmVUb2tlbldlYlZpZXc6IFdlYnZpZXdUYWc7XG5cdHByaXZhdGUgcGx1Z2luOiBLZWVwU2lkaWFuUGx1Z2luO1xuXG5cdGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IEtlZXBTaWRpYW5QbHVnaW4pIHtcblx0XHRzdXBlcihhcHAsIHBsdWdpbik7XG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW47XG5cdH1cblxuXHRwcml2YXRlIGlzVmFsaWRFbWFpbChlbWFpbDogc3RyaW5nKTogYm9vbGVhbiB7XG5cdFx0Y29uc3QgZW1haWxSZWdleCA9IC9eW15cXHNAXStAW15cXHNAXStcXC5bXlxcc0BdKyQvO1xuXHRcdHJldHVybiBlbWFpbFJlZ2V4LnRlc3QoZW1haWwpO1xuXHR9XG5cblx0YXN5bmMgZGlzcGxheSgpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuXHRcdGNvbnRhaW5lckVsLmVtcHR5KCk7XG5cblx0XHQvLyBCYXNpYyBzZXR0aW5nc1xuXHRcdGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMicsIHsgdGV4dDogJ0tlZXBTaWRpYW4gU2V0dGluZ3MnIH0pO1xuXG5cdFx0dGhpcy5hZGRFbWFpbFNldHRpbmcoY29udGFpbmVyRWwpO1xuXHRcdHRoaXMuYWRkU3luY1Rva2VuU2V0dGluZyhjb250YWluZXJFbCk7XG5cdFx0dGhpcy5jcmVhdGVSZXRyaWV2ZVRva2VuV2ViVmlldyhjb250YWluZXJFbCk7XG5cdFx0dGhpcy5hZGRTYXZlTG9jYXRpb25TZXR0aW5nKGNvbnRhaW5lckVsKTtcblx0XHR0aGlzLmFkZFN1YnNjcmlwdGlvblNldHRpbmdzKGNvbnRhaW5lckVsKTtcblx0fVxuXG5cdHByaXZhdGUgYWRkU3Vic2NyaXB0aW9uU2V0dGluZ3MoY29udGFpbmVyRWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XG5cdFx0Y29uc3Qgc3Vic2NyaXB0aW9uVGFiID0gbmV3IFN1YnNjcmlwdGlvblNldHRpbmdzVGFiKFxuXHRcdFx0Y29udGFpbmVyRWwsXG5cdFx0XHR0aGlzLnBsdWdpblxuXHRcdCk7XG5cdFx0c3Vic2NyaXB0aW9uVGFiLmRpc3BsYXkoKTtcblx0fVxuXG5cdHByaXZhdGUgYWRkRW1haWxTZXR0aW5nKGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuXHRcdFx0LnNldE5hbWUoJ0VtYWlsJylcblx0XHRcdC5zZXREZXNjKCdZb3VyIEdvb2dsZSBLZWVwIGVtYWlsLicpXG5cdFx0XHQuYWRkVGV4dCh0ZXh0ID0+IHRleHRcblx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKCdleGFtcGxlQGdtYWlsLmNvbScpXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbWFpbClcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmVtYWlsID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pKTtcblx0fVxuXG5cdHByaXZhdGUgYWRkU3luY1Rva2VuU2V0dGluZyhjb250YWluZXJFbDogSFRNTEVsZW1lbnQpOiB2b2lkIHtcblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcblx0XHRcdC5zZXROYW1lKCdTeW5jIHRva2VuJylcblx0XHRcdC5zZXREZXNjKCdZb3VyIEdvb2dsZSBLZWVwIHN5bmMgdG9rZW4gaXMgYSB1bmlxdWUgY29kZSB0aGF0IGF1dGhvcml6ZXMgdGhpcyBwbHVnaW4gdG8gYWNjZXNzIHlvdXIgR29vZ2xlIEtlZXAgZGF0YS4gWW91IGNhbiByZXRyaWV2ZSBpdCBieSBjbGlja2luZyB0aGUgXCJSZXRyaWV2ZSB0b2tlblwiIGJ1dHRvbi4nKVxuXHRcdFx0LmFkZFRleHQodGV4dCA9PiB7XG5cdFx0XHRcdHRleHRcblx0XHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJ1lvdXIgR29vZ2xlIEtlZXAgc3luYyB0b2tlbi4nKVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MudG9rZW4pXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy50b2tlbiA9IHZhbHVlO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0dGV4dC5pbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoJ3Bhc3RlJywgdGhpcy5oYW5kbGVUb2tlblBhc3RlLmJpbmQodGhpcykpO1xuXHRcdFx0XHR0ZXh0LmlucHV0RWwudHlwZSA9ICdwYXNzd29yZCc7XG5cdFx0XHRcdGNvbnN0IHRvZ2dsZUJ1dHRvbiA9IHRleHQuaW5wdXRFbC5wYXJlbnRFbGVtZW50Py5jcmVhdGVFbCgnYnV0dG9uJywgeyB0ZXh0OiAnU2hvdycgfSk7XG5cdFx0XHRcdHRvZ2dsZUJ1dHRvbj8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuXHRcdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0XHRpZiAodGV4dC5pbnB1dEVsLnR5cGUgPT09ICdwYXNzd29yZCcpIHtcblx0XHRcdFx0XHRcdHRleHQuaW5wdXRFbC50eXBlID0gJ3RleHQnO1xuXHRcdFx0XHRcdFx0dG9nZ2xlQnV0dG9uLnRleHRDb250ZW50ID0gJ0hpZGUnO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHR0ZXh0LmlucHV0RWwudHlwZSA9ICdwYXNzd29yZCc7XG5cdFx0XHRcdFx0XHR0b2dnbGVCdXR0b24udGV4dENvbnRlbnQgPSAnU2hvdyc7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdH0pXG5cdFx0XHQuYWRkQnV0dG9uKGJ1dHRvbiA9PiBidXR0b25cblx0XHRcdFx0LnNldEJ1dHRvblRleHQoJ1JldHJpZXZlIHRva2VuJylcblx0XHRcdFx0Lm9uQ2xpY2sodGhpcy5oYW5kbGVSZXRyaWV2ZVRva2VuLmJpbmQodGhpcykpKTsgXG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIGhhbmRsZVRva2VuUGFzdGUoZXZlbnQ6IENsaXBib2FyZEV2ZW50KTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHRjb25zdCBwYXN0ZWRUZXh0ID0gZXZlbnQuY2xpcGJvYXJkRGF0YT8uZ2V0RGF0YSgndGV4dCcpO1xuXHRcdGlmIChwYXN0ZWRUZXh0ICYmIHBhc3RlZFRleHQuaW5jbHVkZXMoJ29hdXRoMl80JykpIHtcblx0XHRcdGF3YWl0IGV4Y2hhbmdlT2F1dGhUb2tlbih0aGlzLCB0aGlzLnBsdWdpbiwgcGFzdGVkVGV4dCk7XG5cdFx0XHR0aGlzLmRpc3BsYXkoKTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIGhhbmRsZVJldHJpZXZlVG9rZW4oKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0aWYgKCF0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbWFpbCB8fCAhdGhpcy5pc1ZhbGlkRW1haWwodGhpcy5wbHVnaW4uc2V0dGluZ3MuZW1haWwpKSB7XG5cdFx0XHRuZXcgTm90aWNlKCdQbGVhc2UgZW50ZXIgYSB2YWxpZCBlbWFpbCBhZGRyZXNzIGJlZm9yZSByZXRyaWV2aW5nIHRoZSB0b2tlbi4nKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0YXdhaXQgaW5pdFJldHJpZXZlVG9rZW4odGhpcywgdGhpcy5wbHVnaW4sIHRoaXMucmV0cmlldmVUb2tlbldlYlZpZXcpO1xuXHRcdHRoaXMuZGlzcGxheSgpO1xuXHR9XG5cblx0cHJpdmF0ZSBhZGRTYXZlTG9jYXRpb25TZXR0aW5nKGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuXHRcdFx0LnNldE5hbWUoJ1NhdmUgbG9jYXRpb24nKVxuXHRcdFx0LnNldERlc2MoJ1doZXJlIHRvIHNhdmUgaW1wb3J0ZWQgbm90ZXMgKHJlbGF0aXZlIHRvIHZhdWx0IGZvbGRlcikuJylcblx0XHRcdC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuXHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJ0tlZXBTaWRpYW4nKVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Muc2F2ZUxvY2F0aW9uKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3Muc2F2ZUxvY2F0aW9uID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pKTtcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlUmV0cmlldmVUb2tlbldlYlZpZXcoY29udGFpbmVyRWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XG5cdFx0dGhpcy5yZXRyaWV2ZVRva2VuV2ViVmlldyA9IGNvbnRhaW5lckVsLmNyZWF0ZUVsKCd3ZWJ2aWV3JyBhcyBrZXlvZiBIVE1MRWxlbWVudFRhZ05hbWVNYXAsIHtcblx0XHRcdGF0dHI6IHsgc3R5bGU6ICd3aWR0aDogMTAwJTsgaGVpZ2h0OiA2MDBweDsnIH1cblx0XHR9KSBhcyBXZWJ2aWV3VGFnO1xuXHRcdHRoaXMucmV0cmlldmVUb2tlbldlYlZpZXcuc3JjID0gXCJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20vRW1iZWRkZWRTZXR1cFwiO1xuXHRcdHRoaXMucmV0cmlldmVUb2tlbldlYlZpZXcuc2V0QXR0cmlidXRlKCdkaXNhYmxld2Vic2VjdXJpdHknLCAndHJ1ZScpO1xuXHRcdHRoaXMucmV0cmlldmVUb2tlbldlYlZpZXcuc2V0QXR0cmlidXRlKCdjcm9zc29yaWdpbicsICdhbm9ueW1vdXMnKTtcblx0XHR0aGlzLnJldHJpZXZlVG9rZW5XZWJWaWV3LmhpZGUoKTtcblx0fVxufVxuIiwgImltcG9ydCB7IFN1YnNjcmlwdGlvbkluZm8sIFN1YnNjcmlwdGlvbkNhY2hlIH0gZnJvbSAnLi4vdHlwZXMvc3Vic2NyaXB0aW9uJztcbmltcG9ydCB7IE5vdGljZSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IEtFRVBTSURJQU5fU0VSVkVSX1VSTCB9IGZyb20gJy4uL2NvbmZpZyc7XG5cbmNvbnN0IENBQ0hFX0RVUkFUSU9OID0gMjQgKiA2MCAqIDYwICogMTAwMDsgLy8gMjQgaG91cnMgaW4gbWlsbGlzZWNvbmRzXG5cbmV4cG9ydCBjbGFzcyBTdWJzY3JpcHRpb25TZXJ2aWNlIHtcbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSBnZXRFbWFpbDogKCkgPT4gc3RyaW5nLFxuICAgIHByaXZhdGUgZ2V0Q2FjaGU6ICgpID0+IFN1YnNjcmlwdGlvbkNhY2hlIHwgdW5kZWZpbmVkLFxuICAgIHByaXZhdGUgc2V0Q2FjaGU6IChjYWNoZTogU3Vic2NyaXB0aW9uQ2FjaGUpID0+IFByb21pc2U8dm9pZD5cbiAgKSB7IH1cblxuICBhc3luYyBjaGVja1N1YnNjcmlwdGlvbihmb3JjZVJlZnJlc2ggPSBmYWxzZSk6IFByb21pc2U8U3Vic2NyaXB0aW9uSW5mbyB8IG51bGw+IHtcbiAgICBjb25zdCBlbWFpbCA9IHRoaXMuZ2V0RW1haWwoKTtcbiAgICBpZiAoIWVtYWlsKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBjb25zdCBjYWNoZSA9IHRoaXMuZ2V0Q2FjaGUoKTtcbiAgICBpZiAoXG4gICAgICAhZm9yY2VSZWZyZXNoICYmXG4gICAgICBjYWNoZSAmJlxuICAgICAgY2FjaGUuZW1haWwgPT09IGVtYWlsICYmXG4gICAgICBEYXRlLm5vdygpIC0gY2FjaGUudGltZXN0YW1wIDwgQ0FDSEVfRFVSQVRJT05cbiAgICApIHtcbiAgICAgIHJldHVybiBjYWNoZS5pbmZvO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBjb25zdCBpbmZvID0gYXdhaXQgdGhpcy5mZXRjaFN1YnNjcmlwdGlvbkluZm8oZW1haWwpO1xuICAgICAgYXdhaXQgdGhpcy5zZXRDYWNoZSh7XG4gICAgICAgIGluZm8sXG4gICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICAgICAgZW1haWw6IGVtYWlsLFxuICAgICAgfSk7XG4gICAgICByZXR1cm4gaW5mbztcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGNoZWNrIHN1YnNjcmlwdGlvbjonLCBlcnJvcik7XG4gICAgICBuZXcgTm90aWNlKCdGYWlsZWQgdG8gY2hlY2sgc3Vic2NyaXB0aW9uIHN0YXR1cy4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlci4nKTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZmV0Y2hTdWJzY3JpcHRpb25JbmZvKGVtYWlsOiBzdHJpbmcpOiBQcm9taXNlPFN1YnNjcmlwdGlvbkluZm8+IHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke0tFRVBTSURJQU5fU0VSVkVSX1VSTH0vc3Vic2NyaWJlci9pbmZvYCwge1xuICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgJ1gtVXNlci1FbWFpbCc6IGVtYWlsLFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgIGNvbnN0IGVycm9yID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yLmVycm9yIHx8ICdGYWlsZWQgdG8gZmV0Y2ggc3Vic2NyaXB0aW9uIGluZm8nKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpO1xuICB9XG5cbiAgYXN5bmMgaXNTdWJzY3JpcHRpb25BY3RpdmUoZm9yY2VSZWZyZXNoID0gZmFsc2UpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICBjb25zdCBpbmZvID0gYXdhaXQgdGhpcy5jaGVja1N1YnNjcmlwdGlvbihmb3JjZVJlZnJlc2gpO1xuICAgIHJldHVybiBpbmZvPy5zdWJzY3JpcHRpb25fc3RhdHVzID09PSAnYWN0aXZlJztcbiAgfVxufSAiLCAiaW1wb3J0IHsgQXBwLCBNb2RhbCwgU2V0dGluZyB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IFN1YnNjcmlwdGlvblNldHRpbmdzVGFiIH0gZnJvbSAnLi9TdWJzY3JpcHRpb25TZXR0aW5nc1RhYic7XG5pbXBvcnQgS2VlcFNpZGlhblBsdWdpbiBmcm9tICdtYWluJztcblxuZXhwb3J0IGludGVyZmFjZSBOb3RlSW1wb3J0T3B0aW9ucyB7XG4gICAgaW5jbHVkZU5vdGVzVGVybXM/OiBzdHJpbmdbXTtcbiAgICBleGNsdWRlTm90ZXNUZXJtcz86IHN0cmluZ1tdO1xuICAgIHVwZGF0ZVRpdGxlPzogYm9vbGVhbjtcbiAgICBzdWdnZXN0VGFncz86IGJvb2xlYW47XG4gICAgbWF4VGFncz86IG51bWJlcjtcbiAgICB0YWdQcmVmaXg/OiBzdHJpbmc7XG4gICAgbGltaXRUb0V4aXN0aW5nVGFncz86IGJvb2xlYW47XG59XG5cbmV4cG9ydCBjbGFzcyBOb3RlSW1wb3J0T3B0aW9uc01vZGFsIGV4dGVuZHMgTW9kYWwge1xuICAgIHByaXZhdGUgb25TdWJtaXQ6IChvcHRpb25zOiBOb3RlSW1wb3J0T3B0aW9ucykgPT4gdm9pZDtcbiAgICBwcml2YXRlIHBsdWdpbjogS2VlcFNpZGlhblBsdWdpbjtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgYXBwOiBBcHAsIFxuICAgICAgICBwbHVnaW46IEtlZXBTaWRpYW5QbHVnaW4sXG4gICAgICAgIG9uU3VibWl0OiAob3B0aW9uczogTm90ZUltcG9ydE9wdGlvbnMpID0+IHZvaWRcbiAgICApIHtcbiAgICAgICAgc3VwZXIoYXBwKTtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgICAgIHRoaXMub25TdWJtaXQgPSBvblN1Ym1pdDtcbiAgICB9XG5cbiAgICBhc3luYyBvbk9wZW4oKSB7XG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuICAgICAgICBjb250ZW50RWwuY3JlYXRlRWwoJ2gyJywgeyB0ZXh0OiAnSW1wb3J0IE9wdGlvbnMnIH0pO1xuICAgICAgICBjb250ZW50RWwuY3JlYXRlRWwoJ3AnLCB7IHRleHQ6ICdUaGFua3MgZm9yIHN1YnNjcmliaW5nISBVcGRhdGUgdGhlIHByZW1pdW0gb3B0aW9ucyBmb3IgdGhpcyBpbXBvcnQgYmVsb3cuJyB9KTtcbiAgICAgICAgY29uc3QgcHJlbWl1bUZlYXR1cmVWYWx1ZXMgPSB7IC4uLnRoaXMucGx1Z2luLnNldHRpbmdzLnByZW1pdW1GZWF0dXJlcyB9O1xuICAgICAgICBhd2FpdCBTdWJzY3JpcHRpb25TZXR0aW5nc1RhYi5kaXNwbGF5UHJlbWl1bUZlYXR1cmVzU2VydmVyKGNvbnRlbnRFbCwgdGhpcy5wbHVnaW4sIHByZW1pdW1GZWF0dXJlVmFsdWVzKTtcblxuICAgICAgICAvLyBTdWJtaXQgQnV0dG9uXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcbiAgICAgICAgICAgIC5hZGRCdXR0b24oYnRuID0+IGJ0blxuICAgICAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KCdJbXBvcnQnKVxuICAgICAgICAgICAgICAgIC5zZXRDdGEoKVxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vblN1Ym1pdChwcmVtaXVtRmVhdHVyZVZhbHVlcyBhcyBOb3RlSW1wb3J0T3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICB9KSlcbiAgICAgICAgICAgIC5hZGRCdXR0b24oYnRuID0+IGJ0blxuICAgICAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KCdDYW5jZWwnKVxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICB9XG5cbiAgICBvbkNsb3NlKCkge1xuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcbiAgICAgICAgY29udGVudEVsLmVtcHR5KCk7XG4gICAgfVxufSAiXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLElBQUFBLG1CQUErQjs7O0FDQS9CLElBQUFDLG1CQUF1RDs7O0FDR2hELElBQU0sd0JBQXdCOzs7QUNpQ3JDLFNBQVMsY0FBYyxZQUF5QztBQUM1RCxNQUFJLENBQUMsWUFBWTtBQUNiLFdBQU87QUFBQSxFQUNYO0FBQ0EsUUFBTSxPQUFPLElBQUksS0FBSyxVQUFVO0FBQ2hDLFNBQU8sTUFBTSxLQUFLLFFBQVEsQ0FBQyxJQUFJLE9BQU87QUFDMUM7QUFFQSxTQUFTLGNBQWMsTUFBeUM7QUE1Q2hFO0FBNkNJLFFBQU0saUJBQWlDO0FBQUEsSUFDbkMsU0FBTyxVQUFLLFVBQUwsbUJBQVksV0FBVTtBQUFBLElBQzdCLFFBQU0sVUFBSyxTQUFMLG1CQUFXLFdBQVU7QUFBQSxJQUMzQixTQUFTLGNBQWMsS0FBSyxPQUFPLEtBQUs7QUFBQSxJQUN4QyxTQUFTLGNBQWMsS0FBSyxPQUFPLEtBQUs7QUFBQSxJQUN4QyxVQUFVLEtBQUssWUFBWTtBQUFBLElBQzNCLFNBQVMsS0FBSyxXQUFXO0FBQUEsSUFDekIsUUFBUSxNQUFNLFFBQVEsS0FBSyxNQUFNLElBQUksS0FBSyxTQUFTLENBQUM7QUFBQSxJQUNwRCxPQUFPLE1BQU0sUUFBUSxLQUFLLEtBQUssSUFBSSxLQUFLLFFBQVEsQ0FBQztBQUFBLElBQ2pELFdBQVcsTUFBTSxRQUFRLEtBQUssU0FBUyxJQUFJLEtBQUssWUFBWSxDQUFDO0FBQUEsSUFDN0QsWUFBWSxNQUFNLFFBQVEsS0FBSyxVQUFVLElBQUksS0FBSyxhQUFhLENBQUM7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LElBQUksQ0FBQztBQUFBLEVBQzdEO0FBQUEsRUFFQSxNQUFNLGVBQWU7QUFDcEIsU0FBSyxXQUFXLE9BQU8sT0FBTyxDQUFDLEdBQUcsa0JBQWtCLE1BQU0sS0FBSyxTQUFTLENBQUM7QUFBQSxFQUMxRTtBQUFBLEVBRUEsTUFBTSxlQUFlO0FBQ3BCLFVBQU0sS0FBSyxTQUFTLEtBQUssUUFBUTtBQUFBLEVBQ2xDO0FBQUEsRUFFQSxNQUFNLHlCQUF3QztBQUM3QyxXQUFPLElBQUksUUFBUSxDQUFDLFlBQVk7QUFDL0IsVUFBSTtBQUFBLFFBQ0gsS0FBSztBQUFBLFFBQ0w7QUFBQSxRQUNBLE9BQU8sWUFBK0I7QUFDckMsZ0JBQU0saUNBQWlDLE1BQU0sT0FBTztBQUNwRCxjQUFJLHdCQUFPLDZCQUE2QjtBQUN4QyxrQkFBUTtBQUFBLFFBQ1Q7QUFBQSxNQUNELEVBQUUsS0FBSztBQUFBLElBQ1IsQ0FBQztBQUFBLEVBQ0Y7QUFBQSxFQUVBLE1BQU0sY0FBYztBQUNuQixRQUFJO0FBQ0gsWUFBTSx1QkFBdUIsTUFBTSxLQUFLLG9CQUFvQixxQkFBcUI7QUFFakYsVUFBSSxzQkFBc0I7QUFDekIsY0FBTSxLQUFLLHVCQUF1QjtBQUFBLE1BQ25DLE9BQU87QUFDTixjQUFNLHNCQUFzQixJQUFJO0FBQ2hDLFlBQUksd0JBQU8sNkJBQTZCO0FBQUEsTUFDekM7QUFBQSxJQUNELFNBQVMsT0FBUDtBQUNELFVBQUksd0JBQU8seUNBQXlDLE1BQU0sT0FBTztBQUFBLElBQ2xFO0FBQUEsRUFDRDtBQUNEOyIsCiAgIm5hbWVzIjogWyJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJwbHVnaW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJyZXNvbHZlIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIl0KfQo=
