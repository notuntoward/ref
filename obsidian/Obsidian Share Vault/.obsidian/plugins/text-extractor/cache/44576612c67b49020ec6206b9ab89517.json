{"path":"lit/lit_sources/Otterson16stochTrdTSO.docx","text":"Stochastic trading across time under German TSO constraints Scott Otterson*, Dominik Jost, Malte Jansen, and Malte Siefert Fraunhofer Institute for Wind Energy and Energy System Technology IWES 34119 Kassel / Germany *Email: scott.otterson@iwes.fraunhofer.de Abstract -- The uncertainty of wind power forecasts generally decreases with forecast horizon, making it possible to profitably sell large amounts of this power on a day-ahead interday market, and then to make small corrections closer to delivery time by trading on a short-horizon intraday market. Such multistage intraday buy/sell decisions are often made using deterministic power forecasts, even though probabilistic forecasts describe the highly relevant uncertainty vs. time relationship. This is especially true for German transmission system operators (TSOs), who are allowed to consider only the expected value -- i.e. a point forecast -- when selling on the interday market, and who have other restrictions on the intraday market. Simulations suggest that certain German TSOs, or direct marketers which have smaller installed capacities, may benefit on the intraday market by trading while using probabilistic forecasts. A much larger benefit may also accrue with the use of a price forecast, also developed for this work. One limitation this study is that the market model used may have the effect of smoothing out price volatility and illiquidity.  A next step is to re-evaluate probabilistic trading on a market model which simulates such illiquidity.  Index Terms – wind power, probabilistic forecasting, price forecasting, electricity markets, grid integration Introduction The four German transmission system operators (TSOs), Amprion, TransnetBW, 50Hertz, and TenneT, must trade a class of subsidized wind power controlled by the Renewable Energy Sources Act (EEG), on interday day-ahead, and intraday markets. See Figure 1. At noon, on the day before wind power is delivered, the TSOs must sell the forecasted wind power production for each 15 minute interval of the next day – tdeliv in the Figure – and in amounts equal to the mean predicted value within those intervals; the day-ahead forecast is variously called the “most probable,” “expected value,” or “point” forecast. Regardless of the name, it is a deterministic forecast, usually designed to minimize the root mean squared error (RMSE) against power measurements. The day-ahead forecasts will have errors, so TSOs are allowed to correct the resulting trading errors by buying or selling on the EPEX SPOT intraday market, starting at 16:00 on the previous day, and running until the intraday market close time, tclose A trade at market close must again be based on a deterministic point forecast. Although forecast error generally decreases closer to delivery time, the market close forecast will still be wrong; the ending trading error will be corrected with balancing energy. The price per MWh of imbalance correction, being determined by a complex legal mechanism, is extremely difficult to forecast [25]. This is just as well because balancing prices are not known until weeks after they are incurred, and furthermore, trading strategies which speculate on the balancing price are illegal [13]. Power delivery time: tdeliv Day-ahead auction 12:00 Day-ahead trading Intraday trading Balancing Correction Day t Day t-1 Start intraday market 16:00 (15 min products) Gate closure intraday: tclose Figure 1. Day-ahead and Intraday Trading Timelines During the intraday market, the TSOs have the freedom to optimize their trading algorithms to minimize their costs; trading can be done with probabilistic forecasts, although this is not common. They are also allowed to move from purely power-based trading towards power-and-price-optimized trading. The TSOs’ share of total German wind power has decreased significantly in recent years, and was about 10 % of the total at the end of 2014. This means that we can assume that power sales by German TSOs likely have only a small impact on market prices. Trading Decision Timing Figure 2. outlines the timing of TSO trading decisions. On the day-ahead interday market, the TSO must sell the future wind power production according to a point forecast; the amount sold, , should equal a deterministic prediction of the power produced the next day at delivery time, . On the intraday market, the TSO can use more accurate short term power forecasts – which also predict the power production at – to buy or sell power in order to correct the day-ahead forecast error. For each delivery time, there are decision times, , until market close, at which the TSO can decide whether or not to trade intraday market power; the power can be bought or sold at the price available at , or the transaction can be delayed to sometime in the future; for each , a correction could be made at possible transaction times, There are several intraday product lengths but in this report, we concentrate on power bought or sold in 15 minute intervals, where the majority of intraday power is traded; therefore, indexes 15 minute periods. Actual intraday market trading begins at up to 32 hours before delivery but we limit our study to a maximum intraday horizon of eight hours (indexed by) since the accuracy of short term forecasts is not significantly better for longer horizons. Finally, we model a market closing time of. In July 2015, a 30 minute closing time was adopted but we model the old time, and expect that our conclusions will still remain valid. Figure 2. Forecast Decision Timing Market Characteristics Traders try to maximize profit under market rules which are designed to economically reduce the need for balancing power. Figure 3 illustrates the effect of these rules. TSOs generally try to make their corrections with as few trades as possible, as there is a small transaction fee of 0.1 EUR/MWh of traded power, and because there is some risk of market illiquidity, that is, of not being able to find a reasonably-priced buy or sell for a certain point in time. The top plot in Figure 3 shows the distribution of the number of trades for a single delivery time vs. the time difference between the decision and the delivery times (the forecast horizon, so the left side of the plot shows the distribution 24 hours before delivery). The blue line is the median; in the plot, it can be seen that there is little trading until about four hours before delivery, when trading increases rapidly. This is roughly the horizon where short term power forecasts are significantly more accurate than day-ahead forecasts, thus making corrections more reliable. The green lines are quantiles, so for example, there is a 0.99 probability that the number of trades near market close (t = -0.75 hours) is less than 30. Somewhat surprisingly, there is no clear trend in price with horizon, as shown in the bottom plot in Figure 3, suggesting that there is enough liquidity that power remains available as the number of trades increases. There is perhaps a slight trend towards higher price variability near the delivery time – the chance of the price going below -23 Euros near market close is 1% and there is a 1% chance that the price will exceed 84 EUR/MWh. Figure 3. Trading Behavior vs. Trading Horizon (Quantiles) Intraday prices vary widely, with a standard deviation of 18.5 EUR/MWh, over this dataset, while the standard deviation over the balancing prices is 142 EUR/MWh. Balancing prices can be severe, so there is great incentive to avoid using balancing power, and it is only about 2.5% of wholesale market Market model used in this study It is assumed that each TSO sells all the EEG power in its region, and that on the day-ahead market, it sells exactly the amount predicted by a day-ahead point power forecast, in fifteen minute increments. During the intraday period, it can trade correction power, according to some trading algorithm, at the intraday price and paying a transaction fee of 0.10 EUR/MWh of traded power, in accordance with EPEX market rules. At the market close time, the TSO also transacts exactly the amount of power needed to correct for trading errors, as predicted by a point forecast. After market close, the power promised for the delivery time is compared to the power delivered; the TSO pays the current balancing price for the difference. In real life, the amount of EEG capacity available changes over time, as plants are added or removed from the pool. But since we want to focus only on intraday trading algorithm performance, the forecasted and measured power are capacity-normalized i.e. divided by capacity. The model makes a few assumptions about price: First, it assumes that TSO EEG wind power trades don’t affect prices, that is, that the TSO does not have market power – somewhat realistic, as EEG power is 10% of the wind power market or less, as previously discussed. Second, it assumes that there is a single price for each combination of delivery, decision and transaction time. This price is the average price of all power traded at this combination, weighted by the power traded in each transaction. This weighted average can mask volatility, although it should represent the general market behavior over many samples. Trading algorithms On the interday market, TSOs often try to correct their day-ahead market offer errors with the use of power based algorithms which do not consider intraday market price. This section begins with power-only approaches and then introduces a simple price modification. pointPowRMSE: Baseline RMSE Trading TSOs typically base their intraday trading on point forecasts optimized for minimum root mean squared error (RMSE), , which predict the expected power production at at decision times , where is the index at the maximum intraday forecast horizon. They do not necessarily trade at every possible transaction time but attempt to avoid “too-frequent” trades by deciding whether or not a power error is large enough to merit an intraday transaction correction; for each decision time, there is a single, possibly zero-valued power transaction, . Figure 4. pointPowRMS: baseline RMSE Trading The first method tested in this paper, pointPowRMSE, is intended to mimic that approach. See Figure 4. In the figure, the TSO has sold wind power, for delivery time and at each transaction time over it has attempted to correct the day-ahead forecast errors by trading power,, whereis positive for selling and negative for buying. At any decision time, the minimum RMSE estimate of the power that will be delivered at is: \t\t where is the cumulative total power traded on the intraday market for just before decision time,: \t\t Assuming that the correction power the TSO has bought on the intraday market is perfectly reliable, the predicted delivery time power deficit,, is: \t\t Finally, the intraday trade executed by the TSO is: \t\t where is a threshold below which the error is considered too small to justify a trade. The power error threshold, is chosen by tuning for minimum intraday trading cost over a separate training data set. pointPowMed: Median Quantile Trading The pointPowMed method (Figure 5) is identical to pointPowRMSE, except that the RMSE optimized point forecast, in equation (1) is replaced by the median forecasted quantile: \t\t where is the quantile estimate at probability : For delivery time and decision time , the quantile is where is the estimated cumulative distribution function, , of the power random variable . The median quantile forecast may be preferred by traders because the cost of power delivery errors is linear in error amplitude, while an RMSE point forecast is tuned by an error cost function which is sensitive to the error squared. The final trade can still be zeroed by the power error threshold, as in (4). Figure 5. pointPowMed quantPowEdge: Conservative Quantile Range Trading The weaknesses of the power errorthreshold, , are 1.) that it is a fixed constant, independent of forecasted power level and other factors that might affect the accuracy of the forecast error estimate, and 2.) that the range of errors it excludes from trading is symmetric about the expected power value, while the distribution of wind power forecast errors is known to be asymmetric [2]. The quantPowEdge algorithm utilizes a more flexible threshold, following the quantiles of probabilistic wind power forecasts; these are conditional estimates of potentially asymmetric forecast error. The algorithm is similar to that in [25], where it is found to produce fewer trades than the alternatives, thus reducing “double trading,” where the same power is bought and sold. Double trading is believed to, on average, impose additional trading costs [13]. As shown in Figure 6, a trade is performed when the sum of intraday trading and the power promised on the day-ahead market falls outside of the central quantile probability range, , of a probabilistic power forecast i.e. only ifwhere: \t\t The correction target is conservative, bringing the predicted power only to the edge of the central quantile range: \t\t In addition, there is again a fixed power errorthreshold, , which can zero the correction target as in equation (4); the intent is to exclude trades for errors outside of but which would still buy or sell insignificant amounts of power. The combination of and is chosen to minimize trading costs on a separate training data set. Figure 6. quantPowEdge: Cautious Quantile Range Trading quantPowMed: Aggressive Quantile Range Trading The quantPowMed method is identical to quantPowEdge except that it corrects the full distance from the median quantile, as with pointPowMed. The secondary power threshold ( in (4)) and quantile range, are chosen as in the quantPowEdge method. Price modification of power-based trading algorithms The power based algorithms covered above make trading decisions without considering cost. Since intraday prices vary across the day for the same delivery time, it would seem that less expensive power corrections could be made by buying or selling correction power while using a price forecast. We test a simple modification: First, at decision time, one of the power-based algorithms above chooses the amount of correction power to trade for delivery time . Then, if is non-zero, a forecast is made for prices at relevant future transaction times, . If one of the forecasted future transaction prices is better than the current price (higher if selling; lower if buying), then the correction trade is delayed; otherwise, a transaction is made at the price currently available at. As before, the power threshold, and – depending upon the power algorithm – the quantile range,are chosen on a separate training set. Power Forecasting Methods Wind Power Point Forecasts The COSMO-EU and COSMO-DE numerical weather prediction (NWP) models produced the wind parameter forecasts used for the day-ahead and intraday power forecasts, respectively. The short term forecast horizons ranged from 45 minutes ahead to 8 hours ahead in 15 minute steps, while the day-ahead forecast made predictions for each 15 minute period of the following day. In both forecast horizon categories, the NWP data was first used to make a deterministic forecast of the power production at each of 67 German “reference farms.” For the day-ahead forecast, these forecasts were upscaled to TSO region EEG wind production using the “reference” method in [27]. For the short term intraday forecasts, the upscaling was done using a neural network based algorithm [3]. The resulting German-wide forecasts spanned 15-May-2012 to 21-April-2015. Probabilistic Wind Power Forecasts Probabilistic wind power forecasts were generated by regressing the power measurements against the point power forecasts using a quantile B-spline method [22]. For each 15 minute delivery period,a vector of power forecast quantiles, is produced for probabilities . The index denotes the time the forecast is used to make a decision, and thus selects the most recent forecast for the time that is available at a given decision time; in effect, indexes the forecast horizon. A spline degree of 3 was chosen for all quantile forecast models, and 10-fold cross-validation on each individual quantile model was used to select from one to five spline knots. In our implementation, we found that common approaches to knot spacing – linear, or with the use of a histogram – sometimes resulted in poor training convergence for extreme quantiles. The problem was eliminated when we clustered the input data with the kmeans algorithm [6] and placed the knots at the cluster centers. Quantiles were occasionally non-monotonic – not allowed by theory – so they were corrected by the algorithm in [5]. One model per quantile and horizon was trained over 15-May-2012 to 31-Dec-2013; the quantile forecasts used for further work were produced for the time range 01-Jan-2014 to 21-April-2015. As shown in Figure 7, the error of these forecasts, as measured by the continuous ranked probability score (CRPS) [16], gradually decreases as the horizon drops from 24 hours to 8 hours; below 8 hours, the error decreases rapidly (these are quantiles for a forecast of all German EEG wind power). As with the deterministic forecast root mean squared error (RMSE, also plotted), a smaller CRPS means better accuracy. Generally, a smaller CRPS also means more closely spaced quantiles; as the delivery time approaches and as CRPS decreases, will also decrease, causing the quantPowEdge and quantPowMed trading algorithms to become more “willing” to trade. Figure 7. German EEG Forecast Error vs. Horizon Price Forecasting At decision time, , the trader can either correct an estimated error at delivery time by making an immediate trade, or he/she can postpone correction trading until any of the future transaction times, between and (see Figure 2). At each decision time, the price forecaster produces the price estimates needed to decide between the transaction time options: a deterministic time series of prices, , that predict the true prices, at each future transaction time for power to be delivered at . Experiments revealed that it was difficult to train a single forecast model that worked well for all decision and delivery times. Therefore, we categorized each decision/delivery time pair by its forecast horizon (the decision/delivery time difference). There were 30 horizons, and we trained deterministic models for pairs of them, except for at the shortest and longest horizons, where single-horizon models were used. Below we discuss the details of the forecast and training algorithm, along with the inputs used. Neural Network Training and Feature Selection Price forecasts were done with an artificial neural net (ANN), specifically a three layer multilayer perceptron [20]. We had many candidate price forecasting inputs (See IV. B), and this posed training difficulties: Neural networks perform poorly when fed correlated or redundant features, as well as when their architecture is too complex – mainly in the choice of the number of nodes in the middle layer – for a given input dimension and the number of training samples. A partial solution is to use a “feature selection” algorithm to eliminate redundant or irrelevant inputs. But in doing so, we must avoid eliminating predictive, non-linear joint dependencies which a neural network is capable of modeling. One standard way of selecting ANN inputs is to employ a wrapper technique [14], and this is what we did for this work. For N candidate features, the variant we developed works like this: Train N ANN’s, one for each candidate feature, FnN, and initialize the selected features set to F*= {F*N}, where F*N is the feature that yields the lowest forecast error on a separate development set. Tests are done for network topologies containing from 1 to 8 hidden layer nodes, and the lowest error topology is selected. For the remaining N-1 features, FnN-1, train N-1 ANN’s, one per candidate feature, appended to the list of features already selected i.e. each of {F*N, FnN-1}, . Select the candidate feature, F*N-1, that yields the lowest forecast error and append it to F*. As in step 1. the network topology is also selected. Repeat step 2., adding one new feature at each iteration until the forecast error stops improving. The final result is a list of features, F*1, ranked by forecasting importance. For each horizon, we walked down the list from most important to least, selecting the number of features yielding the lowest development set test error. For computational speed, the ANNs were trained with fast Levenberg-Marquardt backpropagation [15] during the feature selection loop; for the final training, Bayesian regularization backpropagation [23] was used. Price forecasting input features A survey of the data showed that the intraday prices were roughly periodic in time-of-day and day-of-week and therefore, we considered harmonics of these periods as potential forecasting inputs. In addition intraday prices were temporally autocorrelated, as well as correlated with day- ahead prices, so lags of these were also included as potential “persistence forecast” features, as would be done in a signal processing problem where there is no domain-specific knowledge. We also examined electricity market behavior literature ([17][18][21]), and identified several market-specific features, mainly designed to detect price illiquidity. The potential feature set given to the feature selection algorithm is shown in Table 1, where the liquidity feature names are in light blue. The “Num. Selected” column shows how many times a feature was selected across the horizon-specific models. Overall, the decision time price, priceDec, was the feature most useful for predicting future prices, followed by other persistence and “climatology” features, for example, yesterday’s transaction price, priceTransM1d. The most useful of the price liquidity features was priceRng, the range of prices in the hour before the decision time. Liquidity features were rarely selected; in this market model, illiquidity does not seem to contribute much towards a change in price. The only feature never selected (in gray) was hddI, the decision/delivery time difference horizon index. The price forecast models were each trained on data coming from at most two horizons; it seems that the price behavior was similar enough between the horizons that there was no need to distinguish between neighboring horizons. Table 1. Price Forecasting Features (liquidity features in light blue; not selected in gray) Feature Meaning Num.Selected priceDec Price at decision time 29 priceTransM1d Yesterday's transaction price 28 priceTransM1w Last week's transaction price 28 priceDA Day-ahead price 25 transHix Transaction time index 25 priceRecent 1 hour avg. price before decision 22 priceAvM1d Yesterday's 1 hour avg. price 13 priceDecM1w Last week's 1 hour avg. price 11 priceRng Price range 1 hour before decision 9 towBasisTransT Transaction time day of week Fourier components (4) 9 priceDecM1d Yesterday's decision time price 9 todBasisDeliv Time of day Fourier comps. (4) 8 priceStdVwgt Price standard deviation 1 hr. before decision (Vol-weighted) 7 priceStd Price standard deviation 1 hr. before decision 6 todBasisTransT Transaction time of day Fourier components (4) 5 dowBasisDecT Decision time day of week Fourier components (4) 5 tradeVol Absolute MW power traded one hour before decision 5 todBasisDecT Decision time, time of day Fourier components (4) 4 nTrades Number of trades 1 hr. before decision 3 dowBasisDeliv Delivery time day of week Fourier components (4) 2 frcstDAeeg_Pt _ErrEst_MW Estimated DE-wide day-ahead EEG wind power forecast error 1 hddI Decision to delivery horizon index 0 Data The time series of the EEG production provided by the German TSOs is estimated with the now-upscaling algorithm described in [3]. Wind power measurements are also used from a collection of 67 German wind farms as discussed in Section V. The day-ahead spot market at which the TSOs trade were downloaded from the EPEX SPOT homepage [9]. Summary statistics of the German EPEX intraday price transactions are available online, however for this work, a record of every transaction was needed; the full transaction data set was purchased from EPEX for the time period studied in this report. In the full data, the following information is available about each transaction: the time of trade execution (when a bid or ask was accepted); the delivery time and duration of the traded power; the amount of power bought or sold; and the transaction price. From this information, it was possible to determine what set of prices was available for each triplet of decision, transaction and delivery time. Finally, the balancing settlement price, reBAP (regelzonenübergreifender Bilanzausgleichspreis), was downloaded at [11]. Results Intraday Transaction Price Forecasting Figure 8 shows the price forecast errors selected decision times and their corresponding transaction times. Line color indicates the decision time, for example, the blue lines show the average forecast errors for decision times that are 8 hours before delivery (delivery is at the t=0 coordinate, on the right side of the plot). For decision times with an 8 hour horizon, the first forecast is for the transaction time fifteen minutes closer to delivery, at t=-7.75 hours. The dotted blue lines show the errors of persistence forecasts, in which the forecast for all transaction times until delivery is simply the price available at the decision time. The solid blue lines show the error for the neural network forecasts described in Section IV. For a given decision time, the forecast horizon increases moving right, and as would be expected, so does the error. Correspondingly, for a given transaction time, the most accurate forecast is made at the decision time nearest to the transaction. The error increases sharply near market close, suggesting that prices during heavy trading (compare with Figure 3) are especially hard to predict. For all decision times, the neural network forecasts have about the same shortest-horizon accuracy as persistence. But for transaction times closer to delivery, the neural nets are superior. Figure 8. Price forecast error at selected horizons Table 2 shows the price forecasting performance, averaged across all horizons and transaction times. Table 2. Price Forecast Performance Average across All Horizons Data Set Persistence Error (RMSE EURO) Neural Net Error (RMSE EURO) NN Improvement over Persistence (%) train 16.3 13.1 19.5 test 14.7 12.7 14.1 In both test and train sets, the root mean squared errors are not small; they are a little less than half of the average absolute intraday price (32.8 EUR/MWh over the data set). In the next section, the utility of the neural net forecast is judged by whether or not it can be used to reduce intraday trading costs. Intraday Trading Costs Here we report the simulated costs of trading on the intraday market in order to correct day-ahead market power trading errors. We focus solely on intraday trading costs because the other costs are identical for all algorithms tested; the TSOs must use point forecasts for their day-ahead power trades – which makes day-ahead error and income identical – and they must also use a point forecast for the final trade at market close – which makes balancing costs identical. For the TSO, the average intraday trading cost per MW of installed capacity is: \t\t where is the volume-weighted intraday market price for power to be delivered at (Section I.A). This price was available on the intraday market at decision time and the amount of capacity-normalized power actually traded by the TSO was For each delivery time, there were fifteen minute periods – ranging between the 45 minute closing time and the maximum eight hour forecast horizon – where correction power could have been traded. Figure 9 shows the intraday costs for each trading algorithm, with and without a price forecast. Costs are shown normalized by dividing by the revenues obtained by each TSO on the day-ahead market when selling exactly the power predicted by the day-ahead point forecast. For each TSO plot, the left group of bars (labeled “none”) are the costs with no price forecast. Surprisingly, the 50 HZ TSO (Hz50 in the plot) can actually make a small intraday trading profit. But without a price forecast, the other TSOs will pay. When there is no price forecast, the baseline deterministic algorithm, pointPowRMSE, is the most financially beneficial, except for the TransnetBW TSO (Tbw), where quantPowMed is infinitesimally better. Figure 9. Intraday Trading Cost vs. Trading Algorithm and Price Forecast (Cost as % Day-Ahead Power Sales) The right bar groups (labeled “allTprice”) show costs when the trading algorithms use price (Section II.E); adding a price forecast provides a greater benefit than switching trading algorithms. For TennetT (Tnt) and Amprion (Amp), pointPowRMSE is still the best option but for 50 Hz (Hz50), the lowest cost comes from the median quantile algorithm, quantPointMed. For TransnetBW, the quantPowMed algorithm also results in the lowest cost. Adding a price forecast has two effects on the optimal trading algorithm parameters. First, it eliminates the need for the power threshold. For all algorithms, is optimal, and the final veto on trading is done entirely by the price forecast. Second, the inclusion of price tightens the optimal quantile trading exclusion range, decreasing the optimal in quantPowMed. Without a price forecast, the optimal about 0.4, depending upon the TSO, and with a price forecast, it goes down to 0.1 This allows the algorithm to trade smaller power errors sooner, in cases when future prices are forecasted to be worse. On a real market, the advantage of these earlier trades – besides the lower price – would be that that they reduce the risk of not being able to find a future trading partner with a reasonable price (illiquidity) [13]. The other conclusion coming from Figure 9 is that intraday correction costs can be a significant fraction of day-ahead revenue: without the use of a price forecast, nearly 20% for TransnetBW TSO (Tbw); with the use of a price forecast about 5-8%. Figure 10 shows the intraday costs for the price-based algorithms plotted against the installed capacity of each TSO (capacity varies over time so the mean is displayed). For reference, costs are also shown if all of the EEG power in Germany is traded in one group (“De” in the plot). There is a general trend towards lower normalized trading cost with increasing capacity, but the reason why the two best algorithms – pointPowRMSE and pointPowMed – switch rankings is not clear. What is clear from this plot is that quantPowEdge fares worst at all capacities. Figure 10. Intraday Trading Cost vs. Average Installed Capacity As noted in Section I.C, these results come from a market model that assigns trading cost based on the average price of historical transactions. In real life, a trader is not guaranteed an average price but instead must accept the best bid or ask not already taken. This kind of market illiquidity is not modeled here even though “double trading – buying and selling the same power – is often considered undesirable, partly because it is believed that illiquidity creates a greater probability of high trading costs (from personal discussions with German power traders). Liquidity risk, along with the market trading fee, is the reason that the quantPowEdge algorithm was proposed in [25], and in that paper, the quantPowEdge algorithm produced substantially fewer simulated trades than an algorithm based on a deterministic forecast. We can see the same in Figure 11, which plots the optimal percentage of trades for each price-based algorithm against capacity. The optimally tuned quantPowEdge algorithm results in substantially fewer trades than pointPowRMSE at all capacities. Figure 11. Percent Possible Trades vs. Mean Installed Capacity Moreover, the percentage-of-trades advantage of quantPowMed is even greater over pointPowMed, the quantile algorithm that produces the best trading results for the 50Hz and TransnetBW TSOs. It’s clear in Figure 11 that optimal pointPowMed makes a near constant percentage of possible trades, and that this is higher than any alternative. From the plot, it also appears to be optimal to trade more frequently when there is higher installed capacity. The quantPowEdge algorithm trades infrequently but it also always produces the highest trading costs (Figure 10), while the second least costly quantile algorithm, quantPowMed, results in far fewer trades – the lowest of any alternative. It is not visible in these simulations, but in a real market, with real liquidity risk, it seems possible that quantPowMed would be the best quantile algorithm. Conclusions and Future Work Simulated intraday trading suggests that German TSOs or direct marketers which have smaller installed capacities may benefit from using probabilistic wind power forecasts. An even larger benefit may accrue with the use of a price forecast. Our market model may have the effect of smoothing out price volatility and illiquidity, so we may be missing their effects on trading algorithm performance. However, if frequent trading on illiquid real markets does result in severe penalties, then the quantPowMed probabilistic trading algorithm, developed for this work, may be a good option. A next step is to re-evaluate probabilistic trading algorithms on a market model which better simulates such illiquidity. ACKNOWLEDGMENT Supported by IRPWIND (European Union 7th Framework Programme, 609795) and EWeLINE (0325500A, German Federal Ministry for Economic Affairs and Energy). References Biermann, K.; Cali, Ü.; Füller, G.; Haubold, R.; Heinze, D.; Herrmann, O.; Jursa, R.; Lange, B.; Moradi, J.; Rohrig, K. & others. “Entwicklung eines Rechenmodells zur Windleistungsprognose für das Gebiet des deutschen Verbundnetzes” Kassel: Institut für Solare Energieversorgungstechnik (ISET), 2005 Bofinger, S.; Luig, A. & Beyer, H. “Qualification of wind power forecasts” Proceedings of the Global Wind Power Conference, 2002 Braun, A. & Dobschinski, J. “Error Reduction of Regional Wind Power Forecast by Integrating Spatio-temporal Information into an Artificial Intelligence Model.” 14th Wind Integration Workshop, 2014 Bundesnetzagentur, “Verordnung zur Ausführung der Verordnung zur Weiterentwicklung des bundesweiten Ausgleichsmechanismus”, Bonn, 22.02.2010. Chernozhukov, V.; Fernández-Val, I. & Galichon, A. “Quantile and Probability Curves Without Crossing.” Econometrica, Blackwell Publishing Ltd, 2010, 78, 1093-1125 Duda, R. O.; Hart, P. E. & Stork, D. G. “Pattern Classification.” Wiley-Interscience, 2001 EPEX SPOT SE. EPEX SPOT Price List April 2014. http://​static.epexspot.com​/​document/​26643/​EPEX%20SPOT%20Price%20List%20April%202014.pdf (accessed September 8, 2014). EPEX SPOT SE (2015). “EPEX SPOT and ECC to reduce Intraday lead time on all markets. Trading up to 30 minutes before delivery.” Press release. Paris, Leipzig, Bern, Vienna, 2015. EPEX SPOT SE, “Day-Ahead Auction,” 2015. [Online]. Available: http://www.epexspot.com/en/market-data/dayaheadauction EPEX SPOT SE; European Commodity Clearing. “EPEX SPOT and ECC to reduce Intraday lead time on all markets. Trading up to 30 minutes before delivery – Austrian lead time decreases by 45 minutes.” Paris, Leipzig, Bern, Vienna, 2015 50Hertz Transmission GmbH, Amprion, TenneT TSO GmbH, TransnetBW GmbH, “Modell zur Berechnung des regelzonenübergreifenden einheitlichen Bilanzausgleichsenergiepreises (reBAP) unter Beachtung des Beschlusses BK6-12-024 der Bundesnetzagentur vom 25.10.2012,” 2012. EPEX SPOT SE, “EPEX SPOT Price List April 2014,” 2014. [Online]. Available: http://static.epexspot.com/document/26643/EPEX%20SPOT%20Price%20List%20April%202014.pdf Garnier, E. & Madlener, R. “Balancing forecast errors in continuous-trade intraday markets.” FCN Working Paper, 2014 Guyonk, I. and Elisseeff, A. “An introduction to variable and feature selection.” Journal of Machine Learning Research, 3:1157–1182, 2003. Hagan, M.T. and Menhaj, M.B. \"Training Feedforward Networks with the Marquardt Algorithm\", IEEE Transaction on Neural Networks, Vol. 5, No. 6, November 1994, pp. 989-993. Hersbach, H. “Decomposition of the continuous ranked probability score for ensemble prediction systems.” Weather and Forecasting, 2000, 15, 559-570 Hagemann, S. & Weber, C. “An empirical analysis of liquidity and its determinants in the German intraday market for electricity.” EWL Working Paper No. 17/2013, 2013 Hagemann, S.; Weber, C. & others. “Trading Volumes in Intraday Markets-Theoretical Reference Model and Empirical Observations in Selected European Markets.” University of Duisburg-Essen, Chair for Management Science and Energy Economics, 2015 Hirth, L. & Ziegenhagen, I.” Balancing Power and Variable Renewables: a Glimpse at German Data, USAEE Working Paper, 2013 Hornik, K., Stinchcombe, M. and White, H. “Multilayer feedforward networks are universal approximators.” Neural Networks, 2(5):359 – 366, 1989 Jónsson, T.; Pinson, “P.; Nielsen, H. A. & Madsen, H. “Predictive densities for day-ahead electricity prices using time-adaptive quantile regression.” European Journal of Operational Research, Applied Energy, 2013 Koenker, R. “Quantile regression.” Cambridge University Press, 2005 MacKay, “Bayesian Interpolation.” Neural Computation. Vol. 4, No. 3, 1992, pp. 415–447 Foresee and Hagan, “Proceedings of the International Joint Conference on Neural Networks,” June, 1997 Möhrlen, C.; Pahlow, M. & Jørgensen, J. U. “Investigation of various trading strategies for wind and solar power developed for the new EEG 2012 law.” Zeitschrift fur Energiewirtschaft, 2012, 36, 9 Van der Veen, R. A.; Abbasy, A. & Hakvoort, R. “A comparison of imbalance settlement designs and results of Germany and the Netherlands.” Young Energy Engineers & Economists Seminar (YEEES), 8-9 April 2010, Cambridge, UK, 2010 Vogt, S.; Dobschinski, J.; Kanefendt, T.; Otterson, S. & Saint-Drenan, Y.-M. “A Hybrid Physical and Machine Learning Based Forecast of Regional Wind Power.” 14th Wind Integration Workshop, 2015","libVersion":"0.3.2","langs":""}