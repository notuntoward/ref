{"path":"lit/lit_notes_OLD_PARTIAL/Wen19solDmdFrcstDp.pdf","text":"Optimal load dispatch of community microgrid with deep learning based solar power and load forecasting Lulu Wen a, b, Kaile Zhou a, b, c, *, Shanlin Yang a, b, **, Xinhui Lu a, b a School of Management, Hefei University of Technology, Hefei 230009, China b Key Laboratory of Process Optimization and Intelligent Decision-making of Ministry of Education, Hefei University of Technology, Hefei 230009, China c City University of Hong Kong, Kowloon, Hong Kong, China art i cle i nfo Article history: Received 10 September 2018 Received in revised form 9 January 2019 Accepted 14 January 2019 Available online 16 January 2019 Keywords: Optimal load dispatch Community microgrid Load forecasting Solar power Deep learning abstract A deep recurrent neural network with long short-term memory units (DRNN-LSTM) model is developed to forecast aggregated power load and the photovoltaic (PV) power output in community microgrid. Meanwhile, an optimal load dispatch model for grid-connected community microgrid which includes residential power load, PV arrays, electric vehicles (EVs), and energy storage system (ESS), is established under three different scheduling scenarios. To promote the supply-demand balance, the uncertainties of both residential power load and PV power output are considered in the model by integrating the fore- casting results. Two real-world data sets are used to test the proposed forecasting model, and the results show that the DRNN-LSTM model performs better than multi-layer perception (MLP) network and support vector machine (SVM). Finally, particle swarm optimization (PSO) algorithm is used to optimize the load dispatch of grid-connected community microgrid. The results show that EES and the coordi- nated charging mode of EVs can promote peak load shifting and reduce 8.97% of the daily costs. This study contributes to the optimal load dispatch of community microgrid with load and renewable energy forecasting. The optimal load dispatch of community microgrid with deep learning based solar power and load forecasting achieves total costs reduction and system reliability improvement. © 2019 Elsevier Ltd. All rights reserved. 1. Introduction Energy and environmental issues are two major challenges for global sustainable development [1]. In most countries, power supply still mainly relies on the combustion of traditional fossil fuels which has brought serious environmental problems [2]. At the same time, electricity consumption has increased signiﬁcantly with the explosive growth of population and the rapid development of economy, especially for the residential electricity consumption which shows an increasing trend and has approximately accounted for 18.68% of total electricity consumption in China by 2014 [3]. In recent years, a new generation of smart grid system has been proposed and developed rapidly to deal with these challenges [4]. As a part of smart grid, microgrid is a cluster of various distributed generators (DGs), energy storage system (ESS), loads, and other monitoring and protection devices [5]. A microgrid can meet more ﬂexible and personalized power demand of a local area. By inter- acting with the main power grid, it can signiﬁcantly improve the energy efﬁciency [6]. Meanwhile, it can also promote the local consumption of distributed energy resources, thus alleviating environmental pressures. According to whether microgrid interact with the main power grid or not, there are mainly two operation modes, i.e. islanded mode and grid-connected mode [7]. With the wide deployment of intermittent renewable energy and the integration of increasingly diverse loads in microgrid, microgrid energy management has drawn great attention [8]. Microgrid energy management aims at promoting supply-demand balance, reducing operational costs and pollutant emissions, and improving power system stability through the optimal dispatch of power generation resources and demand-side loads etc. [9,10]. The simplest dispatch model of community microgrid only includes DGs (e.g. micro turbine and diesel generator) and loads [6]. Currently, the studies on optimal load dispatch of community microgrid are becoming increasingly complex to meet actual needs by considering more components. In order to reduce pollutant * Corresponding author. School of Management, Hefei University of Technology, Hefei 230009, China. ** Corresponding author. School of Management, Hefei University of Technology, Hefei 230009, China. E-mail addresses: zhoukaile@hfut.edu.cn (K. Zhou), yangsl@hfut.edu.cn (S. Yang). Contents lists available at ScienceDirect Energy journal h omepage: w ww.elsevier.com /locate/energy https://doi.org/10.1016/j.energy.2019.01.075 0360-5442/© 2019 Elsevier Ltd. All rights reserved. Energy 171 (2019) 1053e1065 emissions caused by conventional power generation and integrate renewable energy more efﬁciently, several researches started to explore the community microgrid which contains renewable en- ergy resources [11,12]. Meanwhile, with the development of battery related technologies, the cost of energy storage is falling [13]. More and more studies attempt to explore the optimization of commu- nity microgrid that contains ESS and electric vehicles (EVs) [14,15]. ESS can smooth the output of renewable energy resources and shift the peak load in community microgrid, thereby contributing to improve the stability of power system and reduce pollutant emissions [16]. It has been an essential object in community microgrid load dispatch. In Ref. [14], the authors evaluated the economics of providing demand response under a realistic tariff using a range of storage technologies. The dynamic economic emission dispatch problem of microgrid incorporating energy storage system was further explored in Ref. [17]. In order to inte- grate renewable energy ﬂexibly, Ansari et al. [18] investigated the optimal scheduling of battery storage in distribution system with high photovoltaic (PV) arrays penetration. As for EVs, they are important components in community microgrid for optimizing load dispatch, as they are regarded as an effective way to reduce electricity consumption cost and improve stability of power system through reasonable arrangement of charging and discharging ac- tivities. In Ref. [19], a novel charging management strategy was proposed to reduce the negative effects of EVs on power system stability. Moreover, Liu et al. [20] developed a load dispatch model to integrate the renewable energy source using EVs as an ESS. There are also some research efforts that have focused on the load dispatch optimization of community microgrid that contains plug- in hybrid EVs [21,22]. However, few works have researched the community microgrid which contains power load, renewable en- ergy resources, EVs, and ESS simultaneously to meet future needs in more complex context. The inherent randomness and volatility of renewable energy pose many challenges to the load dispatch of community microgrid. Therefore, a variety of studies has considered the intermittence of renewable energy in the load dispatch model of microgrid [12,23]. For instance, in Ref. [12], the authors presented a robust optimi- zation method considering disturbances of solar power for sched- uling microgrid economically. At the same time, some data driven methods have been used to forecasting renewable energy, and thus to determine the uncertainty and provide the insights for sched- uling power load [23,24]. However, these papers just considered the uncertainty of renewable energy resources (i.e. supply side) in microgrid. The uncertainty and volatility of power load (i.e. demand side) which can affect supply-demand balance, are rarely taken into account. In traditional load dispatch model of community microgrid, residential power load is usually given directly. Few studies considered the uncertainty and volatility of load demand which plays an important role in promoting interaction and balance be- tween supply and demand. Accurate load forecasting which can present the load variation over a period in future, has provided the possibility for matching supply and demand in community microgrid. Several methods, such as support vector machine (SVM), artiﬁcial neural network (ANN), statistical regression (SR), grey model (GM), decision tree (DR), and evolution algorithm (EA), have been used for load forecasting [25e27]. For instance, in Ref. [28], the authors forecasted air conditioning load using a SVM model with parameters obtained through modiﬁed simulated annealing optimization. A decision tree was employed to forecast building energy demand levels with various variables in Ref. [29]. In addi- tion, Kaboli et al. [30] presented an optimized gene expression programming to forecast long-term electricity consumption. There are also some research efforts focused on the load forecasting using SR and GM [31e33]. Nevertheless, these methods have certain limitation in learning the internal relationship between residential power load and other factors, as well as in achieving more accurate forecasting results. Since ANN can model more complex relations between power load and related variables compared with other methods, it has been wildly used in the forecasting of residential power load [34,35]. However, general neural networks usually have weak learning ability and cannot consider the time dependencies in power load proﬁle, thus failing to achieve the best forecasting re- sults. Therefore, it is necessary to develop a deep neural network model which performs better in feature representation and map- ping as well as considers the time dependencies. Overall, few of previous studies considered the uncertainties of renewable energy resources and power load simultaneously. Be- sides, current forecasting methods have difﬁculty in achieving more accurate forecasting results. To promote the balance and interaction between supply and demand sides, both the volatility of renewable energy resources and power load should be taken into account in the optimal load dispatch of community microgrid. Also, it is necessary to develop effective and efﬁcient method for the forecasting of renewable energy output and demand-side power load. To bridge this gap, the optimal load dispatch model of a grid- connected community microgrid was developed based on the forecasting of PV power output and residential power load. The key contributions of this study are as follows. (1) A deep recurrent neural network with long short-term memory units (DRNN-LSTM) was developed to forecast aggregated power load of residential buildings and PV power output during a short-term period. (2) The optimal load dispatch model of a grid-connected com- munity microgrid which includes residential power load, PV arrays, EVs, and ESS, was established under three different scheduling scenarios. (3) The uncertainties of the PV power output and residential power load were considered in the optimal load dispatch model simultaneously by using the forecasting results of the DRNN-LSTM model. The remainder of the study is organized as follows. Section 2 introduces the related methodology. Section 3 provides the detailed description of the DRNN-LSTM model for forecasting res- idential power load and PV power output and the optimization model for ﬁnding the optimal load dispatch of community micro- grid. The experimental results and discussions are given in Section 4. Section 5 presents the conclusions. 2. Methodology 2.1. Artiﬁcial neural networks (ANN) ANN abstracts the information processing of human brain neural network, and establishes some non-linear models to learn the relationships between input vectors and output values [36]. Different connection modes will form different neural networks. A simple feedforward network with single hidden layer is shown in Fig. 1. The output from a given node j in layer i can be expressed as yj ¼ f Xn k¼1 ukjyk \u0002 qj ! (1) where f is activation function, ukj is the weight parameter between L. Wen et al. / Energy 171 (2019) 1053e10651054 node j in layer i and node k in layer i-1, yk is the output from node k in layer i-1, qj is the bias of node j, n is the total number of nodes in layer i-1. When all the outputs are obtained, the error e is calculated as e ¼ \u0002yp \u0002 ya\u00032 (2) where yp is the forecasting value and ya is the actual value. Then, all the samples are processed in the training phase, and all the weight parameters are updated as ukj)ukj \u0002 g ve vukj (3) where g is learning rate. 2.2. Recurrent neural network (RNN) and long short-term memory (LSTM) Recurrent neural network (RNN) is neural sequence model that can model temporal dependencies presented in time series data [37]. There are some ring structures in RNN, in order to remember information at previous time steps. Therefore, RNN is capable of dealing with dynamical problems of time series. For example, RNN has been widely applied in language modeling, handwriting recognition, and speech recognition [38,39]. In a simple RNN, the output at time t is determined by both the input at this time step and the output at prior time step, and it can be expressed as yðtÞ ¼ f \u0002u1xðtÞ þ u2hðt\u00021Þ þ q \u0003 (4) where f is activation function, u1 and u2 are weight parameters corresponding to different time steps, q is the bias parameters, xðtÞ is the input at time step t, hðt\u00021Þ is the output at time step t-1, and yðtÞ is the output at time step t. However, RNN always consumes long time in the training through back-propagation. Besides, the gradients are tend to vanish or explode over long time period, thus making the learning of long- term dependencies difﬁcult [40]. To address these problems, long short-term memory (LSTM) was proposed to replace the conven- tional neuron in RNN. LSTM can adaptively scales the input and output value, remembers or forgets the cell state value [41]. All these are achieved by using input, forget and output gates respectively. The schematic of a LSTM unit is shown in Fig. 2. When the input Xt enters LSTM, it passes through an activation function s which outputs ft. ft ¼ s \u0002uf ,½yt\u00021; Xt\u0003þ qf \u0003 (5) In (5), uf is weight parameter, qf is bias parameter, and yt\u00021 is the output from prior LSTM unit. Then, the forget gate will discard some information from the transient cell state, and the input gate will identify what new information remains in the cell state and update the cell state through following functions. it ¼ sðui,½yt\u00021; Xt\u0003þ qiÞ (6) C0 t ¼ tanhðuc,½yt\u00021; Xt\u0003þ qcÞ (7) Ct ¼ ft5Ct\u000214it5C0 t (8) where ui and uc are weight parameters, qi and qc are bias param- eters, it is the vector that determine what value will be updated, C0 t is the new candidate vector, Ct\u00021 is the cell state of previous LSTM unit, and Ct is the new cell state. At last, yt will be output by two activation functions in output gate, and it can be expressed as zt ¼ s \u0004up,½yt\u00021; Xt\u0003þ qp\u0005 (9) yt ¼ zt5tanhðCtÞ (10) where up is weight parameter, qp is bias parameter, zt is a part of cell state that will be output. 2.3. Particle swarm optimization (PSO) Population based algorithm is a computational technology based on the law of biological group behavior and is usually used to solve distributed problems [42]. As an important population based algorithm, PSO has been widely used to deal with the load dispatch of microgrid [43]. It starts from the random solution to ﬁnd the optimal solution by iteration, and evaluates the quality of solutions by their ﬁtness [44]. Compared with genetic algorithm, PSO algo- rithm has fewer adjustable parameters, thus making the algorithm more efﬁcient [45,46]. Since PSO is of strong capability and high efﬁciency in solving optimization problems, this study uses PSO algorithm to deal with the proposed optimal load dispatch model. In PSO algorithm, each solution of the optimization problem can Input Hidden layer output Fig. 1. A simple feedforward network with single hidden layer. σσ σtanh ×+ ×× tanh Xt ft Ct yt-1 yt Ct-1 it pt C't yt Fig. 2. Schematic of a LSTM. L. Wen et al. / Energy 171 (2019) 1053e1065 1055 be described as a particle which has a position vector and a velocity vector. Position vector represents a possible solution of the opti- mization problem, and velocity vector determines the direction and magnitude of the change in position. Position vector and velocity vector are adjusted dynamically according to previous best results. Besides, there is a ﬁtness function to estimate the present position. Suppose there are m particles, the position of particle i can be expressed as Xi ¼ðxi;1; xi;2; /xi;DÞ in D dimensional space, where 1 \u0004 i \u0004 m. Vi ¼ðvi;1; vi;2; /vi;DÞ represents the velocity of particle i. Generally, the position and velocity of particles are taken in a continuous real space. The best positions in the history of particle i are described as pi ¼ðpi1; pi2; /piDÞ, and pj ¼ðpj1; pj2; /pjDÞ de- notes the best positions of all particles, where 1 \u0004 j \u0004 m. Then the velocity and the position of particle i from iteration k to iteration kþ1 can be updated according to ( V kþ1 iD ¼ uV k iD þ c1r1\u0002pk iD \u0002 xk iD\u0003 þ c2r2\u0002pk jD \u0002 xk iD\u0003 Xkþ1 iD ¼ Xk iD þ V kþ1 iD (11) where r1 and r2 are random numbers that are distributed in [0, 1] uniformly, c1 and c2 are learning parameters which represent the self-learning ability and social learning ability of particle respec- tively, and u is inertia weight parameter. Small inertia weight parameter contributes to convergence of PSO algorithm, and large inertia weight parameter is beneﬁcial to jump out of local optimal and facilitate global search [47]. Therefore, the selection of learning parameter and inertia weight parameter is of great importance for the performance of PSO algorithm. 3. Model This study developed a DRNN-LSTM model to forecast resi- dential hourly power load and the hourly PV power output over short-term horizon respectively. Then, an optimal load dispatch model of a grid-connected community microgrid which contains residential power load, PV arrays, EVs, and ESS, was established under different scheduling scenarios. In the load dispatch model, the residential power load and the PV power output were obtained from the forecasting results of the DRNN-LSTM model. 3.1. Forecasting model 3.1.1. Model inputs Depending upon the object of forecasting, the input of the model is a given combination of schedule variables, weather vari- ables, and timescale variable. The schedule variables considered in the DRNN-LSTM model include hour of day (0e23), day of week (1e7), day of month (1e31), and month number (1e12). It is obvious that residential power load has high correlation with schedule variables. For example, the power load is low over daytime of weekday as resi- dents go to work. In contrast, the power load is high during weekend when residents spend much time staying at home. Since PV arrays can only generate electricity under sunlight, the PV po- wer output is more vulnerable to schedule variables. The weather related variables in forecasting residential power load are different from those in forecasting the PV power output. Previous study has shown that weather conditions, especially temperature, has impact on power load [31]. In this study, the weather variables for forecasting residential power load include temperature, humidity, and wind speed. Except these weather variables, global horizontal radiation, and diffuse horizontal radi- ation are considered in forecasting the PV power output. As for timescale variable, 24-h was selected as the reference sequence length of inputs. It is because that routine pattern of residential power load correspond to 24-h. In addition, the PV power output is most pertinent on a daily timescale. 3.1.2. Model structure The residential power load reﬂects the operation state of household appliances which are of high instantaneity and volatility, thus making power load proﬁle transient and non-linear. Therefore, the forecasting model should be capable to model non-linear and regularity of power load proﬁle, as well as consider the time de- pendency existed in the data. Compared with residential power load proﬁle, PV power output proﬁle shows certain periodicity and linearity. However, PV power output is vulnerable to weather conditions. To promote the inte- gration of solar power and reduce waste, more accurate forecasting is required. The DRNN-LSTM model was proposed to overcome these chal- lenges. The proposed forecasting model was a hybrid model which is consisted of input layer, RNN-LSTM layers, general perception layers, and output layer. It has been proved that hybrid model often outperforms non-hybrid model [40]. In order to achieve the best forecasting results on residential power load and PV power output, the model adopted a six-layer network structure, including an input layer, two RNN-LSTM layers, two simple hidden layers, and an output layer. Fig. 3 presents the schematic of the proposed DRNN- LSTM model. The structure of the DRNN-LSTM model is described as follows. (i) Layer 1: The input at one-hour resolution is introduced in layer 1. Each circle represents an input, including schedule variables and weather variables at that time step. The training data contains S samples. S is the number of 24-h sequences (i.e. the total number of days in the training data). (ii) Layer 2 and Layer 3: They are two RNN-LSTM layers, and each circle denotes an output vector. (iii) Layer 4, Layer 5, and Layer 6: Layer 4 and Layer 5 are two simple hidden layers, and these two layers and Layer 6 correspond to a multi-layer feedforward network. 3.1.3. Model regulations In the training of the DRNN-LSTM forecasting model, some regulations were made to improve model performance. The following regulations were adopted in this study. To eliminate the inﬂuence of dimension and accelerate training process, the training data was converted into scalar value by min- t=1 t=2 t=3 t=24 Two Hidden Layer Layer 1 Layer 2 Layer 3 Layer 4,5 Layer 6 Fig. 3. Schematic of the DRNN model. L. Wen et al. / Energy 171 (2019) 1053e10651056 max normalization which can be expressed as x0 t ¼ xi \u0002 min max \u0002 min (12) where xi is the original value, min and max are minimum value and maximum value of the variable where xi is located. Deep neural network has suffered from overﬁtting, thereby causing serious errors in testing phase. Weight decay regularization is an effective method to avoid overﬁtting by adding regularization term to cost function [48]. It can weaken the impact of perturba- tions and noise existed in training data. The error function can be expressed as e0 ¼ eðwÞþ l 2SwT w (13) where e is the original error function, w is the weight vector, and l was set as 0.01 which is default in Keras [49]. Dropout is another way to overcome overﬁtting. It deletes a certain proportion of neural units in neural network layers to change the network structure. Hence, it can adjust the learning ability of neural network model adaptively, and learn more robust characteristics [50]. The Adam was used to optimize the weight parameters in each layer [51]. It is known that conventional gradient descent algorithm takes a lot of time and computing resource in training phase. Although distributed parallel training can accelerate model learning, the computational resources needed are not reduced. Compared with conventional gradient descent algorithm, Adam algorithm has fast convergence speed and is well suitable for dealing with problems that involve large datasets and many pa- rameters [51]. In addition, it designs an independent adaptive learning rate for different parameters and requires little memory. The setting of hyper-parameters will affect the performance of machine learning algorithms. They are usually assigned empirically or determined by the model structure and data characteristics. The hyper-parameters in the DRNN-LSTM model are shown as following: (i) Length of output from Layer 2, Layer 3, Layer 4, and Layer 5; (ii) Activation function of Layer 4, Layer 5, and Layer 6; (iii) Type of neuron nodes (i.e. LSTM or GRU) in Layer 2 and Layer 3; (iv) Dropout of Layer 2, Layer 3, Layer 4, and Layer 5. To optimize the hyper-parameters, a global method is required. Hyperopt, a python library for hyper-parameters optimization, provides an effective way to optimize hyper-parameters in machine learning by parallel schemes [52]. It is a sequential model-based optimization method which presents an optimized interface that accepts an evaluation function and parameters space. Given the parameters space, the optimal structure for the DRNN-LSTM model will be found automatically. 3.1.4. Model evaluation To evaluate the performance of the proposed DRNN-LSTM model, four common metrics were used. (1) Root Mean Square Error (RMSE). RMSE is the root mean square error between actual value and forecasting value in testing phase. RMSE ¼ ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ PT t¼1\u0002ya \u0002 yp\u00032 T v u u t (14) where ya is the actual value in testing phase, yp is the corre- sponding forecasting value, and T is the total number of time steps. (2) Mean Absolute Error (MAE). MAE represents the mean ab- solute error between actual value and forecasting value in testing phase, and it can be expresses as follows. MAE ¼ PT t¼1\u0007 \u0007 \u0007ya \u0002 yp\u0007 \u0007 \u0007 T (15) The meanings of all the variables in Eq. (15) are the same as those in RMSE. (3) Mean absolute percentage error (MAPE). MAPE denotes the mean absolute error in testing phase, and the smaller value of MAPE represents better forecasting performance. MAPE ¼ 100% T XT t¼1 \u0007 \u0007 \u0007 \u0007ya \u0002 yp ya \u0007 \u0007 \u0007 \u0007 (16) The meanings of all the variables in Eq. (16) are the same as those in RMSE. (4) Pearson Correlation Coefﬁcient (PCC). PCC reﬂects the cor- relation between actual values and forecasting values in testing phase. PCC ¼ Ehðya \u0002 mðyaÞÞ\u0002yp \u0002 m \u0002yp\u0003\u0003i sya syp (17) The meanings of all the variables in Eq. (17) are the same as those in RMSE. 3.2. Optimization model In this section, the optimal load dispatch model of grid- connected community microgrid which contains power load, PV arrays, EVs, and ESS, was established. Fig. 4 shows the structure of the grid-connected community microgrid. 3.2.1. Electric vehicles charging model The EVs in the grid-connected community microgrid, can act as a load or a power source by charging or discharging to join the load dispatch of microgrid. The daily driving distance, the starting charging time, and charging load of EVs are important factors for electric vehicles to access microgrid. The daily running distance of EV obeys lognormal distribution (i.e. distance \u0005 log \u0002 Nðm1; s2 1Þ) which can be expressed as fdistanceðx1Þ¼ 1 ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 2ps1x1 p exp \u0002 ðlnx1 \u0002 m1Þ2 2s2 1 ! (18) Fig. 4. Structure of the grid-connected community microgrid model. L. Wen et al. / Energy 171 (2019) 1053e1065 1057 where m1 ¼ 3:2, s1 ¼ 0:88, and x1 is the daily running distance [53]. The charging demand of EV is determined by driving distance. At the same time, it was assumed that charging electricity of EV is equal to daily electricity consumption in this study. Fig. 5 presents the probability distribution of the daily driving distance of EVs. It can be seen from Fig. 5 that daily driving distance of an EV is mainly between 0 km and 100 km. Since the microgrid is a grid-connected community microgrid, the charging situation in which EVs owners start charging when arriving home in the evening according to their daily routine, was studied. The last return time of an EV was deﬁned as a normal distribution (i.e. t \u0005 Nðm2; s2 2Þ) which can be expressed as ftðx2Þ¼ 8 >>>>>< >>>>>: 1 ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 2ps2x2 p exp \u0002 ðx2 þ 24 \u0002 m2Þ2 2s 2 2 ! ; 0 < x2 \u0004 m2 \u0002 12 1 ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 2ps2x2 p exp \u0002 ðx2 \u0002 m2Þ2 2s 2 2 ! ; m2 \u0002 12 < x2 \u0004 24 (19) where m2 ¼ 17:6, s2 ¼ 3:4, and x2 is the last return time of an EV [53]. The probability distribution of starting charging time of an EV under above deﬁnitions is shown in Fig. 6. The daily starting charging time and driving distance of EV are independent mutually, then the charging load proﬁles of EV can be calculated by a random experiment. In this study, the total charging load of EVs are obtained by Monte Carlo simulation which can produce charging load proﬁle for each EV. At the same time, there are some constraints for the EVs charging model, including capacity constraints and charge/ discharge constraints. (1) Capacity constraints of EVs. The ratio of the residual elec- tricity to the rated capacity can be used to estimate the charge state (CS) of EVs. The CS must be in a certain range in order to protect the batteries. CSmin i \u0004 CSi \u0004 CSmax i (20) where CSi is the CS of i-th EV, CSmin i represents the lower limits, and CSmax i represents the upper limits. (2) Capacity constraints of EVs when leaving the microgrid. In order to ensure that EVs have enough power for routine running, the following presents another constraint. CSti \u0006 CSmin ti (21) where CSti is the CS of i-th EV when it leaves microgrid, and CSmin ti is the lower limit for routine running of EVs. (3) Charge/discharge constraints of EVs. To prevent the damage caused by high power of charging or discharging, the charge/ discharge constraint must be met [54]. Pmin i \u0004 PEV i \u0004 Pmax i (22) where PEV i is charging or discharging power of the i-th EV, Pmin i denotes the lower limits, and Pmax i denotes the upper limits. 3.2.2. Objective function The objective of the optimal load dispatch model is to minimize the transaction cost between the microgrid and the main power grid, depreciation cost of EVs and ESS, and the cost of pollutant treatment. The operation and maintenance cost of PV arrays was not considered in the model. (1) Transaction cost between the microgrid and the main power grid can be described as C1 ¼ XT t¼1 jPðtÞjSt (23) where PðtÞ is the transmission electricity between microgrid and the main power grid. The positive value of PðtÞ denotes that the main power grid transmits electricity to microgrid, and the nega- tive value of PðtÞ denotes that microgrid sells electricity to the main power grid. St is the electricity price over period t.If St > 0, it in- dicates that microgrid purchases electricity from the main power grid. When St < 0, it indicates that microgrid sells electricity to the main power grid. (2) Depreciation cost of EVs can be expressed as C2 ¼ Xm i¼1 0 B @ cr E1 ðti2 ti1 \u0007 \u0007 \u0007PEV i ðtÞ\u0007 \u0007 \u0007dt 1 C A (24) where m is the total number of EVs, cr is the battery replacement cost of EV, E1 is total charge-discharge capacity of EV in its life cycle,Fig. 5. Probability distribution of the daily driving distance of EVs. Fig. 6. Probability distribution of starting charging time of an EV. L. Wen et al. / Energy 171 (2019) 1053e10651058 ti1 and ti2 are the starting and ending time of i-th EV accessing to the microgrid, and PEV i ðtÞ represents the charging or discharging power of i-th EV during period t [43]. (3) Depreciation cost of ESS is deﬁned as follows [55]. C3 ¼ Xn j¼1 0 B @ cs E2 ðtj2 tj1 \u0007 \u0007 \u0007PESS j ðtÞ\u0007 \u0007 \u0007dt 1 C A (25) where n is the total number of energy storage unit (ESU), cs is the battery replacement cost of ESU, E2 is total charge-discharge ca- pacity of ESU in its life cycle, tj1 and tj2 are the starting and ending time of j-th ESU accessing to the microgrid, and PESS j ðtÞ represents the charging or discharging power of j-th ESU during period t. (4) Cost of pollutant treatment can be expressed as C4 ¼ XK k¼1ðckakÞP (26) where k represents the k-th pollutant emission, K is the total number of pollutant emissions including CO2,SO2, and NOx [43]. ck is the treatment cost of the k-th pollutant emission, ak is the pollutant discharge coefﬁcients of the k-th pollutant emission, and P is the transaction electricity that was transmitted to microgrid from the main power grid. Therefore, the total cost of the proposed model is consisted of transaction cost between microgrid and the main power grid, depreciation cost of EVs and ESS, and treatment cost of pollutant emissions. The total cost is presented as follows. min ¼ C1 þ C2 þ C3 þ C4 (27) 3.2.3. Constraints of the model The constraints of the model will be given in this section, including electricity supply and demand balance constraint, the constraint of transmission capacity between the microgrid and the main power grid, as well as capacity and charge/discharge con- straints of ESS. The following part provides the description of each constraint. (1) Electricity supply and demand balance constraint. The bal- ance of electricity supply and demand should be kept in the operation of microgrid, and the constraint can be described as: P þ Ppv þ PEVs þ PESS ¼ Pload (28) where P is the transmission power between microgrid and the main power grid, Psolar is the PV power output, PEV is the net power output of EVs, PESS is the net power output of ESS, and Pload is the total power load. (2) Capacity constraints of ESS. CSmin j \u0004 CSj \u0004 CSmax j (29) where CSj is the CS of j-th ESU, CSmin j represents the lower limits, and CSmax j represents the upper limits. (3) Charge/discharge constraints of ESS. Pmin j \u0004 PESS j \u0004 Pmax j (30) where PESS j is charging or discharging power of the j-th ESU, Pmin j denotes the lower limits, and Pmax j denotes the upper limits. (4) Transmission capacity constraints. The transmission power between microgrid and the main power grid is restricted in a certain range to ensure the stability and reliability of power system. \u0002Pmax \u0004 P \u0004 Pmax (31) where Pmax is the upper limit of transmission power. 4. Results and discussions 4.1. Data The residential power load data was obtained from Dataport website which provides a vast database of original and curated data, including utility market operations data to consumer behav- ioral research data [56]. The aggregated power load of 40 resi- dential buildings which were randomly selected, was used in this study. The residential buildings are located in Austin, Texas, including single-family homes, town homes, apartments, and stores. The power load proﬁles at 1-h resolution between January 1, 2018 and February 1, 2018 were used in the experiments. The training data corresponding to the data during January 1, 2018, 00:00 a.m. and January 28, 2018, 23:00 p.m., and the testing data corresponding to the data over January 29, 2018, 00:00 a.m.- February 1, 2018, 23:00 p.m. In addition, the weather variables of input in forecasting residential power load were obtained from MesoWest website corresponding to KATT station, Austin [57]. The proposed DRNN-LSTM model was also tested on the data obtained from Yulara PV plant [58]. The output power data over January 1, 2018eFebruary 1, 2018 of a rooftop PV whose array rating is 106.6 kW, was used in the experiment. Meanwhile, the website has provided the related weather data which is necessary for the forecasting model. The partition of training data and testing data is the same as the partition of that in forecasting residential power load. 4.2. Parameters setup The proposed forecasting model was implemented in Python by using the Keras API running on a TensorFlow backend. Table 1 presents the search space for hyper-parameters optimization. In Table 1, the ranges of output length from Layer 2, Layer 3, Layer 4, and Layer 5 are set reasonably. To avoid gradient vanishing or exploding, the type of neuron nodes on Layer 2 and Layer 3 are optimized from LSTM and GRU. It is because that both LSTM and GRU can consider the time dependency in data, but they may have different effects in analyzing different datasets. Meanwhile, the forecasting performance was estimated and optimized by using Table 1 Search space of hyper-parameters. Hyper-parameter Range Length of output from Layer 2, Layer 3, Layer 4, and Layer 5 [10, 200] Types of neuron nodes in Layer 2 and Layer 3 [LSTM, GRU] Activation functions in Layer 4, Layer 5, and Layer 6 [Sigmoid, ReLU] Dropout in Layer 2, Layer 3, Layer 4, and Layer 5 [0, 1] L. Wen et al. / Energy 171 (2019) 1053e1065 1059 different activation functions in Layer 4, Layer 5, and Layer 6. 4.3. Residential power load forecasting The proposed DRNN-LSTM model was used to forecast the short-term aggregated power load of 40 residential buildings in Austin, TX, the United States. Fig. 7 shows the training and testing process of the DRNN-LSTM model using the aggregated residential power load data over January 1, 2018eFebruary 1, 2018. Fig. 8 presents the forecasting results during January 29, 2018eFebruary 1, 2018. From Figs. 7 and 8, it can be seen that residential power load is of high volatility and ﬂuctuates between 17.36 kW and 83.02 kW. There are two power load peaks in the morning and evening during which residents tend to consume more electricity as they may cook meals, washing clothes, and showering etc. However, the power load proﬁle did not show an obvious daily periodic trends. It is because that residential electricity consumption behavior is of high randomness and usually affected by interferences from environ- ment. In Fig. 8, it can be seen that the forecasting proﬁle almost coincides with actual power load proﬁle. It illustrates that the DRNN-LSTM model has great capability in modeling complex res- idential power load and can achieve good performance. To further demonstrate the forecasting performance, multi- layer perception (MLP) network and support vector machine (SVM) were also used to forecast aggregated residential power load. Fig. 9 shows the forecasting results over January 29, 2018eFebruary 1, 2018 using MLP and SVM respectively. Table 2 presents the relative performances of the DRNN-LSTM, MLP, and SVM in fore- casting aggregated residential power load. From Fig. 9, it can be seen that MLP perform better than SVM in forecasting aggregated residential power load, but they still cannot surpass the proposed DRNN-LSTM model. Table 2 shows that RMSE and MAE of the DRNN-LSTM model in testing phase are 2.987 and 2.365 respectively, which are signiﬁcantly less than the errors ob- tained by MLP and SVM. Meanwhile, the MAPE of the DRNN-LSTM model (7.426%) is less than other two methods as well. When the PCC is close to 1, it represents good forecasting results. The PCC of the DRNN-LSTM model achieves 0.925 which is higher than MLP (0.701) and SVM (0.646). This is because that the high randomness and instantaneity of residential power load lead to complex char- acteristics of power load proﬁle, such as nonlinearity and aperio- dicity. Therefore linear model (e.g. SVM) has some limitations in forecasting residential power load. As for MLP, it cannot accom- modate the time dependency in the residential power load, thus inﬂuencing the forecasting performance. Fig. 7. Training and testing process of the DRNN-LSTM model using the aggregated residential power load data over January 1, 2018eFebruary 1, 2018. Fig. 8. Forecasting results of aggregated residential power load using DRNN-LSTM during January 29, 2018eFebruary 1, 2018. (a) MLP (b) SVM Fig. 9. Forecasting results over January 29, 2018eFebruary 1, 2018 using MLP and SVM respectively. L. Wen et al. / Energy 171 (2019) 1053e10651060 4.4. Solar power forecasting The DRNN-LSTM model was also used to forecast the PV power output including 324 panels in SITD (Sails in the Desert), Yulara, Australia.Fig. 10 shows the training and testing process of the DRNN-LSTM model using the data of PV power output over January 1, 2018eFebruary 1, 2018. Fig. 11 presents the forecasting results during January 29, 2018eFebruary 1, 2018. In Figs. 10 and 11, the proﬁle of PV power output ﬂuctuates slightly compared with the proﬁle of residential power load, and the ﬂuctuation may be caused by some ﬂoating clouds. Besides, the proﬁle exhibits certain periodicity. Generally, the PV power output is 0 during 08:00 p.m. - 05:00 a.m. since there is no sunlight at that time. At around 12:00 a.m., the PV power output reaches the maximum that is about 100 kW. From Figs. 10 and 11, it can be seen that the forecasting results almost bring into correspondence with actual data in testing phase. In other words, the model performs well in forecasting both PV power output and residential power load. It denotes that the DRNN-LSTM has strong generalization ability. At the same time, the forecasting results are compared with the results obtained by MLP and SVM. Fig. 12 shows the forecasting results over January 29, 2018eFebruary 1, 2018 using MLP and SVM respectively. Table 3 presents the relative performances of the DRNN-LSTM, MLP, and SVM in forecasting the PV power output. From Figs. 11 and 12, it can be seen that the DRNN-LSTM model achieves the best forecasting results through comparing the fore- casting power output proﬁle with actual power output proﬁle. Table 2 Evaluation metrics values of the DRNN-LSTM, MLP and SVM in forecasting aggre- gated residential power load. Models DRNN-LSTM MLP SVM RMSE 2.987 5.654 6.191 MAE 2.365 4.383 4.488 MAPE 7.43% 12.68% 19.02% PCC 0.925 0.701 0.646 Fig. 10. Training and testing process of the DRNN-LSTM model using the data of PV power output over January 1, 2018eFebruary 1, 2018. Fig. 11. Forecasting results of the PV power output using DRNN-LSTM during January 29, 2018eFebruary 1, 2018. (a) MLP (b) SVM Fig. 12. Forecasting results using MLP and SVM respectively over January 29, 2018eFebruary 1, 2018. Table 3 Evaluation metrics values of the DRNN-LSTM, MLP and SVM in forecasting the PV power output. Models DRNN-LSTM MLP SVM RMSE 7.536 12.181 14.923 MAE 4.369 7.526 11.549 MAPE 15.87% 34.71% 38.96% PCC 0.961 0.928 0.914 L. Wen et al. / Energy 171 (2019) 1053e1065 1061 Table 3 shows that RMSE, MAE, and MAPE of the DRNN-LSTM model are less than MLP and SVM. Besides, the PCC of the DRNN- LSTM model is 0.961 which is higher than MLP (0.928) and SVM (0.914). It can also be found that all the evaluation metrics values of MLP are just slightly better than those of SVM. It is because that the power output proﬁle of PV array is of certain linearity and peri- odicity. The practices have shown the capability of MLP and SVM in dealing with simple linearity problems. Overall, the proposed DRNN-LSTM model is of capability to make more accurate forecasting results than traditional method in forecasting both aggregated residential power load and the PV power output over short-term period. It provides the possibility for integrating renewable energy efﬁciently, reducing pollutant emis- sions, as well as promoting to implement more ﬂexible demand side management and maintain the stability of power system. The forecasting results of residential power load and the PV power output on February 1, 2018 will be used as the given experimental setup in the optimal load dispatch model, thereby contributing to promote interaction and supply-demand balance in the grid-connected community microgrid. 4.5. Optimization results In this section, three scheduling scenarios were discussed in order to analyze the inﬂuence of EVs and ESS on the dispatch results. Scheduling scenario 1: To prove the effect of the coordinated charging/discharging of EVs on shifting peak load and improving power system stability, the charging/discharging mode of EVs in scheduling scenario 1 was uncoordinated. At the same time, the ESS was not connected to the microgrid. Scheduling scenario 2: Compared with scheduling scenario 1, the ESS was connected to the microgrid in scheduling scenario 2. Scheduling scenario 3: In this scheduling scenario, the EVs were dispatched under co- ordinated charging/discharging mode. Besides, the EVs was con- strained to have enough power to meet the needs of residential daily driving, and the residual capacity of EVs battery will partici- pate in the load dispatch of microgrid. Meanwhile, the ESS was considered in this scheduling scenario. 4.5.1. Experimental setup Although EVs has developed rapidly, the EVs ownership is still limited. Therefore, this study assumed that the permeability of EVs was 50%, i.e. 20 EVs were connected to the microgrid. All the EVs were integrated as a whole and controlled by the centralized controller. Fig. 13 shows the daily power load proﬁles under 0% and 50% permeability of EVs. It can be seen from the two power load proﬁles that the load is low during deep night and noon, but is high during morning and evening. When the permeability of EVs is 50%, the peak load during evening will increase signiﬁcantly and bring more burden on the main power grid. This is because that the residents were assumed to charge their EVs when they arrive home in the evening, and the EVs adopt uncoordinated charging mode. Table 4 shows the parameters of EVs and each EV has the same parameters. The replacement cost of an EV battery is ¥ 30,000, and the total charge-discharge capacity in its life cycle is 240,000 kWh [59]. Table 5 shows the parameters of ESS. The replacement cost of ESS is ¥ 120,000, and the total charge-discharge capacity in its life cycle is 800,000 kWh [60]. The day-ahead hourly purchasing price and selling price of electricity are shown in Fig. 14. The selling price was assumed to be Fig. 13. Daily load proﬁle under 50% permeability of EVs. Table 4 Parameters of EVs. Parameters Value Battery capacity (kWh) 30 SC lower/upper limits (%) 10/90 Power load per 100 km (kWh/100 km) 15 10 Charging efﬁciency 0.9 Discharging efﬁciency 0.9 Charging power limit (kWh) 5 Charging power limit (kWh) 5 Replacement cost of battery (¥) 30000 Table 5 Parameters of ESS. Parameters Value Maximum capacity (kWh) 100 Initial storage (kWh) 0.5 Maximum charging rate (kW) 10 Maximum discharging rate (kW) 10 Charging efﬁciency 0.9 Discharging efﬁciency 0.9 Replacement cost of battery (¥) 120000 Fig. 14. Day-ahead hourly purchasing price and selling price of electricity. L. Wen et al. / Energy 171 (2019) 1053e10651062 10% lower than the respective purchasing price. In this study, the operation and maintenance costs of PV arrays is set to 0, the environmental parameters of the main power grid are listed in Table 6 [43]. Generally, the dispatch cycle is set as one day, and 1-h is a dispatch period. The proﬁles of residential power load and the PV power output in this load dispatch model, come from the fore- casting results on February 1, 2018. 4.5.2. Comparison of different scheduling scenarios In this section, PSO algorithm was used to optimize the load dispatch under three different scheduling scenarios. The particle population size and maximum iteration number of the algorithms were set to 100 and 500 respectively. The optimal result, which reﬂects the best performance on the load dispatch of microgrid, was obtained by 100 times run. In scheduling scenario 1, the ESS was not considered in the microgrid. PV arrays provides the renewable energy for the microgrid, and the main power grid plays a complementary role when the PV power output cannot satisfy the load demand of microgrid. Besides, the EVs adopt uncoordinated charging mode. It means that EVs just provides a part of load. The dispatch proﬁles of the microgrid under scheduling scenario 1 are shown in Fig. 15. It is can be seen from Fig. 15 that PV arrays generates solar po- wer over 05:00 a.m.-18:00 p.m., and reaches the peak output po- wer (i.e. 59.96 kW) at around 10:00 a.m. when the light condition is the best. The load proﬁle represents the total load of residential power load and the charging load of EVs. There are two peaks in load proﬁle which occur in the morning and evening respectively. We can also see that the load is always above 22 kW. This may be because that some household appliances are in operation even at deep night, such as refrigerator and air conditioner. Meanwhile, it can be found that the quantity of electricity pur- chasing from the main power grid declines with the PV power output increases. At about 10:00 a.m., the amount of electricity purchasing decreases to 0. When the value of grid proﬁle is less than 0, it means that PV arrays can generate enough solar power to satisfy the load, and the microgrid can sell extra electricity to the main power grid. By 10:00 a.m., the microgrid can sell electricity to the main power grid with the maximum power output of 30 kW. After that, the PV power output will decline gradually as the light illumination is weakening. Since the electricity purchasing price is high during 09:00AM-13:00 p.m., thus the PV arrays contributes to reduce the total costs of the microgrid. However, the load in the evening is not optimized as the residual electricity of EVs does not participate in the dispatch. Compared with scheduling scenario 1, an EES whose maximum capacity is 100 kWh was adopted in the community microgrid in scheduling scenario 2. The EVs still adopt uncoordinated charging mode. Fig. 16 shows the dispatch proﬁles of the microgrid under scheduling scenario 2. In Fig. 16, when the value of ESS proﬁle is above 0, it denotes that ESS is charging. When the value of ESS proﬁle is less than 0, it means that the ESS is discharging. From Figs. 14 and 16, it can be seen that ESS is charging in the periods of low electricity pur- chasing price and discharging in the periods of high electricity purchasing price. It can also be found that ESS is also charging in the period of 9:00 a.m. and 13:00 p.m., although the electricity pur- chasing price is high. It is because that PV array generates excess electricity during this period, and the microgrid also sells electricity to the main power grid to reduce costs. Compared with scheduling scenario 1, the adoption of ESS in microgrid contributes to shift grid peak load which occurs in the morning and evening, thus improving the stability of power sys- tem. In addition, the ESS helps to integrate distributed renewable energy and reduce electricity demand from the main power grid. Therefore, the operation costs of microgrid will be reduced and the environmental problems will be mediated. However, due to the maximum capacity of the ESS (100 kWh) is limited, the load dispatch has not yet reached the optimal result. In scheduling scenario 3, the EVs adopt coordinated charging mode. Meanwhile, the ESS is also adopted in the microgrid. The dispatch proﬁles of the microgrid under scheduling scenario 3 are shown in Fig.17. It can be seen from Fig. 17 that the peak load of grid proﬁle in the evening is further shifted to deep night during which the electricity purchasing price is low. Since the EVs adopt coordinating mode, their load proﬁle has changed a lot. When the value of EV proﬁle is above 0, the EVs are charging electricity, and when the value is less than 0, the EVs are discharging electricity. We can see that the EVs Table 6 Parameters of pollutant emission. Type Cost (¥/kg) Pollutant emission coefﬁcient of the main power grid (g/kWh) CO2 0.21 889 SO2 14.842 1.8 NOx 62.964 1.6 Fig. 15. Dispatch proﬁles of the microgrid under scheduling scenario 1. Fig. 16. Dispatch proﬁles of the microgrid under scheduling scenario 2. L. Wen et al. / Energy 171 (2019) 1053e1065 1063 is charging at deep night and discharging in the evening. Therefore, the peak load of grid during evening has been decreased signiﬁ- cantly. It can also be found that the total charging/discharging electricity of ESS is reduced compared with scheduling scenario 2. The reason is that unit cost of charging/discharging electricity of ESS is greater than that of EVs and the EVs will be given priority for dispatching. From Figs. 15 and 17, it can be found that the PV power output can meet the load demand in microgrid and sell electricity to the main power grid in 9:00 a.m.-13:00 p.m., but the ESS and EVs only charged a small amount of electricity during this period. It is because that the selling price of electricity is high in this period, and selling the excess electricity to the main power grid is best choice to reduce the total costs. Table 7 shows the total cost under the three different scheduling scenarios. It can be seen from Table 7 that the minimum dispatch cost was achieved under scheduling scenario 3. This reveals that ESS and coordinated charging mode of EVs contribute to reduce the total costs. Besides, the peak load of grid will be shifted substantially and the renewable energy will be integrated efﬁciently in scheduling scenario 3, thereby contributing to improve the stability of power system and reduce pollutant emissions. It can be believed that the battery replacement cost of ESS and EVs will be further reduced with advances in technology. Larger scale ESS and EVs with higher energy storage capacity can be applied in microgrid to reduce operation costs and shift peak load. To further reduce peak load of grid, power companies can also provide targeted demand side strategies, such as increasing elec- tricity purchasing price in peak load periods or providing incentives for residents who response the demand side strategies. Therefore, the reliability and stability of power system will be further improved. 5. Conclusions In this study, a DRNN-LSTM model was proposed to forecast aggregated residential power load and the PV power output over short-term period. Two real-world datasets were used to test the DRNN-LSTM model. The forecasting results release that the DRNN- LSTM model performs better than MLP network and SVM in fore- casting the output power of PV array. It achieved more excellent performance in forecasting aggregated residential power load with the MAPE of 7.43% since traditional forecasting methods have limitations in modeling complex nonlinear problems and cannot consider the time dependencies in the data. Therefore, the pro- posed DRNN-LSTM model presents the potential for making more accurate short-term forecasting to support economical load dispatch of community microgrid. Furthermore, this paper explored the optimal load dispatch in a grid-connected community microgrid under three different scheduling scenarios. In order to promote interaction and balance between supply and demand, the uncertainties of both the PV power output and residential power load were considered in the load dispatch optimization by using the forecasting results of the proposed DRNN-LSTM model. At last, the load dispatch model was optimized by a particle swarm optimization algorithm, and the simulation results show that EES and EVs can shift peak load, improve the solar energy utilization, as well as reduce 8.97% of daily costs. In addition, the charging mode of EVs was discussed. It shows that charging loads of EVs will be shifted form high-priced periods to low-priced periods under the coordinated charging mode, thereby reducing the total costs and improving the stability of power system. However, there are still few limitations in this study. The fore- casting model and the optimization model are two separate part, and future study needs to explore the dynamic mechanism be- tween them systematically. Besides, this study achieved hourly load dispatch in community microgrid. To optimize the load dispatch in real time, more ﬁne-grained data will be used in future. Acknowledgement This work is supported by the National Natural Science Foun- dation of China (Nos. 71822104, 71690235, 71690230 and 71521001), Anhui Science and Technology Major Project (No. 17030901024), Hong Kong Scholars Program (No. 2017-167), China Postdoctoral Science Foundation (No. 2017M612072), and the Fundamental Research Funds for the Central Universities (No. JZ2018HGPA0271). References [1] Djørup S, Thellufsen JZ, Sorknæs P. The electricity market in a renewable energy system. Energy 2018;162:148e57. [2] Pudleiner D, Pielli K. Energy efﬁciency as a means to expand energy access: a Uganda roadmap. Energy Pol 2018;120:354e64. [3] Zhang Y-J, Peng H-R. Exploring the direct rebound effect of residential elec- tricity consumption: an empirical study in China. Appl Energy 2017;196: 132e41. [4] Kovacic Z, Giampietro M. Empty promises or promising futures? The case of smart grids. Energy 2015;93:67e74. [5] Wang D, Qiu J, Reedman L, Meng K, Lai LL. Two-stage energy management for networked microgrids with high renewable penetration. Appl Energy 2018;226:39e48. [6] Lu X, Zhou K, Yang S. Multi-objective optimal dispatch of microgrid containing electric vehicles. J Clean Prod 2017;165:1572e81. [7] Parhizi S, Khodaei A, Shahidehpour M. Market-based versus price-based microgrid optimal scheduling. IEEE Trans Smart Grid 2018;9(2):615e23. [8] Kuznetsova E, Li Y-F, Ruiz C, Zio E. An integrated framework of agent-based modelling and robust optimization for microgrid energy management. Appl Energy 2014;129:70e88. [9] Khan MRB, Jidin R, Pasupuleti J. Multi-agent based distributed control archi- tecture for microgrid energy management and optimization. Energy Convers Manag 2016;112:288e307. [10] Modiri-Delshad M, Kaboli SHA, Taslimi-Renani E, Rahim NA. Backtracking search algorithm for solving economic dispatch problems with valve-point Fig. 17. Dispatch proﬁles of the microgrid under scheduling scenario 3. Table 7 Total cost under different scheduling scenarios. Scenarios Total cost Scenario 1 582.13 Scenario 2 574.04 Scenario 3 529.89 L. Wen et al. / Energy 171 (2019) 1053e10651064 effects and multiple fuel options. Energy 2016;116:637e49. [11] Pappala VS, Erlich I, Rohrig K, Dobschinski J. A stochastic model for the optimal operation of a wind-thermal power system. IEEE Trans Power Syst 2009;24(2):940e50. [12] Wang L, Li Q, Ding R, Sun M, Wang G. Integrated scheduling of energy supply and demand in microgrids under uncertainty: a robust multi-objective opti- mization approach. Energy 2017;130:1e14. [13] Asadi H, Kaboli SHA, Mohammadi A, Oladazimi M. Fuzzy-control-based ﬁve- step Li-ion battery charger by using AC impedance technique. In: Fourth in- ternational conference on machine vision (ICMV 2011): machine vision, im- age processing, and pattern analysis; 2012. p. 8349. [14] Zheng M, Meinrenken CJ, Lackner KS. Smart households: dispatch strategies and economic analysis of distributed energy storage for residential peak shaving. Appl Energy 2015;147:246e57. [15] Garcia-Torres F, Vilaplana DG, Bordons C, Roncero-Sanchez P, Ridao MA. Optimal management of microgrids with external agents including battery/ fuel cell electric vehicles. IEEE Trans Smart Grid 2018. https://doi.org/10.1109/ TSG.2018.2856524. in press. [16] Farrokhabadi M, K€onig S, Ca~nizares CA, Bhattacharya K, Leibfried T. Battery energy storage system models for microgrid stability analysis and dynamic simulation. IEEE Trans Power Syst 2018;33(2):2301e12. [17] Alham M, Elshahed M, Ibrahim DK, El Zahab EEDA. A dynamic economic emission dispatch considering wind power uncertainty incorporating energy storage system and demand side management. Renew Energy 2016;96: 800e11. [18] Ansari B, Shi D, Sharma R, Simoes MG. Economic analysis, optimal sizing and management of energy storage for PV grid integration. IEEE/PES Transmission and Distribution Conference and Exposition (T&D); 2016. p. 1e5. [19] Hashemi-Dezaki H, Hamzeh M, Askarian-Abyaneh H, Haeri-Khiavi H. Risk management of smart grids based on managed charging of PHEVs and vehicle-to-grid strategy using Monte Carlo simulation. Energy Convers Manag 2015;100:262e76. [20] Liu C, Chau K, Diao C, Zhong J, Zhang X, Gao S, et al. A new DC micro-grid system using renewable energy and electric vehicles for smart energy de- livery. IEEE Veh Power Propul Conf 2010:1e6. [21] Kamankesh H, Agelidis VG, Kavousi-Fard A. Optimal scheduling of renewable micro-grids considering plug-in hybrid electric vehicle charging demand. Energy 2016;100:285e97. [22] Morais H, Sousa T, Soares J, Faria P, Vale Z. Distributed energy resources management using plug-in hybrid electric vehicles as a fuel-shifting demand response resource. Energy Convers Manag 2015;97:78e93. [23] Craparo E, Karatas M, Singham DI. A robust optimization approach to hybrid microgrid operation using ensemble weather forecasts. Appl Energy 2017;201:135e47. [24] Gupta R, Gupta NK. A robust optimization based approach for microgrid operation in deregulated environment. Energy Convers Manag 2015;93: 121e31. [25] Kaboli SHA, Fallahpour A, Kazemi N, Selvaraj J, Rahim N. An expression-driven approach for long-term electric power consumption forecasting. Am J Data Min Knowl Disc 2016;1(1):16e28. [26] Kaboli SHA, Selvaraj J, Rahim N. Long-term electric energy consumption forecasting via artiﬁcial cooperative search algorithm. Energy 2016;115: 857e71. [27] Russo A, Raischel F, Lind PG. Air quality prediction using optimal neural networks with stochastic variables. Atmos Environ 2013;79:822e30. [28] Tao Y, Yan H, Gao H, Sun Y, Li G. Application of SVR optimized by Modiﬁed Simulated Annealing (MSA-SVR) air conditioning load prediction model. J Ind Inf Integrat 2018. https://doi.org/10.1016/j.jii.2018.04.003. in press. [29] Yu Z, Haghighat F, Fung BC, Yoshino H. A decision tree method for building energy demand modeling. Energy Build 2010;42(10):1637e46. [30] Kaboli SHA, Fallahpour A, Selvaraj J, Rahim N. Long-term electrical energy consumption formulating and forecasting via optimized gene expression programming. Energy 2017;126:144e64. [31] Chen J, Wang X, Steemers K. A statistical analysis of a residential energy consumption survey study in Hangzhou, China. Energy Build 2013;66: 193e202. [32] Liu B, Nowotarski J, Hong T, Weron R. Probabilistic load forecasting via quantile regression averaging on sister forecasts. IEEE Trans Smart Grid 2017;8(2):730e7. [33] Bahrami S, Hooshmand R-A, Parastegari M. Short term electric load fore- casting by wavelet transform and grey model improved by PSO (particle swarm optimization) algorithm. Energy 2014;72:434e42. [34] Biswas MR, Robinson MD, Fumo N. Prediction of residential building energy consumption: a neural network approach. Energy 2016;117:84e92. [35] Lind PG, Vera-Tudela L, W€achter M, Kühn M, Peinke J. Normal behaviour models for wind turbine vibrations: comparison of neural networks and a stochastic approach. Energies 2017;10(12):1944. [36] Hagan MT, Demuth HB, Beale MH. Neural network design. Boston: Pws Pub.; 1996. [37] Yogatama D, Dyer C, Ling W, Blunsom P. Generative and discriminative text classiﬁcation with recurrent neural networks. 2017. arxiv:170301898. [38] Zhang X-Y, Yin F, Zhang Y-M, Liu C-L, Bengio Y. Drawing and recognizing Chinese characters with recurrent neural network. IEEE Trans Pattern Anal Mach Intell 2018;40(4):849e62. [39] Britz D, Goldie A, Luong T, Le Q. Massive exploration of neural machine translation architectures. 2017. arxiv:170303906. [40] Rahman A, Srikumar V, Smith AD. Predicting electricity consumption for commercial and residential buildings using deep recurrent neural networks. Appl Energy 2018;212:372e85. [41] Hochreiter S, Schmidhuber J. Long short-term memory. Neural Comput 1997;9(8):1735e80. [42] Kaboli SHA, Selvaraj J, Rahim N. Rain-fall optimization algorithm: a population based algorithm for solving constrained optimization problems. J Comput Sci 2017;19:31e42. [43] Lu X, Zhou K, Yang S, Liu H. Multi-objective optimal load dispatch of microgrid with stochastic access of electric vehicles. J Clean Prod 2018;195:187e99. [44] Raﬁeerad A, Bushroa A, Nasiri-Tabrizi B, Kaboli S, Khanahmadi S, Amiri A, et al. Toward improved mechanical, tribological, corrosion and in-vitro bioactivity properties of mixed oxide nanotubes on Tie6Ale7Nb implant using multi- objective PSO. J Mech Behav Biomed Mater 2017;69:1e18. [45] Sebtahmadi SS, Azad HB, Kaboli SHA, Islam MD, Mekhilef S. A PSO-DQ current control scheme for performance enhancement of Z-source matrix converter to drive IM Fed by abnormal voltage. IEEE Trans Power Electron 2018;33(2): 1666e81. [46] Raﬁeerad A, Bushroa A, Nasiri-Tabrizi B, Fallahpour A, Vadivelu J, Musa S, et al. GEP-based method to formulate adhesion strength and hardness of Nb PVD coated on Tie6Ale7Nb aimed at developing mixed oxide nanotubular arrays. J Mech Behav Biomed Mater 2016;61:182e96. [47] Trelea IC. The particle swarm optimization algorithm: convergence analysis and parameter selection. Inf Process Lett 2003;85(6):317e25. [48] Girosi F, Jones M, Poggio T. Regularization theory and neural networks ar- chitectures. Neural Comput 1995;7(2):219e69. [49] Chollet F. Keras: the python deep learning library. Astrophysics Source Code Library; 2018. [50] Srivastava N, Hinton G, Krizhevsky A, Sutskever I, Salakhutdinov R. Dropout: a simple way to prevent neural networks from overﬁtting. J Mach Learn Res 2014;15(1):1929e58. [51] Kingma DP, Ba J. Adam: a method for stochastic optimization. 2014. arxiv: 14126980. [52] Bergstra J, Komer B, Eliasmith C, Yamins D, Cox DD. Hyperopt: a python li- brary for model selection and hyperparameter optimization. Comput Sci Discov 2015;8(1):014008. [53] Huang Y, Guo C, Wang L, Bao Y, Dai S, Ding Q. A cluster-based dispatch strategy for electric vehicles considering user satisfaction. Autom Electr Power Syst 2015;39(12):183e91. [54] Kavousi-Fard A, Abunasri A, Zare A, Hoseinzadeh R. Impact of plug-in hybrid electric vehicles charging demand on the optimal energy management of renewable micro-grids. Energy 2014;78:904e15. [55] Bucciarelli M, Paoletti S, Vicino A. Optimal sizing of energy storage systems under uncertain demand and generation. Appl Energy 2018;225:611e21. [56] Dataport, Pecan Street Inc. https://dataport.cloud, [accessed 15 April 2018]. [57] MesoWest. University of Utah Department of Atmospheric Sciences. http:// mesowest.utah.edu, [accessed 15 April 2018]. [58] DKASC. http://dkasolarcentre.com.au/locations, [accessed 16 April 2018]. [59] Automotive science and technology. http://www.pconline.com.cn/autotech/ 895/8959994.html, [accessed 10 August 2018]. [60] ESCN. http://www.escn.com.cn/news/show-392547.html, [accessed 11 August 2018]. L. Wen et al. / Energy 171 (2019) 1053e1065 1065","libVersion":"0.3.2","langs":""}