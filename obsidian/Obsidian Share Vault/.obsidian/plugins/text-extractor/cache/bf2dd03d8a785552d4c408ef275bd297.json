{"path":"lit/lit_sources/Chen11Online24hSolFrcstWeathTyp.pdf","text":"Online 24-h solar power forecasting based on weather type classiﬁcation using artiﬁcial neural network Changsong Chen ⇑, Shanxu Duan, Tao Cai, Bangyin Liu State Key Laboratory of Advanced Electromagnetic Engineering and Technology, Huazhong University of Science and Technology, Wuhan 430074, China Received 5 January 2011; received in revised form 16 August 2011; accepted 18 August 2011 Available online 13 September 2011 Communicated by: Associate Editor Frank Vignola Abstract Power forecasting is an important factor for planning the operations of photovoltaic (PV) system. This paper presents an advanced statistical method for solar power forecasting based on artiﬁcial intelligence techniques. The method requires as input past power mea- surements and meteorological forecasts of solar irradiance, relative humidity and temperature at the site of the photovoltaic power sys- tem. A self-organized map (SOM) is trained to classify the local weather type of 24 h ahead provided by the online meteorological services. A unique feature of the method is that following a preliminary weather type classiﬁcation, the neural networks can be well trained to improve the forecast accuracy. The proposed method is suitable for operational planning of transmission system operator, i.e. forecasting horizon of 24 h ahead and for PV power system operators trading in electricity markets. Application of the forecasting method on the power production of an actual PV power system shows the validity of the method. \u0002 2011 Elsevier Ltd. All rights reserved. Keywords: Power forecasting; Solar power; Neural network; Weather type; Photovoltaic power system 1. Introduction With the development of photovoltaic (PV) technology, large-scale grid-connected PV power systems have been built around the world in recent years. Since the power pro- duced by a PV system depends critically on the variability of solar irradiance and environmental factors, unexpected variations of a PV system output may increase operating costs for the electricity system by increasing requirements of primary reserves, as well as placing potential risks to the reliability of electricity supply. A priority of a grid operator is to predict changes of the PV system power production, mainly using persistence-type methods, in order to schedule the spinning reserve capacity and to man- age the grid operations. In addition to transmission system operators, online power prediction of the PV system is also required by various end-users such as energy traders, energy service providers and independent power producers, to provide inputs for diﬀerent functions like economic scheduling, energy trading, and security assessment. Many researches focus on providing a forecasting tool in order to predict PV power production with good accu- racy. Most of previous researches on this problem have used two-staged approach. In the ﬁrst stage, the solar irra- diance on diﬀerent time scales is forecasted based on Auto- regressive (AR), artiﬁcial neural networks (ANNs), Fuzzy Logic (FL) and hybrid system (Bacher et al., 2009; Mellit et al., 2005), where the historical observed data and some meteorological data for the site are used to construct the 0038-092X/$ - see front matter \u0002 2011 Elsevier Ltd. All rights reserved. doi:10.1016/j.solener.2011.08.027 ⇑ Corresponding author. Address: State Key Laboratory of Advanced Electromagnetic Engineering and Technology, College of Electrical and Electronic Engineering, Huazhong University of Science and Technology, 1037 Luoyu Road, Wuhan 430074, China. Tel.: +86 18971694075; fax: +86 27 87543658 816. E-mail address: ccsfm@163.com (C. Chen). www.elsevier.com/locate/solener Available online at www.sciencedirect.com Solar Energy 85 (2011) 2856–2870 regression model. Yona et al. (2007) used recurrent neural network to predict insolation by using only historical data in short time. Cao and Cao (2006) developed a hybrid model, which combines artiﬁcial neural network with wavelet analysis, to forecast sequences of total daily solar radiation. Kemmoku et al. (1999) used a multistage ANN to predict the insolation of the next day. Sfetsos and Coonick (2000) introduced a simple approach for the forecasting of hourly solar radiation using various artiﬁcial intelligence based techniques (ANNs and ANFIS). Mellit et al. (2005) proposed a simpliﬁed model for forecasting global solar radiation using artiﬁcial neural network and a library of Markov transition matrices approach. Hocaoglu et al. (2008) proposed a two-dimensional (2-D) representation model of the hourly solar radiation data. Cao and Lin (2008) proposed a new model for forecasting global solar irradiance based on diagonal recurrent wavelet neural network (DRWNN) and a special designed training algorithm. Hontoria et al. (2002) proposed a recurrent neural network and MLP network for generating solar radiation synthetic series. Other frequently used methods are based on the deterministic models of solar radiation, where the input parameters are the latitude and longitude as well as the estimated daily cloud cover or clearness index of a speciﬁc location (Ravinder and Umanand, 2005). In the second stage, the forecasted irradiance and temperature data are used as inputs in commercial PV simulation soft- ware, such as TRNSYS (Alamsyah et al., 2003), PVFORM (Ropp et al., 1997), and HOMER (Dalton et al., 2009). The output of these programs is a forecast simulation, on an hourly basis, of the AC power production of the PV sys- tem. Besides, in some other research works, empirical or simple numerical models were employed to calculate power production using the forecasted weather data (Zhou et al., 2007). All models reviewed here ideally assume that this ground is horizontal and extends inﬁnitely in front of the receiver with no interfering mask or shading surfaces. Real- istic installations usually involve more geometrical and solar radiation calculation complexity, but such an analysis is beyond the scope of this contribution. Before now, most solar power projects were ‘‘small scale” and were not hurt much by solar resource miscalculations thanks to error cancellations through the various calculation steps or engi- neering tolerances. Due to the extremely rapid expansion of the solar power plant industry, things are diﬀerent now. Some large-scale PV system liking Building-Inte- grated Photovoltaic (BIPV) may have various types of PV arrays installed over a wide area with diﬀerent tile and azimuth angles. In addition, signiﬁcant diversity of photo-electric conversion eﬃciency may exist among diﬀer- ent power converters. All of these can result in potentially serious errors while modeling the speciﬁc PV system. An appropriate strategy to overcome the aforemen- tioned problems could be directly forecasting the power production based on some prior information or readily accessed data. Unfortunately, only a few research works in this area have been reported in literatures so far. Chakraborty et al. (2007) reported a Fuzzy ART (adaptive resonance theory) neural network based PV generation forecasting method which was developed to coordinate the Distributed Intelligent Energy Management System (DIEMS) proposed by the authors for an AC micro-grid. In this method, the hourly measured metrological informa- tion (solar radiation, ambient temperature, air pressure, relative humidity) and the calendrical time are used as inputs of the ART Network. The output of the forecasting module are the hourly day-types of present day and the next day which are used to determined the amount of gen- eration available from PV. However, this method can fore- cast only seven levels of power output, making its accuracy very poor. In order to overcome these problems, in this paper a simpliﬁed approach for forecasting 24-h ahead of power generation using a radial basis function network (RBFN) is proposed. The RBFN permits to forecast 24-h ahead of power generation for an experimental roof-top PV sys- tem in online training. Instead of using two-staged methods as described above, the proposed technique makes a direct forecast of the power output of the PV system from its historical record and the online meteorological services. Moreover, a self-organized map (SOM) is also utilized to classify the input variables of the numerical weather predic- tions (NWPs), which improve the forecast accuracy signif- icantly (Sideratos and Hatziargyriou, 2007). The validity of the proposed method is conﬁrmed by comparing the pre- dicted values with the operating data of the PV system. The paper is organized as follows: the next section gives the database description used in this study. In Section 3 a brief introduction about the RBFN is presented, while Sec- tion 4 deals with the model implementation. Results and discussion are shown in Section 5. 2. Database description PV System has a peak power of around 18 kW and com- prises a number of equal PV modules about 170 W. It is sit- uated in the Renewable Energy Research Center (RERC) of Huazhong University of Science and Technology (HUST). Data collected in the PV power system include SCADA registers with average 5 min power delivered by the PV power system to the grid. The climate data which are being log are: solar irradiance (SI), air temperature (T), relative humidity (RH), wind speed (Ws), wind direc- tion (Wd), cloud (Cl), sunshine duration (S), air pressure (P), etc. Fig. 1 shows the measuring system. As examples of the recorded data described above, Figs. 2 and 3 show the evolution of the measured solar irradiance and air temperature from January 1st 2007 to December 31st 2007 with an hourly and daily time scale; Fig. 4 shows the PV power system on the rooftop of the Renewable Energy Research Center and Fig. 5 shows the system’s hourly power output from December 19th 2006 to Decem- ber 25th 2006, recorded in the database of the SCADA system. C. Chen et al. / Solar Energy 85 (2011) 2856–2870 2857 3. Radial basis functions The radial basis functions (RBF) model consists of three layers; the input, hidden and output layers. The nodes within each layer are fully connected to the previous layer. Each of the input variables is assigned to a node in the input layer and passes directly to the hidden layer without weights. The hidden nodes or units contain the radial basis functions (RBF), also called transfer functions, and are analogous to the sigmoid functions commonly used in the back-propagation network models. The RBF is similar to the Gaussian density function which is deﬁned by a “centre” position and a “width” parameter. The Gaussian function gives the highest output when the incoming variables are closest to the center posi- tion and decreases monotonically as the distance from the center increases. The width of the RBF unit controls the rate of decrease; for example, a small width gives a rapidly decreasing function and a large value gives a slowly decreasing function. Let xt be the incoming vector with components, x1t, x1t, ... , xrt. The output of the ith unit, ai(xt), in the hidden layer for the above input pattern is equal to aiðxtÞ¼ exp \u0002 1 r2 i xt \u0002 ^xikk2 \u0002\u0003; i ¼ 1; 2; ... ; N ð1Þ where ^xi is the center of ith RBF unit; ri is the width of ith RBF unit; N is the number of hidden layer nodes. The connections between the hidden units and the out- put units are weighted sums. The output value yj is equal to the summation of the weighted outputs of the hidden units and the biasing term of the output node, and is described by yj ¼ XN i¼1 wijaiðxtÞð2Þ where wij is the weight assigned to the connection linking the ith RBF unit to the jth output; N is the number of hid- den layer nodes (RBF functions); yj is the output value. Fig. 6 presents the training process of the RBF network. In the training activity, the parameters of the RBF units are determined in three steps. First, the unit centers are deter- mined by K-mean clustering algorithm. Then, the widths 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 0 100 200 300 400 500 600 700 800 900 1000 Time (h)Solar irradiance (W/m2) Fig. 2. Hourly solar irradiance during period January 1st–December 31st. Fig. 1. The measuring system at the site of the photovoltaic power system. 2858 C. Chen et al. / Solar Energy 85 (2011) 2856–2870 are determined by a nearest-neighbor method. Finally, weights connecting the RBF units and the output units are calculated using least squares technique techniques. The combination of unsupervised learning in the hidden layer and supervised learning in the second layer makes RBFN capable to handle nonlinear problems, likes photo- voltaic power forecasting. The eﬀectiveness of the RBFN can be enhanced by allowing some input variables of the network to have more inﬂuence on its output, with a proper selection of their normalization factors. 4. Model implementation The proposed model is based on neural networks which use as inputs time series of solar power and NWPs, in order to estimate the future solar power production. The supervi- sory control and data acquisition (SCADA) system pro- vides the values of PV power output. The NWPs are received from the meteorological services of Wuhan and the accuracy of short-term weather forecasting of Wuhan can reach 90%. The NWPs include the daily solar irradi- ance, the lowest air temperature, the highest air tempera- ture, the daily relative humidity, the daily wind speed, the wind direction, the cloud amounts, the air pressure, and so on. The daily solar irradiance, the air temperature, the daily wind speed, the cloud amount, and the air pressure are quantiﬁed by Watt-hour per square meter, centigrade, meter per second, Pascal, respectively. The cloud amounts include total cloud amount and low cloud amount. When there is no cloud in the sky, total cloud amount is recorded as 0. When the sky is completely obscured by clouds, total cloud amount is recorded as 10. Moreover, Total cloud amount is recorded as 1 when one-tenth of the sky is obscured by clouds; total cloud amount is recorded as 2 when two-tenths of the sky is obscured by clouds, and so on. Low cloud amount has the same deﬁnition. 4.1. Weather type classiﬁcation It can be seen from the data of the above SCADA sys- tem that diﬀerent weather types (Chel and Tiwari, 2011) can lead to a signiﬁcant change in PV system output power. Fig. 7 displays the experimental hourly output power data for PV system with diﬀerent weather types. In Fig. 7, the power output at 12:00 in the cloudy days (November 20th 2006 and December 28th 2006) is about 3.0 kW; power output at 12:00 in the rainy days (December 7th 2006 and December 8th 2006) is about 0.1 kW, and power output at 12:00 in the sunny days (December 15th 2006 and 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 -5 0 5 10 15 20 25 30 35 40 Time (h)Air temperature ()ºC Fig. 3. Hourly air temperature during period January 1st–December 31st. Fig. 4. The PV power system on the rooftop of the Renewable Energy Research Center. C. Chen et al. / Solar Energy 85 (2011) 2856–2870 2859 December 16th 2006) is about 10 kW. In order to make the performance of the applied RBfs more eﬀective, the photo- voltaic power prediction model separates the time-series of PV system power data and NWPs into three sets according to the weather condition applying a self-organized map (SOM). The inputs of the self-organized map include the solar irradiance, total cloud amount and low cloud amount. The type of weather is classiﬁed in three groups: sunny, cloudy and rainy. In general, the type of weather is deﬁned as sunny when the solar irradiance, total cloud amount and low cloud amount are high, low, and low respectively. The type of weather is rainy when the solar irradiance, total cloud amount and low cloud amount are low, high, and high respectively. Total cloud amount is deﬁned as low when it is between 0 and 3, and deﬁned as high when it is between 8 and 10. Low cloud amount has the same deﬁnition. The overall system consists of three models: the sunny photovoltaic power prediction model, the cloudy photovoltaic power prediction model and rainy (snowy) photovoltaic power prediction model. The ﬁnal prediction is given by three radial basis function networks. These models are described in more detail in the following subsections. 4.2. The identiﬁcation of the main factors For PV system, there are many factors which can inﬂu- ence the output character such as solar irradiation, system transfer eﬃciency, installation angle, atmospheric pressure, and temperature (Jewell and Unruh, 1990; Rahman and Yamashiro, 2007; Kornelakis and Koutroulis, 2009). To make the description about the proposed method 6 8 10 12 14 16 18 20 0 2 4 6 8 10 12 Time: (h)Power output of PV system (kW) Dec. 19th Dec. 20th Dec. 21st Dec. 22nd Dec. 23rd Dec. 24th Dec. 25th Fig. 5. Experimental data of power output of PV system. Initialize Compare & , Repeat? Select the centre The data set is divided into K subsets Recalculate the centre End Calculate the width Calculate the weight ˆ ix 'ˆ ix 'ˆ ix ˆ ix =ˆ ix 'ˆ ix Fig. 6. The training process of BRF networks. 2860 C. Chen et al. / Solar Energy 85 (2011) 2856–2870 understandable, the system’s daily output recorded in the database of the SCADA system is taken as an example. Before applying the training algorithm, the data (input/ output) should be normalized to [0, 1] using Eq. (3). y\u0003 i ¼ yi \u0002 ymin ymax \u0002 ymin ð3Þ where yi is the original data value; y\u0003 i is the corresponding normalized variable; ymin is the minimum value in {yi}; ymax is the maximum value in {yi}. The data are received from SCADA system and the meteorological services of Wuhan. The time period is 1 year. ymin is the minimum value in 365 days and ymax is the maximum value in 365 days. When yi is the minimum value in 365 days, y\u0003 i correspond to 0; when yi is the maximum value in 365 days, y\u0003 i correspond to 1. The data given in Figs. 8–12 are from August 16th 2006 to September 30th 2006. The term “d” in the x-axes label in Figs. 8–12 stands for “day”. Fig. 8 shows the variational features of the power output of PV system and solar irradiation. From Fig. 8, it is found that the trends of power output of PV system and solar irradiation are essen- tially similar. When the solar irradiation increase, the power output of PV system increase gradually; when the 6 8 10 12 14 16 18 20 0 2 4 6 8 10 12 Time (h)Power output of PV system (kW) Dec. 15th (sunny) Dec. 16th (sunny) Nov. 20th (cloudy) Dec. 28th (cloudy) Dec. 7th (rainy) Dec. 8th (rainy) Fig. 7. Experimental hourly PV system power data recorded by the data logger. 0 5 10 15 20 25 30 35 40 45 50 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 Time (d)Per unit Power output Solar irradiance Fig. 8. The per unit curves of power output of PV system and solar irradiation. C. Chen et al. / Solar Energy 85 (2011) 2856–2870 2861 solar irradiation decrease, the power output of PV system decrease gradually. It is remarkable that the peak and val- ley points of both curves are essentially coincident. There is a great correlation between the power output of PV system and solar irradiation. Fig. 9 presents the variational features of the power out- put of PV system and air temperature. Compared with the correlation between solar irradiation and power output of PV system, it is found that the trends of air temperature and power output of PV system are basically similar in shape and diﬀerent in amplitude. Fig. 10 presents the variational features of the power output of PV system and relative humidity. It is found that the trends of relative humidity and power output of PV sys- tem are basically opposite in shape. Fig. 11 presents the variational features of the power output of PV system and wind speed. The wind contributes to better the heat dissipation and consequently to lower the cell temperature, therefore the wind speed is used to fore- cast the power output of the PV system. Fig. 12 presents the variational features of the power output of PV system and pressure. 0 5 10 15 20 25 30 35 40 45 50 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 Time (d)Per unit Power output Air temperature Fig. 9. The per unit curves of power output of PV system and air temperature. 0 5 10 15 20 25 30 35 40 45 50 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 Time (d)Per unit Power output Relative humidity Fig. 10. The per unit curves of power output of PV system and relative humidity. 2862 C. Chen et al. / Solar Energy 85 (2011) 2856–2870 Fig. 13 presents the relationship between PV power out- put and ﬁve weather variables in sunny days from August 26th 2006 to September 1st 2006. The results show that solar irradiation, wind speed, air temperature and relative humidity can be selected as input variable. 4.3. RBFN forecasting model The well-known RBFN is used for developing an online short-term forecasting model of 24 h ahead photovoltaic system power. The used RBFN consists of one input layer, one hidden layer and one output layer. The input layer accepts as parameters the day of the month and the daily power output of the PV system Ps(t) (i.e. at the time t), the mean daily relative humidity H(t + 1), the mean daily wind speed W(t + 1), the mean daily solar irradiance I(t + 1) and the daily air temperature T(t + 1) obtained by NWPs (i.e. at the time t + 1), while the output layer gives as parameters the 24 h of photovoltaic power at the next day (i.e. at the time t + 1). Therefore, the numbers 0 5 10 15 20 25 30 35 40 45 50 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 Time (d)Per unit Power output Wind speed Fig. 11. The per unit curves of power output of PV system and wind speed. 0 5 10 15 20 25 30 35 40 45 50 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 Time (d)Per unit Power output Pressure Fig. 12. The per unit curves of power output of PV system and pressure. C. Chen et al. / Solar Energy 85 (2011) 2856–2870 2863 of the neurons within the hidden layers are optimized dur- ing the learning step of the network, according with a spec- iﬁed criterion such as a Root Mean Square Error (RMSE). The proposed RBFN structure, shown in Fig. 14, can be expressed by the following relationship between input/out- put parameters: ðP 1ðt þ 1Þ; P 2ðt þ 1Þ; ... ; P 24ðt þ 1ÞÞ ¼ f ðIðt þ 1Þ; T ðt þ 1Þ; H ðt þ 1Þ; W ðt þ 1Þ; P sðtÞ; tÞð4Þ where f is a non-linear approximation function, which can be estimated based on the weights and the bias of the opti- mal RBFN structure. The database described in Section 2 is used for training, validating and testing the proposed RBFN-forecaster. Since it is a single train-and-test experiment, the holdout estimate of error rate will be misleading if we happen to get an “unfortunate” split. The training set is used to ﬁnd the optimal weights and the bias of the RBFN. For online training of neural networks, the training progress of the methodology is as follows. First, train a neural network with the available historical data. Then, the neural network makes predictions for time sample t + 1 at the time stamp t. When the measured values of time sample t + 1 are known, the neural network forecasts is trained again, and weights and bias of the network are updated. The proce- dure of the overall photovoltaic power prediction is shown in Fig. 15. 5. Results and discussion This section presents the prediction results obtained with the general regression neural network methodology described in Section 4 for the three photovoltaic power pre- diction models, as well as an assessment of the impact of each neural network parameter on the training results. The ﬁrst step is to analyze the impact of the number of hidden nodes and spread values in neural network training. For this purpose, the data described in Section 2 is used. The objective is to change only one parameter at each time. Fig. 16 presents the results for sunny days with diﬀerent number of hidden nodes and a ﬁxed spread values. In Fig. 16, Nas is the actual value of PV system power output, Nf5, Nf10, Nf15 are the predicted values when the numbers of hidden nodes in hidden layer are 5, 10, and 15 respec- tively. The same behavior is veriﬁed for cloudy days and rainy days. Fig. 17 presents the results for sunny days with ﬁxed number of hidden nodes and diﬀerent spread values. In Fig. 17, Nf01, Nf04, Nf07 are the predicted values when the spread values are 0.1, 0.4, and 0.7 respectively. The same behavior is veriﬁed for cloudy days and rainy days. The selections of the number of hidden nodes and spread value in RBFN are both the most diﬃcult and important steps. The RMSE from the K-fold cross-valida- tion error is used to select the optimal number of hidden nodes. In K-fold cross-validation, the original dataset is partitioned into K subsets. For each cross-validation step, a single subset is retained as the test set, and the remaining K-1 subsets are used as training set. The cross-validation process is then repeated K times, with each of the K subsets used exactly once as the test set. The K results from the folds then can be averaged (or otherwise combined) to pro- duce a single estimation. In this work K is set to 10. Figs. 18–20 present the predicted results for sunny days (January 7th–10th 2007), cloudy days (January 18th–21st 2007) and rainy days (January 1st–4th 2007) respectively. Nas, Nac and Nar are the actual values of PV system 123456 7 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 Time (d)Per unit Power output Solar irradiance Air temperture Relative humidity Presure Wind speed Fig. 13. The relationship between PV power output and ﬁve weather variables in sunny days. Input layer Hidden layer Output layer . . . 1 . . . 2 24 P24(t+1) P2(t+1) P1(t+1)3 4 6 5 W(t+1) T(t+1) H(t+1) I(t+1) 2PS(t) 1t Fig. 14. The RBFN structure for forecasting 24-h of photovoltaic power output. 2864 C. Chen et al. / Solar Energy 85 (2011) 2856–2870 power output when the weather types are sunny, cloudy and rainy respectively, Nfs, Nfc and Nfr are the predicted values when the weather types are sunny, cloudy and rainy respectively. In the ﬁgures, comparison between the RBFN-forecasted values of 24 h power output and the experimental data for 4 sunny days, 4 cloudy days and 4 rainy days is shown. As can be seen, the predicted values of power output have a good agreement with the measured values for the sunny day and cloudy days, while the results are acceptable for rainy days. Start SOM Select architecture and training parameters Sunny Rainy(Snowy)Cloudy PV power, NWP timeseries Train the model Evaluate the model Compare Ek & Ek-1 Select the best model and train it Assessfinal model Select different parameters Select architecture and training parameters Train the model Evaluate the model Compare Ek & E k-1 Select the best model and train it Assessfinal model Select different parameters Select architecture and training parameters Train the model Evaluate the model Compare Ek & Ek-1 Select the best model and train it Assessfinal model Select different parameters Fig. 15. The procedure of the overall photovoltaic power prediction. 0 20 40 60 80 100 -2 0 2 4 6 8 10 12 14 Time (h)Power output (kW) Nas Nf5 Nf10 Nf15 Fig. 16. The forecasting results with diﬀerent nodes of hidden layer. C. Chen et al. / Solar Energy 85 (2011) 2856–2870 2865 In order to evaluate the obtained results, diﬀerent statis- tical parameters for each predicted 24-h have been calcu- lated: the correlation coeﬃcient r, the mean absolute percentage error MAPE. The MAPE provides information on the short-term performance and represents a measure of the variation of predicted values around the measured data. 020 40 60 80 100 -2 0 2 4 6 8 10 12 14 Time (h)Power output (kW) Nas Nf01 Nf04 Nf07 Fig. 17. The forecasting results with diﬀerent spread values. 0 2040 6080 100 0 2 4 6 8 10 12 Time (h)Power output (kW) Nas Nfs Fig. 18. The forecasting results of the model in sunny days. 2866 C. Chen et al. / Solar Energy 85 (2011) 2856–2870 MAPE ¼ 100 N XN i¼1 P f i \u0002 P a i \u0004 \u0004 \u0004 \u0004 P a i % ð5Þ where N is the total number of data; P f i is the forecasted value; P a i is the actual value; i is the index of the data. It’s worthy to note that at nighttime P a i values are near to 0 kW and thus the corresponding absolute percentage error (APE) of P f i \u0002 P a i \u0004 \u0004 \u0004 \u0004=P a i will approach to inﬁnite even if the error is small. Therefore all va- lue-pairs of ðP f i ; P a i Þ where P a i = maxfP a i gN i¼1 are removed from P f i ; P a i \u0005\u0006\u0007\b while computing the MAPE value in (5). 0 2040 6080 100 0 1 2 3 4 5 6 7 8 9 Time (h)Power output (kW) Nac Nfc Fig. 19. The forecasting results of the model in cloudy day. 0 20 40 60 80 100 0 0.5 1 1.5 2 2.5 Time (h)Power output (kW) Nar Nfr Fig. 20. The forecasting results of the model in rainy day. C. Chen et al. / Solar Energy 85 (2011) 2856–2870 2867 A summary of the determined MAPE is shown in Table 1 for 4 sunny days (January 7th–10th 2007), 4 cloudy days (January 18th–21st 2007) and 4 rainy days (January 1st–4th 2007). According to the results obtained in Table 1, it can be noticed that the correlation coeﬃcient varies in the range 98–99%, and the mean absolute percentage error is between 10.80%, 9.38%, 8.29%, and 9.33% for the simulated sunny days 7th, 8th, 9th and 10th January, 2007. The above results show that the developed RBFN-fore- casters is very suitable for the prediction of sunny days and cloudy days (r is between 96% and 99%), while it also pro- vides acceptable results for rainy days. Fig. 21 presents the forecasting results of the RBF net- work and the empirical model (Mellit and Pavan, 2010). In Fig. 21, Nem is the calculated values of the empirical model and is the observed solar irradiance. Table 2 pre- sents the mean absolute percentage errors between the model Nfs and the model Nem. The predicted results dem- onstrate that the model Nfs is likely to be more eﬀective than the model Nem according to the mean absolute per- centage errors. Fig. 22 presents the forecasting results of diﬀerent mod- els. In Fig. 22, Nfy is the forecasting model with weather type classiﬁcation, and Nfn is the one without weather type classiﬁcation. In Fig. 22, the performance of both predic- tion models applied on the same PV system is compared. From this comparison, it can be seen that the performance of the proposed method with weather type classiﬁcation is superior to the one without weather type classiﬁcation. There is no doubt that the accuracy of the NWPs will aﬀect the prediction of the PV output. Fig. 23 presents the forecasting results of the models with inaccurate weather forecasting. Nfs09 and Nfs07 are the predicted val- ues in the sunny days when the accuracies of the NWPs are 90% and 70% respectively. Table 3 presents the mean Table 1 Mean absolute percentage error and correlation coeﬃcient between the measured and the forecasted power. Weather type Correlation coeﬃcient (%) MAPE (%) 1 Sunny 99.39 10.80 2 Sunny 98.52 9.38 3 Sunny 98.43 8.29 4 Sunny 98.72 9.33 5 Cloudy 99.05 6.36 6 Cloudy 99.88 9.18 7 Cloudy 96.48 15.08 8 Cloudy 98.41 8.89 9 Rainy 48.92 37.23 10 Rainy 53.21 36.60 11 Rainy 81.49 54.44 12 Rainy 78.90 24.16 0 2040 6080 100 0 2 4 6 8 10 12 Time (h)Power output (kW) Nas Nfs Nem Fig. 21. The forecasting results of the RBF network and empirical model. Table 2 Mean absolute percentage error between the model Nfs and the model Nem. Weather type MAPE (Nfs) (%) MAPE (Nem) (%) 1 Sunny 10.80 46.21 2 Sunny 9.38 38.93 3 Sunny 8.29 34.25 4 Sunny 9.33 36.99 Mean Sunny 9.45 39.10 2868 C. Chen et al. / Solar Energy 85 (2011) 2856–2870 absolute percentage errors of the models with inaccurate weather forecasting. 6. Conclusions A new online forecasting model for PV power system by using RBF network has been developed and applied. The model accepts as input parameters the mean daily solar 0 50 100 150 200 250 300 0 2 4 6 8 10 12 Time (h)Power output (kW) Na Nfy Nfn Fig. 22. The forecasting results of diﬀerent models. 0 20 40 60 80 100 0 2 4 6 8 10 12 Time (d)Per unit Nas Nfs Nfs09 Nfs07 Fig. 23. The forecasting results of the models with inaccurate weather forecasting. Table 3 Mean absolute percentage error of the models with inaccurate weather forecasting. Weather type MAPE (Nfs09) (%) MAPE (Nfs07) (%) 1 Sunny 16.47 20.93 2 Sunny 11.43 55.47 3 Sunny 12.24 45.57 4 Sunny 10.50 51.51 C. Chen et al. / Solar Energy 85 (2011) 2856–2870 2869 irradiance, the mean daily relative humidity, the mean daily wind speed, the daily air temperature and the mean daily power output of the PV system. The output is represented by the 24 h ahead of power output of the PV system. After several simulations (model section, using the 10-fold cross- validation), the best performance is obtained with the fol- lowing settings: the number of neurons in the input layer is 6, the number of neurons in the output layer is 24, and the numbers of hidden nodes in hidden layer and spread values of three models (sunny, cloudy and rainy) are 11, 15, 15, 0.4, 0.3, and 0.1 respectively. Results from the appli- cation of the proposed method to an actual PV power sys- tem show that it can be employed to forecast the daily power output of PV power system precisely. This method can play a very important role in an eﬃcient planning of the operation of PV power systems. Acknowledgements The authors would like to thank the support from the National Basic Research Program (973 Program) of China under Project 2010CB227206, the Special Fund for Meteo- rological Sciences Research in the Public Interest under Project GYHY201006036, and the National Natural Sci- ence Foundation of China under Project 50907027. References Alamsyah, T.M.I., Sopian, K., Shahrir, A., 2003. Predicting average energy conversion of photovoltaic system in Malaysia using a simpliﬁed method. Renewable Energy 29 (3), 403–411. Bacher, P., Madsen, H., Nielsen, H.A., 2009. Online short-term solar power forecasting. Solar Energy 83 (10), 1772–1783. Cao, J.C., Cao, S.H., 2006. Study of forecasting solar irradiance using neural networks with preprocessing sample data by wavelet analysis. Energy 31 (15), 3435–3445. Cao, J., Lin, X., 2008. Application of the diagonal recurrent wavelet neural network to solar irradiation forecast assisted with fuzzy technique. Engineering Applications of Artiﬁcial Intelligence 21 (8), 1255–1263. Chakraborty, S., Weiss, M.D., Simoes, M.G., 2007. Distributed intelligent energy management system for a single-phase high- frequency AC microgrid. IEEE Transactions on Industrial Electron- ics 54 (1), 97–109. Chel, A., Tiwari, G.N., 2011. A case study of a typical 2.32 kWP stand- alone photovoltaic (SAPV) in composite climate of New Delhi (India). Applied Energy 88 (4), 1415–1426. Dalton, G.J., Lockington, D.A., Baldock, T.E., 2009. Feasibility analysis of renewable energy supply options for a grid-connected large hotel. Renewable energy 34 (4), 955–964. Hocaoglu, F.O., Gerek, O.N., Kurban, M., 2008. Hourly solar radiation forecasting using optimal coeﬃcient 2-D linear ﬁlters and feed-forward neural networks. Solar Energy 82 (8), 714–726. Hontoria, L., Aguilera, J., Zuﬁria, P., 2002. Generation of hourly irradiation synthetic series using the neural network multilayer perceptron. Solar Energy 72 (5), 441–446. Jewell, W.T., Unruh, T.D., 1990. Limits on cloud-induced ﬂuctuation in photovoltaic generation. IEEE Transactions on Energy Conversion 5 (1), 8–14. Kemmoku, Y., Orita, S., Nakagawa, S., Sakakibara, T., 1999. Daily insolation forecasting using a multi-stage neural network. Solar Energy 66 (3), 193–199. Kornelakis, A., Koutroulis, E., 2009. Methodology for the design optimisation and the economic analysis of grid-connected photovoltaic systems. IET Renewable Power Generation 3 (4), 476–492. Mellit, A., Pavan, A.M., 2010. A 24-h forecast of solar irradiance using artiﬁcial neural network: application for performance prediction of a grid-connected PV plant at Trieste, Italy. Solar Energy 84 (10), 807– 821. Mellit, A., Benghanem, M., Arab, A.H., Guessoum, A., 2005. A simpliﬁed model for generating sequences of global solar radiation data for isolated sites: using artiﬁcial neural network and a library of Markov transition matrices approach. Solar Energy 79 (5), 469–482. Rahman, Md.H., Yamashiro, S., 2007. Novel distributed power generat- ing system of PV-ECaSS using solar energy estimation. IEEE Transactions on Power Systems 22 (2), 358–367. Ravinder, K., Umanand, L., 2005. Estimation of global radiation using clearness index model for sizing photovoltaic system. Renewable Energy 30 (15), 2221–2233. Ropp, M.E., Begovic, M., Rohatgi, A., Long, R., 1997. Design consid- erations for large roof-integrated photovoltaic arrays. Progress in Photovoltaics: Research and Applications 5 (1), 55–67. Sfetsos, A., Coonick, A.H., 2000. Univariate and multivariate forecasting of hourly solar radiation with artiﬁcial intelligence techniques. Solar Energy 68 (2), 169–178. Sideratos, G., Hatziargyriou, N.D., 2007. An advanced statistical method for wind power forecasting. IEEE Transactions on Power Systems 22 (1), 258–365. Yona, A., Senjyu, T., Funabashi, T., 2007. Application of recurrent neural network to short-term-ahead generating power forecasting for photo- voltaic system. In: 2007 IEEE Power Engineering Society General Meeting, pp. 3659–3664. Zhou, W., Yang, H.X., Fang, Z.H., 2007. A novel model for photovoltaic array performance prediction. Applied Energy 84 (12), 1187–1198. 2870 C. Chen et al. / Solar Energy 85 (2011) 2856–2870","libVersion":"0.3.2","langs":""}