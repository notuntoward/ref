{"path":"lit/lit_notes_OLD_PARTIAL/Chan19PhotovoltaicSystemPerformance.pdf","text":"\u0002\u0003 \u0004\u0003 \u0005\u0003 \u0006\u0003 \u0007\u0003 \b\u0003 \t\u0003 \u0003 \u000b\u0003 \u0002\f\u0003 \u0002\u0002\u0003 \u0002\u0004\u0003 \u0002\u0005\u0003 \u0002\u0006\u0003 \u0002\u0007\u0003 \u0002\b\u0003 \u0002\t\u0003 \u0002 \u0003 \u0002\u000b\u0003 \u0004\f\u0003 \u0004\u0002\u0003 \u0004\u0004\u0003 \u0004\u0005\u0003 \u0004\u0006\u0003 \u0004\u0007\u0003 \u0004\b\u0003 \u0004\t\u0003 \u0004 \u0003 \u0004\u000b\u0003 \u0005\f\u0003 \u0005\u0002\u0003 \u0005\u0004\u0003 \u0005\u0005\u0003 \u0005\u0006\u0003 \u0005\u0007\u0003 \u0005\b\u0003 \u0005\t\u0003 \u0005 \u0003 \u0005\u000b\u0003 \u0006\f\u0003 \u0006\u0002\u0003 \u0006\u0004\u0003 \u0006\u0005\u0003 \u0006\u0006\u0003 \u0006\u0007\u0003 \u0006\b\u0003 \u0006\t\u0003 \u0006 \u0003 \u0006\u000b\u0003 \u0007\f\u0003 \u0007\u0002\u0003 \u0007\u0004\u0003 \u0007\u0005\u0003 \u0007\u0006\u0003 \u0007\u0007\u0003 \u0007\b\u0003 \u0007\t\u0003 \b\f\u0003 \b\u0002\u0003 \b\u0004\u0003 \b\u0005\u0003 \b\u0006\u0003 \b\u0007\u0003 XXX-X-XXXX-XXXX-X/XX/$XX.00 ©20XX IEEE Photovoltaic System Performance Model for Output Power Forecasting Aaron Keith Y. Chan Department of Electronics, Computer, and Communications Engineering, Ateneo de Manila University Quezon City, Philippines aaron.chan@obf.ateneo.edu Erees Queen B. Macabebe Department of Electronics, Computer, and Communications Engineering, Ateneo de Manila University Quezon City, Philippines emacabebe@ateneo.edu Abstract—One of the challenges of using photovoltaic (PV) energy is its intermittent nature. Due to this, managing the electrical grid network becomes difficult. Hence, it is important to be able to predict the output power of a PV system. Being able to do so would help plant managers to effectively manage the supply of energy to meet the demand. In this study a photovoltaic system model composed of a PV array model, a DC cable model, and an inverter model was developed, and was used in conjunction with an irradiance forecasting algorithm to predict the output power of a 1 kW grid-connected photovoltaic system. A total of three system models were evaluated, each differing in the inverter model used. When using measured irradiance as input to the system models, the best model obtained a root mean square error (RMSE) of 32.957 W and a coefficient of determination (R 2) of 0.978. When using predicted irradiance as input to the system models, the best model obtained an RMSE of 118.041 W and an R2 of 0.710. Keywords—energy forecast, performance model, photovoltaic system I. INTRODUCTION In the last few years, the total global photovoltaic (PV) installed capacity has been increasing. Between 2016 and 2017 for instance, the installed capacity increased from 300 GW to around 400 GW [1]. In the Philippines, the installed capacity was at 165 MW in 2015 and increased to 896 MW in 2018 [2]. This signifies that advancements in technology and lowering of costs make solar an attractive alternative source of energy. One of the challenges of using PV energy is its intermittent nature. The time of day, day of month, month of year, and atmospheric conditions all affect the output power of a PV system. Because of these varying conditions, managing the electrical grid network becomes challenging. Thus, having a tool that can accurately forecast the output power of a PV system is important. This study aims to develop a PV system performance model using parameters commonly found in data sheets, and use it in conjunction with an irradiance prediction algorithm in order to forecast the output power of a PV system. This will help plant managers to effectively manage the supply of energy and power producers to meet their contracted capacity. Households with installed PV systems can also plan their consumption activities based on the forecasted supply. There are two main methods for forecasting the output power of a PV system – the direct method and the indirect method [3]. The direct method, also called the statistical method, utilize machine learning to directly predict the output power of the photovoltaic system. Whereas, the indirect method utilize solar irradiance forecasting and the results are used as input to a PV system model to calculate the system output power. The direct method has been shown to produce better results compared to the indirect method [4]. However, a drawback of this approach is that the PV system must be installed, and output power data must be collected and used in the machine learning algorithm. This means that forecasting cannot be done prior to the physical construction of the PV system. While in the indirect method, its main advantage is that the output power forecasting can be done before the physical construction of the PV system. Majority of the literature uses the direct method, with only 11% using the indirect method [3]. However, historical data of a PV system is not always available. Hence, in this study, the indirect method was used. II. PHOTOVOLTAIC SYSTEM AND DATA GATHERING SETUP A. Photovoltaic System Setup An actual PV system was used to validate and measure the performance of the PV system model. The schematic of the PV system is illustrated in Fig. 1. It is composed of four REC270PE PV modules connected in series and a Schneider Electric Conext RL 3000E-S grid-tie inverter. These components and the losses in the DC cables were considered in the system model. B. Data Gathering System To collect the necessary data for irradiance forecasting and for testing the system models, a data gathering system described in Fig. 2 was developed. It is composed of a weather station, a pyranometer, PV module temperature sensors, and sensors for measuring electrical properties. To measure losses within the DC cables, a DC sensor was installed immediately after the PV modules and the data logger of the inverter was Fig. 1. Diagram of the PV System. Fig. 2. Components of the Data Gathering System. APPEEC2019 1570569303 1Authorized licensed use limited to: University of Wollongong. Downloaded on May 31,2020 at 22:53:12 UTC from IEEE Xplore. Restrictions apply. used to measure the DC parameters after the DC cable. Data from the inverter was also used as the AC parameters. The sensors were connected to Arduino microcontroller units, which were then connected to a Raspberry Pi microprocessor. The data logger samples and stores the data every 10 seconds. III. PHOTOVOLTAIC SYSTEM MODELS The PV system model is composed of three sub models: the PV array model, the DC cable model, and the inverter model. Fig. 3 shows the block diagram of the model, and the corresponding input and output parameters, where G is the solar irradiance, T is the PV array temperature, P is power, V is voltage, and I refers to current. The succeeding sections discuss these models in detail. A. Photovoltaic Array Model There are two approaches in modelling the photovoltaic array: using the equivalent electric circuit model [5], and using explicit equations [6], [7]. In the first approach, a complete characterization of the PV array can be obtained. However, it requires numerical models to solve, which can be time consuming. In the second approach, only specific information about the array can be obtained, such as short-circuit current (ISC), open-circuit voltage (VOC), maximum power current (IMPP), and maximum power voltage (VMPP). In PV systems, maximum power point trackers are used, and thus it can be assumed that the PV array is always operating at the maximum power point. In this work, translation equations were used in order to translate the maximum power point parameters from standard test conditions (STC) to operating conditions. The succeeding equations describe the translation equations. The following parameters are translated based on the changes in solar irradiance and temperature: short-circuit current (ISC), open-circuit voltage (VOC), maximum power current (IMPP), and maximum power voltage (VMPP). It is important to note that in the usage of the succeeding equations, the individual PV modules have been lumped into one component model. Eq. (1) describes the effect of irradiance and temperature on VOC [8], [9]: VOC\u0002TM,GM\u0003\u0004=\u0004VOC,STC\u0004+\u0004VOC,STC\u0002VOC\u0002TM\u0004-\u0004TSTC\u0003 +\u0004 NsnkBTSTC q ln( GM GSTC ) (1) where VOC,STC is the open-circuit voltage at STC, \u0002VOC is the temperature coefficient of VOC, TM is the module temperature, and TSTC is the temperature at STC, Ns is the number of cells in series, n is the diode ideality factor, kB is the Boltzmann constant, which is equal to 1.38064852×10-23 J·K-1, q is the elementary charge, which is equal to 1.6021766208×10 -19 C, GM is the irradiance incident on the PV module, and GSTC is the irradiance at STC. Eq. (2) describes the effect of irradiance and temperature on ISC [8], [9]: ISC\u0002TM,GM\u0003 = ISC,STC\u00051 + \u0003ISC\u0002TM\u0004\u0004- TSTC\u0003\u0006 GM GSTC (2) where ISC,STC is the short-circuit current at STC, \u0003ISC is the temperature coefficient of ISC. The translation equations for IMPP and VMPP use the previous two equations. Eq. (3) describes the changes in IMPP [10]: IMPP\u0002TM,GM\u0003 = IMPP,STC ISC(TM,GM) ISC,STC (3) Eq. (4) describes the changes in VMPP [10]: VMPP\u0002TM,GM\u0003 = VMPP,STC + \u0007VOC\u0002TM,GM\u0003 - VOC,STC\b + RS(IMPP,STC - IMPP(TM,GM)) (4) In order to calculate VMPP, the series resistance (RS) of the PV module is needed. In this study, the method of Villalva et al. was used to obtain RS based on the PV module parameters provided in the data sheet [5]. B. DC Cable Model In order to calculate the power loss and voltage drop caused by the cable, the resistance of the cable was obtained. The resistance of the cable can be calculated using the equation for the resistance of a conductor [11]: RC = \u0004\u0002TC\u0003 lC AC (5) where RC is the resistance of the cable, lC is the length of the cable, AC is the cross-sectional area of the cable, and \u0004 is the resistivity of the material. In Eq. (5), resistivity is taken as a function of temperature, and is defined as [11]: \u0004(T C) = \u00040[1 + \u0003(TC - T0)] (6) where \u00040 is the resistivity of the conductor material 20°C, \u0003 is the temperature coefficient, TC is the temperature of the conductor, and T0 is equal to 20°C. The cable material was assumed to be copper. Also, the temperature of the cable was assumed to be equal to air temperature. C. Inverter Model Inverters are characterized by their efficiency, where efficiency is defined as \u0005 INV = Pout Pin (7) where Pout is the output real power of the inverter and Pin is the input power of the inverter. To model the inverter, an equation that reproduces the efficiency curves, or the corresponding power loss is needed. In the work of Driesse et al., an equation for power loss (Ploss) as a function of input power (Pin) and input voltage (Vin) was developed [12]: Ploss = f (Pin,Vin) (8) In order to compare inverters, and to avoid large values, Driesse et. al. used normalized values: Ploss Pnom = f ( Pin Pnom , Vin Vnom ) (9) Fig. 3. PV System Model Block Diagram. 2Authorized licensed use limited to: University of Wollongong. Downloaded on May 31,2020 at 22:53:12 UTC from IEEE Xplore. Restrictions apply. ploss = f (pin,vin) where Pnom is the nominal input power of the inverter and Vnom is the nominal input voltage of the inverter. Normalized values were also utilized in this study. Driesse et al. proposed two models based on Eq. (9). The first model uses a linear voltage dependency model: ploss = \u0007b00 + b01\u0002vin - 1\u0003\b +\u0007b10 + b11\u0002vin - 1\u0003\bpin +\u0007b20 + b21\u0002vin - 1\u0003\bpin 2 (10) where the bxy coefficients are to be determined through curve fitting. The second model includes an additional inverse voltage dependency: ploss = \tb00 + b01\u0002vin - 1\u0003 + b02 \u000b vin\f\r + \tb10 + b11\u0002vin - 1\u0003 + b12 \u000b vin\f\r pin + \tb20 + b21\u0002vin - 1\u0003 + b22 1 vin\f\r pin 2 (11) Using the two proposed models, the efficiency curves found in the manufacturer data sheet was reproduced. Fig. 4 shows the efficiency curves of the following: (a) from the manufacturer data sheet, (b) reproduced using Eq. (10), and (c) reproduced using Eq. (11). From the plots, Eq. (11) was able to reproduce the efficiency curves properly. Fig. 5 plots the measured efficiency curves at different operating voltages. As can be observed from the efficiency curve of the inverter, there is no voltage dependency at different operating voltages. Hence, ploss as a function of pin may suffice to model the inverter during operation. A total of three inverter models, summarized in Table I, were evaluated based on the data used for curve fitting. For inverter model 1, Eq. (11) was fitted based on the efficiency curves provided in the data sheet of the inverter. For inverter model 2, since the actual operating voltage (from 100 V to 130 V) of the inverter was below the voltages provided in the data sheet, Eq. (11) was fitted based on the actual data collected from the inverter. Inverter model 3 uses Eq. (12) to model the inverter using actual data for curve fitting: ploss=a0+a1pin+a2pin 2 (12) where the ax coefficients were determined by curve fitting. Fig. 4. Inverter Efficiency Curves (a) from Product Data Sheet [13], (b) reproduced using Eq. (10), and (c) reproduced using Eq. (11). Fig. 5. Measured Efficiency Curves at Operating Voltages. TABLE I. SUMMARY OF INVERTER MODELS. Inverter Model Equation Data Used for Curve Fitting 1 ploss = \tb00 + b01\u0002vin - 1\u0003 + b02 \u000b vin\f\r + \tb10\u0004+\u0004b11\u0002vin\u0004-\u00041\u0003\u0004+\u0004b\u000b2 \u000b vin\f\r pin + \tb\u000e\u000f\u0004+\u0004b21\u0002vin\u0004-\u00041\u0003\u0004+\u0004b\u000e2 1 vin\f\r pin 2 inverter data sheet 2 actual data 3 ploss=a0+a1pin+a2pin 2 actual data 3Authorized licensed use limited to: University of Wollongong. Downloaded on May 31,2020 at 22:53:12 UTC from IEEE Xplore. Restrictions apply. D. Irradiance Forecasting Algorithm This study used the method developed by Creayla et al., which utilized the random forest algorithm to forecast the solar irradiance [14]. Weather parameters were used as the predictors in the forecasting algorithm. IV. METRICS The following metrics were used to evaluate the performance of the models compared with the actual system [3]: mean bias error (MBE), root mean square error (RMSE), standard deviation of errors (SDE), and coefficient of determination (R 2). The succeeding equations use the following variables. Xpred is defined as the predicted or theoretical variable, and Xmeas is defined as the measured variable. Var() is defined as variance. \u0004MBE\u0004=\u0004 1 N \u0010 (Xpred -\u0004Xmeas) N i\u0004=\u00041 (13) \u0004RMSE\u0004= \u00111 N \u0010\u0007Xpred -\u0004Xmeas\b 2 N i\u0004=\u00041 (14) \u0004SDE\u0004= \u00111 N \u0010\u0007Xpred\u0004-\u0004Xmeas\u0004-\u0004MBE\b2 N \u0004i\u0004=1 (15) R2\u0004=\u00041\u0004-\u0004 Var(Xpred - Xmeas) Var(Xpred) (16) V. RESULTS AND DISCUSSION The system models were validated against the measured data. In the following sections, the system models evaluated using the measured irradiance and using the predicted irradiance are presented. A. System Model Evaluation Using Measured Irradiance The system model shown in Fig. 3 was evaluated using the measured irradiance and PV array temperature as input to the model. Fig. 6 shows the system output power comparisons using the three inverter models. Fig. 7 shows the plots comparing the power output errors. The MBE daily and hourly error plots are shown in Fig. 7 (a) and (c), while RMSE daily and hourly plots are in Fig. 7 (b) and (d). Table II lists the error values of the system model using the three inverter models. The system model that utilized the inverter model 1 obtained the highest errors as it tends to over predict. This may be attributed to the system sizing. The experimental setup did not utilize the full capacity of the inverter. System models 2 and 3 utilized inverter data from experiment, thus, they performed better with almost the same error values. In Fig. 7, large error values are observed during the hours between 9:00 and 11:00 due to shading from a nearby structure. Fig. 6. System Models Output Power Comparisons Using Measured Irradiance. Fig. 7. System Models Output Power Errors Using Measured Irradiance. TABLE II. SYSTEM MODELS OVERALL METRICS USING MEASURED IRRADIANCE. Inverter MBE (W) RMSE (W) SDE (W) R 2 Model 1 24.580 58.041 52.579 0.930 Model 2 -0.728 33.286 33.278 0.977 Model 3 -0.097 32.957 32.957 0.978 4Authorized licensed use limited to: University of Wollongong. Downloaded on May 31,2020 at 22:53:12 UTC from IEEE Xplore. Restrictions apply. B. System Model Evaluation Using Predicted Irradiance Using the predicted irradiance and the measured PV array temperature as input to the model, the system model depicted in Fig. 3 was evaluated. Fig. 8 shows a comparison between actual and predicted irradiance. The errors for this specific data set are shown in the figure. Table III shows the errors between the actual and predicted values, averaged over the whole data set. Based on the MBE, the forecasting algorithm tends to over predict. This tends to happen when irradiance rapidly changes during the middle of the day due to the presence of clouds, as seen in Fig. 8. It means that the trained model is unable to accurately predict these rapid variations. Fig. 9 shows the system output power comparisons using predicted irradiance as input to model, while Fig. 10 shows the plots comparing the power output errors of the three models. The MBE daily and hourly error plots are shown in Fig. 10 (a) and (c), while RMSE daily and hourly plots are in Fig. 10 (b) and (d). Table IV lists the error values of the system model using the three inverter models. When the predicted irradiance was used as input to the system model, model 2 did not perform as well as model 3. Upon investigation this was caused by large voltage spikes during the evening. These voltages spikes arise from Eq. (1) and are due to the non-zero irradiance prediction, as shown in Fig. 8. The resulting effect in output power is seen in Fig. 9. From Eq. (1), a small amount of irradiance is enough to generate voltage across the PV module. Inverter model 2 is dependent on the input voltage, thus, large errors occurred. This effect was not observed in Model 3 because the inverter model is dependent on input power only. Fig. 10. System Models Output Power Errors Using Predicted Irradiance. TABLE III. IRRADIANCE PREDICTION METRICS. AVERAGE ERRORS OF THE WHOLE DATASET. MBE (W·m -2) RMSE (W·m -2) SDE (W·m -2) R 2 32.817 139.896 135.992 0.755 TABLE IV. SYSTEM MODELS OVERALL METRICS USING PREDICTED IRRADIANCE. Inverter MBE (W) RMSE (W) SDE (W) R 2 Model 1 49.831 145.007 136.176 0.562 Model 2 35.000 137.519 132.991 0.606 Model 3 24.272 118.041 115.519 0.710 Fig. 9. System Models Output Power Comparisons Using Forecasted Irradiance. Fig. 8. Comparison of Predicted and Actual Irradiance. 5Authorized licensed use limited to: University of Wollongong. Downloaded on May 31,2020 at 22:53:12 UTC from IEEE Xplore. Restrictions apply. VI. CONCLUSION AND RECOMMENDATIONS The system model developed in this study is composed of three submodels: a PV array model, a DC cable model, and an inverter model. A total of three system models were evaluated each differing in the inverter model used. When using measured irradiance as input to the models, system model 3 produced the best results with an RMSE equal to 32.957 W and an R 2 equal to 0.978. When using predicted irraidance as input to the models, system model 3 again produced the best results with an RMSE equal to 118.041 W and an R 2 of 0.710. Further evaluation of the system model can be done by testing it with different configurations of PV modules, so as to take into account configurations that include parallel connections. Since the operation of the inverter unit only covered up to 30% of its nominal output power, it is suggested that a PV array with larger capacity be used to match the nominal input power of the inverter, or an inverter with a smaller power rating be used. This is so that the efficiency curve of the inverter can be evaluated in its entirety. ACKNOWLEDGMENT The authors would like to acknowledge the Department of Science and Technology - Engineering Research and Development for Technology (DOST-ERDT) for the funding support. REFERENCES [1] S. Philipps, “Photovoltaics Report,” Fraunhofer Institute for Solar Energy Systems ISE, Freiburg, Germany, Mar. 2019. [2] “2018 Power Statistics: Summary of Installed Capacity, Dependable Capacity, Power Generation and Consumption,” Department of Energy, Republic of the Philippines, Mar. 2019. [3] J. Antonanzas, N. Osorio, R. Escobar, R. Urraca, F. J. Martinez-de-Pison, and F. Antonanzas-Torres, “Review of photovoltaic power forecasting,” Solar Energy, vol. 136, pp. 78–111, 2016. [4] G. Graditi, S. Ferlito, and G. Adinolfi, “Comparison of Photovoltaic plant power production prediction methods using a large measured dataset,” Renewable Energy, vol. 90, pp. 513–519, 2016. [5] M. G. Villalva, J. R. Gazoli, and E. R. Filho, “Comprehensive Approach to Modeling and Simulation of Photovoltaic Arrays,” IEEE Transactions on Power Electronics, vol. 24, no. 5, pp. 1198–1208, May 2009. [6] E. I. Batzelis, “Simple PV Performance Equations Theoretically Well Founded on the Single-Diode Model,” IEEE Journal of Photovoltaics, vol. 7, no. 5, pp. 1400–1409, Sep. 2017. [7] J. J. Roberts, A. A. M. Zevallos, and A. M. Cassula, “Assessment of photovoltaic performance models for system simulation,” Renewable and Sustainable Energy Reviews, vol. 72, pp. 1104–1123, 2017. [8] A. Dolara, S. Leva, and G. Manzolini, “Comparison of different physical models for PV power output prediction,” Solar Energy, vol. 119, pp. 83–99, 2015. [9] L. Cristaldi, M. Faifer, M. Rossi, and S. Toscani, “A Simplified Model of Photovoltaic Panel,” in 2012 IEEE International Instrumentation and Measurement Technology Conference Proceedings, 2012, pp. 431– 436. [10] K. Ding, X. Bian, H. Liu, and T. Peng, “A MATLAB- Simulink-Based PV Module Model and Its Application Under Conditions of Nonuniform Irradiance,” IEEE Transactions on Energy Conversion, vol. 27, no. 4, pp. 864–872, Dec. 2012. [11] H. D. Young and R. A. Freedman, Sears and Zemansky’s University Physics: with Modern Physics, 11th ed. Pearson Addison Wesley, 2004. [12] A. Driesse, P. Jain, and S. Harrison, “Beyond the curves: Modeling the electrical efficiency of photovoltaic inverters,” in 2008 33rd IEEE Photovoltaic Specialists Conference, 2008, pp. 1–6. [13] “Conext RL Photovoltaic Grid Tie Inverters: Installation and Operation Manual,” Schneider Electric, Jul. 2013. [14] C. M. C. Creayla, F. C. C. Garcia, and E. Q. B. Macabebe, “Next Day Power Forecast Model Using Smart Hybrid Energy Monitoring System and Meteorological Data,” Procedia Computer Science, vol. 105, pp. 256–263, 2017. 6Authorized licensed use limited to: University of Wollongong. Downloaded on May 31,2020 at 22:53:12 UTC from IEEE Xplore. Restrictions apply.","libVersion":"0.3.2","langs":""}