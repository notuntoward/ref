{"path":"lit/lit_sources/Chatzivasileiadis22powSysMLseminar.pdf","text":"DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Machine Learning for Power Systems: Is it time to trust it? Spyros Chatzivasileiadis Associate Professor Head of Section Power Systems 1 AI4OPT Seminar Series GeorgiaTech, Fall 2022 DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 2 Department of Wind and Energy Systems Working for a sustainable future=——ManagementIHead of Department Peter Hauge Madsen Deputy Head of Department Pinistralb o AdministrationPeter Hjuler Jensen Head of Administration Seren Knudsen Wind Energy Wind Turbine Wind Energy Power and Energy { Materials & Design Systems Systems | Derma . n ~ Components (WTD) (WES) (PES) In Kingdom ~ $ Eads (WHC) : Netherlands Berlin Poland T Head of Division Head of Division | =W of el Head of Division London German Warsaw ) Ignacio Marti Kenneth Thomsen Cathy Suo Jacob @stergaard | Belgidm - “Paris ¥ MA a’ ® Slovakia Austria Lp ] France oe Hungary 3 ny W . d pl 7 —, 3 ; DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 3 DTU Wind and Energy Systems at a Glance 378 employees #1 in wind publication citations worldwide 98 PhD students 280 industry partners 70% funding that involves industry hd I “rl pr; ! fod I or TEpT(EEX Re La 5 DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Department of Wind and Energy Systems Working for a sustainable future ~100 people working on power systems DTUI Power and Energy Systems (PES) Management . Head of Division Jacob @stergaard Head of Department Peter Hauge Madsen Deputy Head of Department Peter Hjuler Jensen E-mobility PowerlLabDK (PLK) Energy Markets Power Systems Power-to-X and Distributed Storage Energy Systems and Prosumer = Integration and Analytics (PWR) (EMA) | (PTX) (DES) (EMP)wind Turbine Wind Energy Power and Energy NE) Head of Section Spyros Head of Section Head of Section Head of Section Chresten Trazholt Henrik Bindner Mattia Marinelli Wind Energy Materials & Design Systems (WES) (PES) Chatzivasileiadis : os, 2 LA “0 Headof Section Thomas Meler Sarensen Head of Section Jalal Kazempour LI) - “ Components (WTD) (WMC) Head of Division Head of DivisionHead of Division Cathy Suo Head of Division Kenneth ThomsenIgnacio Marti Jacob @stergaard : a h LY 1 ed DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Electric Power Systems PWR Section: 28+3 members; 20 nationalities 5 AC/DC Wind Power Lab DTUI Lars Herre SamMirza Nuhic Chevalier Po//erLabs Energy System Simulation Lab Agnes Nakiganda aria c 0 Jochen Konrad Jose A. L Ana Turk Daniel Miller orrent| Stiasny Sundsgaard 05€ = Vilaplana Hjortur Jéhannsson Gabriel M.G. Agro ] or . Vilera Nellikkath Kahraman Saevarsson Guests Nikos Cutululis Tonny W. Rasmussen Qscar Saborio-Romano Alessandra Follo Amir Arasteh Sulav Ghimire Sujay lgiz Ghosh Murzakhanov Vassilis Kekatos (Visiting Professor, Virginiatech, US) DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 PWR: Advanced Methods and Tools for Power System Security and Control 6 Methods Going Beyond the State-of-the-art 1. Trustworthy AI for Power Systems 2. Quantum Computing 3. Cyber Physical Systems 4.Energy Data Spaces 5. Stability, Optimization, and Control of Zero-Inertia Systems Advanced Tools 1. World-Record in Fast Real- time Security Assessment of Electric Power Systems 2. Open-Source Models of the Nordic and European Systems 3. Digitalization tools for e.g. grid black start 4.Digital Twins for Power Systems Applications 1. RTDS infrastructure and Hardware-in-the-Loop 2. Demonstration in Bornholm 3. System-stability and operation including the Bornholm and North Sea Energy Islands PWR: Advanced Methods and Tools for Power System Security and Control DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 This work would not have been possible without the hard work of several people! Many thanks to… 7 Sam Chevalier Rahul Nellikkath Jochen Stiasny Ilgiz Murzakhanov Elea Prat Lejla Halilbasic Georgios Misyris Florian Thams Andreas Venzke And to our collaborators: Dan Molzahn, GeorgiaTech Steven Low, Caltech Guannan Qu, Caltech (now at CMU) Panagiotis Papadopoulos, Robert Hamilton, Tabia Ahmad, Univ. Strathclyde Brynjar Sævarsson Spyros Chatzivasileiadis DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Machine learning: Why shall we apply it in power systems? 1. Extremely fast  can assess 100x-1’000x more of critical scenarios • computation within only a few milliseconds (100x – 1000x faster than conventional methods) – Predict fast and act faster  drastically increase power system resilience 2. Can handle very complex systems and infer from incomplete data • Excellent potential to create accurate surrogate models – Accelerate simulations; and offer good approximations of previously intractable systems But: Would an Operator ever trust AI in the Control Room? 8HE DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 This talk: Two Challenges and One Opportunity • Challenge #1: Machine Learning is extremely dependent on high-quality data. • Challenge #2: Has the Neural Network been trained to generalize well? Can we trust it? • Opportunity: “AI for Optimization”. Use trustworthy Machine Learning to capture (=approximate well) previously intractable constraints and embed them in any optimization problem – Example1: Instead of running 10,000 scenarios to determine the critical clearing time of a converter-based system, run a single optimization. 9 1G. S. Misyris, J. Stiasny, S. Chatzivasileiadis, Capturing Power System Dynamics by Physics-Informed Neural Networks and Optimization. IEEE Conference on Decision and Control (CDC), 2021 . [ .pdf ] Abbreviations I will use: • ML: Machine Learning • NN: Neural Network= DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Facts Consequence Challenge #1: ML extremely dependent on high-quality data 1. All data are not the same For a NN that assesses if a system is stable, training data close to the stability boundary contain much more information than training data far away from it. Statistical sampling is not enough 10= DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Facts Consequence Challenge #1: ML extremely dependent on high-quality data 1. All data are not the same For a NN that assesses if a system is stable, training data close to the stability boundary contain much more information than training data far away from it. Statistical sampling is not enough 2. Training data must follow the same statistical properties as real data Do we have enough historical data about e.g. outages? Is this possible? 1. For power systems: We have so many physical models. Add them! 2. We cannot trust “Neural Network Accuracy” as a performance metric 11= DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Facts Consequence Challenge #1: ML extremely dependent on high-quality data 1. All data are not the same For a NN that assesses if a system is stable, training data close to the stability boundary contain much more information than training data far away from it. Statistical sampling is not enough 2. Training data must follow the same statistical properties as real data Do we have enough historical data about e.g. outages? Is this possible? 1. For power systems: We have so many physical models. Add them! 2. We cannot trust “Neural Network Accuracy” as a performance metric Challenge #2: Has NN been trained to generalize well? 3. NN training is an extremely complex optimization procedure Prone to overfitting/underfitting Can we trust it? 12= DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Facts Consequence Challenge #1: ML extremely dependent on high-quality data 1. All data are not the same For a NN that assesses if a system is stable, training data close to the stability boundary contain much more information than training data far away from it. Statistical sampling is not enough 2. Training data must follow the same statistical properties as real data Do we have enough historical data about e.g. outages? Is this possible? 1. For power systems: We have so many physical models. Add them! 2. We cannot trust “Neural Network Accuracy” as a performance metric Challenge #2: Has NN been trained to generalize well? 3. NN training is an extremely complex optimization procedure Prone to overfitting/underfitting Can we trust it? 13 Solution=——I DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Facts Consequence Challenge #1: ML extremely dependent on high-quality data 1. All data are not the same For a NN that assesses if a system is stable, training data close to the stability boundary contain much more information than training data far away from it. Statistical sampling is not enough 2. Training data must follow the same statistical properties as real data Do we have enough historical data about e.g. outages? Is this possible? 1. For power systems: We have so many physical models. Add them! 2. We cannot trust “Neural Network Accuracy” as a performance metric Challenge #2: Has NN been trained to generalize well? 3. NN training is an extremely complex optimization procedure Prone to overfitting/underfitting Can we trust it? 14 Solution=——I DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Facts Consequence Challenge #1: ML extremely dependent on high-quality data 1. All data are not the same For a NN that assesses if a system is stable, training data close to the stability boundary contain much more information than training data far away from it. Statistical sampling is not enough 2. Training data must follow the same statistical properties as real data Do we have enough historical data about e.g. outages? Is this possible? 1. For power systems: We have so many physical models. Add them! 2. We cannot trust “Neural Network Accuracy” as a performance metric Challenge #2: Has NN been trained to generalize well? 3. NN training is an extremely complex optimization procedure Prone to overfitting/underfitting Can we trust it? 15 Solution=——I DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Closing the Loop: A Framework for Trustworthy Machine Learning in Power Systems 16 J. Stiasny, S. Chevalier, R. Nellikkath, B. Sævarsson, S. Chatzivasileiadis. Closing the Loop: A Framework for Trustworthy Machine Learning in Power Systems. Accepted to 2022 iREPSymposium -Bulk Power System Dynamics and Control -XI (iREP). Banff, Canada. July 2022. [ paper | code ]= DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Closing the Loop: Trustworthy ML for Power Systems 17 Training Database Train Neural Network Satisfied? yes no Ready to deploy in a real application Conventional Neural Network Training for Power System Applications= DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Closing the Loop: Trustworthy ML for Power Systems 18 Training Database Train Neural Network Satisfied? yes no “Sampling beyond Statistics” Focus on High- Information Content Regions: Separating hyperplanes and Directed Walks= DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Closing the Loop: Trustworthy ML for Power Systems 19 Training Database Train Neural Network with/without Physics-Informed Satisfied? yes no “Sampling beyond Statistics” Focus on High- Information Content Regions: Separating hyperplanes and Directed Walks= DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Closing the Loop: Trustworthy ML for Power Systems 20 Training Database Train Neural Network with/without Physics-Informed Satisfied? yes no “Sampling beyond Statistics” Enrich Database: NN-Informed Sampling “Sampling beyond Statistics” Focus on High- Information Content Regions: Separating hyperplanes and Directed Walks= DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Closing the Loop: Trustworthy ML for Power Systems 21 Training Database Train Neural Network with/without Physics-Informed NN Verification/ Worst-case Guarantees Final NN with Performance Guarantees Trustworthy AI Satisfied? yes no “Sampling beyond Statistics” Enrich Database: NN-Informed Sampling “Sampling beyond Statistics” Focus on High- Information Content Regions: Separating hyperplanes and Directed Walks= DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Closing the Loop: Trustworthy ML for Power Systems 22 Training Database Train Neural Network with/without Physics-Informed NN Verification/ Worst-case Guarantees Final NN with Performance Guarantees “Sampling beyond Statistics” Enrich Database: Verification- Informed Sampling Satisfied? yes no Trustworthy AI Satisfied? yes no “Sampling beyond Statistics” Enrich Database: NN-Informed Sampling “Sampling beyond Statistics” Focus on High- Information Content Regions: Separating hyperplanes and Directed Walks= DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Sampling beyond Statistics: Separating Hyperplanes and Directed Walks • Historical data are often insufficient • Need to generate our own data • Here: generate data for N-1 security+small-signal stability – Assessing the stability of 100’000s of operating points is an extremely demanding task – Immense search space – How can I do it efficiently? 23 F. Thams, A. Venzke, R. Eriksson, and S. Chatzivasileiadis, ”Efficient database generation for data-driven security assessment of power systems”. ”. IEEE Trans. Power Systems, vol. 35, no. 1, pp. 30-41, Jan. 2020. https://www.arxiv.org/abs/1806.0107.pdf= DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Sampling beyond Statistics: Separating Hyperplanes and Directed Walks • Historical data are often insufficient • Need to generate our own data • Here: generate data for N-1 security+small-signal stability – Assessing the stability of 100’000s of operating points is an extremely demanding task – Immense search space – How can I do it efficiently? 24 Proposed approach: • Can accommodate numerous definitions of power system security (e.g. N-1, N-k, small-signal stability, voltage stability, transient stability, or a combination of them) • 10-20 times faster than existing state-of- the-art approaches • Generated Databases for IEEE 14-bus and NESTA 162-bus system available! http://www.chatziva.com/downloads.html#databases F. Thams, A. Venzke, R. Eriksson, and S. Chatzivasileiadis, ”Efficient database generation for data-driven security assessment of power systems”. ”. IEEE Trans. Power Systems, vol. 35, no. 1, pp. 30-41, Jan. 2020. https://www.arxiv.org/abs/1806.0107.pdf= DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 • The goal – Focus on the boundary between stability and instability – We call it: “high information content” region • How? 1. Using convex relaxations 2. And “Directed Walks” 25 Unstable regions Stable region High information content Real data for the IEEE 14-bus system N-1 security and small-signal stability Sampling beyond Statistics: Efficient Database Generation=——I 135 140P1 —€) stable —€ unstable 145 150 DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Convex relaxations to discard infeasible regions 26 Non-convex stable region= DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Convex relaxations to discard infeasible regions 27 Non-convex stable region • Certificate: if point infeasible for semidefinite relaxation  infeasible for the original problem convex relaxation= DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Convex relaxations to discard infeasible regions 28 Non-convex stable region • Certificate: if point infeasible for semidefinite relaxation  infeasible for the original problem • If infeasible point: find minimum radius to feasibility convex relaxation= DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Convex relaxations to discard infeasible regions 29 Non-convex stable region convex relaxation • Certificate: if point infeasible for semidefinite relaxation  infeasible for the original problem • If infeasible point: find minimum radius to feasibility • Discard all points on one side of the hyperplane • A. Venzke, D.K. Molzahn, S. Chatzivasileiadis, Efficient Creation of Datasets for Data-Driven Power System Applications. PSCC 2020. https://arxiv.org/pdf/1910.01794.pdf=——I DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 30 • “Directed walks”: steepest- descent based algorithm to explore the remaining search space, focusing on the area around the security boundary 1. Variable step-size 2. Parallel computation 3. Full N-1 contingency check Directed Walks———IIm{\\}W =SdnND-p JE se--R--% > 4 | 3 DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Results Points close to the security boundary (within distance γ) IEEE 14-bus NESTA 162-bus Brute Force 100% of points in 556.0 min intractable Importance Sampling 100% of points in 37.0 min 901 points in 35.7 hours Proposed Method 100% of points in 3.8 min 183’295 points in 37.1 hours 31=——I DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 NN-Informed Sampling • Ideally: enrich the database with points near the stability boundary during NN training – But: impossible to know a priori which are these points • What do we do? 32= DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 NN-Informed Sampling • Ideally: enrich the database with points near the stability boundary – But: impossible to know a priori which are these points • What do we do? 1. Sample 1’000’000 random points and have the NN assess them • Extremely fast  NN will take some minutes to assess all of them 33= DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 NN-Informed Sampling • Ideally: enrich the database with points near the stability boundary – But: impossible to know a priori which are these points • What do we do? 1. Sample 1’000’000 random points and have the NN assess them • Extremely fast  NN will take some minutes to assess all of them 2. From the NN assessment: identify the region close to the stability boundary 34= DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 NN-Informed Sampling • Ideally: enrich the database with points near the stability boundary – But: impossible to know a priori which are these points • What do we do? 1. Sample 1’000’000 random points and have the NN assess them • Extremely fast  NN will take some minutes to assess all of them 2. From the NN assessment: identify the region close to the stability boundary 3. Sample 200 points in this region, compute the ground truth (=run N-1 and small signal stability), and enrich the database 35= DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Sampling beyond statistics: Better results with less data • Larger datasets achieve lower error – 64 : ~2x more data than 54 – 74 : ~4x more data than 54 • The directed walks and the NN-informed resampling achieve the same performance with half the datapoints 36 Number of datapoints Mean squared error (test set loss) Note: Actual performance of DW and NI depends on the case study. But the trend remains the same across all our experiments= DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Sampling beyond statistics: Better results with less data • Larger datasets achieve lower error – 64 : ~2x more data than 54 – 74 : ~4x more data than 54 • The directed walks and the NN-informed resampling achieve the same performance with half the datapoints • Physics-Informed Neural Networks can achieve similar results 37 Number of datapoints Mean squared error (test set loss) Note: Actual performance of DW, NI, and PINNs depends on the case study. But the trend remains the same across all our experiments= DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Physics-Informed Neural Networks for Power Systems 38= DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 min 𝑤𝑤1,𝑤𝑤2 𝑦𝑦𝑖𝑖 − �𝑦𝑦𝑖𝑖 s.t. �𝑦𝑦𝑖𝑖 = 𝑤𝑤1+ 𝑤𝑤2𝑥𝑥𝑖𝑖 ∀𝑖𝑖 39 𝑥𝑥 𝑦𝑦 �𝑦𝑦𝑖𝑖 = 𝑤𝑤1+ 𝑤𝑤2𝑥𝑥𝑖𝑖 𝑦𝑦𝑖𝑖: actual/correct value �𝑦𝑦𝑖𝑖: estimated value Loss function: Estimate best 𝑤𝑤1, 𝑤𝑤2 to fit the training data Traditional training of neural networks required no information about the underlying physical model. Just data! Neural Networks: An advanced form of non-linear regression= DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Physics Informed Neural Networks • Automatic differentiation: derivatives of the neural network output with respect to the input can be computed during the training procedure • A differential-algebraic model of a physical system can be included in the neural network training* • Neural networks can now exploit knowledge of the actual physical system • Machine learning platforms (e.g. Tensorflow) enable these capabilities 40 *M. Raissi, P. Perdikaris, and G. Karniadakis, Physics-Informed neural networks: A deep learning framework for solving forward and inverse problems involving nonlinear partial differential equations\", Journal of Computational Physics, vol.378, pp. 686-707, 2019= DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Physics-Informed Neural Networks for Power Systems 41 “Original” Loss function G. S. Misyris, A. Venzke, S. Chatzivasileiadis, Physics-Informed Neural Networks for Power Systems. Presented at the Best Paper Session of IEEE PES GM 2020. https://arxiv.org/pdf/1911.03737.pdf=——oP oP oP |—— Exact -—- Predicted | | P=0.17 [p.u.] P=0.18 [p.u.] 1 9 1 19 1.5} : 1.5} : min —— >» [0 —=0\"\"+ = > [f(9)]Wb ap | 12 Tg 1 1} (6a) < 0.5 0.5 st. 6=NN(, Pn, W,b) (6b) 0 0Sry1En (6c) 0.4 N f(8) = Mb + Dé + Asiné — B,, (6d) 302 \\ - | DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Physics-Informed Neural Networks for Power Systems 42 “Original” Loss function Swing equation “Physics-Informed” term G. S. Misyris, A. Venzke, S. Chatzivasileiadis, Physics-Informed Neural Networks for Power Systems. Presented at the Best Paper Session of IEEE PES GM 2020. https://arxiv.org/pdf/1911.03737.pdf=——I RE SA Ea 3 min wy] 2 10 = 4 IN] D_ 17) z 1 X= EN & (6a) “© 0.5 st. §=NN(tPn, W,b) (6b) 0 : 86 : 96 f(8) = Mé + Dé + Asiné — P,,| (6d) 3 02 _— 3 0 -0.2 |—— Exact -—- Predicted | P=0.17 [p.u.] P=0.18 [p.u.] 1.3} 1 : DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Physics-Informed Neural Networks for Power Systems 43 Code is available on GitHub: https://github.com/jbesty G. S. Misyris, A. Venzke, S. Chatzivasileiadis, Physics-Informed Neural Networks for Power Systems. Presented at the Best Paper Session of IEEE PES GM 2020. https://arxiv.org/pdf/1911.03737.pdf • Physics-Informed Neural Networks (PINN) could potentially replace solvers for systems of differential-algebraic equations in the long-term – Probable power system application: Extremely fast screening of critical contingencies • In our example: PINN 87 times faster than ODE solver • Can directly estimate the rotor angle at any time instant=——I —— Exact — — — Predicted| P=0.17 [p.u.] P=0.18 [p.u.] 15} 15] “0.5 0.5 DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Computation time: Classical numerical solvers vs. Physics-Informed NNs • Physics-Informed Neural Networks can determine the outputs more than 100x faster than classical numerical solvers – The further we look in time, e.g. what is the frequency at t=1s, the larger the computational advantage is 44 Classic solvers PINNs RK45 #1 RK45 #2 RK45 #3 PINN #1 PINN #2 PINN #3 0.01s 0.1s 1s J. Stiasny, G. S. Misyris, S. Chatzivasileiadis, Transient Stability Analysis with Physics-Informed Neural Networks. https://arxiv.org/abs/2106.13638 [ code ] oo cee |© ceeeo >> cee _= 2=S &p Xx ha= 8] Loo SES ooo =25\" 2£32 A 5oO 1 .oe S eee 5go»)oo XX -»oo ooo< H + sa aatak™iaN ap] A) 10)| | | |© © = ©i ™i A! An— [s] jurod eyep iad own) uonenyeaq=(— DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Closing the Loop: Trustworthy ML for Power Systems 45 Training Database Train Neural Network with/without Physics-Informed NN Verification/ Worst-case Guarantees Final NN with Performance Guarantees Trustworthy AI Satisfied? yes no “Sampling beyond Statistics” Enrich Database: NN-Informed Sampling “Sampling beyond Statistics” High-Information Content: Separating hyperplanes and Directed Walks= DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Neural Network Verification for classification NNs in Power Systems 46 A. Venzke, S. Chatzivasileiadis. Verification of Neural Network Behaviour: Formal Guarantees for Power System Applications. In IEEE Transactions on Smart Grid, vol. 12, no. 1, pp. 383-397, Jan. 2021, https://arxiv.org/pdf/1910.01624.pdf V. Tjeng, K. Y. Xiao, and R. Tedrake, “Evaluating robustness of neural networks with mixed integer programming,” in International Conference on Learning Representations (ICLR 2019), 2019= DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Neural Network Verification: HOW? 1. Exact transformation: Convert the neural network to a set of linear equations with binaries • The Neural Network can be included in a mixed-integer linear program 2. Formulate an optimization problem (MILP) and solve it  certificate for NN behavior 3. Assess if the neural network output complies with the ground truth 47= DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 • Most usual activation function: ReLU • ReLU: Rectifier Linear Unit 48 𝑤𝑤35 𝑤𝑤24 𝑢𝑢𝑖𝑖𝑖𝑖 𝑢𝑢𝑜𝑜𝑜𝑜𝑜𝑜 𝑢𝑢5 𝑢𝑢4𝑢𝑢2 𝑢𝑢3 From Neural Networks to Mixed-Integer Linear Programming Linear weightsNon-linear activation functions input output= DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 49 From Neural Networks to Mixed-Integer Linear Programming input output 1. But ReLU can be transformed to a piecewise linear function with binaries If input<0 , set binary =0  use linear function #1 DTUI Non-linear \\ activation functions Linear weights DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 50 From Neural Networks to Mixed-Integer Linear Programming input output 1. But ReLU can be transformed to a piecewise linear function with binaries If input>0 , set binary =1  use linear function #2 If input<0 , set binary =0  use linear function #1 Non-linear Linear weights oP activation \\, / functions DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 51 From Neural Networks to Mixed-Integer Linear Programming 2. I can encode all operations of a Neural Network to a system of linear equations with continuous and binary variables 3. I can integrate all information encoded in a neural network inside an optimization program input x output y 1. But ReLU can be transformed to a piecewise linear function with binaries If binary =0, y=0 If binary =1, y=x Non-linear Linear weights activation functions=——I DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Certify the output for a continuous range of inputs 52 A. Venzke, S. Chatzivasileiadis. Verification of Neural Network Behaviour: Formal Guarantees for Power System Applications. IEEE Transactions on Smart Grid, Jan. 2021. https://arxiv.org/pdf/1910.01624.pdf 1. We assume a given input xref with classification “safe” ® correct safe ® correct unsafe e misclassified X verification samples DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Certify the output for a continuous range of inputs 53 1. We assume a given input xref with classification “safe” 2. Solve optimization problem: Does classification change for any input within distance ε from xref? 3. If not, then I can certify that my neural network will classify the whole continuous region as “safe” 4. I can repeat this for other regions and different classifications A. Venzke, S. Chatzivasileiadis. Verification of Neural Network Behaviour: Formal Guarantees for Power System Applications. IEEE Transactions on Smart Grid, Jan. 2021. https://arxiv.org/pdf/1910.01624.pdf ® correct safe ® correct unsafe e misclassified X verification samples DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Provable Worst-case Guarantees 54 Venzke, G. Qu, S. Low, S. Chatzivasileiadis, Learning Optimal Power Flow: Worst-case Guarantees for Neural Networks. Best Student Paper Award at IEEE SmartGridComm 2020. https://arxiv.org/pdf/2006.11029.pdf R. Nellikkath, S. Chatzivasileiadis, Physics-Informed Neural Networks for Minimising Worst-Case Violations in DC Optimal Power Flow. In IEEE SmartGridComm 2021, Aachen, Germany, October 2021. R. Nellikkath, S. Chatzivasileiadis. Physics-Informed Neural Networks for AC Optimal Power Flow. 2021.= DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Neural Networks for Optimal Power Flow 55 Optimal Power Flow Minimize Total Generation Cost Subject to: Total supply = Total load demand Transmission line limits Generator limits Several recent approaches in literature apply Neural Networks to estimate the optimal point • Demonstrate up to 100x speedup • But no performance guarantees  Does the Neural Network decision lead to any violations? We have developed methods that can for the first time determine these worst-case violations (of any Neural Network to an OPF) • Key point: Convert NN to a MILP= DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Worst violation over the whole training dataset (training+test set) 56 Our algorithm: provable worst-case guarantee over the whole input domain Maximum violation of generator limits Maximum violation of line limits=——oP -— Empirical Exact worst-case lower bound guarantee Ve Test cases Vg Uline Vg Uline (MW) (MW) | (MW) (MW) Uline case9 case30 case39 casebrs casell8 casel6? case300 DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Worst violation over the whole training dataset (training+test set) 57 Our algorithm: provable worst-case guarantee over the whole input domain Maximum violation of generator limits Maximum violation of line limits Over the whole input domain violations can be much larger (here ~7x) compared to what has been estimated empirically on the dataset=——I Empirical Exact worst-case lower bound guarantee Test cases Vg Uline Vg Uline (MW) (MW) | (MW) (MW) cased | 2.5 1.8 | 2.8 1.9 case30 | 1.7 0.6 | 3.6 3.1 case39 | 51.9 37.2 | 270.6 120.0 case57 | 4.2 0.0 | 23.7 0.0 casell8 | 149.4 15.6 | 997.8 510.8 casel62 | 228.0 180.0 | 1563.3 974.1 case300 | 4745 692.7 | 3658.5 3449.3A Uline DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Worst violation over the whole training dataset (training+test set) 58 New algorithm: provable worst-case guarantee over the whole input domain Maximum violation of generator limits Maximum violation of line limits We can now provide guarantees that no NN output will violate the line limits over the whole input domain=——I Empirical Exact worst-case lower bound guarantee Ve Test cases Vg Uline Vg Uline (MW) (MW) | (MW) (MW) ine cased | 2.5 1.8 | 2.8 1.9 case30 | 1.7 0.6 | 3.6 3.1 case39 | 51.9 37.2 | 270.6 120.0 case57 | 4.2 0.0 | 23.7 0.0} casell8 | 149.4 15.6 | 997.8 510.8 casel62 | 228.0 180.0 | 1563.3 974.1 case300 | 4745 692.7 | 3658.5 3449.3 DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 The opportunity “AI for Optimization” 59= DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 The opportunity: 1-slide summary 60 Intersection of all security/stability criteria: Non-linear and non- convex security region 1. Take any non- convex region 2. Train a NN to approximate it RELUs as activ. functions 3. Convert NN to a MILP (remember NN verification?) MILP 4. Solve any problem Example1: Instead of running e.g. 10’000 simulations to determine the critical clearing time for a set of disturbances, run a single optimization: max fault clearing time s.t. system=safe 1Misyris, Stiasny, Chatzivasileiadis, CDC, 2021 DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 61 An Example • North Sea Wind Power Hub • Wind Hub Operators offer energy and primary frequency control and primary voltage control – Can determine both P and Q, and – Kp,fand Kv (freq. droop and voltage droop) • What are the permissible combinations of P,Q, Kp,f , and Kv that satisfy: – Small-signal Stability (e.g. ζ>3%), for all – N-1 contingencies Problem extremely difficult to solve: infinite combinations J. Stiasny, S. Chevalier, R. Nellikkath, B. Sævarsson, S. Chatzivasileiadis. Closing the Loop: A Framework for Trustworthy Machine Learning in Power Systems. Accepted to 2022 iREPSymposium -Bulk Power System Dynamics and Control - XI (iREP). Banff, Canada. 2022. [ paper | code ]=——I DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Opportunity: Convert Verified Neural Network to an Optimization Problem 62 For given operating point (𝑃𝑃𝑟𝑟𝑟𝑟𝑟𝑟 ∗ , 𝑄𝑄𝑟𝑟𝑟𝑟𝑟𝑟 ∗ ), what is the maximum range of frequency and voltage control parameters (𝐾𝐾𝑝𝑝,𝑟𝑟 and 𝐾𝐾𝑣𝑣) that ensures small- signal stability for all N-1 contingencies? Optimization Problem #1 MILPorjer surdure(gNRE REE00 © NN— oo | 3.60<fXNI~> Small-signal stable for all N-17 Final Venfied NN with Performance Guarantees= DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Opportunity: Convert Verified Neural Network to an Optimization Problem 63 For given frequency and voltage control, what is the maximum permissible range of active and reactive power (𝑃𝑃 and 𝑄𝑄) that ensures small- signal stability for all N-1 contingencies? Optimization Problem #2 MILP=—— Small-signal stable oP oP oP Final Verified NN with Performance Guarantees » Q > Ko¢ Kv a for all N-1? 8.4 7.2 6.0 4.8 3.0 1.2 0.0 —1.2 —2.4boHsDamping ratio DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Wrap-up 64 1. Sampling beyond statistics can yield high quality training databases with smaller amounts of data 2. Physics-informed neural networks exploit the underlying physics in the training procedure. 3. Neural network verification builds the missing trust; necessary in safety-critical systems. 4. From 1000s of simulations to a single optimization: Neural Networks can capture previously intractable constraints and embed them in any optimization problem “Data-centric AI movement” (Andrew Ng, Stanford, and others) “Small [data] is the new big” (IEEE Spectrum, Apr. 2022) Exploit the prior knowledge=——I DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 What did I not talk about Exploring a wide range of research directions 1. Accelerating MILPs: using Decision Trees to estimate the active set and drastically reduce the number of binary variables [ https://arxiv.org/pdf/2010.06344.pdf , IEEE Trans. Power Systems] 2. Contracting Neural-Newton Solver: Derive convergence guarantees for Neural Networks that can replace conventional Newton solvers [https://arxiv.org/pdf/2106.02543.pdf , L4DC 2022] 3. Interpretable Machine Learning: Direct association of the SHAP Values with the Power Transfer Distribution Factors (PTDFs) [ https://arxiv.org/pdf/2209.05793.pdf , submitted ] 4. Input Convex NNs for convex approximations of non-convex optimization problems [ https://arxiv.org/pdf/2209.08645.pdf , submitted ] 5. Physics-Informed Neural Networks for Fast Dynamic Security Assessment [https://arxiv.org/pdf/2106.13638.pdf, code: https://github.com/jbesty/PINNs_transient_stability_analysis ] 6. Neural Network Training with by-design worst-case guarantees [soon on ArXiV] and others… 65= DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Interested in a postdoc or PhD? • Come work with us! • Wide range of topics around ML and beyond: – Trustworthy Machine Learning, Physics-Informed Neural Networks, capturing intractrable constraints with NNs, and more! – Working with real datasets, and industry collaboration – Opportunities for open academic research and/or toolbox development for practical applications • Open positions online! • Contact: spchatz@dtu.dk 66= JiI= ll DTU Wind and Energy Systems – Spyros Chatzivasileiadis13 October 2022 Thank you! Spyros Chatzivasileiadis Assoc. Prof, Head of Section www.chatziva.com spchatz@dtu.dk 67 • A. Venzke, S. Chatzivasileiadis. Verification of Neural Network Behaviour: Formal Guarantees for Power System Applications. Accepted at IEEE Trans. on Smartgrid. 2020. https://arxiv.org/pdf/1910.01624.pdf • A. Venzke, G. Qu, S. Low, S. Chatzivasileiadis, Learning Optimal Power Flow: Worst-case Guarantees for Neural Networks. Best Student Paper Award at IEEE SmartGridComm 2020.[ .pdf | slides | video ] • G. S. Misyris, A. Venzke, S. Chatzivasileiadis, Physics-Informed Neural Networks for Power Systems. Presented at the Best Paper Session of IEEE PES GM 2020. https://arxiv.org/pdf/1911.03737.pdf • R. Nellikkath, S. Chatzivasileiadis, Physics-Informed Neural Networks for AC Optimal Power Flow https://arxiv.org/abs/2110.02672 [ code ] • J. Stiasny, G. S. Misyris, S. Chatzivasileiadis, Transient Stability Analysis with Physics-Informed Neural Networks. https://arxiv.org/abs/2106.13638 [ code ] • J. Stiasny, S. Chevalier, R. Nellikkath, B. Sævarsson, S. Chatzivasileiadis. Closing the Loop: A Framework for Trustworthy Machine Learning in Power Systems. Accepted to 2022 iREPSymposium -Bulk Power System Dynamics and Control -XI (iREP). Banff, Canada. 2022. [ paper | code ] All publications available at: www.chatziva.com/publications.html Some code available at: www.chatziva.com/downloads.html Article without any equations  S. Chatzivasileiadis, A. Venzke, J. Stiasny and G. Misyris, \"Machine Learning in Power Systems: Is It Time to Trust It?,\" in IEEE Power and Energy Magazine, vol. 20, no. 3, pp. 32-41, May-June 2022 [ .pdf ]=","libVersion":"0.3.2","langs":""}