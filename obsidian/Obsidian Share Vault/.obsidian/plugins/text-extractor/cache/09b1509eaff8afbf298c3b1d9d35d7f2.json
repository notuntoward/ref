{"path":"lit/lit_sources/Patton13CopulaMethodsForecasting.pdf","text":"Copula Methods for Forecasting Multivariate Time Series \u0000 Andrew J. Patton Duke University 26 April 2012 Forthcoming in the Handbook of Economic Forecasting, Volume 2. Abstract Copula-based models provide a great deal of ‡exibility in modelling multivariate distributions, allowing the researcher to specify the models for the marginal distributions separately from the dependence structure (copula) that links them to form a joint distribution. In addition to ‡exibility, this often also facilitates estimation of the model in stages, reducing the computational burden. This chapter reviews the growing literature on copula-based models for economic and …nancial time series data, and discusses in detail methods for estimation, inference, goodness-of-…t testing, and model selection that are useful when working with these models. A representative data set of two daily equity index returns is used to illustrate all of the main results. Keywords: dependence, correlation, tail risk, volatility, density forecasting. J.E.L. codes: C32, C51, C53. \u0000I thank the Editors (Graham Elliott and Allan Timmermann), two anonymous referees, and Yanqin Fan, Do- minique Guégan, Bruno Rémillard, and seminar participants at the Federal Reserve Bank of Saint Louis and HEC Montréal for helpful comments and suggestions, and Dong Hwan Oh for outstanding research assistance. Contact address: Department of Economics, Duke University, 213 Social Sciences Building, Box 90097, Durham NC 27708- 0097. Email: andrew.patton@duke.edu. Matlab code for some of the analysis in this chapter will be available at http://econ.duke.edu/sap172/code.html. 1 1 Introduction This chapter reviews the growing literature on copula-based models for forecasting economic and …nancial time series data. Copula-based multivariate models allow the researcher to specify the models for the marginal distributions separately from the dependence structure (copula) that links these distributions to form the joint distribution. This frees the researcher from considering only existing multivariate distributions, and allows for a much greater degree of ‡exibility in specifying the model. In some applications estimation can also be done in stages, with the marginal distribu- tions estimated separately from the dependence structure, facilitating the study of high-dimension multivariate problems. All theoretical methods reviewed in this chapter are applied to a representative data set of daily returns on two equity indices, and detailed discussion of methods for estimation, inference, goodness-of-…t testing, and model selection that are useful when working with copula-based models is provided. While the main ideas in copula theory are not hard, they may initially appear foreign. One objective of this chapter is to lower the “entry costs” of understanding and applying copula methods for economic time series. To …x ideas, let us …rst recall a key result in this literature due to Sklar (1959), which states that an n-dimensional joint distribution can be decomposed into its n univariate marginal distributions and an n-dimensional copula: Let Y \u0000 [Y1; :::; Yn] 0 s F ; with Yi s Fi then 9 C : [0; 1] n ! [0; 1] s.t. F (y) = C (F1 (y1) ; :::; Fn (yn)) 8 y 2Rn (1) Thus the copula C of the variable Y is the function that maps the univariate marginal distributions Fi to the joint distribution F: Another interpretation of a copula function is possible using the “probability integral transformation”, Ui \u0000 Fi (Yi) : As Casella and Berger (1990) note, when Fi is continuous the variable Ui will have the U nif (0; 1) distribution regardless of the original distribution Fi: Ui \u0000 Fi (Yi) s U nif (0; 1) , i = 1; 2; ::; n (2) The copula C of Y\u0000 [Y1; :::; Yn] 0 can be interpreted as the joint distribution of the vector of proba- bility integral transforms, U \u0000 [U1; :::; Un] 0 ; and thus is a joint distribution function with U nif (0; 1) 2 margins. Notice that, when the densities exist, the above representation of the joint cdf implies the following representation for the joint pdf: f (y1; :::; yn) = c (F1 (y1) ; :::; Fn (yn)) \u0000 nY i=1 fi (yi) (3) where c (u1; :::; un) = @nC (u1; :::; un) @u1 \u0000 ::: \u0000 @un What makes this representation particularly useful for empirical research is the converse of Sklar’s theorem: given any set of n univariate distributions (F1; :::; Fn) and any copula C; the func- tion F de…ned by equation (1) above de…nes a valid joint distribution with marginal distributions (F1; :::; Fn) : For example, one might combine a Normally distributed variable with an Exponen- tially distributed variable via a t copula, and obtain a strange but valid bivariate distribution. The ability to combine marginal distributions with a copula model allows the researcher to draw on the large body of research on modeling univariate distributions, leaving “only” the task of modelling the dependence structure. This chapter will focus exclusively on multivariate forecasting problems using copula-based models, and exclude univariate copula-based models, such as those considered by Darsow, et al. (1992), Ibragimov (2009), Beare (2010), Chen and Fan (2006a) and Chen, et al. (2009) for exam- ple. While univariate copula-based time series models are indeed interesting, from a forecasting perspective they are essentially a particular type of nonlinear time series model, a topic covered in chapters by White (2006) and Teräsvirta (2006) in the …rst edition of this Handbook. In multivariate forecasting problems we will be interested in a version of Sklar’s theorem for conditional joint distributions presented in Patton (2006a), where we consider some information set Ft\u00001; and decompose the conditional distribution of Yt given Ft\u00001 into its conditional marginal distributions and the conditional copula: Let YtjFt\u00001 s F (\u0000jFt\u00001) with YitjFt\u00001 s Fi (\u0000jFt\u00001) , i = 1; 2; :::; n then F (yjFt\u00001) = C (F1 (y1jFt\u00001) ; :::; Fn (ynjFt\u00001) jFt\u00001) (4) If we de…ne the (conditional) probability integral transform variables, Uit = Fi (YitjFt\u00001), then the conditional copula of YtjFt\u00001 is just the conditional distribution of UtjFt\u00001 : UtjFt\u00001 s C (\u0000jFt\u00001) (5) 3 This highlights the potential for copula-based models to facilitate speci…cation and estimation in stages: one can estimate models for each of the conditional marginal distributions, Fi (\u0000jFt\u00001) ; construct the probability integral transform variables, and then consider copula models for the joint distribution of these variables. This results in a valid n-dimensional model, without the challenge of specifying and estimating it simultaneously. Note in equation (4) that the same information appears in each of the marginals and the copula.1 However, in empirical applications it may be the case that not every part of Ft\u00001 is needed for every marginal distribution. For example, let F (i) t\u00001 denote the information set generated by (Yi;t\u00001; Yi;t\u00002; :::) ; and let Ft\u00001 denote the information set generated by (Yt\u00001; Yt\u00002; :::) : For some processes we may …nd that YitjFt\u00001 d = YitjF (i) t\u00001; i.e., processes where each variable depends only upon its own lags and not on lags of other variables. Thus it is possible to use models for marginal distributions that do not explicitly use the entire information set, but still satisfy the restriction that all margins and the copula use the same information set. For inference on copula parameters and related quantities, an important distinction arises be- tween fully parametric multivariate models (where the copula and the marginal distributions are all parametric) and semiparametric models (where the copula is parametric and the marginal distrib- utions are nonparametric). The latter case has much empirical appeal, but slightly more involved methods for inference are required. We will review and implement methods for both parametric and semiparametric copula-based multivariate models.2 Several other surveys of copula theory and applications have appeared in the literature to date: Nelsen (2006) and Joe (1997) are two key text books on copula theory, providing clear and detailed introductions to copulas and dependence modelling, with an emphasis on statistical foundations. Frees and Valdez (1998) present an introduction to copulas for actuarial problems. Cherubini, et al. (2004) present an introduction to copulas using methods from mathematical …nance, and McNeil, et al. (2005) present an overview of copula methods in the context of risk management. Genest and Favre (2007) present a description of semiparametric inference methods for iid data with a detailed 1 When di¤erent information sets are used, the resulting function F (\u0000j\u0000) is not generally a joint distribution with the speci…ed conditional marginal distributions, see Fermanian and Wegkamp (2012). 2 Forecasts based on nonparametric estimation of copulas are not common in the economics literature, and we will not consider this case in this chapter. Related articles include Genest and Rivest (1993) and Capéraà, et al. (1997) for iid data, and Fermanian and Scaillet (2003), Fermanian, et al. (2004), Sancetta and Satchell (2004) and Ibragimov (2009) for time series data. 4 empirical illustration. Patton (2009a) presents a summary of applications of copulas to …nancial time series and an extensive list of references. Choros, et al. (2010) provide a concise survey of estimation methods, both parametric and nonparametric, for copulas for both iid and time series data. Manner and Reznikova (2011) present a survey speci…cally focused on time-varying copula models, and Patton (2012) provides a brief review of the literature on copula-based methods for univariate and multivariate time series. This chapter will focus on the key steps in using a copula-based model for economic forecasting, and the outline of this chapter will follow these steps. In Section 2 we consider some dependence summary statistics, which are useful for describing the data and for making initial decisions on the types of copula models that may be useful for a given data set. In Section 3 we look at estimation and inference for copula models, covering both fully parametric and semiparametric models. In Section 4 we review model selection and goodness-of-…t tests that are applicable for copula-based models, and in Section 5 we look at some issues that arise in economic applications of copula based models, such as extracting linear correlation coe¢ cients from a copula-based model and computing portfolio Value-at-Risk. Finally, in Section 6 we survey some of the many applications of copulas in economics and …nance, and in Section 7 we discuss directions for future research in this area. 1.1 Empirical illustration: small cap and large cap equity indices To illustrate the methods presented in this chapter, we consider the daily returns on two equity indices: the S&P 100 index of the largest U.S. …rms (covering about 60% of total market capital- ization), and the S&P 600 index of small …rms (covering about 3% of market capitalization). The sample period is 17 August 1995 (the start date for the S&P 600 index) until 30 May 2011, which covers 3639 trading days. A time series plot of these two series over this sample period is presented in the upper panel of Figure 1, and a scatter plot of these returns is presented in the lower panel of Figure 1. Summary statistics for these returns are presented in Table 1.3 [INSERT FIGURE 1 AND TABLE 1 ABOUT HERE ] Before modelling the dependence structure between these two return series, we must …rst model 3 Matlab code to replicate the empirical results presented in this chapter will be available at http://econ.duke.edu/sap172/code.html 5 their conditional marginal distributions.4 We will base our model on the following structure: Yit = \u0000i (Zt\u00001) + \u0000i (Zt\u00001) \"it, for i = 1; 2; where Zt\u00001 2 Ft\u00001 (6) \"itjFt\u00001 s Fi (0; 1) 8 t That is, we will allow each series to have potentially time-varying conditional mean and variance, and we will assume that the standardized residual, \"it; has a constant conditional distribution (with mean zero and variance one, for identi…cation).5 Using the Bayesian Information Criterion (BIC) and considering ARMA models for the condi- tional mean up to order (5; 5) ; the optimal models were found to be an AR(2) for the S&P 100 and an AR(0) (i.e., just a constant) for the S&P 600. Testing for the signi…cance of …ve lags of the “other” series, conditional on these models, yielded p-values of 0.13 and 0.34, indicating no evidence of signi…cant cross-equation e¤ects in the conditional mean. Again using the BIC and considering volatility models in the GJR-GARCH class, see Glosten, et al. (1993), of up to order (2,2), the optimal models for both series were of order (1,1). Using these models we construct the estimated standardized residuals as: ^\"it \u0000 Yit \u0000 \u0000i (Zt\u00001; ^\u0000) \u0000i (Zt\u00001; ^\u0000) , i = 1; 2 (7) where ^\u0000 is the vector of estimated parameters for the models for the conditional mean and condi- tional variance. We will consider both parametric and nonparametric models for Fi. Many choices are possible for the parametric model for Fi; including the Normal, the standardized Student’s t (as in Bollerslev, 1987), the skewed t (as in Patton, 2004), and others. In this chapter we use the simple and ‡exible skewed t distribution of Hansen (1994), see Jondeau and Rockinger (2003) for further results on this distribution. This distribution has two “shape” parameters: a skewness parameter, \u0000 2 (\u00001; 1) ; which controls the degree of asymmetry, and a degrees of freedom parameter \u0000 2 (2; 1] which controls the thickness of the tails. When \u0000 = 0 we recover the standardized Student’s t distribution, 4 Modelling the dependence structure of the variables directly, using the unconditional probability transform vari- ables, yields a model for the unconditional copula of the returns. This may be of interest in some applications, but in forecasting problems we almost certainly want to condition on the available information, and thus are lead to study the conditional copula, which requires specifying models for the conditional marginal distributions. 5 When parametric models are considered for Fi it is possible to allow for this distribution to vary through time, see Patton (2004) for one example, but we will not consider this here for simplicity. 6 when \u0000 ! 1 we obtain a skewed Normal distribution, and when \u0000 ! 1 and \u0000 = 0 we obtain the N (0; 1) distribution. For the nonparametric estimate of Fi we will use the empirical distribution function (EDF)6: ^Fi (\") \u0000 1 T + 1 TX t=1 1 f^\"it \u0000 \"g (8) Table 1 presents the estimated parameters of the skewed t distribution, and Figure 2 presents the …tted parametric estimates of this distribution. The upper panel shows that the …tted density appears to provide a reasonable …t to the empirical histogram. The lower panel presents a QQ plot, and reveals that a few extreme left tail observations are not captured by the models for each series. [ INSERT FIGURE 2 ABOUT HERE ] The lower rows of Table 1 report p-values from a test of the goodness-of-…t of the skewed t distribution using both the Kolmogorov-Smirnov (KS) and Cramer-von Mises (CvM) test statistics: KSi = max t \u0000 \u0000 \u0000 \u0000 ^Ui;(t) \u0000 t T \u0000 \u0000 \u0000 \u0000 (9) CvMi = TX t=1 \u0000 ^Ui;(t) \u0000 t T \u00002 (10) where ^Ui;(t) is the tth largest value of n ^Ui;joT j=1 ; i.e., the tth order statistic of n ^Ui;joT j=1. Both of these test statistics are based on the estimated probability integral transformations: ^Uit \u0000 Fskew t \u0000 ^\"it; ^\u0000i; ^\u0000i\u0000 (11) In the absence of parameter estimation error, the KS and CvM test statistics have asymptotic distributions that are known, however the presence of estimated parameters in our model means that those distributions are not applicable here. To overcome this we exploit the fact that with parametric models for the mean, variance and error distribution we have completely characterized the conditional distribution, and thus can use a simple simulation-based method to obtain critical values (see Genest and Rémillard (2008) for example): (i) Simulate T observations for Yit from 6 Note that this de…nition of the EDF scales by 1= (T + 1) rather than 1=T; as is common in this literature. This has no e¤ect asymptotically, and in …nite samples is useful for keeping the estimated probability integral transforms away from the boundaries of the unit interval, where some copula models diverge. 7 this model using the estimated parameters, (ii) Estimate the models on the simulated data, (iii) Compute the KS and CvM statistics on the estimated probability integral transforms of the simu- lated data, (iv) Repeat steps (i)-(iii) S times (e.g., S = 1000), (v) Use the upper 1 \u0000 \u0000 quantile of \u0000\u0000KS(s); CvM(s)\u0000\u0000S s=1 as the critical value for these tests. Implementing these tests on the S&P 100 and S&P 600 standardized residuals, we …nd p-values for the KS (CvM) tests of 0.12 and 0.09 (0.48 and 0.22), and thus fail to reject the null that the skew t model is well-speci…ed for these two return series. This provides support for these models of the marginal distributions, allowing us to move on to modelling the copula. 2 Dependence summary statistics When assuming Normality, the only relevant summary statistic for the dependence structure is the linear correlation coe¢ cient, and this is routinely reported in empirical work on multivariate time series. However, when considering more ‡exible models for the dependence structure we need to also consider other measures of dependence, to provide some guidance on the types of models that might be suitable for the variables under analysis. This section describes some useful dependence measures and methods for conducting inference on estimates of these measures. 2.1 Measures of dependence Numerous dependence measures exist in the literature, see Nelsen (2006, Chapter 5) and Joe (1997, Chapter 2) for detailed discussions. A key attribute of a dependence measure for providing guidance on the form of the copula is that it should be a “pure” measure of dependence (or “scale invariant”, in the terminology of Nelsen 2006), and so should be una¤ected by strictly increasing transformations of the data. This is equivalent to imposing that the measure can be obtained as a function of the ranks (or probability integral transforms) of the data only, which is in turn equivalent to it being a function solely of the copula, and not the marginal distributions. Linear correlation is not scale invariant (e.g., Corr [X; Y ] 6= Corr [exp fXg ; exp fY g]) and is a¤ected by the marginal distributions of the data. Given its familiarity in economics, it is still a useful measure to report, but we will augment it with other measures of dependence. Firstly, we recall the de…nition of Spearman’s rank correlation. We will denote the population 8 rank correlation as % and sample rank correlation as ^% : % = Corr [U1t; U2t] = 12E [U1tU2t] \u0000 3 = 12 Z 1 0 Z 1 0 uvdC (u; v) \u0000 3 (12) ^% = 12 T TX t=1 U1tU2t \u0000 3 (13) (Note that this formula exploits the fact that E [U ] = 1=2 and V [U ] = 1=12 for U s U nif (0; 1) :) Rank correlation is constrained to lie in [\u00001; 1] ; with the bounds of this interval being attained only when one variable is a strictly increasing or decreasing function of the other. Rank correlation is useful for providing information on the sign of the dependence between two variables, which is important when considering copula models that can only accommodate dependence of a given sign (such as some Archimedean copulas). We next consider “quantile dependence”, which measures the strength of the dependence be- tween two variables in the joint lower, or joint upper, tails of their support. It is de…ned as \u0000q = 8 < : Pr [U1t \u0000 qjU2t \u0000 q] ; 0 < q \u0000 1=2 Pr [U1t > qjU2t > q] ; 1=2 < q < 1 (14) = 8 < : C(q;q) q ; 0 < q \u0000 1=2 1\u00002q+C(q;q) 1\u0000q ; 1=2 < q < 1 ^\u0000q = 8 < : 1 T q XT t=1 1 fU1t \u0000 q; U2t \u0000 qg ; 0 < q \u0000 1=2 1 T (1\u0000q) XT t=1 1 fU1t > q; U2t > qg 1=2 < q < 1 (15) Quantile dependence provides a richer description of the dependence structure of two variables.7 By estimating the strength of the dependence between the two variables as we move from the center (q = 1=2) to the tails, and by comparing the left tail (q < 1=2) to the right tail (q > 1=2) we are provided with more detailed information about the dependence structure than can be provided by a scalar measure like linear correlation or rank correlation. Information on the importance of asymmetric dependence is useful as many copula models, such as the Normal and the Student’s t copulas, impose symmetric dependence. Tail dependence is a measure of the dependence between extreme events, and population tail 7 The de…nition given here is tailored to positively dependent variables, as it traces out the copula along the main diagonal, C (q; q) for q 2 (0; 1) : It is easily modi…ed to apply to negatively dependent variables, by considering C (q; 1 \u0000 q) and C (1 \u0000 q; q) : 9 dependence can be obtained as the limit of population quantile dependence as q ! 0 or q ! 1 : \u0000L = lim q!0+ C (q; q) q (16) \u0000U = lim q!1\u0000 1 \u0000 2q + C (q; q) 1 \u0000 q Sample tail dependence cannot simply be taken as ^\u0000L = limq!0+ ^\u0000q, since if we set q close enough to zero we are assured that the estimate will be zero. (For example, if we use the EDF to estimate the marginal distributions, then any value of q < 1=T or q > 1 \u0000 1=T will result in ^\u0000q = 0:) Thus estimating tail dependence from a …nite sample of data must be done using an alternative approach. Unlike the extreme tails of a univariate distribution, which under general conditions can be shown using extreme value theory to follow a functional form with just one or two free parameters, the tails of a bivariate distribution require the estimation of an unknown univariate function known as “Pickand’s (1981) dependence function”. It can be shown, see Frahm, et al. (2005), that estimating the upper and lower tail dependence coe¢ cients is equivalent to estimating the value of the Pickand’s dependence function at one-half. One simple nonparametric estimator of tail dependence considered in Frahm, et al. (2005) is the “log” estimator: ^\u0000L = 2 \u0000 log \u00001 \u0000 2 (1 \u0000 q\u0000) + T \u00001 XT t=1 1 fU1t \u0000 1 \u0000 q\u0000; U2t \u0000 1 \u0000 q\u0000g\u0000 log (1 \u0000 q\u0000) for q\u0000 \u0000 0 (17) ^\u0000U = 2 \u0000 log \u0000T \u00001 XT t=1 1 fU1t \u0000 1 \u0000 q\u0000; U2t \u0000 1 \u0000 q\u0000g\u0000 log (1 \u0000 q\u0000) for q\u0000 \u0000 0 As usual for extreme value estimation, a threshold q\u0000 needs to be chosen for estimation, and it can di¤er for the upper and lower tail. This choice involves trading o¤ the variance in the estimator (for small values of q) against bias (for large values of q), and Frahm, et al. (2005) suggest a simple method for making this choice.8 Information on the importance of tail dependence is useful as many copula models, such as the Normal and Frank copulas, impose zero tail dependence, and other copulas impose zero tail dependence in one of their tails (e.g., right for the Clayton copula and left for the Gumbel copula). 8 Alternatively, one can specify and estimate parametric copulas for the joint upper and lower tails, and infer the tail dependence coe¢ cients from the …tted models. This approach is discussed in Section 3.4.1 below. 10 2.2 Inference on measures of dependence In addition to estimating dependence summary statistics, it is often of interest to obtain standard errors on these, either to provide an idea of the precision with which these parameters are estimated, or to conduct tests on these (we will consider tests for asymmetric dependence and for time-varying dependence below). If the data to be analyzed was known to already have U nif (0; 1) margins, then inference is straightforward, however in general this is not the case, and the data on which we compute the dependence summary statistics will usually depend on parameters estimated in an earlier part of the analysis. (For example, on ARMA models for the mean, GARCH models for the variance, and possibly shape parameters for the density of the standardized residuals.) The method for inference on the estimated dependence statistics is di¤erent depending on whether a parametric or a nonparametric model is used for the distribution of the standardized residuals. The methods described below are closely related to inference methods for estimated copula parameters, which are discussed in Section 3. 2.2.1 Parametric marginal distributions Combining parametric marginal distributions for the standardized residuals with parametric models for the conditional means and variances yields a fully parametric model for the conditional marginal distributions. Inference on the estimated dependence statistics can be conducted in one of (at least) two ways. Firstly, one could treat this as multi-stage GMM, where the “moments” of all stages except for the estimation of the dependence statistics, are the scores of the marginal log-likelihoods (i.e., these are all maximum likelihood estimators), and the latter are the moments (or “estimating equations”) that generate ^%, ^\u0000q; ^\u0000L and ^\u0000U as solutions: This is a minor adaptation of the methods in Patton (2006b), who considered multi-stage maximum likelihood estimation (MLE) for copula- based models of multivariate time series. We consider this method in detail in Section 3.1 below. A second, simpler, approach based on a bootstrap may be desirable to avoid having to compute the moments outlined above: (i) Use the stationary bootstrap of Politis and Romano (1994), or another bootstrap method that preserves (at least asymptotically) the time series dependence in the data, to generate a bootstrap sample9 of the data of length T: (ii) Estimate the model on 9 It is important to maintain the cross-sectional dependence of the data, and so this shu- e should be done on entire rows of the matrix of standardized residuals, assuming that these are stored in a T \u0000 n matrix, and not separately for each series. 11 the simulated data, (iii) Compute the dependence measures on the estimated probability integral transformations, (iv) Repeat steps (i)-(iii) S times (e.g., S = 1000), (v) Use the \u0000=2 and 1 \u0000 \u0000=2 quantiles of the simulated distribution of n\u0000^%i; ^\u0000q i ; ^\u0000L i ; ^\u0000U i \u0000oS i=1 to obtain a 1\u0000\u0000 con…dence interval for these parameters. See Gonçalves and White (2004) for results on the bootstrap for nonlinear and serially dependent processes. 2.2.2 Nonparametric marginal distributions Using the empirical distribution function (EDF), or some other nonparametric estimate, of the distributions for the standardized residuals with parametric models for the conditional means and variances makes the model semiparametric. As in the fully parametric case, inference on the estimated dependence statistics can be conducted either using the asymptotic distribution of the parameters of the model (including the in…nite-dimensional marginal distributions) or using a bootstrap approach. Both of these approaches are based on the assumption that the underlying true conditional copula is constant through time. Similar to the parametric case, in the …rst approach one treats this as multi-stage semiparametric GMM, where the “moments” of all stages except for the estimation of the dependence statistics, are the scores of the log-likelihood (i.e., these are all ML), and the latter are the moments that generate ^%, ^\u0000q; ^\u0000L and ^\u0000U as solutions: This is a minor adaptation of the methods in Chen and Fan (2006b), who considered multi-stage MLE for semiparametric copula-based models of multivariate time series. A key simpli…cation of this approach, relative to the fully parametric case, is that the estimated parameters of the models for the conditional mean and variance do not a¤ect the asymptotic distribution of the dependence statistics, see Rémillard (2010). This is a surprising result. Thus, in this semiparametric case and under the assumption of a constant conditional copula, one can ignore the estimation of the mean and variance models. The asymptotic distribution does depend on the estimation error coming from the use of the EDF, making the asymptotic variance di¤erent from standard MLE. We will discuss this method in detail in Section 3.2 below. A second approach again exploits the bootstrap to obtain con…dence intervals, and is simple to implement. Following Chen and Fan (2006b) and Rémillard (2010), we can treat the estimated standardized residuals as though they are the true standardized residuals (i.e., we can ignore the presence of estimation error in the parameters of the models for the conditional mean and variance), and under the assumption that the conditional copula is constant we can then use 12 a simple iid bootstrap approach: (i) Randomly draw rows, with replacement, from the T \u0000 n matrix of standardized residuals until a bootstrap sample of length T is obtained, (ii) Estimate the dependence measures of the bootstrap sample, (iii) Repeat steps (i)-(ii) S times, (iv) Use the \u0000=2 and 1 \u0000 \u0000=2 quantiles of the simulated distribution of n\u0000^%i; ^\u0000q i ; ^\u0000L i ; ^\u0000U i \u0000oS i=1 to obtain a 1 \u0000 \u0000 con…dence interval for these parameters. Given how simple it is to compute the dependence statistics discussed above, this bootstrap approach is fast and convenient relative to one that relies on the asymptotic distribution of these statistics. When the conditional copula is time-varying, the parameter estimation error from the models for the conditional mean and variance cannot, in general, be ignored, see Rémillard (2010), and so the above multi-stage GMM or iid bootstrap approaches are not applicable. Methods for conducting inference on the above parameters that are robust to time variation in the conditional copula are not yet available, to my knowledge. A potential method to overcome this is as follows: If the dynamics of the conditional copula (and conditional means and variances) are such that the serial dependence of the process can be replicated by a block bootstrap, then the approach used for fully parametric models may be suitable: (i) Use the a block bootstrap (e.g., that of Politis and Romano (1994)) to generate a bootstrap sample of the original data of length T; (ii) Estimate the conditional mean and variance models on the bootstrap sample, (iii) Compute the dependence measures on the estimated standardized residuals, (iv) Repeat steps (i)-(iii) S times, (v) Use the \u0000=2 and 1 \u0000 \u0000=2 quantiles of the simulated distribution of n\u0000^%i; ^\u0000q i ; ^\u0000L i ; ^\u0000U i \u0000oS i=1 to obtain a 1\u0000\u0000 con…dence interval for these parameters.10 2.3 Empirical illustration, continued Using the small-cap and large-cap equity index return data and marginal distribution models de- scribed in Section 1.1, we now examine their dependence structure. The rank correlation between these two series is estimated at 0:782; and an 90% iid bootstrap con…dence interval is [0:769; 0:793] : Thus the dependence between these two series is positive and relatively strong. The upper panel of Figure 3 presents the estimated quantile dependence plot, for q 2 [0:025; 0:975] ; along with 90% 1 0 Gaißer, et al. (2010) suggest a block bootstrap to conduct inference on dependence measures for serially dependent data, and it is possible that this approach may be combined with the results of Rémillard (2010) to justify the inference method outlined here, however this has not been considered in the literature to date. Other work on related problems include Genest and Rémillard (2008) and Ruppert (2011). 13 (pointwise) iid bootstrap con…dence intervals, and the lower panel presents the di¤erence between the upper and lower portions of this plot, along with a pointwise con…dence interval for this di¤er- ence. As expected, the con…dence intervals are narrower in the middle of the distribution (values of q close to 1/2) and wider near the tails (values of q near 0 or 1). This …gure shows that observations in the lower tail are somewhat more dependent than observa- tions in the upper tail, with the di¤erence between corresponding quantile dependence probabilities being as high as 0.1. The con…dence intervals show that these di¤erences are borderline signi…cant at the 0.10 level, with the upper bound of the con…dence interval on the di¤erence lying around zero for most values of q: We present a joint test for asymmetric dependence in the next section. Figure 3 also presents estimates of the upper and lower tail dependence coe¢ cients. These are based on the estimator in equation (17), using the method in Frahm, et al. (2005) to choose the threshold. The estimated lower tail dependence coe¢ cient is 0.411 with a 90% bootstrap con…dence interval of [0.112,0.664]. The upper tail dependence coe¢ cient is 0.230 with con…dence interval [0.022,0.529]. Thus we can reject the null of zero tail dependence for both the upper and lower tails. [ INSERT FIGURE 3 ABOUT HERE ] 2.4 Asymmetric dependence With an estimated quantile dependence function, and a method for obtaining standard errors, it is then possible to test for the presence of asymmetric dependence. This can provide useful guidance on the types of parametric copulas to consider in the modelling stage. A simple test for asymmetric dependence can be obtained by noting that under symmetric dependence we have: \u0000q = \u00001\u0000q 8 q 2 [0; 1] (18) Testing this equality provides a test of a necessary but not su¢ cient condition for symmetric dependence. Rather than test each q separately, and run into the problem of interpreting a set of multiple correlated individual tests, it is desirable to test for asymmetry jointly. Stack the 14 estimated quantile dependence measures into a vector of the form11: ^\u0000 \u0000 [\u0000q1; \u0000q2; :::; \u0000q2p] 0 where qp+j = 1 \u0000 qj, for j = 1; 2; :::; p (19) and then test: H0 : R\u0000 = 0 vs. Ha : R\u0000 6= 0 (20) where R \u0000 \u0000 Ip... \u0000 Ip \u0000 Using the fact that pT \u0000^\u0000 \u0000 \u0000 \u0000 d \u0000! N (0; V\u0000) from Rémillard (2010), and a bootstrap estimate of V\u0000; denoted ^V\u0000;S; we can use that under H0 : T \u0000^\u0000 \u0000 \u0000 \u00000 R0 \u0000R ^V\u0000;SR0\u0000\u00001 R \u0000^\u0000 \u0000 \u0000 \u0000 d \u0000! \u0000 2 p (21) Implementing this test on the estimated quantile dependence function for the S&P 100 and S&P 600 standardized residuals, with q 2 f0:025; 0:05; 0:10; 0:975; 0:95; 0:90g yields a chi-squared statistic of 2.54, which corresponds to a p-value of 0.47, thus we fail to reject the null that the dependence structure is symmetric using this metric. Of particular interest in many copula studies is whether the tail dependence coe¢ cients (i.e., the limits of the quantile dependence functions) are equal. That is, a test of H0 : \u0000L = \u0000U vs. Ha : \u0000L 6= \u0000U (22) Using the estimates and bootstrap inference methods from the previous section this is simple to implement. As noted above, the estimated tail dependence coe¢ cients are ^\u0000L = 0:411 and ^\u0000U = 0:230: The bootstrap p-value for this di¤erence is 0:595, indicating no signi…cant di¤erence in the upper and lower tail dependence coe¢ cients. 2.5 Time-varying dependence There is an abundance of evidence that the conditional volatility of economic time series changes through time, see Andersen, et al. (2006) for example, and thus reason to think that the conditional 1 1 An alternative to considering a …nite number of values of q would be to consider \u0000 as a function of all q 2 (0; 1) : This is feasible, but with a more complicated limiting distribution, and we do not pursue this here. 15 dependence structure may also vary through time. For example, Figure 4 presents a time series plot of rolling 60-day rank correlation, along with pointwise bootstrap standard errors (correct only under the null that this correlation is not changing). This …gure shows that the rank correlation hovered around 0.6-0.7 in the early part of the sample, rising to around 0.9 during the …nancial crisis of 2008-09. [ INSERT FIGURE 4 ABOUT HERE ] Before specifying a functional form for a time-varying conditional copula model, it is informative to test for the presence of time-varying dependence. The tests we will consider maintain a constant conditional copula under the null, and thus the results from Rémillard (2010) may be used here to obtain the limiting distribution of the test statistics we consider. There are numerous ways to test for time-varying dependence. We will focus here on tests that look for changes in rank correlation, %; both for the ease with which such tests can be implemented, and the guidance they provide for model speci…cation.12 The rank correlation measure associated with Ct will be denoted %t: We will consider three types of tests for time-varying dependence. The …rst test is a simple test for a break in rank correlation at some speci…ed point in the sample, t\u0000: Under the null, the dependence measure before and after this date will be equal, while under the alternative they will di¤er: H0 : %1 = %2 vs. Ha : %1 6= %2 (23) where %t = 8 < : %1; t \u0000 t\u0000 %2; t > t\u0000 A critical value for (^%1 \u0000 ^%2) can be obtained by using the iid bootstrap described in Section 2.2.2, noting that by imposing iid-ness when generating the bootstrap samples we obtain draws that impose the null hypothesis. This test is simple to implement, but requires the researcher to have a priori knowledge of when a break in the dependence structure may have occurred. In some applications this is reasonable, see Patton (2006a) for one example, but in other cases the date of the break, if present, is not known. 1 2 An alternative is to consider test statistics that look for changes any where in the copula, as in Rémillard (2010), which asymptotically will detect a greater variety of changes in the copula, but are harder to interpret and use in model speci…cation, and may have lower power in …nite samples. 16 A second test for time-varying dependence allows for a break in the rank correlation coe¢ cient at some unknown date. As usual for these types of tests, we must assume that the break did not occur “too close” to the start or end of the sample period (so that we have su¢ cient observations to estimate the pre- and post-break parameter), and a common choice is to search for breaks in an interval [t\u0000 L; t\u0000 U ] where t\u0000 L = d0:15T e and t\u0000 U = b0:85T c :13 A variety of test statistics are available for these types of tests, see Andrews (1993), and a simple, popular statistic is the “sup” test ^Bsup = max t\u00002[t\u0000 L;t\u0000 U ] \u0000 \u0000^%1;t\u0000 \u0000 ^%2;t\u0000\u0000 \u0000 (24) where ^%1;t\u0000 \u0000 12 t\u0000 t\u0000 X t=1 U1tU2t \u0000 3 (25) ^%2;t\u0000 \u0000 12 T \u0000 t\u0000 TX t=t\u0000+1 U1tU2t \u0000 3 A critical value for ^Bsup can again be obtained by using the iid bootstrap described in Section 2.2.2. A third test for time-varying dependence is based on the “ARCH LM” test for time-varying volatility proposed by Engle (1982). Rather than looking for discrete one-time breaks in the de- pendence structure, this test looks for autocorrelation in a measure of dependence, captured by an autoregressive-type model. For example, consider the following regression U1tU2t = \u00000 + pX i=1 \u0000iU1;t\u0000iU2;t\u0000i + \u0000t (26) or a parsimonious version of this regression: U1tU2t = \u00000 + \u00001 p pX i=1 U1;t\u0000iU2;t\u0000i + \u0000t (27) Under the null of a constant conditional copula, we should …nd \u0000i = 0 8 i \u0000 1; and this can be tested by forming the statistic ^Ap = ^\u0000 0R0 \u0000R ^V\u0000R0\u0000\u00001 R ^\u0000 where ^\u0000 \u0000 [\u00000; :::; \u0000p] 0 R = \u0000 0p\u00001...Ip \u0000 1 3 dae denotes the smallest integer greater than or equal to a; and bbc denotes the largest integer smaller than or equal to b. 17 and using the usual OLS estimate of the covariance matrix for ^V\u0000: Critical values for this test statistic can again be obtained using the iid bootstrap described in Section 2.2.2. Implementing these tests for time-varying dependence between the S&P 100 and S&P 600 standardized residuals yields results that are summarized in Table 2 below. Having no a priori dates to consider for the timing of a break, consider for illustration tests for a break at three points in the sample, at t\u0000=T 2 f0:15; 0:50; 0:85g ; which corresponds to the dates 23-Dec-1997, 7-July-2003, 8-Jan-2009. For the latter date evidence of a break in rank correlation is found, with a p-value of 0.045, while for the earlier two dates no evidence is present. Thus it appears that the rank correlation towards the end of the sample is di¤erent from that during the earlier part of the sample. However, given a lack of a reason for choosing a break date of 8-Jan-2009, a more appropriate test is one where the break date is estimated, and using that test the p-value is 0:269; indicating no evidence against a constant rank correlation in the direction of a one-time break. The plot of rank correlation in Figure 4, and related evidence for relatively smoothly evolving conditional volatility of …nancial assets, suggests that if rank correlation is varying, it may be more in an autoregressive-type manner than as a discrete, one-time change. Using the AR speci…cation for autocorrelation in (U1tU2t) described in equation (27), I …nd evidence of non-zero autocorrelation for lags 10 and 5, but no evidence at lag 1. Thus, we can conclude that there is evidence against constant conditional rank correlation for the S&P100 and S&P 600 standardized residuals, and thus evidence against a constant conditional copula. Given the wealth of evidence that volatility changes through time, this is not overly surprising, but it provides a solid motivation for considering models of time-varying copulas. [ INSERT TABLE 2 ABOUT HERE ] 3 Estimation and inference for copula models This section covers inference on the parameters of copula-based multivariate models. A key mo- tivation for obtaining the distribution of our parameter estimates is that the economic quantities of interest are functionals of the conditional distribution of Yt: For example, measures of depen- dence will be functions of the conditional copula (perhaps directly related to the copula parameters, perhaps not), and measures of risk will often be functions of both the copula and the marginal dis- tributions. Understanding the estimation error in our model will enable us to derive the estimation 18 error around the economic quantities of interest. Given their prevalence in the literature to date, we will focus on maximum likelihood estimation. Other estimation methods used in the literature are discussed in Section 3.3. A majority of applications of copula models for multivariate time series build the model in stages, and that case is considered in detail here. We will assume that the conditional mean and variance are modelled using some parametric speci…cation: E [YitjFt\u00001] \u0000 \u0000i (Zt\u00001; \u0000\u0000) , Zt\u00001 2 Ft\u00001 (28) V [YitjFt\u00001] \u0000 \u00002 i (Zt\u00001; \u0000\u0000) This assumption allows for a wide variety of models for the conditional mean: ARMA models, vector autoregressions, linear and nonlinear regressions, and others. It also allows for a variety of models for the conditional variance: ARCH and any of its numerous parametric extensions (GARCH, EGARCH, GJR-GARCH, etc., see Bollerslev, 2010), stochastic volatility models, and others. Note that Ft\u00001 will in general include lags of all variables in Yt; not only lags of Yit: The standardized residuals are de…ned as: \"it \u0000 Yit \u0000 \u0000i (Zt\u00001; \u0000\u0000) \u0000i (Zt\u00001; \u0000\u0000) (29) The conditional distribution of \"it is treated in one of two ways, either parametrically or nonpara- metrically. In the former case, this distribution may vary through time as a (parametric) function of Ft\u00001-measurable variables (e.g., the time-varying skewed t distribution of Hansen, 1994), or may be constant. In the nonparametric case, we will follow the majority of the literature and assume that the conditional distribution is constant. \"itjFt\u00001 s Fi (\u0000jZt\u00001; \u0000\u0000) (30) or \"itjFt\u00001 s iid Fi (31) For the identi…cation of the parameters of the conditional mean and variance models, the distrib- ution of \"it must have zero mean and unit variance. The choice of a parametric or nonparametric model for the distribution of the standardized residuals leads to di¤erent inference procedures for the copula parameters, and we will treat these two cases separately below. The conditional copula is the conditional distribution of the probability integral transforms of the standardized residuals. We will consider parametric copula models, and will consider both 19 constant and time-varying cases: Uit \u0000 Fi (\"it) , i = 1; 2; :::; n (32) and Ut \u0000 [U1t; :::; Unt] 0 jFt\u00001 s 8 < : iid C (\u0000\u0000) C (\u0000t (\u0000\u0000)) where \u0000t is the parameter of the copula C; and its time series dynamics are governed by the parameter \u0000\u0000: In the constant case we have simply \u0000t = \u0000\u0000 8 t: The parameter for the entire model is \u0000\u0000 \u0000 [\u0000\u00000; \u0000\u00000] 0 ; with \u0000\u0000 containing all parameters related to the marginal distributions, and \u0000\u0000 containing all parameters for the copula. 3.1 Parametric models When all components of the multivariate model are parametric, the most natural estimation method is maximum likelihood: in writing down a fully parametric model for the conditional distribution of Yt; we have fully speci…ed the likelihood. ^\u0000T = arg max \u0000 log LT (\u0000) (33) where log LT (\u0000) = TX t=1 log ft (YtjFt\u00001; \u0000) (34) log ft (YtjFt\u00001; \u0000) = nX i=1 log fit (YitjFt\u00001; \u0000) + log c (F1t (Y1tjFt\u00001; \u0000) ; :::; Fnt (YntjFt\u00001; \u0000) jFt\u00001; \u0000) Under regularity conditions, see White (1994) for example14, standard results for parametric time series models can be used to show that: pT \u0000 ^\u0000T \u0000 \u0000\u0000\u0000 d \u0000! N (0; V \u0000 \u0000 ) as T ! 1 (35) 1 4 For time-varying conditional copula models it can be di¢ cult to establish su¢ cient conditions for stationarity, which is generally required for standard estimation methods to apply. Results for general classes of univariate nonlinear processes are presented in Carrasco and Chen (2002) and Meitz and Saikkonen (2008), however similar results for the multivariate case are not yet available. Researchers usually make these regularity conditions a high level assumption, and then use simulation results to provide some reassurance that these assumptions are plausible for the model(s) under consideration. 20 A consistent estimator of the asymptotic covariance matrix can also be obtained using standard methods: ^V\u0000 = ^A\u00001 T ^BT ^A\u00001 T (36) where ^BT = 1 T TX t=1 ^st^s 0 t and ^AT = 1 T TX t=1 ^Ht ^st = @ @\u0000 log ft \u0000YtjFt\u00001; ^\u0000T \u0000 ^Ht = @2 @\u0000@\u00000 log ft \u0000YtjFt\u00001; ^\u0000T \u0000 Under the assumption that the model is correctly speci…ed, the “information matrix equality” holds, and so B0 = \u0000A0; where A0 \u0000 limT !1 ^AT and B0 \u0000 limT !1 ^BT : This means that we can alternatively estimate V \u0000 \u0000 by \u0000 ^A\u00001 T or by ^B\u00001 T : These estimators are all consistent for the true asymptotic covariance matrix: ^V\u0000 \u0000 V \u0000 \u0000 p \u0000! 0 as T ! 1 (37) 3.1.1 Multi-stage estimation of parametric copula-based models In many applications the multivariate model is speci…ed in such a way that the parameters can be estimated in separate stages. Such models require that the parameters that appear in the one marginal distribution do not also appear in another marginal distribution, and there are no cross- equation restrictions on these parameters. Standard models for the conditional mean (ARMA, VAR, etc.) satisfy this condition, as do most multivariate volatility models, with the notable exception of the BEKK model of Engle and Kroner (1995). If the parameters are indeed separable into parameters for the …rst margin, \u00001; parameters for the second margin, \u00002; etc., and parameters for the copula, \u0000; then the log-likelihood takes the form: TX t=1 log ft (Yt; \u0000) = TX t=1 nX i=1 log fit (Yit; \u0000i) + TX t=1 log ct (F1t (Y1t; \u00001) ; :::; Fnt (Ynt; \u0000n) ; \u0000) (38) Maximizing the parameters separately for the margins and the copula is sometimes called “inference functions for margins”, see Joe (1997) and Joe and Xu (1996), though more generally this is known 21 as multi-stage maximum likelihood (MSML) estimation. De…ne the MSML estimator as ^\u0000T;M SM L \u0000 \u0000^\u00000 1;T;M SM L; :::; ^\u00000 n;T;M SM L; ^\u00000 T;M SM L\u00000 ^\u0000i;T;M SM L \u0000 arg max \u0000i TX t=1 log fit (Yit; \u0000i) , i = 1; 2; :::; n (39) ^\u0000T;M SM L \u0000 arg max \u0000 TX t=1 log ct (F1t (Y1t; ^\u00001;T;M SM L) ; :::; Fnt (Ynt; ^\u0000n;T;M SM L) ; \u0000) Clearly, MSMLE is asymptotically less e¢ cient than one-stage MLE. However, simulation studies in Joe (2005) and Patton (2006b) indicate that this loss is not great in many cases. The main appeal of MSMLE relative to (one-stage) MLE is the ease of estimation: by breaking the full parameter vector into parts the estimation problem is often greatly simpli…ed. As for one-stage MLE, under regularity conditions, see White (1994) or Patton (2006b), the MSMLE is asymptotically normal: pT \u0000 ^\u0000T;M SM L \u0000 \u0000\u0000\u0000 d \u0000! N (0; V \u0000 M SM L) as T ! 1 (40) While estimation is simpli…ed by breaking up estimation in stages, the calculation of an estimator of the asymptotic covariance matrix is more complicated. A critical point to note is that one cannot simply take the inverse Hessian of the copula likelihood (the equivalent of \u0000 ^AT in the previous section) as an estimator of the asymptotic covariance of the estimated copula parameters: that estimator ignores the estimation error that arises from the use of \u0000^\u00000 1;T;M SM L; :::; ^\u00000 n;T;M SM L\u00000 rather than [\u0000\u00000 1 ; :::; \u0000\u00000 n ] 0 in the copula estimation step. To capture that additional source of estimation error, the following estimator should be used: ^VM SM L = ^A\u00001 T ^BT \u0000 ^A\u00001 T \u00000 (41) Note that the information matrix equality does not hold for MSML, and so this “sandwich form” for the asymptotic covariance matrix estimator is required. The ^BT matrix in this case is the analog of that in one-stage MLE: ^BT = 1 T TX t=1 ^st^s 0 t where ^st \u0000 \u0000 ^s 0 1t; :::; ^s 0 nt; ^s 0 ct\u00000 (42) ^sit = @ @\u0000i log fit (Yit; ^\u0000i;T;M SM L) , i = 1; 2; :::; n ^sct = @ @\u0000 log ct \u0000F1t (Y1t; ^\u00001;T;M SM L) ; :::; Fnt (Ynt; ^\u0000n;T;M SM L) ; ^\u0000T;M SM L\u0000 22 The ^AT matrix takes a di¤erent form for MSML, re‡ecting the presence of estimated parameters in the copula log-likelihood: ^AT = 1 T TX t=1 ^Ht where ^Ht = 2 6 6 6 6 6 6 6 6 6 4 r2 11;t 0 \u0000 \u0000 \u0000 0 0 0 r2 22;t \u0000 \u0000 \u0000 0 0 ... ... . . . ... ... 0 0 \u0000 \u0000 \u0000 r 2 nn;t 0 r2 1c;t r2 2c;t \u0000 \u0000 \u0000 r2 nc;t r2 cc;t 3 7 7 7 7 7 7 7 7 7 5 (43) r2 ii;t = @2 @\u0000i@\u00000 i log fit (Yit; ^\u0000i;T;M SM L) , i = 1; 2; :::; n r2 ic;t = @2 @\u0000@\u00000 i log ct \u0000F1t (Y1t; ^\u00001;T;M SM L) ; :::; Fnt (Ynt; ^\u0000n;T;M SM L) ; ^\u0000T;M SM L\u0000 r2 cc;t = @2 @\u0000@\u00000 log ct \u0000F1t (Y1t; ^\u00001;T;M SM L) ; :::; Fnt (Ynt; ^\u0000n;T;M SM L) ; ^\u0000T;M SM L\u0000 The above discussion shows that ^VM SM L is somewhat tedious to obtain, although each of the steps required is no more di¢ cult that the usual steps required to estimate a “sandwich form” asymptotic covariance matrix. An alternative to these calculations is to use a block bootstrap for inference, see Gonçalves and White (2004) for theoretical justi…cation. This is done as follows: (i) Use a block bootstrap (e.g., the stationary bootstrap of Politis and Romano (1994)) to generate a bootstrap sample of the data of length T; (ii) Estimate the model using the same multi-stage approach as applied for the real data, (iii) Repeat steps (i)-(ii) S times (e.g., S = 1000), (iv) Use the \u0000=2 and 1 \u0000 \u0000=2 quantiles of the distribution of n ^\u0000ioS i=1 to obtain a 1 \u0000 \u0000 con…dence interval for these parameters. 3.2 Semiparametric models Given the sample sizes that are commonly available in economics and …nance, it is often possible to reliably estimate univariate distributions nonparametrically (for example, by using the empir- ical distribution function) but not enough to estimate higher-dimension distributions or copulas, necessitating the use of a parametric model. Semiparametric copula-based models marry these two estimation methods, using a nonparametric model for the marginal distributions, such as the empirical distribution function (EDF), and a parametric model for the copula. In such cases the 23 estimation of the copula parameter is usually conducted via maximum likelihood, and in this liter- ature this estimator is sometimes called the “canonical maximum likelihood” estimator. ^\u0000T \u0000 arg max \u0000 TX t=1 log c \u0000 ^U1t; :::; ^Unt; \u0000\u0000 where ^Uit \u0000 ^Fi (^\"it) , i = 1; 2; :::; n (44) ^Fi (\") \u0000 1 T + 1 TX t=1 1 f^\"it \u0000 \"g ^\"it \u0000 Yit \u0000 \u0000i (Zt\u00001; ^\u0000i) \u0000i (Zt\u00001; ^\u0000i) The asymptotic distribution of this estimator was studied by Genest, et al. (1995) for iid data and by Chen and Fan (2006a,b) for time series data.15 The di¢ culty here, relative to the parametric case is that the copula likelihood now depends on the in…nite-dimensional parameters Fi; as well as the marginal distribution parameters \u0000: Standard maximum likelihood methods cannot be applied here. Chen and Fan (2006b) and Chan et al. (2009) provided conditions under which the following asymptotic normal distribution is obtained: pT (^\u0000T \u0000 \u0000\u0000) d \u0000! N (0; V \u0000 SP M L) as T ! 1 (45) where V \u0000 SP M L = A \u00001 CF \u0000A\u00001 CF The asymptotic covariance matrix, VSP M L; takes the “sandwich”form. The outer matrix, ACF ; is an inverse Hessian, and Chen and Fan (2006b) show that it can be estimated by: ^ACF;T \u0000 \u0000 1 T TX t=1 @2 log ct \u0000 ^U1t; :::; ^Unt; ^\u0000T \u0000 @\u0000@\u00000 (46) The inner matrix, \u0000; is a form of outer product of gradients, but for this semiparametric estimator it is not simply the scores of the log-likelihood; an additional term appears due to the presence of 1 5 Chen, Fan and Tsyrennikov (2006) propose a one-stage estimator of this model, in contrast with the multi-stage estimator considered here, based on splines for the nonparametric marginal distribution functions which attains full e¢ ciency. 24 the EDF in the objective function: ^\u0000T = 1 T TX t=1 sts 0 t (47) where st \u0000 @ @\u0000 log ct \u0000 ^U1t; :::; ^Unt; ^\u0000T \u0000 + nX j=1 ^Qjt (48) ^Qjt \u0000 1 T TX s=1;s6=t @2 log ct \u0000 ^U1s; :::; ^Uns; ^\u0000T \u0000 @\u0000@Uj (1 fUjt \u0000 Ujsg \u0000 Ujs) (49) The above result shows that the asymptotic variance of the MLE of the copula parameter depends on the estimation error in the EDF (through the terms ^Qjt) but surprisingly does not depend upon the estimated parameters in the marginal distributions (^\u0000j). This is particularly surprising as all estimates in this framework are pT -consistent. Thus in this case the researcher can esti- mate ARMA-GARCH type models (or others) for the conditional mean and variance, compute the standardized residuals, and then ignore, for the purposes of copula estimation and inference, the estimation error from the ARMA-GARCH models. Two important caveats are worth noting here: Firstly, this only applies for constant conditional copula models; if the conditional copula is time-varying, the Rémillard (2010) shows that the estimation error from the models for the conditional mean and variance will a¤ect the asymptotic distribution of the copula parameter es- timate. Second, this only applies when the marginal distributions of the standardized residuals are estimated nonparametrically; as discussed in the previous section, with parametric marginal distribution models the estimation error from the models for the conditional mean and variance will, in general, a¤ect the distribution of the copula parameter estimate. Chen and Fan (2006b) and Rémillard (2010) also propose a simple bootstrap alternative to the above calculations for inference on the estimated copula parameters: (i) Use an iid bootstrap to generate a bootstrap sample of the estimated standardized residuals of length T; (ii) Transform each time series of bootstrap data using its empirical distribution function, (iii) Estimate the copula model on the transformed data (iv) Repeat steps (i)-(iii) S times (e.g., S = 1000), (v) Use the \u0000=2 and 1 \u0000 \u0000=2 quantiles of the distribution of n ^\u0000ioS i=1 to obtain a 1 \u0000 \u0000 con…dence interval for these parameters. Of course, the bootstrap distribution of the parameter estimates can also be used for conducting joint tests on the parameters. Another alternative, proposed by Rémillard (2010), is to simulate from the estimated copula model, rather than bootstrap the standardized residuals: (i) Simulate a sample of length T using 25 iid draws from the copula model using the estimated parameters, (ii) Transform each series using its EDF,16, then follow steps (iii)-(v) of the bootstrap method above. 3.3 Other estimation methods While maximum likelihood estimation is the most prevalent in the literature, other methods have been considered. Method of moments-type estimators, where the parameter of a given family of copulas has a known, invertible, mapping to a dependence measure (such as rank correlation or Kendall’s tau) are considered in Genest (1987), Ghoudi and Rémillard (2004) and Rémillard (2010), among others. Generalized method of moments, where the number of dependence measures may be greater than the number of unknown parameters, and simulated method of moments are considered in Oh and Patton (2011a). Minimum distance estimation is considered by Tsukahara (2005). Bayesian estimation of copula models is considered in Min and Czado (2010), Smith, et al. (2010a,b), see Smith (2011) for a review. 3.4 Empirical illustration, continued In this section we continue our study of daily returns on a large-cap equity index (the S&P 100) and a small-cap equity index (the S&P 600), over the period 1995-2011. In Section 1.1 we veri…ed that simple AR-GARCH type models for the conditional mean and variance appeared to …t the data well, and we con…rmed that the skewed t distribution of Hansen (1994) could not be rejected as a model for the conditional distribution of the standardized residuals using goodness-of-…t tests. In Sections 2.4 and 2.5 we found mild evidence of asymmetric dependence between these two series (with crashes being more strongly dependent than booms) and stronger evidence for time-varying dependence. We will now consider a variety of parametric models for the copula of these two series, along with several di¤erent approaches for computing standard errors on the estimated parameters. A summary of some common copula models and their properties is presented in Table 3.17 1 6 Note that we estimate the marginal distributions of the simulated draws from the copula model using the EDF, even though the margins are known to be U nif (0; 1) in this case, so that the simulation approach incorporates the EDF estimation error faced in practice. 1 7 Mixtures of copulas are also valid copulas, and thus by combining the simple copulas in Table 3 new models may be obtained, see Hu (2006) for example. 26 We will …rst discuss the use of parametric copula models for estimating tail dependence coef- …cients. Then we will consider models for the entire dependence function, …rst assuming that the conditional copula is constant, and then extend to time-varying conditional copulas. [ INSERT TABLE 3 ABOUT HERE ] 3.4.1 Estimating tail dependence using parametric copula models An alternative to the nonparametric estimation of tail dependence coe¢ cients discussed in Section 2.1 is to specify and estimate parametric models for the tails of the joint distribution, see McNeil, et al. (2005) for example. For data sets with relatively few observations, the additional structure provided by a parametric model can lead to less variable estimates, though the use of a parametric model of course introduces the possibility of model misspeci…cation. This approach uses a parametric model on the bivariate tail and use the …tted model to obtain an estimate of the tail dependence coe¢ cient. To allow for asymmetric dependence, this is done on the lower and upper tails separately.18 To do this, note from Chen, et al. (2010), that if (U; V ) s C (\u0000) ; then the log-likelihood of (U; V ) conditional on fU > q; V > qg is log L (\u0000jq) = 1 T TX t=1 lt (\u0000jq) where lt (\u0000jq) = \u00001t\u00002t log c \u0000 ~Ut; ~Vt; \u0000\u0000 + \u00001t (1 \u0000 \u00002t) log @C \u0000 ~Ut; ~Vt; \u0000\u0000 @u (50) + (1 \u0000 \u00001t) \u00002t log @C \u0000 ~Ut; ~Vt; \u0000\u0000 @v + (1 \u0000 \u00001t) (1 \u0000 \u00002t) log C \u0000 ~Ut; ~Vt; \u0000\u0000 and ~Ut = max [Ut; q] , ~Vt = max [Vt; q] \u00001t = 1 fUt > qg , \u00002t = 1 fVt > qg That is, we replace all values of (Ut; Vt) that are less than q by q; and we use the indicators \u00001t and \u00002t to record the values that are not censored. Maximizing the above likelihood yields an estimate of 1 8 Note also that the parametric copula chosen must, obviously, be one that allows for non-zero tail dependence in the tail in which it is to be used. For example, using a Normal or Frank copula as a model for the tail copula guarantees that the estimated tail dependence coe¢ cient is zero, as this is a feature of these copulas, see Table 3. Similarly, using the left tail of the Gumbel copula also ensures an estimated tail dependence of zero. Instead, one should use the right tail of a Gumbel copula, or a t copula, or the left tail of a Clayton copula, or one of many other copulas that allow for non-zero tail dependence. See de Haan, et al. (2008) for details on estimation and testing of parametric tail copulas. 27 the parameters of the upper tail copula. The lower tail copula can be modeled similarly. Estimation via MLE is generally simple, and all that is required beyond usual MLE is a function for the copula cdf (which is usually already known) and a function for @C=@u and @C=@v: For many copulas these latter functions are easy to obtain. Given an estimate of the tail copula parameter for each of the tails, we obtain the estimated tail dependence coe¢ cients as: ^\u0000L = lim q!0+ CL \u0000q; q; ^\u0000L\u0000 q (51) ^\u0000U = lim q!1\u0000 1 \u0000 2q + CU \u0000q; q; ^\u0000U \u0000 1 \u0000 q These coe¢ cients are known in closed form for many commonly-used copulas (e.g., the Gumbel, Clayton, and Student’s t), see Joe (1997), Nelsen (2006) and Demarta and McNeil (2005), and see Table 3 for a summary. Table 4 presents four estimates of these coe¢ cients, the …rst two are nonparametric (the expres- sion for the “log”estimator is given in equation (17), and the “sec”estimator is given in Frahm, et al., 2005), and the second two are parametric, based on the Gumbel and Student’s t for the upper tail, and the “rotated Gumbel”and Student’s t for the lower tail. The cuto¤s used for determining the parametric tail copula are 0:025 and 0:975; which yields 49 (39) observations to estimate the lower (upper) tail copula.19 The estimated tail copula parameters are ^\u0000L = 1:455 and ^\u0000U = 1:263; and using the expression for the tail dependence of a Gumbel copula presented in Table 3, the implied estimated tail dependence coe¢ cients are ^\u0000L = 0:390 and ^\u0000U = 0:269: The Student’s t tail copula parameters are \u0000^\u0000L; ^\u0000L\u0000 = [0:592; 4:896] and \u0000^\u0000U ; ^\u0000U \u0000 = [0:446; 5:889] ; implying tail dependence coe¢ cients of ^\u0000L = 0:266 and ^\u0000U = 0:149: An iid bootstrap was again used to obtain a 90% con…dence interval on these estimates, reported in Table 4. As Table 4 reveals, the point estimates of the upper and lower tail dependence coe¢ cients are very similar across three of the four methods, with the tail dependence implied by the Student’s t copula being lower than the other three estimates. The precision of these estimates, however, varies greatly depending on whether a parametric or nonparametric approach is used. [ INSERT TABLE 4 ABOUT HERE ] 1 9 As usual in estimating “tail” quantities, the choice of cut-o¤ is somewhat arbitrary. I experimented with cut-o¤ values between 0.01 and 0.05. 28 3.4.2 Constant copula models Next we consider copula models for the entire dependence structure, not just the tails. The estima- tion of constant copula models is straightforward and fast for the multi-stage estimation method we consider here, as the number of parameters in most (bivariate) copulas is just one or two. In higher dimensions the task is more challenging, see Oh and Patton (2011b) for an example of a 100-dimensional copula application. In Table 5 below we …rst present the estimated parameters and values of the log-likelihood for a variety of models. The left columns present results for the fully parametric case (where the parametric copulas are combined with parametric models for the marginal distributions) and the right columns contain results for the semiparametric models. The top three models in terms of log-likelihood are highlighted in bold.20 [ INSERT TABLE 5 ABOUT HERE ] Table 5 reveals that of these nine speci…cations, the best copula model for both the parametric and semiparametric case is the Student’s t copula, followed by the “rotated Gumbel” copula and then the Normal copula. By far the worst model is the “rotated Clayton” copula, which imposes zero lower tail dependence and allows only for upper tail dependence. Next we focus on a subset of these models, and compute a range of di¤erent standard errors for the estimated parameters. For both the parametric and semiparametric cases, we consider (i) naïve standard errors, where the estimation error from the earlier stages of estimation (AR, GARCH and marginal distributions) is ignored, (ii) multi-stage MLE or multi-stage semiparametric MLE (MSML) standard errors, using the asymptotic distribution theory for these estimators in Patton (2006b) or Chen and Fan (2006b) respectively, (iii) bootstrap standard errors, using either a block bootstrap21 of the original returns and estimation of all stages on the bootstrap sample (parametric case), based on Gonçalves and White (2004), or an iid bootstrap of the standardized residuals and estimation only of the EDF and the copula (semiparametric case), based on Chen and Fan (2006b) and Rémillard (2010), and (iv) a simulation-based standard error. For the parametric case the model for the entire joint distribution is simulated many times using the estimated parameters, and on each of the simulated samples the parameters are re-estimated, while for the semiparametric 2 0 The inverse degrees of freedom parameter, \u0000\u00001; is estimated to facilitate simple tests on this parameter below. 2 1 Speci…cally, the stationary bootstrap of Politis and Romano (1994) with an average block length of 60 observations is used. 29 case only the copula model is simulated, the EDF of the simulated data is computed, and the copula parameters are re-estimated, as suggested by Rémillard (2010). In the parametric case this approach yields correct …nite-sample standard errors, while the semiparametric case, and all the other methods of obtaining standard errors, rely on asymptotic theory. For the bootstrap and the simulation-based standard errors 1000 replications are used. The results are presented in Table 6. [ INSERT TABLE 6 ABOUT HERE ] Table 6 shows that the naïve standard errors are too small relative to the correct MSML standard errors, a predictable outcome given that naïve standard errors ignore the additional estimation error arising from the estimation of marginal distribution parameters. In the parametric case the naïve standard errors are on average about half as large as the MSML standard errors (average ratio is 0.54), while for the semiparametric case the ratio is 0.84. The relatively better performance in the semiparametric case is possibly attributable to the fact that the MSML standard errors in that case can, correctly, ignore the estimation error coming from the AR-GARCH models for the conditional mean and variance, with adjustment required only for estimation error coming from the EDF. In the fully parametric case, adjustments for estimation error from marginal distribution shape parameters and the parameters of the AR-GARCH models must be made. In both the parametric and the semiparametric cases the bootstrap standard errors are very close to the MSML standard errors, with the ratio of the former to the latter being 0.98 and 0.97 respectively. This is what we expect asymptotically, and con…rms that the researcher may use either ‘analytical’ MSML standard errors or more computationally-intensive bootstrap standard errors for inference on the estimated copula parameters. The simulation-based standard errors for the semiparametric case are also close to the MSML standard errors (with the average ratio being 1.07). In the parametric case, where correct …nite-sample standard errors can be obtained, we see that these are smaller than the MSML and bootstrap standard errors, with the average ratio being around 0.7. Asymptotically we expect this ratio to go to 1, but in …nite samples this value of ratio will depend on the particular model being used. 3.4.3 Time-varying copula models Next we consider two time-varying models for the conditional copula of these standardized residuals. In both cases we will use the “GAS”model of Creal, et al. (2011), which speci…es the time-varying 30 copula parameter (\u0000t) as evolving as a function of the lagged copula parameter and a “forcing variable” that is related to the standardized score of the copula log-likelihood. To deal with parameters that are constrained to lie in a particular range (e.g., a correlation parameter forced to take values only inside (\u00001; 1)), this approach applies a strictly increasing transformation (e.g., log, logistic, arc tan) to the copula parameter, and models the evolution of the transformed parameter, denoted ft : ft = h (\u0000t) , \u0000t = h\u00001 (ft) (52) where ft+1 = ! + \u0000ft + \u0000I \u00001=2 t st (53) st \u0000 @ @\u0000 log c (U1t; U2t; \u0000t) (54) It \u0000 Et\u00001 \u0000 sts 0 t\u0000 = I (\u0000t) (55) Thus the future value of the copula parameter is a function of a constant, the current value, and the score of the copula-likelihood, I \u00001=2 t st: We will consider a time-varying rotated Gumbel copula and time-varying Student’s t copula. The Gumbel copula parameter is required to be greater than one, and the function \u0000t = 1 + exp (ft) is used to ensure this. For the Student’s t copula we will assume that the degrees of freedom parameter is constant and that only the correlation parameter is time-varying. As usual, this parameter must lie in (\u00001; 1) ; and the function \u0000t = (1 \u0000 exp f\u0000ftg) = (1 + exp f\u0000ftg) is used to ensure this. The estimated parameters for these two models are presented in Table 7. For both the paramet- ric and the semiparametric models we see that the Student’s t speci…cation has a higher value of the likelihood, perhaps re‡ecting its additional free parameter. Consistent with what one might expect given results in the volatility literature, the estimated degrees of freedom parameter is higher for the time-varying Student’s t copula model than for the constant version (11.2 compared with 6.9). Thus time-varying dependence may explain some (but not all) of the tail dependence estimated via the constant Student’s t copula, see Manner and Segers (2011) on stochastic copulas and tail dependence. When the time-varying conditional copula model is combined with parametric marginal distrib- utions the resulting joint distribution is fully parametric, and all of the inference methods reviewed for the constant copula case may be applied here. The left panel of Table 7 presents four di¤er- ent estimates of the standard errors of these models. As in the constant case, we again observe that the naïve standard errors, which ignore the estimation error contributed from the marginal 31 distributions, are too small relative to the MSML standard errors, and the MSML and bootstrap standard errors are generally similar. When the marginal distributions are estimated using the EDF, the resulting joint distribution is semiparametric. Unlike the constant copula case, the true standardized residuals in this case are not jointly iid; even though they are individually iid; which means that the theoretical results of Chen and Fan (2006a) and Rémillard (2010) cannot be applied. Moreover this implies (see Rémillard, 2010) that the estimation error coming from the parametric models for the marginal dynamics will, in general, a¤ect the asymptotic distribution of the estimated copula parameters. Inference methods for these models have not yet been considered in the econometrics or statistics literature, to the best of my knowledge. One intuitive inference method, which still needs formal justi…cation, is to use a block bootstrap technique similar to the parametric case, where the original data are bootstrapped (in blocks, to preserve the temporal dependence structure) and then the semiparametric model is estimated on the bootstrap data22. Standard errors using such a technique are presented in the right panel of Table 7, along with naïve standard errors that ignore the estimation error in the marginal distributions altogether. [ INSERT TABLE 7 ABOUT HERE ] 4 Model selection and goodness-of-…t testing In this section we consider the problems of model selection and goodness-of-…t (GoF) testing. The latter problem is the traditional speci…cation testing problem, and seeks to determine whether the proposed copula model is di¤erent from the (unknown) true copula. The former testing problem seeks to determine which model in a given set of competing copula models is the “best”, according to some measure. In economic applications GoF tests and model selection tests are complementary: In some applications a GoF test is too weak a criterion, as limited data may mean that several, non- overlapping, models are not rejected. In other applications a GoF test may be too strict a criterion, as in economics we generally do not expect any of our models to be correctly speci…ed, and a rejection does not necessarily mean that the model should be discarded. Model selection tests, on the other hand, allow the researcher to identify the best model from the set, however they do 2 2 See footnote 10 for discussion. 32 not usually provide any information on whether the best model is close to being true (which is a question for a GoF test) or whether it is the “best of a bad bunch”of models. These caveats noted, GoF tests and model selection tests are useful ways of summarizing model performance. 4.1 Tests of goodness of …t Inference for tests of goodness-of-…t (GoF) di¤er depending on whether the model under analysis is parametric or semiparametric, and we will consider these two cases separately. We will focus on in-sample (full sample) tests of GoF, see Chen (2011) for analysis of out-of-sample GoF tests. Two tests that are widely used for GoF tests of copula models are the Kolmogorov-Smirnov and the Cramer-von Mises tests23. The test statistics for these tests in univariate applications are presented in equations (9) and (10); the multivariate versions of these statistics are presented below. These tests use the empirical copula, denoted ^CT ; which is also de…ned below. ^CT (u) \u0000 1 T TX t=1 nY i=1 1 n ^Uit \u0000 uio (56) KSC = max t \u0000 \u0000 \u0000C \u0000Ut; ^\u0000T \u0000 \u0000 ^CT (Ut) \u0000 \u0000 \u0000 (57) CvMC = TX t=1 n C \u0000Ut; ^\u0000T \u0000 \u0000 ^CT (Ut) o2 (58) Note that approaches based on a comparison with the empirical copula, such as those above, only work for constant copula models, as they rely on the empirical copula serving as a nonparametric estimate of the true conditional copula. When the true conditional copula is time-varying, the empirical copula can no longer be used for that purpose. One way of overcoming this problem is to use the …tted copula model to obtain the “Rosenblatt” transform of the data, which is a multivariate version of the probability integral transformation, and was used in Diebold, et al. (1999) and further studied in Rémillard (2010). In the bivariate case, the transform is V1t = U1t 8 t (59) V2t = C2j1;t (U2tjU1t; \u0000) 2 3 Genest, et al. (2009) provide a comprehensive review of the many copula GoF tests available in the literature, and compare these tests via a simulation study. Across a range of data generating processes, they conclude that a Cramer-von Mises test (applied to the empirical copula or to the Rosenblatt transform of the original data) is the most powerful, a …nding that is supported by Berg (2009) who considers some further tests. 33 where C2j1;t is the conditional distribution of U2tjU1t: In general multivariate applications, the transformation is: Vit = @i\u00001C (U1t; :::; Uit; 1; :::; 1) @u1 \u0000 \u0000 \u0000 @ui\u00001 \u0000 @i\u00001C (U1t; :::; Ui\u00001;t; 1; :::; 1) @u1 \u0000 \u0000 \u0000 @ui\u00001 ; i = 2; :::; n (60) \u0000 Ciji\u00001;:::;1 (UitjUi\u00001;t; :::; U1) c1;2;:::;i\u00001 (Ui\u00001;t; :::; U1) i.e., the numerator is the conditional distribution of Uit given [U1t; :::; Ui\u00001;t] ; and the denominator is the conditional density of [U1t; :::; Ui\u00001;t] : The usefulness of this transformation lies in the result that if the speci…ed conditional copula model is correct, then Vt \u0000 [V1t; :::; Vnt] 0 s iid Cindep (61) That is, the Rosenblatt transformation of the original data returns a vector of iid and mutually independent U nif (0; 1) variables. With this result in hand, we can again use the KS or CvM test statistics to test whether the empirical copula of the estimated Rosenblatt transforms is signi…cantly di¤erent from the independence copula.24 ^C v T (v) \u0000 1 T TX t=1 nY i=1 1 fVit \u0000 vig (62) C v \u0000Vt; ^\u0000T \u0000 = nY i=1 Vit (63) KSR = max t \u0000 \u0000 \u0000C v \u0000Vt; ^\u0000T \u0000 \u0000 ^C v T (Vt) \u0000 \u0000 \u0000 (64) CvMR = TX t=1 n C v \u0000Vt; ^\u0000T \u0000 \u0000 ^C v T (Vt) o2 (65) 4.1.1 Fully parametric For fully parametric copula-based models, GoF testing is a relatively standard problem, as these models are simply non-linear time series models. See Corradi and Swanson’s (2006) review article on evaluating predictive densities, Bontemps, et al. (2011) and Chen (2011) on GoF tests for multivariate distributions via moment conditions, and Diebold, et al. (1999) on GoF tests via 2 4 Note that the order of the variables a¤ects the Rosenblatt transformation. In most economic applications the ordering of the variables is arbitrary. One way to overcome this is to conduct the test on all possible orderings and then de…ne a new test statistic as the maximum of all the test statistics. The simulation-based methods for obtaining critical values described below could also be applied to this “combination” test statistic. 34 Rosenblatt’s transform, discussed below (although the latter paper ignores estimation error in the model parameters). A di¢ culty in obtaining critical values for GoF test statistics, such as the KS and CvM test statistics, is that they depend on estimated parameters, both in the copula and also in marginal distributions. As discussed in the context of obtaining standard errors on estimated copula para- meters, the parameter estimation error coming from the marginal distributions cannot in general be ignored. GoF tests can be implemented in various ways, but for fully parametric models a simple simulation-based procedure is always available: (i) Estimate the margins and copula model pa- rameters on the actual data to obtain the parameter estimate, ^\u0000T (ii) Compute the GoF test statistic (for example, the Kolmogorov-Smirnov or Cramer-von Mises test statistics) on the actual data, ^GT (iii) Simulate a time series of length T from the model using the estimated parameter ^\u0000T (iv) Estimate the model on the simulated data to obtain ^\u0000(s) T (v) Compute the GoF statistic on the simulated data, ^G(s) T ; (vi) Repeat steps (iii)-(v) S times, (vii) compute the simulation-based p-value for this test as: pT;S = 1 S XS s=1 1 n ^G(s) T \u0000 ^GT o (66) 4.1.2 Semiparametric Rémillard (2010) considers GoF tests for semiparametric copula-based models for time series, and shows the surprising and useful result that the asymptotic distributions of GoF copula tests are una¤ected by the estimation of marginal distribution parameters (as was the case for the asymptotic distribution of the estimated copula parameters). The estimation error coming from the use of the empirical distribution functions does matter, and he proposes a simple simulation-based method to capture this: (i) estimate the margins and copula model parameters on the actual data to obtain the parameter estimate, ^\u0000T (ii) Compute the GoF test statistic (for example, the Kolmogorov- Smirnov or Cramer-von Mises test statistics) on the actual data, ^GT (iii) Simulate a time series of length T from the copula model using the estimated parameter ^\u0000T (iv) Transform each time series of simulated data using its empirical distribution function (v) Estimate the copula model on the transformed simulated data to obtain ^\u0000(s) T (vi) Compute the GoF statistic on the simulated data, ^G(s) T ; (vi) Repeat steps (iii)-(vi) S times, (viii) compute the simulation-based p-value for this test as in the parametric case. 35 The case of nonparametric margins combined with a time-varying conditional copula has not yet been considered in the literature. In the empirical example below I obtain a simulation-based p-value using the same approach as the parametric case considered in the previous section, using the EDF in place of the estimated parametric marginal distribution. Theoretical support for this approach is still required. 4.1.3 Empirical illustration, continued Table 8 presents the results of four GoF tests for the copula models considered in Section 3.4. The top panel considers fully parametric models, and the lower panel semiparametric models. Both KS and CvM tests are applied, either to the empirical copula of the standardized residuals (KSC and CvMC) or to the Rosenblatt transformation of the standardized residuals (KSR and CvMR). For the two time-varying copula models only the tests based on the Rosenblatt transformation are applicable. The left panel presents the p-values from an implementation of these tests that ignores the estimation error from the marginal distributions, though it does take into account the estimation error from the copula parameters. The right panel presents p-values from tests that appropriately account for estimation error from the marginal distributions. We observe in Table 8 that ignoring estimation error leads almost uniformly to p-values that are larger than when this estimation error is taken into account. Thus in addition to providing a false estimate of high precision of estimated parameters, as observed in Tables 6 and 7, ignoring estimation error from the marginal distributions also provides a false indication of a good …t to the data. Using the correct p-values, we observe that the constant conditional copula models are all rejected, particularly so when combined with nonparametric marginal distributions. The time- varying (GAS) copula models both pass the GoF tests in the parametric case, however only the rotated Gumbel speci…cation passes the CvM test in the semiparametric case. Thus we have substantial evidence against the constant copula assumption, and moderate evidence that the two time-varying copula models described in Section 3.4 are also rejected. [ INSERT TABLE 8 ABOUT HERE ] 36 4.2 Model selection tests The problem of …nding the model that is best, according to some criterion, among a set of competing models (i.e., the problem of “model selection”) may be undertaken either using the full sample (in-sample) of data, or using an out-of-sample (OOS) period. The treatment of these two cases di¤ers, as does the treatment of parametric and semiparametric models, and we will consider all four combinations. The problem also di¤ers on whether the competing models are nested or non- nested. Below we will focus on pair-wise comparisons of models; for comparisons of large collections of models see White (2000), Romano and Wolf (2005) and Hansen, et al. (2011), for example. 4.2.1 Fully parametric, in-sample In-sample, fully parametric, model selection tests are generally straightforward if the competing models are nested, as a likelihood ratio test can generally be used.25 In this case the smaller model is held as the true model under the null hypothesis, and under the alternative the larger model is correct. For example, comparing a Normal copula with a Student’s t copula can be done via a test on the inverse degree of freedom parameter: H0 : \u0000\u00001 = 0 vs. Ha : \u0000\u00001 > 0 (67) Notice that the parameter, \u0000\u00001; is on the boundary under the null, and so the usual t-statistic will not have the usual N (0; 1) limited distribution, however the right-tail critical values (which are the ones that are relevant for testing against this alternative) are the same, e.g., 90% and 95% critical values for the t statistic are 1.28 and 1.64. Rivers and Vuong (2002) consider model selection for general parametric nonlinear dynamic models. They allow for many pT -consistent estimators (e.g., ML, GMM, minimum distance), they consider nested and non-nested models, and they allow one or both models to be misspeci…ed. This latter feature is particularly attractive in economic applications. Rivers and Vuong (2002) consider a range of di¤erent applications, but for copula applications their results simplify greatly if (i) the models are non-nested, (ii) we estimate the marginals and the copula by ML (one-stage or multi-stage) and (iii) we compare models using their joint log-likelihood. In this case, the null 2 5 The problem becomes more complicated if the smaller model lies on the boundary of the parameter space of the larger model, or if some of the parameters of the larger model are unidenti…ed under the null that the smaller model is correct. See Andrews (2001) and Andrews and Ploberger (1994) for discussion of these issues. 37 and alternative hypotheses are: H0 : E [L1t (\u0000\u0000 1) \u0000 L2t (\u0000\u0000 2)] = 0 (68) vs. H1 : E [L1t (\u0000\u0000 1) \u0000 L2t (\u0000\u0000 2)] > 0 H2 : E [L1t (\u0000\u0000 1) \u0000 L2t (\u0000\u0000 2)] < 0 where Lit (\u0000\u0000 i ) \u0000 log fit (Yt; \u0000\u0000 i ) (69) (Note that if the same marginal distributions are used for both models, then the di¤erence between the joint log-likelihoods reduces to the di¤erence between the copula likelihoods.) Rivers and Vuong (2002) show that a simple t-statistic on the di¤erence between the sample averages of the log-likelihoods has the standard Normal distribution under the null hypothesis: pT n \u0000L1T \u0000 ^\u00001T \u0000 \u0000 \u0000L2T \u0000 ^\u00002T \u0000o ^\u0000T d \u0000! N (0; 1) under H0 (70) where \u0000LiT \u0000 ^\u0000iT \u0000 \u0000 1 T TX t=1 Lit \u0000 ^\u0000iT \u0000 , i = 1; 2 and ^\u00002 T is some consistent estimator of V hpT n \u0000L1T \u0000 ^\u00001T \u0000 \u0000 \u0000L2T \u0000 ^\u00002T \u0000oi ; such as the Newey-West (1987) HAC estimator. This is a particularly nice result as it shows that we can ignore estimation error in ^\u00001T and ^\u00002T ; and do not need to compute asymptotic variances of these quantities or use simulations to get critical values. Note that the Rivers and Vuong (2002) test may be applied to both constant and time-varying conditional copula models. Rivers and Vuong (2002) show that their test can also be applied when some metric other than the joint likelihood is used for measuring goodness of …t. In this case the variance, ^\u00002 T ; needs to be adjusted to take into account the estimation error from the parameters. 4.2.2 Semiparametric, in-sample Chen and Fan (2006b) consider a similar case to Rivers and Vuong (2002), but for semiparametric copula-based models, under the assumption that the conditional copula is constant. Chen and Fan (2006b) show that when the models are “generalized non nested”26 the likelihood ratio t test 2 6 Chen and Fan (2006b) de…ne two copula models to be generalized non-nested if the set fu : c1 (u;\u0000\u0000 1) 6= c2 (u;\u0000\u0000 2)g has positive Lebesgue measure, where \u0000\u0000 i is the limiting parameter of copula model i; i.e., if the models, evaluated at their limiting parameters, di¤er somewhere in their support. 38 statistic is again Normally distributed under the null hypothesis: pT n \u0000L1T \u0000 ^\u00001T \u0000 \u0000 \u0000L2T \u0000 ^\u00002T \u0000o ^\u0000T ! N (0; 1) under H0 where ^\u00002 T = 1 T TX t=1 0 @ ~dt + nX j=1 n ^Q2j \u0000 ^Ujt; ^\u00002T \u0000 \u0000 ^Q1j \u0000 ^Ujt; ^\u00001T \u0000o 1 A 2 (71) dt \u0000 log c1 \u0000 ^Ut; ^\u00001T \u0000 \u0000 log c2 \u0000 ^Ut; ^\u00002T \u0000 ~dt = dt \u0000 \u0000dT ^Qij (u; ^\u0000iT ) \u0000 1 T TX t=1;t6=s 8 < : @ log ci \u0000 ^Ut; ^\u0000iT \u0000 @uj \u00001 n u \u0000 ^Ujto \u0000 ^Ujt\u00009 = ; (72) Note that the asymptotic variance is more complicated in one sense, as the estimation error coming from the use of the EDF must be incorporated, which is accomplished through the terms ^Q1j and ^Q2j: It is simpler in another sense, as the authors exploit the constant conditional copula assumption and avoid the need for a HAC estimator of the variance of \u0000dT : The Chen and Fan (2006b) test for comparing copula models is derived under the assumption that the conditional copula is constant, and corresponding results for the time-varying case are not available in the literature, to my knowledge. 4.2.3 Empirical illustration, continued The upper panel of Table 9 presents the results of Rivers and Vuong (2002) pair-wise comparison tests of the parametric copula-based multivariate models introduced in Section 3.4 above. These results show that the Clayton copula is signi…cantly beaten by all three other models, while the Student’s t copula signi…cantly outperforms all three other models. (The comparison of the Stu- dent’s t copula with the Normal copula is done as a one-sided t test on the signi…cance of the inverse degrees of freedom parameter, as in equation (67) above). The rotated Gumbel copula is better but not signi…cantly better than the Normal copula. The lower panel of Table 9 presents the corresponding Chen and Fan (2006b) tests for the semiparametric copula-based multivariate models, and the same conclusions are obtained. With parametric marginal distributions we can also use the Rivers and Vuong test (2002) to compare the time-varying rotated Gumbel and Student’s t copulas. The t-statistic from that test is 4.27, very strongly in favor of the time-varying Student’s copula. 39 Comparisons of time-varying and constant conditional copulas are usually complicated by the presence of a parameter that is unidenti…ed under the null hypothesis. When using the GAS model, see equation (53), a constant copula is obtained when \u0000 = 0; but this leaves \u0000 unidenti…ed. Tests to accommodate this may be obtained by combining the results of Rivers and Vuong (2002) with those of Andrews (2001) and Andrews and Ploberger (1994).27 [ INSERT TABLE 9 ABOUT HERE ] 4.2.4 Out-of-sample model comparisons We now consider out-of-sample methods for evaluating copula-based multivariate models. This is an important aspect of the evaluation of economic forecasts, see West (2006) for motivation and discussion. In this analysis, we estimate the model using an in-sample period (of length R < T ) and evaluate it on the remaining P = T \u0000 R observations (the “out-of-sample”, OOS, period). Estimation of the model as we progress through the OOS period can be done in one of three ways. First, using “recursive” or “expanding window” estimation, where the forecast for observation t is based on data in the interval [1; t \u0000 1]. Alternatively, one can estimate the model using a “rolling” window, using data only in the interval [t \u0000 R; t \u0000 1] : This method is thought to provide some robustness against structural breaks in the data generating process, but involves “throwing away” observations from the start of the in-sample period. Finally, one can use “…xed window”estimation, where the model is estimated just once, using data from [1; R] : This latter method is useful when the model is computationally intensive to estimate. Let ^\u0000t denote the parameter vector of the multivariate density obtained for a forecast of Yt using one of these three estimation methods.28 A useful way to compare multivariate (or univariate) density forecasts, is to compare their OOS log-likelihood values, see Diks, et al. (2010) for example. Averaging across the OOS period, this can be interpreted as measuring the (negative of the) Kullback-Leibler distance of the density forecast 2 7 Theoretically, the problem of an identi…ed parameter under the null only appears when comparing constant and time-varying versions of the same copula (e.g., constant and time-varying Gumbel copulas), and does not arise when comparing copulas from di¤erent families (e.g., a constant Normal and a time-varying Gumbel). However, comparisons of constant and time-varying versions of the same copula are the most natural ones to consider, and thus this problem cannot be so easily avoided. 2 8 Note that although ^\u0000t has a subscript “t”, it uses data only up until t \u0000 1 (recursive or rolling window) or until R < t (…xed window). The subscript refers to the realization of the target variable, Yt: 40 from the true, unknown, conditional density, and so a model with a higher OOS log-likelihood is interpreted as being closer to the truth.29 \u0000LOOS \u0000 1 P TX t=R+1 log ft \u0000Y1t; :::; Ynt; ^\u0000t\u0000 (73) Using the fact that a multivariate log-likelihood can be decomposed into the marginal log-likelihoods and the copula, note that the di¤erence between two multivariate log-likelihoods with the same marginal distributions is equal to the di¤erence solely between their copula log-likelihoods: log f (a) t (Y1t; :::; Ynt) \u0000 log f (b) t (Y1t; :::; Ynt) = log c(a) t (F1t (Y1t) ; :::; Fnt (Ynt)) (74) \u0000 log c(b) t (F1t (Y1t) ; :::; Fnt (Ynt)) This is particularly useful for semiparametric multivariate models using the EDF for the marginal distributions: without further assumptions that model does not provide marginal densities and so the marginal log-likelihoods are not available. The OOS evaluation of predictive models di¤ers not only according to whether the models are fully parametric or semiparametric (as we have observed in numerous instances above), but also in the treatment of the parameter estimation error in the forecasts. Giacomini and White (2006) consider OOS forecasting models that are based on an estimation window of …nite length (i.e., a …xed or rolling estimation scheme), and consider the forecast performance of two competing models conditional on their estimated parameters: H0 : E hlog c1 \u0000 ^Ut; ^\u00001t\u0000 \u0000 log c2 \u0000 ^Ut; ^\u00002t\u0000i = 0 (75) vs H1 : E hlog c1 \u0000 ^Ut; ^\u00001t\u0000 \u0000 log c2 \u0000 ^Ut; ^\u00002t\u0000i > 0 H2 : E hlog c1 \u0000 ^Ut; ^\u00001t\u0000 \u0000 log c2 \u0000 ^Ut; ^\u00002t\u0000i < 0 Importantly, the estimated parameters appear in the null, so a good model that is badly estimated will be punished. This has some particularly useful features for evaluating copula-based models: Firstly, we can compare both nested and non-nested models. In fact, we can even compare the same model estimated in two di¤erent ways (e.g., using one-stage MLE or MSMLE). Secondly, we do not need to pay special attention to whether the model is fully parametric or semiparametric. The 2 9 One could also consider weighted likelihoods, placing more emphasis on particular regions of the support, such as the tails versus the center or the left tail versus the right tail, see Amisano and Giacomini (2007) Gneiting and Ranjan (2011) and Diks, et al. (2011). 41 asymptotic framework of Giacomini and White (2006) requires no adjustments for the estimated parameters of the models being compared, and the limiting distribution of the test statistic is N (0; 1) : The only complication is that a HAC estimate of the asymptotic variance is required, as the di¤erences in log-likelihoods may be serially correlated and heteroskedastic. When the estimation window is expanding and the model is fully parametric, one can instead use the framework of West (1996). In this case the null and alternative hypotheses relate to the probability limit of the estimated parameters, denoted \u0000\u0000 1 and \u0000\u0000 2: H0 : E [log c1 (Ut; \u0000\u0000 1) \u0000 log c2 (Ut; \u0000\u0000 2)] = 0 (76) In West’s (1996) framework, the estimation error in ^\u0000t will a¤ect the asymptotic variance of the t-statistic, and he provides a consistent estimator of the extra terms that need to be estimated. He notes that this estimation error can be ignored if P=R ! 0 as P; R ! 1 (i.e., the estimation window is “large”relative to the OOS period), or if the comparison of model accuracy is done using the same loss function as used in estimation, and so if we estimate the marginals and the copula by ML (one-stage or multi-stage) and we compare models using their joint log-likelihood, then West’s test is numerically identical to the Giacomini and White (2006) test, although the tests di¤er in their statement of the null hypothesis and thus in the interpretation of the result. It is important to note that West’s (1996) approach can only be applied to non-nested models30, and only to fully parametric models; the extension to consider semiparametric multivariate density models has not been treated in the literature, to my knowledge. 4.2.5 Empirical illustration, continued We now consider out-of-sample comparisons of the various copula-based multivariate models applied to S&P 100 and S&P 600 index returns. These comparisons will be done using the joint log- likelihood, and within the parametric and semiparametric groups of models this simpli…es to a comparison of the copula log-likelihoods. In all cases we will use the Giacomini and White (2006) test, with the in-sample period being the …rst ten years of the sample period (August 17, 1995 to August 17, 2005, a total of R = 2519 observations) and the OOS period being the remainder (August 18, 2005 to May 20, 2011, yielding P = 1450 observations). To simplify the problem, 3 0 McCracken (2007) considers nested models in this framework, but only linear speci…cations, and so cannot generally be used in multivariate density forecasting applications. 42 we will consider a …xed estimation window, and only estimate the models once, using the …rst R observations. The top panel of Table 10 reports the t-statistics of pair-wise comparisons. We …nd that all but one pair-wise comparison is signi…cant, indicating good power to di¤erentiate between these models, and the best model turns out to be the Student’s t-GAS model, followed by the Rotated Gumbel-GAS model. Both of these models beat all of the constant copula models, consistent with our earlier …ndings of signi…cant evidence of time-varying dependence, and with the GoF test results discussed in Section 4.1.3. The same conclusions are found for pair-wise comparisons of semiparametric models, presented in the middle panel of Table 10. The bottom row of Table 10 presents the results of tests to compare multivariate models with the same copula but with di¤erent models for the marginal distributions, either the parametric skew t distribution, or a nonparametric estimate. As noted above, the nonparametric estimate we use is the EDF, and does not have an unique counterpart for the density, which is required for the computation of the log-likelihood. To overcome this for this test, one can use a nonparametric density estimate, such as one based on a Gaussian kernel with Silverman’s bandwidth.31 The results in Table 10 indicate that for all choices of copula model the parametric density estimate is preferred to the nonparametric estimate in terms of OOS …t (the t-statistics are all positive), however only for the time-varying copulas are these di¤erences (borderline) signi…cant, with t-statistics of 1.99 and 1.80. [ INSERT TABLE 10 ABOUT HERE ] 5 Other issues in applications In this section we will discuss two examples of estimation and computation issues that arise when applying copulas to multivariate time series. We will consider the general case that the conditional copula is time-varying, which of course nests the constant conditional copula case. Let (U1t; U2t) jFt\u00001 s C (\u0000t) (77) where \u0000t = \u0000 (Zt\u00001; \u0000\u0000) , for Zt\u00001 2 Ft\u00001 3 1 This is the default kernel density estimate using Matlab’s “pltdens.m” function. The bandwidth is 1:06^\u0000T \u00001=5, where ^\u00002 is the sample variance of the standardized residuals (which is 1.00 for both series). 43 5.1 Linear correlation in copula-based multivariate models The upper and lower tail dependence implied by many well-known copulas are known in closed form, see Table 4 for example. The tail dependence implied by the time-varying rotated Gumbel and Student’s t GAS copula models are presented in Figure 5. [ INSERT FIGURE 5 ABOUT HERE ] Corresponding formulas for rank correlation are often not available, and formulas for the more familiar linear correlation are never available, as the linear correlation depends both upon on the copula model and the marginal distribution speci…cation. While linear correlation has its drawbacks as a measure of dependence, it is still the most widely-known in economics and it is often useful to present as a summary of the linear dependence implied by a given model. Given the speci…cation for our multivariate time series model in equation (6), the conditional correlation of the two variables can be expressed as: \u0000t \u0000 Corrt\u00001 [Y1t; Y2t] = Corrt\u00001 [\"1t; \"2t] (78) = Et\u00001 [\"1t\"2t] , since \"itjFt\u00001 s Fi (0; 1) = Et\u00001 \u0000 F \u00001 1 (U1t) F \u00001 2 (U2t) \u0000 , since Uit \u0000 Fi (\"it) The last expression cannot usually be obtained analytically, however two numerical approaches are available. The …rst is to use two-dimensional numerical integration:32 Et\u00001 \u0000 F \u00001 1 (U1t) F \u00001 2 (U2t) \u0000 \u0000 Z 1 0 Z 1 0 F \u00001 1 (u1) F \u00001 2 (u2) c (u1; u2; \u0000t (\u0000)) du1du2 (79) An alternative approach is to use simulation: Et\u00001 \u0000 F \u00001 1 (U1t) F \u00001 2 (U2t) \u0000 \u0000 1 S SX s=1 F \u00001 1 \u0000u(s) 1 \u0000 F \u00001 2 \u0000u(s) 2 \u0000 (80) where \u0000u(s) 1 ; u(s) 2 \u0000 s iid C (\u0000t (\u0000)) , s = 1; 2; :::; S where S is the number of simulations (e.g., S = 1000). When the copula is time-varying, these simulations need to be done for each day in the sample, as each day will have a di¤erent value for the copula parameter. When the sample size is large this can be quite a computational burden (although the problem is parallelizable). 3 2 For example, via the built-in function “dblquad.m” in Matlab. 44 One way to reduce the number of computations across days in the sample is to exploit the fact that for many copulas the mapping from copula parameter to correlation is smooth, and so one can compute this mapping for a reduced number of values of the copula parameter (its minimum and maximum value over the sample period, and, e.g., 10 evenly-spaced values in between) and then use interpolation to obtain the correlation.33 Note that this grid must cover all time-varying parameters in the copula and the distributions of the standardized residuals. For example, if we allowed both the correlation and the degrees of freedom parameter to change in the Student’s t copula then we need a grid of, say, 10 \u0000 10 values.34 The spline approach is particularly useful when there are few varying parameters in the copula and marginal distributions; when this gets even moderately large, it may be faster to simply do the simulation for each day of the sample. Before relying on interpolation it is of course important to check that the function is indeed smooth. Figure 6 presents the interpolated mapping from the Gumbel parameter and t copula correlation parameter (the degrees of freedom parameter was held …xed at the value reported in Table 6) to the linear correlation that is obtained, using the EDF for the marginal distributions. This mapping was estimated using 10 equally spaced nodes and 100,000 simulations, and is shown to be a good approximation from a comparison with the mapping using 20 equally spaced nodes. With this mapping it is fast to get the implied linear correlation for the entire time series (3969 dates), and this is plotted in Figure 7. [ INSERT FIGURES 6 AND 7 ABOUT HERE ] 5.2 Value-at-Risk and Expected Shortfall in copula-based multivariate models Multivariate models of …nancial time series are often used in risk management, and two key measures of risk are Value-at-Risk and Expected Shortfall. (See the chapter by Komunjer in this Handbook for a review of methods for VaR forecasting.) For a portfolio return Yt; with conditional distribution 3 3 Given a …xed amount of computing time there is often a trade-o¤ between the number of nodes at which to compute the correlation, and the precision of the estimate at each node. Since the interpolation step takes the values at the nodes as the true values, it is very important to make sure that these are as accurate as possible. Thus it is usually better to have fewer nodes estimated very precisely than many nodes estimated imprecisely. 3 4 Further, if the marginal distributions of the standardized residuals were allowed to vary through time (e.g., with time-varying skewness and kurtosis) then a grid would need to cover variations in these parameters too. 45 Ft; these measures are de…ned as V aRq t \u0000 F \u00001 t (q) , for q 2 (0; 1) (81) ESq t \u0000 E [YtjFt\u00001; Yt \u0000 V aRq t ] , for q 2 (0; 1) That is, the q% VaR is the q th percentile of the conditional distribution, and the corresponding ES is the expected value of Yt conditional on it lying below its VaR. When the joint distribution of the variables of interest is elliptical (e.g., Normal or Student’s t) the distribution of any linear combination of these variables (such as a portfolio return) is known in closed form. When more ‡exible models are used for the marginal distributions and the copula the distribution of linear combinations of the variables is generally not known in closed form, and obtaining these risk measures requires a di¤erent approach. One simple means of obtaining the VaR and ES of a portfolio of variables whose distribution is modelled using a copula-based approach is via simulation. At each point in the sample, we generate S observations from the multivariate model, then form the portfolio return, and then use the empirical distribution of those simulated portfolio returns to estimate the VaR and ES measures. For values of q closer to zero or one, larger values of S are required. Figure 8 presents results for an equal-weighted portfolio with q = 0:01; and use S = 5000 simulations on each date. We can see that the VaR ranges from around -2% at the start of the sample, to -14% at the height of the …nancial crisis. Expected Shortfall ranges from around -3% and is as low as -17%. The risk estimates implied by the Rotated Gumbel model are below those from the Student’s t model on around 70% of the days, consistent with the much greater lower tail dependence implied by this copula. To better see the di¤erences in the VaR and ES estimates implied by the two copulas, Figure 9 presents the values of these measures for an equal-weighted portfolio of returns with mean zero and variance one, using the empirical distribution of the standardized residuals for the S&P 100 and S&P 600 for the marginal distributions, for rank correlation ranging from zero to 0.99. A spline is used to map rank correlation to the Gumbel and Student’s t copula parameters, analogous to that for linear correlation discussed in the previous section. To estimate the VaR and ES measures for each level of rank correlation 1 million simulations are used. This …gure yields two main insights. First, the di¤erences between the predicted VaR and ES from the various models are greatest for more extreme quantiles: the 0.1% VaR and ES measures vary more across copulas 46 than the corresponding measures at the 1% level. This is consistent with the observation that these copulas have broadly similar implications for the middle of the distribution, but can di¤er more substantially in the joint tails. Second, the di¤erences between these copulas are greatest for rank correlation around 0.3 to 0.7. This is intuitive, given that for rank correlation 1 (implying perfect positive dependence, or “comonotonicity”) these models are identical, and for rank correlation of zero both the Gumbel and Normal copulas imply independence, while not so for the Student’s t copula if \u0000 < 1: We can see from Figure 9 that all three copula models yield identical results for rank correlation equal to one, and that the rotated Gumbel and Normal copulas yield the same risk estimates when rank correlation is zero, while the Student’s t copula indicates slightly more risk (for this …gure I used the estimated degrees of freedom from the time-varying t copula, which was 15.4). Thus the range of rank correlations where there is the greatest possibility of di¤erent estimates of risk and dependence is around 0.3 to 0.7, which happens to be around the values observed for many …nancial asset returns. [INSERT FIGURES 8 AND 9 ABOUT HERE ] 6 Applications of copulas in economics and …nance In this section we review some of the many applications of copulas in economics and …nance, broadly categorized into the areas of application. 6.1 Risk management One of the …rst areas of application of copulas in economics and …nance was risk management. The focus of risk managers on Value-at-Risk (VaR), and other measures designed to estimate the probability of large losses, leads to a demand for ‡exible models of the dependence between sources of risk. See Komunjer (2011) for a recent review of VaR methods. Hull and White (1998), Cherubini and Luciano (2001), Embrechts, et al. (2002, 2003) and Embrechts and Höing (2006) study the VaR of portfolios. Rosenberg and Schuermann (2006) use copulas to consider ‘integrated’ risk management problems, where market, credit and operational risks must be considered jointly. McNeil, et al. (2005) and Alexander (2008) provide clear and detailed textbook treatments of copulas and risk management. 47 6.2 Derivative contracts Another early application of copulas was to the pricing of credit derivatives (credit default swaps and collateralized debt obligations, for example), as these contracts routinely involve multiple underlying sources of risk. Li (2000) was …rst to use copulas in a credit risk application, see also Frey and McNeil (2001), Schönbucher and Schubert (2001), Giesecke (2004) Hofert and Scherer (2011) and Du¢ e (2011) for applications to default risk. Applications of copulas in other derivatives markets include Rosenberg (2003), Bennett and Kennedy (2004), Cherubini, et al. (2004), van den Goorbergh, et al. (2005), Salmon and Schleicher (2006), Grégoire, et al. (2008), Taylor and Wang (2010), and Cherubini, et al. (2012). 6.3 Portfolio decision problems Considering portfolio decision problems in their most general form involves …nding portfolio weights that maximize the investor’s expected utility, and thus requires a predictive multivariate distribu- tion for the assets being considered. Applications of copulas in portfolio problems include Patton (2004), who considers a bivariate equity portfolio problem using time-varying copulas; Hong, et al. (2007) consider an investment decision involving eleven equity portfolios under “disappointment aversion”preferences; Christo¤ersen and Langlois (2011) consider portfolio decisions involving four common equity market factors; Garcia and Tsafack (2011) consider portfolio decisions involving stocks and bonds in two countries; and Christo¤ersen, et al. (2011) consider a time-varying copula model for 33 developed and emerging equity market indices. 6.4 Time-varying copula models The econometrics literature contains a wealth of evidence that the conditional volatility of economic time series changes through time, motivating the consideration of models that also allow the con- ditional copula to vary through time. Various models have been proposed in the literature to date. Patton (2002, 2004, 2006a), Jondeau and Rockinger (2006), Christo¤ersen, et al. (2011) and Creal, et al. (2011) consider models of time-varying copulas where the copula functional form is …xed and its parameter is allowed to vary through time as a function of lagged information, similar to the famous ARCH model for volatility, see Engle (1982) and Bollerslev (1986). “Stochastic copula” models, analogous to stochastic volatility models, see Shephard (2005), were proposed by Hafner 48 and Manner (2010) and further studied in Manner and Segers (2011). “Locally constant” copula models are considered by Giacomini, Härdle and Spokoiny (2009), Guégan and Zhang (2009), Dias and Embrechts (2010), Harvey (2010), Rémillard (2010) and Busetti and Harvey (2011). Regime switching models, as in Hamilton (1989), for the conditional copula allow the functional form of the copula to vary through time and are considered by Rodriguez (2007), Okimoto (2008), Chollete, et al. (2009), Markwat, et al. (2009), Garcia and Tsafack (2011). 6.5 Other applications There are several other noteworthy economic applications of copulas that do not neatly …t into one of the above categorizations. Breymann, et al. (2003) and Dias and Embrechts (2010) study the copulas of …nancial assets using intra-daily data sampled at di¤erent frequencies; Granger, et al. (2006) use copulas to provide a de…nition of a ‘common factor in distribution’; Bartram, et al. (2007) use a time-varying conditional copula model to study …nancial market integration between seventeen European stock market indices; Heinen and Rengifo (2007) use copulas to model multivariate time series of count data; Rodriguez (2007) uses copulas to study …nancial contagion; Dearden, et al. (2008) and Bonhomme and Robin (2009) use copulas to model the dynamics in a panel of earnings data; Lee and Long (2009) use copulas to ‡exibly model the uncorrelated residuals of a multivariate GARCH model; Patton (2009b), Dudley and Nimalendran (2011) and Kang, et al. (2010) apply copulas to study dependence between hedge funds and other assets; and Zimmer (2011) studies the how simpli…ed copula models relate to the recent U.S. housing crisis. 7 Conclusions and directions for further research Copula-based multivariate models allow the researcher to specify the models for the marginal dis- tributions separately from the dependence structure (copula) that links these distributions to form the joint distribution. This increases the ‡exibility of multivariate models that can be considered, and often reduces the computational complexity of estimating such models. This chapter reviews some of the empirical applications of copula-based methods in economics, and discusses in detail methods for estimation, inference, goodness-of-…t testing, and model selection that are useful when working with these models. Inference methods di¤er according to whether the marginal distribu- tions are modelled parametrically or nonparametrically (leading respectively to a fully parametric 49 or semiparametric multivariate model) and both cases are considered. A representative data set of two daily equity index returns is used to illustrate all of the main results. In reviewing the literature to date, an outline of the “ideal” copula model emerges. An ideal copula model can accommodate dependence of either sign (positive or negative), it can capture both symmetric and asymmetric dependence, and it allows for the possibility of non-zero tail dependence. A truly ideal copula model might also possess a fourth attribute: scalability, to higher dimensions (more on this below). Most of the copulas in use empirically, see Table 3 for example, possess at least two of these attributes, and more recent research has lead to copula models that possess all three, and sometimes scalability, such as the skew t copula of Demarta and McNeil (2004) and the factor copula of Oh and Patton (2011b). The literature on copula methods for economic and …nancial time series suggests two important directions for further research. The …rst is theoretical: methods for inference on semiparametric multivariate models with a time-varying conditional copula. These models have great empirical appeal: in many economic and …nancial applications there is su¢ cient data to reliably estimate a univariate distribution nonparametrically, and there is an abundance of evidence that the depen- dence between economic variables varies through time. Inference methods currently assume either the marginal distributions are parametric (Patton, 2006b), or the conditional copula is constant (Chen and Fan, 2006b; Rémillard, 2010). A block bootstrap method for inference for semiparamet- ric multivariate models with a time-varying conditional copula was discussed in this chapter, but its use requires formal justi…cation. An alternative approach based on a “multiplier central limit theorem”, see Rémillard and Scaillet (2009) and Ruppert (2011) for details and discussion, may prove useful. A second direction for further research is empirical: useful and feasible methods for modelling dependence in high dimensions. While bivariate and low dimension (n < 10) applications of copula- based models are still common, researchers have begun to consider higher dimension problems, up to around one hundred variables. For example, Daul et al. (2003) proposed a “grouped t” copula and show that this copula can be used in applications of up to 100 variables. Hofert and Scherer (2011) and Hering, et al. (2010) consider nested Archimedean copulas for modelling credit default swaps on 125 companies. Aas, et al. (2009) and Min and Czado (2010) consider multivariate “vine” copulas, which are constructed by sequentially applying bivariate copulas to build up a higher dimension copula, see Acar, et al. (2012) for an important critique of vine copulas. Oh and 50 Patton (2011b) propose a new class of “factor copulas”for a collection of 100 equity returns. When taking models to high dimension applications one is inevitably forced to make some simplifying assumptions, and in di¤erent applications the set of plausible simplifying assumptions will vary. Increasing the variety of models available for such applications, and investigating their usefulness, will be an active area of research for some time. References [1] Aas, K., C. Czado, A. Frigessi, and H. Bakken, 2009, Pair-copula Constructions of Multiple Dependence, Insurance: Mathematics and Economics, 44, 182-198. [2] Abegaz, F. and U.V. Naik-Nimbalkar, 2008, Modeling statistical dependence of Markov chains via copula models, Journal of Statistical Planning and Inference, 138, 1131-1146. [3] Alexander, C., 2008, Market Risk Analysis, Volume III, Wiley & Sons, London. [4] Amisano, G. and R. Giacomini, 2007, Comparing Density Forecasts via Weighted Likelihood Ratio Tests, Journal of Business & Economic Statistics, 25(2), 177-190. [5] Andersen, T.G., T. Bollerslev, P. Christo¤ersen and F.X. Diebold., 2006, Volatility and Correlation Forecasting, in Handbook of Economic Forecasting, Volume 1, G. Elliott, C.W.J. Granger and A. Timmermann eds., Elsevier, Oxford. [6] Andrews, D.W.K., 1993, Tests for Parameter Instability and Structural Change with an Unknown Change Point, Econometrica, 61, 821-856. [7] Andrews, D.W.K., 2001, Testing When a Parameter Is on the Boundary of the Maintained Hypothesis, Econometrica, 69, 2001, 683-734. [8] Andrews, D.W.K. and W. Ploberger, 2001, Optimal Tests When a Nuisance Parameter Is Present Only Under the Alternative, Econometrica, 62, 1994, 1383-1414. [9] Bartram, S.M., S.J. Taylor and Y.-H. Wang, 2007, The euro and European …nancial market dependence, Journal of Banking and Finance, 51(5), 1461-1481. [10] Beare, B.K., 2010, Copulas and temporal dependence, Econometrica, 78, 395-410. [11] Bennett, M.N. and J.E. Kennedy, 2004, Quanto Pricing with Copulas, Journal of Derivatives, 12(1), 26-45. [12] Berg, D., 2009, Copula goodness-of-…t testing: An overview and power comparison, European Journal of Finance, 15, 675-701. [13] Bollerslev, T., 1986, Generalized Autoregressive Conditional Heteroskedasticity, Journal of Econometrics, 31, 307-327. 51 [14] Bollerslev, T., 1987, A Conditionally Heteroskedastic Time Series Model for Speculative Prices and Rates of Return, Review of Economics and Statistics, 69(3), 542-547. [15] Bollerslev, T., 2010, Glossary to ARCH (GARCH), in Volatility and Time Series Economet- rics: Essays in Honor of Robert F. Engle, T. Bollerslev, J.R. Russell and M.W. Watson eds, Oxford University Press, Oxford. [16] Bonhomme, S., and J.-M. Robin, 2009, Assessing the Equalizing Force of Mobility Using Short Panels: France, 1990-2000, Review of Economic Studies, 76(1), 63-92. [17] Bontemps, C., B. Feunou and N. Meddahi, 2011, Testing Distributional Assumptions: The Multivariate Case, working paper, Toulouse School of Economics. [18] Breymann, W., A. Dias, and P. Embrechts, 2003, Dependence structures for multivariate high-frequency data in …nance, Quantitative Finance, 3, 1-16. [19] Busetti, F. and A. Harvey, 2011, When is a Copula Constant? A Test for Changing Relation- ships, Journal of Financial Econometrics, 9(1), 106-131. [20] Capéraà, P., A.-L. Fourgères, and C. Genest, 1997, A nonparametric estimation procedure for bivariate extreme value copulas, Biometrika, 84(3), 567-577. [21] Carrasco, M. and X. Chen, 2002, Mixing and moment properties of various GARCH and stochastic volatility models, Econometric Theory 18, 17-39. [22] Casella, G. and R.L. Berger, 1990, Statistical Inference, Duxbury Press, U.S.A. [23] Chan, N.-H., J. Chen, X. Chen, Y. Fan and L. Peng, 2009, Statistical Inference for Multi- variate Residual Copula of GARCH Models, Statistica Sinica, 19, 53-70. [24] Chen, Y.-T., 2011, Moment Tests for Density Forecast Evaluation in the Presence of Para- meter Estimation Uncertainty, Journal of Forecasting, 30, 409–450. [25] Chen, X., and Y. Fan, 2006a, Estimation of copula-based semiparametric time series models, Journal of Econometrics, 130, 307-335. [26] Chen, X., and Y. Fan, 2006b, Estimation and model selection of semiparametric copula-based multivariate dynamic models under copula misspeci…cation, Journal of Econometrics, 135, 125-154. [27] Chen, X., Y. Fan and V. Tsyrennikov, 2006, E¢ cient estimation of semiparametric multi- variate copula models, Journal of the American Statistical Association, 101 (475), 1228-1240. [28] Chen, X., Y. Fan, D. Pouzo and Z. Yang, 2010, Estimation and model selection of semipara- metric multivariate survival functions under general censorship, Journal of Econometrics, 157, 129-142. [29] Chen, X., W.B. Wu, and Y. Yi, 2009. E¢ cient estimation of copula-based semiparametric Markov models, Annals of Statistics, 37, 4214-4253. [30] Cherubini, U. and E. Luciano, 2001, Value at Risk trade-o¤ and capital allocation with copulas, Economic Notes, 30, 235-256. 52 [31] Cherubini, U., E. Luciano and W. Vecchiato, 2004, Copula Methods in Finance, John Wiley & Sons, England. [32] Cherubini, U., F. Gobbi, S. Mulinacci and S. Romagnoli, 2012, Dynamic Copula Methods in Finance, John Wiley & Sons, England. [33] Chollete, L., A. Heinen, and A. Valdesogo, 2009, Modeling International Financial Returns with a Multivariate Regime-switching Copula, Journal of Financial Econometrics, 7, 437-480. [34] Choros, B., R. Ibragimov and E. Permiakova, 2010, Copula estimation, in Workshop on Copula Theory and its Applications, Lecture Notes in Statistics - Proceedings, F. Durante, W. Härdle, P. Jaworski, and T. Rychlik, eds., Springer. [35] Christo¤ersen, P. and H. Langlois, 2011, The Joint Dynamics of Equity Market Factors, working paper, Rotman School of Management, University of Toronto. [36] Christo¤ersen, P., V. Errunza, K. Jacobs and H. Langlois, 2011, Is the Potential for In- ternational Diversi…cation Disappearing?, working paper, Rotman School of Management, University of Toronto. [37] Corradi, V. and N.R. Swanson, 2006, Predictive Density Evaluation, in Handbook of Eco- nomic Forecasting, G. Elliott, C.W.J. Granger and A. Timmermann, eds., North Holland, Amsterdam. [38] Creal, D., S.J. Koopman and A. Lucas, 2011, Generalized Autoregressive Score Models with Applications, Journal of Applied Econometrics, forthcoming. [39] Darsow, W. F., B. Nguyen, and E.T. Olsen, 1992, Copulas and Markov processes, Illinois Journal of Mathematics, 36, 600-642. [40] Daul, S., E. De Giorgi, F. Lindskog and A. McNeil, 2003, The grouped t-copula with an application to credit risk, RISK, 16, 73-76. [41] de Haan, L., C. Neves and L. Peng, 2008, Parametric tail copula estimation and model testing, Journal of Multivariate Analysis, 99, 1260-1275. [42] Dearden, L., E. Fitzsimons, A. Goodman and G. Kaplan, 2008, Higher Education Funding Reforms in England: The Distributional E¤ects and the Shifting Balance of Costs, Economic Journal, 118(526), 100-125. [43] Demarta, S. and A.J. McNeil, 2005, The t copula and related copulas, International Statistical Review, 73, 111-129. [44] Dias, A. and P. Embrechts, 2010, Modeling exchange rate dependence dynamics at di¤erent time horizons, Journal of International Money and Finance 29, 1687-1705. [45] Diebold, F.X., J. Hahn and A.S. Tay, 1999, Multivariate Density Forecast Evaluation and Calibration in Financial Risk Management: High Frequency Returns on Foreign Exchange, Review of Economics and Statistics, 81, 661-673. 53 [46] Diks, C., V. Panchenko, and D. van Dijk, 2010, Out-of-sample comparison of copula speci…- cations in multivariate density forecasts, Journal of Economic Dynamics and Control, 34(9), 1596-1609. [47] Diks, C., V. Panchenko, and D. van Dijk, 2011, Likelihood-based scoring rules for comparing density forecasts in tails, Journal of Econometrics, 163(2), 215-230. [48] Dudley, E. and M. Nimalendran, 2011, Margins and Hedge Fund Contagion, Journal of Financial and Quantitative Analysis, 46, 1227-1257. [49] Du¢ e, D., 2011, Measuring Corporate Default Risk, Clarendon Lectures in Finance, Oxford University Press, Oxford. [50] Embrechts, P. and A. Höing, 2006, Extreme VaR scenarios in higher dimensions, Extremes, 9, 177-192. [51] Embrechts, P., A. McNeil and D. Straumann, 2002, Correlation and Dependence Properties in Risk Management: Properties and Pitfalls, in M. Dempster, ed., Risk Management: Value at Risk and Beyond, Cambridge University Press. [52] Embrechts, P., A. Höing and A. Juri, 2003, Using Copulae to bound the Value-at-Risk for functions of dependent risks, Finance & Stochastics, 7, 145-167. [53] Engle, R.F., 1982, Autoregressive Conditional Heteroscedasticity with Estimates of the Vari- ance of UK In‡ation, Econometrica, 50, 987-1007. [54] Engle, R.F. and K.F. Kroner, 1995, Multivariate Simultaneous Generalized ARCH, Econo- metric Theory, 11(1), 122-150. [55] Fermanian, J.-D. and O. Scaillet, 2003, Nonparametric estimation of copulas for time series, Journal of Risk, 5(4), 25-54. [56] Fermanian, J.-D. and M. Wegkamp, 2012, Time dependent copulas, Journal of Multivariate Analysis, forthcoming. [57] Fermanian, J.-D., D. Radulovi´c and M. Wegkamp, 2004, Weak convergence of empirical copula processes, Bernoulli, 10(5), 847-860. [58] Frahm, G., M. Junker and R. Schmidt, 2005, Estimating the tail-dependence coe¢ cient: Properties and pitfalls, Insurance: Mathematics and Economics, 37, 80-100. [59] Frees, E.W. and E.A. Valdez, 1998, Understanding Relationships using Copulas, North Amer- ican Actuarial Journal, 2(1), 1-25. [60] Frey, R. and A.J. McNeil, 2001, Modelling dependent defaults, ETH E-Collection, http://e- collection.ethbib.ethz.ch/show?type=bericht&nr=273. [61] Gaißer, S., M. Ruppert and F. Schmid, 2010, A multivariate version of Hoe¤ding’s Phi-Square, Journal of Multivariate Analysis, 101, 2571-2586. [62] Garcia, R. and G. Tsafack, 2011, Dependence Structure and Extreme Comovements in In- ternational Equity and Bond Markets, Journal of Banking & Finance, 35(8), 1954-1970. 54 [63] Genest, C., 1987, Frank’s family of bivariate distributions, Biometrika, 74(3), 549-555. [64] Genest, C. and L.-P. Rivest, 1993, Statistical Inference Procedures for Bivariate Archimedean Copulas, Journal of the American Statistical Association, 88(423), 1034-1043. [65] Genest, C. and A.-C. Favre, 2007, Everything you always wanted to know about copula modeling but were afraid to ask, Journal of Hydrologic Engineering, 12, 347-368. [66] Genest, C., K. Ghoudi and L.-P. Rivest, 1995, A semiparametric estimation procedure of dependence parameters in multivariate families of distributions, Biometrika, 82(3), 543-552. [67] Genest, C. and B. Rémillard, 2008, Validity of the Parametric Bootstrap for Goodness-of-Fit Testing in Semiparametric Models, Annales de l’Institut Henri Poincaré, 44(6), 1096-1127. [68] Genest, C., B. Rémillard and D. Beaudoin, 2009, Omnibus Goodness-of-Fit Tests for Copulas: A Review and a Power Study, Insurance: Mathematics and Economics, 44, 199-213. [69] Ghoudi, K. and B. Rémillard, 2004, Empirical processes based on pseudo-observations II: The multivariate case, in Asymptotic Methods in Stochastics: Festschrift for Miklós Csörgö, C.M. Cuadras, J. Fortiana, and J.A. Rodríguez-Lallena, eds., Kluwer Academic, Dordrecht. [70] Giacomini, R. and H. White, 2006, Tests of Conditional Predictive Ability, Econometrica, 74(6), 1545–1578. [71] Giacomini, E., W. Härdle, and V. Spokoiny, 2009, Inhomogeneous dependence modeling with time-varying copulae, Journal of Business & Economic Statistics, 27, 224-234. [72] Giesecke, K., 2004, Correlated Default with Incomplete Information, Journal of Banking and Finance, 28, 1521-1545. [73] Glosten, L.R., R. Jagannathan, D.E. Runkle, 1993, On the Relation between the Expected Value and the Volatility of the Nominal Excess Return on Stocks, Journal of Finance, 48(5), 1779-1801. [74] Gneiting, T. and R. Ranjan, 2011, Comparing Density Forecasts using Threshold- and Quantile-Weighted Scoring Rules, Journal of Business & Economic Statistics, 29(3), 411- 422. [75] Gonçalves, S. and H. White, 2004, Maximum Likelihood and the Bootstrap for Nonlinear Dynamic Models, Journal of Econometrics, 119, 199-220. [76] Granger, C.W.J., T. Teräsvirta and A.J. Patton, 2006, Common factors in conditional dis- tributions for bivariate time series, Journal of Econometrics, 132, 43-57. [77] Grégoire, V., C. Genest and M. Gendron, 2008, Using copulas to model price dependence in energy markets, Energy Risk, 5(5), 58-64. [78] Guégan, D. and J. Zhang, 2009, Change analysis of dynamic copula for measuring dependence in multivariate …nancial data, Quantitative Finance, 10(4), 421-430. [79] Hafner, C.M. and H. Manner, 2010, Dynamic Stochastic Copula Models: Estimation, Infer- ence and Applications, Journal of Applied Econometrics, forthcoming. 55 [80] Hamilton, J.D., 1989, A New Approach to the Economic Analysis of Nonstationary Time Series and the Business Cycle, Econometrica, 57, 357-384. [81] Hansen, B.E., 1994, Autoregressive conditional density estimation, International Economic Review, 35(3), 705-730. [82] Hansen, P.R., A. Lunde and J.M. Nason, 2011, Model Con…dence Sets for Forecasting Models, Econometrica, forthcoming. [83] Harvey, A., 2010, Tracking a Changing Copula, Journal of Empirical Finance, 17, 485-500. [84] Heinen, A. and E. Rengifo, 2007, Multivariate autoregressive modeling of time series count data using copulas, Journal of Empirical Finance, 14(4), 564-583. [85] Heinen, A. and A. Valdesogo, 2009, Asymmetric CAPM dependence for large dimensions: the Canonical Vine Autoregressive Model, CORE Discussion Paper 2009-069. [86] Hering, C., M. Hofert, J.-F. Mai and M. Scherer, 2010, Constructing hierarchical Archimedean copulas with Lévy subordinators, Journal of Multivariate Analysis, 101(6), 1428-1433. [87] Hofert, M. and M. Scherer, 2011, CDO pricing with nested Archimedean copulas, Quantitative Finance, 11(5), 775–787. [88] Hong, Y., J. Tu and G. Zhou, 2007, Asymmetries in stock returns: Statistical tests and economic evaluation, Review of Financial Studies 20, 1547–1581. [89] Hu, L., 2006, Dependence patterns across …nancial markets: a mixed copula approach, Applied Financial Economics, 16(10), 717-729. [90] Hull, J. and A. White, 1998, Value at Risk when daily changes in market variables are not normally distributed, Journal of Derivatives, 5, 9-19. [91] Ibragimov, R., 2009, Copula-based characterizations for higher-order Markov processes, Econometric Theory, 25, 819-846. [92] Joe, H., 1997, Multivariate Models and Dependence Concepts, Monographs in Statistics and Probability 73, Chapman and Hall, London. [93] Joe, H., 2005, Asymptotic e¢ ciency of the two-stage estimation method for copula-based models, Journal of Multivariate Analysis, 94, 401-419. [94] Joe, H. and J.J. Xu, 1996, The Estimation Method of Inference Functions for Margins for Mul- tivariate Models, working paper, Department of Statistics, University of British Columbia. [95] Jondeau, E. and M. Rockinger, 2003, Conditional Volatility, Skewness, and Kurtosis: Ex- istence, Persistence, and Comovements, Journal of Economic Dynamics and Control, 27, 1699-1737. [96] Jondeau, E. and M. Rockinger, 2006, The copula-GARCH model of conditional dependen- cies: an international stock market application, Journal of International Money and Finance, 25(5), 827-853. 56 [97] Kang, B.U., F. In, G. Kim and Y.S. Kim, 2010, A Longer Look at the Asymmetric Dependence between Hedge Funds and the Equity Market, Journal of Financial and Quantitative Analysis, 45(3), 763-789. [98] Komunjer, I., 2011, Quantile Prediction, in Handbook of Economic Forecasting, Volume 2, G. Elliott and A. Timmermann eds., Elsevier, Oxford. [99] Lee, T.-H. and X. Long, 2009, Copula-based multivariate GARCH model with uncorrelated dependent standardized returns, Journal of Econometrics, 150(2), 207-218. [100] Li, D.X., 2000, On default correlation: a copula function approach, Journal of Fixed Income, 9, 43-54. [101] Manner, H. and O. Reznikova, 2011, A survey on time-varying copulas: Speci…cation, simu- lations and estimation, Econometric Reviews, forthcoming. [102] Manner, H. and J. Segers, 2011, Tails of correlation mixtures of elliptical copulas, Insurance: Mathematics and Economics, 48(1), 153-160. [103] Markwat, T.D., E. Kole and D.J.C. van Dijk, 2009, Time Variation in Asset Return Depen- dence: Strength or Structure?, working paper, Econometric Institute, Erasmus University Rotterdam. [104] McCracken, M.W., 2007, Asymptotics for Out of Sample Tests of Granger Causality, Journal of Econometrics, 140, 719-752. [105] McNeil, A.J., R. Frey and P. Embrechts, 2005, Quantitative Risk Management: Concepts, Techniques and Tools, Princeton University Press, New Jersey. [106] Meitz, M. and P. Saikkonen, 2008, Ergodicity, mixing, and the existence of moments of a class of Markov models with applications to GARCH and ACD models, Econometric Theory, 24, 1291-1320. [107] Min, A. and C. Czado, 2010, Bayesian inference for multivariate copulas using pair-copula constructions, Journal of Financial Econometrics, 8(4), 450-480. [108] Nelsen, R.B., 2006, An Introduction to Copulas, Second Edition, Springer, U.S.A. [109] Oh, D.-H. and A.J. Patton, 2011a, Simulated Method of Moments Estimation for Copula- Based Multivariate Models, working paper, Duke University. [110] Oh, D.-H. and A.J. Patton, 2011b, Modelling Dependence in High Dimensions with Factor Copulas, working paper, Duke University. [111] Okimoto, T., 2008, New evidence of asymmetric dependence structure in international equity markets, Journal of Financial and Quantitative Analysis, 43, 787–815. [112] Patton, A.J., 2002, Applications of Copula Theory in Financial Econometrics, Unpublished Ph.D. dissertation, University of California, San Diego. [113] Patton, A.J., 2004, On the Out-of-Sample Importance of Skewness and Asymmetric Depen- dence for Asset Allocation, Journal of Financial Econometrics, 2(1), 130-168. 57 [114] Patton, A.J., 2006a, Modelling Asymmetric Exchange Rate Dependence, International Eco- nomic Review, 47(2), 527-556. [115] Patton, A.J., 2006b, Estimation of Multivariate Models for Time Series of Possibly Di¤erent Lengths, Journal of Applied Econometrics, 21(2), 147-173. [116] Patton, A.J., 2009a, Copula-based models for …nancial time series, in T.G. Andersen, R.A. Davis, J.-P. Kreiss and T. Mikosch (eds.) Handbook of Financial Time Series, Springer Verlag. [117] Patton, A.J., 2009b, Are \"Market Neutral\" Hedge Funds Really Market Neutral?, Review of Financial Studies, 22(7), 2495-2530. [118] Patton, A.J., 2012, A Review of Copula Models for Economic Time Series, Journal of Mul- tivariate Analysis, forthcoming. [119] Pickands, J., 1981, Multivariate Extreme Value Distributions, Bulletin de l’Institut Interna- tional de Statistique, 859-878. [120] Politis, D.N. and J.P. Romano, 1994, The Stationary Bootstrap, Journal of the American Statistical Association, 89, 1303-1313. [121] Rémillard, B., 2010, Goodness-of-…t tests for copulas of multivariate time series, working paper, HEC Montreal. [122] Rémillard, B. and O. Scaillet, 2009, Testing for Equality Between Two Copulas, Journal of Multivariate Analysis, 100(3), 377-386. [123] Rémillard, B., N. Papageorgiou and F. Soustra, 2012, Copula-based semiparametric models for multivariate time series, Journal of Multivariate Analysis, forthcoming. [124] Rivers, D. and Q. Vuong, 2002, Model Selection Tests for Nonlinear Dynamic Models, The Econometrics Journal, 5(1), 1-39. [125] Rodriguez, J.C., 2007, Measuring …nancial contagion: a copula approach, Journal of Empirical Finance, 14(3), 401-423. [126] Romano, J.P. and M. Wolf, 2005. Stepwise Multiple Testing as Formalized Data Snooping. Econometrica 73, 1237-1282. [127] Rosenberg, J.V., 2003, Nonparametric pricing of multivariate contingent claims, Journal of Derivatives, 10, 9-26. [128] Rosenberg, J.V. and T. Schuermann, 2006, A general approach to integrated risk management with skewed, fat-tailed risks, Journal of Financial Economics, 79, 569-614. [129] Ruppert, M., 2011, Consistent testing for a constant copula under strong mixing based on the tapered block multiplier technique, working paper, Department of Economic and Social Statistics, University of Cologne. [130] Salmon, M. and C. Schleicher, 2006, Pricing Multivariate Currency Options with Copulas, in J. Rank, ed., Copulas: From Theory to Application in Finance, Risk Books, London. 58 [131] Sancetta, A. and S. Satchell, 2004, The Bernstein copula and its applications to modeling and approximations of multivariate distributions, Econometric Theory, 20, 2004, 535–562 [132] Schönbucher, P. and D. Schubert, 2001, Copula Dependent Default Risk in Intensity Models, mimeo, Bonn University. [133] Shephard, N., 2005, Stochastic Volatility: Selected Readings, Oxford University Press, Oxford. [134] Sklar, A., 1959, Fonctions de répartition à n dimensions et leurs marges, Publications de l’ Institut Statistique de l’Universite´ de Paris, 8, 229-231. [135] Smith, M., A. Min, C. Almeida, and C. Czado, 2010a, Modeling longitudinal data using a pair- copula decomposition of serial dependence, Journal of the American Statistical Association, 105 (492), 1467-1479. [136] Smith M., Q. Gan, and R. Kohn, 2010b, Modeling Dependence Using Skew t Copulas: Bayesian Inference and Applications, Journal of Applied Econometrics, forthcoming. [137] Smith, M.S., 2011, Bayesian Approaches to Copula Modelling, in Hierarchical Models and MCMC: A Tribute to Adrian Smith, forthcoming. [138] Taylor, S.J., and Y. Wang, 2010, Option prices and risk-neutral densities for currency cross- rates, Journal of Futures Markets 30, 324-360. [139] Teräsvirta, T., 2006, Forecasting Economic Variables with Nonlinear Models, in Handbook of Economic Forecasting, Volume 1, G. Elliott, C.W.J. Granger and A. Timmermann eds., Elsevier, Oxford. [140] Tsukahara, H., 2005, Semiparametric estimation in copula models, Canadian Journal of Statistics, 33(3), 357-375. [141] van den Goorbergh, R.W.J., C. Genest and B.J.M. Werker, 2005, Multivariate Option Pricing Using Dynamic Copula Models, Insurance: Mathematics and Economics, 37, 101-114. [142] West, K. D., 1996, Asymptotic Inference About Predictive Ability, Econometrica, 64(5), 1067-1084. [143] West, K. D., 2006, Forecast Evaluation, in Handbook of Economic Forecasting, Volume 1, G. Elliott, C.W.J. Granger and A. Timmermann eds., Elsevier, Oxford. [144] White, H., 1994, Estimation, Inference and Speci…cation Analysis, Econometric Society Monographs No. 22, Cambridge University Press, Cambridge, U.K. [145] White, H., 2000, A Reality Check for Data Snooping, Econometrica 68, 1097-1126. [146] White, H., 2006, Approximate Nonlinear Forecasting Methods, in Handbook of Economic Forecasting, Volume 1, G. Elliott, C.W.J. Granger and A. Timmermann eds., Elsevier, Ox- ford. [147] Zimmer, D., 2011, The Role of Copulas in the Housing Crisis, Review of Economics and Statistics, forthcoming. 59 Table 1: Summary statistics and marginal distribution parameter estimates S&P 100 S&P 600 Summary statistics Mean 0.020 0.033 Std dev 1.297 1.426 Skewness -0.151 -0.302 Kurtosis 10.021 7.962 Correl (lin/rnk) 0.837 / 0.782 Conditional mean \u00000 0.023 0.033 \u00001 -0.078 – \u00002 -0.067 – Conditional variance ! 0.017 0.029 \u0000 0.001 0.017 \u0000 0.134 0.149 \u0000 0.919 0.892 Skew t density \u0000 -0.145 -0.140 \u0000 9.936 19.808 GoF tests KS p-value 0.124 0.093 CvM p-value 0.479 0.222 Notes: This table presents summary statistics and other results for daily returns on the S&P 100 and S&P 600 indices over the period August 1995 to May 2011. The top panel presents summary statistics, including linear and rank correlations; the second panel presents parameter estimates from AR(2) and AR(0) models for the conditional mean; the third panel presents pa- rameter estimates from GJR-GARCH(1,1) models for the conditional variance; the fourth panel presents parameter estimates from skew t models for the distribution of the standardized residuals; the bottom panel presents simulation-based p-values from two Kolmogorov-Smirnov and Cramer- von Mises goodness-of-…t tests for the models of the conditional marginal distributions, using 1000 simulations. 60 Table 2: Testing for time-varying dependence Break AR(p) 0:15 0:50 0:85 Anywhere 1 5 10 p-val 0.667 0.373 0.045 0.269 0.417 0.054 0.020 Notes: This table presents p-values from tests for time varying rank correlation between the standardized residuals of the S&P 100 and S&P 600 indices, based on 1000 bootstrap simulations. The left panel considers tests that allow for a one-time break in rank correlation. The right panel considers tests for autocorrelation in UitUjt: 61Table3:SomecommoncopulamodelsParameterPos&NegRankLowerUpperParameter(s)spaceIndepdep?correlationKendall’s\u0000taildeptaildepNormal\u0000(\u00001;1)0Yes6\u0000arcsin\u000022\u0000arcsin\u000000Clayton\u0000(0;1)0Noyn:a:\u0000\u0000+22\u00001=\u00000RotatedClayton\u0000(0;1)0Noyn:a:\u0000\u0000+202\u00001=\u0000Plackett\u0000(0;1)1Yes\u00002\u00002\u0000log\u0000\u00001(\u0000\u00001)2n:a:00Frank\u0000(\u00001;1)0Yesg\u0000(\u0000)g\u0000(\u0000)00Gumbel\u0000(1;1)1Non:a:\u0000\u00001\u000002\u000021=\u0000RotatedGumbel\u0000(1;1)1Non:a:\u0000\u00001\u00002\u000021=\u00000SymJoe-Clayton\u0000L;\u0000U[0;1)\u0000[0;1)(0;0)Non:a:n:a:\u0000L\u0000UStudent’st\u0000;\u0000(\u00001;1)\u0000(2;1)(0;1)Yesn:a:2\u0000arcsin(\u0000)gT(\u0000;\u0000)gT(\u0000;\u0000)Notes:Thistablepresentssomecommonparametriccopulamodels,alongwiththeirparameterspaces,andanalyticalformsforsomecommonmeasuresofdependence,ifavailable..FormoredetailsonthesecopulasseeJoe(1997,Chapter5)orNelsen(2006,Chapters4-5).Measuresthatarenotavailableinclosedformaredenoted“n:a:”.Parametervaluesthatleadtotheindependencecopulaaregiveninthecolumntitled“Indep”.Frankcopularankcorrelation:g\u0000(\u0000)=1\u000012(D1(\u0000)\u0000D2(\u0000))=\u0000andFrankcopulaKendall’stau:g\u0000(\u0000)=1\u00004(1\u0000D1(\u0000))=\u0000;whereDk(x)=kx\u0000kRx0tk\u0000et\u00001\u0000\u00001dtisthe“Debye”function,seeNelsen(2006).Student’stcopulaloweranduppertaildependence:gT(\u0000;\u0000)=2\u0000FStudt\u0000\u0000q(\u0000+1)\u0000\u00001\u0000+1;\u0000+1\u0000;seeDemartaandMcNeil(2005).yTheClayton(androtatedClayton)copulaallowsfornegativedependencefor\u00002(\u00001;0);howevertheformofthisdependenceisdi¤erentfromthepositivedependencecase(\u0000>0);andisnotgenerallyusedinempiricalwork. 62 Table 4: Estimates of tail dependence Nonparametric Parametric “log” “sec” Gumbel Student’s t Lower tail dependence: ^\u0000L Estimate 0.411 0.414 0.390 0.266 90% CI [0:112; 0:664] [0:105; 0:658] [0:321; 457] [0:221; 0:349] Upper tail dependence: ^\u0000U Estimate 0.230 0.233 0.270 0.149 90% CI [0:021; 0:537] [0:021; 0:549] [0:185; 0:354] [0:081; 0:170] pval for \u0000L = \u0000U 0.850 0.842 0.411 0.245 Notes: This table presents four estimates of the lower and upper tail dependence coe¢ cients for the standardized residuals of the S&P 100 and S&P 600 indices. 90% con…dence intervals based on 1000 bootstrap replications are also presented. The bottom row presents bootstrap p-values from tests that the upper and lower tail dependence coe¢ cients are equal. Table 5: Constant copula model parameter estimates Parametric Semiparametric Est. Param. log L Est. Param. log L Normal 0.7959 1991.8 0.7943 1978.3 Clayton 2.0279 1720.5 2.0316 1723.1 Rotated Clayton 1.6914 1414.5 1.6698 1396.2 Plackett 18.8405 1976.2 18.7224 1964.8 Frank 7.8969 1904.1 7.8019 1882.0 Gumbel 2.2637 1826.5 2.2480 1803.4 Rotated Gumbel 2.3715 2013.6 2.3673 2008.4 Sym Joe-Clayton \u0000\u0000 L; \u0000 U \u0000 0:6639 ; 0:5378 1980.8 0:6649 ; 0:5318 1967.8 Student’s t \u0000\u0000; \u0000\u00001\u0000 0:8019 ; 0:1455 2057.4 0:8005 ; 0:1428 2041.9 Notes: This panel presents the estimated parameters of nine di¤erent models for the copula of the standardized residuals of the S&P 100 and S&P 600 indices. The value of the copula log- likelihood at the optimum is also presented, and the best three models are in bold. The left panel presents results when the marginal distributions are modelled using a skew t distribution; the right panel presents results when the marginal distributions are estimated using the empirical distribution function. 63 Table 6: Standard errors on estimated constant copula parameters Parametric Semiparametric Naïve MSML Boot Sim Naïve MSML Boot Sim Normal ^\u0000 0.7959 0.7943 s.e. 0.0046 0.0108 0.0099 0.0062 0.0046 0.0061 0.0065 0.0055 log L 1991.8 1978.3 Clayton ^\u0000 2.0279 2.0316 s.e. 0.0451 0.0961 0.0862 0.0664 0.0449 0.0545 0.0580 0.0701 log L 1720.5 1723.1 Rotated ^\u0000 2.3715 2.3673 Gumbel s.e. 0.0310 0.0610 0.0595 0.0386 0.0309 0.0421 0.0344 0.0420 log L 2013.6 2008.4 Student’s t ^\u0000 0.8019 0.8005 s.e. 0.0053 0.0101 0.0096 0.0070 0.0053 0.0055 0.0054 0.0067 ^\u0000\u00001 0.1455 0.1428 s.e. 0.0172 0.0206 0.0222 0.0186 0.0172 0.0182 0.0169 0.0203 log L 2057.4 2041.9 Note: This table presents the estimated parameters of four di¤erent copula models for the standardized residuals for the S&P 100 and the S&P 600 indices, when the marginal distributions are estimated using a skewed t distribution (left panel) or the empirical distribution function (right panel). For the parametric model four di¤erent estimators of the standard error on the estimated parameter are presented, and for the semiparametric model three di¤erent standard errors are presented. For all models the log-likelihood at the estimated parameter is also presented. 64 Table 7: Standard errors on estimated time-varying copula parameters Parametric Semiparametric Naïve MSML Boot Sim Naïve Boot Rotated ^! 0.0013 0.0015 Gumbel 0.0012 0.0051 0.0249 0.0013 0.0011 0.0075 GAS ^\u0000 0.0404 0.0420 0.0124 0.0298 0.0248 0.0076 0.0110 0.0191 ^\u0000 0.9961 0.9955 0.0028 0.0096 0.0655 0.0026 0.0029 0.0201 log L 2127.3 2117.3 Student’s t ^! 0.0199 0.0192 GAS 0.0012 0.0142 0.1075 0.0090 0.0093 0.0440 ^\u0000 0.0653 0.0603 0.0091 0.0166 0.0244 0.0100 0.0296 0.0185 ^\u0000 0.9912 0.9913 1.9\u000010\u00006 0.0119 0.0475 0.0038 0.0284 0.0190 ^\u0000\u00001 0.0887 0.0891 0.0133 0.0415 0.0240 0.0174 0.0515 0.0185 log L 2203.6 2184.6 Note: This table presents the estimated parameters of two di¤erent time-varying copula mod- els for the standardized residuals for the S&P 100 and the S&P 600 indices, when the marginal distributions are estimated using a skewed t distribution (left panel) or the empirical distribution function (right panel). For the parametric model four di¤erent estimators of the standard error on the estimated parameter are presented, and for the semiparametric model two di¤erent standard errors are presented. For all models the log-likelihood at the estimated parameter is also presented. 65 Table 8: Goodness of …t tests for copula models Naïve Simulation KS C CvM C KS R CvM R KS C CvM C KS R CvM R Parametric Normal 0.30 0.26 0.00 0.00 0.10 0.09 0.00 0.00 Clayton 0.00 0.00 0.00 0.06 0.00 0.00 0.00 0.01 Rot. Gumbel 0.42 0.32 0.18 0.15 0.09 0.02 0.09 0.06 Student’s t 0.47 0.39 0.09 0.13 0.35 0.13 0.04 0.07 Rot. Gumbel-GAS – – 0.11 0.18 – – 0.99 1.00 Student’s t-GAS – – 0.07 0.07 – – 0.08 0.08 Semiparametric Normal 0.43 0.48 0.04 0.00 0.00 0.00 0.00 0.00 Clayton 0.00 0.00 0.08 0.014 0.00 0.00 0.00 0.01 Rot. Gumbel 0.43 0.53 0.61 0.41 0.00 0.00 0.02 0.00 Student’s t 0.65 0.74 0.40 0.13 0.00 0.00 0.02 0.00 Rot. Gumbel-GAS – – 0.78 0.27 – – 1.00 1.00 Student’s t-GAS – – 0.47 0.08 – – 0.03 0.00 Note: This table presents the p-values from various tests of goodness-of-…t for four di¤erent copula models for the standardized residuals for the S&P 100 index and the S&P 600 index, when the marginal distributions are estimated parametrically (top panel) or nonparametrically (lower panel). KS and CvM refer to the Kolmogorov-Smirnov and Cramer-von Mises tests respectively. The subscripts C and R refer to whether the test was applied to the empirical copula of the standardized residuals, or to the empirical copula of the Rosenblatt transform of these residuals. The p-values are based on 100 simulations. The left panel presents p-values that (incorrectly) ignore parameter estimation error, the right panel present results that take this estimation error into account. p-values less than 0.05 are in bold. 66 Table 9: In-sample model comparisons for constant copula models Normal Clayton Rot Gumbel Student’s t Parametric Normal – Clayton -7.2355 – Rot. Gumbel 0.9303 15.588 – Student’s t 7.0585y 9.9977 2.5759 – log L 1991.8 1720.5 2013.6 2057.4 Rank 3 4 2 1 Semiparametric Normal – Clayton -6.2724 – Rot. Gumbel 1.1584 16.319 – Student’s t 7.8462y 8.7999 1.6694 – log L 1978.3 1723.1 2008.4 2041.9 Rank 3 4 2 1 Note: This table presents t-statistics from Rivers and Vuong (2002) (upper panel) and Chen and Fan (2006b) model comparison tests for four constant copula models. A positive value indicates that the model to the left is better than the model above, and a negative value indicates the opposite. The average value of the log-likelihood for each model is also presented. yThe Student’s t copula nests the Normal copula, and so a standard t-test can be used to compare these models. t-statistics that are greater than 1.96 are in bold, and those less than -1.96 are in italics. 67 Table 10: Out-of-sample model comparisons Normal Clayton RGum Stud t RGum-GAS Stud t-GAS Parametric Normal – Clayton -10.05 – RGum 0.96 18.81 – Stud t 9.39 12.67 3.87 – RGum GAS 5.94 15.81 8.57 4.43 – Stud-t GAS 9.89 14.74 10.35 9.46 4.99 – log LOOS C 914.8 770.91 923.39 952.69 1017.16 1069.15 Rank 5 6 4 3 2 1 Semiparametric Normal – Clayton -9.90 – RGum 0.71 18.36 – Stud t 9.34 12.39 3.71 – RGum GAS 5.47 15.79 8.29 3.99 – Stud-t GAS 9.85 14.99 10.55 9.43 5.15 – log LOOS C 912.74 765.90 919.30 948.33 1007.64 1062.07 Rank 5 6 4 3 2 1 Parametric vs Nonparametric margins t-stat 0.91 1.35 1.23 1.39 1.99 1.80 Note: This table presents t-statistics from out-of-sample pair-wise comparisons of the log- likelihood values for four constant copula models and two time-varying copula models, with fully parametric or semiparametric marginal distribution models. A positive value indicates that the model to the left is better than the model above, and a negative value indicates the opposite. The out-of-sample value of the log-likelihood for each model is also presented. The bottom row of the table presents t-statistics from pair-wise comparisons of bivariate density models with the same copula speci…cation but with either nonparametric or skew t marginal distributions, and a positive value indicates that the model with skew t marginal distributions is preferred. t-statistics that are greater than 1.96 are in bold, and those less than -1.96 are in italics. 68 Aug95 Jan97 Jan99 Jan01 Jan03 Jan05 Jan07 Jan09 Jan11 50 100 150 200 250 300 350 400 Prices of S&P 100 and S&P 600 indices S&P 100 S&P 600 -10 -5 0 5 10 -10 -5 0 5 10 S&P 100 returnS&P 600 return Daily returns on S&P 100 and S&P 600 Figure 1: The upper panel of this …gure shows the level of the S&P100 and S&P 600 indices over the period August 1995 to May 2011, normalized to 100 at the start of the sample period. The lower panel shows a scatter plot of daily returns on these indices. 69 -6 -4 -2 0 2 4 6 0 0.1 0.2 0.3 0.4 0.5 S&P 100 xf(x) -6 -4 -2 0 2 4 6 0 0.1 0.2 0.3 0.4 0.5 S&P 600 xf(x) -6 -4 -2 0 2 4 -6 -4 -2 0 2 4 Model quantileEmpirical quantile -6 -4 -2 0 2 4 -6 -4 -2 0 2 4 Model quantileEmpirical quantile Data Fitted skew t Figure 2: The upper panels of this …gure present the …tted skew t density for the S&P100 and S&P 600 standardized residuals, along with histograms of these residuals; the lower panels present QQ plots. 70 0 0.2 0.4 0.6 0.8 1 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 quantile (q)Quantile dep Quantile dependence for SP100 and SP600 std resids 0 0.1 0.2 0.3 0.4 0.5 -0.6 -0.5 -0.4 -0.3 -0.2 -0.1 0 0.1 0.2 0.3 Difference in upper and lower quantile dependenceUpper minus lower quantile (q) quantile dep 90% CI Figure 3: The upper panel shows the estimated quantile dependence between the standardized resid- uals for the S&P 100 index and the S&P 600 index, and the upper and lower tail dependence coe¢ cients estimated using a Gumbel tail copula, along with 90% bootstrap con…dence intervals. The lower panel presents the di¤ erence between corresponding upper and lower quantile and tail dependence estimates, along with a 90% bootstrap con…dence interval for this di¤ erence. 71 Figure 4: This …gure shows the rank correlation between the standardized residuals for the S&P 100 index and the S&P 600 index over a 60-day moving window, along with 90% bootstrap con…dence intervals. Aug95 Jan97 Jan99 Jan01 Jan03 Jan05 Jan07 Jan09 Jan11 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 Tail dependence from time-varying copula models RotGumbel lower tail Stud t upper and lower tail Figure 5: Conditional tail dependence from the time-varying rotated Gumbel and Student’s t copula models. 72 1.5 2 2.5 3 3.5 4 0.5 0.6 0.7 0.8 0.9 1 Linear correlation from Gumbel copula model Gumbel copula parameterLinear correlation 0.5 0.55 0.6 0.65 0.7 0.75 0.8 0.85 0.9 0.95 0.4 0.5 0.6 0.7 0.8 0.9 1 t copula correlation parameterLinear correlation Linear correlation from Student's t copula model Interpolated using 10 nodes Values from 20 nodes Figure 6: Spline for linear correlation implied by Gumbel and Student’s t copula models, when combined with the empirical distributions of the standardized residuals of the S&P 100 and S&P 600 indices, compared with actual values at 20 points. 73 Aug95 Jan97 Jan99 Jan01 Jan03 Jan05 Jan07 Jan09 Jan11 0.5 0.55 0.6 0.65 0.7 0.75 0.8 0.85 0.9 0.95 Linear correlation from time-varying copula models RotGumbel Stud t Figure 7: Conditional correlation from the time-varying rotated Gumbel and Student’s t copula models. 74 Aug95 Jan97 Jan99 Jan01 Jan03 Jan05 Jan07 Jan09 Jan11 -15 -10 -5 0 Portfolio Value-at-Risk from time-varying copula models, q=0.01 RotGumbel Stud t Aug95 Jan97 Jan99 Jan01 Jan03 Jan05 Jan07 Jan09 Jan11 -18 -16 -14 -12 -10 -8 -6 -4 -2 0 Portfolio Expected Shortfall from time-varying copula models, q=0.01 RotGumbel Stud t Figure 8: Conditional 1% Value-at-Risk (upper panel) and Expected Shortfall (lower panel) for an equal-weighted portfolio, based on the time-varying rotated Gumbel and Student’s t copula models. 75 0 0.2 0.4 0.6 0.8 1 -4 -3.5 -3 -2.5 -2 Portfolio Value-at-Risk, q=0.01 Rank correlation 0 0.2 0.4 0.6 0.8 1 -4 -3.5 -3 -2.5 -2 Portfolio Value-at-Risk, q=0.001 Rank correlation 0 0.2 0.4 0.6 0.8 1 -5 -4.5 -4 -3.5 -3 -2.5 Portfolio Expected Shortfall, q=0.01 Rank correlation 0 0.2 0.4 0.6 0.8 1 -5 -4.5 -4 -3.5 -3 -2.5 Portfolio Expected Shortfall, q=0.001 Rank correlation Normal Stud t RotGumbel Figure 9: Value-at-Risk (upper panels) and Expected Shortfall (lower panels), at the 1% (left panels) and 0.1% (right panels) con…dence level, for an equal-weighted portfolio of two returns, with joint distribution formed from the empirical distributions of the standardized residuals of the S&P 100 and S&P 600 indices and combined with three di¤ erent copulas. The rank correlation implied by these copulas is set to vary from zero to one. 76","libVersion":"0.3.2","langs":""}