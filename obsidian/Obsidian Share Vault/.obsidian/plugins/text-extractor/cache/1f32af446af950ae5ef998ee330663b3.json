{"path":"lit/sources/MacKay92BayesianInterpolation.pdf","text":"Communicated by David Haussler Bayesian Interpolation David J. C. MacKay’ Computation and Neural Systems, California Institute of Technology 139-74, Pasadena, CA 91225 USA Although Bayesian analysis has been in use since Laplace, the Bayesian method of model-comparison has only recently been developed in depth. In this paper, the Bayesian approach to regularization and model-comparison is demonstrated by studying the inference prob- lem of interpolating noisy data. The concepts and methods described are quite general and can be applied to many other data modeling problems. Regularizing constants are set by examining their posterior probability distribution. Alternative regularizers (priors) and alterna- tive basis sets are objectively compared by evaluating the evidence for them. ”Occam’s razor” is automatically embodied by this process. The way in which Bayes infers the values of regularizing constants and noise levels has an elegant interpretation in terms of the effective num- ber of parameters determined by the data set. This framework is due to Gull and Skilling. 1 Data Modeling and Occam’s Razor In science, a central task is to develop and compare models to account for the data that are gathered. In particular this is true in the problems of learning, pattern classification, interpolation and clustering. Two levels of inference are involved in the task of data modeling (Fig. 1). At the first level of inference, we assume that one of the models that we invented is true, and we fit that model to the data. Typically a model includes some free parameters; fitting the model to the data involves inferring what values those parameters should probably take, given the data. The results of this inference are often summarized by the most probable parameter values and error bars on those parameters. This is repeated for each model. The second level of inference is the task of model comparison. Here, we wish to compare the models in the light of the data, and assign some sort of preference or ranking to the alternatives.’ *Present address: Darwin College, Cambridge CB3 9EU, U.K. ’Note that both levels of inference are distinct from decision theory. The goal of infer- ence is, given a defined hypothesis space and a particular data set, to assign probabilities to hypotheses. Decision theory typically chooses between alternative actions on the ba- sis of these probabilities so as to minimize the expectation of a “loss function.” This paper concerns inference alone and no loss functions or utilities are involved. Neural Computation 4, 415-447 (1992) @ 1992 Massachusetts Institute of Technology 416 David J. C. MacKay For example, consider the task of interpolating a noisy data set. The data set could be interpolated using a splines model, using radial basis functions, using polynomials, or using feedforward neural networks. At the first level of inference, we take each model individually and find the best fit interpolant for that model. At the second level of inference we want to rank the alternative models and state for our particular data set that, for example, ”splines are probably the best interpolation model,” or “if the interpolant is modeled as a polynomial, it should probably be a cubic.” Bayesian methods are able consistently and quantitatively to solve both these inference tasks. There is a popular myth that states that Bayesian methods differ from orthodox (also known as “frequentist” or “sampling theory”) statistical methods only by the inclusion of subjective priors that are arbitrary and difficult to assign, and usually do not make much difference to the conclusions. It is true that at the first level of inference, a Bayesian’s results will often differ little from the outcome of an orthodox attack. What is not widely appreciated is how Bayes per- forms the second level of inference. It is here that Bayesian methods are totally different from orthodox methods. Indeed, when regression and density estimation are discussed in most statistics texts, the task of model comparison is virtually ignored; no general orthodox method exists for solving this problem. Model comparison is a difficult task because it is not possible simply to choose the model that fits the data best: more complex models can al- ways fit the data better, so the maximum likelihood model choice would lead us inevitably to implausible overparameterized models that general- ize poorly. “Occam’s razor” is the principle that states that unnecessarily complex models should not be preferred to simpler ones. Bayesian meth- ods automatically and quantitatively embody Occam’s razor (Gull 1988; Jeffreys 19391, without the introduction of ad hoc penalty terms. Com- plex models are automatically self-penalizing under Bayes’ rule. Figure 2 gives the basic intuition for why this should be expected; the rest of this paper will explore this property in depth. Bayesian methods were first laid out in depth by the Cambridge geo- physicist Sir Harold Jeffreys (1939). The logical basis for the Bayesian use of probabilities as measures of plausibility was subsequently estab- lished by Cox (1964), who proved that consistent inference in a closed hypothesis space can be mapped onto probabilities. For a general review of Bayesian philosophy the reader is encouraged to read the excellent papers by Jaynes (1986) and Loredo (1989). Since Jeffreys the emphasis of most Bayesian probability theory has been “to formally utilize prior information” (Berger 19851, that is, to perform inference in a way that makes explicit the prior knowledge and ignorance that we have, which orthodox methods omit. However, Jeffreys‘ work also laid the foundation for Bayesian model comparison, which does not involve an emphasis on prior information, but rather emphasizes getting maximal informa tion Bayesian Interpolation 417 to create new Figure 1: Where Bayesian inference fits into the data modeling process. This figure illustrates an abstraction of the part of the scientific process, in which data are collected and modeled. In particular, this figure applies to pattern classification, learning, interpolation, etc. The two double-framed boxes denote the two steps that involve inference. It is only in those two steps that Bayes’ rule can be used. Bayes does not tell you how to invent models, for example. The first box, ”fitting each model to the data,” is the task of inferring what the model parameters might be given the model and the data. Bayes may be used to find the most probable parameter values, and error bars on those parameters. The result of applying Bayes to this problem is often little different from the result of using orthodox statistics. The second inference task, model comparison in the light of the data, is where Bayes is in a class of its own. This second inference problem requires a quantitative Occam’s razor to penalize over-complex models. Bayes can assign objective preferences to the alternative models in a way that automatically embodies Occam’s razor. from the data. Jeffreys applied this theory to simple model comparison problems in geophysics, for example, testing whether a single additional parameter is justified by the data. Since the 1960s, Jeffreys’ model com- parison methods have been applied and extended in the economics litera- ture (Zellner 1984), and by a small number of statisticians (Box and Tiao 1973). Only recently has this aspect of Bayesian analysis been further developed and applied to more complex problems in other fields. 418 David J. C. MacKay Figure 2: Why Bayes embodies Occam’s razor. This figure gives the basic intuition for why complex models are penalized. The horizontal axis represents the space of possible data sets D. Bayes rule rewards models in proportion to how much they predicted the data that occurred. These predictions are quantified by a normalized probability distribution on D. In this paper, this probability of the data given model 3-1;, P(D I ‘Hi), is called the evidence for Hi. A simple model XI makes only a limited range of predictions, shown by P(D 1 3-11); a more powerful model ‘H2, that has, for example, more free parameters than 3-11, is able to predict a greater variety of data sets. This means however that 3-12 does not predict the data sets in region C1 as strongly as 3-11. Assume that equal prior probabilities have been assigned to the two models. Then if the data set falls in region C1, the less powerful model 3-11 will be the more probable model. This paper will review Bayesian model comparison, “regularization,” and noise estimation, by studying the problem of interpolating noisy data. The Bayesian framework I will describe for these tasks is due to Gull (1988, 1989a), Gull and Skilling (1991), and Skilling (1991), who have used Bayesian methods to achieve the state of the art in image reconstruction. The same approach to regularization has also been de- veloped in part by Szeliski (1989). Bayesian model comparison is also discussed by Bretthorst (19901, who has used Bayesian methods to push back the limits of NMR signal detection. The same Bayesian theory un- derlies the unsupervised classification system, Autoclass (Hanson et al. 1991). The fact that Bayesian model comparison embodies Occam’s razor has been rediscovered by Kashyap (1977) in the context of modeling time series; his paper includes a thorough discussion of how Bayesian model comparison is different from orthodox “Hypothesis testing.” One of the earliest applications of these sophisticated Bayesian methods of model comparison to real data is by Patrick and Wallace (1982); in this fasci- nating paper, competing models accounting for megalithic stone circle geometry are compared within the description length framework, which is equivalent to Bayes. Bayesian Interpolation 419 As the quantities of data collected throughout science and engineer- ing continue to increase, and the computational power and techniques available to model that data also multiply, I believe Bayesian methods will prove an ever more important tool for refining our modeling abili- ties. I hope that this review will help to introduce these techniques to the \"neural\" modeling community. A companion paper (MacKay 1992a) will demonstrate how these techniques can be fruitfully applied to backprop- agation neural networks. Another paper will show how this framework relates to the task of selecting where next to gather data so as to gain maxima1 information about our models (MacKay 1992b). 2 The Evidence and the Occam Factor Let us write down Bayes' rule for the two levels of inference described above, so as to see explicitly how Bayesian model comparison works. Each model 'Hi ('H stands for \"hypothesis\") is assumed to have a vec- tor of parameters w. A model is defined by its functional form and two probability distributions: a \"prior\" distribution P(w I 'Hi) that states what values the model's parameters might plausibly take; and the predictions P(D I w, 'Hi) that the model makes about the data D when its parameters have a particular value w. Note that models with the same parameter- ization but different priors over the parameters are therefore defined to be different models. 1. Model fitting. At the first level of inference, we assume that one model 'Hi is true, and we infer what the model's parameters w might be given the data D. Using Bayes' rule, the posterior Probability of the parameters w is (2.1) In words: Likelihood x Prior Evidence Posterior = The normalizing constant P(D 1 7-l;) is commonly ignored, since it is irrelevant to the first level of inference, that is, the choice of w; but it will be important in the second level of inference, and we name it the midence for 'Hi. It is common to use gradient-based methods to find the maximum of the posterior, which defines the most probable value for the parameters, WM~; it is then common to summarize the posterior distribution by the value of WMP, and error bars on these best fit parameters. The error bars are obtained from the curvature 420 David J. C. MacKay of the posterior; writing the Hessian A = -VV logP(w I D, 'Hi) and Taylor-expanding the log posterior with Aw = w - WMP, we see that the posterior can be locally approximated as a gaussian with covariance matrix (error bars) A-'.2 2. Model comparison. At the second level of inference, we wish to in- fer which model is most plausible given the data. The posterior probability of each model is Notice that the data-dependent term P(D I 'Hi) is the evidence for 'Hi, which appeared as the normalizing constant in equation 2.1. The second term, P('Hi), is a \"subjective\" prior over our hypothe- sis space that expresses how plausible we thought the alternative models were before the data arrived. We will see later that this subjective part of the inference will typically be overwhelmed by the objective term, the evidence. Assuming that we have no reason to assign strongly differing priors P('H,) to the alternative models, models 'Hi are ranked by evaluating the evidence. Equation 2.3 has not been normalized because in the data modeling process we may de- velop new models after the data have arrived (Fig. l), when an inadequacy of the first models is detected, for example. So we do not start with a completely defined hypothesis space. Inference is open ended: we continually seek more probable models to account for the data we gather. New models are compared with previous models by evaluating the evidence for them. The key concept of this paper is this: to assign a preference to alternative models Xi, a Bayesian evaluates the evidence P(D I 'Hi). This concept is very general: the evidence can be evaluated for parametric and \"non- parametric\" models alike; whether our data modeling task is a regression problem, a classification problem, or a density estimation problem, the evidence is the Bayesian's transportable quantity for comparing alterna- tive models. In all these cases the evidence naturally embodies Occam's razor; we will examine how this works shortly. 'Whether this approximation is a good one or not will depend on the problem we are solving. For the interpolation models discussed in this paper, there is only a single maximum in the posterior distribution, and the gaussian approximation is exact. For more general statistical models we still expect the posterior to be dominated by locally gaussian peaks on account of the central limit theorem (Walker 1967). Multiple maxima that arise in more complex models complicate the analysis, but Bayesian methods can still successfully be applied (Hanson et al. 1991; MacKay 1992a; Neal 1991). Bayesian Interpolation 421 Of course, the evidence is not the whole story if we have good reason to assign unequal priors to the alternative models 31. (To only use the evidence for model comparison is equivalent to using maximum likeli- hood for parameter estimation.) The classic example is the ”Sure Thing” hypothesis, @ E.T. Jaynes, which is the hypothesis that the data set will be D, the precise data set that actually occurred; the evidence for the Sure Thing hypothesis is huge. But Sure Thing belongs to an immense class of similar hypotheses that should all be assigned correspondingly tiny prior probabilities; so the posterior probability for Sure Thing is negligible alongside any sensible model. Models like Sure Thing are rarely seriously proposed in real life, but if such models are developed then clearly we need to think about precisely what priors are appropri- ate. Patrick and Wallace (1982), studying the geometry of ancient stone circles (for which some people have proposed extremely elaborate theo- ries!), discuss a practica1 method of assigning relative prior probabilities to alternative models by evaluating the lengths of the computer programs that decode data previously encoded under each model. This procedure introduces a second sort of Occam’s razor into the inference, namely a prior bias against complex models. However, this paper will not include such prior biases; we will address only the data’s preference for the al- ternative models, that is, the evidence, and the Occam’s razor that it embodies. In the limit of large quantities of data this objective Occam’s razor will always be the more important of the two. 2.1 A Modern Bayesian Approach to Priors. It should be pointed out that the emphasis of this modern Bayesian approach is not on the inclusion of priors into inference. There is not one significant “subjective prior” in this entire paper. (For problems where significant subjective pri- ors do arise see Gull 1989b; Skilling 1989.) The emphasis is that consistent degrees of preference for alternative hypotheses are represented by prob- abilities, and relative preferences for models are assigned by evaluating those probabilities. Historically, Bayesian analysis has been accompanied by methods to work out the “right” prior P(w I IFI) for a problem, for ex- ample, the principles of insufficient reason and maximum entropy. The modern Bayesian, however, does not take a fundamentalist attitude to assigning the “right” priors - many different priors can be tried; each particular prior corresponds to a different hypothesis about the way the world is. We can compare these alternative hypotheses in the light of the data by evaluating the evidence. This is the way in which alternative regularizers are compared, for example. If we try one model and obtain awful predictions, we have learned something. “A failure of Bayesian prediction is an opportunity to learn” (Jaynes 1986), and we are able to come back to the same data set with new models, using new priors for example. 422 David J. C. MacKay c W Aow Figure 3: The Occam factor. This figure shows the quantities that determine the Occam factor for a hypothesis 7-Ii having a single parameter W. The prior distribution (dotted line) for the parameter has width Aow. The posterior dis- tribution (solid line) has a single peak at WMP with characteristic width Aw. The Occam factor is Aw/A*w. 2.2 Evaluating the Evidence. Let us now explicitly study the evi- dence to gain insight into how the Bayesian Occam's razor works. The evidence is the normalizing constant for equation 2.1: (2.4) For many problems, including interpolation, it is common for the pos- terior P(w I D, h!,) c( P(D 1 w, 'Hi)P(w I 'Hi) to have a strong peak at the most probable parameters WMP (Fig. 3). Then the evidence can be approx- imated by the height of the peak of the integrand P(D 1 w,'H;)P(w I h!i) times its width, Aw: P(D I h!;) = 1 P(D 1 w1 'Hi)P(W I 'Hi) dw P(D I 'Hi) N P(D I WMP,~!~) P(WMVI~ I 'Hi) AW -- Evidence N Best fit likelihood Occam factor (2.5) Thus the evidence is found by taking the best fit likelihood that the model can achieve and multiplying it by an \"Occam factor\" (Gull 1988), which is a term with magnitude less than one that penalizes 'Hi for having the parameter w. 2.3 Interpretation of the Occam Factor. The quantity Aw is the pos- terior uncertainty in w. Imagine for simplicity that the prior P(w 1 h!]) is uniform on some large interval AOw, representing the range of val- ues of w that 7-1, thought possible before the data arrived (Fig. 3). Then P(WMP I 'HI) = l/Aow, and Aw Occam factor = ~ Aow Bayesian Interpolation 423 that is, the ratio of the posterior accessible volume of ‘His parameter space to the prior accessible volume, or the factor by which ‘Hi’s hypothesis space collapses when the data arrive (Gull 1988; Jeffreys 1939). The model Xi can be viewed as being composed of a certain number of equivalent submodels, of which only one survives when the data arrive. The Occam factor is the inverse of that number. The log of the Occam factor can be interpreted as the amount of information we gain about the model when the data arrive. Typically, a complex model with many parameters, each of which is free to vary over a large range Aow, will be penalized with a larger Occam factor than a simpler model. The Occam factor also provides a penalty for models that have to be finely tuned to fit the data; the Occam factor promotes models for which the required precision of the parameters Aw is coarse. The Occam factor is thus a measure of complexity of the model, but unlike the V-C dimension or algorithmic complexity, it relates to the complexity of the predictions that the model makes in data space; therefore it depends on the number of data points and other properties of the data set. Which model achieves the greatest evidence is determined by a trade-off between minimizing this natural complexity measure and minimizing the data misfit. 2.4 Occam Factor for Several Parameters. If w is k-dimensional, and if the posterior is well approximated by a gaussian, the Occam factor is given by the determinant of the gaussian’s covariance matrix: P(D I ‘Hi) 21 Evidence 1~ Best fit likelihood P(D I w~p,Hi) P(w~p I ‘Hi) (2~)~/’det-’/’A , (2.6) -‘ + Occam factor where A = -VV logP(w I D, ‘Hi), the Hessian that we already evaluated when we calculated the error bars on WMP. As the amount of data col- lected, N, increases, this gaussian approximation is expected to become increasingly accurate on account of the central limit theorem (Walker 1967). For the linear interpolation models discussed in this paper, this gaussian expression is exact for any N. 2.5 Comments. 0 Bayesian model selection is a simple extension of maximum likeli- hood model selection: fhe evidence is obtained by muzti~lying the best fit likelihood by the Occam factor. To evaluate the Occam factor all we need is the Hessian A, if the gaussian approximation is good. Thus the Bayesian method of model comparison by evaluation of the evidence is computation- ally no more demanding than the task of finding for each model the best fit parameters and their error bars. 424 David J. C. MacKay 0 It is common for there to be degeneracies in models with many pa- rameters; that is, several equivalent parameters could be relabeled without affecting the likelihood. In these cases, the right-hand side of equation 2.6 should be multiplied by the degeneracy of WMP to give the correct estimate of the evidence. 0 ”Minimum description length” (MDL) methods are closely related to this Bayesian framework (Rissanen 1978; Wallace and Boulton 1968; Wallace and Freeman 1987). The log evidence log,P(D I 31,) is the number of bits in the ideal shortest message that encodes the data D using model 31,. Akaike’s (1970) criterion can be viewed as an approximation to MDL (Schwarz 1978; Zellner 1984). Any implementation of MDL necessitates approximations in evaluating the length of the ideal shortest message. Although some of the earliest work on complex model comparison involved the MDL framework (Patrick and Wallace 19821, I can see no advantage in MDL, and recommend that the evidence should be approximated directly. 0 It should be emphasized that the Occam factor has nothing to do with how computationally complex it is to use a model. The ev- idence is a measure of plausibility of a model. How much CPU time it takes to use each model is certainly an interesting issue that might bias our decisions toward simpler models, but Bayes’ rule does not address that issue. Choosing between models on the ba- sis of how many function calls they need is an exercise in decision theory, which is not addressed in this paper. Once the probabilities described above have been inferred, optimal actions can be chosen using standard decision theory with a suitable utility function. 3 The Noisy Interpolation Problem Bayesian interpolation through noise-fvee data has been studied by Sibisi (1991). In this paper I study the problem of interpolating through data where the dependent variables are assumed to be noisy (a task also known as ”regression,” ”curve-fitting,” ”signal estimation,” or, in the neural networks community, “learning”). I am not examining the case where the independent variables are also noisy. This different and more difficult problem has been studied for the case of straight line-fitting by Gull (1989b). Let us assume that the data set to be interpolated is a set of pairs D = {x,,,, t,}, where m = 1 . . . N is a label running over the pairs. For simplicity I will treat x and t as scalars, but the method generalizes to the multidimensional case. To define a linear interpolation model, a set Bayesian Interpolation 425 of k fixed basis functions3 d = (q$,(x)} is chosen, and the interpolated function is assumed to have the form: (3.1) where the parameters wh are to be inferred from the data. The data set is modeled as deviating from this mapping under some additive noise process: (3.2) If v is modeled as zero-mean gaussian noise with standard deviation g,,, then the probability of the data4 given the parameters w is tm = y(xm) + vm where /3 = l/a2,, ED = C,,!fk(xm) - f,]’, and ZD = (2~//3)~/~. P(D 1 w, p, A) is called the likelihood. It is well known that finding the maximum likelihood parameters wML may be an “ill-posed” problem. That is, the w that minimizes ED is underdetermined and/or depends sensitively on the details of the noise in the data; the maximum like- lihood interpolant in such cases oscillates wildly so as to fit the noise. Thus it is clear that to complete an interpolation model we need a prior R that expresses the sort of smoothness we expect the interpolant y(x) to have. A model may have a prior of the form (3.4) where Ey might be for example the functional E, = Jy”(x)’dx (which is the regularizer for cubic spline interpolation5). The parameter N is a measure of how smooth f(x) is expected to be. Such a prior can also be written as a prior on the parameters w: (3.5) where Zw = Jdkw exp(-aEw). Ew (or EY) is commonly referred to as a regularizing function. The interpolation model is now complete, consisting of a choice of ba- sis functions d, a noise model with parameter P, and a prior (regularizer) ‘R, with regularizing constant a. 3The case of adaptive basis functions, also known as feedforward neural networks, is examined in a companion paper. 4Strictly, this probability should be written P({tm} I {xm}, w,P, A), since these inter- polation models do not predict the distribution of input variables {xm}; this liberty of notation will be taken throughout this paper and its companion. 5Strictly, this particular prior may be improper because a y(x) of the form w~x + wo is not constrained by this prior. 426 David J. C. MacKay 3.1 The First Level of Inference. If CY and /3 are known, then the posterior probability of the parameters w is6 (3.6) Writing' M(w) = aEw + ,BED (3.7) the posterior is (3.8) where ZM(CY, P) = Jdkw exp(-M). We see that minimizing the combined objective function M corresponds to finding the most probable interpolant, WM~. Error bars on the best fit interpolant* can be obtained from the Hessian of M, A = VVM, evaluated at WMP. This is the well known Bayesian view of regularization (Poggio et al. 1985; Titterington 1985). Bayes can do a lot more than just provide an interpretation for regu- larization. What we have described so far is just the first of three levels of inference. (The second level described in sections 1 and 2, \"model comparison,\" splits into a second and a third level for this problem, be- cause each interpolation model is made up of a continuum of submodels with different values of CY and P.) At the second level, Bayes allows us to objectively assign values to CY and P, which are commonly unknown a priori. At the third, Bayes enables us to quantitatively rank alterna- tive basis sets A, alternative regularizers (priors) R, and, in principle, alternative noise models. Furthermore, we can quantitatively compare interpolation under any model A, R with other interpolation and learn- ing models such as neural networks, if a similar Bayesian approach is applied to them. Neither the second nor the third level of inference can be successfully executed without Occam's razor. The Bayesian theory of the second and third levels of inference has only recently been worked out (Gull 1989a); this paper's goal is to re- view that framework. Section 4 will describe the Bayesian method of inferring CY and p; Section 5 will describe Bayesian model comparison for the interpolation problem. Both these inference problems are solved by evaluation of the appropriate evidence. 'The regularizer a, R has been omitted from the conditioning variables in the like- lihood because the data distribution does not depend on the prior once w is known. Similarly the prior does not depend on p. 7The name M stands for \"misfit\"; it will be demonstrated later that M is the natural measure of misfit, rather than & = ZPED. 'These error bars represent the uncertainty of the interpolant, and should not be confused with the typical scatter of noisy data points relative to the interpolant. Bayesian Interpolation 427 4 Selection of Parameters a and /3 Typically, a is not known a priori, and often ,b is also unknown. As a is varied, the properties of the best fit (most probable) interpolant vary. As- sume that we are using a prior that encourages smoothness, and imagine that we interpolate at a very large value of a; then this will constrain the interpolant to be very smooth and flat, and it will not fit the data at all well (Fig. 4a). As a is decreased, the interpolant starts to fit the data bet- ter (Fig. 4b). If a is made even smaller, the interpolant oscillates wildly so as to overfit the noise in the data (Fig. 4c). The choice of the \"best\" value of (Y is our first \"Occam's razor\" problem: large values of a correspond to simple models that make constrained and precise predictions, saying \"the interpolant is expected to not have extreme curvature anywhere\"; a tiny value of a corresponds to the more powerful and flexible model that says \"the interpolant could be anything at all, our prior belief in smooth- ness is very weak.\" The task is to find a value of a that is small enough that the data are fitted but not so small that they are overfitted. For more severely ill-posed problems such as deconvolution, the precise value of the regularizing parameter is increasingly important. Orthodox statistics has ways of assigning values to such parameters, based for example on misfit criteria, the use of test data, and cross-validation. Gull (1989a) has demonstrated why the popular use of misfit criteria is incorrect and how Bayes sets these parameters. The use of test data may be an unreliable technique unless large quantities of data are available. Cross-validation, the orthodox \"method of choice\" (Eubank 19881, will be discussed more in Section 6.6 and MacKay (1992a). I will explain the Bayesian method of inferring a and ,b after first reviewing some statistics of misfit. 4.1 Misfit, x2, and the Effect of Parameter Measurements. For N independent gaussian variables with mean p and standard deviation D, the statistic x2 = C(X-~)~/O~ is a measure of misfit. If p is known a priori, x2 has expectation Nf a. However, if p is fitted from the data by setting p = X, we \"use up a degree of freedom,\" and x2 has expectation N- 1. In the second case p is a \"well-measured parameter.\" When a parameter is determined by the data in this way it is unavoidable that the parameter fits some of the noise in the data as well. That is why the expectation of x2 is reduced by one. This is the basis of the distinction between the ON and ON-^ buttons on your calculator. It is common for this distinction to be ignored, but in cases such as interpolation where the number of free parameters is similar to the number of data points, it is essential to find and make the analogous distinction. It will be demonstrated that the Bayesian choices of both Q and ,b are most simply expressed in terms of the effective number of well-measured parameters, 7, to be derived below. 428 David J. C. MacKay 1.3 I\"t._L.\"z - 0.- . 3.3, I , , . . . . *.. . b) Figure 4: How the best interpolant depends on a. 'These figures introduce a data set, \"X,\" that is interpolated with a variety of models in this paper. Notice that the density of data points is not uniform on the x-axis. In the three figures the data set is interpolated using a radial basis function model with a basis of 60 equally spaced Cauchy functions, all with radius 0.2975. The regularizer is Ew = C w2, where w are the coefficients of the basis functions. Each figure shows the most probable interpolant for a different value of a: (a) 6000; (b) 2.5; (c) Note at the extreme values how the data are oversmoothed and overfitted, respectively. Assuming a flat prior, N = 2.5 is the most probable value of a. In (b), the most probable interpolant is displayed with its la error bars, which represent how uncertain we are about the interpolant at each point, under the assumption that the interpolation model and the value of N are correct. Notice how the error bars increase in magnitude where the data are sparse. The error bars do not get bigger near the datapoint close to (l,O), because the radial basis function model does not expect sharp discontinuities; the error bars are obtained assuming the model is correct, so that point is interpreted as an improbable outlier. Misfit criteria are \"principles\" that set parameters like a and (3 by re- quiring that x2 should have a particular value. The discrepancy principle requires x2 = N. Another principle requires x2 = N - k, where k is the number of free parameters. We will find that an intuitive misfit criterion Bayesian Interpolation 429 arises for the most probable value of /j; on the other hand, the Bayesian choice of cy will be unrelated to the value of the misfit. 4.2 Bayesian Choice of N and 0. To infer from the data what value Q and B should have: Bayesians evaluate the posterior probability dis- tribution: The data-dependent term P(D I a, P, A, R) has already appeared earlier as the normalizing constant in equation 3.6, and it is called the evidence for cy and 8. Similarly the normalizing constant of equation 4.1 is called the evidence for A, R, and it will turn up later when we compare alternative models A, R in the light of the data. If P(a,/?) is a flat prior\" (which corresponds to the statement that we do not know what value cy and /? should have), the evidence is the function that we use to assign a preference to alternative values of Q and p. It is given in terms of the normalizing constants defined earlier by Occam's razor is implicit in this formula: if a is small, the large freedom in the prior range of possible values of w is automatically penalized by the consequent large value of ZW; models that fit the data well achieve a large value of ZM. The optimum value of Q achieves a compromise between fitting the data well and being a simple model. Now to assign a preference to (a,/?), our computational task is to evaluate the three integrals ZM, ZW, and ZD. We will come back to this task in a moment. 4.2.1 But That Sounds Like Determining Your Prior after the Data Haue Ar- rived! This is an aside that can be omitted on a first reading. When I first heard the preceding explanation of Bayesian regularization I was discon- tent because it seemed that the prior is being chosen from an ensemble of possible priors after the data have arrived. To be precise, as described 'Note that it is not satisfactory to simply maximize the likelihood simultaneously over w, a, and 0; the likelihood has a skew peak such that the maximum likelihood value for the parameters is not in the same place as most of the posterior probability (Gull 1989a). To get a feeling for this here is a more familiar problem: examine the pos- terior probability for the parameters of a gaussian (p, a) given N samples: the maximum likelihood value for u is UN, but the most probable value for u (found by integrating over p) is UN-~. It should be emphasized that this distinction has nothing to do with the prior over the parameters, which is flat here. It is the process of marginalization that corrects the bias of maximum likelihood. '\"Since (Y and fi are scale parameters, this prior should be understood as a flat prior over loga and log@. 430 David J. C. MacKay above, the most probable value of a is selected; then the prior correspond- ing to that value of a alone is used to infer what the interpolant might be. This is not how Bayes would have us infer the interpolant. It is the com- bined ensemble of priors that define our prior, and we should integrate over this ensemble when we do inference.” Let us work out what hap- pens if we follow this proper approach. The preceding method of using only the most probable prior will emerge as a good approximation. The true posterior P(w I D,d,R) is obtained by integrating over a and P: P(w I D, A, R) = /P(w I D, a, P, d, R)P(a, P I D, A, R) da dP (4.3) In words, the posterior probability over w can be written as a linear combination of the posteriors for all values of a, P. Each posterior density is weighted by the probability of cr, P given the data, which appeared in equation 4.1. This means that if P(a,P I D,d,R) has a dominant peak at &,b, then the true posterior P(w I D,d,R) will be dominated by the density P(w I D,b,p,d,R). As long as the properties of the posterior P(w I D, cr, p, A, R) do not change rapidly with a, j5’ near b, b and the peak in P(a, P I D, A, R) is strong, we are justified in using the approximation: (4.4) This approximation is valid under the same conditions as in footnote 12. It is a matter of ongoing research to develop computational methods for cases where this approximation is invalid (Sibisi and Skilling, personal communication). P(w I D,d,R) -P(w I D,&,b,d,R) 4.3 Evaluating the Evidence. Let us return to our train of thought at equation 4.2. To evaluate the evidence for a,P, we want to find the integrals ZM, ZW, and ZD. Typically the most difficult integral to evaluate is ZM. zM(a, P) = 1 dkW exp[-M(wi (2, P)] If the regularizer R is a quadratic functional (and the favorites are), then ED and EW are quadratic functions of w, and we can evaluate ZM exactly. Letting VVEw = C and VVED = B then using A = aC + PB, we have 1 M = M(wM~) + T(w - WM~)~A(W - WMP) where WMP = PA-IBwML. This means that ZM is the gaussian integral: ZM = e-’~(2n)k/zdet-1/2A (4.5) “It is remarkable that Laplace almost got this right in 1774 (Stigler 1986); when inferring the mean of a Laplacian distribution, he both inferred the posterior probability of a nuisance parameter like in equation 4.1, and then attempted to integrate out the nuisance parameter as in equation 4.3. Bayesian Interpolation 431 a) b) 1 ,.' 0 ---- 50 t ... 0.001 0.01 0.1 1 10 100 1000 Alpha Figure 5: Choosing a. (a) The evidence as a function of a: Using the same radial basis function model as in Figure 4, this graph shows the log evidence as a function of a, and shows the functions. that make up the log evidence, namely the data misfit xh = 2,!3E~, the weight penalty term x$, = 2crEw, and the log of the Occam factor (2K)k/2det-'/2A/Zw(a). (b) Criteria for optimizing a: This graph shows the log evidence as a function of a, and the functions whose intersection locates the evidence maximum: the number of good parameter measurements y, and x$,. Also shown is the test error (rescaledl on two test sets; finding the test error minimum is an alternative criterion for setting a. Both test sets were more than twice as large in size as the interpolated data set. Note how the point at which xk = y is clear and unambiguous, which cannot be said for the minima of the test energies. The evidence gives Q a I-a confidence interval of [1.3,5.0]. The test error minima are more widely distributed because of finite sample noise. In many cases where the regularizer is not quadratic (for example, en- tropy-based), this gaussian approximation is still servicable (Gull 1989a). Thus we can write the log evidence for Q and p as 1 2 logP(D I a,P,A,R) = -aEZp -pEzP - -logdetA-logZw(cx) (4.6) k - logZ@) + 5 log27r The term PEEP represents the misfit of the interpolant to the data. The three terms -aEEp - log det A -log Zw(a) constitute the log of the \"Oc- cam factor\" penalizing over-powerful values of a: the ratio (2~)~/*det-\"~A/Z~(a) is the ratio of the posterior accessible volume in parameter space to the prior accessible volume, and the term aEZp mea- sures how far WMP is from its null value. Figure 5a illustrates the behavior 432 David J. C. MacKay of these various terms as a function of a for the same radial basis function model as illustrated in Figure 4. Now we could just proceed to evaluate the evidence numerically as a function of LY and P, but a more deep and fruitful understanding of this problem is possible. 4.4 Properties of the Evidence Maximum. The maximum over a,p of P(D I (Y, P, A, R) = Z~((ti, P)/[zw(a)zD(P)] has some remarkable prop- erties that give deeper insight into this Bayesian approach. The results of this section are useful both numerically and intuitively. Following Gull (1989a), we transform to the basis in which the Hessian of Ew is the identity, VVEw = I. This transformation is simple in the case of quadratic Ew: rotate into the eigenvector basis of C and stretch the axes so that the quadratic form Ew becomes homogeneous. This is the natural basis for the prior. I will continue to refer to the parameter vector in this basis as w, so from here on Ew = Cwf. Using VVM = A and VVED = B as above, we differentiate the log evidence with respect to a and p so as to find the condition that is satisfied at the maximum. The log evidence, from equation 4.6, is 1 2 logP(D 1 a, p, A, R) = -aEEP - DEEp - - logdet A (4.7) k N N 2 2 2- + -loga+-log~~--log2.ir First, differentiating with respect to a, we need to evaluate d/da log det A. Using A = nI + PB, d dcr - IogdetA = Trace = Trace (A-'I) = TraceA-' This result is exact if Ew and ED are quadratic. Otherwise this result is an approximation, omitting terms in dB/acu. Now, differentiating equa- tion 4.7 and setting the derivative to zero, we obtain the following con- dition for the most probable value of a: (4.8) The quantity on the left is the dimensionless measure of the amount of structure introduced into the parameters by the data, that is, how much the fitted parameters differ from their null value. It can be interpreted as the x2 of the parameters, since it is equal to x& = C4/&, with The quantity on the right of equation 4.8 is called the number of good parameter measurements, y, and has value between 0 and k. It can be written in terms of the eigenvalues of PB, A,, where the subscript a runs 2aEgP = k - crTraceA-' (I. = I/& Bayesian Interpolation 433 w21GwMp ‘wuL ’ Figure 6: Good and bad parameter measurements. Let w1 and w2 be the com- ponents in parameter space in two directions parallel to eigenvectors of the data matrix B. The circle represents the characteristic prior distribution for w. The ellipse represents a characteristic contour of the likelihood, centered on the maximum likelihood solution WML. WMP represents the most probable param- eter vector. w1 is a direction in which A1 is small compared to a, that is, the data have no strong preference about the value of wl; w1 is a poorly measured parameter, and the term X,/(X, + a) is close to zero. w2 is a direction in which XI is large; w2 is well determined by the data, and the term Xz/(X, + a) is close to one. over the k eigenvectors. The eigenvalues of A are A, + a, so we have k - - a=l y = k - aTraceA-’ = (4.9) Each eigenvalue Xa measures how strongly one parameter is determined by the data. The constant a measures how strongly the parameters are determined by the prior. The ath term ya = X,/(A, + a) is a number between 0 and 1 that measures the strength of the data in direction a relative to the prior (Fig. 6): the components of WMP are given by WMP~ = A direction in parameter space for which A, is small compared to a does not contribute to the number of good parameter measurements. y is thus a measure of the effective number of parameters that are well determined by the data. As alp --f 0, y increases from 0 to k. The con- dition, equation 4.8, for the most probable value of a can therefore be interpreted as an estimation of the variance of the gaussian distri- bution from which the weights are drawn, based on y effective samples from that distribution: CT$ = C wf/y. This concept is not only important for locating the optimum value of a: it is only the y good parameter measurements that are expected to contribute to the reduction of the data misfit that occurs when a model is fitted to noisy data. In the process of fitting w to the data, it is un- avoidable that some fitting of the model to noise will occur, because some 7aWMI.a. 434 David J. C. MacKay components of the noise are indistinguishable from real data. Typically, one unit (x2) of noise will be fitted for every well-determined parameter. Poorly determined parameters are determined by the regularizer only, so they do not reduce xk in this way. We will now examine how this concept enters into the Bayesian choice of p. Recall that the expectation of the x2 misfit between the true interpolant and the data is N. However we do not know the true interpolant, and the only misfit measure to which we have access is the x2 between the inferred interpolant and the data, & = 20E~. The ”discrepancy principle” of orthodox statistics states that the model parameters should be adjusted so as to make xh = N. Work on unregularized least-squares regression suggests that we should estimate the noise level so as to set xb = N - k, where k is the number of free parameters. Let us find out the opinion of Bayes’ rule on this matter. We differentiate the log evidence, equation 4.7, with respect to p and obtain, setting the derivative to zero: 2pE~ = N - (4.10) Thus the most probable noise estimate, b, does not satisfy & = N or xh = N - k; rather, xk = N - y. This Bayesian estimate of noise level naturally takes into account the fact that the parameters that have been determined by the data inevitably suppress some of the noise in the data, while the poorly measured parameters do not. Note that the value of x; enters only into the determination of p: misfit criteria have no role in the Bayesian choice of D (Gull 1989a). In summary, at the optimum value of cy and [j, xh = y, x; = N - y. Notice that this implies that the total misfit M = NEW + PEL, satisfies the simple equation 2h4 = N. The interpolant resulting from the Bayesian choice of N is illustrated by Figure 4b. Figure 5b illustrates the functions involved with the Bayes- ian choice of a, and compares them with the “test error” approach. Demonstration of the Bayesian choice of p is omitted, since it is straight- forward; /3 is fixed to its true value for the demonstrations in this paper. Inference of an input-dependent noise level p(x) will be demonstrated in a future publication. These results generalize to the case where there are two or more separate regularizers with independent regularizing constants {a,} (Gull 1989a). In this case, each regularizer has a number of good parameter measurements yc associated with it. Multiple regularizers will be used in the companion paper on neural networks. Finding the evidence maximum with a head-on approach would in- volve evaluating det A while searching over a, p; the above results (equa- tions 4.8,4.10) enable us to speed up this search (for example, by the use of reestimation formulas like a := y/2Ew) and replace the evaluation of detA by the evaluation of TraceA-’. For large dimensional problems Bayesian Interpolation 435 where this task is demanding, Skilling (1989) has developed methods for estimating TraceA-' statistically in k2 time. 5 Model Comparison To rank alternative basis sets d and regularizers (priors) R in the light of the data, we examine the posterior probabilities: P(A,R I D) 0: P(D I A,R)P(A,R) (5.1) The data-dependent term, the evidence for A, R, appeared earlier as the normalizing constant in equation 4.1, and is evaluated by integrating the evidence for (a, P): P(D I 4 R) = 1 P(D I A, R, a, D)p(a, P) da @ (5.2) Assuming that we have no reason to assign strongly differing priors P(d, R), alternative models A, R are ranked just by examining the ev- idence. The evidence can also be compared with the evidence found by an equivalent Bayesian analysis of other learning and interpolation models so as to allow the data to assign a preference to the alternative models. Notice as pointed out earlier that this modern Bayesian frame- work includes no emphasis on defining the \"right\" prior R with which we ought to interpolate. Rather, we invent as many priors (regularizers) as we want, and allow the data to tell us which prior is most probable. Having said this, I would still recommend that the \"maximum entropy principle\" and other respected guides should be consulted when invent- ing these priors (see Gull 1988, for example). 5.1 Evaluating the Evidence for d,R. As a and p vary, a single evidence maximum is obtained, at &, fi (at least for quadratic ED and Ew). The evidence maximum is often well approximated12 by a separable gaussian, and differentiating equation 4.7 twice we obtain gaussian error bars for logo and logp: (Aloga)' N 2/y (AlogP)2 N 2/(N-y) P(D I d, R) - P(D I &, a, d, R)P(&, a) 27r Alog a Alog P Putting these error bars into equation 5.2, we obtain the evidence.I3 (5.3) I2This approximation is valid when, in the spectrum of eigenvalues of PB, the number I3There are analytic methods for performing such integrals over (Bretthorst 1990). of eigenvalues within e-fold of & is O(1). 436 David J. C. MacKay How is the prior P(6, a) assigned? This is the first time in this paper that we have met one of the infamous \"Subjective priors\" that are supposed to plague Bayesian methods. Here are some answers to this question. (1) Any other method of assigning a preference to alternatives must im- plicitly assign such priors. Bayesians adopt the healthy attitude of not sweeping them under the carpet. (2) With some thought, reasonable values can usually be assigned to subjective priors, and the degree of reasonable subjectivity in these assignments can be quantified. For ex- ample, a reasonable prior on an unknown standard deviation states that 0 is unknown over a range of (3f2) orders of magnitude. This prior con- tributes a subjectivity of about &1 to the value of the log evidence. This degree of subjectivity is often negligible compared to the log evidence differences. (3) In the noisy interpolation example, all models consid- ered include the free parameters a and p. So in this paper I do not need to assign a value to P(&, 8); I assume that it is a flat prior (flat over log a and logp, since a and p are scale parameters) that cancels out when we compare alternative interpolation models. 6 Demonstration These demonstrations will use two one-dimensional data sets, in imita- tion of Sibisi (1991). The first data set, \"X,\" has discontinuities in deriva- tive (Fig. 4), and the second is a smoother data set, \"Y\" (Fig. 8). In all the demonstrations, p was not left as a free parameter, but was fixed to its known true value. The Bayesian method of setting a, assuming a single model is cor- rect, has already been demonstrated, and quantified error bars have been placed on the most probable interpolant (Fig. 4). The method of eval- uating the error bars is to use the posterior covariance matrix of the parameters Wh, A-*, to get the variance on y(x), which for any x is a linear function of the parameters, y(x) = ch (bh(X)Wh. The error bars at a single point x are given by vary(x) = (bTA-'4. Actually we have access to the full covariance information for the entire interpolant, not just the pointwise error bars. It is possible to visualize the joint error bars on the interpolant by making typical samples from the posterior distribution, performing a random walk around the posterior \"bubble\" in parameter space (Sibisi 1991; Skilling et al. 1991). Figure 8 shows data set Y inter- polated by three typical interpolants found by random sampling from the posterior distribution. These error bar properties are found under the assumption that the model is correct; so it is possible for the true interpolant to lie significantly outside the error bars of a poor model. In this section Bayesian model comparison will be demonstrated first with models differing only in the number of free parameters (for exam- ple, polynomials of different degrees), then with comparisons between models as disparate as splines, radial basis functions, and feedforward Bayesian Interpolation 437 0 ......... C Evldmc. for 1.Q.ndre polynml.1. * -20 4 0 -20 -40 v * f -80 -100 c) -100 -6oI*!.:;, , , , , , . j -120 -140 -160 ' 15 20 25 30 35 40 45 50 55 Nd.r of bA.1. function. ............ L .... ....... *..l - ---pq ..,,-.=s- .......................... ~. ........ 2---; 3 1::: ........ -,~ - : E I 0 -20 -40 E f -80 -1oa b) Cwehy lunsrlmn. - G.UI.1.\". ---. 1.2 1 0.6 0.6 0.4 0.2 J 0- 20 40 60 80 100 120 140 d) Nd.r of co.fflsl.nt. 0 40 60 BO 100 120 Nd-r of coeffIclentr Figure 7 The Evidence for data set X (see also table 1). (a) Log evidence for Legendre polynomials. Notice the evidence maximum. The gentle slope to the right is due to the \"Occam factors\" that penalize the increasing complexity of the model. (b) Log evidence for radial basis function models. Notice that there is no Occam penalty for the additional coefficients in these models, because increased density of radial basis functions does not make the model more powerful. The oscillations in the evidence are due to the details of the pixellation of the basis functions relative to the data points. (c) Log evidence for splines. The evidence is shown for the alternative splines regularizers p = 0.. .6 (see text). In the representation used, each spline model is obtained in the limit of an infinite number of coefficients. For example, p = 4 yields the cubic splines model. (d) Test error for splines. The number of data points in the test set was 90, cf. number of data points in training set = 37. The y-axis shows ED; the value of ED for the true interpolant has expectation 0.225 f 0.02. neural networks. For each individual model, the value of a is optimized, and the evidence is evaluated by integrating over a using the gaussian approximation. All logarithms are to base e. 6.1 Legendre Polynomials: Occam's Razor for the Number of Basis Functions. Figure 7a shows the evidence for Legendre polynomials of different degrees for data set X. The basis functions were chosen to be orthonormal on an interval enclosing the data, and a regularizer of the form Ew = C iwi was used. 438 David J. C. MacKay Table I: Evidence for models interpolating data sets X and Y! Data Set X Data Set Y Model Best Log Best Log parameter evidence parameter evidence values values Legendre polynomials k = 38 -47 k = 11 23.8 Gaussian radial k > 40, k > 50, Cauchy radial k > 50, k > 50, basis functions r = .25 -28.8 i 1.0 r = .77 27.1 f 1.0 basis functions r = .27 -18.9 f 1.0 r = 1.1 25.7 f 1.0 Splines, p = 2 k > 80 -9.5 k > 50 8.2 Splines, p = 3 k > 80 -5.6 k > 50 19.8 Splines, p = 5 k > 80 -24.9 k > 50 21.8 Splines, p = 6 k > 80 -35.8 k > 50 20.4 Splines, p = 4 k > 80 -13.2 k > 50 22.1 Hermite functions k=18 - 66 k=3 42.2 Neural networks 8 neurons, -12.6 6 neurons, 25.7 k = 25 k=19 ‘All logs are natural. The evidence P(D I 1-i) is a density over D space, so the absolute value of the log evidence is arbitrary within an additive constant. Only differences in values of log evidences are relevant, relating directly to probability ratios. Notice that an evidence maximum is obtained: beyond a certain num- ber of terms, the evidence starts to decrease. This is the Bayesian Occam’s razor at work. The additional terms make the model more powerful, able to make more predictions. This power is automatically penalized. Notice the characteristic shape of the ”Occam hill.” On the left, the hill is steep as the oversimple models fail to fit the data; the penalty for misfitting the data scales as N, the number of data measurements. The other side of the hill is much less steep; the log Occam factors here only scale as klogN, where k is the number of parameters. We note in Table 1 the value of the maximum evidence achieved by these models, and move on to alternative models. The choice of orthonormal Legendre polynomials described above was motivated by a maximum entropy argument (Gull 1988). Models using other polynomial basis sets have also been tried. For less well- motivated basis sets such as Hermite polynomials, it was found that the Occam factors were far bigger and the evidence was substantially smaller. If the size of the Occam factor increases rapidly with overparameteriza- tion, it is generally a sign that the space of alternative models is poorly matched to the problem. Bayesian Interpolation 439 6.2 Fixed Radial Basis Functions. For a radial basis function or “ker- nel” model, the basis functions are 4rl(x) = g[(x - xh)/r]/r; here the xh are equally spaced over the range of interest. I examine two choices of g: a gaussian and a Cauchy function, 1/1 + x2. We can quantitatively com- pare these alternative models of spatial correlation for any data set by evaluating the evidence. The regularizer is Ew = C iw;. Note that this model includes one new free parameter, r; in these demonstrations this parameter has been set to its most probable value (i.e., the value that maximizes the evidence). To penalize this free parameter an Occam fac- tor is included, fiP(1og r)A log r, where A log r = posterior uncertainty in log Y, and P(1og r) is the prior on log r, which is subjective to a small degree [I used P(1ogr) = 1/(4 f 2)]. This radial basis function model is the same as the ”intrinsic correlation” model of Charter (1991), Gull (1989a), and Sibisi (1991). Figure 7b shows the evidence as a function of the number of basis functions, k. Note that for these models there is not an increasing Occam penalty for large numbers of parameters. The reason for this is that these extra parameters do not make the model any more powerful (for fixed (Y and r). The increased density of basis func- tions does not enable the model to make any significant new predictions because the kernel g band-limits the possible interpolants. 6.3 Splines: Occam’s Razor for the Choice of Regularizer. The splines model was implemented as follows: let the basis functions be a Fourier set coshx, sinhx, h = 0,1,2,. . .. Use the regularizer Ew = C ~hPw&,,,) + C ih”z~$,,,,~. If p = 4 then in the limit k -+ 00 we have the cubic splines regularizer EF) = Jy”(x)*dx; if p = 2 we have the reg- ularizer Ef) = J y’(~)~dx, etc. Notice that the “nonparametric” splines model can easily be put in an explicit parameterized representation. Figure 7c shows the evidence for data set X as a function of the num- ber of terms, for p = 0,1,2,3,4,6. Notice that in terms of Occam’s razor, both cases discussed above occur: for p = 0, 1, as k increases, the model becomes more powerful and there is an Occam penalty. For p = 3,4,6, increasing k gives rise to no penalty. The case p = 2 seems to be on the fence between the two. As p increases, the regularizer becomes more opposed to strong cur- vature. Once we reach p = 6, the model becomes improbable because the data demand sharp discontinuities. The evidence can choose the order of our splines regularizer for us. For this data set, it turns out that p = 3 is the most probable value of p, by a few multiples of e. In passing, the radial basis function models described above can be transformed into the splines models’ Fourier representation. If the radial basis function kernel is g(x) then the regularizer in the splines represen- tation is Ew = C i(z~;(~,~) + W;(~~,,,)G~*, where Gh is the discrete Fourier transform of g. 440 David J. C. MacKay 3, I 2.5 2 1.5 I Y x I 1 -.5 -2 -1 0 1 2 3 4 5 x Figure 8: Data set \"Y,\" interpolated with splines, p = 5. The data set is shown with three typical interpolants drawn from the posterior probability distribution. Contrast this with Figure 4b, in which the most probable interpolant is shown with its pointwise error bars. 6.4 Results for a Smoother Data Set. Figure 8 shows data set Y, which comes from a much smoother interpolant than data set X. Table 1 summarizes the evidence for the alternative models. We can confirm that the evidence behaves in a reasonable manner by noting the following differences between data sets X and Y In the splines family, the most probable value of p has shifted upward to the stiffer splines with p = 4 - 5, as we would intuitively expect. Legendre polynomials: an observant reader may have noticed that when data set X was modeled with Legendre polynomials, the most probable number of coefficients k = 38 was suspiciously similar to the number of data points N = 37. For data set Y, however, the most probable number of coefficients is 11, which confirms that the evidence does not always prefer the polynomial with k = N! Data set X behaved in this way because it is very poorly modeled by polynomials. The Hermite function model, which was a poor model for data set X, is now the most probable, by a long way (over a million times more probable). The reason for this is that actually the data were generated from a Hermite function! Bayesian Interpolation 441 6.5 Why Bayes Cannot Systematically Reject the Truth. Let us ask a sampling theory question: if one of the models we offer to Bayes is actually true, i.e., it is the model from which the data were generated, then is it possible for Bayes to systematically (over the ensemble of pos- sible data sets) prefer a false model? Clearly under a worst case analysis, a Bayesian‘s posterior may favor a false model. Furthermore, Skilling (1991) demonstrated that with some data sets a free form (maximum en- tropy) model can have greater evidence than the truth; but is it possible for this to happen in the typical case, as Skilling seems to claim? I will show that the answer is no, the effect that Skilling demonstrated cannot be systematic. To be precise, the expectation over possible data sets of the log evidence for the true model is greater than the expectation of the log evidence for any other fixed model (Osteyee and Good 1974).14 Proof. Suppose that the truth is actually 3-11. A single data set arrives and we compare the evidences for 3-11 and 3-12, a different fixed model. Both models may have free parameters, but this will be irrelevant to the argument. Intuitively we expect that the evidence for ‘XI, P(D 1 3-11), should usually be greatest. Let us examine the difference in log evidence between and 3-12. The expectation of this difference, given that 3-1, is true, is (Note that this integral implicitly integrates over all El’s parameters ac- cording to their prior distribution under XI.) Now it is well known that for normalized p and q, J p log p/q is minimized by setting q = p (Gibbs’ theorem). Therefore a distinct model 3-12 is never expected to systemati- cally defeat the true model, for just the same reason that it is not wise to bet differently from the true odds. This result has two important implications. First, it gives us frequentist confidence in the ability of Bayesian methods on the average to identify the true model. Second, it provides a stringent test of numerical imple- mentations of Bayesian model comparison: imagine that we have written a program that evaluates the evidence for models 3-11 and 3-12; then we can generate mock data from sources simulating 311 and 3-12 and evalu- ate the evidence; if there is any systematic bias, averaged over several mock data sets, for the estimated evidence to favor the false model, then we can be sure that our numerical implementation is not evaluating the evidence correctly. ‘‘Skilling’s result presumably occurred because the particular parameter values of the true model that generated the data were not typical of the prior used when evaluating the evidence for that model. In such a case, the log evidence difference can show a transient bias against the true model, for small quantities of data; such biases are usually corrected by greater quantities of data. 442 David J. C. MacKay This issue is illustrated using data set Y. The \"truth is that this data set was actually generated from a quadratic Hermite function, 1.1 (1 - x + 2~*)e-~/~. By the above argument the evidence ought probably to favor the model \"the interpolant is a 3-coefficient Hermite function\" over our other models. Table 1 shows the evidence for the true Hermite function model, and for other models. As already stated, the truth is indeed considerably more probable than the alternatives. Having demonstrated that Bayes cannot systematically fail when one of the models is true, we now examine the way in which this framework can fail, if none of the models offered to Bayes is any good. 6.6 Comparison with \"Generalization Error\". It is a popular and intuitive criterion for choosing between alternative interpolants (found using different models) to compare their errors on a test set that was not used to derive the interpolants. \"Cross-validation\" is a more refined and more computationally expensive version of this same idea. How does this method relate to the evaluation of the evidence described in this paper? Figure 7c displayed the evidence for the family of spline interpolants. Figure 7d shows the corresponding test error, measured on a test set with size over twice as big (90) as the \"training\" data set (37) used to determine the interpolant. A similar comparison was made in Figure 5b. Note that the overall trends shown by the evidence are matched by trends in the test error (if you flip one graph upside down). Also, for this particular problem, the ranks of the alternative spline models under the evidence are similar to their ranks under the test error. And in Figure 5b, the evidence maximum over 0 is surrounded by the test error minima. Thus this suggests that the evidence might be a reliable predictor of generalization ability. However, this is not necessarily the case. There are five reasons why the evidence and the test error might not be correlated. First, the test error is a noisy quantity. It is necessary to devote large quantities of data to the test set to obtain a reasonable signal-to-noise ratio. In Figure 5b more than twice as much data is in each test set but the difference in log (u between the two test error minima exceeds the size of the Bayesian confidence interval for log a. Second, the model with greatest evidence is not expected to be the best model all the time - Bayesian inferences are uncertain. The whole point of Bayes is that it quantifies precisely those uncertainties: the relative values of the evidence for alternative models express the plausibility of the models, given the data and the underlying assumptions. Third, there is more to the evidence than there is to the generalization error. For example, imagine that for two models, the most probable interpolants happen to be identical. In this case, the two solutions will have the same generalization error, but the evidence will not in general Bayesian Interpolation 443 be the same: typically, the model that was a priori more complex will suffer a larger Occam factor and will have a smaller evidence. Fourth, the test error is a measure of performance only of the single most probable interpolant: the evidence is a measure of plausibility of the entire posterior ensemble around the best fit interpolant. Probably a stronger correlation between the evidence and the test statistic would be obtained if the test statistic used were the average of the test error over the posterior ensemble of solutions. This ensemble test error is not so easy to compute. The fifth and most interesting reason why the evidence might not be correlated with the generalization error is that there might be a flaw in the underlying assumptions such that the models being compared might all be poor models. If a poor regularizer is used, for example, one that is ill-matched to the statistics of the world, then the Bayesian choice of cy will often not be the best in terms of generalization error (Davies and Anderssen 1986; Gull 1989a; Haussler et al. 1991). Such a failure occurs in the companion paper on neural networks. What is our attitude to such a failure of Bayesian prediction? The failure of the evidence does not mean that we should discard Bayes’ rule and use the generalization error as our criterion for choosing a. A failure is an opportunity to learn; a healthy scientist actively searches for such failures, because they yield insights into the defects of the current model. The detection of such a failure (by evaluating the generalization error, for example) motivates the search for new models that do not fail in this way; for example, alternative regularizers can be tried until a model is found that makes the data more probable. If one uses the generalization error only as a criterion for model com- parison, one is denied this mechanism for learning. The development of maximum entropy image deconvolution was held up for years be- cause no one used the Bayesian choice of a; once the Bayesian choice of CY was used (Gull 1989a1, the results obtained were most dissatisfactory, making clear what a poor regularizer was being used; this motivated an immediate search for alternative priors; the new, more probable priors discovered by this search are now at the heart of the state of the art in image deconvolution (Weir 1991). 6.7 The Similarity between Regularization and “Early Stopping“. While an overparameterized model is fitted to a data set using gradient descent on the data error, it is sometimes noted that the model’s general- ization error passes through a minimum, rather than decreasing mono- tonically. This is known as “overlearning” in the neural networks com- munity, and some researchers advocate the use of “early stopping,” that is, stopping gradient descent before the data error minimum is reached, so as to try to obtain solutions with smaller generalization error. This author believes that “overlearning” should be viewed as a symp- tom of a model ill-matched to the data set, and that the appropriate re- 444 David J. C. MacKay sponse is not to patch up a bad model, but rather to search for models that are well matched to our data. In particular, the use of models in- corporating simple regularizers is expected to give results qualitatively similar to early stopping. This can be seen by examining Figure 6. The regularizer moves the minimum of the objective function from WML to wMP; as the strength of the regularizer N is increased, WMP follows a knee-shaped trajectory from WML to the origin; a typical solution WMP is shown in Figure 6. If on the other hand gradient descent on the likeli- hood (data error) is used, and if the typical initial condition is close to the origin, then gradient descent will follow a similar knee-shaped trajectory. Thus qualitatively similar solutions are expected from increasingly early stopping and increasingly strong regularization with complete minimiza- tion. Regularization is to be preferred as a more robust, repeatable, and comprehensible procedure. 6.8 Admitting Neural Networks into the Canon of Bayesian Interpo- lation Models. A second paper will discuss how to apply this Bayesian framework to feedforward neural networks. Preliminary results using these methods are included in Table 1. Assuming that the approxima- tions used were valid, it is interesting that the evidence for neural nets is actually good for both the spiky and the smooth data sets. Further- more, neural nets, in spite of their arbitrariness, yield a relatively compact model, with fewer parameters needed than to specify the splines and ra- dial basis function solutions. 7 Conclusions The recently developed methods of Bayesian model comparison and reg- ularization have been presented. Models can be ranked by evaluating the evidence, a solely data-dependent measure that intuitively and consis- tently combines a model's ability to fit the data with its complexity. The precise posterior probabilities of the models also depend on the subjective priors that we assign to them, but these terms are typically overwhelmed by the evidence. Regularizing constants are set by maximizing the evidence. For many regularization problems, the theory of the number of well-measured pa- rameters makes it possible to perform this optimization on-line. In the interpolation examples discussed, the evidence was used to set the number of basis functions k in a polynomial model; to set the characteristic size Y in a radial basis function model; to choose the order p of the regularizer for a spline model, and to rank all these different models in the light of the data. Further work is needed to formalize the relationship of this frame- work to the pragmatic model comparison technique of cross-validation. Using the two techniques in parallel, it is possible to detect flaws in the Bayesian Interpolation 445 underlying assumptions implicit in the data models being used. Such failures direct our search for superior models, providing a powerful tool for human learning. There are thousands of data modeling tasks waiting for the evidence to be evaluated. It will be exciting to see how much we can learn when this is done. Acknowledgments I thank Mike Lewicki, Nick Weir and David R. T. Robinson for helpful conversations, and Andreas Herz for comments on the manuscript. I am grateful to Dr. R. Goodman and Dr. I? Smyth for funding my trip to Maxent 90. This work was supported by a Caltech Fellowship and a Studentship from SERC, UK. References Akaike, H. 1970. Statistical predictor identification. Ann. Inst. Statist. Math. 22, Berger, J. 1985. Statistical Decision Theory and Bayesian Analysis. Springer, Berlin. Box, G. E. P., and Tiao, G. C. 1973. Bayesian Inference in Statistical Analysis. Addison-Wesley, Reading, MA. Bretthorst, G. L. 1990. Bayesian analysis. I. Parameter estimation using quadra- ture NMR models. 11. Signal detection and model selection. 111. Applications to NMR. J. Mag. Reson. 88(3), 533-595. Charter, M. K. 1991. Quantifying drug absorption. In Maximum Entropy and Bayesian Methods, Laramie, 2990, W. T. Grandy and L. H. Schick, eds., pp. 245- 252. KIuwer, Dordrecht. Cox, R. T. 1964. Probability, frequency, and reasonable expectation. Am. J. Phys. Davies, A. R., and Anderssen, R. S. 1986. Optimization in the regularization of ill-posed problems. J. Aust. Mat. SOC. Ser. B 28, 114-133. Eubank, R. L. 1988. Spline smoothing and non-parametric regression. Marcel Dekker, New York. Gull, S. F. 1988. Bayesian inductive inference and maximum entropy. In Max- imum Entropy and Bayesian Methods in Science and Engineering, Vol. 1: Founda- tions, G. J. Erickson and C. R. Smith, eds., pp. 53-74. Kluwer, Dordrecht. Gull, S. F. 1989a. Developments in maximum entropy data analysis. In Maxi- mum Entropy and Bayesian Methods, Cambridge, 1988, J. Skilling, ed., pp. 53-71. Kluwer, Dordrecht. Gull, S. F. 1989b. Bayesian data analysis: Straight-line fitting. In Maximum Entropy and Bayesian Methods, Cambridge, 2988, J. Skilling, ed., pp. 511-518. Kluwer, Dordrecht. Gull, S. F., and Skilling, J. 1991. Quantified Maximum Entropy. MemSys5 User’s Manual. M.E.D.C., 33 North End, Royston, SG8 6NR, England. 203-21 7. 14, 1-13. 446 David J. C. MacKay Hanson, R., Stutz, J., and Cheeseman, P. 1991. Bayesian classification theory. NASA Ames TR FIA-90-12-7-01. Haussler, D., Kearns, M., and Schapire, R. 1991. Bounds on the sample complex- ity of Bayesian learning using information theory and the VC dimension. In Proceedings of the Fourth COLT Workshop. Morgan Kaufmann, San Mateo, CA. Jaynes, E. T. 1986. Bayesian methods: General background. In Maximum En- tropy and Bayesian Methods in Applied Statistics, J. H. Justice, ed., pp. 1-25. Cambridge University Press, Cambridge. Jeffreys, H. 1939. Theory of Probability. Oxford University Press, Oxford. Kashyap, R. L. 1977. A Bayesian comparison of different classes of dynamic models using empirical data. IEEE Transact. Automatic Control AC-22(5), 715- 727. Loredo, T. J. 1989. From Laplace to supernova SN 1987A: Bayesian inference in astrophysics. In Maximum Entropy and Bayesian Methods, P. Fougere, ed., pp. 81-142. Kluwer, Dordrecht. MacKay, D. J. C. 1992a. A practical Bayesian framework for backpropagation networks. Neural Comp. 4(3), 448-472. MacKay, D. J. C. 1992b. Information-based objective functions for active data selection. Neural Comp., to appear. Neal, R. M. 1991. Bayesian mixture modeling by Monte Carlo simulation. Preprint. Dept. of Computer Science, University of Toronto. Osteyee, D. B., and Good, I. J. 1974. Information, Weight of Evidence, the Singularity between Probability Measures and Signal Detection. Springer, Berlin. Patrick, J. D., and Wallace, C. S. 1982. Stone circle geometries: An information theory approach. In Archaeoastronomy in the Old World, D. C. Heggie, ed. Cambridge University Press, Cambridge. Poggio, T., Torre, V., and Koch, C. 1985. Computational vision and regulariza- tion theory. Nature (London) 317(6035), 314-319. Rissanen, J. 1978. Modeling by shortest data description. Automatica 14, 465- 471. Schwarz, G. 1978. Estimating the dimension of a model. Ann. Stat. 6(2), 461- 464. Sibisi, S. 1991. Bayesian interpolation. In Maximum Entropy and Bayesian Methods, Laramie, 1990, W. T. Grandy, Jr., and L. H. Schick, eds., pp. 349-355. Kluwer, Dordrecht. Skilling, J. 1989. The eigenvalues of mega-dimensional matrices. In Maximum Entropy and Bayesian Methods, Cambridge, 1988, J. Skilling, ed., pp. 455-466. Kluwer, Dordrecht. Skilling, J. 1991. On parameter estimation and quantified MaxEnt. In Mux- imum Entropy and Bayesian Methods, Lararnie, 1990, W. T. Grandy, Jr., and L. H. Schick, eds., pp. 267-273. Kluwer, Dordrecht. Skilling, J., Robinson, D. R. T., and Gull, S. F. 1991. Probabilistic displays. In Maximum Entropy and Bayesian Methods, Laramie, 1990, W. T. Grandy, Jr., and L. H. Schick, eds., pp. 365-368. Kluwer, Dordrecht. Stigler, S. M. 1986. Laplace’s 1774 memoir on inverse probability. Stat. Sci. 1(3), 359-378. Bayesian Interpolation 447 Szeliski, R. 1989. Bayesian Modeling of Uncertainty in Low Level Vision. Kluwer, Dordrech t . Titterington, D. 1985. Common structure of smoothing techniques in statistics. Int. Statist. Rev. 53, 141-170. Walker, A. M. 1967. On the asymptotic behaviour of posterior distributions. J. R. Stat. SOC. B 31, 80-88. Wallace, C. S., and Boulton, D. M. 1968. An information measure for classifica- tion. Comput. J. 11(2), 185-194. Wallace, C. S., and Freeman, P. R. 1987. Estimation and inference by compact coding. J. R. Statist. SOC. B 49(3), 240-265. Weir, N. 1991. Applications of maximum entropy techniques to HST data. Proc. ESOIST-ECF Data Analysis Workshop, April 1991. Zellner, A. 1984. University of Chicago Press, Chicago. Basic Issues in Econometrics. Received 21 May 1991; accepted 29 October 1991.","libVersion":"0.3.1","langs":""}