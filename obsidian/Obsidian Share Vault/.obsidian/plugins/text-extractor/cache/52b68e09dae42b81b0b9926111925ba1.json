{"path":"lit/lit_notes_OLD_PARTIAL/Heinemann06frcstSolRadCMV.pdf","text":"Forecasting of Solar Radiation Detlev Heinemann, Elke Lorenz, Marco Girodo Oldenburg University, Institute of Physics, Energy and Semiconductor Research Laboratory, Energy Meteorology Group 26111 Oldenburg, Germany E-mail: detlev.heinemann@uni-oldenburg.de URL: www.energy-meteorology.de Abstract Solar energy is expected to contribute major shares of the future global energy supply. Due to its fluctuating nature an efficient use will require reliable forecast information of its availability in various time and spatial scales depending on the application. The current status of forecasting solar irradiance for energy generation purposes is briefly reviewed with respect to very short-term forecasting (up to a few hours) and forecasts for up to two days mainly for use in utility applications. Keywords: forecasting, solar irradiance, numerical model 1. Introduction One of the major challenges for future global energy supply will be the large scale integration of renewable energy sources into existing energy supply structures. This not only demands substantial efforts in further development of advanced technologies but also makes the availability of precise information on the fluc- tuating wind and solar resources an indispensable necessity. Any efficient implementation of wind and solar energy conversion processes has to account for this behaviour in respective operating strategies. A key issue hereby is the prediction of renewable energy fluxes, typically for time scales from the sub-hourly range up to two days depending on the given application. Examples are the storage management in stand-alone photo- voltaic or wind energy systems, control systems in buildings, control of solar thermal power plants and the management of electricity grids with high penetration rates from renewable sources (see Fig.1). First attempts in irradiance forecasting have been presented more than twenty years ago (Jensenius, 1981), when daily solar radiation forecasts for one to two days in advance have been produced with the Model Output Statistics (MOS) technique (Glahn and Lowry, 1972), which is presented in chapter 3. Subsequent years showed only minor attemps or progress with respect to the development of solar irradiance forecasting methods. Heck and Takle (1987) and Jensenius (1989) both presented variations of the MOS approach with- out introducing new elements. In the very short-range time scale Kaifel and Jesemann (1992) used a statistical approach for the prediction of cloud motion in Meteosat images and could show the principal benefit of the method for the time scale of one hour, but also revealed a significant numerical effort. Chowdhury and Rahman (1987) used a statistical autoregressive ARIMA model to forecast sub-hourly irradiance. Beyer et al. (1994) used a multiresolution decomposition technique for a structure analysis of satellite images, which are decomposed into local avera- ges and gradients on various spatial scales. Information in both, averages and gradients may be used for forecasting. This paper presents different state-of-the-art approaches to solar irradiance forecasting on different time scales. Very short-term forecasting in a temporal range of 30 minutes to 6 hours (chapter 2) is based on the analysis of satellite data. Forecasts for up to 2 days ahead (chapter 3) are based on numerical weather prediction. The time scale – and its corresponding spatial scale – is governed by the application and its time constants. For example, an operation of a PV-diesel system needs information in the very short time range whereas an integration of solar power into electricity grids will largely benefit from forecasts one or more days ahead. The latter is also the time range where the output from numerical weather forecasts is applied. 0,1h 1h 10h 100h PV Electricity Utility Load Building control System operation STPP 1000 km 100 km 10 km 1 km Range of NWP 10 min 1d 2d Fig. 1: Typical target applications for irradiance forecasting and their respective spatial and temporal scales. (STPP = Solar Thermal Power Plants, PV = Photovoltaics). The blue area depicts the range for which the use of Numerical Weather Prediction models is appropriate. 2. Very short-term forecasting As far as short-term horizons are concerned, satellite data are a high quality source for irradiance information because of its excellent temporal and spatial resolution. Due to the strong impact of cloudiness on surface solar irradiance, an accurate description of the temporal development of the cloud situation is essential for irradiance forecasting. As a measure of cloudiness, cloud index images according to the Heliosat method (Hammer et al., 2003), a semi-empirical method to derive solar irradiance from satellite data, are calculated from the satellite data. To predict the cloud index image in a first step motion vector fields are derived from two consecutive images. The future image then is determined by applying the calculated motion vector field to the actual image. Finally, solar surface irradiance is derived from the predicted cloud index images with the aid of the Heliosat method. Figure 2 gives an overview of these steps to derive the irradiance forecast. forecast of global irradiance Forecast: • motion vector fields • smoothing satellite images forecast of cloud-index images cloud-index images Heliosat Method Fig. 2: Short-term forecasting scheme using statistical methods on satellite imagery. 2.1 Calculation of cloud and radiation maps Images in the visible range of the geostationary satellite METEOSAT are used as an input data for the fore- cast. The satellite provides an image of the full Earth disc every 30 minutes with a spatial resolution of approximately 2.5 km x 3.5 km in central Europe. The surface irradiance and information on clouds are derived from the satellite measurements using an en- hanced version of the Heliosat method. A characteristic feature of the method is the derivation of a dimensionless cloud index value n for each image pixel describing the influence of cloudiness on atmospheric transmittance. Further a quasi linear relationship is assumed between the cloud index n and the ratio of global irradiance G and clear-sky irradiance Gclear, referred to as the clear-sky index k*. Typical deviations of hourly satellite-derived surface irradiance from ground truth data are 20-25% of relative root mean square error (RMSE). Future calculation schemes will benefit from the high-quality data of the new Meteosat Second generation satellites (Mueller et al., 2004). 2.2 Forecasting scheme The forecast algorithm for very short-term time scales operates on cloud index images and is therefore independent of the diurnal pattern of solar irradiance. This allows to focus on the development of cloud structures. The deterministic daily variation of irradiance is added through the use of a clear sky model. As the temporal change of cloud strucures on short time scales up to one hour is mainly caused by cloud motion, motion vector fields are an appropriate tool to forecast cloud index images. Several approaches to derive motion vector fields have been proposed (e.g., Beyer et al. (1994), Bannehr et al. (1994), Cote and Tatnall (1995)). As an example, an algorithm proposed by Hammer et al. (1999) is based on a model of motion using the the basic assumptions about cloud motion: • Pixel intensities remain constant during the motion (typically one time slot) • The motion vector field is smooth, i.e. neighbouring vectors do not differ much in direction and length. To derive motion vector fields, corresponding regions are identified within two consecutive images accor- ding to the model of motion (Fig. 3). The criterium for an optimum displacement vector is the minimum mean square pixel difference for a rectangular region. The calculated motion vector field is applied to the current image to derive the forecast image. Finally, the forecasted image undergoes a smoothing filter for the elimination of randomly varying small scale structures which are not predictable. Filtering this 'noise' considerably improves the forecast quality. 10:00 Model of motion 12:00 11:00 Fig. 3: Motion vector fields calculated in a short-term forecasting scheme. 2.3 Forecast accuracy For an evaluation of the overall error, the forecast results were compared to half-hourly ground measured irradiance data from a regional measurement network for global irradiance (region of Saarbrücken, Germany, period 4/1995-3/1996). To derive the regional forecasts, average values of eight stations distributed over an area of 31km x 45km have been calculated. Fig. 4 shows the RMSE of the global irradiance forecast. The forecast algorithm significantly reduces the errors compared to persistence. With increasing forecast horizon the influence of smoothing becomes more important compared to the application of motion vector fields. Furthermore, the Heliosat method conside- rably contributes to the overall deviation, especially for very short forecast horizons. Fig. 4: RelativeRMSE of global irradiance forecast depending on the forecast horizon, calculated for a one year period in Germany (eight stations in an area of 31km x 45km). For comparison, forecasts based on persistence, on application of a smoothing filter, and on motion vectors only are displayed. As a lower limit the deviation due to the Heliosat method only is given. Fig. 5: Forecast error ranges depending on the irradiance situation. Ground measured(red) and forecasted (blue) irradiance for a clear sky (left) and a broken cloudy (irght) day. The yellow area represents the two-standard-error- range for all situations, the orange area is specific to the given zenith angle – variability class. An accurate specification of the forecast error is an important issue for an effective application. Therefore, a detailed two-dimensional error analysis was performed to distinguish situations with different forecast quality. Two parameters were chosen to characterize situations with different levels of accuracy: Solar zenith angle and pixel variability within the cloud index images. Situations with inhomogeneous clouds, corresponding to a high variability in the cloud index images, generally are more difficult to forecast and usually show larger errors. Fig. 5 shows two typical situations with different accuracies. Whereas clear sky days show signifi- cantly smaller errors than average, broken cloudy days behave vice versa. This information on expected accuracy is an important component of any irradiance forecast. Consequently, different classes of forecast quality are defined with respect to solar zenith angle and variability index. For large solar zenith angles the forecast errors exceed 40% for all forecast horizons. Fig. 6 shows the relative standard error depending on the forecast horizon for the different variability classes. In cases of high irradiance with very low spatial variability the error for half-hourly irradiance values ranges from 10% for a forecast horizon of 30 minutes to 25% for a forecast horizon of 6 hours. Higher variabilities show considerably higher forecast errors. Fig. 6: Relative standard error for various forecast lead times. The curves show different variability from high (top) to low (bottom). Only solar zenith angles below 70° are considered. 3. Irradiance forecasting based on numerical weather prediction Very short-term forecasting of global solar irradiance is limited to a time horizon of approximately 6 h. For an efficient planning and operation of solar energy systems and especially for its grid integration forecasts for up to 48 h or even beyond have to be provided. Therefore, the potential of numerical meteorological mo- dels in forecasting solar irradiance needs to be evaluated. A meteorological model is any model which allows to calculate fields of meteorological variables, e.g., wind speed, radiation, in the atmosphere. Models range from global, numerical weather prediction models (NWP) to models for local environments. Global NWP models have usually a coarse resolution and do not allow for a detailed mapping of small-scale features. Therefore, the use of regional mesoscale models and the combination of a NWP model with statistical post- processing tools to account for local effects are emphasized here. 3.1 Mesoscale numerical modeling Mesoscale models are three-dimensional, primitive equation, regional models. They usually use staggered grids, terrain-following vertical coordinates, and four-dimensional data assimilation using nudging. They in- clude parameterizations for several processes, e. g., turbulence and radiation. The PSU/NCAR mesoscale model MM5 is a regional-scale primitive equation model that can be configured hydrostatically or non-hydrostatically (Grell et al., 1995). It uses a terrain-following coordinate in pressure, solves its finite-difference equations with a time-split scheme and has multiple nesting capabilities. Parame- terization of atmospheric radiation provides longwave and shortwave schemes that interact with the atmos- phere including cloud and precipitation fields as well as with the surface. MM5 is driven in this investigation by parameters available from a global NWP model. Typical input para- meters are air temperature, horizontal wind speed, relative humidity, geopotential height, sea-level pressure and surface temperature. The resolution of these data is typically 0.5 to 1 degree in space and 3 to 6 hours in time. MM5 performs spatial and temporal scaling and the calculation of the solar irradiance. The accuracy of MM5 forecasts of solar irradiance and the dependency on different MM5 configurations as well as on diffe- rent input data is still not known in detail. Only a few studies have investigated MM5 estimations of solar irradiance for single locations (Armstrong, 2000; Zamora, 2003). Extended studies on regional forecasts of solar irradiance are still pending. Therefore, a case study of using MM5 for forecasting surface solar irradiance for lead times of up to 48 hours for regions as well as for single locations has been carried out. The general potential of the method and its expected accuracy should be examined. In a first step different MM5 configurations and their downward short-wave radiation results were compared to determine the best set-up. For this purpose MM5 has been initialized with NCEP1 reanalysis data from (National Center for Environmental Prediction) with a (1°x1°, 6 h) resolution. The configuration test and the first forecast runs with the best set-up are done by case studies. Three different cloud situations (clear sky , broken clouds, overcast) with a 48 h lead time were investigated. The results are computed as spatial averages for a region of 150x150 km with a horizontal grid size of 3x3 km, 23 vertical layers and a temporal resolution of 1 h. The comparison of seven configurations shows significant differences in the error of the irradiance. For the clear sky situation the error is between 0.25 % and -14.7 % . The broken cloud situation is linked with higher errors (2.3 % to - 64.4 %) as well as the overcast case (-7.8 % to 129 %). The best configuration is defined to be the one which leads in all three cases to acceptable errors (1.85 %; 6.75%; 25.8 %). The best configuration was used in the forecast test case with data from different sources and with different resolutions as initialization. Two NWP models were used as input: The global macroscale model GME of the German Weather Service (DWD) running with a mesh size of approx. 60 km and a temporal resolution of 3h. Based on this model, the mesoscale model LM covering Europe computes a forecast with a mesh size of approx. 7 km and hourly values. Both models provide output to be used with MM5. The second input source was the ECMWF2 forecast with a temporal resolution of 6 h and a grid resolution of approx. 60 km. Fig. 7: Left: Comparison of MM5 forecast (o) and satellite-derived Heliosat data (+) for six consecutive days with clear skies. Right: Same for a day with broken clouds. Black: satellite-derived irradiance (Heliosat); red: MM5 with ECMWF initialization; blue: MM5 with DWD-LM initialization. First results show a good agreement between measurements and forecasts for clear sky situations (Fig. 7, left) and the effect caused by different input sources is negligible. In case of broken clouds and overcast situations the deviations increase significantly. Fig. 7 (right) shows the results for a forecast compared with satellite derived data. Although the Heliosat data shows a strong overcast situation, MM5 predicts a nearly clear sky situation when using the DWD-LM initialization. The ECMWF initialization reduces this deviation but also overestimates the irradiance compared to the Heliosat data. 1 National Centers for Environmental Prediction, USA 2 ECMWF is the European Centre for Medium Range Weather Forecasts in Reading, U.K.. Based on the case study results an additional investigation has been performed for a period of 40 days in summer 2003 for a 200 km x 200 km region in Germany. Again, ECMWF and DWD LM-6h are used for initialization. The results are compared to ground measurements of eight ground stations, to Heliosat derived data and to results from an operational MOS forecast (Fig. 8). Fig. 8: Relative root mean square errors for regional 200 km x 200 km forecasts for one (left) and two (right) days, 40 days in summer 2003. MOS forecasts show a superior behaviour compared to MM5 results. A second approach in using a mesoscale model for solar irradiance forecasting is to predict parameters describing cloudiness. After converting, this information can be used within the Heliosat method to derive solar irradiance. In a similar way and after a temporal and spatial scaling the cloud parameters predicted by macroscale models may be used. The global macroscale model run by ECMWF already directly forecasts solar irradiance. The weakness is the low spatial and temporal resolution which may be overcome by a spatial and temporal integration. This approach also makes the integration of forecasts of aerosol type and amount a promising option. Fig. 9 shows the principal procedure. Cloud index, COD Clear Sky Irradiance Aerosol Forecast MM5 Cloud Forecast Global irradiance Fig. 9: Forecasting approach based on mesoscale numerical modeling. Weather forecast NWP model output Local refinement (statistical methods, e.g.: MOS) Local prediction (time and site specific) Fig. 10: Scheme of an operational irradiance forecasting using Model Output Statistics (MOS). Local measurements ground- or satellite-based 3.2 Model output statistics Model Output Statistics (MOS) is a post-processing technique used to objectively interpret numerical model output and produce site-specific forecasts. MOS relates observed weather elements to appropriate variables (predictors) via a statistical approach. These predictors may be NWP model forecast, prior observations, or geoclimatic data. The Glossary of Meteorology defines MOS as follows: “For a numerical weather predic- tion model, statistical relations between model-forecast variables and observed weather variables, used for either correction of model-forecast variables or prediction of variables not explicitly forecast by the model.” (American Meteorological Society, 2000) MOS objectively interprets NWP model output based on a historical sample and therefore only predicts events which are forced by synoptic-scale systems. It may correct for certain systematic NWP model biases and quantify uncertainty in NWP model forecasts. It accounts for some local effects and incorporates clima- tic considerations. By principle, it cannot predict events forced by mesoscale features and correct for certain deficiencies in NWP model physics, analysis schemes, or parameterizations. Also changes to NWP model components cannot be considered. Not every local effect may be accounted for as well as unusual climatic conditions. Jensenius (1981) for the first time presented a MOS approach to solar irradiance forecasting. Daily solar ra- diation forecasts for one to two days in advance were produced using a multiple linear regression for max. twelve predictors explaining each at least 0.1% of the total predictand variance. Approaches for clearness index, and irradiation directly, both for single station and regionalized were developed. Mainly predictors which determine cloudiness were used: mean relative humidity, 750 hPa vertical velocity, 850 hPa relative vorticity, 200 hPa wind speed, 700 hPa dew point, etc. Verification statistics showed a mean bias error (MBE) of 2 % and a rmse of 25% for a 1-day-forecast. Tab. 1: Verification results for ECMWF based MOS forecast. Forecasts using ground and satellite-derived data are compared to persistance and to deviations introduced by the satellite technique HELIOSAT. rmse, hourly rmse, daily mbe, hourly mbe, daily MOS, ground data 32.1 19.0 2.9 2.8 MOS, Meteosat data 34.9 22.9 2.3 2.1 Ground persistance 54.5 48.1 -0.2 -0.6 Meteosat persistance 52.2 48.2 3.3 2.7 HELIOSAT 26.0 12.1 2.8 3.4 Recently, a MOS based forecasting scheme for solar irradiance has been reported using ECMWF model output (Bofinger and Heilscher, 2004). Direct model output as well as statistically derived predictors were used. The most relevant predictors are: cloud cover index, dew point difference, 500 hPa relative humidity, dew point difference, cloud cover below 2000m, probability of precipitation. Verification results for a one- year period (2002) and 32 German sites are given in Tab. 1. Bias errors are low for all forecasts, rmse values show significant improvements over persistance with minor differences between ground-based and satellite- derived data. Outlook Only recently more work has been presented to improve solar irradiance forecasting. For one- or two-day forecasts the direct output from numerical macro- or mesoscale models has shown severe deviations between forecasted and real irradiance. This can be understood by the role of radiant fluxes in numerical models, which are important as a driver for atmospheric processes and to a much less extend for the production of precise surface solar irradiances. The indirect use of these models by using forecasts of variables which influence surface irradiance (clouds, humidity,..) seems to be a promising option. The coupling of these data with radiative transfer models then is a straightforward task. In the same sense, coupling of atmospheric and statistical models (as MOS is) still has a strong potential for improvements. Acknowledgements Forecast data have been kindly provided by the German Weather Service (DWD) and the European Centre for Medium Range Weather Forecasts (ECMWF). Ground measurement data are supplied by the German Weather Service. Meteocontrol GmbH provided information on an operational MOS solar irradiance forecast. Validation results have been produced by Carsten Hoyer, DLR, in the framework of the ESA funded project ENVISOLAR. Current research on solar irradiance forecasting reported in this paper is performed in the framework of the Virtual Institue of Energy Meteorology (vIEM) funded by the Helmholtz Gemeinschaft.. References American Meteorological Society (2000): Glossary of Meteorology. 2nd Edition, Boston, USA. Armstrong, M. A. (2000): Comparison of MM5 Forecast Shortwave Radiation with Data Obtained from the Atmospheric Radiation Measurement Program. Master of Science Scholarly Paper, University of Maryland, USA. Bannehr, L., Rohn, M. and Warnecke, G. (1996): A Functional Analytic Method to Derive Displacement Vector Fields From Satellite Image Sequences. International Journal of Remote Sensing 17, 383–392. Beyer, H.G., Costanzo, C., Heinemann, D. and Reise, C. (1994): Short Range Forecast of PV Energy Pro- duction Using Satellite Image Analysis. Proc. 12th European Photovoltaic Solar Energy Conference, 11-15 April 1994, Amsterdam, 1718–1721. Bofinger, S. and Heilscher, G. (2004): Solar Radiation Forecast Based on ECMW and Model Output Statistics. Technical Report ESA/ENVISOLAR, AO/1-4364/03/I-IW, EOEP-EOMD. Chowdhury, B. H. and Rahman, S. (1987): Forecasting Sub-hourly Solar Irradiance for Prediction of Photo- voltaic Output. Proc. 19th IEEE Photovoltaic Specialists Conference, New Orleans, LA, 4-8 May 1987, 171–176. Cote S., and Tatnall, A. R. L. A. (1995): Neural Network Based Method for Tracking Features from Satellite Sensor Images. International Journal of Remote Sensing 16, 3695–3701. Glahn, H. R. and Lowry, D. A. (1972). The Use of Model Output Statistics (MOS) in Objective Weather Forecasting (1972): Journal of Applied Meteorology 11, 1203–1211. Grell, G. A., Dudhia, J. and Stauffer, D. R. (1995): A Description of the Fifth-Generation Penn State/NCAR Mesoscale Model (MM5). Technical Note NCAR/TN-398+STR, National Center for Atmospheric Re- search, Boulder, USA, 121pp. Hammer, A., Heinemann, D., Lorenz, E., Lückehe, B. (1999): Short-term Forecasting of Solar Radiation: A Statistical Approach Using Satellite Data, Solar Energy 67, 139–150. Hammer, A., Heinemann, D., Hoyer, C., Kuhlemann, R., Lorenz, E., Müller, R. and Beyer, H. G. (2003): Solar Energy Assessment Using Remote Sensing Technologies. Remote Sensing of Environment 86, 423–432. Heck, P. W. and Takle, E. S. (1987): Objective Forecasts of Solar Radiation and Temperature. Iowa State Journal of Research 62, 29–42. Jensenius, J. S. and Cotton, G. F. (1981): The Development and Testing of Automated Solar Energy Fore- casts Based On The Model Output Statistics (MOS) Technique. Proc. 1st Workshop on Terrestrial Solar Resource Forecasting and on the Use on Satellites for Terrestrial Solar Resource Assessment, Newark, 1981, American Solar Energy Society. Jensenius, J. S. (1989): Insolation Forecasting. In: R. L. Hulstrom (Ed.): Solar Resources, MIT Press, Cam- bridge, pp. 335–349. Kaifel, A. K. and Jesemann, P. (1992): An Adaptive Filtering Algorithm for Very Short-range Forecast of Cloudiness Applied to Meteosat Data, Proc. 9th Meteosat Users Meeting, Locarno. Lorenz, E., Heinemann, D. and Hammer, A. (2004): Short-term Forecasting of Solar Radiation Based on Satellite Data. Proc. Eurosun (ISES Europe Solar Congress), Freiburg, Germany. Müller, R. W., Dagestad, K. F., Ineichen, P., Schroedter-Homscheidt, M., Cros, S., Dumortier, D., Kuhle- mann R., Olseth, J. A., Piernavieja, G., Reise, C., Wald, L. and Heinemann, D. (2004): Rethinking Sa- tellite-based Solar Irradiance Modeling – The SOLIS Clear Sky Module. Remote Sensing of Environ- ment 91, 160–174. Zamora, R. J., Solomon, S., Dutton, E. G., Bao, J. W., Trainer, M., Portmann, R. W., White, A. B., Nelson, D. W. and R.T. Mc Nider (2003): Comparing MM5 Radiative Fluxes with Observations Gathered During the 1995 and 1999 Nashville Southern Oxidants Studies. Journal of Geophysical Research 108 (D2), 4050ff.","libVersion":"0.3.2","langs":""}