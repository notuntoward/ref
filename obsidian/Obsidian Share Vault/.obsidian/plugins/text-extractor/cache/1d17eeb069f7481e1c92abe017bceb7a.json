{"path":"lit/lit_sources.backup/papers_to_add/Papers I'm Reviewing Right Now/SplineRgrsn/MultivariateSplinesArbKnots/v10i4pp309-317_abstract.pdf","text":"309 Control Points for Multivariate B-Spline Surfaces over Arbitrary Triangulations Philip Fong and Hans-Peter Seidel* Abstract This paper describes first results of a test implementation that implements the new multivariate B-splines as recently devel- oped by Dahmen et al. 10 for quadratics and cubics. The surface scheme is based on blending functions and control points and allows the modelling of -continuous piecewise polyno- mial surfaces of degree k over arbitrary triangulations of the parameter plane. The surface scheme exhibits both affine in- variance and the convex hull property, and the control points can be used to manipulate the shape of the surface locally. Additional degrees of freedom in the underlying knot net al- low for the modelling of discontinuities. Explicit formulas are given for the representation of polynomials and piecewise polynomials as linear combinations of B-splines. Categories and Subject Descriptors: I.3.5 [Computer Graph- ics]: Computational Geometry and Object Modeling - curve, surface, solid, and object representations; J.6 [Computer- Aided Engineering]: Computer-Aided Design (CAD); G. 1.2 [Approximation]: Spline Approximation. General Terms: Algorithms, Design. Additional Key Words and Phrases: Blossoming, B-patch, B-spline surface, control point, knot net, multivariate B- splines, polar forms, symmetric recursive algorithms. 1. Introduction Tensor-product B-spline surfaces3,26 have proven themselves an excellent tool for the modelling of free form surfaces. How- ever, tensor-product surfaces also have their well-known draw- backs if the modelling of largely irregular objects is required. Therefore, not surprisingly, the need for B-splines over non- rectangular regions has been expressed quite early27. 1.1. Previous Work Splines over arbitrary triangulations of the parameter plane have first been considered by Dahmen et al.8 and Höllig18. These multivariate splines are defined as projections of sim- plices and are therefore called simplex splines. The main draw- back of simplex splines in the past has been the difficulty in forming linear combinations and the absence of control points. *This work has been partly supported by the Natural Sci- ences and Engineering Research Council of Canada through Personal Operating Grant OGP0105573 and Strategic Oper- ating Grant STR0040527 †Computer Graphics Laboratory Department of Computer Science University of Waterloo Waterloo, Ontario, N2L 3G1, Canada A different approach has been taken by Seidel29. The B- patches developed there are based on the study of symmetric recursive evaluation algorithms and are defined by generalizing the de Boor algorithm for the evaluation of a B-spline segment from curves to surfaces. B-patches have control points but the construction of smooth surfaces still requires considerable computation. Other approaches to the construction of B-splines over irregular domains have been based on subdivision7,12, interpo- lation23, and on the use of multisided patches19,20,28. However, each of these schemes has its own difficulties. The new scheme presented in this paper has been obtained by matching B-patches with simplex splines\". It differs from the other schemes mentioned above in that it is an approxima- tion scheme that is based on blending functions and control points. The resulting surfaces are defined as linear combina- tions of the blending functions and are parametric piecewise polynomials over a triangulation of the parameter plane whose shape is determined by their control points. 1.2. Overview The paper is organized as follows: Section 2 recalls some basic facts about simplex splines and B-patches and develops the new B-spline scheme. Section 3 illustrates the use of control points as shape handles and discusses how discontinuities can be introduced through appropriate knot placement. Section 4 develops formulae for the representation of polynomial and piecewise polynomial surfaces as linear combinations of B- splines. This representation is new for piecewise polynomials. An example from our implementation illustrates this result in the quadratic case. Finally, Section 5 offers some concluding remarks and points out directions for future work. 1.3. Notation Defining for any ordered set of affinely independent points in the plane and North-Holland Computer Graphics Forum 10 (1991) 309-317 310 P. Fong et al. / Multivariate B-Spline Surfaces 2.2. B-patches A fix to this problem arises from the study of B- patches29. B-patches are a patch representation for polyno- mial surfaces that arises from generalizing the de Boor Algo- rithm from curves to surfaces. One way to define B-patches the barycentric coordinates of u with respect to the ordered set W are given as i.e. is by means of their blending functions Given a tri- angle together with the additional knots the B- patch blending functions over A( I) are given by the recurrence We let denote the convex hull of an arbitrary set and we use stan- dard multiindex notationz i4 with denoting multiindices that sum to l. 2. The New B-spline Scheme and where are the barycentric co- ordinates of u with respect to It The new B-spline scheme is obtained from matching B- patches29 with simplex splines8,18. The main advantage of is shown by Seidel29 that the B-patch blending functions form a partition of unity and that every polynomial surface F can be the new scheme lies in the availability of control points. This allows forming surfaces as linear combinations of blending functions, and the control points can be used for shape control and for the representation of piecewise polynomials. written as linear of them. This representation 2.1. Simplex Splines Let be a finite set of points in The simplex spline is defined re- cursively as follows: For we set is called a B-patch. The points are called B-patch control points. Moreover, the B-patch control points in this representation are given by where f denotes the polar form or blossom of It follows symmetric simplicial evaluation algorithm that is similar to the de Boor algorithm for spline curves29. This means that a B-patch can be evaluated by the recurrence where is the characteristic function on from the properties of polar forms25 that B-patches have a For we set where is any subset of affinely indepen- dent points in For a more detailed introduction to simplex splines the reader is referred to Micchelli21 . Further information can be found elsewhere8,9,16-18,22,33 . Here we note that is positive and is known to be a piecewise polynomial of degree k = m - 2, supported on the convex hull that is - continuous everywhere. Simplex splines exhibit the problem that it is a priori unclear how to form linear combinations and how to use them for constructing piecewise polynomial surfaces over arbitrary triangulations. The above definition demonstrates that lots and lots of simplex splines exist. Which ones should we choose, and how should we normalize to achieve affine invariance? and such that is a point on the surface. Note that the recurrence relations (3),(4) and (7),(8) are dual to each other29. 2.3. The New B-spline Scheme The construction of the new spline scheme\" is based on the ob- servation that the recurrence relations (1),(2) and (3),(4) agree under proper selection of the knots and under proper renormal- ization. P. Fong et al. /Multivariate B-Spline Surfaces 311 Figure 1. Triangulation of a bounded domain More precisely: Let define a triangulation of the parameter plane (or of a bounded domain This means that while for any two is empty or is a common point or edge of and In particular, any edge of some is the common edge of exactly two triangles and say (see Figure 1). In order to construct simplex splines of degree k over the triangulation T we first assign a sequence of knots to every vertex of the triangulation in such a way that and that any set of three knots is affinely independent, or, in other words, forms a proper triangle (These constraints will be relaxed in Section 3.2. to allow for the modelling of dis- continuities). With the knot net in place we can then consider the simplex splines with and Let us now consider the regions defined by (where int A denotes the interior of a set A) and let us assume that (which can always be assured through care- ful knot placement). Loosely speaking, this condition states that the clouds of knots associated with different vertices of a triangle are all separated from each other. In particular, all triangles then have the same orien- tation (see Figure 2). It is shown elsewhere\" that under these conditions where In fact, the recipe for choosing the sets according to (10) precisely stems from this observation. It is perhaps worthwhile to point out that this knot selection rule is completely different from an- other rule as developed earlier8,18, and subsequently used, e.g., elsewhere1,15,33. The above identity (12) suggests introducing the normalized B-splines It follows from (6) and (12) that the normalized B-splines are linearly independent and locally linearly independent over Figure 2. The region 312 P. Fong et al. / Multivariate B-Spline Surfaces every subdomain of These normalized B-splines are used as blending functions in the new B-spline scheme. A B-spline surface F of degree k over a given triangula- tion T with knot net is then defined as 3. Control Points and Shape Control Due to its construction, the B-spline scheme developed in the previous section inherits properties from both simplex-splines and B-patches. This section lists some of these properties that are useful for interactive surface design. 3.1. Control Points Since the B-patch blending functions form a partition of unity, it follows from (12),(13) that the normalized B-splines also sum up to one for Equation (18) in the following section implies that this property holds not just locally, but also globally, i.e. and the normalized B-splines form a global partition of unity. This property implies affine invariance: Let : be an affine map (e.g. translation, rotation, scaling), then the result of applying to a B-spline surface F(u) = is given by the B-spline surface with transformed coefficients i.e. This property makes the coefficients meaningful indepen- dent of the coordinate system. Furthermore, since the simplex splines are positive, the definition (13) implies that the normalized B-splines are also positive throughout. By virtue of (15) a B-spline surface therefore lies in the convex hull of its coefficients. This property is usually referred to as convex hull property. Another important property of the B-spline scheme is its locality. Recall that a simplex spline vanishes outside the convex hull of its knots. Hence the normalized B-spline vanishes outside the convex hull of its knots as well. Therefore the movement of a coefficient only affects the surface on the triangle and on the triangles surrounding it. Everywhere else the surface is left unchanged. The above properties show that the coefficients in the B-spline representation control the shape of the surface and have geometric meaning that is invariant under coordinate transformation. The coefficients are therefore called control points. We summarize the properties that have been mentioned so far as follows: Affine Invariance: The relationship between the control points and the B-spline surface is invariant under affine coordinate transformations. Convex Hull Property: A B-spline surface lies in the convex hull of its control points. Locality: Movement of a control point only affects the B- spline surface locally on one triangle of the given trian- gulation and on the triangles surrounding it. Smoothness: A B-spline surface of degree k is a piecewise polynomial of degree k on its knot net that is continuous everywhere if the knots are in general position. Figure 3. Different knot configurations for the normalized B-splines It follows from (13) and from the properties of simplex splines that F is a piecewise polynomial of degree k over the subtrian- gulation of T that is given by the knot net, and that F is continuous everywhere. This degree of continuity is remark- able since it is well-known that -continuous piecewise polynomials of degree k are usually hard to come by13,14. P. Fong et al. / Multivariate B-Spline Surfaces 313 NI 100(u) over Knotfiguration 3 Figure 4. The quadratic normalized B-splines NI 110(u) and NI 200(u) over the six different knotfigurations shown in the previ- ous Figure. NI 200(u) over Knotfiguration 6 NI 100(u) over Knotfiguration 1 NI 200(u) over Knotfiguration 4 NI 100(u) over Knotfiguration 2 NI 200(u) over Knotfiguration 5 314 P. Fong et al. / Multivariate B-Spline Surfaces 3.2. Modelling of Discontinuities Although it is desirable in general to have surfaces that are as smooth as possible, it is necessary for practical applications to be able to model discontinuities like sharp edges or corners as well. It is known from the theory of simplex splines that knot multiplicities along a line reduce the order of continuity along this line21. In the quadratic case for example, a knot configura- tion with four knots on a line will produce a discontinuity along this line while three knots on a line reduce the continuity along this line from to This behaviour is demonstrated by Figure 4 which shows quadratic B-splines over 6 different knot configurations as depicted in Figure 3. 4. Representation of Piecewise Polynomial Surfaces as Linear Combinations of B-splines In order to make a surface scheme useful for practical applica- tions one has to be able to represent as many surfaces as pos- sible by the scheme. In this section we show that polynomial and piecewise polynomial surfaces can be represented as lin- ear combinations of multivariate B-splines and we give explicit formulae for computing this representation. The representation of polynomial surfaces has been worked out elsewhere\" and is repeated here. The representation of piecewise polynomial surfaces is new. A detailed derivation is given elsewhere32. The given formulae have been implemented for quadratics and cubics and are illustrated for the quadratic case by Figure 5 and Figure 6. We recall from Section 2.2 that every polynomial surface F can be represented as a B-patch and that B-patches can be evaluated by the recurrence (7),(8). Our results on the repre- sentation of polynomial and piecewise polynomial surfaces are based upon studying to what extent this recursive evaluation persists for the B-spline scheme. The essential observation can be formulated in the following Lemma that has been proved elsewhere\": Lemma 4.1 Suppose the sequence has the following property. For any two adjacent triangles A( I) and whose common edge is and for with one has Using Lemma 4.1 we can derive an explicit formula for the representation of -continuous piecewise polynomials of degree k as linear combinations of B-splines. Theorem 4.2 Let F be any piecewise polynomial surface of degree k over a given triangulation that is -continuous everywhere, and let be the polar form of the restriction of F to the triangle Then: A full proof of Theorem 4.2 is given elsewhere32. Theo- rem 4.2 implies the following corollary\". Corollary 4.3 Let F be any polynomial of degree k and let f denote its polar form. Then: If then this equation specializes to (15), and hence proves that the normalized B-splines do in fact form a global partition of unity. Theorem 4.2 is illustrated by Figure 5 and by Figure 6. Figure 5 (left) shows a segment of a -continuous quadratic piecewise Bézier surface F over an irregular triangulation T. Using the multiaffine version of the de Casteljau algo- rithms6,25.we have computed the polar form of the restriction of F to every triangle Evaluation of according to equation (17) yields the B-spline control points that are shown in Figure 5 (right). In accordance with Theorem 4.2 the resulting B-spline surface reproduces the original surface exactly. The advantage of converting from Bézier to B-spline rep- resentation is demonstrated by Figure 6: While the movement of a single Bezier control point will generally destroy the conti- nuity of the surface (Figure 6 (left)), a movement of a B-spline control point will also alter the shape of the surface but will pre- serve the smoothness and continuity of the surface throughout (Figure 6 (right)). Another remarkable consequence of Theorem 4.2 should be mentioned here. Recall from Section 2 that a B-spline surface F is a piecewise polynomial over the triangulation induced by its knot net IC. Let be a refinement of this triangulation. Trivially F is a piecewise polynomial over as well. Theorem 4.2 states that F can thus be represented as a B-spline over In other words: Our B-spline scheme allows for subdivision and refinement. At the moment, our practical experience with subdivision is still very limited. Additional research is necessary to exploit the subdivision property in a constructive and computationally efficient way. Then where P. Fong et al. / Multivariate B-Spline Surfaces 315 Figure 5. A quadratic C1 -continuous piecewise polynomial test surface with Bezier control net (left) and B-spline control net (right). Figure 6. Influence of moving a single control point: If a Bezier control point is moved, the C1-continuity of the surface is destroyed, and a sharp edge is introduced (left). If a B-spline control point is moved, the C1-continuity of the surface is preserved (right). 5. Conclusion The B-spline scheme presented in this paper inherits desirable properties from both simplex splines and B-patches and of- fers potential for the design of surfaces over irregular grids. Smoothness, locality and the modelling of discontinuities are inherited from simplex splines, while control points, affine in- variance, and the representation of piecewise polynomials are derived via B-patches. Several recurrence relations are avail- able that allow, e.g., evaluation and differentiation of B-spline surfaces at a given parameter value. In the future we would like to derive additional algo- rithms that allow us to evaluate and differentiate multivariate B-spline surfaces directly from the control points instead of via their blending functions. Such algorithms are unknown for simplex splines but are available for B-patches. It is hoped that these algorithms can be adapted. Such algorithms should also facilitate the conversion from the B-spline representation to the representation as a piecewise Bezier surface. Finally, the benefits of subdivision have to be explored in more detail. 316 P. Fong et al. / Multivariate B-Spline Surfaces The current state of our implementation focuses on the testing of fundamental algorithms rather than the construction of real world objects. In the next step of this implementation we would like to explore the potential of the new B-spline scheme for more realistic data and would like to investigate the benefits of the scheme when dealing with concrete design problems. References 1. Auerbach, S., Gmelig Meyling, R.H.J., Neamtu, M., and Schaeben, H., Approximation and geometric mod- eling with simplex B-splines associated with irregular triangles, Memorandum No. 842, Faculty of Applied Mathematics, University of Twente (1990). Boehm, W., Farin, G. and Kahmann, J., “A survey of curve and surface methods in CAGD,” Computer Aided Geometric Design 1, pp. 1-60 (1984). De Boor, C., “On calculating with B-splines, ” J. Approx. Theory 6, pp. 50-62 (1972). De Boor, C., “B-Form Basics,” in Geometric Modeling, Algorithms and New Trends, SIAM, Farin, G. (ed), pp. De Casteljau, P., Courbes et surfaces a poles, Technical Report, Citroen, Paris (1963). De Casteljau, P., Formes a poles, Hermes, Paris (1985). Catmull, E. and Clark, J., “Recursively generated B- spline surfaces on arbitrary topological meshes,” Com- puter Aided Design 10 , pp. 350-355 (1978) Dahmen, W. and Micchelli, C.A., “On the linear inde- pendence of multivariate B-splines I. Triangulations of simploids,” SIAM J. Numer. Anal. 19, pp. 993-1012 (1982). Dahmen, W. and Micchelli, C.A., “Recent progress in multivariate splines,” pp. 27-121 in Approximation The- ory IV, Chui, C.K., Schumaker, L.L., Word, J.D. (eds), Academic Press, (1983). Dahmen, W., Micchelli, C.A. and Seidel, H.-P., Blos- soming Begets B-Splines Built Better by B-Patches, Re- search Report RC 16261(#72182), IBM Research Divi- sion, Yorktown Heights (1990), accepted for publication in Mathematics of Computation. DeRose, T., Geometric Continuity: A Parameterization Independent Measure of Continuity for Computer Aided Geometric Design, PhD thesis, UC Berkeley (1985). Doo, D. and Sabin, M.A., “Behaviour of recursive di- vision surfaces near extraordinary points,” Computer Aided Design 10, pp. 356-360 (1978). 13. Farin, G.E., Subsplines über Dreiecken, Dissertation, Braunschweig, F.R.G. (1979). 14. Farin, G.E., “Triangular Bernstein-Bezier patches,” Computer AidedGeometric Design 3, pp. 83-127 (1986). 2. 3. 4. 131-148 (1987). 5. 6. 7. 8. 9. 10. 1 1. 12. 15. 16. 17. 18. 19. 20. 21. 22. 23. 24. 25. 26. 27. 28. 29. 30. 31. Gmelig Meyling, R.H.J., Polynomial spline approxima- tion in two variables, PhD thesis, University of Amster- dam (1986). Grandine, T.A., “The computational costs of simplex spline functions,” SIAM J. Numer. Anal. 24, pp. 887-890 (1987). Grandine, T.A., “The stable evaluation of multivariate simplex splines,” Math. Comp. 50, pp. 197-205 (1988). Höllig, K., “Multivariate splines,” SIAM J. Numer. Anal. Loop, C. and DeRose, T.D., “A multisided generaliza- tion of Bezier surfaces,.” ACM Transactions on Graphics Loop, C. and DeRose, T.D., “Generalized B-spline Sur- faces of Arbitrary Topology,” Proc. SIGGRAPH’90, pp. Micchelli, C.A., “On a numerically efficient method for computing with multivariate B-splines,” in Multivariate Approximation Theory, W. Schempp and K. Zeller (eds), Birkhäuser, Basel, pp. 21 1-248 (1979). Micchelli, C.A., “A constructive approach to Kergin in- terpolation in Multivariate B-splines and Lagrange interpolation,” Rocky Mountain J. Math. 10, pp. 485-497 (1980). Peters, J., Fitting smoothparametric surfaces to 3D data, PhD thesis, University of Wisconsin, Madison (1990). Ramshaw, L., “Beziers and B-splines as multiaffine maps,” pp. 757 - 776 in Theoretical Foundations of Com- puter Graphics and CAD, Springer (1988). Ramshaw, L., “Blossoms are polar forms”, Computer Aided Geometric Design 6, pp. 323-358 (1989). Riesenfeld, R.F., Applications of B-spline Approxima- tion to Geometric Problems of Computer Aided Design, PhD Dissertation, Syracuse University (1973). Sabin, M.A., The Use of Piecewise Forms for the Numer- ical Representation of Shape, Ph.D. Dissertation, Hun- garian Academy of Sciences, Budapest (1976). Sabin, M.A., “Non-rectangular surface patches suitable for inclusion in a B-spline surface”, in Proc. Europraph- ics ’83, P. ten Hagen (ed), pp. 57-69, North-Holland (1983). Seidel, H.-P., “Symmetric recursive algorithms for sur- faces: B-patches and the de Boor algorithm for poly- nomials over triangles,” Constructive Approximation 7, Seidel, H.-P., “Algorithms for B-patches,” in Proc. Graphics Interface ’91, Morgan Kaufmann Publishers, Palo Alto, California, pp. 8-15 (1991). Seidel, H.-P., “Polar Forms and Composite Surfaces,” in: Blossoming: The New Polar-Form Approach to Spline Curves and Surfaces, SIGGRAPH’91 Course Notes #26, 19, pp. 1013-1031 (1982). 8(3), pp. 204-234 (1989). 347-356 (1990). pp. 257-279 (1991). ACM SIGGRAPH 8.1-8.52 (1991). P. Fong et al. / Multivariate B-Spline Surfaces 32. Seidel, H.-P., Representing piecewise polynomials as 33. Traas, C.R., “Practice of bivariate quadratic simplicial splines,” in Computation of Curves and Surfaces, Dah- men, W. et al (eds), NATO ASI Series, Kluwer Academic Publishers, Dordrech, pp. 383-422 (1990). 317 linear combinations of multivariate B-splines, preprint, Waterloo ( 199 1 ) .","libVersion":"0.3.2","langs":""}