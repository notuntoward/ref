{"path":"lit/lit_sources/Munkhammar17AutocorrelationbasedCopulaModel.pdf","text":"Contents lists available at ScienceDirect Solar Energy journal homepage: www.elsevier.com/locate/solener An autocorrelation-based copula model for generating realistic clear-sky index time-series Joakim Munkhammar⁎, Joakim Widén Built Environment Energy Systems Group, Department of Engineering Sciences, Uppsala University, SE- 751 21 Uppsala, Sweden ARTICLE I NFO Keywords: Clear-sky index Autocorrelation function Copula modeling Probability distribution modeling ABSTRACT This study presents a method for using copulas to model the temporal variability of the clear-sky index, which in turn can be used to produce realistic time-series of photovoltaic power generation. The method utilizes the autocorrelation function of a clear-sky index time-series, and based on that a correlation matrix is set up for the dependency between clear-sky indices at N time-steps. With the use of this correlation matrix an N-dimensional copula function is conﬁgured so that correlated samples for these N time-steps can be obtained. Results from the copula model are compared with the original data set and an uncorrelated model based on zero correlated clear- sky index data in terms of distribution, autocorrelation, step changes and distribution. The copula model is shown to be superior to the uncorrelated model in these aspects. As a validation the model is tested with solar irradiance for two diﬀerent geographical regions: Norrköping, Sweden and Hawaii, USA. The copula model is also applied to a set of bins of daily mean clear-sky index and the use of bins is shown to improve the results. 1. Introduction The variability of solar irradiance on Earth’s surface has an eﬀect on many solar engineering applications, in particular those involving photovoltaic (PV) power generation (Lave et al., 2012; Bollen and Hassan, 2011; Kleissl, 2013; Widén, 2015). By quantifying the solar irradiance variability, it is possible to improve the design and operation of power systems where large amounts of distributed PV power might be injected into the grid (Bollen and Hassan, 2011; Widén, 2015; Lave et al., 2015). This is useful in order to avoid costly grid reinforcements (Bollen and Hassan, 2011; Holttinen et al., 2008). When high resolution data on solar irradiance is not available for certain time periods, or geographical locations, models that generate synthetic data can be useful (Bright et al., 2015). This paper extends the literature with a synthetic irradiance generator, based on a statistical method which has previously only been applied to spatial solar correlation modeling. Solar irradiance, normalized via the clear-sky irradiance to the clear-sky index, has interesting variability on minute to instantaneous scale (Bright et al., 2015) and for such resolution the clear-sky index distribution can be modeled as a probability distribution with typically two or three peaks (Hollands and Huget, 1983; Hollands and Suehrcke, 2013; Munkhammar et al., 2015a; Widén et al., in press-a). Studies on clear-sky index ramp rates, and general temporal variability, include Markov-chain modeling (Bright et al., 2015), neural network modeling (Voyant et al., 2011) and pure sampling from probability distributions (Munkhammar et al., 2015a,b). Models vary in terms of input data complexity from utilizing cloud size, coverage and morphology (Bright et al., 2015; Smith et al., 2017) to analysis of the clear-sky index time- series (Munkhammar et al., 2015a,b; Munkhammar et al., 2017). A challenge is to not only obtain an accurate probability distribution, but to obtain a realistic synthetic time-series of the clear-sky index as well (Bright et al., 2017). These methods are intended to complement, and at best, improve on existing irradiation estimates from software, such as Meteonorm (2017), or irradiance from satellite data, see e.g. Engerer et al. (2017). In terms of time-series realism, autocorrelation is a useful measure. Autocorrelation of the clear-sky index has been studied previously for instantaneous irradiance (Brinkworth, 1977; Skartveit and Olseth, 1992; Aguiar and Collares-Pereira, 1992; Hansen et al., 2010) and for step-changes as well (Hansen et al., 2010), where the autocorrelation function is positive and follows an exponential slope for hour resolution (Skartveit and Olseth, 1992; Aguiar and Collares-Pereira, 1992; Hammer and Beyer, 2013), while it has also shown negative values for minute resolution (Hansen et al., 2010; Perez et al., 2012). Models utilizing the autocorrelation of the clear-sky index include Brinkworth (1977), auto-regressive Gaussian (Aguiar and Collares-Pereira, 1992), neural networks (Voyant et al., 2011) and fractal cloud modeling (Lohmann et al., 2017). So-called clear-sky index generators are useful, since they use some existing data set of, e.g., lower resolution or averaged clear-sky index data to estimate higher resolution data http://dx.doi.org/10.1016/j.solener.2017.09.028 Received 22 June 2017; Received in revised form 5 September 2017; Accepted 13 September 2017 ⁎ Corresponding author. E-mail addresses: joakim.munkhammar@angstrom.uu.se (J. Munkhammar), joakim.widen@angstrom.uu.se (J. Widén). Solar Energy 158 (2017) 9–19 0038-092X/ © 2017 Elsevier Ltd. All rights reserved. MARK (temporal or spatial), see e.g. Bright et al. (2015, 2017), Wegener et al. (2012), Ngoko et al. (2014), and Grantham et al. (2017). Autocorrela- tion functions of clear-sky index step changes have also been used in so- called virtual networks to study the variability of spatially distributed ﬂeets of PV plants, see (Widén, 2015). This indicates that the auto- correlation function might be useful for both temporal and spatial solar irradiance studies. Regarding spatial solar irradiance variability, copulas have been used to model the variability of solar irradiance in a spatial network (Munkhammar et al., 2017; Munkhammar and Widén, 2016). Copula modeling, being a multivariate statistical method for simulating cor- related stochastic variables, is an increasingly common method for modeling correlation between stochastic variables (Nelsen, 2006). It has been used and described in studies of for example electric vehicle charging (Lojowska et al., 2012), wind power (Hagspiel et al., 2012), wave power (Li et al., 2016) and spatial solar irradiance variability (Munkhammar et al., 2017; Munkhammar and Widén, 2016). This study develops an autocorrelation-based copula model for generating synthetic clear-sky index data, including the development of a model for generating synthetic clear-sky index data for binned daily mean clear-sky index levels. A copula-based model for quantifying the temporal variability of the clear-sky index on binned daily mean clear- sky index has not been done previously. The clear-sky index generator is, in similarity with for example (Skartveit and Olseth, 1992), based on utilizing only time-series as input. The model extends this type of modeling with more extensive autocorrelation statistics. Daily clear-sky index bins have been used in other studies for gen- erating synthetic clear-sky index data, in particular (Ngoko et al., 2014). In this paper the model simulations, and input data set, are based on minute resolution, where 120 min of each day for 365 days are used. General copula modeling and its application to temporal solar irradiance modeling is introduced in Section 2.2. This study continues the work on correlation modeling of the clear- sky index in Munkhammar and Widén (2017), Munkhammar et al. (2017), and Munkhammar and Widén (2016), where the latter two studies presented models on spatial variability in the clear-sky index by using copulas and a spatiotemporal data set of the clear-sky index. If spatial modeling of solar irradiance is modeled under virtual network assumptions, generated from temporally shifted time-series based on cloud advection velocity, this model could also directly be used for spatial irradiance variability studies. This paper is organized as follows. In Section 2 the methodology and data are presented, in Section 3 the results are presented and in Section 4 the results are discussed in a wider context. 2. Methodology The methodology is organized so that the clear-sky index and an algorithmic description of the method is presented in Section 2.1, the copula modeling in Section 2.2, the goodness-of-ﬁt statistic used in this study is presented in Section 2.3, the variability index is presented in Section 2.4 and the data set is presented in Section 2.5. 2.1. The clear-sky index In order to focus on the temporal variability of instantaneous solar irradiance, the clear-sky index is used. Formally, the clear-sky index κ is deﬁned as the ratio between the measured global horizontal irradiance (GHI) G t() and the estimated global horizontal clear-sky irradiance G t( )c over time t: ≡κ t Gt Gt () () () . c (1) The temporal copula model developed in this paper is based on the assumption that the clear-sky index is not dependent on time of day or season. This assumption can be contested, see for example (Smith et al., 2017). However, for expected time of day or seasonal variability in clear-sky index time series, bins of clear-sky index for time of day or season might be used instead. Generally, throughout this study, it is assumed that the time-series of the clear-sky index is approximately stationary, a property of time- series which means that the joint probability distribution of a set of equivalently separated data points in a time-series does not change over time (Koopmans, 1995). If the clear-sky index is not expected to be stationary, the use of bins for speciﬁc time-periods, as mentioned, could perhaps improve this. Since the clear-sky index is primarily deﬁned only during daytime, when >G t() 0c , there is a maximum length of each daily vector of consecutive points of the clear-sky index. In order to have suﬃcient data for modeling this prompts the use of clear-sky index for a number of days (all days in a year in this study), each with the same length vector. Time, t, has resolution of minutes in this study. Based on the assumption that the clear-sky index time-series for each day is stationary and a data set of clear-sky index for a number of days is available, the main model of the paper is based on the following algorithmic steps, where the copula modeling steps are described in detail in Section 2.2, see also (Munkhammar et al., 2017; Munkhammar and Widén, 2016; Nelsen, 2006) for more information. 1. Obtain a clear-sky index data set for N data points on M days, thus generating an ×NM data set. 2. Estimate the autocorrelation function of the clear-sky index for each day, generating a data set of size ×NM . 3. Compute the mean autocorrelation function, for N steps, over all M days, generating a vector of the mean autocorrelation function of size N. 4. Deﬁne a correlation matrix, of size ×NN , from the N mean auto- correlation function values. 5. Deﬁne a copula based on the empirical distribution of the clear-sky index data set for N data points on all M days and the autocorrela- tion-based correlation matrix. 6. Generate, with the copula model, M number of synthetic correlated clear-sky index time-series with N data points each. The concepts of these steps will be clariﬁed, in a formal sense, in the following section. The proposed copula model is validated by com- paring the synthetic copula-generated data sets with: • Original clear-sky index data set of daily time-series. (The data set.) • Generated uncorrelated daily data sets of clear-sky index time- series. (The uncorrelated model.) The latter of these, the generated uncorrelated clear-sky index time- series, is the special case of the copula model with zero autocorrelation for non-zero lag, rendering the correlation matrix an identity matrix. This model is equivalent to a model of random sampling of the clear-sky index probability distribution and will generally be called the un- correlated model in this study, since it lacks temporal correlation, which makes it equivalent to conventional probability distribution clear-sky index models (similar to the models used in e.g. Hollands and Suehrcke (2013) and Munkhammar et al. (2015a)). In spatial correlation mod- eling, the uncorrelated model was studied in for example (Munkhammar et al., 2017). In addition to applying the copula model to mean autocorrelation function over all days (in step 3), a copula model is made for each bin of daily mean clear-sky index as well. The daily mean clear-sky index (calculated for the =N 120 data points for each day) was binned in ﬁve bins equally separated on the interval [0,1]. Then a mean autocorrela- tion function for the clear-sky index was obtained for all days within each bin. The algorithmic steps were then performed for each binned data set. In terms of machine learning, it is customary to divide up training J. Munkhammar, J. Widén Solar Energy 158 (2017) 9–19 10 and testing data sets. This was tested by dividing up half of the input data set into training data, and using the other half for testing it against, the results from this is presented in Section 3. The conclusion was that dividing up into training and testing data set essentially merely gave a shorter sample of days to use for both training and testing (and thus mainly higher variability when comparing results). 2.2. Temporal copula modeling of the clear-sky index This section describes the formal copula modeling of the clear-sky index time-series. It is introduced for the general case along with how the modeling is applied to the clear-sky index in this study. Copula modeling is a statistical framework based on the concept that correlated samples from a given number of stochastic variables, which have a dependency that is reﬂected in the correlation between variables, can be modeled via a so-called copula. The idea is that the joint distribution function of the variables can be expressed by a copula joining the univariate marginal distributions. An N-variable copula is used in this paper, and it models the de- pendency between N stochastic variables by generating sets of N cor- related values for each stochastic variable based on their marginal distribution. For this paper the distributions are all of the same type: each is the empirical clear-sky index distribution (from the entire data set). Formally, it is common to use the so-called inversion method for sampling values from a copula and marginal distributions, this is also used in this paper. This method is brieﬂydeﬁned as follows (Nelsen, 2006, p. 51), with comments on how it is applied in this study. Assume N stochastic variables …XX X,, , N12 with given cumulative distribution functions (CDFs) …FF F,, ,XX XN12 . In this case X1 represents the stochastic variable of one single time-step, and X2 the stochastic vari- able of another time-step, etc. The main point is to model the de- pendency between temporally separated time-steps in a time-series, and that this variability is universal for any set of such points in the time- series, since the time-series is considered approximately stationary. =N 120 consecutive data points (a series) are modeled in this study. There is, however, in principle no requirement of the model for using consecutive time-steps. Based on this setup, if we recall Sklar’s theorem, which certiﬁes the existence of a copula, see Nelsen (2006), these distributions can be joined via a copula C if the copula can be expressed as: …= ……FX X X C F x F x F x(, , , ) ( ( ), ( ), , ( )).XX X N X X X N,, , 1 2 1 2N N12 12 (2) The copula function can be written: …= …… −− −Cu u u F F u F u F u(, , , ) ( ( ), ( ), , ( )).NX X X XX X N12 , , , 1 1 1 2 1 N N12 12 (3) for == …Fx u i N() , 1,2,,Xi ii , where …u uu,, , N12 are realizations of uni- form variables …UU U,, , N12 . A special case is a copula with two stochastic variables X1 and X2: a bivariate copula. Such a copula would, in this study, correspond to modeling the dependency between a single pair of time-steps, and be represented by a copula function C: = −−C u u F Fu Fu(, ) ( ( ), ( )).XX XX12 , 1 1 1 212 12 (4) The key to setting up a copula function is to have a correlation matrix which expresses the correlation between the stochastic variables. Such a matrix is by necessity square. In this case, the correlation matrix is generated from a time-series of the clear-sky index with N data points. This correlation matrix is based on the mean autocorrelation function of the clear-sky index, over all days, according to step 3 in the algorithm. For the binned scenarios, the mean autocorrelation of the binned days is used instead. In formal terms the autocorrelation function for n steps can be deﬁned as An( ) for a lag of n steps ( =n 0 represents zero-lag autocorrelation). For a data set with N number of data points yi, mean value y and standard de- viation σ the autocorrelation function An( ) for lag n is deﬁned as (Box et al., 2016): ∑=− − = − −An σN yy y y() 1 ()( ). t Nn tt n 0 (5) It should be noted that estimates of the autocorrelation function are only reasonable for n up to approximately N /4, see Box et al. (2016, p. 31). In this study the autocorrelation function is used up to and in- cluding =nN in the modeling, but the interpretation of the results might only be reasonable up to N /4. The temporal correlation matrix in this study, incorporating the correlation between the set of consecutive time-steps, becomes an au- tocorrelation matrix with elements based on An( ),deﬁned according to (Hayes, 1996): = ⎛ ⎝ ⎜ ⎜ ⎜ ⋯− ⋯− ⋮⋮ ⋱ ⋮ −− ⋯ ⎞ ⎠ ⎟ ⎟ ⎟ ρ AA A n AA A n An An A (0) (1) ( 1) (1) (0) ( 2) (1) (2) (0) , (6) which is symmetric, with elements =A (0) 1. This matrix is used as correlation matrix in copula-modeling, see Munkhammar et al. (2017) and Munkhammar and Widén (2016) for more information relating to the clear-sky index application. See Fig. 1 for a schematic illustration of the modeling and the proposed autocorrelation concept. The next key step in copula modeling is the choice of distribution for each stochastic variable to be correlated by the copula. In this case the empirical distribution of the clear-sky index (for all days and all time- steps of the data set) is chosen. For the binned scenarios, the empirical distribution of the clear-sky index for the binned days was used. The copula itself is based on a separate distribution, the type of which has to be set a priori in the modeling, but since this is the ﬁrst study of its kind, by temporally modeling the clear-sky index, the commonly used normal distribution, i.e. Gaussian copula, conﬁguration was chosen. The copula modeling with input data set of binned daily clear-sky index values works equivalent to the case with the whole year clear-sky index data, only reduced amounts of data are used. The model developed in this paper was implemented in MATLAB, and the functions autocorr for the autocorrelation function, and Fig. 1. An illustration of the copula-based autocorrelation method developed in this study. On the left the process of the modeling is presented and on the right the auto- correlation modeling concept is presented. Elements of the correlation matrix ρ are obtained from the autocorrelation function of the clear-sky index. J. Munkhammar, J. Widén Solar Energy 158 (2017) 9–19 11 copularnd for the copula random number generator, were used. 2.3. Kolmogorov-Smirnov goodness-of-ﬁt test statistic In this study the Kolmogorov-Smirnov (K-S) test statistic was used to determine probability distribution goodness-of-ﬁt. This is a commonly used estimate to quantify the similarity between two probability dis- tributions. The test statistic S is based on the maximum deviation be- tween two distributions (Conover, 1999): =−SF x F xmax | () ()| x 12 (7) where Fx( )1 and Fx()2 are empirical (or analytical) cumulative dis- tribution functions. Here K-S test statistics are used to estimate the goodness-of-ﬁt for the resulting aggregate clear-sky index distributions from data and simulations. This type of measure has been used in previous studies as well, for example in probability distribution mod- eling (Munkhammar et al., 2015a) and power generation and grid in- teraction (Munkhammar et al., 2015b). For this study the Matlab function kstest2 was used. 2.4. Variability index In order to test the variability in the output from the correlated and uncorrelated models compared with the data set, the variability index was used. This is deﬁned as (Stein et al., 2012): = −− + −− + VI Gt Gt t Gt Gt t (( ) ( 1)) Δ (( ) ( 1)) Δcc 2 2 (8) where tΔ is the time interval resolution, over which G and Gc are averaged. 2.5. Data set The data used for this study is based on radiometer measurements of global horizontal irradiance for one year (2008) obtained from the Swedish Meteorological and Hydrological Institute (SMHI) for Norrköping, Sweden ( ° ′ ″5935 31 N ° ′ ″1711 8 E) (Swedish Meteorological and Hydrological Institute, 2008). The clear-sky index was calculated with estimates of the clear-sky irradiance, obtained from the Ineichen- Perez model (Ineichen and Perez, 2002). In order to avoid low solar angles (leading to singular clear-sky index), while maintaining the same amount of time-step data per day (a necessity of the model), 120 data points (min) per day (centered around noon each day) were used. The end points (at 11am and 13 pm) of the daily data set corresponded to solar elevation angles of 47 and 54 degrees during summer solstice, 3 and 7 degrees during winter solstice. This totals 43′800 ( ×120 365) data points of clear-sky index data, which generates a ×120 120 autocorrelation matrix. The simulations of the models were also set to generate ×= ′120 365 43 800 data points. In the simulations for binned data the binned number of data points was used in the simulations, see Table 1. The data set on solar irradiance for model validation from the National Renewable Energy Laboratory (NREL) radiometer array in Hawaii, USA, is presented in Sengupta and Andreas (2010), and is described in detail in Munkhammar et al. (2017) along with the clear- sky irradiance model McClear (Soda-service, 2016) used for this loca- tion. 3. Results In Fig. 2 the distribution, autocorrelation function and step-change distribution for the clear-sky index data set, the copula model simula- tion and the uncorrelated model simulation are presented. Here step- change distribution is deﬁned as the distribution of the diﬀerence be- tween each pair of adjacent clear-sky index data points. As a check for consistency in the modeling, the clear-sky index generated by the models should be similar compared with the original data set, which appears to be the case when inspecting the histograms of the original data set and 43’800 simulated data points from each model, presented in subplots (A)–(C). In subplot (D) the copula model is shown to follow the autocorrelation function closely, in particular when compared with the uncorrelated model. This can also be compared with results from the Skartveit and Olseth one lag autocorrelation model (Skartveit and Olseth, 1992). The resulting autocorrelation in that model showed declining autocorrela- tion function over time as well. Additionally, it also showed a model output in autocorrelation which had generally lower autocorrelation values than that of the data set. Their autocorrelation studies were limited in time-lag to ten minutes, so no comparison on negative au- tocorrelation values for larger time lags could be made. The discrepancy between the input (data set) and the output (copula model) autocorrelation is some artifact of the copula modeling, prob- ably because the linear autocorrelation as deﬁned in Eq. (5) is not preserved during inverse sampling, which could be diﬀerent if rank correlations were used instead. This is left as an open issue for further investigation. Subplots (E–G) represent step-changes, and the copula model (F) is closer to the data set for step-changes compared with the uncorrelated model (G). In subplot (H) the mean variability index over diﬀerent time-spans is presented. The variability of the copula model is higher than that of the data set, but considerably lower than that of the uncorrelated model for all time-spans. In terms of relative K-S test statistics, deﬁned here as the ratio of K-S test statistics, the ratio of the test statistic of uncorrelated model output to the data set and correlated output to the data set, for step-changes, is 1.28. This means that the maximum deviation in clear-sky step-change index CDF from the uncorrelated model is reduced by a factor of 1.28 with use of the copula model. As a comparison, the data set was divided into training data and testing data, by using the ﬁrst 183 days of the year as training data, and the last 182 days as testing data. The results are presented in Fig. 3. Subplot (A) represents a histogram of the clear-sky index from the testing data set, and subplot (B) represents a histogram of the copula model on the training data set. Although there are some diﬀerences in the clear-sky index data histograms, a K-S test statistic of 0.12 was computed, which is as a reference on par with distribution modeling, c.f. Munkhammar et al. (2015a) and Munkhammar and Widén (2016). In subplot (C) the mean autocorrelation function of the testing data set and of the copula model (on the training data set) are presented. Compared with the autocorrelation plots for the full data set Fig. 2, there are only small deviations, likely caused by ﬂuctuations of a smaller data set. In Fig. 4 the mean autocorrelation function for the (complete) data set and for the copula model output is given along with the auto- correlation function for N data points on each of the 365 days in the data set. Results show that the copula model appears to capture the autocorrelation features of the clear-sky index, while the uncorrelated model is less accurate. Considering the non-correlated case in Fig. 3C, we observe despite the completely uncorrelated time-series generated by the uncorrelated model, that there is a span of non-zero auto- correlation functions for each day evident in the ﬁgure. This is an Table 1 Daily clear-sky index interval, number of days and number of data points for the binned scenarios. Daily mean CSI Days Data points <<0 CSI 0.2 46 5′520 <<0.2 CSI 0.4 82 9′840 <<0.4 CSI 0.6 52 6′240 <<0.6 CSI 0.8 62 7′440 <<0.8 CSI 1.0 51 6′120 J. Munkhammar, J. Widén Solar Energy 158 (2017) 9–19 12 artefact of applying the autocorrelation function to the 120 generated points of each day, since this will cause daily variability of the auto- correlation function due to random ﬂuctuations, which on average is zero. That is, 120 randomly sampled data points will make for a form of random autocorrelation function, which creates a unique autocorrela- tion function each day, which accumulates a span of autocorrelation functions over all days that on average is zero. It is interesting that the mean autocorrelation function for both the data set and the copula model show negative values. It should be noted that, as was mentioned in Section 2.2, the autocorrelation function of a data set of N points is only reasonable up to about =nN /4, which in this case becomes =n 30. However, the mean autocorrelation is Fig. 2. Subplots (A–C) represent histograms of the clear-sky index, for (A) the data set, (B) the copula model simulation and (C) the uncorrelated model simulation. Subplot (D) represents the autocorrelation function for the data set and the two model simulations. Subplots (E–G) represent histograms of step changes of (E) the data set, (F) the copula model si- mulation and (G) the uncorrelated model simulation. Subplot (H) re- presents the variability index for diﬀerent time-steps. Fig. 3. Subplot (A) represents a histogram of the clear-sky index from the testing data set, and subplot (B) represents a histogram of the co- pula model of the training data set. Subplot (C) represents the mean autocorrelation for the testing data set and the copula model (on the training data set). J. Munkhammar, J. Widén Solar Energy 158 (2017) 9–19 13 negative even at =n 30. Negative values of the autocorrelation function has been obseved, in e.g. Perez et al. (2012). More studies on the au- tocorrelation of the clear-sky index, for various time-scales and even spatial dispersion (under assumption of the validity virtual network modeling), such as Ngoko et al. (2014), could assist in determining this. The sorted (ascending) mean clear-sky index level each day (each 120 point data set) can be seen in Fig. 5 for the data set, the copula model simulation and the uncorrelated model simulation. Although the copula model yields a result that is closer to the data set than the un- correlated model the copula model does not entirely capture the variability in daily mean clear-sky index. It shows that although the copula generated model simulation closely represents the clear-sky index data set in terms of mean autocorrelation and variability, as seen in Fig. 4, this variability is restricted to each day and not spread out over days with diﬀerent mean clear-sky index, as in the original data set.As an attempt to improve this result, copula modeling of bins of mean daily clear-sky irradiance was carried out. These results are presented in Section 3.2. 3.1. Validation with diﬀerent irradiance data set In order to validate the model for use on data from diﬀerent geo- graphical regions a data set on solar irradiance from NREL’s Hawaii solar radiometer network was used (Sengupta and Andreas, 2010). The same conﬁguration of the data set was used, with minute resolution (the Hawaii data was averaged from second resolution to minute re- solution) and 120 consecutive data points centered around noon on each day for 365 days. The clear-sky model used for this was the McClear clear-sky index model (Soda-service, 2016), the same as was used in Munkhammar et al. (2017) for spatial correlation modeling with the same data set of solar irradiance. The results in terms of probability distribution, autocorrelation, step-change distribution, variability index and sorted daily clear-sky index is shown in Fig. 6. The results show that there are qualitative diﬀerences between the probability distribution of the clear-sky index compared with the Norrköping data, but that the model reproduces this properly. The autocorrelation function, step-change distributions, variability index and sorted daily mean clear-sky index all appear similar to the results using the Norrköping data. Subtle diﬀerences are, for example, the magnitude of the variability index, and the slope of the sorted mean Fig. 4. The autocorrelation function over time for each day for (A) the data set, (B) the copula simulation and (C) the uncorrelated model. The red line in each subplot represents the mean autocorrelation function for each minute over all the 365 days measured and simulated data. 0 50 100 150 200 250 300 350 Days 0 0.2 0.4 0.6 0.8 1 1.2Sorted mean CSI Data Copula model Uncorr. model Fig. 5. Sorted (ascending) daily mean (over 120 data points) clear-sky index for the data set, the copula model simulation and the uncorrelated model si- mulation. J. Munkhammar, J. Widén Solar Energy 158 (2017) 9–19 14 daily clear-sky index data. The latter is an eﬀect of the diﬀerence in climate at Hawaii, USA, being less variable in terms of mean daily clear- sky index. 3.2. Binned daily clear-sky index model In this section we will present results for modeling the clear-sky index for a set of bins of daily mean clear-sky index levels. See Table 1 for a list of bins, number of days and the number of data points for each bin. In subplots (A–E) in Fig. 7 the clear-sky index distribution for each bin of mean clear-sky index is presented for both the data set and the copula model, and in subplot (F) a diagram of K-S test statistics for each bin is presented (between data set and model). By visual inspection the probability distributions are similar to the data set, which is further veriﬁed by the K-S test statistics, where all models are below 0.016 in K- S test statistic. These distributions also ﬁt well with previous in- vestigations, such as Widén et al. (in press-a) and Smith et al. (2017), regarding other data sets of solar irradiance. See (Widén et al., in press- a) for more information on the probability distribution characteristics of the clear-sky index for these particular bins. The use of diﬀerent copula distribution or rank correlations could be Fig. 6. Figure on model output using solar irradiance from Hawaii, USA. Subplots (A–C) represent histograms of the clear-sky index, for (A) the data set, (B) the copula model simulation and (C) the uncorrelated model si- mulation. Subplot (D) represents the autocorrelation function for the data set and the two model simulations. Subplots (E–G) represent histograms of step changes of (E) the data set, (F) the copula model simulation and (G) the uncorrelated model simulation. Subplot (H) represents the variability index for diﬀerent time-steps. Finally subplot (I) represents sorted (as- cending) daily mean (over 120 data points) clear-sky index for the data set, the copula model simulation and the uncorrelated model simulation. Fig. 7. Histograms of the data set and from simulations of the copula model in each bin of daily clear-sky index in subplots (A–E) and a K-S test statistic in subplot (F). J. Munkhammar, J. Widén Solar Energy 158 (2017) 9–19 15 interesting to investigate further. In Fig. 8 the autocorrelation function for each binned data set and for the copula model is shown. The mean autocorrelation function for each bin show a similar slope with some smaller variations, all slopes include negative values. The autocorrelation function shape appears to be essentially universal regardless of mean clear-sky index level, in- dicated by both data and model. These represent data for 46 days (the smallest available binned data set number was used for all), which means that there could be additional features in the autocorrelation for larger data sets. In similarity with the mean autocorrelation plot in Fig. 4, only autocorrelation up to N /4 (for N being the total number of autocorrelation steps), can be considered statistically reliable, still at 30 points most autocorrelation functions of binned data show negative values. By visual inspection the autocorrelation functions of the copula model ﬁts the autocorrelation function of the data sets, with an ap- parent model underestimate in correlation for lower number of minutes lag and an overestimate in correlation for larger number of minutes lag. The sorted mean daily mean clear-sky index for diﬀerent clear-sky index bins is shown in Fig. 9. In comparison with Fig. 5, which pre- sented the sorted daily mean clear-sky index for the whole data set and the copula model, the sorted mean daily clear-sky for each bin is con- siderably improved for each bin. The number of days chosen for each bin was again the same as for the bin with the lowest number of days (46), see Table 1. In order to show the output of the model, in terms of clear-sky index, a set of six consecutive 120-min consecutive time-series sessions of clear-sky index is given in Fig. 10. In this case the data set for each session is chosen from a random day of clear-sky index and the mean clear-sky index of that day was used in the copula model to generate bin-speciﬁc synthetic clear-sky index data to match that. This is also compared with the output of the uncorrelated model. The variability of the clear-sky index generated by the copula model reproduces the original data set, at least to a higher degree than the uncorrelated model. Even though the trend of rising or falling CSI 0 50 100 Minutes -0.2 0 0.2 0.4 0.6 0.8 1Autocorrelation (A) Data set Copula model 0<CSI<0.2 0 50 100 Minutes -0.2 0 0.2 0.4 0.6 0.8 1Autocorrelation (B) Data set Copula model 0.2<CSI<0.4 0 50 100 Minutes -0.2 0 0.2 0.4 0.6 0.8 1Autocorrelation (C) Data set Copula model 0.4<CSI<0.6 0 50 100 Minutes -0.2 0 0.2 0.4 0.6 0.8 1Autocorrelation (D) Data set Copula model 0.6<CSI<0.8 0 50 100 Minutes -0.2 0 0.2 0.4 0.6 0.8 1Autocorrelation (E) Data set Copula model 0.8<CSI<1.0 Fig. 8. The autocorrelation function for the data set and simulations with the copula model for each bin of daily clear-sky index in subplots (A–E). 5 1015202530354045 Days 0 0.2 0.4 0.6 0.8 1Sorted mean CSI Data set Copula model 0.8<CSI<1.0 0.6<CSI<0.8 0.2<CSI<0.4 0.4<CSI<0.6 0.0<CSI<0.2 Fig. 9. Sorted daily mean clear-sky index for the data set and the copula model for each bin. J. Munkhammar, J. Widén Solar Energy 158 (2017) 9–19 16 during each session seems to be followed by certain sessions, such as in particular the 480–600 session, this is likely a coincidence, since other sessions such as 0–120 and 600–720, have similar variability but misses the trend. It would be interesting to see how this performs against more so- phisticated distribution selection guided by meteorology hours (Bright et al., 2017) and perhaps with Markov models, such as Ngoko et al. (2014). As an application example, the solar irradiance of day 134 (a random partly cloudy day containing several types of bins) in the data set is presented together with copula model simulations in Fig. 11. The copula model simulation is based on known mean clear-sky index (known bin) for each 120-min session. The data set for solar irradiance is shown in subplot (A) along with estimated clear-sky irradiance weighed with the clear-sky index from the copula model (for each two hour bin) and a subplot (B) which shows the total mean irradiance per hour (in terms of kWh/h). The data on solar irradiance is reproduced by the copula model simulations, with some inherent smaller diﬀerence in variability. As the model is run, selecting a binned copula model for the mean clear-sky index level, the variability in total irradiance varies, and the variability is inherent to the bin width (here 0.2 clear-sky index points). A larger data set and more narrow bin width could possibly help bring higher accuracy in this modeling. 4. Concluding discussion This paper presented a general method for using copulas to model the temporal variability, and to produce a realistic time-series of the clear-sky index. Results show that the copula model simulation pro- duces a clear-sky index time-series which, in terms of step-changes, autocorrelation and daily mean clear-sky index variability shows su- perior realism, compared to the uncorrelated model simulations. Testing the copula model on a solar irradiance data set from Hawaii, USA, representing a vastly diﬀerent geographic location and climate than Norrköping, Sweden, showed that the results are essentially equivalent in terms of accuracy and applicability. A copula model for diﬀerent daily clear-sky index bins was also presented, and it was shown to be more accurate than the model without binned mean clear- sky index data. A purely theoretical conﬁguration of the temporal copula model using synthetic clear-sky index modeling and analytic autocorrelation 0 100 200 300 400 500 600 700 Minutes 0 0.5 1 1.5CSI Uncorr. model Copula model Data set Fig. 10. Two hour sessions of clear-sky index from the data set, corre- spondingly binned copula model simulations and uncorrelated simulations (without bins). Each two hour session is separated with a vertical black line. Fig. 11. Example of clear-sky index for day 134 (a random partly cloudy day containing several types of bins) in the data set compared with simulated binned data from copula model simulations in terms of power in subplot (A) and energy in subplot (B). The coloring of data in subplot (B) is based on one color for the data set and one color for the copula model simulations and an overlapping color. (For interpretation of the references to color in this ﬁgure legend, the reader is referred to the web version of this article.) J. Munkhammar, J. Widén Solar Energy 158 (2017) 9–19 17 function estimates could help improve the applicability of the model. Such a study would be similar to Munkhammar and Widén (2016) compared with Munkhammar et al. (2017). Given theoretical clear-sky index distributions and autocorrelation functions, such as the ones proposed by Widén et al. (in press-a, in press-b), which appear to be universally applicable to any geographic region when properly parameterized, e.g., to the daily clear-sky index, it is possible to apply and validate the correlated outputs of the model with comparatively small amounts of data on solar irradiance for that location. In that way unlimited synthetic clear-sky index data could be obtained from a small data set of measured solar irradiance for any given location. Generally, this method is useful for generating realistic synthetic clear-sky index time-series, which in turn, with the aid of an appro- priate PV power generation model can be used to generate realistic synthetic PV power generation time-series. See Munkhammar and Widén (2016) for a simple combination of methods that can generate synthetic PV power generation on arbitrarily oriented PV system based on synthetic clear-sky index time-series. This, in turn, could be useful for grid-integration studies, where probabilistic load-ﬂow calculations potentially could be complemented with a synthetic time series of PV power generation. Since copula modeling of spatially dispersed PV power generation was recently shown to improve estimates for grid simulations, in Widén et al. (in press-b), the use of temporal copula modeling could prove useful as well. Generally, applying this type of temporal copula modeling to dif- ferent clear-sky index data sets, including for diﬀerent locations or re- solution, could be interesting. In such investigations, comparing the methodology with existing software, such as Meteonorm (2017), could be interesting to pursue in order to properly quantify applicability of temporal correlation modeling. In terms of applicability, the eﬀect of changing the number of bins, and consequently the bin width, could be interesting to investigate as well. That could provide valuable insights into potentially universal statistical, and then modeling, properties regarding solar variability. One example is the slope of temporal correlation, and whether or not that generally has negative values for minute (or higher) resolution. Also, since the modeling is general, it could be used to model the temporal variability of any general time-series, such as for example electricity use, net-demand or grid interaction in power systems re- search. Developing a method for forcasting that utilizes this particular co- pula-method could prove fruitful, in particular for devising demand side management strategies for matching electric power use with in- termittent generation. Acknowledgment This project was funded by the project “Development and evalua- tion of forecasting models for solar power and electricity use over space and time”, and the EU-ERA.Net Smart Grids Plus project “Increased Self Consumption of Photovoltaic Power for Electric Vehicle Charging in Virtual Networks”, both funded by the Swedish Energy Agency. References Aguiar, R., Collares-Pereira, M., 1992. TAG: a time-dependent, autoregressive, Gaussian model for generating synthetic hourly radiation. Sol. Energy 49, 167–174. Bollen, M.H.J., Hassan, F., 2011. Integration of Distributed Generation in the Power System. Wiley IEEE Press Series on Power Engineering. Box, G.E.P., Jenkins, G.M., Reinsel., G.C., Ljung, G.C., 2016. Time Series Analysis: Forecasting and Control, ﬁfth ed. Wiley Series in Probability and Statistics, Wiley. Bright, J.M., Smith, C.J., Taylor, P.G., Crook, R., 2015. Stochastic generation of synthetic minutely irradiance time series derived from mean hourly weather observation data. Sol. Energy 115, 229–242. Bright, J.M., Babacan, O., Kleissl, J., Taylor, P.G., Crook, R., 2017. A synthetic, spatially decorrelating solar irradiance generator and application to a LV grid model with high PV penetration. Sol. Energy 147, 83–98. Brinkworth, B.J., 1977. Autocorrelation and stochastic modelling of insolation sequences. Sol. Energy 19, 343–347. Conover, W.J., 1999. Practical Nonparametric Statistics, third ed. Wiley. Engerer, N.A., Bright, J.M., Killinger, S., 2017. Himawari-8 enabled real-time distributed PV simulations for distribution networks. In: Proceedings of IEEE PVSC 2017, Washington DC, USA, June 25–30 2017. Grantham, A.P., Pudney, P.J., Ward, L.A., Belusko, M., Boland, J.W., 2017. Generating synthetic ﬁve-minute solar irradiance values from hourly observations. Sol. Energy 147, 209–221. Hagspiel, S., Papaemannouli, A., Schmid, M., Andersson, G., 2012. Copula-based mod- eling of stochastic wind power in Europe and implications for the Swiss power grid. Appl. Energy 96, 33–44. Hammer, A., Beyer, H.G., 2013. Solar radiation, spatial and temporal variability. In: Richter, C., Lincot, F., Guermard, A. (Eds.), Sol. Energy. Springer, New York, pp. 634–648. Hansen, C.W., Stein, J.S., Ellis, A., 2010. Statistical Criteria for Characterizing Irradiance Time Series. Sandia Report SAND2010-7314. Hayes, M.H., 1996. Statistical Digital Signal Processing and Modeling. John Wiley & Sons Inc. Hollands, K.G.T., Huget, R.G., 1983. A probability density function for the clearness index, with applications. Sol. Energy 30, 195–209. Hollands, K.G.T., Suehrcke, H., 2013. A three-state model for the probability distribution of instantaneous solar radiation, with applications. Sol. Energy 96, 103–112. Holttinen, H., Milligan, M., Kirby, B., Acker, T., Neimane, V., Molinski, T., 2008. Using standard deviation as a measure of increased operational reserve requirement for wind power. Wind Eng. 32, 355–378. Ineichen, P., Perez, R., 2002. A new airmass independent formulation for the Linke tur- bidity coeﬃcient. Sol. Energy 73, 151–157. Kleissl, J., 2013. Solar Energy Forecasting and Resource Assessment, ﬁrst ed. Academic Press. Koopmans, L.H., 1995. The Spectral Analysis of Time Series Probability and Mathematical Statistics. Elsevier Science, Albuquerque, USA. Lave, M., Kleissl, J., Arias-Castro, E., 2012. High-frequency irradiance ﬂuctuations and geographic smoothing. Sol. Energy 86, 2190–2199. Lave, M., Reno, M.J., Broderick, R.J., 2015. Characterizing local high-frequency solar variability and its impact to distribution studies. Sol. Energy 118, 327–337. Li, W., Isberg, J., Chen, W., Engström, J., Waters, R., Svensson, O., Leijon, M., 2016. Bivariate joint distribution modeling of wave climate data using a copula method. Energy Stat. 04, 1650015. Lohmann, G.H., Hammer, A., Monahan, A.H., Schmidt, T., Heinemann, D., 2017. Simulating clear-sky index increment correlations under mixed sky conditions using a fractal cloud model. Sol. Energy 150, 255–264. Lojowska, A., Kurowicka, D., Papeafthymiou, G., van der Sluis, L., 2012. Stochastic modeling of power demand due to EVs using copula. IEEE Trans. Power Syst. 27, 1960–1968. Meteonorm Irradiance Software. < www.meteonorm.com > (accessed 8/8 2017). Munkhammar, J., Widén, J., 2016. Copula correlation modeling of aggregate solar irra- diance in spatial networks. In: Proceedings of Solar Integration Workshop. Vienna 15–17 November. Munkhammar, J., Widén, J., 2016. Correlation modeling of instantaneous solar irradiance with applications to solar engineering. Sol. Energy 133, 14–23. Munkhammar, J., Widén, J., 2017. An autocorrelation-based copula model for producing realistic clear-sky index and photovoltaic power generation time-series. In: Proceedings of IEEE PVSC 2017, Washington DC, USA, June 25–30 2017. Munkhammar, J., Rydén, J., Widén, J., Lingfors, D., 2015. Simulating dispersed photo- voltaic power generation using a bimodal mixture model of the clear-sky index. In: Proceedings of EU-PVSEC, Hamburg, Germany 14–18 September 2015, pp. 1560–1567. Munkhammar, J., Rydén, J., Widén, J., 2015b. On a probability distribution model combining household power consumption, electric vehicle home-charging and pho- tovoltaic power production. Appl. Energy 142, 135–143. Munkhammar, J., Widén, J., Hinkelman, L., 2017. A copula method for estimating ag- gregate instantaneous solar irradiance in spatial networks. Sol. Energy 143, 10–21. Nelsen, R.B., 2006. An Introduction to Copulas. second ed. Springer Series in Statistics, New York. Ngoko, B.O., Sugihara, H., Funaki, T., 2014. Synthetic generation of high temporal re- solution solar radiation data using Markov models. Sol. Energy 103, 160–170. Perez, R., Kivalov, S., Schlemmer, J., Hemker Jr., K., Hoﬀ, T.E., 2012. Short-term irra- diance variability: preliminary estimation of station pair correlation as a function of distance. Sol. Energy 86, 2170–2176. Sengupta, M., Andreas, A., 2010. Oahu Solar Measurement Grid (1-Year Archive): 1- Second Solar Irradiance; Oahu, Hawaii (Data); NREL Report No. DA-5500-56506. http://dx.doi.org/10.5439/1052451. Skartveit, A., Olseth, J.A., 1992. The probability density and autocorrelation of short-term global and beam irradiance. Sol. Energy 49, 477–487. Smith, C.J., Bright, J.M., Crook, R., 2017. Cloud cover eﬀect of clear-sky index dis- tributions and diﬀerences between human and automatic cloud observations. Sol. Energy 144, 10–21. Soda-service, 2016. Cams McClear Service For Estimating Irradiation under Clear-Sky. < http://www.soda-pro.com/web-services/radiation/cams-mcclear > (2016- 05-05). Stein, J.S., Hansen, C.W., Reno, M.J., 2012. The Variability Index: a New and Novel Metric for Quantifying Irradiance and PV Output Variability, Tech. Rep. SAND2012- 288C2, Sandia National Laboratories. Swedish Meteorological and Hydrological Institute [Internet]. Norrköping, Sweden: J. Munkhammar, J. Widén Solar Energy 158 (2017) 9–19 18 SMHI, 2008. Available from: < http://www.smhi.se/en >. Voyant, C., Muselli, M., Paoli, C., Nivet, M.-L., 2011. Optimization of an artiﬁcial neural network dedicated to the multivariate forecasting of daily global radiation. Energy 36, 348–359. Wegener, J., Lave, M., Luoma, J., Kleissl, J., 2012. Temporal Downscaling of Irradiance Data via Hidden Markov Models on Wavelet coeﬃcients: Application to California Solar Intiative data, UCSD Report. < http://calsolarresearch.ca.gov/images/ stories/ documents/Sol1_funded_ proj_docs/UCSD/ucsd_rpt_downscaling-1sec.pdf > . Widén, J., 2015. A model of spatially integrated solar irradiance variability based on logarithmic station-pair correlations. Sol. Energy 122, 1409–1424. Widén, J., Shepero, M., Munkhammar, J., 2017. On the properties of aggregate clear-sky index distributions and an improved model for spatially correlated instantaneous solar irradiance, Sol. Energy (in press). Widén, J., Shepero, M., Munkhammar, J., 2017. Probabilistic load ﬂow for distribution grids with high PV penetrations using copula-based modeling of spatially correlated solar power. IEEE J. Photovoltaics (in press). J. Munkhammar, J. Widén Solar Energy 158 (2017) 9–19 19","libVersion":"0.3.2","langs":""}