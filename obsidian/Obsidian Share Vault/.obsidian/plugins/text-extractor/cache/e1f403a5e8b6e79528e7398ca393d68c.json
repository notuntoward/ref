{"path":"lit/lit_notes_OLD_PARTIAL/Sabeti14AdditiveModelsConditional.pdf","text":"Stat The ISI’s Journal for the Rapid (wileyonlinelibrary.com) DOI: 10.1002/sta4.64 Dissemination of Statistics Research Additive models for conditional copulas Avideh Sabeti, Mian Wei and Radu V. Craiu \u0002 Received 30 July 2014; Accepted 12 September 2014 Conditional copulas are ﬂexible statistical tools that couple joint conditional and marginal conditional distributions. In a linear regression setting with more than one covariate and two dependent outcomes, we consider additive models for studying the dependence between covariates and the copula parameter. We examine the computation and model selection tools needed for Bayesian inference. The method is illustrated using simulations and a real example. Copyright © 2014 John Wiley & Sons, Ltd. Keywords: additive models; Bayesian inference; conditional copulas; cross-validated marginal likelihood; cubic splines; Markov chain Monte Carlo 1 Introduction Starting with the seminal paper of Sklar (1959), copulas have developed into an important tool used for qualitative and quantitative evaluations of dependence in statistical models. If Y1, Y2, ::: , Yk are continuous random variables with joint distribution function H and marginal distributions F1, F2, ::: , Fk, the unique copula C :[ 0, 1] k ![ 0, 1] “couples” the joint and the marginal distributions via H.y1, ::: , yk/ D C¹F1.y1/, ::: Fk.yk/º, for all .y1, ::: , yk/ 2 Rk. Therefore, in order to deﬁne H, we need to know the marginals Fi and the copula C. This can be convenient in situations in which one has a good grasp on the marginal distributions. As a natural extension, conditional copulas couple joint conditional and marginal conditional distributions (Lambert & Vandenhende, 2002; Patton, 2006). Speciﬁcally, if X 2 Rp is a covariate vector, then HX. y1, ::: , yk j X/ D C¹F1jX. y1 j X/, ::: , FkjX. yk j X/ j Xº, for all . y1, ::: , yk/ 2 Rk.(1) Conditional copulas models play an essential part in modelling high-dimensional data. For instance, consider a random vector Y D . Y1, ::: , Y4/ 2 R4. Using the decomposition used by Acar et al. (2012, equation (3), p. 75), we can show that its four-dimensional continuous density f. y/ :D f. y1, y2, y3, y4/ can be decomposed as f. y1, y2, y3, y4/ D f1. y1/f2. y2/f3. y3/f4. y4/ \u0003c12¹F1. y1/, F2. y2/ºc23¹F2. y2/, F3. y3/ºc14¹F1. y1/, F4. y4/º \u0003c13j2¹F1j2. y1jy2/, F3j2. y3jy2/ºc24j1¹F2j1. y2jy1/, F4j1. y4jy1/º \u0003c43j12¹F4j12. y4 j y1, y2/, F3j12. y3 j y1, y2/º, (2) where, if A, B \u0004¹1, 2, 3, 4º are a set of indices, then we have used the following notations: fA and FA are, respectively, the joint density and distribution functions of ¹Yj : j 2 Aº; fAjB and FAjB are the conditional density and distribution Department of Statistics, University of Toronto, Toronto, Ontario M5S3G3, Canada ∗Email: craiu@utstat.toronto.edu Stat 2014; 3: 300–312 Copyright © 2014 John Wiley & Sons, Ltd Stat Additive models for conditional copulas The ISI’s Journal for the Rapid (wileyonlinelibrary.com) DOI: 10.1002/sta4.64 Dissemination of Statistics Research functions of ¹Yj : j 2 Aº given ¹Yh : h 2 Bº; cA and cAjB denote, respectively, the copula density for ¹Yj : j 2 Aº and the conditional copula density of ¹Yj : j 2 Aº given ¹Yh : h 2 Bº. Not surprisingly, increasing the dimension of Y will result in a decomposition like (2) where copula densities are conditioned on more than two random variables. Acar et al. (2012) have shown that when replacing the conditional copulas with unconditional ones in (2), we are likely to incur inferential losses in terms of both bias and efﬁciency. The conditional copula can also be a useful modelling tool in regression settings in which we observe outcomes Y1, ::: , Yk along with covariate vector X 2 Rp, and of interest is not only the effect of the covariate on each response but also the effect of X on the dependence structure between the responses. Throughout the paper, we consider parametric copula families in which the function C assumes a parametric form indexed by a copula parameter \u0002.In many applications one can reasonably assume that \u0002 will vary with X. However, it is generally difﬁcult to guess the functional relationship between \u0002 and the covariate vector X, so its estimation requires ﬂexible models that can capture a wide variety of patterns. This naturally leads to the use of semiparametric (Acar et al., 2011; Craiu & Sabeti, 2012) and non-parametric inferential tools (Omelka et al., 2009; Veraverbeke et al., 2011; Abegaz et al., 2012). However, as the dimension p of the covariate vector X increases, the volume of data required to keep the error within reasonable bounds increases very quickly (Abegaz et al., 2012). The generic motivational examples discussed earlier prompt our search for practical inferential procedures for conditional copula models when p >1. The paper is developed for situations in which the parameter \u0002 is a scalar and there are two (i.e. k D 2) continuous outcomes of interest, Y1 and Y2, that are marginally linked to the vector of covariates via linear regression models. We propose here the use of additive models for studying the functional dependence between the covariate vector and the copula parameter. In this paper, we will improve on the statistical ingredients developed by Craiu & Sabeti (2012) in two directions. Most importantly, we will examine the performance of their Bayesian cubic spline estimator within an additive model framework. Secondly, we investigate the performance of the cross-validated marginal likelihood (CVML) criterion that adapts the seminal concept of cross-validation for marginal likelihood considered by Geisser & Eddy (1979) to the conditional copula setting. In the next section, we introduce the statistical model and describe the computational algorithms needed for inference and the calculation of the CVML criterion. We will also introduce the additive model and the CVML criterion. Simula- tions and a real data analysis are discussed in Sections 3 and 4, respectively. The paper closes with a discussion of future research directions. 2 The model In a regression setting, we consider the continuous bivariate outcome Y1 and Y2 along with covariate X 2 Rp. Marginally, each response Yi, i D 1, 2, is modelled using a normal regression model. For a sample of size n, ¹.Y1j, Y2j, Xj/ : 1 \u0005 j \u0005 nº, where Xj D .Xj1, ::: , Xjp/ T,wedenote ˇi D .ˇi1, ::: , ˇip/ T and assume that marginally Yij \u0006 N.XT j ˇi, \u0003 2 i /, 81 \u0005 i \u0005 2, 1 \u0005 j \u0005 n,(3) leading to the conditional density of .Y1j, Y2j/ given Xj f.Y1j, Y2j j Xj/ D 2Y iD1 1 \u0003i \u0004 Yij \u0007 XT j ˇi \u0003i ! \u0003 (4) \u0003 c.1,1/ ´ ˆ Y1j \u0007 XT j ˇ1 \u00031 ! , ˆ Y2j \u0007 XT j ˇ2 \u00032 ! ˇ ˇ ˇ ˇ \u0002.Xj/ μ , 81 \u0005 j \u0005 n,(5) Stat 2014; 3: 300–312 301 Copyright © 2014 John Wiley & Sons, Ltd A. Sabeti et al. Stat (wileyonlinelibrary.com) DOI: 10.1002/sta4.64 The ISI’s Journal for the Rapid Dissemination of Statistics Research where c.a,b/.u, v j \u0002/ D @ aCbC.u, v j \u0002/=@ua@vb, for all 0 \u0005 a, b \u0005 1. An important part of the model is the speciﬁcation of \u0002.X/. Many copula families have their parameter \u0002 restricted to a subset of R. We consider here a user-speciﬁed link function g that maps the support of the copula parameter onto the real line and set g.\u0002/ D \u0005.X/, where \u0005 : R p ! R is the unknown calibration function we want to estimate. Given the one-to-one correspondence between the copula parameter \u0002.X/ and the conditional Kendall’s tau \u0006.X/ D 4E¹H.Y1, Y2 j X/ j Xº\u0007 1, one can choose to parametrize the model on the \u0006 or \u0002 scale. In this paper, inference is performed directly on the copula parameter calibration function for computational convenience. However, when goodness-of-ﬁt measures are reported across different copula families, one must use the \u0006 scale, which is parametrization invariant (see also discussion in Acar et al., 2011). We adopt an additive model (Hastie & Tibshirani, 1990) for \u0005.X/ \u0005.X/ D ˛0 C pX hD1 \u0005h.Xh/,(6) where each \u0005h : R ! R is speciﬁed using the ﬂexible cubic spline model suggested by Smith & Kohn (1996) in which \u0005h.Xh/ D 3X jD1 ˛.h/ j Xj h C K.h/ X kD1 .h/ k .Xh \u0007 \u0007 .h/ k / 3 C (7) and aC D max.0, a/. It is well known that the performance of spline-based estimators is inﬂuenced by the location of the knots \u0007 .h/ k . In our model, this choice is automatic and data-driven. A general remark is that in our implementations, we assume the covariates are independent. In order to test this assumption when applying the method to real data, we have used tests based on the empirical copula process (Genest & Remillard, 2004; Kojadinovic & Holmes, 2009) and based on correlation of distances (Székely et al., 2007). The priors assigned to the parameters involved in the marginal models are as follows: ˇi \u0006 N.0, \u0003 2 i Ip/, 8i D 1, 2, \u0003 2 i \u0006 InvGam.0.1, 0.1/, 8i D 1, 2. For the parameters involved in the cubic spline , we follow the prior speciﬁcations used by Craiu & Sabeti (2012). For each covariate Xh, we select a ﬁxed value for the maximum number of knots, K.h/ max. The range spanned by the observed values of covariate Xh is divided into K.h/ max intervals of equal length, I.h/ 1 , ::: , I.h/ K.h/ max, and we assume that each interval I.h/ k contains at most one knot. In order to complete the model speciﬁcation, we introduce additional parameters ¹\b.h/ k : 1 \u0005 k \u0005 K.h/ maxº, where for all k 2¹1, ::: , K.h/ maxº \b.h/ k D ´ 1 if there is a knot \u0007 .h/ k 2 I.h/ k , 0 otherwise. The model (7) becomes then Copyright © 2014 John Wiley & Sons, Ltd 302 Stat 2014; 3: 300–312 Stat Additive models for conditional copulas The ISI’s Journal for the Rapid (wileyonlinelibrary.com) DOI: 10.1002/sta4.64 Dissemination of Statistics Research 28 30 32 34 36 38 40 42−1.0−0.50.00.51.0 Zτ 1.00.50.0−0.5−1.0−1.0−0.50.00.51.0 Zτ Figure 1. Five hundred realizations of \u0005h.z/ drawn from the prior distribution. The simulation set-up is inspired by the real data example from Section 5: in the left panel, Z is uniform on (28, 42), and in the right panel, Z has been standardized using the transformation h.Z/ D .Z \u0007 35/=7. \u0005h.Xh/ D 3X jD1 ˛.h/ j Xj h C K.h/ maxX kD1 \b.h/ k .h/ k .Xh \u0007 \u0007 .h/ k / 3 C,(8) and one can see that the number of non-zero terms in the sum depends on the values of \b.h/ 1 , ::: , \b.h/ K.h/ max. For each \u0005h, we construct a hierarchical prior for ¹\b.h/ 1 , ::: , \bK.h/ maxº. Speciﬁcally, if we let j\b.h/jD PK.h/ max kD1 \b.h/ k be the number of knots that are used in the model for \u0005i,then p.j\b.h/jj \t .h// / \t .h/j\u0002 .h/j j\b.h/j! 1 ¹j\u0002 .h/j\u0002K.h/ maxº,(9) that is, j\b.h/j follows the right truncated Poisson distribution with parameter \t .h/ and maximum value K.h/ max. In addition, p.\b.h/ ˇ ˇ j\b.h/j/ D K.h/ max j\b.h/j !\u00031 , p.\b.h/j\t .h// D p.\b.h/ ˇ ˇ j\b.h/j/p.j\b.h/jˇ ˇ\t .h//. The form of p.\b.h/ jj\b.h/j/ implies that, given a number of knots for the model, all conﬁgurations of intervals containing a knot are equally likely. The priors for all the parameters involved in the spline model for \u0005h are chosen regardless of the type of outcome as \t .h/ \u0006 Bin.K.h/ max, p D 0.5/, ˛0 \u0006 N .0, 10/, ˛.h/ j \u0006 N .0, 10/, 81 \u0005 j \u0005 3, (10) Stat 2014; 3: 300–312 303 Copyright © 2014 John Wiley & Sons, Ltd A. Sabeti et al. Stat (wileyonlinelibrary.com) DOI: 10.1002/sta4.64 The ISI’s Journal for the Rapid Dissemination of Statistics Research .h/ k \u0006 N .0, 10/, 81 \u0005 k \u0005 K.h/ max, \u0007 .h/ k \u0006 Unif[ I.h/ k ], 81 \u0005 k \u0005 K.h/ max. (11) Without additional information on the shape of \u0005h, we would like to be as vague as possible a priori. Note that the prior distributions given in equations (9) and (11) induce a prior distribution on the set of all possible maps \u0005h : R ! R. This prior is too complex to characterize analytically, but easy to sample from. Speciﬁcally, given a response index h, each sample of spline parameters ¹\b.h/ k , \u0007 .h/ k , .h/ k : 1 \u0005 k \u0005 K.h/ maxº, ¹˛.h/ j : 1 \u0005 j \u0005 3º and ˛0 from (9) and (11) will produce, when plugged into equation (8), a curve \u0005h. If the priors used are indeed not too informative about the shape of \u0005h, then we do not expect to see emerging any particular patterns. Our simulations show that the prior is not too sensitive to changes in the values used in (9) and (11) but is sensitive to the covariate’s range. In Figure 1, we show 500 maps \u0005h.z/ on Kendall’s tau scale where it is easier to see emerging patterns because the range is bounded. The left panel illustrates the case where the covariate is uniform on the interval .28, 42/ (the range was chosen to match the data example in Section 4), and the curves in the right panel are obtained after standardizing the covariate so that the values are in the interval .\u00071, 1/. One can see that when the covariate has a wider range, we tend to favour heavily, a priori, extreme dependence patterns with Kendall’s tau close to 1 or \u00071. Such trends are undesirable as they can potentially bias the inference. However, after standardizing the covariate, the prior bias seems to vanish. For this reason, we recommend standardizing all covariates used in the conditional copula model. 2.1. The computational algorithm If ! is the vector of all the parameters involved in the model and D denotes all the observed data, the posterior distribution, .! j D/, cannot be studied analytically because of its complicated form. Instead, we construct a Markov chain Monte Carlo (MCMC) algorithm to sample from .!jD/. The form of the sampling algorithm follows the generic design of the Gibbs sampler (Gelfand, 2000) in which every component !j is updated by sampling from its conditional distribution .!j j !n!j, D/. Some of the components of the chain cannot be sampled directly from the conditional distribution, so a Metropolis–Hastings update is needed (for details on using Metropolis–Hastings updates within the Gibbs sampler, see, for instance, Craiu & Rosenthal, 2014). The strategies used to update each parameter at step t C 1 (the values at step t are marked using supra index .t/) are described in the following. ˇ’s: Let X 2 Rn\u0004p be the matrix whose rows are XT j , 1 \u0005 j \u0005 n,and Y1, Y2 the vector of responses, Yi D¹Yij : 1 \u0005 j \u0005 nº. If we had not considered the dependence between the outcomes, then the posterior conditional distribution of ˇ1, ˇ2 would have been Q i \u0002 ˇijD, \u0003 .t/ i \u0003 DQ \u0002 ˇijX, Yi, \u0003 .t/ i \u0003 D n.ˇi; \u000bi, ˙i/, i D 1, 2, (12) where n.x; a, b/ is the density of a normal with mean vector a and variance matrix b,and \u000bi D \u0002 I C X TX \u0003\u00031 X TYi, ˙i D \u0002 \u0003 .t/ i \u00032 \u0002I C X TXi\u0003\u00031 , i D 1, 2. (13) The update of each ˇi involves a mixture of transition kernels. With probability \t D 0.8, we update using an indepen- dent Metropolis (IM) transition kernel in which the proposal distribution is Q i.ˇi j D, \u0003 .t/ i /, and with probability 1 \u0007 \t D 0.2, we update using a random-walk Metropolis (RWM) with a Gaussian proposal with mean at the current value of ˇi and variance chosen so that the acceptance rate is between 20% and 30%. Copyright © 2014 John Wiley & Sons, Ltd 304 Stat 2014; 3: 300–312 Stat Additive models for conditional copulas The ISI’s Journal for the Rapid (wileyonlinelibrary.com) DOI: 10.1002/sta4.64 Dissemination of Statistics Research \u0003’s: Once again, without the copula component of the likelihood, the posterior conditional distribution of \u0003i given the data and ˇ1, ˇ2 available in closed form is Q \u0002\u0003ijD, ˇ.tC1/ i \u0003 DQ \u0002 \u0003jX, Yi, ˇ.tC1/ i \u0003 D D IG 0.1 C pCn 2 , 0.1 C \u0002 ˇ .tC1/ i \u0003T ˇ .tC1/ i C \u0002Yi\u0003Xˇ .tC1/ i \u0003T \u0002Yi\u0003Xˇ .tC1/ i \u0003 2 ! , i D 1, 2. (14) The updates are made according to an IM kernel in which the proposal density is Q .\u0003 j X, Yi, ˇ.tC1/ i / for each i D 1, 2. The updating steps for ˇ and \u0003 lead to faster mixing compared with the sampling algorithm deﬁned in Craiu & Sabeti (2012) where only RWM updates were used, because the IM transition kernel has a good acceptance rate (\b30%) and allows the chain to jump around the target space, which leads to a decrease in the autocorrelation. In the absence of additional information regarding which covariates are more likely to induce changes in \u0005,we use the same Kmax D K.h/ max value for each h D 1, 2, ::: , p. ˛’s: Because there is no range restriction for each ˛.h/ k and no direct sampling strategy is possible, we use the RWM within Gibbs with proposal variance tuned so that the acceptance rates are between 20% and 50%. \b’s: The updates are performed using the Metropolis-within-Gibbs strategy for the entire latent variable vector E\b.h/ D .\b.h/ 1 , ::: , \b.h/ Kmax/. For updating E\b.h/, we use two type of moves: we either add/delete a component (i.e. transforming a zero component into a one or vice versa) or swap two components. In our applications, we choose with probability half to add/delete a component chosen at random and otherwise to permute two components of E\b that are selected at random. Each proposed move is accepted or rejected based on a Metropolis–Hastings rule. ’s: If \b.h/ k D 1, we use the RWM-within-Gibbs strategy to update .h/ k using proposals tuned so that the acceptance rates are between 20% and 50%. If \b.h/ k D 0, .h/ k is updated using a random draw from its prior distribution that is automatically accepted. \u0007 ’s: If \b.h/ k D 1,weuse an IM update for \u0007 .h/ k using as proposal the prior distribution of \u0007 .h/ k .If \b.h/ k D 0, then the next state \u0007 .h/ k is sampled from its prior and automatically accepted. \t:For \t, we use an IM update with proposal distribution equal to the prior, that is, Bin.0.5, Kmax/. 2.2. Pseudo-marginal likelihood model selection The cross-validated pseudo-marginal likelihood (CVML) criterion of Geisser & Eddy (1979) is used to compare the predictive power of various models considered. Denote by M such a generic model, characterized by regression parameters ¹ˇi, \u0003i : i D 1, 2º corresponding to a subset of covariates, X, and all the spline parameters involved in modelling the calibration function \u0005.X/. Denote the parameters in the model as !, the data are D, and for each 1 \u0005 j \u0005 n, D\u0003j denotes the remaining data after we have removed the covariates and responses pertaining to the jth item, .Y1j, Y2j, Xj/. A selection criterion based on the CVML will choose the model M that maximizes the sum CVML.M/ D nX jD1 log p.Y1j, Y2jjD\u0003j, M/. (15) Stat 2014; 3: 300–312 305 Copyright © 2014 John Wiley & Sons, Ltd A. Sabeti et al. Stat (wileyonlinelibrary.com) DOI: 10.1002/sta4.64 The ISI’s Journal for the Rapid Dissemination of Statistics Research One can see from (15) that the CVML criterion favours models that exhibit the best average predictive power. The average is taken with respect to the parameters in the model, so (15) is a function of the model and the observed data only. From a Bayesian standpoint, the computation of the criterion would be impractical if we were to proceed by performing separately n data analyses, one for each sample of size n\u00071. However, the following derivation can be used to compute CVML.M/ from a single Bayesian analysis of the whole data (see also Hanson et al., 2011). We have E[ p.Y1j, Y2jj!/ \u00031] D 1 p.DjM/ R p.Dj!,M/p.!jM/ p.Y1j,Y2jj!,M/ d! D 1 p.DjM/ R p.D\u0003jj!, M/p.!jM/ d! D p.D\u0002jjM/ p.DjM/ D 1 p.Y1j,Y2jjD\u0002j,M/ , (16) where the ﬁrst expectation is taken with respect to the posterior distribution of all parameters in the model, .! j D, M/ D p.Dj!, M/=p.D j M/. Based on (16), we deduce that a Monte Carlo estimator of (15) is 1CVML.M/ D nX jD1 \u0007 log \" 1 M MX mD1 p.Y1j, Y2jj!.m/, M/ \u00031# , (17) where !.1/, !.2/, ::: , !.M/ are draws from the posterior distribution .! j D, M/ obtained via the MCMC algorithm described in the previous section. 3 Simulations The simulation study provides information about the average errors incurred when implementing the proposed esti- mation approach and illustrates the performance of the CVML criterion when it is used to select the copula family and the inﬂuential covariates in model (6). 3.1. Simulation details We have generated data using the Clayton copula using either a univariate or bivariate calibration function. Marginally, the outcomes follow the distributions deﬁned by the linear models speciﬁed in (3). All covariate values are indepen- dently sampled from the Uniform[ 0, 1] distribution. For the dependence structure, we have considered two non-linear calibration functions \u0005S1 and \u0005S2 deﬁned as \u0005S1.x/ D log[ 4.5 \u0007 1.5 sin. x/] and \u0005S2.x1, x2/ D log[ 4.5 \u0007 sin.x1/ \u0007 sin.x2/]. Under scenario S1, we simulate data using only one covariate so the true calibration function is \u0005S1, and under scenario S2, we generate data using the calibration \u0005S2. Marginally, under S1 and S2, each response variable is linked to, respectively, one or two covariates via a linear model with Gaussian errors, as speciﬁed in (3). Each analysis has been replicated 50 times for samples of size n D 450.Wekept Kmax D 4 ﬁxed throughout the simulation study. The MCMC sampler was run for 10,000 iterations, and the ﬁrst 3,000 samples were discarded as burn-in. The simulation parameters used in the MCMC samplers were selected to produce acceptance probabilities in Copyright © 2014 John Wiley & Sons, Ltd 306 Stat 2014; 3: 300–312 Stat Additive models for conditional copulas The ISI’s Journal for the Rapid (wileyonlinelibrary.com) DOI: 10.1002/sta4.64 Dissemination of Statistics Research the range 20–40%. The copula model data were generated using the copula library within R. The main steps of the MCMC sampler were implemented in C++ with the results processed in R. 3.2. Estimation of the calibration function In this section, we present plots and measures of the goodness of ﬁt for the proposed estimating procedure. We focus on scenario S2, which is more challenging to ﬁt To provide a graphical illustration of the ﬁt, in Table I, we show one-dimensional slices in the true surface (black line), the estimated surface (red line) and the two surfaces delimitating the 95% credible region (green lines). The slices are obtained when one of the two covariates is ﬁxed at values in the set ¹\u00070.75, \u00070.25, 0.25, 0.75º. We observe that the credible bands grow wider near the boundaries of the covariate range and the bias gets also bigger when the covariate is closer to 1 or \u00071. Table II contains the trace plots, the autocorrelation plots (up to lag 200) and the histograms of the posterior samples for \u0002.\u00070.25, 0.75/, \u0002.0.75, \u00070.25/ and \u0002.0.75, 0.75/. In general, the autocorrelation function plots and the trace plots look similar across different parameter values. In the histograms, the red line shows the true value of the calibration function. We observe that the samples for \u0002.0.75, 0.75/ are further from the true value when compared with the samples for \u0002.0.75, \u00070.25/. This is consistent with our previous observation concerning the ﬁt when covariate values are close to the boundary. We also look at the model estimates for the normal regression parameters. Table III shows the trace plots, the autocorrelation plots and the histograms obtained from posterior samples corresponding to the linear regression model for the ﬁrst outcomes ˇ11 and ˇ12, and the residual standard deviation \u00031. The parameters used in the second regression model yield similar plots. The red line in the histograms represents the true value of the parameter. Although the autocorrelation function seems to be high for these estimates, the histograms suggest that the samples provide good estimates of the marginal model parameters. Table I. One-dimensional projections of the true calibration surface (black), the estimated surface (red) and credible bands (green) produced under scenario S2. Stat 2014; 3: 300–312 307 Copyright © 2014 John Wiley & Sons, Ltd A. Sabeti et al. Stat (wileyonlinelibrary.com) DOI: 10.1002/sta4.64 The ISI’s Journal for the Rapid Dissemination of Statistics Research Table II. Trace (top row), autocorrelation function (middle row) and histogram (bottom row) plots for the calibration parameters \u0002.\u00070.25, 0.75/, \u0002.0.75, \u00070.25/ and \u0002.0.75, 0.75/. For a more global summary, we approximate numerically the integrated variance, squared bias and mean squared error using a grid of 400 equidistant points in the covariate space. The values reported in Table IV are computed when the copula family used is the true one. When comparing these measures across the two simulation scenarios, we notice an increase in bias when the number of covariates is increased. This is not surprising because we ﬁt a signiﬁcantly more complex model under scenario S2 than under S1, but the sample size is the same. 3.3. Copula selection The performance of the CVML criterion for choosing the correct copula family is illustrated in Table V. Speciﬁcally, we ﬁt the generated data using Clayton, Frank and Gumbel copula families. In Table V, we report the percentage of correct decisions computed from 50 independent replicates. It can be noticed that there is a small decrease in accuracy for scenario S2 compared with S1, which is not surprising given that the former model is more complex than the latter. Copyright © 2014 John Wiley & Sons, Ltd 308 Stat 2014; 3: 300–312 Stat Additive models for conditional copulas The ISI’s Journal for the Rapid (wileyonlinelibrary.com) DOI: 10.1002/sta4.64 Dissemination of Statistics Research Table III. Trace (top row), autocorrelation function (middle row) and histogram (bottom row) plots for the regression coefﬁcients, ˇ11 and ˇ12, of the ﬁrst outcome, Y1, and the corresponding residual standard deviation, \u00031. Table IV. Performance of the estimation procedure under scenarios S1 and S2. Scenario Integrated squared bias Integrated variance Integrated mean squared error S1 0.061 0.433 0.494 S2 0.132 0.515 0.647 3.4. Variable selection We have also examined the performance of CVML in selecting the covariates to be included in the model. We focused on data generated under scenario S2, and we ﬁtted them using models with one, two or three covariates. All results reported in this section are obtained under the correct Clayton copula family. Stat 2014; 3: 300–312 309 Copyright © 2014 John Wiley & Sons, Ltd A. Sabeti et al. Stat (wileyonlinelibrary.com) DOI: 10.1002/sta4.64 The ISI’s Journal for the Rapid Dissemination of Statistics Research Table V. Performance of cross-validated marginal likelihood in selecting the correct Clayton family over Frank or Gumbel family under scenarios S1 and S2. The numbers in the table represent the percentage of correct decisions. Scenario/Copula Frank (%) Gumbel (%) S1 100 98 S2 96 94 Table VI. Comparison of the cross-validated marginal likelihood (CVML) criterion values for models with one, two or three covari- ates. Left panel: box plot of 50 independently replicated values of the difference CVML.M2/ \u0007 CVML.M1/. Right panel: box plot of 50 independently replicated values of the difference CVML.M2/ \u0007 CVML.M3/. If we denote by Mi the model with the ﬁrst i covariates included, then we see from the box plots shown in Table VI that CVML always selects M2 over M1 or M3.The difference in CVML values is larger between M2 and M1 than between M2 and M3, which is natural given the criterion’s connection to the model’s predictive power. 4 Application to the twin birth data The additive model approach is applied to a subset of the matched multiple birth data set. The data containing all twin births in the USA from 1995 to 2000 enable detailed investigation of twin gestations. We consider the twin live births in which both babies survived their ﬁrst year of life with mothers aged between 18 and 40 years. Of interest Copyright © 2014 John Wiley & Sons, Ltd 310 Stat 2014; 3: 300–312 Stat Additive models for conditional copulas The ISI’s Journal for the Rapid (wileyonlinelibrary.com) DOI: 10.1002/sta4.64 Dissemination of Statistics Research Table VII. Twin birth data: cross-validated marginal likelihood (CVML) values for three copula families under model M1 (bottom row) and M2 (top row). The criterion suggests that the model M1 with the Frank copula is most suitable for ﬁtting the data. Criterion Clayton Frank Gumbel CVML.M2/ \u000710,213.4 \u00077683.7 \u000754,763.2 CVML.M1/ \u00077405.3 \u00075569.4 \u000749,947.9 is the dependence between the birth weights of twins (in grammes), denoted by BW1 and BW2, respectively. We consider a random sample of 450 twin live births and investigate the effect of two covariates, gestational age (GA) and maternal age (MA), on the dependence between BW1 and BW2. We compare the model M1 in which the GA is the only covariate considered and model M2 in which GA and MA are the included covariates. We also compare three analyses based on three parametric copula families: Clayton, Frank and Gumbel. For each copula family, we compute the CVML criterion for the models with both covariates (GA and MA) included. The results shown in the ﬁrst row of Table VII suggest that the Frank copula is more suitable for analysing the data. Under the Frank copula, model M1 is preferred with a CVML value of \u00075569.4 compared with \u00077683.7 obtained for M2. After deciding that M1 is preferred, we compare again the ﬁt for M1 under each of the three copulas, and the results are shown on the second row of Table VII. This ﬁnding is concordant with the single covariate analysis of Acar et al. (2011). 5 Conclusions and future work We propose Bayesian inference for the conditional copula model in a regression context with multiple covariates. We implement spline approximation within the additive model framework and propose a model selection criterion that selects the model with the best predictive power. The simulations show that the efﬁciency of the method decreases as the dimension of the covariate vector increases, and we would like to explore theoretically the rate of the decay. It is conceivable that when the number of covariates grows large, the approach proposed here may become too computationally expensive, and simpler formulations of the calibration function and improvements of the MCMC algorithm needed to sample the posterior distribution are worth investigating. Acknowledgements This work was supported by an individual Natural Sciences and Engineering Research Council of Canada research grant. References Abegaz, F, Gijbels, I & Veraverbeke, N (2012), ‘Semiparametric estimation of conditional copulas’, Journal of Multivariate Analysis, 110, 43–73. Stat 2014; 3: 300–312 311 Copyright © 2014 John Wiley & Sons, Ltd A. Sabeti et al. Stat (wileyonlinelibrary.com) DOI: 10.1002/sta4.64 The ISI’s Journal for the Rapid Dissemination of Statistics Research Acar, E, Craiu, RV & Yao, F (2011), ‘Dependence calibration in conditional copulas: a nonparametric approach ’, Biometrics, 67, 445–453. Acar, E, Genest, C & Nešlehová, J (2012), ‘Beyond simpliﬁed pair-copula constructions’, Journal of Multivariate Analysis, 110, 74–90. Craiu, RV & Rosenthal, JS (2014), ‘Bayesian computation via Markov chain Monte Carlo’, Annual Reviews of Statistics and Its Application, 1, 179–201. Craiu, RV & Sabeti, A (2012), ‘In mixed company: Bayesian inference for bivariate conditional copula models with discrete and continuous outcomes’, Journal of Multivariate Analysis, 110, 106–120. Geisser, S & Eddy, WF (1979), ‘A predictive approach to model selection’, Journal of the American Statistical Association, 74, 153–160. Gelfand, AE (2000), ‘Gibbs sampling’, Journal of the American Statistical Association, 95(452), 1300–1304. Genest, C & Remillard, B (2004), ‘Tests of independence and randomness based on the empirical copula process’, Test, 13, 335–369. Hanson, T, Branscum, A & Johnson, W (2011), ‘Predictive comparison of joint longitudinal–survival modelling: a case study illustrating competing approaches’, Lifetime Data Analysis, 17, 2–28. Hastie, TJ & Tibshirani, RJ (1990), Generalized Additive Models, Chapman & Hall, London. Kojadinovic, I & Holmes, M (2009), ‘Tests of independence among continuous random vectors based on Cramér–von Mises functionals of the empirical copula process’, Journal of Multivariate Analysis, 100, 1137–1154. Lambert, P & Vandenhende, F (2002), ‘A copula-based model for multivariate non-normal longitudinal data: analysis of a dose titration safety study on a new antidepressant’, Statistics in Medicine, 21, 3197–3217. Omelka, M, Gijbels, I & Veraverbeke, N (2009), ‘Improved kernel estimation of copulas: weak convergence and goodness-of-ﬁt testing’, Annals of Statistics, 37(5B), 3023–3058. Patton, AJ (2006), ‘Modelling asymmetric exchange rate dependence’, International Economic Review, 47, 527–556. Sklar, A (1959), ‘Fonctions de répartition à n dimensions et leurs marges’, Publications de l’Institut de Statistique de l’Université de Paris, 8, 229–231. Smith, M & Kohn, R (1996), ‘Nonparametric regression using Bayesian variable selection’, Journal of Econometrics, 75, 317–343. Székely, GJ, Rizzo, ML & Bakirov, NK (2007), ‘Measuring and testing dependence by correlation of distances’, Annals of Statistics, 35, 2769–2794. Veraverbeke, N, Omelka, M & Gijbels, I (2011), ‘Estimation of a conditional copula and association measures’, Scandinavian Journal of Statistics, 38, 766–780. Copyright © 2014 John Wiley & Sons, Ltd 312 Stat 2014; 3: 300–312","libVersion":"0.3.2","langs":""}