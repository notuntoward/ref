{"path":"lit/lit_sources/Vohra23EndtoendLearningMultiple.pdf","text":"Accepted to IEEE Belgrade PowerTech, 2023 End-to-End Learning with Multiple Modalities for System-Optimised Renewables Nowcasting Rushil Vohra, Ali Rajaei , Graduate Student Member, IEEE, and Jochen L. Cremer Member, IEEE, Department of Electrical Sustainable Energy Delft University of Technology Delft, The Netherlands rushilvohra@outlook.com, {A.Rajaei, J.L.Cremer}@tudelft.nl Abstract—With the increasing penetration of renewable power sources such as wind and solar, accurate short-term, nowcasting renewable power prediction is becoming increasingly important. This paper investigates the multi-modal (MM) learning and end-to-end (E2E) learning for nowcasting renewable power as an intermediate to energy management systems. MM combines features from all-sky imagery and meteorological sensor data as two modalities to predict renewable power generation that otherwise could not be combined effectively. The combined, predicted values are then input to a differentiable optimal power ﬂow (OPF) formulation simulating the energy management. For the ﬁrst time, MM is combined with E2E training of the model that minimises the expected total system cost. The case study tests the proposed methodology on the real sky and meteorological data from the Netherlands. In our study, the proposed MM- E2E model reduced system cost by 30% compared to uni-modal baselines. Index Terms—multi-modal learning, end-to-end learning, op- timal power ﬂow, power forecasting. I. INTRODUCTION In many regions, sustainable energy systems will rely heav- ily on photovoltaic (PV) power, wind power, or both. These forms of energy generation are inherently uncontrollable due to their dependence on the local weather. Therefore, predicting energy generation is essential to ensure a balanced electrical system. A shared goal of system operators and microgrid managers is maintaining grid stability cost-effectively, where forecasting power can be considered an intermediate step to managing the energy system. Conventional numerical weather prediction (NWP) models and statistical methods are for instance autoregressive moving average (ARMA) and autoregressive integrated moving aver- age (ARIMA). However, these NWP and statistical models sometimes result in inaccurate forecasts, especially in the short term. Applying machine learning (ML) methods for these predictions in recent years aimed at lowering these inaccuracies. For example, models based on artiﬁcial neural networks (ANNs) improved prediction accuracy using meteo- rological time series input data based on input features such as humidity and air pressure for forecasting outputs such as solar irradiance and wind speed [1], [2]. Authors in [3] developed a hybrid PV power short-term prediction method that combines an ARIMA model with an ANN model and considers the different seasons as model inputs. Reference [4] proposed an approach that considers meteorological inputs and produces ensemble predictions. Beyond meteorological data, [5] uses another type of ANN, a convolutional neural network (CNN), and a long short and term memory (LSTM) module that takes sky images as input to produce the expected PV power as output. Despite this impressive development improving the accuracy over the years through machine learning, ML-based approaches for PV and wind predictions do not consider heterogeneous input data simultaneously in their predictions. As these data sources, meteorological and sky images, contain different information for predicting PV and wind output, their combination is promising. Multi-modal (MM) learning combines time series data with imagery and improves the prediction of severe short-term ﬂuctuations that other ANN approaches may miss [6]. MM learning combines different modalities of heterogenous data streams (such as text and audio) so that features from either modality enhance each other [7]. Combining these modalities means learning a common function for all the modalities simultaneously to produce a single representation vector. This ‘function’ can be an ANN. Three different ’fusion’ methods to combine these modalities are early, late, and intermediate fusion [8]. Early fusion combines raw or pre-processed data from different modalities, e.g., by concatenation, before the input to an ML model. Late fusion combines the predictions made from either modality, e.g., using a weighted average. Finally, intermediate fusion implements a hidden layer, called as MM layer, in the ANN. The engineer designs the ANN model architecture and selects this layer’s position in the ANN. Recently, [6] showed that MM learning successfully forecasted PV power outperforming baselines by a large margin. Beyond power prediction, MM also improved energy load time series forecasting [9]. End-to-end (E2E) learning models the task of the user in the training of the ML model [10]. This learning differs from conventional learning of ML models that uses a prepared (labelled) data set and only assumes a loss on the training data. This assumption has a weakness of not considering the task for what the trained ML model has used afterwards, which is what E2E learning addresses. For example, an ML model trained for predicting PV or wind power in power systems could have the ﬁnal task of being used as input optimising an energy management schedule of resource allocations [11]. In more detail, from the perspective of a power system operator, thearXiv:2304.07151v1 [eess.SY] 14 Apr 2023 task can be modelled as a mathematical optimisation problem with the objective to minimise the total system operational cost and constraints that ensure the grid’s physical security limits. Donti et al. [12] developed an E2E learning approach for convex optimisations such as the optimal power ﬂow (OPF) problem. E2E learning considers then the optimisation, here an OPF, that can be modelled in an ANN as a differentiable optimisation layer making use of the implicit function theorem [13]. The ANN is then trained on the system’s true objective, the economic cost [12]. This paper combines MM with E2E for the ﬁrst time and applies our MM-E2E technique to a MM PV and wind forecasting using an ANN that is trained E2E based on the system’s cost arising from inaccurate PV and wind forecasts. Our proposed MM ANN combines features with intermediate fusion from imagery and time-series meteorological data to predict PV and wind generation. Respectively, the predicted PV and wind generation are input to a differentiable optimi- sation layer that determines the schedule to dispatch power generations cost-efﬁciently and minimises their re-dispatch cost. The two contributions are: (i) MM-E2E combines the intermediate fusion of MM and E2E learning of a model for PV and wind generation prediction in energy systems, leveraging their advan- tages: MM maximises learnable information from het- erogeneous data, and E2E learns models for accurate predictions. (ii) E2E learning for an energy system with PV and wind generation. The dispatching and redispatching optimi- sation problem captures the ultimate system economic cost caused by prediction inaccuracies. The ANN model learns to compensate for the inaccuracies in the most cost- effective way. The rest of this paper is structured as follows. Section II outlines the design and formulation of the proposed MM-E2E model. The case study in Section III presents the numerical results of applying the proposed framework on the IEEE 6-bus system, followed by a discussion. The paper is concluded in Section IV. II. METHODOLOGY This section describes the proposed MM-E2E learning ap- proach for solar and wind prediction along the workﬂow of three steps: pre-processing, MM learning and E2E with optimal power ﬂow as task optimisation. After pre-processing the heterogeneous data sources, i.e., imagery and meteoro- logical sensor data, the proposed approach combines these data features with MM. Subsequently, E2E learning trains the ANN-based model on the ultimate economic system cost arising from prediction errors. A. Data Pre-processing To reduce the computational times of image processing, the imagery dataset is pre-processed in two ways. Firstly, the im- ages are converted from colour scale to grayscale, which may also beneﬁt object recognition [14]. Secondly, the resolution of the imagery is reduced from 1536 × 1536 to 64 × 64. Third, as ANNs training converges faster with input feature values between 0 and 1, the image pixel values are min-max normalised [15]. Hence the resulting images i ∈ ΩN have the pixel features xImage i ∈ (0, 1) 64×64. The tensor X combines many of such images, e.g., X Image ∈ (0, 1)64×64×N where N is the cardinality |ΩN | = N of all (training) images ΩN . Also, min-max normalises the meteorological data resulting in xM eteo i ∈ (0, 1) F ×N with the number of meteorological features F . Finally, imagery and meteorological data samples were measured every 10 minute to nowcast renewable power from 10-minutes-recent data. B. Multi-Modal Learning: Intermediate Fusion of Features Convolutional neural network (CNN) f1 can predict PV or wind power ˆyi ∈ R2 ≥0 exclusively from imagery xImage i and feedforward NN (FNN) f2 is suitable for exclusively using numerical (meteorological) data xM eteo i , respectively f1 : xImage i → ˆyi (1a) f2 : xM eteo i → ˆyi. (1b) A typical CNN architecture contains stacks of convolu- tional layers with activation functions, followed by a pooling layer and, optionally, a batch normalisation layer [15]. Fully- connected (FC) layers with a speciﬁed activation function are stacked ’on top’ to make the ﬁnal predictions ˆyi. To predict power combined from the two modalities of data, feature information from either one must be considered in conjunction. MM-E2E via intermediate fusion conjuncts these pieces of information: features h1,i are extracted from the imagery using a CNN ˜f1 : xImage i → h1,i (2) and concatenated with features from the meteorological data hmm,i = h1,i⌢xM eteo i . (3) This intermediate fusion of features was selected as the early fusion of input data directly xImage i ⌢xM eteo i is not suited. Fusing early imagery and sensor data as modalities without any feature extraction is not well suited as the sensor data cannot be directly concatenated with the pixel values of an image, and different types of ANNs are suited for the different data types. Another suggested approach for two modalities is bilinear pooling [16] with the outer product hmm = [ h1 1 ] ⊗ [ h2 1 ] = [ h1 h1 ⊗ h2 1 h2 ] , (4) where the index i was dropped for simplicity reasons for the two feature tensors h1 and h2 that give the MM feature tensor hmm, where h1,i is the extracted feature tensor for the ﬁrst modality, and h2,i is the extracted feature tensor for the second. Subsequently, another ANN f3 : hmm,i → ˆyi, (5) learns predicting the PV and wind power levels ˆyi = ( ˆP P V i , ˆP W i ) from the concatenated, extracted features hmm. 2 A possible disadvantage of intermediate fusion is that the approach may result in a very large and imbalanced feature tensor. However, it has also been argued that these imbalances in the tensor accelerate the convergence of training the ANN. The case study, Section III-C compares these two approaches. C. Optimal Power Flow After the ANN f3 predicts renewable power generation ˆyi, two varying OPF optimisation problems are solved in a sequence minimising the system cost and ensuring the physical constraints of the grid. The ﬁrst problem referred to as OPF- Schedule, receives the predicted renewable generation ˆyi from the ANN f3 as a parameter and aims to minimise system cost by scheduling the dispatch of generators. However, during the real-time operation, the predicted renewable generation may be different from the true value, which may lead to energy imbalances in the system. Therefore, the second optimisation problem, referred to as OPF-Redispatch, is formulated to ﬁnd the optimal redispatch of the generators that can balance supply and demand with the lowest redispatch cost. The transmission grid consists of a set of nodes B, and a set of lines L. Without loss of generality, it is considered that each node b ∈ B could be connected to a conventional generator, load demand, PV and wind generation. Therefore, ANN f3 outputs the PV and wind power predictions at multiple locations, and we expand ˆyi,b = ( ˆP P V i,b , ˆP W i,b ) by the index b for the bus locations ∀b ∈ B. Then, we drop the index i in the following for simplicity reasons and continue only with ˆP P V b ( ˆP W b ). The OPF-Schedule assumes the DC power ﬂow equations with known load demand as follows min C sch = ∑ b∈B cg b P g b + ∑ b∈B (γP V b λP V b +γW b λ W b + γb(λ+ b + λ− b ) ) (6) s.t. P g b − P d b + ( ˆP P V b − λP V b ) + ( ˆP W b − λW b ) = ∑ l∈Lb fl + (λ+ b − λ− b ) ∀b ∈ B (7) P g b ≤ P g b ≤ P g b ∀b ∈ B (8) fl = δi−δj xl ∀l ∈ L (9) −fl ≤ fl ≤ fl ∀l ∈ L (10) 0 ≤ λ P V b ≤ ˆP P V b , 0 ≤ λW b ≤ ˆP W b ∀b ∈ B (11) where the objective function in (6) minimises the operational dispatching cost of the system denoted by C sch, which consists of dispatching cost, renewable curtailment cost, and a penalty term for infeasibility in the node balance. In this regard, the conventional generator output and cost are P g b and c g b . Fur- thermore, the predicted PV (wind) generation is ˆP P V b ( ˆP W b ), while PV (wind) curtailment and corresponding curtailment cost are λP V b (λW b ), and γP V b (γW b ), respectively. Positive (negative) node injection imbalance and its associated penalty are given by λ+ b (λ − b ) and γb. Furthermore, load demand and active line ﬂow are represented by P d b , and fl, respectively. Eq. (7) models the node balance, while the ﬂow of line l between adjacent nodes with the reactance of xl is formulated in (9). Finally, the limits on generator output, line ﬂow, PV and wind curtailment are presented in (8), (10)-(11). While the dispatch of generators ˆP g b is determined based on the predicted renewable generation ˆP P V b and ˆP W b , the true values of renewable generation P P V b and P W b , might be different, e.g. ˆP P V b ̸= P P V b ∃ b ∈ B (12a) ˆP W b ̸= P W b ∃ b ∈ B. (12b) Therefore, redispatching accounts for this mismatch between the predicted and actual renewable generation. In this context, the OPF-Redispatch problem is formulated as below: min C rd = ∑ b∈B(cup b dP g+ b + c dn b P g− b ) +γP V b λP V b + γW b λW b + ∑ b∈B (γb(λ+ b + λ− b ) ) (13) s.t. ( ˆP g b + dP g+ b − dP g− b ) − P d b +(P P V b − λP V b ) + (P W b − λ W b ) = ∑ l∈Lb fl + (λ+ b − λ − b ) ∀b ∈ B (14) 0 ≤ dP g+ b ≤ dP g+ b , 0 ≤ dP g− b ≤ dP g− b ∀b ∈ B (15) P g b ≤ ˆP g b + dP g+ b − dP g− b ≤ P g b ∀b ∈ B (16) Eqs. (9) − (11), where the objective minimises the redispatching cost of the system, shown by C rd, which includes upward and downward ramping cost of generators, as well as renewable and pe- nalised nodal imbalances. In this regard, upward (downward) redispatch of generators and its associated cost is represented by dP g+ b (dP g− b ), and c up b (cup b ), respectively. The nodal balance constraint is shown in (14), while generator redispatch constraints are presented in (15)-(16). After solving OPF-Redispatch, the total system cost C sys can be calculated as below: C sys = C sch + C rd (17) The total system cost is a function of renewable prediction accuracy, where prediction errors lead to higher operational costs C sys, where the root-mean-squared error for PV and wind are Eq. (18) and Eq. (19) respectively. RM SEP V = √ ∑ b∈B( ˆP P V b − P P V b )2 |B| (18) RM SEW = √ ∑ b∈B( ˆP W b − P W b )2 |B| (19) D. Proposed Multi-Modal End-to-End Learning Approach The proposed MM-E2E learning approach trains the ANNs ˜f1 and f3 to minimise the ultimate system cost C sys. Our approach combines the features from the modalities h1 and x M eteo i in a single ANN f3 to perform renewable power prediction, which is then used as input for OPF optimisation 3 Fig. 1: The proposed multi-modal end-to-end architecture (MM-E2E). The extracted features from imagery are fused with the meteorological data to predict renewable power (ˆy) by FC layers. The power prediction is then used to solve the OPF problems, the output of which trains the ANN. Load Gen. Costs System constraints yi Dispatch OPF Minimized Cost Redispatch OPF Σ Dispatch Schedule Redispatch Costyi Dispatch Cost ^ Fig. 2: The OPF-Schedule and OPF-Redispatch minimise system costs. as the ultimate task. The proposed approach is shown in Fig. 1 and follows 5 consecutive steps: 1) A feature extraction network ˜f1, CNN-fe is applied to an image input xImage i according to Eq. (2). The CNN-fe shown as part of Fig. 1 consists of convolutional, ReLU activation, and max pooling layers, followed by an FC layer with ReLU activation and another with Sigmoid activation. ˜f1outputs the feature vector h1,i. 2) The meteorological features xM eteo i are fused with h1,i in a joint representation using concatenation as in Eq. (3) 3) Renewable power ˆyi is predicted from the fused feature vector, hmm,i, using a FNN layer f3 as in Eq. (5), referred to as FNN-pred. 4) The prediction ˆyi = ( ˆP P V i , ˆP W i ) is one of the inputs to the OPFs as illustrated in Fig. 2. These OPFs consist of two successively executed variations of OPFs (OPF- Schedule and OPF-Redispatch) as in Sec. II-C. Both are integrated as differentiable parameterized optimization layers in the neural network, where the solutions are differentiated concerning the parameters ˆyi [13]. 4.1) As shown in Fig. 2, the renewable prediction ˆyi = ( ˆP P V i , ˆP W i ) is the input to the optimal dispatch sched- ule of the generators with OPF-Schedule. 4.2) Then, if there exists any power imbalance due to a mismatch of the predicted power ( ˆP P V b , ˆP W b ) to the true powers (P P V b , P W b ) according to Eq. (12a), the OPF-Redispatch problem is solved to ﬁnd the optimal redispatch of the generators. 5) During training, the loss is considered as the total system cost of dispatch and redispatch, given by Eq. (17). This loss is differentiated and the gradients backpropagated to update the weights of all parameters deﬁning functions ˜f1 and f3 of CNN-fe and FNN-pred, respectively. 1 2 3 4 5 6 0 < P g < 200 MW 0 < P g < 150 MW 0 < P g < 180 MW P PV P W Pd P d P d Fig. 3: The modiﬁed IEEE 6-bus system with PV and wind generation. III. CASE STUDIES A. Settings and Test Network 1) Power System: Fig. 3 shows the modiﬁed IEEE 6-bus system with 3 generator, 3 load demands, PV generation at bus 1, and wind generation at bus 2. Other parameters used in OPF-Schedule and OPF-Redispatch optimisations are presented in Appendix A. Below are details regarding load demand, PV generation, and wind generation. • The load is modelled from the dynamic load proﬁles of 1.5 million identical households, normalised to IEEE 6-bus values and distributed over 3 buses [17]. In this context, the maximum load demand of the considered data is 293MW. • PV generation is based on the LG NeON BiFacial 440W panel (with a panel area of 2.2 m2). Eq. (20) approximates the output of a PV farm with Npanels panels of area Apanel, given their rated power Prated and the Global Horizontal Irradiance (GHI). PP V = GHI 1000W/m2 × PRated × Npanels (20) Eq. (20) disregards losses in panel efﬁciency due to temperature. We assume a farm of 250, 000 panels and corresponding rating of 110MWp. • Wind generation is based on a farm of 36 Vestas V112- 3.45MW turbines (modelled on the existing OWEZ off- shore farm), resulting in a rating of 124MWp. The turbine power curve is approximated by a Tanh function, which can be found in Appendix A. Sky imagery data and meteorological sensor data (with 10 minutes resolution) are two modalities. For meteorological fea- tures, time, air temperature, cloud opacity, relative humidity, wind direction, wind speed, precipitable water, and surface pressure are considered (more details in Appendix A). GHI is not included to simulate a context where local pyranometer data is not available. The sky imagery was captured at the TU Delft campus. The dataset consists of images captured at a minute frequency between 04:00 and 23:00 from 01 May 2021 to 24 February 2022. Each image is in full colour, with a resolution of 1536 × 1536. An example of an image taken on 01 May 2021 at 11:00 is provided in Fig. 4. 2) Training and Testing: The data set contains 10, 000 data samples, where 25% is saved for testing, 67.5% is used for training (total N = 6750 training samples), and 7.5% is for validation. During training, early stopping is implemented if the validation error does not decrease for 5 consecutive epochs. 4 Fig. 4: All sky images captured by the camera at 11:00 on 01 May 2021. TABLE I COMPARISON OF PREDICTIONS OF PV AND WIND POWER FROM IMAGERY (USING CNN-BASE) AND METEOROLOGICAL DATA (USING FNN-BASE). PV Wind Imagery Meteo. Data Imagery Meteo. Data Average MSE 0.00836 0.00177 0.00867 0.00011 STD MSE 0.000682 0.000134 0.00131 0.00013 The AdamW optimiser with a batch size of 64 is used to train the ANN. Furthermore, 10 random train-test trials are considered for all case studies. The separation of the validation and training split between trials is varied, as is the mini-batch shufﬂing, while the never-before-seen test set is the same. The plots and tables in each case study show the distribution of test set predictions over the 10 trials. Moreover, for sequential learning models (not E2E models), the mean squared error M SE = 1 N ∑ i∈ΩN (yi − ˆyi) 2 (21) and mean absolute error M AE = 1 N ∑ i∈ΩN |yi − ˆyi| were used as loss functions. 3) Network Architecture: Several studies were conducted to obtain a good ANN network architecture. The studies focused on the ideal ANN depth, number of images used, image resolution, etc. The CNN-base model contains 3 sets of con- volutional and max. pooling layers, followed by 2 FC layers; whereas the FNN-base) for forecasting from meteorological consists of 4 FC layers. Apart from the last layer (which uses Sigmoid activation), all other layers use the ReLU activation function. Details of these architectures are in Appendix A. Moreover, these initial studies showed that using 3 recent images, combined with a pixel-wise average, produced better PV power predictions by CNN-base than 1 image. The same conclusion was found for the number of recent meteorological samples, resulting in 24 meteorological inputs (3 for each of the 8 variables). The initial results in Table I show that power predictions with the meteorological data and FNN-base were far more accurate than using imagery and CNN-base. The relative beneﬁt of meteorological data can be explained by that images do not contain as many obvious and distinct features, such as wind speed and humidity, as are directly present in the meteorological data. 4) Investigated Models: Five models were investigated. 1) UM-base1-Seq: this naive ensemble baseline combines the predictions from imagery (using CNN-base) f1 and meteorological data (using FNN-base) f2 from Eq. (1) as an average ˆyU M 1 = 0.5f1(xImage i ) + 0.5f2(xM eteo i ), (22) exemplifying the simplest late fusion method to combine the two modalities. The predicted power is then used to solve for system cost C sys in the 6-bus system. 2) UM-base2-Seq: a linear regressor is ﬁtted to combine the two power predictions ˆyU M 2 = c1f1(xImage i ) + c2f2(xM eteo i ), (23) which can be considered as a more ‘intelligent’ version of UM-base1-Seq as the weights c1 and c2 are ﬁtted. 3) MM-Seq: the MM approach shown in Fig. 1 is trained by using the M SE shown in Eq. (21) as loss, so the trained ANN has the objective to accurately predicting renewable power. This baseline represents current ML- based approaches for PV and wind prediction. 4) MM-E2E (proposed model): the MM approach is used to predict power and is trained E2E based on the minimised C sys. 5) Perfect Forecast: simulates a scenario where the system cost is calculated using the true PV or wind powers (P P V b , P W b ). This simulation, therefore, calculates the minimum achievable system cost. B. Meteorological Feature Extraction Here, two MM networks are compared in terms of their effectiveness at predicting PV power. The ﬁrst includes a network for extracting features from both modalities separately (FNN for meteorological data and CNN for imagery), before combining them, whereas the second only uses a network (CNN) to extract features from imagery and then fuses them with the meteorological data. The method used for fusion in both architectures for this study is concatenation. Over 10 times training, the ﬁrst model achieves an average MSE of 0.00143 (0.00058), where the number in parentheses is the standard deviation, compared to an MSE of 0.00129 (0.00031) for the second model. Despite the added complexity of the ﬁrst architecture (i.e., more layers), it attains a higher error and variance in error. These results may be attributed to the fact that there are few meteorological features, to begin with (F = 24), thus, the added feature extraction network only overﬁts the training data without revealing new information from the features. This effect may be alleviated with much larger sets of training data or the use of more previous instances of meteorological features. C. Multi-Modal Joint Representation Method This study investigates bilinear pooling (given in Eq. (4)) and concatenation for feature fusion within the MM archi- tecture. This fusion occurs, as shown in Fig. 1, after feature extraction from the imagery modality. The ANN using con- catenation achieves an average MSE of 0.00109 (0.00024), compared to an MSE of 0.00144 (0.00033) for bilinear pooling over these 10 trials. Bilinear pooling includes all the fea- tures represented in the fused feature space of concatenation. 5 TABLE II AVERAGE AND STANDARD DEVIATION OF MSE AND %RMSE ON PRE- DICTED PV POWER OVER 10 TRIALS. Persistence UM-base1 UM-base2 MM Average MSE 0.0008 0.00294 0.00151 0.00109 STD (MSE) 0 0.000157 0.000179 0.000242 Average %RMSE 2.8% 5.4% 3.9% 3.2% STD (%RMSE) 0 0.14% 0.23% 0.34% However, it results in quadratically larger feature space with greater sparsity and more irrelevant features. Thus, the ANN may miss important information amongst the vast feature space, potentially prompting the need for feature selection. Feature selection for regression problems reduces not only computational time but also improves predictive performance by avoiding spurious correlations between irrelevant features and the target (a form of overﬁtting). D. Comparison of Methods for Power Forecasting This case study quantiﬁes the utility of MM learning for power forecasting. UM-base1, UM-base2, the proposed MM model, and a persistence forecast are compared in terms of prediction error. The OPF problems, system cost and E2E training are therefore not considered here as we seek to compare the prediction performance of the models. The results are presented in Table II. The prediction performance of UM- base1, UM-base2 and MM, in terms of %RMSE, is in line with state-of-the-art ANN-based methods for predicting solar power [18]. The persistence forecast outperforms the other 3 methods consistently. However, it must be noted that this is because it is predicting PV power (analogous to GHI given Eq. (20)) using the GHI from 10 minutes prior, while the ANN methods do not include recent GHI as a feature. UM-base1 severely lacks performance compared to UM-base2, likely due to the signiﬁcantly worse-performing imagery modality being equally weighed with the sensor data. Additionally, MM learning improves predictions compared to UM-base2. Two reasons may explain this phenomenon. Firstly, UM-base2 has only two trainable parameters (as given in Eq. (23)), while MM has thousands; this additional complexity may aid prediction. Secondly, UM-base2 employs the latest possible fusion, only combining the predicted GHI from either modality, while MM employs intermediate fusion, concatenating features from meteorological data and imagery. During training, this archi- tecture extracted feature layers (CNN-fe) to learn how the visual features enhance the sensor data for forecasting. E. E2E learning with PV and Wind Prediction This study investigates the system costs minimisation by E2E learning against the baselines for predicting PV power which are established already. The MM learning model in Fig. 5 is shown to not only improve power output prediction but also beneﬁt power system operation in terms of system cost as both the MM models outperform the UM ones. A conventional approach, represented by UMbase2-Seq, results in a 32% cost increase compared to a perfect knowledge scenario. C sys is only increased by 10% when using MM learning and training sequentially. Much of this cost reduction 0.00 0.01 0.02 0.03 0.04 0.05 MAE on Test Set 0 10 20 30 40 50Average Excess Cost on Test Set (%) MM-Seq MM-E2E UM-base1-Seq UM-base2-Seq Perfect Forecast Fig. 5: Excess system cost compared to power forecast error (MAE) in a system with PV generation. 0.000 0.025 0.050 0.075 0.100 0.125 0.150 0.175 0.200 MAE on Test Set 0.0 2.5 5.0 7.5 10.0 12.5 15.0 17.5 20.0Average Excess Cost on Test Set (%) MM-PVWind-Seq MM-PVWind-E2E UM-base2-Seq UM-base1-Seq Perfect Forecast Fig. 6: Excess system cost compared to power forecast error (MAE) in a system with PV and wind generation. is due to the intelligent combination of MM features using an ANN. E2E learning also contributes a clear reduction in cost (comparing the 10% excess cost from MM-Seq to 7% from MM-E2E). In addition, E2E training enables a more consistently reduced cost, shown by the lower variance in cost. This improved performance of MM-E2E can be explained by the fact that E2E training provides the ANN with information about the generation cost functions (cup b , c dn b ) of the various generators. Thus, for instances where perfect prediction is not obtained, E2E training may enable the ANN to appropriately over- or underestimate power such to reduce cost. This same study can be conducted in a power system with PV and wind generation. The proposed model is adjusted to ‘MM-PVWind-E2E’ to predict both power sources by includ- ing an FNN-pred network which uses only meteorological data for wind prediction. The results are in Fig. 6, where the error is measured as the average of M AE( ˆP P V g , P P V g ) and M AE( ˆP W g , P W g ). While E2E training results in lower system costs than sequential learning, the power prediction error is signiﬁcantly greater in the former. Note that the standard deviation on system cost is lowest from MM-PVWind-E2E, while the standard deviation on the power prediction is the largest for MM-PVWind-E2E. F. System Cost Functions The results found in Figs. 5 and 6 are worth investigating as they both show MM-E2E achieving the lowest costs but with disparate prediction error. We investigate the cost function in PV and wind systems with a load of 145MW, and PV and wind generation of 25MW each. Fig. 7 shows the system cost C sys under regular and reduced (by 50%) branch limits. Fig. 7a shows no global minimum, but isolines along which identical costs can be achieved by overestimating PV and underestimating wind, or vice-versa. Thus, system balance 6 0 1 2 3 4 P PV g / P PV , true g 0.0 0.5 1.0 1.5 2.0 2.5 3.0 3.5 4.0PWg/PW,trueg 500 700 900 1100 1300 1500 1700 1900 2100 (a) 0 1 2 3 4 P PV g / P PV , true g 0.0 0.5 1.0 1.5 2.0 2.5 3.0 3.5 4.0PWg/PW,trueg 500 700 900 1100 1300 1500 1700 1900 2100 (b) Fig. 7: Cost functions of a system with PV and wind generation, (a) under regular, (b) and reduced (by 50%) branch limits. may be maintained with no (or very low) redispatch costs while incurring prediction errors. This behaviour explains Fig. 6, where relatively large prediction errors are not detrimental to cost minimisation. Fig. 7b shows possible local minima as branch limits are reduced and more constraints are binding. E2E training in this context would enable the learning of a more complex cost function, but may also cause inaccurate power predictions. Thus, the optimisation objective should be carefully selected depending on the problem context for E2E training. G. Discussion The studies presented promising results regarding the appli- cation of MM and E2E learning for economically optimised renewable power predictions. However, some limitations of the methodology can be noted, which most importantly is the computational time to train the models as it involves solving optimisations. The computational time’s complexity to the training data and power network sizes must be thoroughly analysed to quantify the approach’s limitations. Furthermore, in future works, using Pearson correlation for selecting fea- tures may improve power prediction. Including features from early layers into the MM power prediction may also improve performance and mitigate the vanishing gradients [7]. Testing the proposed MM-E2E architecture with various cost func- tions, e.g., asymmetric and quadratic ones would simulate more realistic conditions. Designing a tailored loss function, such as a multi-task objective, may prevent converging to local minima (sometimes seen with E2E learning). Further, considering the prediction relies mostly on time-sequenced data (in both modalities), ML techniques such as LSTM-RNNs could also improve predictions compared to only CNNs and FNNs. Finally, a more thorough analysis with a wider set of OPF-type problems is recommended to fully assess the proposed approach’s beneﬁts. IV. CONCLUSION This paper investigated two deep learning techniques, multi- modal (MM) learning and end-to-end (E2E) learning, for pho- tovoltaic and wind power nowcasting in energy management systems. The features from two modalities (all-sky imagery and time series meteorological data) are combined through MM learning. The model is trained E2E on the total system cost from prediction errors modelled as optimization problems. The proposed model architecture, MM-E2E, is tested in dif- ferent settings against uni-modal sequentially trained convolu- tional and feedforward networks to understand the advantages and limitations of the methodology. Our studies found that the proposed MM-E2E model reduced the economic cost by impressively around 30%. However, we are also cautious and discussed the limitation regarding the computational scaling of the E2E approach, which we recommend as future works. REFERENCES [1] Y. Ren, P. Suganthan, and N. Srikanth, “Ensemble methods for wind and solar power forecasting—a state-of-the-art review,” Renewable and Sustainable Energy Reviews, vol. 50, pp. 82–91, 2015. [2] R. Ahmed, V. Sreeram, Y. Mishra, and M. D. Arif, “A review and eval- uation of the state-of-the-art in PV solar power forecasting: Techniques and optimization,” Renewable and Sustainable Energy Reviews, vol. 124, 2020. [3] E. Vrettos and C. Gehbauer, “A Hybrid Approach for Short-Term PV Power Forecasting in Predictive Control Applications,” in 2019 IEEE Milan PowerTech, 2019, pp. 1–6. [4] S. Leva, M. Mussetta, A. Nespoli, and E. Ogliari, “PV power forecasting improvement by means of a selective ensemble approach,” in 2019 IEEE Milan PowerTech, 2019, pp. 1–5. [5] J. Zhang, R. Verschae, S. Nobuhara, and J.-F. Lalonde, “Deep photo- voltaic nowcasting,” Solar Energy, vol. 176, pp. 267–276, 2018. [6] Z. Li, K. Wang, C. Li, M. Zhao, and J. Cao, “Multimodal Deep Learning for Solar Irradiance Prediction,” in 2019 International Conference on Internet of Things (iThings) and IEEE Green Computing and Commu- nications (GreenCom) and IEEE Cyber, Physical and Social Computing (CPSCom) and IEEE Smart Data (SmartData), 2019, pp. 784–792. [7] T. Baltruˇsaitis, C. Ahuja, and L.-P. Morency, “Multimodal machine learning: A survey and taxonomy,” IEEE transactions on pattern anal- ysis and machine intelligence, vol. 41, no. 2, pp. 423–443, 2018. [8] D. Lahat, T. Adalı, and C. Jutten, “Multimodal data fusion: An overview of methods, challenges, and prospects,” Proceedings of the IEEE, vol. 103, pp. 1449–1477, 2015. [9] Q. Xian and W. Liang, “A multi-modal time series intelligent prediction model,” in Proceeding of 2021 International Conference on Wireless Communications, Networking and Applications, Z. Qian, M. Jabbar, and X. Li, Eds. Singapore: Springer Nature Singapore, 2022, pp. 1150– 1157. [10] P. Donti, B. Amos, and J. Z. Kolter, “Task-based end-to-end model learning in stochastic optimization,” Advances in neural information processing systems, vol. 30, 2017. [11] D. Wahdany, C. Schmitt, and J. L. Cremer, “More than accuracy: end-to- end wind power forecasting that optimises the energy system,” Electric Power Systems Research, vol. 221, p. 109384, 2023. [Online]. Available: https://www.sciencedirect.com/science/article/pii/S0378779623002730 [12] P. L. Donti, D. Rolnick, and J. Z. Kolter, “DC3: A learning method for optimization with hard constraints,” in International Conference on Learning Representations, 2021. [13] A. Agrawal, B. Amos, S. Barratt, S. Boyd, S. Diamond, and Z. Kolter, “Differentiable convex optimization layers,” in Advances in Neural Information Processing Systems, 2019. [14] H. M. Bui, M. Lech, E. Cheng, K. Neville, and I. S. Burnett, “Using grayscale images for object recognition with convolutional-recursive neural network,” 2016 IEEE 6th International Conference on Commu- nications and Electronics, IEEE ICCE 2016, pp. 321–325, 9 2016. [15] A. Geron, Hands-On Machine Learning with Scikit-Learn, Keras, and TensorFlow. O’Reilly, 2019. [16] A. Zadeh, M. Chen, S. Poria, E. Cambria, and L.-P. Morency, “Tensor fusion network for multimodal sentiment analysis,” in Proceedings of the 2017 Conference on Empirical Methods in Natural Language Processing, 2017, pp. 1103–1114. [17] BDEW, “Standardlastproﬁle Strom,” 2017, data retrieved from World Development Indicators, https://www.bdew.de/energie/ standardlastproﬁle-strom/. [18] M. Q. Raza, M. Nadarajah, and C. Ekanayake, “On recent advances in PV output power forecast,” Solar Energy, vol. 136, pp. 125–144, 10 2016. 7 APPENDIX Details of the parameters used in the DCOPF-Schedule and DCOPF-Redispatch optimisations are given in Table III. The wind turbine power curve and its approximation are depicted in Fig. 8. This work considers meteorological sensor data and sky imagery data modalities. The meteorological features are presented in Table VIII. Each one is measured at a temporal resolution of 10 minutes. The baseline models resulting from initial case studies (CNN-base and FNN-base) are described in Tables V and IV. The architectures of CNN-fe and FNN-pred are given in Tables VI and VII. TABLE III VALUES OF ESSENTIAL PARAMETERS USED IN THE OPTIMISATIONS. Parameter Value Unit P g 1 , P g 2 , P g 3 0 MW P g 1 200 MW P g 2 150 MW P g 2 180 MW c g 1 12 Euro/MW c g 2 10 Euro/MW c g 3 8 Euro/MW fl 100 MW L 11 B 6 γb 100 Euro/MW γP V b , γW b 0.1 Euro/MW Fig. 8: Power curve of Vestas V112-3.45 turbine and a Tanh approximation. TABLE IV FNN-BASE ARCHITECTURE. Layer Type Input Size # Neurons Activation F1 FC ninputs×1 64 ReLU F2 FC 64×1 128 ReLU F3 FC 128×1 64 ReLU F4 FC 64×1 1 Sigmoid TABLE V CNN-BASE ARCHITECTURE. Layer Type Input Size Kernel Stride Padding Activation C1 Conv. 64×64×1 3×3 2×2 1×1 ReLU P2 Max. Pool. 32×32×8 2×2 2×2 0×0 - C3 Conv. 16×16×8 3×3 1×1 1×1 ReLU P4 Max. Pool. 16×16×32 2×2 2×2 0×0 - C5 Conv. 8×8×32 3×3 1×1 1×1 ReLU P6 Max. Pool. 8×8×16 2×2 2×2 0×0 - Flatten Layer Type Input Size # Neurons - - Activation F7 FC 256×1 64 - - ReLU F8 FC 64×1 1 - - Sigmoid TABLE VI CNN-FE ARCHITECTURE. Layer Type Input Size Kernel Stride Padding Activation C1 Conv. 64×64×1 3×3 2×2 1×1 ReLU P2 Max. Pool. 32×32×8 2×2 2×2 0×0 - C3 Conv. 16×16×8 3×3 1×1 1×1 ReLU P4 Max. Pool. 16×16×32 2×2 2×2 0×0 - C5 Conv. 8×8×32 3×3 1×1 1×1 ReLU P6 Max. Pool. 8×8×16 2×2 2×2 0×0 - Flatten Layer Type Input Size # Neurons - - Activation F7 FC 256×1 64 - - ReLU F8 FC 64×1 64 - - Sigmoid TABLE VII FNN-PRED ARCHITECTURE. Layer Type Input Size # Neurons Activation F1 FC 88×1 64 ReLU F2 FC 64×1 128 ReLU F3 FC 128×1 64 ReLU F4 FC 64×1 1 Sigmoid TABLE VIII METEOROLOGICAL FEATURES USED FOR PREDICTING P P V OR P W . Meteo. Variable Description Unit Time The moment of the day when the instance was measured seconds Air temperature Measured at 2 meters above sur- face level °C Cloud opacity The attenuation of incoming sun- light due to clouds. Varies from 0% (no cloud) to 100% (full at- tenuation of incoming sunlight) % Relative humidity Measured at 2 meters above ground level. Relative humidity is the amount of water vapour as a percentage of the amount needed for saturation at the same temper- ature. A value of 50% means the air is 50% saturated % Wind direction Measured at 10m altitude ° Wind speed Measured at 10m altitude m/s Precipitable water A measure of the precipitable wa- ter of the entire atmospheric col- umn kg/m2 Surface pressure Air pressure measured at sea level hPa 8","libVersion":"0.3.2","langs":""}