{"path":"lit/papers_to_add/Papers I'm Reviewing Right Now/Pinson12vShrtWndPowLogitNorm_TechNote.pdf","text":"Very short-term probabilistic forecasting of wind power with generalised logit-Normal distributions P. Pinson Technical University of Denmark, Dpt. of Informatics and Mathematical Modelling 2800 Kgs. Lyngby, Denmark Abstract. Very short-term probabilistic forecasts, which are essential for an optimal manage- ment of wind generation, ought to account for the nonlinear and double-bounded nature of that stochastic process. They take here the form of discrete-continuous mixtures of generalised logit-Normal distributions and probability masses at the bounds. Both autoregressive and con- ditional parametric autoregressive models are considered for the dynamics of their location and scale parameters. Estimation is performed in a recursive least-squares framework with expo- nential forgetting. The superiority of this proposal over classical assumptions about the shape of predictive densities e.g. Normal and Beta, is demonstrated based on 10-minute ahead point and probabilistic forecasting at the Horns Rev wind farm in Denmark. Keywords: bounded time-series; dynamic models; probabilistic forecasting; transformation; wind power 1. Introduction In diﬀerent areas of forecasting, both theoretical and practical developments are pointing towards various forms of probabilistic forecasting. This has been the case in economics and ﬁnance (Tay and Wallis 2000, Timmermann 2000), earthquake prediction (Kagan and Jackson 2000), meteorology (Leutbecher and Palmer 2008), as well as for weather-related processes like renewable energy production (Bacher et al. 2009, Pinson et al. 2007b) or ﬂoods (Clocke and Pappenberger 2009). When considering continuous variables such as wind power, they optimally take the form of predictive densities—equivalently referred to as predictive distributions or density forecasts, giving the full probability density function of the power random variable for a set of lead times. The optimal management and trading of wind power calls for probabilistic forecasts (Pinson et al. 2007). This follows from a more general result: for a large class of decision-making problems, optimal decisions directly relate to quantiles of conditional predictive distributions (Gneiting 2011). Lead times in the range of hours to days correspond to the needs of decision-makers in view of the structure and operation of European electricity markets (Giebel et al. 2011, Costa et al. 2008). They have thus attracted the most attention so far. Density forecasts for these horizons are commonly based on statistical models for the “dressing” of point predictions, conditional to weather conditions (Bremnes 2006, Møller et al. 2008, Pinson and Kariniotakis 2010). Alternatively, they result from the dynamic post-processing of ensemble forecasts of meteorological variables (Nielsen et al. 2006, Pinson and Madsen 2009, Taylor et al. 2009). When wind power penetration reaches a certain level, and with large-scale wind farms injecting power at a single point of the electricity network, it becomes crucial to also have forecasts for horizons of a few minutes ahead. Characterising and modelling the power 2 P. Pinson ﬂuctuations at these time scales is recognised as a current challenge. Firstly, this is required by the Transmission System Operator (TSO) in order to optimally operate reserves for the continuous balance of the power system. In that case, the relevant horizons are deﬁned as 1, 10 and 30 minutes (Sørensen et al. 2007). More speciﬁcally for the case of Denmark, the TSO Energinet.dk has deﬁned the 10-minute lead time as the most important one since power ﬂuctuations at this time scale are those that most seriously aﬀect the balance in the power system (Akhmatov 2007). This aspect directly motivates our choice to focus on 10-minute ahead forecasts only. Secondly, very short-term predictions are needed as input to the (oﬀshore) wind farm controllers themselves with typical time steps between 5 and 15 minutes (Kristoﬀersen and Christiansen 2003, Sørensen et al. 2005). Finally, the operation of wind-storage systems at temporal scales consistent with the temporal resolution at which regulation is carried out in practise in some electricity markets e.g. 15 minutes in the Netherlands, or 5 minutes in New Zealand and Australia, calls for very short-term forecasts. Even though emphasis is placed on the 10-minute lead time only, extension to further horizons can be the topic of future work. This may be based on the same predictive distributions but with diﬀerent input data and dynamics models. For such short lead times, statistical models based on historical measurements only, though taking advantage of meteorological and physical expertise on the problem at hand, should be preferred. Running Numerical Weather Prediction (NWP) models for these tem- poral resolutions with frequent updates would be clearly too expensive if not impossible today. Also statistical approaches are known to outperform NWP-based ones for the fore- casting of the power output of a wind farm at lead times less than a few hours (Giebel et al. 2011). Examples of recent works on improving such statistical approaches, focusing on the wind (speed and potentially direction) variable, include the regime-switching space-time method introduced by Gneiting et al. (2006), and the multivariate wind vector models of Hering and Genton (2009). Some other works have been focusing on capturing changes in the wind ﬁeld dynamics using e.g. Markov-switching approaches (Ailliot et al. 2006). In parallel, Pinson and Madsen (2011) discuss the beneﬁts of Markov-switching autoregressive models for point and probabilistic forecasting of wind power generation at forecast horizons of 10-minutes ahead. We place ourselves in a parametric probabilistic forecasting framework, for which very few proposals exist in the literature, especially at these lead times. Our core objective is to discuss how wind power characteristics motivate the choice for speciﬁc types of predictive distributions. A ﬁrst crucial feature of the wind power variable is that it is double-bounded between a minimum production of zero and a maximum one being equal to the nominal capacity (denoted Pn) of the wind turbine, wind farm, or wind energy portfolio considered. It is in parallel a nonlinear function of wind speed in the form of a sigmoid. Wind power measurements and forecasts are normalised by Pn in the following. They then take values in the unit interval [0, 1]. The time variations of Pn, if any, are commonly recorded for re- cent wind farms. They can be used for an adaptive scaling of measurements and forecasts. A consequence of the above is that predictive densities cannot be Gaussian. This is valid whatever the temporal resolution of wind power time-series or the forecast horizon consid- ered. Their higher-order moments are also directly related to their mean, and potentially to some external signal. These two points have already been discussed in a number of pub- lications (Lange 2005, Pinson 2006, Bludszuweit et al. 2008). To our knowledge however, no work exists in the literature where these aspects have been appropriately taken into consideration in a probabilistic forecasting framework. For illustrative purposes, Figure 1 depicts an episode with 2 days of successive 10-minute average power output at the Horns Probabilistic forecasting of wind power 3 Rev oﬀshore wind farm which will be the focus of the application and results part of the paper. 0 50 100 150 200 250 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 time steps [x10mins]normalized power measurements Figure 1. Episode of 2 days (288 time-steps, with a temporal resolution of 10 minutes) with wind power measurements at the Horns Rev wind farm in Denmark. We propose here a methodology for the probabilistic forecasting of wind power time- series that account for these characteristics. Predictive densities take the form of discrete- continuous mixtures consisting of a generalised logit-Normal (GL-Normal) distribution with potential concentration of probability mass at the bounds of the unit interval [0, 1]. Given a shape parameter, these predictive densities are fully characterised by a location and a scale parameter only. By employing the related generalised logit transform for variance stabili- sation, the obtained variable can be modelled with censored Gaussian distributions. After preliminary deﬁnitions in Section 2, the forecasting methodology is described in Section 3. Both model building and estimation aspects are subsequently dealt with in Section 4, with focus on simple autoregressive (AR) models or more advanced conditional parametric au- toregressive (CP-AR) models. These models are considered for the sake of example only and could be further improved in the future. In the case of further lead times, say up to a few days ahead, it should be envisaged to build models additionally accounting for the weather dynamics as given by meteorological forecasts. The methodology is applied in Section 5 for the probabilistic forecasting of wind power generation at the Horns Rev wind farm in Denmark, at lead times of 10 minutes. It is evaluated against some simple benchmarks, as well as against other assumptions that could be made regarding the shape of predictive densities e.g. Normal or Beta. The paper ends with concluding remarks in Section 6. 2. Preliminary deﬁnitions Transformations are commonly employed for variance stabilisation, and to work in a Gaus- sian framework. Besides the general class of power or Box-Cox transformations (Box and Cox 1964), Johnson (1949) originally introduced the so-called logistic (or logit) transform, 4 P. Pinson subsequently used for e.g. bounded economic variables (Wallis 1987). It directly relates to using logit-Normal distributions for modelling the original eﬀect (Aitchison and Shen 1980). A generalisation of both the logit transform and of logit-Normal distributions is given below, being appropriate for the case of wind power modelling and forecasting applications. Wind power generation is a double-bounded process, thus making the logistic trans- formation appealing. Owing to the diﬀerent inﬂection in power curves for low and high power values, a suitable transformation should allow for asymmetry. The generalised logit (GL) transformation inspired by Mead (1965) hence comprises an ideal candidate. For an original time-series {xt}, the generalised logit transform yt is given by yt = γ(xt; ν) = ln ( xν 1 − xν ) , ν > 0, xt ∈ (0, 1) (1) while the inverse transformation, referred to as inverse generalised logit (IGL), is deﬁned as xt = γ−1(yt; ν) = { 1 + 1 exp(yt) }−1/ν , ν > 0, yt ∈ R (2) The GL transformation generalises the logistic one with an additional shape parameter ν only. Its purpose is to inﬂuence the evolution of variance and skewness of these distributions as a function of their mean. For ν = 1, one retrieves the more classical logit transforma- tion, recently used by Lau and McSharry (2010) for wind power prediction. The aim of employing such transformation is to work with a time-series {yt} for which the assumption that conditional densities may be Gaussian is more appropriate. In parallel, in view of the known relationship between conditional expectation and variance of wind power densities (Pinson 2006, Bludszuweit et al. 2008), it is expected that the conditional variance of the predictive densities for the transformed variable will be independent of their mean. We introduce the generalised logit-Normal distribution (GL-Normal) based on the afore- mentioned GL transform. It is denoted by Lν(µ, σ2), where µ and σ are the location and scale parameters, respectively. For a Gaussian variable Y ∼ N (µ, σ2), the transformed variable X = γ(Y ; ν) is such that X ∼ Lν(µ, σ2). By generalising the probability density function of a univariate logit-Normal variable given by Aitchison and Shen (1980) and Frederic and Lad (2008), we obtain that for the GL-Normal variable, f (x) = 1 σ√ 2π ( ν x(1 − xν) ) exp { − 1 2 [ γ(x; ν) − µ σ ]2} , x ∈ (0, 1) (3) We do not discuss here the moments of a variable that would be distributed GL-Normal. One could carry out theoretical developments in the spirit of Aitchison and Shen (1980) to derive some properties and perform comparisons with the class of logit-Normal and Dirichlet distributions. It could also be envisaged to perform similar numerical developments as in Frederic and Lad (2008) in order to visualize the moments of GL-Normal distributions as a function of their location and scale parameters. 3. Forecasting methodology based on generalised logit-Normal distributions Several authors e.g. Lange (2005) and Pinson (2006), have observed that the standard deviation of the distributions of forecast errors was directly linked to its conditional expec- tation, whatever the time of the year, horizon and forecast model. Appropriate predictive Probabilistic forecasting of wind power 5 densities of wind power generation should account for and reproduce this observed feature. Recently, some models for this relationship have been proposed (Pinson and Madsen 2009, Bludszuweit et al. 2008, Usaola 2009). More precisely, Bludszuweit et al. (2008) looked at second-order polynomial mean-variance models for obtaining the parameters of Beta distri- butions when analysing the uncertainty of wind power forecasts, a posteriori. The models they obtained had the general form of asymmetric logistic models. Based on a similar ob- servation, Usaola (2009) modeled moments and cumulants of forecast error distributions as a function of the level of predicted power, as input to power ﬂow models. Finally Pinson and Madsen (2009) introduced a logistic mean-variance model for the Gaussian kernels used in the dressing of ensemble forecasts of wind power generation. Applying an appro- priate GL-transform to wind power data allows dampening the eﬀect: the variance of the predictive densities for the transformed variable can then be assumed to be independent of its mean. Write {Xt} and {Yt} the stochastic processes whose realisations deﬁne the time-series {xt} and {yt}, following the preliminary deﬁnitions of Section 2. Wind power generation is null for wind speed values below cut-in speed, while being equal to nominal capacity when wind speed is above the rated speed. The values for cut-in and rated wind speeds may well vary depending upon the turbines and wind power portfolio considered. We consequently propose to write the predictive density for the wind power generation Xt+k at time t + k as Xt+k ∼ ω0 t+kδ0 + (1 − ω0 t+k − ω1 t+k)Lν(µt+k, σ2 t+k) + ω1 t+kδ1 (4) with δ0 and δ1 Dirac delta functions at 0 and 1, respectively, representing the potential concentration of probability mass at the bounds of the unit interval. To be consistent, one has ω0 t+k, ω1 t+k ∈ [0, 1], ω0 t+k + ω1 t+k ∈ [0, 1] The main reason for the introduction of this concentration of probability mass at the bounds is that the original variable to be GL-transformed must take values in (0, 1) only (as expressed in (1)). For the case of wind power, these bounds are obviously reached on a regular basis. Consider for instance issuing 10-minute ahead point forecasts of wind power generation at Horns Rev (the test case site of Section 5). Point forecasts correspond to the 1-step ahead conditional expectation of wind power production based on an AR model. The distributions of observed wind power generation conditioned upon the prediction level are depicted in Figure 2, for various power classes close to the natural generation bounds for that wind farm. The non-negligible concentration of probability mass at these bounds is visible from this Figure. In a general manner, other forms of distributions e.g. exponential ones, could be used in (4) instead of probability masses at the bounds. This would reﬂect that even if predicting zero (or nominal) power, there still may be some uncertainty. Based on (4), but now considering Yt+k the GL-transform of Xt+k, the form of its predictive density is given by Yt+k ∼ ω0 t+kδ−∞ + (1 − ω0 t+k − ω1 t+k)N (µt+k, σ2 t+k) + ω1 t+kδ+∞ (5) Similarly to the coarsening approach of Lesaﬀre et al. (2007) for the modelling of outcome scores in [0, 1] using classical logit-Normal distributions, we deﬁne a threshold value ǫ, being in the order of measurement precision, say ǫ ≤ 10 −2. Wind power values below or equal to ǫ (resp. above or equal to 1 − ǫ) are considered to be 0 (resp. 1). This 6 P. Pinson0.00.10.20.30.40.50.000.010.020.030.040.000.020.040.060.000.010.020.030.040.000.010.020.030.040.050.00.10.20.30.40.50.60.7 Figure 2. Distributions of observed power conditional to the predicted expected power (within [0,2] % of Pn, [2,4], [4,6], [94,96], [96,98], [98,100]). The same scale is used for the x axis in all bar plots. translates to constraining the range of potential variations of the GL-transformed variable, i.e. yt ∈ Dy = [γ(ǫ; ν), γ(1 − ǫ; ν)]. One can consequently rewrite (5) as Yt+k ∼ ω0 t+kδγ(ǫ;ν) + N (µt+k, σ2 t+k)1 ¯Dy + ω1 t+kδγ(1−ǫ;ν) (6) where ¯Dy is the complement of Dy and 1 ¯Dy the indicator function for this open interval, i.e. 1 ¯Dy = { 1, y ∈ ¯Dy 0, otherwise (7) The weight (1 − ω0 t+k − ω1 t+k) does not appear anymore in (6). This is because the pre- dictive density for Yt+k takes the form of a censored Normal instead. This permits to straightforwardly derive the expressions for the weights ω0 t+k and ω1 t+k, ω0 t+k = Φ ( γ(ǫ; ν) − µt+k σt+k ) , ω1 t+k = 1 − Φ ( γ(1 − ǫ; ν) − µt+k σt+k ) (8) with Φ the cumulative distribution function of a standard Normal variable. Predictive densities are then fully characterised by their location (µt+k) and scale (σt+k) parameters only. 4. Dynamic models for the location and scale parameters We aim to show the advantages of modelling and forecasting wind power time-series with GL-Normal variables, not to discuss the superiority of certain dynamic models. Therefore the developments gathered below concentrate on fairly simple dynamic models only. They could however be extended to account for additional eﬀects e.g. conditional heteroskesdatic- ity or regime-switching dynamics. It would clearly call for modiﬁcation of the estimation Probabilistic forecasting of wind power 7 methods described. GL-Normal densities could also be envisaged for further lead times (i.e. from a few hours to a few days ahead), for which appropriate statistical approaches should account for the nonlinear transformation of the dynamic information provided by meteorological predictions. To give a brief overview of our approach, AR and CP-AR models are proposed for the location parameter. In parallel, the scale parameter is viewed as constant in the former case, or as a nonlinear function of the covariate conditioning the AR dynamics in the latter one. Only AR types of dynamics are considered, as earlier results on similar oﬀshore data suggested that such dynamics for the mean are appropriate when considering short lead times (Pinson and Madsen 2011). Extensive data analysis reported by Vincent et al. (2010) and Vincent et al. (2011) showed that seasonalities were not observed at the Horns Rev wind farm considered as a case study in the following. They are thus not accounted for in the various models below. Model coeﬃcients are adaptively and recursively estimated based on an exponential forgetting of past observations. This proposal follows from various results reported in the literature (Gneiting et al. 2006, Pinson and Madsen 2011, Sanchez 2006, Vincent et al. 2010, e.g. ) showing that parameters in dynamic models should be seen as slowly changing over time. This is because the dynamics of the processes involved may well vary at time scales of months, seasons and years, with features that cannot easily be accounted for in the models themselves in a parametric framework. 4.1. Autoregressive dynamics In the case of AR dynamics, the expression relating the location parameter µt+k to previous observations writes µt+k = θ⊤ ˜yt (9) where θ = [θ0 θ1 . . . θl]⊤ and ˜yt = [1 yt . . . yt−l+1]⊤. This is while the scale parameter is deﬁned as a constant, i.e. σ2 t+k = β. The maximum lag l can be determined after examining the autocorrelation and par- tial autocorrelation functions of the {yt} time-series, by minimisation of either Akaike Information Criterion (AIC), Bayesian Information Criterion (BIC), or ﬁnally through a cross-validation exercise. Note that in the case of censored Normal variables, the location parameter may take values outside of the range within which yt is constrained. The {yt} time-series corresponds to realisations of censored Normal variables. It may be argued that the vector of AR parameters θ can be estimated with either Least-Squares (LS) or Maximum-Likelihood (ML) techniques. In the case of censored Normal variables, the LS-estimator for the location parameter is certainly more subject to estimation bias than the ML-estimator. Experiments on wind power generation data showed that the LS- estimator of the location parameter was acceptable, while having the advantage of simplicity of implementation if compared with the ML-estimator. This is the reason why we only consider and describe the LS-estimator below. The parameters θ are estimated within a Recursive Least Squares (RLS) framework (Ljung and S¨oderstr¨om 1983, Madsen 2007). The scale parameter σt+k can similarly be tracked accordingly. Recursive estimation oﬀers the advantage that only the last available measurements are used at each time step for updating the model parameters. This contrasts with the more computationally-intensive idea of employing a sliding window, as done by Gneiting et al. (2006) and Hering and Genton (2009), for which estimation is performed on a bulk of data at each time step. 8 P. Pinson The estimate of the parameters θt at time t is deﬁned as ˆθt = arg min θ t∑ i=1 λt−i (yi − θ⊤ ˜yi−k)2 (10) where λ is the forgetting factor, λ ∈ (0, 1), allowing for the exponential forgetting of past observations, for which the corresponding eﬀective number of observations is deﬁned as nλ = (1 − λ)−1. The value of the forgetting factor is typically slightly below 1. In a recursive framework, the formulae for updating the LS-estimate of θt based on the newly available information at time t summarises to ˆRt = λ ˆRt−1 + ˜yt−k ˜y⊤ t−k (11) ˆθt = ˆθt−1 + ˆR−1 t ˜yt−kεt (12) where εt is deﬁned as εt = yt − θ⊤−1 ˜yt−k. Note that there is a direct correspondence of the RLS estimator in the above with what would be the Kalman ﬁlter estimator of ˆθt in a state-space framework. These aspects are extensively discussed by e.g. Madsen (2007) and Li (2008). Consequently, it is interesting to note that the posterior distribution of the true parameter θt given the available information up to time t − 1 is Gaussian with mean ˆθt−1 and covariance ˆR−1 t−1 (Ljung and S¨oderstr¨om 1983, pp. 55-56). The update (12) of the parameter estimates does not ensure that they will remain within the stationary region. This does not appear to be a problem for the 1-step ahead forecasting application. It would be more problematic if aiming at simulating the process over a period of time or at issuing multi-step ahead forecasts. With time-varying parameters, it may also well be that the parameter estimates cross into the nonstationary region and then get back into the stationary one after few time steps. Since the scale parameter is given by a constant only, its adaptive estimation at time t can be performed thanks to an exponential smoothing scheme, being consistent with the way we update the parameters of the dynamic model for µt+k. Owing to the sensitivity of the GL transform close to the bounds of the unit interval, we have noticed that it would be beneﬁcial to robustify the exponential smoothing of the scale parameter. This can be carried out by down-weighting observations when the location parameter gets closer to the bounds. Our proposal for this weight is given by wt = 4θ⊤ ˜yt−k (1 − θ⊤ ˜yt−k) , wt ∈ [0, 1] (13) And the resulting exponential smoothing scheme writes ˆβt = λ∗ ˆβt−1 + (1 − λ∗) (yt − θ⊤ ˜yt−k)2 (14) with λ∗ = 1 − (1 − λ)wt. It appears appropriate to initialise θt with a vector of zeros, the resulting model hence corresponding to white noise. βt may be initialised with a small value or alternatively with an expert guess. In parallel, the inverse covariance matrix ˆRt can be initialised as an identity matrix times a small constant, yielding a small load on its diagonal. Only the updating formula (11) is used for the ﬁrst steps of the recursive estimation procedure in order to gather suﬃcient information on the process characteristics. When that point Probabilistic forecasting of wind power 9 is reached (say, for t > 50), both (12) and (14) are also employed at each time step for updating the models for the location and scale parameters. Note that ˆRt is necessarily invertible in view of the updating performed in (11), as long as the underlying model is not over-parametrized. 4.2. Conditional parametric autoregressive dynamics If considering CP-AR dynamics instead, the constant parameters in (9) are replaced by coeﬃcient functions of some covariate, these functions being of unknown form, µt+k = θ(ω)⊤ ˜yt (15) where θ(ω) = [θ0(ω) θ1(ω) . . . θl(ω)]⊤, while ˜yt is deﬁned as in (9). In parallel the model for the scale parameter becomes an unknown function of this same covariate, i.e. σ2 t+k = β(ω). The maximum lag l in the dynamic model above can be chosen similarly to that for the more simple AR dynamics. Recent developments on conditional parametric and the more general varying-coeﬃcient models are reported in Fan and Zhang (2008). The most obvious choice for ω is wind direction, since it directly induces shadowing eﬀects within a wind park, thus aﬀecting the dynamic response of that wind park to mete- orological conditions. Wind direction might also inﬂuence the wind speed dynamics them- selves, as is the case at Horns Rev for instance (Vincent et al. 2010). We denote by ωt the wind direction measurement at time t, ωt ∈ [0, 2π]. In view of the short lead times considered in the test case application, conditioning the AR dynamics upon the wind direc- tion measurement available at time t can be seen as reasonable. If focusing on further lead times, it would certainly be beneﬁcial to use wind direction forecasts instead. The coeﬃcient functions θ(ω) and β(ω) are estimated in a nonparametric framework, i.e. without assuming a shape for these functions. The method for their adaptive and recursive estimation combines local kernel regression and RLS with exponential forgetting. The estimation procedure described below is in the spirit of Nielsen et al. (2000) and Pinson et al. (2008), to which the reader is referred to for more details. The only assumption about the coeﬃcient functions is that they are suﬃciently smooth to be locally approximated with constants. The estimation problem reduces to locally ﬁtting linear models at a number m of ﬁtting points ω(j). Deﬁning these ﬁtting points is best done by using information on the distribution of ω. Let us focus on a single ﬁtting point ω(j) only. The objective function to be minimised at each time t consists of a modiﬁed version of that used for adaptive estimation of the AR-dynamic model considered above. The estimate of the set of local coeﬃcients at ω(j) and at time t is deﬁned as ˆθ(j),t = arg min θ(j) t∑ i=1 Λ(j),t(i)c(j),i (yi − θ⊤ (j) ˜yi−k)2 (16) where the weights c(j),i to be assigned to past observations are given by a Kernel function of the form c(j),i = T ( |ωi − ω(j)| ℏ(j) ) (17) In the above, |.| denotes a polar distance, being consistent with ω being a circular variable. ℏ(j) is the bandwidth of the kernel assigned to ω(j). T may for instance be chosen as a 10 P. Pinson tricube function, T (v) = { (1 − v3)3, v ∈ [0, 1] 0 , v > 1 (18) In parallel in (16), Λ(j),t is the function that permits the exponential forgetting of past observations, i.e. Λ(j),t(i) = { λeﬀ (j),tΛ(j),t−1(i), 1 ≤ i ≤ t − 1 1 , i = t (19) λeﬀ (j),t is the eﬀective forgetting factor for the ﬁtting point ω(j). It follows the deﬁnition given by Nielsen et al. (2000), which links λeﬀ (j),t and c(j),t so that λeﬀ (j),t = 1 − (1 − λ)c(j),t (20) where λ is the classical user-deﬁned forgetting factor, λ ∈ (0, 1). This eﬀective forget- ting factor ensures that old observations are down-weighted only when new information is available. A little algebra, which is skipped here since extensively covered by Nielsen et al. (2000) and Pinson et al. (2008), yields the set of recursive formulae for the adaptive estimation of the local coeﬃcients ˆθ(j),t, ε(j),t = yt − ˆθ⊤ (j),t−1 ˜yt−k (21) R(j),t = λeﬀ (i),tR(j),t−1 + c(j),t ˜yt−k ˜y⊤ t−k (22) ˆθ(j),t = ˆθ(j),t−1 + c(j),tR−1 (j),t ˜yt−kε(j),t (23) One sees that when the weight c(j),t equals 0 (thus meaning that the local estimates should not be aﬀected by new information), then one has ˆθ(j),t = ˆθ(j),t−1 and R(j),t = R(j),t−1. This conﬁrms the role of the eﬀective forgetting factor, i.e. to down-weight old observations, but only when new information is available. In parallel, one has to estimate ˆβ(j),t, the local constant that deﬁnes the scale parameter at time t and at ω(j). As an extension to (14), it is given by ˆβ(j),t = λ∗ (j),t ˆβ(j),t−1 + (1 − λ∗ (j),t) (yt − θ⊤ (j),t ˜yt−k)2 (24) with λ∗ (j),t = 1 − (1 − λ)wtc(j),t, wt still being deﬁned by (13). When starting the recursive process, the local inverse covariance matrices R(j),t, as well as the local parameter estimates ˆθ(j),t and ˆβ(j),t, can be initialised for all ﬁtting points as in Section 4.1 for the case of AR dynamics. The value of the parameter estimates ˆθt(ω) and ˆβt(ω) for any ω can then be obtained by interpolation through the estimated local parameters at the various ﬁtting points ω(j) (j = 1, . . . , m). 5. Application and results Focus is given here to the application of the methodology and models described above to the test case of an oﬀshore wind farm, for 10-minute ahead forecasting of wind power production. Such lead time corresponds to one-step ahead forecasts in view of the temporal resolution Probabilistic forecasting of wind power 11 of the time series considered. Note though that the methodology has been introduced for general direct k-step ahead forecasting. Indeed, one could work along the lines of Gneiting et al. (2006) for instance, and build models for direct 2-step ahead forecasting. Statistical models based only on historical measurements are in order for forecast horizons up to 6-8 hours ahead. However for horizons further than one hour ahead, dynamic information from meteorological forecasts permits to signiﬁcantly improve forecast accuracy (Giebel et al. 2011, Costa et al. 2008). The test case and available data are introduced in the ﬁrst stage, followed by a detailed description of the model conﬁguration and estimation setup employed. The paper also discusses the way forecasts are evaluated, as well as the benchmarks considered. Application results and related comments are gathered at the end. 5.1. Test case and available data We consider the case of the oﬀshore wind farm located at Horns Rev, oﬀ the west coast of Jutland in Denmark. This wind farm has a nominal capacity Pn of 160 MW. The original wind and power measurement data includes raw one-second measurements for each wind turbine. Focus is given to the total power output, normalised by Pn, and to the average wind direction for the wind farm. An averaging procedure has been developed in order to obtain time-series of 10-minute wind direction and power averages. This averaging rate makes the very fast ﬂuctuations related to the turbulent nature of the wind disappear and reveal slower ﬂuctuations at the minute scale. Because there may be some erroneous or suspicious data in the raw measurements, the averaging procedure has a threshold parameter τv, which corresponds to the minimum percentage of data needed to be considered as valid within a given time interval, so that the related power (or wind direction) average is also considered as valid. Choosing a suﬃciently high value for τv permits to avoid sampling eﬀects in the averaging procedure that would impact the representativeness of the average values obtained. The threshold chosen is τv = 75%. The available raw data is from 16 th February 2005 to 25 th January 2006, consisting of 49536 data points. As a result of the averaging procedure, the wind direction and power generation dataset consists of 41651 valid data points. 5.2. Model conﬁguration, estimation setup and benchmarking From the available data, two periods are deﬁned, the ﬁrst one being used for identiﬁcation (and initial training) of the statistical models, and the second one for evaluating what the performance of these models may be in operational conditions. The ﬁrst 15120 data points (with 11968 valid ones) are employed as the learning set, exactly covering the months from February to May 2005. The remainder of the dataset, covering a period from June 2005 to January 2006, is used for out-of-sample evaluation of 1-step ahead forecast performance. This evaluation set contains 34536 data points, including 29683 valid ones. Over the learning period, a part of the data is used for one-fold cross validation (the last 9000 points) in order to select an optimal autoregressive order for the dynamic models, the values of the forgetting factors, the shape parameter of the GL-transformation, as well as the ﬁtting points and bandwidths for the case of the conditional parametric models. Actually, instead of considering the forgetting factor itself, it is preferred to use the corresponding eﬀective number of observations nλ. It allows one to better appraise the size of the equivalent ‘sliding window’ in the adaptive estimation of the dynamic model parameters, such as that 12 P. Pinson considered by Gneiting et al. (2006) and Hering and Genton (2009). In parallel, the censoring parameter ǫ is arbitrarily set to ǫ = 0.001, corresponding to the resolution of the power measurements. Selection of optimal values for the model structure and parameters nλ and ν is done in a trial-and-error manner, by evaluating the results obtained from a set of diﬀerent setups. For more information on cross validation, we refer to Stone (1974). The criterion to be minimised over the cross-validation set is the Continuous Rank Probability Score (CRPS) of 1-step ahead density forecasts. The CRPS is a common proper skill score used for the evaluation of density forecasts (Gneiting et al. 2007). For the CP-AR dynamics, the bandwidth values are selected similarly. Focusing on the order of the various models ﬁrst, results from Pinson and Madsen (2011) suggest that a maximum lag l = 3 is suﬃcient for capturing the dynamics in oﬀshore wind power ﬂuctuations with a 10-minute resolution, at the Horns Rev wind farm. We veriﬁed that for all models considered, a signiﬁcant decrease in 1-step ahead CRPS values can be observed when augmenting l up to l = 3, and that no further beneﬁt is obtained by further increasing the value of l. Applying a parsimonious model principle, we then decide to concentrate on models of order l = 3 only. In all cases, the AR models are initialised as simple random walk models, with very low variance of predictive densities. In the case of the GL-Normal densities and AR dynamics, one may consider the selection of nλ and ν to be performed simultaneously or iteratively. It has been observed for the data of the present case-study that both ways yielded similar results. We thus present them below in Figure 3 after nλ and ν were optimised one after the other, iteratively. More precisely, Figure 3(a) depicts the variations in 1-step-ahead CRPS for ν ﬁxed to its optimal value, and with nλ varying between 100 and 10.000, with steps of 100 observations. Similarly, Figure 3(b) shows the evaluation of the 1-step-ahead CRPS for nλ ﬁxed to its optimal value, and with ν varying between 0.2 and 5, with increments of 0.2. The overall minimum 1-step-ahead CRPS value on the cross-validation set is obtained for nλ = 2500 (corresponding to approximately 17.5 days) and ν = 3.2. This optimal value for nλ is smaller than the 45 days deemed optimal for the sliding estimation windows of Gneiting et al. (2006) and Hering and Genton (2009) when considering lead times of 2 hours. The speed of change in the characteristics of wind and power dynamics certainly depends upon the temporal resolution of the time-series. It may also be related to the local wind climate: the oﬀshore wind farm at Horns Rev is known for particular characteristics of its wind and power dynamics (Pinson and Madsen 2011, Vincent et al. 2011). Figure 3(b) demonstrates the interest of introducing the generalised form of the logit transformation and hence to generalise the use of the more classical logistic transform by Lau and McSharry (2010): a signiﬁcant decrease in CRPS is seen for ν > 1, i.e. when considering negatively-skewed mean-variance relationships for the GL-Normal predictive densities. Our proposal probabilistic forecasting methodology seems to be fairly robust with respect to the choice of nλ and ν values, as the 1-step-ahead CRPS of predictive densities does not vary much for nλ ∈ [2000, 4000] and for ν ∈ [2.5, 3.5]. Turning our attention to the GL-Normal predictive densities with CP-AR dynamics, an exercise similar to that performed above led to the same values for nλ and ν, i.e. nλ = 2500 and ν = 3.2. In addition, the location of the ﬁtting points and related bandwidth values for the local ﬁtting of coeﬃcient functions have to be selected. It has been arbitrarily decided to use 16 ﬁtting points, as such a number allows a fairly good coverage of potential wind directions values, while limiting the computational power needed. The spreading of these ﬁtting points has been performed in view of the distribution of wind direction values over the learning period, i.e. such that there is the same frequency of data between any two Probabilistic forecasting of wind power 13 0 2000 4000 6000 8000 10000 1.9 2 2.1 2.2 2.3 n λCRPS [% of Pn] (a) As a function of nλ (for ν = 3.2) 0 1 2 3 4 5 1.9 2 2.1 2.2 2.3 νCRPS [% of Pn] (b) As a function of ν (for nλ = 2500) Figure 3. Evolution of the 1-step-ahead CRPS of GL-Normal density forecasts of wind power gen- eration based on simple AR-dynamics. These results are obtained on the cross-validation set, as a function of the parameters nλ and ν. successive ﬁtting points. Regarding the Kernel bandwidth in (17), both ﬁxed and nearest- neighbour bandwidths have been envisaged. The latter concept was preferred, in order to be consistent with the idea introduced above, so it would be more consistent to respect the distribution of wind direction data when deﬁning the ﬁtting points. Following Nielsen et al. (2000), the nearest-neighbour bandwidth is deﬁned by the share of the (wind direction) data that should be covered by the Kernel attached to any single ﬁtting point. This share is chosen here to be 60% in order to obtain suﬃciently smooth variations of the coeﬃcient functions in the CP-AR model. Smaller values have been tested, though not improving the forecast performance of the model over the cross-validation set. The resulting setup for the ﬁtting points and related bandwidth values is depicted in Figure 4, along with the corresponding wind rose at Horns Rev. In the polar representation of Figure 4(b), the polar coordinates give the location of the ﬁtting points, while the bandwidths values are given by the ordinate of the various points. It is visually straightforward to recognise that less ﬁtting points and higher bandwidth values are present in areas with less data available. As a basis for the evaluation of the forecast performance of the methodology introduced in the paper, diﬀerent types of benchmark methods are considered, some of them being reviewed by Giebel et al. (2011), Costa et al. (2008) and Pinson and Madsen (2011). First of all for point forecasting the persistence forecast method, for which the forecast at time t + k is given by the measurement available at time t, is known to be diﬃcult to outperform for short lead times. Another basic benchmark is an extension of persistence based on the average of the last few measurements. To be consistent with the autoregressive orders of the models employed here, this moving average benchmark consists of the average of the last 3 measurements. In parallel the most common benchmark for probabilistic forecasts of meteorological or weather-related processes is climatology, which is based on always issuing the same unconditional predictive density built from all historical observations available. Since climatology is fairly easy to outperform for short lead times, we also consider the 14 P. Pinson 500 1000 1500 2000 30 210 60 240 90 270 120 300 150 330 180 0W N E S (a) wind rose 50 100 150 30 210 60 240 90 270 120 300 150 330 180 0W N E S (b) ﬁtting points and related bandwidth values Figure 4. Wind rose, ﬁtting points and related bandwidths values based on the distribution of wind di- rection values over the learning set. All values are in degrees, following the trigonometric convention. probabilistic generalization of persistence based on a random walk model as a benchmark. At a given time this probabilistic forecast takes the form of a Gaussian predictive density with its mean given by the last available power measurement and its variance resulting from exponential smoothing of past squared residuals. For consistency, this exponential smoothing uses the same forgetting factor as for the more advanced approaches considered, i.e. with nλ = 2500. The main objective of the present paper is to demonstrate the interest of considering GL-Normal distributions for wind power prediction. As a basis for comparison, we there- fore consider similar forecasting methodologies based on more classical assumptions about the shape of predictive densities, but with the same dynamical models for their location and shape parameters. For point forecasting the common assumption is that of a Normal distribution, while in a probabilistic forecasting framework, the most common ones are (cen- sored) Normal or Beta distributions (Bludszuweit et al. 2008, Pinson and Madsen 2011). Additional point and probabilistic forecasts based on these assumptions will be seen as a benchmark. Results will be given for AR models only, and labelled as ‘Normal AR’ and ‘Beta AR’. The optimal value found for the eﬀective number of observations nλ is nλ = 2000 (corresponding to approximately 14 days) for the case of both assumptions on predictive densities. 5.3. Results and comments A fully probabilistic approach to forecast evaluation is employed. This means that focus is given to evaluating the quality of predictive densities, including their reliability and overall skill, as well as to assessing the quality of some point forecasts that can be extracted from such predictive densities. Following the point of Gneiting (2011) among others, one should extract the optimal point forecasts from predictive densities based on the target evaluation Probabilistic forecasting of wind power 15 Table 1. Monthly results for the evaluation of point forecasts extracted from density forecasts: focus on the NMAE for the median (in % of the nominal capacity Pn). Best score values are highlighted using bold fonts. Month Jun. Jul. Aug. Sept. Oct. Nov. Dec. Jan. All Moving average 3.44 3.28 3.47 3.62 3.47 3.57 3.60 3.62 3.50 Persistence 2.40 2.43 2.50 2.50 2.40 2.59 2.61 2.47 2.48 Normal AR 2.34 2.42 2.48 2.43 2.33 2.64 2.63 2.45 2.45 GL-Normal AR 2.32 2.35 2.43 2.38 2.28 2.47 2.54 2.40 2.38 GL-Normal CP-AR 2.31 2.34 2.42 2.37 2.26 2.47 2.53 2.36 2.36 Table 2. Monthly results for the evaluation of point forecasts extracted from density forecasts: focus on the NRMSE for the expectation (in % of the nominal capacity Pn). Best score values are highlighted using bold fonts. Month Jun. Jul. Aug. Sept. Oct. Nov. Dec. Jan. All Moving average 5.70 6.06 5.93 6.35 5.79 8.06 6.35 5.88 6.31 Persistence 3.98 4.68 4.47 4.66 4.17 6.23 4.76 4.28 4.70 Normal AR 3.80 4.56 4.36 4.46 3.97 6.00 4.62 4.20 4.54 GL-Normal AR 3.81 4.57 4.32 4.43 3.96 5.87 4.55 4.12 4.50 GL-Normal CP-AR 3.79 4.53 4.30 4.42 3.93 5.87 4.56 4.08 4.47 score. Indeed, the median of predictive densities should be selected if the target evaluation score is of the Mean Average Error type (abbreviated MAE, or NMAE for its normalised version). Similarly, if the target score is of quadratic nature like the Root Mean Square Error (RMSE, or NRMSE for its normalized version), the optimal point forecast to be extracted is the expectation of predictive densities. In view of these aspects, we focus ﬁrst on the quality of point forecasts related to the median and expectation of predictive densities, since the corresponding NMAE and NRMSE scores appear to be the most employed in the wind power forecasting literature (Giebel et al. 2011, Costa et al. 2008, Madsen et al. 2005). Owing to the length of the evaluation set (approximately 8 months), it has been chosen to study these scores overall and on a monthly basis. The evaluation results for point forecasts based on the persistence and moving-average benchmarks, as well as for the Normal-AR, and the proposed GL- Normal AR and CP-AR predictive densities, are collated in Tables 1 and 2. Whatever the score considered, the persistence benchmark indeed seems competitive: the more advanced approaches only propose overall improvements up to 5%. This is due to the inertia in local atmospheric processes at such temporal scales. Persistence has a clear advantage over the other moving-average benchmark, for which all score values are much higher. Even though monthly ﬂuctuations can be observed in the NMAE and NRMSE scores, it appears that the Normal AR benchmark almost consistently outperforms the persistence and moving-average benchmarks, while being outperformed by the point forecasts extracted from GL-Normal predictive densities. A slight gain in point forecast accuracy is also seen if considering that the moments of GL-Normal predictive densities may vary as a function of wind direction, as is the case with the CP-AR dynamic model. The recent work of Gallego et al. (2011), where it was shown that for short lead times wind direction inﬂuences power dynamics in a smooth manner and that this should be accounted for in statistical approaches to forecasting, conﬁrms our results. In the second stage, we look at the quality of predictive densities, concentrating ﬁrst on 16 P. Pinson Table 3. Monthly results for the evaluation of density forecasts with a CRPS criterion (in % of the nominal capacity Pn). Best score values are highlighted using bold fonts. Month Jun. Jul. Aug. Sept. Oct. Nov. Dec. Jan. All Climatology 18.67 19.75 20.07 18.61 19.79 24.65 21.81 21.63 20.47 Persistence 2.30 2.06 2.03 2.06 1.96 2.35 2.29 2.02 2.12 Normal AR 1.85 2.01 1.99 1.98 1.87 2.31 2.23 1.97 2.01 Beta AR 1.81 1.91 1.96 1.93 1.78 2.08 2.08 1.90 1.92 GL-Normal AR 1.76 1.80 1.86 1.86 1.81 1.93 1.92 2.03 1.86 GL-Normal CP-AR 1.73 1.78 1.82 1.81 1.71 1.94 1.88 1.79 1.80 their overall skill by employing the CRPS criterion, being a proper skill score. Extensive discussion about the evaluation of probabilistic forecasts through the use of proper scoring rules can be found in Gneiting et al. (2007). Similar to the above, the CRPS criterion is calculated on a monthly basis as well as globally. Evaluation results are gathered in Table 3, for the two basic benchmarks (climatology and the probabilistic extension of persistence), Normal-AR and Beta-AR predictive densities, and ﬁnally for the proposed GL-Normal AR and CP-AR probabilistic forecasts. The improvements in terms of the CRPS criterion are signiﬁcant when going from the Normal predictive densities to GL-Normal predictive densities, in the order of 7.5%, and consistent over the evaluation period. The fact that Beta predictive distributions have a varying shape consistent with the double-bounded nature of wind power is reﬂected by the CRPS values for the Beta-AR predictive densities. The additional feature of GL- Normal distributions consisting of their natural mean-variance relationship still gives them an advantage though. Like for the case of point forecasts in the above, an additional improvement is observed if considering that the parameters of GL-Normal densities should be made a function of wind direction. The overall decrease in the CRPS criterion when going from Normal predictive densities with AR dynamics to GL-Normal predictive densities with CP-AR dynamics is of 10.5%. The climatology benchmark is dramatically outperformed in all cases, while the probabilistic extension of persistence still appears as a competitive benchmark. Overall, non-negligible beneﬁts may be achieved by proposing adequate models for the wind power dynamics combined with an improved assumption about the shape of predictive densities. We somehow expect that such improvement comes from the fact that GL-Normal pre- dictive densities are more probabilistically reliable (or in other words, calibrated) than the Normal ones. Calibration of predictive densities can be assessed through the use of e.g. Probability Integral Transform (PIT) histograms, as carried out by Gneiting et al. (2006), or with reliability diagrams in the form of quantile-quantile plots, as in Figure 5. Such re- liability diagrams depict the observed proportions of a set of quantile composing predictive densities of wind power generation against the nominal ones (Pinson et al. 2007b). Here the set of quantiles is deﬁned with a step of 5% in their nominal proportions. This assess- ment of the reliability of calibration of the quantiles composing predictive densities directly builds on their very deﬁnition: a quantile forecast with nominal proportion α should cover the actual observation α% of the time. Climatology is not represented since it has perfect marginal calibration. Normal-AR predictive densities introduce a systematic and signiﬁcant probabilistic bias in the probabilistic forecasts they provide. Predictive densities seem to be too wide on average, since observed proportions are larger than the nominal ones for nominal proportions Probabilistic forecasting of wind power 17 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 nominal proportionsobserved proportions reference Normal AR Beta AR GL−Normal AR GL−Normal CP−AR persistence Figure 5. Evaluation of the reliability of predictive densities with reliability diagrams in the form of quantile-quantile plots. above 0.5, and inversely for nominal proportions below 0.5. A simple explanation is that the variance of predictive densities is not conditional to the level of wind generation. Since wind generation is quite often at a medium level, the exponentially smoothed error variance used for the variance of predictive densities is fairly high. The variance is consequently over-predicted when wind generation is at a low and high level. The calibration results for the persistence benchmark are very close to that of Normal-AR predictive densities owing to the similarity in their deﬁnition. In contrast when employing GL-Normal distributions for probabilistic forecasting, predictive densities do not tend to be systematically over- or under-dispersive due to their natural mean-variance relationship. This appears to be valid for both types of dynamics considered for the mean of predictive densities. Similarly to GL- Normal predictive densities, the Beta-AR densities have an acceptable level of reliability due to their natural shape variations as a function of their location parameter. It was argued that the doubled-bounded nature of wind power generation causes the fact that the shape of predictive densities ought to vary depending upon the power level. This motivated the proposal of GL-Normal predictive densities. In parallel following Gneiting et al. (2007) and other authors, the correspondence of predicted probabilities and observed frequencies should be veriﬁed for the evaluation set as a whole but potentially also for any subset. The calibration of predictive densities is hence further investigated as a function of the level of power, in a spirit similar to that of Pinson et al. (2007b). Mutually exclusive subsets of the evaluation set are deﬁned based on measurements, so that they are the same for all probabilistic forecasting approaches, following the proposal for calibration assessment based on forecast strata introduced and extensively discussed by Br¨ocker (2008). The criterion employed for quantifying the lack of calibration of predictive densities is the Mean Absolute Deviation from Calibration (MADC), deﬁned as the integrated absolute diﬀerence between the reference case of perfectly calibrated forecast and the observed proportions of the quantiles of predictive densities. It then represents the area between the reliability 18 P. Pinson Table 4. Results for the evaluation of the calibration of predictive densities conditional to the level of measured power and overall, with the MADC criterion (in %). Level [0,0.2] [0.2,0.4] [0.4,0.6] [0.6,0.8] [0.8,1] Overall Climatology 38.86 26.64 20.03 23.33 34.91 0 Persistence 7.85 6.92 5.99 5.78 5.99 5.82 Normal AR 19.38 10.71 2.99 2.70 11.61 7.91 Beta AR 21.71 10.56 3.28 2.26 16.75 2.41 GL-Normal AR 6.50 3.43 6.34 5.80 6.85 2.85 GL-Normal CP-AR 9.19 1.78 3.45 3.17 11.15 2.22 curves and the diagonal as in the case of the reliability diagram of Figure 5. Lower MADC values indicate more reliable predictive densities. It is calculated in the case of the whole evaluation set and over subsets deﬁned by various ranges of measured wind power, e.g. when normalized wind power generation is between 0 and 0.2. The corresponding results are summarised in Table 4, with the “overall” column giving the MADC values for the reliability assessment presented in Figure 5. Climatology has perfect reliability when evaluated over the whole evaluation set since predictive densities are unconditional and directly derived from the collected measurements. This unconditional nature is clearly aﬀecting its reliability when assessed over the various subsets deﬁned by the level of observed wind power owing to the level-varying characteristics of the stochastic process. A similar result can be observed for the case of Normal-AR and Beta-AR predictive densities for low and high power values. For medium power values, the low MADC values indicate that both Normal and Beta assumptions, as well as the related variance estimation, are fairly acceptable. When looking across the various levels of measured power and at overall results, both persistence and GL-Normal predictive densities seem to be better calibrated. One remembers, however, that calibration is only one aspect of probabilistic forecasting skill (Gneiting et al. 2007). Appropriate ranking of competing approaches can only be carried out based on the skill score values of Table 3. Based on all the results presented, GL-Normal predictive densities appear to be best, with a fair advantage to the CP-AR dynamics for their location and scale parameters. And even if persistence seems to have an acceptable calibration, this does not translate to these benchmark probabilistic forecasts having a competitive skill level (as seen from Table 3). For illustrative purposes, Figure 6 depicts an episode with 375 successive time-steps of quantile forecasts (with nominal proportions 0.05 and 0.95) extracted from GL-Normal predictive densities with CP-AR dynamics, along with the corresponding measurements. One can easily observe that the predictive densities are naturally bounded between 0 and 1, and that the variance of GL-Normal densities is larger when the conditional expectation of the process is at a medium level. It is harder though to see that both dynamics and variance of the predictive densities are a function of the wind direction onsite. Let us have a look at some of the parameters of the CP-AR dynamic model, more speciﬁcally the coeﬃcient for the ﬁrst autoregressive lag, as well as the variance of the GL-Normal predictive densities, at the end of the evaluation set. These various quantities are represented in polar coordinates in Figure 7. Variations as a function of the wind direction ω can be observed. The variance of predictive densities appears to be signiﬁcantly higher for Westerly and North-Westerly winds, and lower for the other sectors. This is in line with the extensive wind data analysis performed by Vincent et al. (2010) and Vincent et al. (2011) based on meteorological measurements obtained at Horns Rev. It was observed that wind ﬂuctuations (and by Probabilistic forecasting of wind power 19 extension wind power ﬂuctuations) tend to have a higher variance for winds coming from the North Sea, thus from Westerly and North-Westerly directions, than for winds coming from land. 0 50 100 150 200 250 300 350 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 time steps [x10mins]normalized power 5% quantile forecasts 95% quantile forecasts measurements Figure 6. Episode of 375 time-steps (with a time resolution of 10 minutes), with quantile forecasts of nominal proportions 0.05 and 0.95, along with related normalised wind power measurements. These quantile forecasts are extracted from the predictive densities with CP-AR dynamics. 0.5 1 1.5 30 210 60 240 90 270 120 300 150 330 180 0W N E S (a) θ1(ω) 0.05 0.1 0.15 30 210 60 240 90 270 120 300 150 330 180 0W N E S (b) σ2(ω) Figure 7. Some of the CP-AR model parameters as a function of the wind direction ω at the end of the evaluation set. 20 P. Pinson 6. Concluding remarks A generalization of the logit-Normal distribution was introduced in order to properly ac- count for the nonlinear and double-bounded nature of wind power generation in short-term probabilistic forecasting. It was observed that its characteristics make it more appropri- ate than the more commonly assumed Normal and Beta distributions. We believe that GL-Normal distributions could be viewed as a basic feature of parametric probabilistic forecasting methodologies for lead times between a few minutes and a few days ahead. Be- ing fully characterised by a location and a scale parameter only (assuming that the shape parameter is a meta-parameter estimated once and for all from available data), fairly simple models can be employed for the description of its dynamics. In our proposal forecasting methodology, predictive densities of wind power take the form of discrete-continuous mixtures consisting of these GL-Normal distributions with po- tential concentration of probability mass at the bounds of the unit interval [0, 1]. These mixtures could be rethought in the future based on further data analysis and if looking at longer lead times. Since forecast uncertainty may not be null when predicting zero or nominal power, probability masses should be replaced by exponential distributions, the pa- rameters of which would then also have to be estimated. For these more general mixtures, it will certainly be beneﬁcial to develop estimation methods in a dynamic (Bayesian) model averaging framework, as in Raftery et al. (2010). The models employed for the location and scale parameters of the predictive densities account for the autoregressive nature of the wind power generation process, as well as the non-linear inﬂuence of wind direction. For further lead times and multi-step ahead forecasting some of the numerous models described in the literature could be employed for the dynamics of GL-Normal distribution parameters. They could for instance account for additional eﬀects and covariates, like meteorological measurements which are known to be important for short lead times (Gallego et al. 2011), or meteorological forecasts for lead times further than 6 hours ahead. More particularly for very short-term forecasts, the proposal of new dynamic models should be supported by some of the recent and extensive data analysis studies performed based on wind, wind power and other meteorological data. For the case of this oﬀshore site, the results from Pinson and Madsen (2011) suggest that regime-switching may be present in the time-series of wind power generation. This is conﬁrmed by the results of Vincent et al. (2011) explaining that these switches relate to local thermal eﬀects, atmospheric stability and to the presence of convective cells in the vicinity or over this site. Regime-switching approaches are also relevant for onshore sites especially in complex terrain environments, as investigated by Gneiting et al. (2006) when focusing on wind channelling eﬀects. GL-Normal distributions should also be considered for the modelling and forecasting of other nonlinear and bounded processes where it is expected or known that the eﬀects of the bounds are not symmetrical, as for bounded economic variables (Wallis 1987). For the wind power application, the shape parameter ν of GL-Normal distributions will surely vary from site to site. In a more general manner, this parameter will depend upon the process considered and should be estimated from data. The cross-validation approach employed here yielded acceptable results. It may however be envisaged to develop a more rigorous framework based on e.g. maximum likelihood estimation for selecting ν. Probabilistic forecasting of wind power 21 Acknowledgements The work presented has been partly supported by the European Commission under the SafeWind project (ENK7-CT2008-213740), by the Danish Public Service Obligation (PSO) programme through the project ‘Radar@Sea’ (PSO-2009-1-0226), and ﬁnally by the Danish Research Council for Tech- nology and Production Sciences (FTP-274-08-0573), which are hereby acknowledged. We are thank- ful to Vattenfall Denmark for originally providing the wind power measurements for the Horns Rev wind farm, Pierre-Julien Trombe for the data processing and quality checking, as well as Tilmann Gneiting, Niels K. Poulsen and Henrik Madsen for inspiring discussions on probabilistic forecasting and bounded time-series. We ﬁnally acknowledge two anonymous reviewers, an associate editor, as well as Richard Chandler, for useful comments and suggestions. References Ailliot, P., Monbet, V. and Prevosto M. (2006) An autoregressive model with time-varying coeﬃ- cients for wind ﬁelds. Environmetrics, 17, 107–117. Aitchison, J. and Shen, S. (1980) Logistic-normal distributions: some properties and uses. Biometrika, 67, 261–272. Akhmatov, V. (2007) Inﬂuence of wind direction on intense power ﬂuctuations in large oﬀshore wind farms in the North Sea. Wind. Eng., 31, 59–64. Bacher, P., Madsen, H. and Nielsen, H.Aa. (2009) Online short-term solar power forecasting. Sol. Energy, 83, 1772–1783. Bludszuweit, H., Dom´ınguez-Navarro, J.A. and Llombart A. (2008) Statistical analysis of wind power forecast errors. IEEE T. Power Syst., 23, 983–991. Box, G.E.P. and Cox, D.R. (1964) An analysis of transformations. J. Royal Stat. Soc. B, 26, 211–243. Bremnes, J.B. (2006) A comparison of a few statistical models for making quantile wind power forecasts. Wind Energy, 9, 3–11. Br¨ocker, J. (2008) On reliability analysis of multi-categorical forecasts. Nonlin. Proc. Geophys., 15, 661–673. Cloke, H.L. and Pappenberger, F. (2009) Ensemble ﬂood forecasting: a review. J. Hydrol., 375, 613–626. Costa, A., Crespo, A., Navarro, J., Lizcano, G., Madsen, H. and Feitosa E (2008) A review on the young history of the wind power short-term prediction. Renew. Sust. Energ. Rev., 12, 1725–1744. Fan, J.Q. and Zhang, W. (2008) Statistical methods with varying-coeﬃcient models. Stat. Interf., 1, 179–195. Frederic, P. and Lad, F. (2008) Two moments of the logit-normal distribution. Comm. Stat. B- Simul., 37, 1263–1269. Gallego, C., Pinson, P., Madsen, H., Costa, A. and Cuerva, A. (2011). Inﬂuence of local wind speed and direction on wind power dynamics Application to oﬀshore very short-term forecasting. Appl. Energ., 88, 4087–4096. Giebel, G., Brownsword, R., Kariniotakis, G., Denhard, M. and Draxl C. (2011) The state of the art in short-term prediction of wind power - A literature overview, 2nd edition. Technical report, EU project Anemos.plus. [Available online: http://orbit.dtu.dk] Gneiting, T. (2011) Quantiles as optimal point predictors. Int. J. Forecasting, 27, 197–207. Gneiting, T., Balabdaoui, F. and Raftery A.E. (2007) Probabilistic forecasts, calibration and sharp- ness. J. Royal Stat. Soc. B, 69, 243–268. Gneiting, T., Larson, K., Westrick, K., Genton, M.G. and Aldrich, E. (2006) Calibrated probabilis- tic forecasting at the stateline wind energy center - The regime-switching space-time method. J. Am. Stat. Assoc., 101, 968–979. 22 P. Pinson Hering, A.S. and Genton, M.G. (2009) Powering up with space-time wind forecasting. J. Am. Stat. Assoc., 105, 96–104. Johnson, N. (1949) Systems of frequency curves generated by methods of translation. Biometrika, 36, 146–176. Kagan, Y.Y. and Jackson, D.D. (2000) Probabilistic forecasting of earthquakes. Geophys. J. Int., 143, 438–453. Kristoﬀersen, J.R. and Christiansen, P. (2003) Horns Rev oﬀshore wind farm: its main controller and remote control system. Wind. Eng., 27, 351–359. Lange, M. (2005) On the uncertainty of wind power predictions - Analysis of the forecast accuracy and statistical distribution of errors. J. Solar Energ.-T. ASME, 127, 177–184. Lau, A. and McSharry, P. (2010). Approaches for multi-step density forecasts with application to aggregated wind power. Ann. Appl. Stat., 4, 1311–1341. Lesaﬀre, E., Rizopoulos, D. and Tsonoka, R. (2007) The logistic-transform for bounded outcome scores. Biostatistics, 8, 72–95. Leutbecher, M. and Palmer, T.N. (2008) Ensemble forecasting. J. Comput. Phys., 227, 3515–3539. Li, T.H. (2008) On exponentially weighted recursive least squares for estimating time-varying parameters. J. Stat. Theo. Pract., 2, 339–354. Ljung, L. and S¨oderstr¨om, T. (1983) Theory and Practice of Recursive Estimation. MIT Press: Boston. Madsen, H. (2007) Time Series Analysis. Chapman & Hall/CRC: London. Madsen, H., Pinson, P., Nielsen, T.S., Nielsen, H.Aa. and Kariniotakis, G. (2005) Standardizing the performance evaluation of short-term wind power prediction models. Wind Eng., 29, 475–489. Mead, R. (1965) A generalized logit-normal distribution. Biometrics, 21, 721–731. Møller, J.K., Nielsen, H.Aa. and Madsen, H. (2008) Time-adaptive quantile regression. Comput. Stat. Data An., 52, 1292–1303. Nielsen, H.Aa., Nielsen, T.S., Joensen, A.K. and Madsen, H. and Holst, J. (2000) Tracking time- varying coeﬃcient functions. Int. J. of Adapt. Control, 14, 813–828. Nielsen, H.Aa., Nielsen, T.S., Madsen, H., Badger, J., Giebel, G., Landberg, L., Sattler, K., Voulund, L. and Tøfting, J. (2006) From wind ensembles to probabilistic information about future wind power production - Results from an actual application. in Proc. IEEE PMAPS Conference, Probabilistic Methods Applied to Power Systems, Stockholm, Sweden. Pinson, P. (2006) Estimation of the uncertainty in wind power forecasting. Ph.D. thesis, Ecole des Mines de Paris, Paris, France. [Available online: http://pastel.paristech.org] Pinson, P., Chevallier, C. and Kariniotakis, G. (2007) Trading wind generation from short-term probabilistic forecasts of wind power. IEEE T. Power Syst., 22, 1148–1156. Pinson, P. and Kariniotakis, G. (2010) Conditional prediction intervals of wind power. IEEE T. Power Syst., 25, 1845–1856. Pinson, P. and Madsen, H. (2009) Ensemble-based probabilistic forecasting at Horns Rev. Wind Energy, 12, 137–55. Pinson, P. and Madsen, H. (2011) Adaptive modeling and forecasting of wind power ﬂuctuations with Markov-switching autoregressive models. J. Forecasting, available online. Pinson, P., Nielsen, H.Aa., Madsen, H. and Nielsen, T.S. (2008) Local linear regression with adap- tive orthogonal ﬁtting for the wind power application. Stat. Comput., 18, 59–71. Pinson, P., Nielsen, H.Aa., Møller, J.K., Madsen, H. and Kariniotakis, G. (2007) Nonparametric probabilistic forecasts of wind power: required properties and evaluation. Wind Energy, 10, 497–516. Raftery, A.E., Karny, M. and Ettler, P. (2010). Online prediction under model uncertainty via dynamic model averaging: Application to a cold rolling mill. Technometrics, 52, 52–66. Sanchez, I. (2006) Short-term prediction of wind energy production. Int. J. Forecasting, 22, 43–56. Stone, M. (1974) Cross-validation and assessment of statistical predictions (with discussion). J. Probabilistic forecasting of wind power 23 Royal Stat. Soc. B, 36, 111–147. Sørensen, P.E., Cutululis, N.A., Vigueras-Rodriguez, A., Jensen, L.E., Hjerrild, J., Donovan, M.H. and Madsen, H. (2007) Power ﬂuctuations from large wind farms. IEEE T. Power Syst., 22, 958–965. Sørensen, P. and co-authors (2005) Operation and control of large wind turbines and wind farms - Final report. Technical report, Risø National Laboratories for Sustainable Energy, Technical University of Denmark, Risø-R-1532(EN). Tay, A.S. and Wallis, K.F. (2000) Density forecasting: a survey. J. Forecasting, 19, 235–254. Taylor, J.W., McSharry, P.E. and Buizza, R. (2009) Wind power density forecasting using wind ensemble predictions and time series models. IEEE T. Energy Conver., 24, 775–782. Timmermann A. (2000) Density forecasting in economics and ﬁnance. J. Forecasting, 19, 231–234. Usaola, J. (2009) Probabilistic load ﬂow with wind production uncertainty using cumulants and Cornish–Fisher expansion. Int. J. Elec. Power. Syst., 31, 474–481. Vincent, C.L., Giebel, G., Pinson, P. and Madsen, H. (2010) Resolving non-stationary spectral signals in wind speed time-series using the Hilbert-Huang transform. J. App. Meteorol. Clim., 49, 253–267. Vincent, C.L., Pinson, P. and Giebel, G. (2011) Wind ﬂuctuations in the North Sea. Int. J. Cli- matol., available online. Wallis, K.F. (1987) Time series analysis and bounded economic variables. J. Time Ser. Anal., 8, 115–123.","libVersion":"0.3.2","langs":""}