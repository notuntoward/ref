{"path":"lit/lit_sources/Uniejewski21RegularizedQuantileRegression.pdf","text":"Regularized quantile regression averaging for probabilistic electricity price forecasting Bartosz Uniejewski, Rafał Weron ⁎ Department of Operations Research and Business Intelligence, Wrocław University of Science and Technology, 50-370 Wrocław, Poland ab st ra c tar ti cl e i n f o Article history: Received 18 November 2019 Received in revised form 1 September 2020 Accepted 9 January 2021 Available online 16 January 2021 Keywords: Electricity price forecasting Probabilistic forecasting Risk management Quantile Regression Averaging (QRA) LASSO Bayesian Information Criterion (BIC) Cross-validation Kupiec test Pinball score Conditional predictive accuracy Trading strategy Financial proﬁts Quantile Regression Averaging (QRA) has sparked interest in the electricity price forecasting community after its unprecedented success in the Global Energy Forecasting Competition 2014, where the top two winning teams in the price track used variants of QRA. However, recent studies have reported the method's vulnerability to low quality predictors when the set of regressors is larger than just a few. To address this issue, we consider a regu- larized variant of QRA, which utilizes the Least Absolute Shrinkage and Selection Operator (LASSO) to automat- ically select the relevant regressors. We evaluate the introduced technique – dubbed LASSO QRA or LQRA for short – using datasets from the Polish and Nordic power markets. By comparing against a number of benchmarks, we provide evidence for its superior predictive performance in terms of the Kupiec test, the pinball score and the test for conditional predictive accuracy, as well as ﬁnancial proﬁts for a range of trading strategies, especially when the regularization parameter is selected ex-ante using the Bayesian Information Criterion (BIC). As such, we offer an efﬁcient tool that can be used to boost the proﬁtability of energy trading activities, help with bidding in day-ahead markets and improve risk management practices in the power sector. ©2021ElsevierB.V.All rights reserved. 1. Introduction The Global Energy Forecasting Competition 2014 (GEFCom2014) has changed the landscape of energy forecasting. Instead of focusing on point forecasts, with all their limitations, the organizers have advo- cated computing probabilistic – more precisely – quantile forecasts and using the pinball score to evaluate them. The electricity price forecasting (EPF) literature has reacted lively, with the number of probabilistic EPF papers growing steadily in the following years (Hong et al., 2020). This has had the welcome effect of making the energy forecasting literature more interesting for economists and the ﬁnancial industry. After all, the most commonly used risk measure – the Value-at-Risk (VaR) – is noth- ing else but a quantile forecast. The better the probabilistic forecast, par- ticularly for the extreme quantiles, the more accurate the VaR estimate (Bunn et al., 2016; Uniejewski et al., 2019). And, obviously, this applies also to energy portfolios. Yet, risk management is not the only applica- tion of probabilistic energy forecasting. For instance, using predictive distributions as a basis for trading imbalances in an electricity market can be signiﬁcantly more proﬁtable and ﬁnancially less risky than rely- ing upon mean value-based point forecasts (Bunn et al., 2018). Hence the need for a development of efﬁcient probabilistic EPF techniques. Formally introduced by Nowotarski and Weron (2015), Quantile Re- gression Averaging (QRA) has sparked interest in the EPF community after its unprecedented success in GEFCom2014, where the top two winning teams in the price track used variants of QRA (Gaillard et al., 2016; Maciejowska and Nowotarski, 2016). The idea underlying QRA is to apply quantile regression (QR; see Koenker, 2005) to point – not probabilistic – forecasts of a pool of models, i.e., use the individual point predictions as regressors and the observed spot price as the pre- dicted variable. This is of substantial practical value. QRA is able to lever- age developments in point forecasting, which still is much more popular than its probabilistic counterpart, while offering an accurate approxi- mation of the predictive distribution. Since it is a general forecasting technique not limited to electricity prices, a number of authors have re- ported its successful application in areas ranging from load (Liu et al., 2017; Zhang et al., 2018; Wang et al., 2019)towindpower (Zhang et al., 2016) and irradiance forecasting (Mpfumali et al., 2019). However, a recent study of Marcjasz et al. (2020) has revealed the method's vulnerability to low quality predictors when the set of regres- sors is larger than just a few. The authors emphasize the importance of Energy Economics 95 (2021) 105121 ⁎ Corresponding author. E-mail addresses: bartosz.uniejewski@pwr.edu.pl (B. Uniejewski), rafal.weron@pwr.edu.pl (R. Weron). https://doi.org/10.1016/j.eneco.2021.105121 0140-9883/© 2021 Elsevier B.V. All rights reserved. Contents lists available at ScienceDirect Energy Economics journal hom e p age: w ww.elsevier.com/locate/eneeco correctly selecting the individual point forecasts for QRA, whose perfor- mance is known only ex post, and even recommend using only two or three point forecasts as inputs. A way to tackle this problem via principal component analysis (PCA) has been proposed by Maciejowska et al. (2016). However, their Factor QRA (or FQRA) model yields suboptimal and nearly identical forecasts to the so-called Quantile Regression Ma- chine (QRM) of Uniejewski et al. (2019), which ﬁrst aggregates point predictions of the individual methods, then runs quantile regression on the combined forecasts. Here, we introduce a different approach that signiﬁcantly outper- forms not only these two, but also a number of other benchmarks. It can be regarded as a regularized variant of QRA, which utilizes the Least Absolute Shrinkage and Selection Operator (LASSO) of Tibshirani (1996) to select the relevant regressors. We evaluate the introduced technique – dubbed LASSO QRA or LQRA for short – using datasets from the Polish and Nordic power markets. By comparing against nearly 30 benchmarks, we provide evidence for its superior predictive perfor- mance in terms of the Kupiec (1995) test, the pinball score (see, e.g., Gneiting, 2011; Nowotarski and Weron, 2018) and the test for con- ditional predictive accuracy of Giacomini and White (2006),especially when the regularization parameter is selected ex-ante using the Bayes- ian Information Criterion (BIC). As such, our study provides energy gen- erators, retailers and brokers with a tool that can be used to boost the proﬁtability of their trading activities, help with bidding in day-ahead markets and improve their risk management practices. The remainder of the paper is structured as follows. In Section 2 we brieﬂy describe the datasets and the forecasting scheme used in this study. Then, in Section 3 we discuss data preprocessing, describe the expert model used for computing the point forecasts and intro- duce LQRA. In Section 4,we ﬁrst evaluate the predictive performance of the point forecasts, then discuss coverage and sharpness of the obtained probabilistic forecasts. In particular, we report the results for the 90% prediction intervals, which are based on quantiles that correspond to conﬁdence levels often used in risk management, i.e., 5% and 95%. Given that electricity price forecasts, no matter how accurate, are of limited value if they cannot be used to devise a trading strategy that yields proﬁts, in Section 4 we also evaluate a range of strategies that involve buying electricity when it is cheap, storing it and selling when it is expensive. Finally, in Section 5 we wrap up the results and conclude. 2. Datasets 2.1. Two distinct markets We consider datasets from two neighboring, but distinct European power markets – the Polish Power Exchange (POLEX) and Nord Pool (NP). The ﬁrst one was downloaded from the websites of POLEX (www.tge.pl) and the Polish Transmission System Operator (TSO; www.pse.pl). It comprises three time series at hourly resolu- tion (see Fig. 1): • day-ahead electricity prices for the main auction at POLEX (so-called ‘Fixing #1’), • day-ahead predictions of the system-wide load in Poland, • day-ahead predictions of the generation of centrally dispatched gen- erating units in Poland (denoted by JWCD), and covers the period from 2 October 2014 to 31 December 2019. The Polish market is fossil fuel dominated, with a slowly decreasing share of hard coal and lignite (from ca. 86% in 2014 to ca. 75% in 2019). Fig. 1. Polish Power Exchange (POLEX) day-ahead prices (top), day-ahead system load forecasts (middle) and day-ahead forecasts of the generation of centrally dispatched generating units (bottom) from 2 October 2014 to 31 December 2019. The vertical dashed lines mark respectively the beginning of the 1189-day out-of-sample test period for pointforecasts (29 September 2016; also the beginning of the initial 364-day calibration window for probabilistic forecasts) and the beginning of the 825-day out-of-sample test period for probabilistic forecasts (28 September 2017). The ﬁrst 728 days constitute the initial calibration window for point forecasts. B. Uniejewski and R. Weron Energy Economics 95 (2021) 105121 2 The second dataset was downloaded from the Nord Pool website (www.nordpoolgroup.com) and also includes three time series at hourly resolution (see Fig. 2): • day-ahead system prices for the whole Nordic region, • day-ahead load forecasts (so-called consumption prognosis) aggre- gated for Denmark, Finland, Norway and Sweden, • day-ahead forecasts of wind power generation in Denmark, and covers the period from 1 January 2013 to 31 December 2019. In contrast to the Polish market, the Nordic one is hydro dominated (par- ticularly Norway) with a large share of nuclear (Sweden, Finland) and wind power generation (Denmark). All time series were preprocessed to account for changes to/from the daylight saving time. The missing values (corresponding to changes to the summertime) were substituted by the arithmetic average of the ob- servations from neighboring hours. The doubled values (corresponding to the changes from the summertime) were replaced by their arithmetic mean. 2.2. The forecasting scheme The idea underlying QRA is to apply quantile regression to a pool of point forecasts. Hence, our forecasting scheme is composed of two stages. First, point forecasts of the so-called expert, regression-type model deﬁned in Section 3.1.2 are obtained via ordinary least squares (OLS). Then they are used to construct probabilistic forecasts by running quantile regression; the resulting models are described in Section 3.2.5. Since both stages require calibration windows, the ﬁrst probabilistic predictions are obtained for the 1093rd day in each dataset, see the rightmost vertical dashed lines in Figs. 1 and 2. Like the majority of EPF studies, we use a rolling window scheme. However, following Hubicka et al. (2019), Marcjasz et al. (2018) and Maciejowska et al. (2020), we do not consider an arbitrarily chosen cal- ibration window length for computing point forecasts, but rather a pool of 701 window lengths – ranging from 28 (ca. one month) to 728 days (ca. two years) – and combine the obtained predictions. Initially, the ﬁrst 728 (=2 × 364) days are used for calibration of the expert model. For shorter windows, the calibration sample is left-truncated, so that it ends on the same day as the 728-day window. Then for each day be- tween 29 September 2016 and 31 December 2018 for POLEX and be- tween 30 December 2014 and 31 December 2019 for Nord Pool, we simultaneously compute 24 point forecasts, one for each hour of the day. These are the 1189-day (POLEX) and 1828-day (NP) out-of- sample test periods for point forecasts, spanning from the leftmost ver- tical dashed lines in Figs. 1–2 to the last day in the datasets. To obtain probabilistic forecasts from point predictions, for each hour of the days between 28 September 2017 and 31 December 2018 for POLEX and between 29 December 2015 and 31 December 2019 for Nord Pool, we use a rolling 364-day calibration window and one of the models described in Section 3.2.5. The 825-day (POLEX) and 1464-day (NP) out-of-sample test periods for probabilistic forecasts span from the rightmost vertical dashed lines in Figs. 1-2 to the last day in the datasets; the probabilistic forecasts themselves are evaluated in Section 4.2. 3. Methodology Since our forecasting scheme is composed of two stages, we ﬁrst de- scribe the point forecasting concepts in Section 3.1, then the probabilis- tic ones in Section 3.2. Each of these Sections ends with a summary which wraps up the discussed ideas and presents the models. Fig. 2. Nord Pool (NP) system prices (top), day-ahead consumption prognosis (middle) and day-ahead forecasts of wind power generation (bottom) from 1 January 2013 to 31 December 2019. The vertical dashed lines mark respectively the beginning of the 1828-day out-of-sample test period for point forecasts (30 December 2014; also the beginning of the initial 364-day calibration window for probabilistic forecasts) and the beginning of the 1464-day out-of-sample test period for probabilistic forecasts (29 December 2015). The ﬁrst 728 days constitute the initial calibration window for point forecasts. B. Uniejewski and R. Weron Energy Economics 95 (2021) 105121 3 3.1. Point forecasts 3.1.1. Variance stabilizing transformations The estimation of electricity price models via maximum likelihood (ML) or ordinary least squares (OLS) is typically hampered by spikes. These ‘outliers’ tend to pull model estimates towards values that yield a better ﬁt for the extreme observations, but at the same time increase the in-sample errors for the non-spiky prices. A statistically sound model- ing framework would either require robust estimation algorithms, as in Grossi and Nan (2019), or models with explicit spike components, for a review see Weron (2014). Neither of these are popular in the EPF litera- ture. Instead the authors have resorted either to treating electricity price series with a ‘reasonable’ ﬁlter (Janczura et al., 2013; Lisi and Pelagatti, 2018; Afanasyev and Fedorova, 2019) and calibrating the model to spike-ﬁltered data or to transforming the original series, ﬁtting the model to transformed prices and applying the inverse transformation to obtain the forecasts (Diaz and Planas, 2016; Uniejewski et al., 2018; Narajewski and Ziel, 2020); the latter approach has the advantage of using spiky prices, though their impact on parameter estimates is re- duced. For markets with only positive and distinctly different from zero prices, the logarithmic transform can be used, which leads to popular in ﬁnance models for log-prices. However, spikes come in all shapes and sizes – historically they have been mostly positive, but with the increasing penetration of renewables signiﬁcant price drops have started appearing (Maciejowska, 2020). In some markets, like in Germany, negative spikes are more common nowadays than positive ones (Hagfors et al., 2016b). This has triggered the development of alternative transformations that can handle negative and close to zero values. In an extensive empirical study involving two model classes (regression models, neural networks) and datasets from 12 diverse power markets, Uniejewski et al. (2018) have evaluated 16 variance stabilizing transformations (VSTs), ranging from simple threshold-type cutoffs, through generalized Box-Cox type transforms, to the probability integral transform (PIT) based approaches. Although there was no clear-cut winner, the N-PIT, the mirror-log and the area hyperbolic sine (asinh) transforms performed reasonably well, with the N-PIT having an edge over the competitors for the considered re- gression model and asinh performing very well for the neural network. Given that asinh is much simpler to compute, like Schneider (2011), Ziel and Weron (2018) and Marcjasz (2020), we use it in our study. Each time series (prices and exogenous variables) is ﬁrst standard- ized by subtracting the sample median and dividing by the sample Me- dian Absolute Deviation (MAD) corrected by the 75% quantile of the standard normal distribution z0.75; note, that according to Uniejewski et al. (2018), the (median, MAD) standardization yields better results than the more commonly used in statistics (mean, standard deviation) pair. For instance, for prices Pd,h we have: pd,h ¼ Pd,h−a b ≡ Pd,h−med Pd,h \u0001\u0003 MAD Pd,hðÞ z0:75 : ð1Þ Then we asinh-transform the standardized series. For instance, for prices we obtain: Y d,h ¼ asinh pd,h \u0001\u0003 ¼ log pd,h þ ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ p2 d,h þ 1 q\u0005\u0006 , ð2Þ for each d and h. Once the transformed price forecast for day d and hour h,i.e., bY d,h, is computed, we apply the inverse transformation to obtain the price forecast itself. Here, we follow Narajewski and Ziel (2020) and deﬁne the back-transformation as: bPd,h ¼ a þ b D ∑ D i¼1 sinh bY d,h þ εi \u0005\u0006 , ð3Þ where D is the number of days in the calibration window, εi are the in- sample residuals of the OLS procedure, and a and b are deﬁned in Eq. (1). Note, that the back-transformation proposed by Uniejewski et al. (2018) is simpler, but may be less accurate when bY d,h is far from zero. 3.1.2. The expert model For computing point forecasts we use a parsimonious autoregressive structure, inspired by the ARX model of Misiorek et al. (2006) and later used in a number of EPF studies (see Ziel and Weron, 2018, for a re- view). Following Uniejewski et al. (2016) and Ziel (2016), we refer to it as an expert model, since it is built on some prior knowledge of ex- perts. The model for the asinh-transformed price on day d and hour h is given by: Y d,h ¼ β1Y d−1,h þ β2Y d−2,h þ β3Y d−7,h|ﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ{zﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ} autoregressive effects þ β4Y d−1,24|ﬄﬄﬄﬄﬄﬄ{zﬄﬄﬄﬄﬄﬄ} end−of −day þ β5Y max d−1 þ β6Y min d−1|ﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ{zﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ} non−linear effects þ β7Z 1ðÞ d,h þ β8Z 2ðÞ d,h|ﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ{zﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ} exogenous variables þ β9DSat þ β10DSun þ β11DMon|ﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ{zﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ} weekday dummies þ εd,h, ð4Þ where Yd−1,h, Yd−2,h and Yd−7,h account for the autoregressive effects and correspond to prices from the same hour of the previous day, two days before and a week before, Yd−1,24 is the last known price at the time the prediction is made and provides information about the end- of-day price level, Y d−1 max ≡ maxh=1, …,24{Yd−1,h} and Yd−1 min ≡ minh=1, …, 24{Yd−1,h} represent previous day's variation in prices, Zd, h (1) is the asinh-transformed day-ahead system load forecast for day d and hour h, Zd,h (2) is the asinh-transformed day-ahead forecast for day d and hour h of either generation of centrally dispatched generating units (for POLEX) or of wind power generation (for Nord Pool), DSat, DSun and DMon are respectively Saturday, Sunday and Monday dummies, and the εd,h’s are assumed to be independent and identically distributed normal var- iables. The model weights are estimated via OLS, independently for each day and hour. 3.1.3. Point forecasting models Summing up, for each day in the out-of-sample test period for point forecasts, i.e., d =1,2, …, 1189 (for POLEX) and d =1, 2, …,1828 (for NP), each hour of the day, i.e., h =1, 2, …, 24, and each calibration win- dow length, i.e., T = 28, 29, …, 728 days (see Section 2 for details), we follow the same routine: Pd,h ! standardize pd,h ! VST Y d,h ! predict bY d,h ! inverseVST bPd,h: ð5Þ Namely, we (i) standardize the prices in the calibration window using Eq. (1),(ii) VST-transform the standardized prices in the calibra- tion window using the area hyperbolic sine deﬁned in Eq. (2),(iii)estimate parameters of the expert model (4) via OLS and compute the one-step ahead point predictions, and ﬁnally (iv) apply the inverse of the asinh transformation given by Eq. (3) to obtain the price forecasts. Note, that we also standardize and asinh-transform the exogenous variable time se- ries prior to ﬁttingthe expert modelinstep(iii). As a result of this routine, for each day d and hour h we obtain 701 different point forecasts of the same expert model estimated on data from 701 calibration windows. We can treat these forecasts as coming from 701 different ‘models’. 3.2. Probabilistic forecasts 3.2.1. Quantile Regression Averaging (QRA) QRA, as introduced by Nowotarski and Weron (2015), is based on averaging n =1, …, N point predictions of electricity prices bP nðÞ d,h using quantile regression (QR; see Koenker, 2005): q αjXd,h \u0001\u0003 ¼ Xd,hβα, ð6Þ where q(α| ⋅) is the conditional αth quantile of the electricity price dis- tribution, Xd,h is the vector of independent variables, i.e., bP nðÞ d,h for B. Uniejewski and R. Weron Energy Economics 95 (2021) 105121 4 n =1, …, N, while βα =[βα (1), …, βα (N)]′ is the corresponding vector of weights for given α. To obtain parameter estimates we minimize the sum of the so-called check functions: ^βα ¼ argmin βα ∑ d, h α \u0002 1Pd,h<Xd,hβα \u0001\u0003 Pd,h \u0002 Xd,hβα \u0001\u0003 |ﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ{zﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ} check function , ð7Þ where 1x is the characteristic function of set X. Following the un- precedented success in the Global Energy Forecasting Competition 2014, QRA became a popular technique for probabilistic energy fore- casting (see, e.g., Maciejowska et al., 2016; Zhang et al., 2016; Liu et al., 2017; Zhang et al., 2018; Kostrzewski and Kostrzewska, 2019; Mpfumali et al., 2019; Seraﬁnet al., 2019; Uniejewski et al., 2019; Wang et al., 2019; Kath and Ziel, 2020). However, a recent study of Marcjasz et al. (2020) has revealed the method's vulnerability to low quality predictors when the set of regressors is larger than just a few. To tackle this problem, in what follows we introduce a regularized (or penalized) variant of QRA. QRA is a special case of QR where the regressors are point (mean value) forecasts of the predicted variable, i.e., bP nðÞ d,h for n =1, …, N. Note, however, that QR is a general technique that can yield electricity price forecasts also for more diverse sets of explanatory variables, in- cluding past prices and/or fundamental variables, as in Bunn et al. (2016) or Hagfors et al. (2016a), potentially also higher moments of the predictive distribution or quantile forecasts. To our best knowledge, the latter idea has not been utilized in the EPF context thus far. 3.2.2. Regularization In simple terms the idea of regularization can be formulated as an optimization problem: bβ ¼ argmin β f X; βðÞ þ g βðÞfg, ð8Þ where f(X; β) is the minimized function, g(β) is the penalty function and β is the vector of parameters (Tikhonov, 1963). The most com- monly used variant of regularization deﬁnes the penalty function as an ℓ q norm scaled with an additional tuning (or regularization) param- eter λ. When q = 1 and f(X; β) is the Residual Sum of Squares (RSS) we obtain the Least Absolute Shrinkage and Selection Operator (LASSO) of Tibshirani (1996): bβ ¼ argmin β ∑d,h Pd,h−Xd,hβ \u0001\u00032 |ﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ{zﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ} RSS þ λ ∑ n i¼1jβij 8 >< >: 9 >= >; , ð9Þ which not only shrinks the β’s towards zero, but also eliminates some of them. For λ = 0 the method is equivalent to the original formulation of the problem, i.e., OLS. As λ increases, more and more variables are elim- inated. A clear advantage of LASSO is that it can handle an almost unlim- ited number of explanatory variables. Hence, it can be used as an automated variable selection tool (Gaillard et al., 2016; Uniejewski et al., 2016; Ziel, 2016; Uniejewski and Weron, 2018; Ziel and Weron, 2018). 3.2.3. LASSO QRA Regularization applied to quantile regression is not a completely new idea (for a mathematical treatment of this topic see Li and Zhu, 2008). There are even a few forecasting papers where this approach has been considered. On one hand, there are publications where LASSO is combined with QR to construct probabilistic forecasts of eco- nomic variables (Manzan, 2015), global radiation (Ben Bouallègue, 2017), electric demand (Lebotsa et al., 2018; He et al., 2019) or photo- voltaic power (Agoua et al., 2019), for a pool of explanatory variables (but not point forecasts as in QRA). On the other, there are studies where penalized (via LASSO) QR is used to obtain a quantile of the predictive distribution (e.g., Value at Risk at the 95% level) from a pool of forecasts of this particular quantile (Bayer, 2018; Bracale et al., 2019). However, to our best knowledge, there is no paper that combines regularization with QRA, i.e., with mean value (not quantile) forecasts taken as independent variables in Eq. (6). The LASSO QRA or LQRA for short is constructed by applying the check function deﬁned in Eq. (7) to the ℓ 1 regularization in Eq. (9): ^βα ¼ argmin βα ∑d,h α−1Pd,h<Xd,hβα \u0001\u0003 Pd,h−Xd,hβα \u0001\u0003 |ﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ{zﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ} check function,see Eqn: 7ðÞ þ λ ∑ N n¼1 β nðÞ α \b \b \b \b \b \b |ﬄﬄﬄﬄﬄﬄﬄ{zﬄﬄﬄﬄﬄﬄﬄ} LASSO penalty 8 >>>< >>>: 9 >>>= >>>; , ð10Þ where, as in Eq. (6), Xd,h is the vector of independent variables, i.e., bP nðÞ d,h for n =1, …, N,for day d and hour h,and Xd,hβα ¼ ∑ N n¼1β nðÞ α bP nðÞ d,h.Note, that Eq. (10) can be rewritten to ﬁtintothe deﬁnition of a linear prob- lem, thus to estimate bβα we use a basic linear programming tool, i.e., the Simplex algorithm (Dantzig et al., 1955). Due to the linear penalty factor, LQRA selects the most informative point forecasts, so there is no need for experts to select them a priori. What is more, because of regularization, the ﬁnal forecasts of different quantiles may be constructed using different sets of point forecasts. Po- tentially, this may improve the predictive performance. Actually, we ex- pect the model to be at least as accurate as QRA and at the same time much more robust to a large number of point forecast (inputs). The higher the λ, the fewer point forecasts will ﬁnally be used to construct the quantile forecasts. Note, that λ may or may not depend on α.In Section 4.2 we present results for models with one ﬁxed λ for all 99 per- centiles as well as a model which selects the optimal value of λ for each percentile and each hour. 3.2.4. Selection of λ To check the performance of LQRA we conduct empirical tests on a logarithmic grid of 19 λ’s ranging from 10 −1 to 10 3.Weadditionally in- clude λ = 0, which corresponds to the original QRA method; in total we report results for 20 different values of λ. We also consider two proce- dures for selecting the optimal value of λ. The ﬁrst, denoted by LQRA (BIC),utilizesthe Bayesian Information Criterion (BIC) to select the tuning parameter based on the in-sample ﬁt and uses the formulation proposed by Lee et al. (2014). Namely, for quantile α, day d and hour h we select the λ that corresponds to the lowest BIC value: BIC α d,h λðÞ ¼ log ∑ d d ⁎¼d−364 α−1 Pd⁎ ,h<^Pα d⁎ ,h \t Pd⁎,h−^Pα d ⁎,h \u0005\u0006 ! þm log nðÞ 2n log pðÞ, ð11Þ where Pd, h is the observed price, bPα d,h is the corresponding model- predicted α-quantile of the price distribution (in-sample ﬁt), m is the number of non-zero parameters in the regularized model, n = 364 is the number of observations in the calibration window and p is the num- ber of potential predictors (here: 25). The second procedure, denoted by LQRA(CV), utilizes cross- validation to select the optimal value of λ,see, e.g., Hastie et al. (2015) for a discussion and examples. We divide the in-sample data into k = 7 disjunctive subsets of 364 7 ¼ 52 days; note, that the length of the cali- bration window for probabilistic forecasts is 364 days. Then we calibrate the model k times, each time we leave out one of the k subsets for test- ing. Finally, we compare the performance for each λ by looking at the Pinball Score, deﬁned in Eq. (13) below, averaged across all days in the calibration window. The λ with the lowest score is chosen, indepen- dently for each percentile. B. Uniejewski and R. Weron Energy Economics 95 (2021) 105121 5 3.2.5. Probabilistic forecasting models The probabilistic forecasts are obtained for QR-type models cali- brated on a rolling window of 364 days; this is in contrast to point fore- casts, which are ﬁtted on 701 rolling windows of lengths ranging from 28 to 728 days. For example, in case of the Polish data, the initial calibra- tion window for probabilistic forecasts covers the period from 29 Sep- tember 2016 to 27 September 2017 and yields forecasts for all 24 h of the next day (28 September). Afterwards, the window is rolled forward by one day and the models are re-estimated to obtain forecasts for 29 September. This procedure is repeated until the predictions for 31 De- cember 2019 are made. To obtain probabilistic forecasts of the day-ahead price, we use only 25 out of 701 individual point forecasts available (see Section 4.1). Marcjasz et al. (2018) claimthatitisnot beneﬁcial to take into consideration models that are calibrated on windows of fewer then 56 days. What is more, forecasts obtained for windows of similar lengths provide almost identical results. Thus, as the po- tential variables for LQRA we have selected point forecasts obtained for models calibrated on windows of 56,84,112, …, 728 days; see the black dots in Fig. 3. The resulting models are denoted by LQRA(λi), where λi ¼ 10 2 i−1ðÞ 9 −1 for i =1, …, 19 is a logarithmic grid of λ’srang- ing from 10−1 to 103. Note, that λ =0in Eq. (10) corresponds to ‘pure’ or non- regularized QRA. The latter is treated as the ﬁrst benchmark and denoted later in the text by QRA. The next 25 benchmarks use QR applied to individual point forecasts; we denote them by QR(T), where T = 56,84,112, …, 728. The last three benchmarks are moti- vated by the results of Marcjasz et al. (2020).The authors report that averaging probabilistic forecasts can further improve the accu- racy. Thus, we additionally average probabilistic forecasts QR(T), both ‘horizontally’ and ‘vertically’,see Section 3.3.2 in the cited arti- cle. We denote them by Q-Ave and F-Ave, respectively. Finally, since it may be beneﬁcial to ﬁrst average point forecasts and then apply QR (instead of averaging predictions on the probabilistic level), we also consider the Quantile Regression Machine (QRM) approach of Uniejewski et al. (2019). In this model, denoted by QRM, all 25 indi- vidual point forecasts are ﬁrst averaged and the result is then used as an input to the QR algorithm. Interestingly, QRM yields nearly iden- tical forecasts to the Factor QRA (or FQRA) model of Maciejowska et al. (2016), because the latter applies QR to the ﬁrst factor (which approximates the mean) extracted from a pool of forecasts. Finally, note that in this study we forecast 99 percentiles, which can be treated as a relatively good approximation of the entire distribution. Due to a possible lack of monotonicity of the quantile forecasts, after obtaining predictions of the 99 percentiles we sort the results, indepen- dently for each day and hour. 4. Results 4.1. Point forecasts The point forecasts are evaluated using the Mean Absolute Error: MAE ¼ 1 24D ∑ D d¼1 ∑ 24 h¼1 ∣bPd,h−Pd,h∣, where D is the number of days in the out-of-sample test period. The re- sults are presented in Fig. 2. They are very similar to those reported in Hubicka et al. (2019) and Marcjasz et al. (2018). As can be seen for both datasets, the optimal (in terms of MAE) calibration window length is around 100-days; this can hardly be selected ex-ante.For both datasets the shortest windows are not recommended. What was also reported by Marcjasz et al. (2018) for some of the analyzed markets, the longer calibration window we take, the worse the autoregressive model per- forms. We observe this behavior both for the POLEX and NP datasets. 4.2. Probabilistic forecasts 4.2.1. Error measures and testing for predictive ability When evaluating probabilistic forecasts, we follow the paradigm of ‘maximizing sharpness subject to reliability’ (Gneiting and Katzfuss, 2014; Nowotarski and Weron, 2018). To check the reliability we com- pute the empirical coverage: Iα d:h ¼ 1, for Pd,h∈ ^L α d,h ^Uα d,h hi, 0, for Pd,h∉ ^L α d,h ^Uα d,h hi, 8 >< >: ð12Þ where ^L α d;h is the lower and ^Uα d;h the upper bound of the prediction inter- val (PI), and compare it to the nominal coverage. To this end, we per- form the Kupiec (1995) test for the 50% and 90% PIs. Then, we use the Pinball Score (or Pinball Loss) to evaluate the sharpness. It is a proper scoring rule and a special case of an asymmetric piecewise linear loss function (Gneiting, 2011): PS ^qα,P, Pd,h, α \u0001\u0003 ¼ 1−αðÞ ^qα,P−Pd,h \u0001\u0003 for Pd,h<^qα,P, α Pd,h−^qα,P \u0001\u0003 for Pd,h ≥ ^qα,P, ( ð13Þ where ^qα;P is the price quantile of order α ∈ (0, 1) and Pd,h is the observed price for day d and hour h. The lower PS is, the more accurate are the probabilistic forecasts for a given quantile. The Pinball Score can be av- eraged across all percentiles, i.e., α = 0.01, 0.02, ...,0.99 as in the GEFCom2014 competition, and all hours in the whole out-of-sample test period. This yields the Aggregate Pinball Score (APS), which is Fig. 3. The Mean Absolute Errors (MAE) for the POLEX dataset from the period 29 September 2016 to 31 December 2019 (left panel) and the Nord Pool dataset from the period 30 December 2014 to 31 December 2019 (right panel), as a function of the calibration window length ranging from 28 to 728 days. Black dots represent forecasts used as inputs for QR-based procedures, gray dots – predictions for all considered window lengths. B. Uniejewski and R. Weron Energy Economics 95 (2021) 105121 6 equivalent to computing the quantile representation of the so-called Continuous Ranked Probability Score (CRPS), see Laio and Tamea (2007). Finally, to draw statistically signiﬁcant conclusions on the outperformance of forecasts of one model by those of another, we use the Giacomini and White (2006) test for conditional predictive ability (CPA). It can be regarded as a generalization of the commonly used Diebold-Mariano test for unconditional predictive ability. Here, one sta- tistic for each pair of models is computed based on the 24-dimensional vector of Pinball Scores for each day: ΔX,Y,d ¼ ∥APSX,d∥−∥APSY,d∥, where ∥APSX,d∥ ¼ ∑ 24 h¼1∑ 0:99 α¼0:01 PS bqα,P, Pd,h, α \u0001\u0003 for model X.For each pair of models and both datasets we compute the p-values of the CPA test with null H0 : ϕ = 0 in the regression: ΔX,Y,d ¼ ϕ 0Xd−1 þ εd, where Xd−1 contains information of day d − 1, i.e., a constant and lags of ΔX,Y,d. 4.2.2. Empirical coverage In Fig. 4 we depict the so-called Prediction Interval Coverage Probabil- ity (PICP; see, e.g., Nowotarski and Weron, 2018) or empirical coverage of the 90% PIs constructed from the 5th and 95th percentiles, i.e., for α = 0.05 and 0.95. Plotted are the results of empirical coverage aggre- gated for all hours in the out-of-sample test period, i.e., 825 × 24 = 19 800 observations for POLEX and 1464 × 24 = 35 136 for Nord Pool. Sev- eral conclusions can be drawn: • Firstly, we can observe that the dashed lines indicating the expected level of 90% are rarely reached. This means that most of the PIs are too narrow; the exceptions include F-Ave (for both markets) and Q-Ave (for NP). • As far as benchmarks are concerned, it is hard to formulate clear-cut conclusions. For the Polish dataset, F-Ave and Q-Ave outperform QR (T) for all T. However, for Nord Pool, Q-Ave and QR(T) perform simi- larly and F-Ave yields too wide PIs; QRM yields similar coverage to QR(T) for both datasets. • As emphasized by Lichtendahl et al. (2013), vertical averaging of probabilities (→ F-Ave) yields wider PIs than horizontal averaging of quantiles (→ Q-Ave), leading to less sharp predictive distributions. While this often helps in EPF (Uniejewski et al., 2019; Marcjasz et al., 2020), for the considered Nord Pool dataset the F-Ave-implied PIs are clearly too wide. Possibly this is a consequence of the much less spiky prices in 2019 compared to the earlier years, see Fig. 2. • LQRA strongly depends on λ. Rather larger values of the tuning pa- rameter are preferable. • Both methods for automated selection of λ,i.e., LQRA(BIC) and LQRA (CV), are slightly outperformed by the best (ex-post) ﬁxed λ values. At the same time, for both markets they yield similar coverage to QRM and QR(T). • The most reliable results are obtained with F-Ave for POLEX and QR (168) for Nord Pool. They yield a coverage of 90.45% and 89.67%, respectively. Similar conclusions can be drawn for the 50% PIs (not plotted here for the sake of clarity). 4.2.3. The Kupiec test The test is performed to check whether the obtained PIs are close enough to the nominal values of PINC = 50% or 90%, or equivalently whether the Average Coverage Errors, deﬁned as ACE = PICP − PINC, are close enough to zero. Recall, that the Kupiec (1995) test checks whether the probability of an actual price falling into the PI (→ ‘hit’)is equal to PINC, under the assumption that the ‘hits’ and ‘misses’ are inde- pendent. The test rejects the null hypothesis of ACE equal to zero if the actual fraction of ‘hits’ is statistically different from PINC (Nowotarski and Weron, 2018). In what follows, we report the results for three benchmarks (Q-Ave, F-Ave, QRM) and three LQRA models – one with an ex-post selected, relatively well performing value of λ14 = 77.43 ≈ 77, denoted by LQRA(77), and two that utilize automated se- lection of the tuning parameter, i.e., LQRA(BIC) and LQRA(CV). Fig. 4. The PI Coverage Probability (PICP) of the probabilistic forecasts for the POLEX dataset from 29 September 2016 to 31 December 2019 (top panels) and the Nord Pool dataset from 30 December 2014 to 31 December 2019 (bottom panels). The black dashed line corresponds to the PI Nominal Coverage (PINC) of 90%. Results are divided into two plots, the coverage for benchmark models (left panels;see Section 3.2.5)and LQRA as a function of λ and the two automated procedures for λ selection (right panels;see Section 3.2.4). B. Uniejewski and R. Weron Energy Economics 95 (2021) 105121 7 For both datasets, the Kupiec test is conducted for the whole out-of- sample test period, but separately for each of the 24 hourly series. In Fig. 4 we depict the ACE (in percent) for the 50% and 90% PIs generated by the six selected probabilistic forecasting methods. The ﬁlled symbols indicate signiﬁcance of the Kupiec test at the 1% level. The latter results, also at the 5% level, are summarized in Table 1. We can draw the follow- ing conclusions: • Nearly in all cases the PIs for off-peak prices (i.e., night hours, early mornings and late evenings) are too narrow (ACE <0), while for on- peak prices they are usually too wide (ACE >0). • As far as benchmarks are concerned, the best performing is QRM,par- ticularly for on-peak hours. On the other hand, F-Ave seems to per- form slightly better for off-peak hours. • All three LQRA models outperform the benchmarks. They pass the Kupiec test at the 1% signiﬁcance level for nearly all on-peak hours, and for as many as 17–22 h for the NP dataset. At the 5% signiﬁcance level the results are slightly less convincing, but still much better than for the benchmarks. • No signiﬁcant differences between the performance of LQRA(BIC) and LQRA(CV) can be observed; interestingly, they are at par with LQRA Fig. 5. The Average Coverage Errors (ACE = PICP − PINC; in percent) for the 50% and 90% PIs generated by the six selected probabilistic forecasting methods, separately for each hour of the day and the POLEX (top six panels) and NP datasets (bottom six panels). Filled symbols indicate signiﬁcance of the Kupiec test at the 1% level, compare with Table 1. Table 1 The number of hours of the day (i.e., out of 24) for which the null of the Kupiec test is not rejected at the 1% and 5% signiﬁcance levels, for both datasets. Compare with Fig. 5. POLEX Nord Pool PI 90% 50% 90% 50% Sig. level 1% 5% 1% 5% 1% 5% 1% 5% Q-Ave 63 665 38 8 F-Ave 22 547 65 2 QRM 11 8 10 10 15 8 12 8 LQRA(77) 14 11 18 16 20 17 20 18 LQRA(BIC) 12 10 17 14 17 17 22 18 LQRA(CV) 12 10 19 16 17 17 21 18 B. Uniejewski and R. Weron Energy Economics 95 (2021) 105121 8 (77),for which λ was selected ex-ante.Given that LQRA(BIC) involves asigniﬁcantly lower computational cost than LQRA(CV), it can be rec- ommended based on the results of the Kupiec test. 4.2.4. Sharpness In Fig. 6 we depict the Aggregate Pinball Score (APS) deﬁned in Section 4.2.1, i.e., the PS averaged across all 99 percentiles and all days and hours in the out-of-sample test period for probabilistic forecasts. Like in Section 4.2.2, we present the results for all benchmarks and all considered values of λ for LQRA. Wecan observethat: • Both for the Polish and Nordic markets the best performing bench- mark is F-Ave with an APS of 6.18 (for POLEX) and 0.73 (for NP). • For the POLEX dataset, all results obtained for LQRA with λ >10out- perform the benchmarks by a large margin. The APS as function of λ has a ‘minimum’ at 6.05, ca. 2.1% lower compared to the APS of the best benchmark. • For the Nordic market we can also conclude that most of the forecasts obtained for LQRA outperform the benchmarks by a large margin. The APS as a function of λ takes its ‘minimum’ at 0.71, around 3% lower compared to the best benchmark. • Both for the Polish and Nordic markets LQRA(BIC) and LQRA(CV) per- form comparably well, with the former having a slight edge for the POLEX dataset. Both are signiﬁcantly better than all benchmarks and essentially at par with LQRA(77), i.e., with the ex-post selected λ. 4.2.5. Testing conditional predictive ability As in Section 4.2.3, we perform the CPA test of Giacomini and White (2006) for three benchmarks (Q-Ave, F-Ave, QRM) and three LQRA models – LQRA(77) with an ex-post selected λ and two that utilize auto- mated selection of the tuning parameter, i.e., LQRA(BIC) and LQRA(CV). In Fig. 7 we illustrate the obtained p-values using ‘chessboards’ Fig. 6. The Aggregate Pinball Score (APS) for the POLEX dataset from 29 September 2016 to 31 December 2019 (top panels) and the Nord Pool dataset from 30 December 2014 to 31 December 2019 (bottom panels), plotted separately for the benchmark (left panels)and LQRA models (right panels). Fig. 7. Results of the conditional predictive ability (CPA) test of Giacomini and White (2006) for forecasts of selected models for the POLEX (left) and Nord Pool (right) datasets. We use a heat map to indicate the range of the p-values – the closer they are to zero (→ dark green) the more signiﬁcant is the difference between the forecasts of a model on the X-axis (better) and the forecasts of a model on the Y-axis (worse). B. Uniejewski and R. Weron Energy Economics 95 (2021) 105121 9 (analogously as in Ziel and Weron, 2018; Seraﬁnetal., 2019; Uniejewski et al., 2019), i.e., we use a heat map to indicate the range of the p-values – the closer they are to zero (→ dark green) the more signiﬁcant is the difference between the forecasts of a model on the X-axis (better) and the forecasts of a model on the Y-axis (worse). Clearly, the CPA test re- sults conﬁrm and emphasize the observations made in Section 4.2.4.In particular, F-Ave signiﬁcantly outperforms all other benchmarks and for both datasets the best performing model overall is LQRA(BIC),thatis never signiﬁcantly outperformed by any other method. Given that LQRA(BIC) is computationally less demanding than LQRA(CV),it is the recommended option. 4.3. Measuring ﬁnancial proﬁts Electricity price forecasts, no matter how accurate, are of limited value if they cannot be used to devise a trading strategy that yields proﬁts. Hence, to put the above results in a different perspective, we consider strategies that can be implemented by a company that pos- sesses an energy-storage system, like the Virtual Power Plant analyzed in Sikorski et al. (2019). Without loss of generality, let us assume that the company owns a 1.25 MWh battery, for both economic and techni- cal reasons it cannot be discharged below 0.25 MWh (or 20% of the nominal capacity) and its efﬁciency is 80% for a single charge- discharge cycle. We compare a range of quantile-based, intra-day trad- ing strategies which aim at buying 1 MWh of electricity to charge the battery when it is the cheapest (typically very early morning hours), storing it and discharging the unit to sell 0.8 MWh, i.e., 80% of 1 MWh, of electricity when it is the most expensive (typically in the afternoon). We use data from the Polish day-ahead (see Section 2) and balancing (source: www.pse.pl) markets to illustrate the strategies and evaluate the ﬁnancial value of different electricity price forecasts. 4.3.1. Quantile-based trading strategies All considered quantile-based trading strategies consist of the same three steps. In step (i), before bidding in the day-ahead market on day d − 1, we select two hours – one with a low and one with a high ex- pected price of electricity on day d.More precisely, the ‘low-price hour’ h1 and the ‘high-price hour’ h2 are chosen such that h1 < h2 and the price spread between the α-quantile of the price distribution for hour h2 and the (1 − α)-quantile for hour h1 is maximized, see Fig. 8 for an illustration. We consider six levels of α (1%, 5%, 10%, 15%, 20% and 25%) and for- mulate the above as a linear integer programming problem with: • decision variables xsell h and xbuy h equal to one if we respectively sell or buy at hour h and zero otherwise, satisfying xbuy h∗ + ∑h=1 h∗ xsell h ≤ 1for h ∗ =1,2, …,24; • and objective function: max ∑ 24 h¼1 0:8 bPα d,h⋅xh sell−bP1−α d,h ⋅x h buy \t , ð14Þ where bPα d,h is the model-predicted α-quantile of the price distribution on day d and hour h. We use the intlinprog function from the Matlab Opti- mization Toolbox to solve it. In step (ii) we submit to POLEX the bid to buy 1 MWh for bP1−α d,h1 at hour h1 and simultaneously the offer to sell 0.8 MWh at bPα d,h2 at hour h2. For instance, when bidding for 29 September 2017 with α = 10% the price spread is maximized for bP90% d,4 ¼ 132:51 and bP10% d,20 ¼ 204:23 PLN/MWh, see Fig. 8. Note, that the probability that each of our bids will be accepted is 1 − α (independently); in this case it is 90%, both for the bid to buy at h1 = 4 and the offer to sell at h2 = 20. Finally, in step (iii): • If both the bid and the offer are accepted, on day d and hour h1 we buy 1 MWh in the day-ahead market for the auction settled price Pd,h1 and charge the battery. Then at hour h2 > h1 we discharge the battery and sell 0.8 MWh in the day-ahead market at Pd,h2.The daily proﬁtis 0.8 Pd, h2 − Pd,h1 PLN. • If both the bid and the offer are rejected, we do nothing; the daily proﬁtis 0 PLN. • If only the offer is accepted, on day d and hour h1 we buy 1 MWh in the balancing market for Bd,h1 and charge the battery. Then at hour h2 > h1 we discharge the battery and sell 0.8 MWh in the day-ahead market. The daily proﬁtis 0.8 Pd,h2 − Bd,h1 PLN. • Analogously, if only the bid is accepted, on day d and hour h1 we buy 1 MWh in the day-ahead market and charge the battery. Then at hour h2 > h1 we discharge the battery and sell 0.8 MWh in balancing mar- ket at Bd,h2.The dailyproﬁtis 0.8 Bd,h2 − Pd,h1 PLN. 4.3.2. Benchmark strategies To show that the probabilistic forecasts are worth considering we compare the quantile-based strategies deﬁned in Section 4.3.1 against two benchmarks. The ﬁrst one is a naive strategy that al- ways buys 1 MWh at hour 4 am and sells 0.8 MWh at 12 pm; thoseare thehours with the – on average – lowest and highest price in the Polish day-ahead market. The second, point forecasts- based benchmark is constructed analogously to the quantile- based strategies, but instead of using quantile forecasts bPα d,h it uti- lizes point forecasts bPd,h. 4.3.3. Results In Table 2 we report the proﬁts (in PLN) obtained when using one of the benchmark or quantile-based strategies deﬁned in Sections 4.3.1–4.3.2 in the POLEX market for the whole out-of-sample, 853-day period, see Fig. 1. We can draw the following conclusions: • For any considered quantile-based strategy the obtained proﬁtis sig- niﬁcantly higher than for the naive or point forecasts-based bench- marks. • For all considered α’s the highest proﬁts are obtained for one of the LQRA-based probabilistic forecasts; see the underlined values in each column. • LQRA(BIC) with α = 20% yields the highest proﬁt overall. The value of 45,396.21 PLN for 853 days is equivalent to an average daily proﬁtof 53.22 PLN (or ca. 12 EUR). Fig. 8. Illustration of the quantile-based trading strategies discussed in Section 4.3.1.When bidding for 29 September 2017, based on the 80% PIs available a day earlier, the price spread is maximized for bP90% d,4 ¼ 132:51 (left •)and bP10% d,20 ¼ 204:23 PLN/MWh (right •). B. Uniejewski and R. Weron Energy Economics 95 (2021) 105121 10 5. Conclusions In this paper we have introduced a new technique for computing probabilistic forecasts – LASSO QRA or LQRA for short. It is a regularized variant of Quantile Regression Averaging, which utilizes the Least Abso- lute Shrinkage and Selection Operator (LASSO) to select the valuable and eliminate the redundant point forecasts used as inputs to quantile regression. Although illustrated on datasets comprising day-ahead elec- tricity prices, we believe that LQRA can be a useful approach also for other forecasting applications, in particular, in risk management. We have evaluated the new technique using datasets from the Polish and Nordic power markets, and compared against nearly 30 bench- marks. Furthermore, we have introduced two automated techniques for ex-ante selection of the regularization parameter – LQRA(BIC) that uses the Bayesian Information Criterion to select λ based on the in- sample ﬁt, and a more computationally demanding procedure which utilizes cross-validation. We provide evidence for the superior predic- tive performance of LQRA(BIC) in terms of the Kupiec test for (uncondi- tional) coverage, the pinball score and the test for conditional predictive accuracy (CPA), as well as ﬁnancial proﬁts for a range of trading strate- gies. Overall, we recommend LQRA(BIC) as an accurate and computa- tionally efﬁcient method for computing probabilistic forecasts that can be used to boost the proﬁtability of energy trading activities, help with bidding in day-ahead markets and improve risk management practices in the power sector. Acknowledgments This work was partially supported by the Ministry of Science and Higher Education (MNiSW, Poland) through Diamond Grant No. 0199/ DIA/2019/48 (to BU) and the National Science Center (NCN, Poland) through MAESTRO grant No. 2018/30/A/HS4/00444 (to RW). Appendix A. Supplementary data Supplementary data and Matlab codes can be found online at https://doi.org/10.1016/j.eneco.2021.105121. References Afanasyev, D., Fedorova, E., 2019. On the impact of outlier ﬁltering on the electricity price forecasting accuracy. Appl. Energy 236, 196–210. Agoua, X., Girard, R., Kariniotakis, G., 2019. Probabilistic models for spatio-temporal pho- tovoltaic power forecasting. IEEE Transactions on Sustainable Energy 10, 780–789. Bayer, S., 2018. Combining value-at-risk forecasts using penalized quantile regressions. Econometrics and Statistics 8, 56–77. Ben Bouallègue, Z., 2017. Statistical postprocessing of ensemble global radiation forecasts with penalized quantile regression. Meteorol. Z. 26, 253–264. Bracale, A., Carpinelli, G., Falco, P.D., 2019. Developing and comparing different strategies for combining probabilistic photovoltaic power forecasts in an ensemble method. En- ergies 12, 1–16. Bunn, D., Andresen, A., Chen, D., Westgaard, S., 2016. Analysis and forecasting of electric- ity price risks with quantile factor models. Energy Journal 37, 101–122. Bunn, D., Gianfreda, A., Kermer, S., 2018. A trading-based evaluation of density forecasts in a real-time electricity market. Energies 11, 2658. Dantzig, G.B., Orden, A., Wolfe, P., et al., 1955. The generalized simplex method for mini- mizing a linear form under linear inequality restraints. Pac. J. Math. 5, 183–195. Diaz, G., Planas, E., 2016. A note on the normalization of Spanish electricity spot prices. IEEE Trans. Power Syst. 31, 2499–2500. Gaillard, P., Goude, Y., Nedellec, R., 2016. Additive models and robust aggregation for GEFCom2014 probabilistic electric load and electricity price forecasting. Int. J. Forecast. 32, 1038–1050. Giacomini, R., White, H., 2006. Tests of conditional predictive ability. Econometrica 74, 1545–1578. Gneiting, T., 2011. Quantiles as optimal point forecasts. Int. J. Forecast. 27, 197–207. Gneiting, T., Katzfuss, M., 2014. Probabilistic forecasting. Annual Review of Statistics and Its Application 1, 125–151. Grossi, L., Nan, F., 2019. Robust forecasting of electricity prices: simulations, models and the impact of renewable sources. Technological Forecasting & Social Change 141, 305–318. Hagfors, L., Bunn, D., Kristoffersen, E., Staver, T., Westgaard, S., 2016a. Modeling the UK electricity price distributions using quantile regression. Energy 102, 231–243. Hagfors, L., Kamperud, H., Paraschiv, F., Prokopczuk, M., Sator, A., Westgaard, S., 2016b. Prediction of extreme price occurrences in the German day-ahead electricity market. Quantitative Finance 16, 1929–1948. Hastie, T., Tibshirani, R., Wainwright, M., 2015. Statistical Learning with Sparsity: The Lasso and Generalizations. CRC Press. He, Y., Qin, Y., Lei, X., Feng, N., 2019. A study on short-term power load probability density forecasting considering wind power effects. International Journal of Electrical Power and Energy Systems 113, 502–514. Hong, T., Pinson, P., Wang, Y., Weron, R., Yang, D., Zareipour, H., 2020. Energy forecasting: A review and outlook. IEEE Open Access Journal of Power and Energy 7, 376–388. https://doi.org/10.1109/OAJPE.2020.3029979. Hubicka, K., Marcjasz, G., Weron, R., 2019. A note on averaging day-ahead electricity price forecasts across calibration windows. IEEE Transactions on Sustainable Energy 10, 321–323. Janczura, J., Trück, S., Weron, R., Wolff, R., 2013. Identifying spikes and seasonal compo- nents in electricity spot price data: a guide to robust modeling. Energy Econ. 38, 96–110. Kath, C., Ziel, F., 2020. Conformal prediction interval estimation and applications to day- ahead and intraday power markets. Int. J. Forecast. https://doi.org/10.1016/j. ijforecast.2020.09.006 In press. Koenker, R.W., 2005. Quantile Regression. Cambridge University Press. Kostrzewski, M., Kostrzewska, J., 2019. Probabilistic electricity price forecasting with Bayesian stochastic volatility models. Energy Econ. 80, 610–620. Kupiec, P.H., 1995. Techniques for verifying the accuracy of risk measurement models. The Journal of Derivatives 3, 73–84. Laio, F., Tamea, S., 2007. Veriﬁcation tools for probabilistic forecasts of continuous hydro- logical variables. Hydrol. Earth Syst. Sci. Discuss. 11, 1267–1277. Lebotsa, M.E., Sigauke, C., Bere, A., Fildes, R., Boylan, J.E., 2018. Short term electricity de- mand forecasting using partially linear additive quantile regression with an applica- tion to the unit commitment problem. Appl. Energy 222, 104–118. Lee, E.R., Noh, H., Park, B.U., 2014. Model selection via Bayesian information criterion for quantile regression models. J. Am. Stat. Assoc. 109, 216–229. Li, Y., Zhu, J., 2008. L1-norm quantile regression. J. Comput. Graph. Stat. 17, 163–185. Lichtendahl, K.C., Grushka-Cockayne, Y., Winkler, R.L., 2013. Is it better to average proba- bilities or quantiles? Manag. Sci. 59, 1594–1611. Lisi, F., Pelagatti, M., 2018. Component estimation for electricity market data: determinis- tic or stochastic? Energy Econ. 74, 13–37. Liu, B., Nowotarski, J., Hong, T., Weron, R., 2017. Probabilistic load forecasting via Quantile regression averaging on sister forecasts. IEEE Transactions on Smart Grid 8, 730–737. Maciejowska, K., 2020. Assessing the impact of renewable energy sources on the electric- ity price level and variability – a quantile regression approach. Energy Econ. 85, 104532. Maciejowska, K., Nowotarski, J., 2016. A hybrid model for GEFCom2014 probabilistic elec- tricity price forecasting. Int. J. Forecast. 32, 1051–1056. Maciejowska, K., Nowotarski, J., Weron, R., 2016. Probabilistic forecasting of electricity spot prices using factor quantile regression averaging. Int. J. Forecast. 32, 957–965. Maciejowska, K., Uniejewski, B., Seraﬁn, T., 2020. PCA forecast averaging – predicting day- ahead and intraday electricity prices. Energies 13, 3530. Manzan, S., 2015. Forecasting the distribution of economic variables in a data-rich envi- ronment. J. Bus. Econ. Stat. 33, 144–164. Table 2 Proﬁts (in PLN) obtained when using one of the benchmark or quantile-based strategies deﬁned in Sections 4.3.1–4.3.2 in the POLEX market for the whole out-of-sample, 853-day period, see Fig. 1. The highest proﬁts in each column are underlined, the best overall result is emphasized in bold. Strategy Proﬁt Naive (4 am–12 pm) 33,065.29 Point forecasts-based 37,722.39 Quantile-based 1–99% 5–95% 10–90% 15–85% 20–80% 25–75% Q-Ave 41,317.92 43,328.89 43,432.31 43,793.54 43,289.09 43,033.88 F-Ave 39,848.26 43,369.44 44,052.04 44,071.39 44,088.11 43,130.34 QRM 41,163.29 43,054.28 43,124.12 43,197.42 43,731.54 42,240.25 LQRA(77) 42,360.05 44,135.49 44,320.03 44,713.52 44,684.40 43,624.65 LQRA(BIC) 42,886.10 43,993.23 44,502.81 43,836.79 45,396.21 42,741.57 LQRA(CV) 41,693.80 43,971.88 44,238.45 44,213.62 45,073.19 43,103.88 B. Uniejewski and R. Weron Energy Economics 95 (2021) 105121 11 Marcjasz, G., 2020. Forecasting electricity prices using deep neural networks: a robust hyper-parameter selection scheme. Energies 13 (18), 4605. Marcjasz, G., Seraﬁn, T., Weron, R., 2018. Selection of calibration windows for day-ahead electricity price forecasting. Energies 11, 2364. Marcjasz, G., Uniejewski, B., Weron, R., 2020. Probabilistic electricity price forecasting with NARX networks: combine point or probabilistic forecasts? Int. J. Forecast. 36, 466–479. Misiorek, A., Trück, S., Weron, R., 2006. Point and interval forecasting of spot electricity prices: linear vs. non-linear time series models. Studies in Nonlinear Dynamics & Econometrics 10 (Article 2). Mpfumali, P., Sigauke, C., Bere, A., Mulaudzi, S., 2019. Day ahead hourly global horizontal irradiance forecasting – application to south African data. Energies 12, 3569. Narajewski, M., Ziel, F., 2020. Econometric modelling and forecasting of intraday electric- ity prices. J. Commod. Mark. 19, 100107. Nowotarski, J., Weron, R., 2015. Computing electricity spot price prediction intervals using quantile regression and forecast averaging. Comput. Stat. 30, 791–803. Nowotarski, J., Weron, R., 2018. Recent advances in electricity price forecasting: a review of probabilistic forecasting. Renew. Sust. Energ. Rev. 81, 1548–1568. Schneider, S., 2011. Power spot price models with negative prices. Journal of Energy Mar- kets 4, 77–102. Seraﬁn, T., Uniejewski, B., Weron, R., 2019. Averaging predictive distributions across cali- bration windows for day-ahead electricity price forecasting. Energies 12, 256. Sikorski, T., Jasinski, M., Ropuszynska-Surma, E., Weglarz, M., Kaczorowska, D., Kostyla, P., Leonowicz, Z., Lis, R., Rezmer, J., Rojewski, W., Sobierajski, M., Szymanda, J., Bejmert, D., Janik, P., 2019. A case study on distributed energy resources and energy-storage systems in a virtual power plant concept: economic aspects. Energies 12, 4447. Tibshirani, R., 1996. Regression shrinkage and selection via the lasso. Journal of the Royal Statistical Society B 58, 267–288. Tikhonov, A.N., 1963. Solution of incorrectly formulated problems and the regularization method. Soviet Mathematics Doklady 4, 1035–1038. Uniejewski, B., Weron, R., 2018. Efﬁcient forecasting of electricity spot prices with expert and LASSO models. Energies 11, 2039. Uniejewski, B., Nowotarski, J., Weron, R., 2016. Automated variable selection and shrink- age for day-ahead electricity price forecasting. Energies 9, 621. Uniejewski, B., Weron, R., Ziel, F., 2018. Variance stabilizing transformations for electricity spot price forecasting. IEEE Trans. Power Syst. 33, 2219–2229. Uniejewski, B., Marcjasz, G., Weron, R., 2019. On the importance of the long-term seasonal component in day-ahead electricity price forecasting: part II – probabilistic forecast- ing. Energy Econ. 79, 171–182. Wang, Y., Zhang, N., Tan, Y., Hong, T., Kirschen, D., Kang, C., 2019. Combining probabilistic load forecasts. IEEE Transactions on Smart Grid 10, 3664–3674. Weron, R., 2014. Electricity price forecasting: a review of the state-of-the-art with a look into the future. Int. J. Forecast. 30, 1030–1081. Zhang, Y., Liu, K., Qin, L., An, X., 2016. Deterministic and probabilistic interval prediction for short-term wind power generation based on variational mode decomposition and machine learning methods. Energy Convers. Manag. 112, 208–219. Zhang, W., Quan, H., Srinivasan, D., 2018. Parallel and reliable probabilistic load forecast- ing via quantile regression forest and quantile determination. Energy 160, 810–819. Ziel, F., 2016. Forecasting electricity spot prices using LASSO: on capturing the autoregressive intraday structure. IEEE Trans. Power Syst. 31, 4977–4987. Ziel, F., Weron, R., 2018. Day-ahead electricity price forecasting with high-dimensional structures: Univariate vs. multivariate modeling frameworks. Energy Econ. 70, 396–420. B. Uniejewski and R. Weron Energy Economics 95 (2021) 105121 12","libVersion":"0.3.2","langs":""}