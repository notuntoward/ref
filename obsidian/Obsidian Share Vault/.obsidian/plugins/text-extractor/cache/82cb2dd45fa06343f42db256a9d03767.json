{"path":"lit/lit_notes_OLD_PARTIAL/Ardiansyah22Seq2SeqRegressionLearningbased.pdf","text":"Sustainable Energy, Grids and Networks 32 (2022) 100939 Contents lists available at ScienceDirect Sustainable Energy, Grids and Networks journal homepage: www.elsevier.com/locate/segan Seq2Seq regression learning-based multivariate and multistep SOC forecasting of BESS in frequency regulation service Ardiansyah a, Zaki Masood a, Deokjai Choi b, Yonghoon Choi a,∗ a Energy ICT Laboratory, Department of Electrical Engineering, Chonnam National University, Gwangju, 61186, Korea b Department of Artificial Intelligence Convergence, Chonnam National University, Gwangju, 61186, Korea a r t i c l e i n f o Article history: Received 15 May 2022 Received in revised form 26 August 2022 Accepted 21 September 2022 Available online 12 October 2022 Keywords: Battery energy storage systems Deep regression learning Frequency regulation State of charge Multivariate forecasting a b s t r a c t Battery Energy Storage Systems (BESS) has a fast response time and high ramping capability, making it suitable for smart grid frequency regulation service. However, providing the required regulation capacity without a problem at any point in time is bound with the BESS state of charge (SOC) devel- opment periodically. Moreover, knowing SOC variation in advance will help the BESS producers keep SOC at the desired level. The BESS SOC can be maintained in the admissible operation area to avoid the mismatch penalties while following regulation signals. Therefore, the maximum service reward can also be achieved. Unfortunately, forecasting the SOC of BESS in frequency regulation service is not a straightforward problem. The forecasting method should deal with multiple dependent variables that periodically determine SOC’s development. Moreover, developing a one-time manner multistep SOC forecasting model is also a challenge. To solve both problems, a sequence-to-sequence (seq2seq) regression learning architecture that has been proven to deal with sequentially interdependent data is adopted in our proposed forecasting framework. Various state-of-the-art memory cells in deep regression learning, i.e., long short-term memory (LSTM), gated recurrent unit (GRU), bi-directional (bi)-LSTM, and bi-GRU, were utilized and evaluated. The evaluation result shows that the developed models outperform the existing machine learning-based forecasting methods. The Bi-GRU cells provide the best performance in root mean square error (RMSE) and mean absolute error (MAE) evaluation metrics. © 2022 The Author(s). Published by Elsevier Ltd. This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/). 1. Introduction In recent years, the immense development of smart grid tech- nologies has prompted a shift in the equipment used to handle the stability of the frequency in renewable-rich power systems. One of the most promising elements to provide a more flexible frequency regulation service is battery energy storage systems (BESS) [1–4]. BESS is a good option for frequency regulation ser- vice because of its fast response time feature. Moreover, its sus- tained rate of power change in megawatts per minute surpasses traditional power plants in ramping capabilities. As a result, the share of BESS in the frequency regulation service markets has been increasing rapidly in many countries. In the United States (US), the BESS capacity as frequency regulation resources has risen from zero to over 280 MW for the Pennsylvania-New Jersey- Maryland (PJM) independent system operator (ISO) alone [5]. In South Korea, BESS for frequency regulation service is located in all provinces with a total generation capacity is around 376 MW [6]. ∗ Correspondence to: Energy ICT Laboratory, Department of Electrical Engineering Convergence, Chonnam National University, Gwangju, 61186 Korea. E-mail address: yh.choi@jnu.ac.kr (Y. Choi). BESS is also gradually played a vital role in front-of-the-meter (FTM) grid services in Europe, the Middle East, and Africa (EMEA) region, in which the main implemented use case is frequency regulation service [7]. In a frequency regulation service system, the ISO holds the power capacity provided by BESS producers, which can be acti- vated automatically at any time to manage the balance of the grid frequency. As depicted in Fig. 1, the BESS can be used either as the frequency containment reserves (FCR) that stops the frequency drift in case of a grid failure event or the frequency restoration reserves (FRR) that brings the frequency back to its nominal value (60 Hz in South Korea). In both cases, the ISO, such as Korea Power Exchange (KPX), will publish the dynamic frequency regulation signal to ask BESS producers to follow. In a pay-for- performance-based frequency regulation service [8], the reward depends on their frequency regulation capacity and accuracy in following the regulation signal. Many ISOs have drafted their requirements for BESS participa- tion in frequency regulation service. For instance, in Germany, the 15-min-criteria had imposed on BESS producers that they should provide the required capacity for at least 15 min at any point of time without problem [9]. The BESS state of charge (SOC) needs https://doi.org/10.1016/j.segan.2022.100939 2352-4677/© 2022 The Author(s). Published by Elsevier Ltd. This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by- nc-nd/4.0/). Ardiansyah, Z. Masood, D. Choi et al. Sustainable Energy, Grids and Networks 32 (2022) 100939 Fig. 1. Illustration of smart grid frequency regulation service. In general can be divided into two-steps: (1) the frequency containment reserves (FCR), and (2) frequency restoration reserves (FRR). to be maintained in the admissible operation area to avoid the mismatch. SOC is the level of charge of the BESS relative to its capacity in percentage points (0% = empty; 100% = full). BESS may be operated freely at a certain level, between 25% and 75% of SOC. From the BESS producer’s point of view, the BESS power input/output response providing frequency regulation service can be expressed as the BESS SOC variation within the service period. A negative frequency deviation can lead to BESS discharging, while a positive frequency deviation may provoke BESS charging. Knowing SOC variation in advance will help the BESS producers keep SOC at the desired level and avoid mismatch penalties. With the wealth of available data, machine learning (ML)- based approaches have received renewed attention in SOC fore- casting problems [10,11]. Unfortunately, for the case of BESS in frequency regulation service, predicting its SOC is not straightfor- ward. The forecasting method should deal with multiple depen- dent variables that periodically determine the BESS SOC develop- ment. A. Mashlakov et al. in [12,13] developed SOC forecasting models for BESS operating in frequency regulation service by considering the hourly mean of frequency data and its modified features. Several traditional and state-of-the-art ML techniques, ranging from decision-tree-based regression methods (Decision- Tree (DT), Random-Forest (RF), and Light Gradient Boosting Ma- chine (LightGBM)) to data-driven deep regression learning ap- proaches (Convolutional Network Network (CNN) and Recurrent Neural Network (RNN)), have been analyzed. However, the analy- sis in [14] showed that the existing algorithms could not perform well when they dealt with the multistep SOC forecasting problem. Multi-step ahead forecasting is the task of predicting a sequence of values of the defined horizon in a one-time manner [15]. Given historical SOC data, a forecasting model predicts a vector of future SOC values by learning the dependence between inputs, inputs–outputs, and outputs of time-series data. Hence, a fore- casting method that can provide a robust solution for predicting sequentially interdependent data is indispensable. This paper addresses the issues mentioned above by utilizing the sequence-to-sequence (seq2seq) model in deep regression learning as our solution. The seq2seq model has been proven as a robust solution for multivariate and multistep forecasting for many different cases, as described in [16]. However, a de- tailed analysis of memory cell selection and time-step configu- ration needs to be conducted to find an optimal solution. In this case, we compare and analyze the implementation of long short- term memory (LSTM), and its state-of-the-art variants cells [17], i.e., gated recurrent unit (GRU), bi-directional (bi)-LSTM, and bi- GRU, in our SOC forecasting framework. Specifically, the main contributions of this paper are summarized as follows: 1. We handle SOC forecasting as a multivariate and multistep time-series forecasting problem. The seq2seq deep regres- sion learning architecture is utilized to develop a robust forecasting model. The implementation of four state-of- the-art memory cells, i.e., LSTM, bi-LSTM, GRU, and Bi-GRU, were analyzed and compared to find the best solution to solve the problem. 2. We use two real-world datasets that are publicly avail- able in [12,13]. An exploratory data analysis (EDA) is per- formed to find the best multivariate input for the pro- posed SOC forecasting framework. Two different feature sets are then generated. First, 2-features input was selected based on Pearson correlation analysis [18], and second, 6- features input that has a high (over 0.5) normalized mutual information (NMI) score [19]. 3. We conduct a comprehensive evaluation of our developed forecasting model along with the existing solution imple- mented in [12–14]. The mean square error (MSE) is used as a model optimization parameter in the training and validation steps. In testing cases, the root mean square error (RMSE) and the mean absolute error (MAE) are im- plemented as performance evaluation metrics. A statistical test method is then performed to check whether there is any significant difference in performance error among the proposed memory cells. The rest of this paper is organized as follows. The following section describes BESS participation’s system model and problem formulation in the pay-for-performance-based frequency regu- lation service. Section 2 provides our EDA on public BESS SOC datasets and then discusses the multivariate and multistep fore- casting problem regarding the dataset in detail. The general prin- ciples of seq2seq learning architecture applied in this study and our methods in developing and optimizing the forecasting models are presented in Section 3. Section 4 provides the evaluation results, and finally, Section 5 concludes our work on seq2seq learning-based multivariate and multistep BESS SOC forecasting problem. 2 Ardiansyah, Z. Masood, D. Choi et al. Sustainable Energy, Grids and Networks 32 (2022) 100939 2. BESS in pay-for-performance-based frequency regulation service Ideally, the grid frequency is the same everywhere on an interconnected grid, for example, 60 Hz in South Korea. How- ever, if the power generation and demand mismatch happen, the grid frequency moves away from its nominal value. More- over, implementing the low-carbon commitment by gradually replacing dispatchable fossil-fuel-based power plants with inter- mittent renewable power generation will demand more flexibility to guarantee the stability of power system operation. As men- tioned in the introduction, BESS can provide high instantaneous active power output in a fast response time. Therefore, BESS can be counted as one of the most flexible devices in smart grid systems to handle the frequency stability challenge. Frequency regulation service is generally implemented at sev- eral levels, i.e., primary, secondary, and tertiary frequency con- trol [13]. Due to its technical capabilities, BESS is usually used as either primary to stop the frequency drift or secondary frequency control to bring the frequency back to its nominal value. Our work focuses on the BESS application in primary frequency con- trol that gives higher market dividends than other services [20]. The primary frequency control is activated to guarantee the fre- quency stability of the power system, compensating for the offset between the energy production and the demand. Fast-acting au- tomatic resources are used to hold the frequency within the threshold by responding to the frequency deviations ∆(ft ). The deviation can be expressed as ∆(ft ) = f (t) − fn, (1) where, fn is the nominal system frequency and f (t) is the mea- sured frequency at time t. As prices for BESS cost development continue to decline and the need for system flexibility increases, power system opera- tors seek to develop policies to enhance BESS deployment in frequency regulation service. The regulator created an incentive program for fast responding units like BESS. For example, the Fed- eral Energy Regulatory Commission (FERC) in the United States (US) established FERC Order No. 755 [21]. Power system operators must add a performance payment with an accuracy adjustment to the capacity payment in this context. Currently, this pay-for- performance-based scheme has been implemented by most ISOs in US [5] and the European energy service market [13]. 2.1. Problem formulation Many service optimization models exist to determine the op- timal participation strategy of BESS in a pay-for-performance- based frequency regulation service [22]. Most developed partici- pation strategies are bound to various decision-making activities to find the trade-off between BESS operation cost and benefit. BESS producers should periodically evaluate the weighting fac- tors between possible rewards and operation costs. One of the most crucial weighting factors to optimize the BESS economical dispatch and unit commitment is the BESS SOC. It must accurately be predicted to maximize the received benefit, as depicted in the following objective function max C,b λc CT − λp T∑ t=1 |b(t) − Cr(t)| − λbes T∑ t=1 f [b(t), SoC (t)], (2) subject to: C ≥ 0, rt ∈ [−1, 1], (3) where, C ≥ 0 is the frequency regulation capacity bidding, t = (1, 2, 3, . . . , T ) is the operation time interval and r is the normalized dynamic frequency regulation signal (1 by T vector). Charging/discharging power capacity is denoted by b(t) (positive for charging). The function f [b(t), SoC (t)] represents the cost of BESS operation. λc is frequency regulation capacity clearing price, λp is the regulation payment subject to the relative error of the response, and λbes is the price of BESS cell operation cost of charging and discharging. The response is expressed by the BESS power output PFC at every moment t according to the dynamic regulation signal. A negative frequency deviation leads to BESS discharging, while a positive frequency deviation provokes BESS charging. The change of the BESS SOC within the period of frequency regulation can be defined as a percentage, expressed as ∆SoC (t) = 100% ∫ ti ti−1 ηPFC(t) Enom dt, (4) SoC (t) = SoC (t − 1) + ∆SoC (t) (5) subject to: − PFC (t) ≤ b(t) ≤ PFC (t) (6) SoCmin ≤ SoC (t) ≤ SoCmax, (7) where, η is the BESS efficiency and Enom is the nominal energy capacity of the BESS. In this paper, the assumption of BESS power- to-energy ratio is 1, as it is one of the most common ratios for the FCR according to [23]. The discharge and charge BESS efficiency were set to equal to 98.5%, and no degradation was considered to simulate the average battery response for every new measurement. Hence, the BESS power output PF C (t) in (4) and the charging and discharging power capacity b(t) in (2) will be the same value. 2.2. BESS SOC as multivariate & multistep forecasting problem Optimal BESS producers’ participation in frequency regulation service is dependent on the serial correlation of coupled resources and corresponding stochastic processes that predetermine the development of BESS SOC periodically, when it 0% = empty and 100% = max. At each time t = (1, 2, 3, . . . , T ), the BESS SOC forecasting problem can be treated as regression problem with multivariate input. As described in [12–14], various features can be used as multivariate input of the SOC forecasting models, such as the energy market feature, the frequency regulation signal feature, and the BESS state feature. The energy market feature may include renewable energy generation source profile, auto- matic activated reserve configuration, and regulation volume. The frequency regulation signal feature can be retrieved from the frequency measurement of the regulation service operation area. It may include the number of frequency values above or below daily single standard deviation, in sum or mean value. The BESS state feature may include the power input/output value of the charging/discharging process in its original form or modified by the variation shifting and the differential process. As a multivariate forecasting problem, a prediction model can be developed to predict the numerical output of SOC given some inputs. Let x = {x1, x2, . . . , xn} be the set of input variables and y = {y1, y2, . . . , ym} be a set of output variables, we can track on how SOC changing corresponding to multiple inputs, depicted as ym = β0 + β1x1 + β2x2 + · · · + βmxn + εm, (8) where, β0, β1, β2, . . . , βm are the regression coefficients and εm is the prediction error term. Several techniques were developed using a data-driven ML-based approach to find the best fit and minimize the predicting error. The best model is defined as the model that has the lowest prediction error. One of the widely used standard loss functions for measuring the model prediction error in regression analysis problems is the MSE. It corresponds to the average difference between the observed known values of the 3 Ardiansyah, Z. Masood, D. Choi et al. Sustainable Energy, Grids and Networks 32 (2022) 100939 predicting target and the predicted value by the model, depicted as 1 m m∑ i=1 ε2 i with εi = yi − ¯y(x1, x2, . . . , xn), (9) where yi and ¯y(x1, x2, . . . , xn) are the observed and predicted values of the target variables. RNN is a type of neural network algorithm that has a long history of solving regression task problems [24]. RNN can re- serve the temporal information in sequence by connecting hidden layers of the current time step and several previous time steps. However, RNN suffers from short-term memory that may have difficulty carrying information from earlier steps to later ones if a sequence is long enough. The LSTM cell is then created as a solution to solve this problem. In addition to utilizing the recurrent connection of the outputs from the previous time-step, LSTM has an internal mechanism called gates that operate like a local variable to accumulate state over the input sequence. A newer generation cell called GRU was developed [24]. It works like LSTM but with fewer tensor operations. LSTM/GRU offers at least two benefits to solving multivariate regression problems. First, it natively supports multiple parallel input sequences presented in a flat structure. Second, LSTM/GRU can map input data directly to a variable-length vector repre- senting numerous outputs. Even though GRU is expected to work faster than LSTM, there is no clear winner which technique gives better performance. Therefore, researchers and engineers usually try both to determine which one works better for their use-cases. For example, LSTM/GRU were used and compared for predicting solar radiation that can help in designing, sizing, and analyzing the performance of photovoltaic (PV) energy systems [17]. As mentioned earlier, the BESS SOC needs to be kept at a certain level (in 15 min and 1-h time steps for most cases) to provide the required frequency regulation capacity without any problem. In this case, multistep time-series forecasting, in which a forecasting model predicts a vector of future SOC val- ues in H = [xt+1, . . . , xt+H ] from historical time series data [x1, . . . , xt ], where H > 1 forecasting horizon, periodically need to be performed. Several methods were developed for multi-step forecasting problems, where three main strategies are, (1) Direct Multi-step Forecast Strategy, (2) Recursive Multi-step Forecast Strategy, (3) Multiple Output Forecast Strategy [25]. Different ML models have been used to implement the direct strategy for multi-step forecasting tasks, for instance, the nearest neighbors [26], DT and RF [27]. This direct method involves developing a separate model for each forecast time step. Using one model for each time step can add computational problems, especially as the number of time steps to be forecasted increases. On the other hand, the recursive strategy involves a single model multiple times that is commonly used in the Auto-Regressive In- tegrated Moving Average (ARIMA) [28] and default RNN learning architecture. In this case, the prediction for the prior time step is used iteratively to predict the following time step. Unfortunately, when very long-term forecasts are at stake and a stochastic set- ting is assumed, this modeling approach neglects the existence of stochastic dependencies between future values. Thus, prediction errors will be accumulated such that performance can quickly degrade as the prediction time horizon increases. The multiple output strategy involves developing a model that is capable of predicting the entire forecast sequence in a one-shot manner, depicted as [xt+H , . . . , xt+1] = F (xt , . . . , xt−n+1) + w, (10) where t ∈ {n, . . . , N − H}, F : Rd → RH is the input vector- valued function, and w ∈ RH is a noise vector. Hence, the predicted value is no more a scalar quantity but a vector of future values of the time series. The multiple output model is a more complex forecasting approach as they need to learn the depen- dence structure between inputs, inputs–outputs, and between outputs. 3. Seq2Seq regression learning as the forecasting solution This paper adopts the seq2seq regression learning architecture to deal with multivariate and multistep forecasting of BESS SOC. It is a variant of RNN architecture developed to work, learn, and predict sequentially dependent data. As depicted in Fig. 2, it con- sists of the encoder to read and encode the input sequence and the decoder that predicts each element in the output sequence of the forecasting horizon. Several memory cells, such as LSTM, GRU, bi-LSTM, and bi-GRU, can be utilized to solve the problem of carrying long enough information in both encoder–decoder, from earlier time steps to later ones in a sequence manner [16,17]. This model offers several benefits as follows 1. It can automatically learn features from sequence data as input without lag observations. 2. It can support multiple parallel input sequences for multi- variate inputs. 3. It can map input data directly to a variable-length vector representing multiple output time steps. 4. It can produce output vector sequence in a one-shot man- ner. Fig. 3 shows the flowchart of the BESS SOC forecasting pro- cess with the proposed seq2seq regression learning architecture. The intricacies of these processes are described in detail in the following sub-chapters. 3.1. Real-world dataset for SOC forecasting Representative data that considers the stochastic processes of corresponding multiple dependent variables periodically de- termining SOC’s development in the real-world environment is needed to make a good forecasting model from the proposed learning architecture. Therefore, two real-world SOC datasets of BESS operating in frequency regulation service are used. First, collected from Northern Europe (Finland) and second, imported from Central Europe (France) electricity market. In both datasets, the battery SOC data were simulated based on a simple BESS model, as described in [29]. The actual frequency measurements for four years, from 2015 to 2018, served as an input for the BESS model to generate the percentage value of SOC variation in the BESS charging and discharging state. The summary of SOC and frequency regulation profile in both datasets are depicted in Fig. 4. It is based on the assumption that the BESS full activation time is set to less than one second. It is to response the full activation frequency deviation (FAFD) of ±100 mHz and the dead-band (DB) of ±50 mHz for the Northern Europe dataset, and FAFD ±200 mHz and DB ±10 mHz for the Central Europe dataset. The grid frequency needs to be maintained within the DB limits by responding to the frequency deviations from the nominal system frequency. BESS is expected to become one of the first activated resorts in frequency regula- tion to guarantee stability. It can be expressed as a BESS power output response following the drop curve signal. A negative fre- quency deviation leads to BESS discharging, while a positive deviation provokes BESS charging. The BESS SOC variation is represented in percentage (positive for charging, negative for discharging). Initially, the simulation outcome was the time series consist- ing of BESS SOC variation data with a one-second resolution. 4 Ardiansyah, Z. Masood, D. Choi et al. Sustainable Energy, Grids and Networks 32 (2022) 100939 Fig. 2. The seq2seq regression learning architecture, consisted of encoder–decoder sub-model to deal with the multivariate and multi-step forecasting problem of BESS SOC. Fig. 3. Proposed SOC forecasting framework for BESS operated in frequency regulation service. Fig. 4. SOC and frequency regulation profile in each dataset, Northern Europe and Central Europe electricity markets. In frequency regulation application, the variation of SOC value is depend on the frequency regulation profile setting in each electricity market region. It was then re-sampled for a 15-min time step. For developing the SOC forecasting model, 140 041 samples were taken from the 15-min time scale in the Northern Europe dataset, divided into 69 968 samples for 2015–2016 data and 70 073 samples for 2017–2018. Then, the 15-min data were transformed to an hourly resolution that produced 35 064 samples of the one-hour time scale. The 15-min and one-hour time scale SOC data were selected considering the BESS operation in multi-objective grid services with current procurement practices and possible future developments. An example of frequency measurement and the percent value of SOC variation in a day of BESS operation is depicted in Figs. 5 and 6. For multi-objective grid services in the future research issue, we may classify the different services into four SOC variation categories based on its duty (frequency and intensity) profile as depicted in Fig. 7. Several feature sets such as market, frequency, and BESS state are available in the dataset. The market features were retrieved initially from open data in [31]. These include an hourly sum of wind power generation (wind), an hourly automatic activated reserve (up-aar, dn-aar), and regulation volumes (up-reg, dn- reg) in the area. The frequency (freq) regulation-related features were retrieved from the frequency measurements. They included hourly sums of the number of seconds when the frequency was above or below daily single (1s-up, 2s-up) or double (1s-dn, 2s-dn) the standard deviation value, respectively. Moreover, the means of these features related to the positive (sm-up) or neg- ative (sm-dn) deviation were also obtained. The BESS state data 5 Ardiansyah, Z. Masood, D. Choi et al. Sustainable Energy, Grids and Networks 32 (2022) 100939 Fig. 5. Example of frequency measurement on March 7, 2015, of the Northern Europe dataset. Fig. 6. Example of BESS SOC charging/discharging variation on March 7, 2015, in the Northern Europe dataset. Fig. 7. Illustration of BESS classification based on its duty profile for representing different SOC variation in multi-objective grid services, image source [30]. are the modified SOC by shifting (sh-1, sh-24, sh-48) and applying difference (df-1, df-24, df-48) with steps 1, 24, and 48, which are investigated because of the highest correlation at these time steps. 3.2. Data preprocessing An exploratory data analysis (EDA) is then conducted to pre- process the dataset and select the important features for the SOC forecasting inputs. From the heatmaps in Fig. 8, we can see Fig. 8. Correlation value of each feature in market and frequency measurement data with the SOC variation. Fig. 9. Correlation between artificially created frequency measurement data with the SOC variation. that the BESS SOC variation highly correlates with the mean of frequency measurement feature. The Pearson correlations of the frequency measurements led to 92% with the SOC variation data. Moreover, Fig. 9 shows that the artificially created frequency data features correlate with SOC varying from 60% to 80%. Therefore, we can say that the frequency measurement and its modified features become the essential factors that need to be considered to reduce the uncertainty of the SOC forecasting model. To be sure, we use a mutual information (MI) score method to confirm the correlation analysis result. The MI can be denoted as MI(x, y) = x∑ i=1 y∑ j=1 xi ∩ yjlog xi ∩ yj xiyj . (11) Where xi is the number of the samples in each input feature x and yj is the number of the samples in target output y. Furthermore, the normalized mutual information (NMI) between them can be defined as NMI(x, y) = MI(x, y) mean(H(x), H(y)) , (12) 6 Ardiansyah, Z. Masood, D. Choi et al. Sustainable Energy, Grids and Networks 32 (2022) 100939 Fig. 10. Normalized mutual information score between SOC variation and other available features. where H(x) and H(y) are the amount of uncertainty for each input feature and the target output, respectively. NMI score range is from 0 to 1 (0 = no mutual information, 1 = perfect correlation). A high NMI score indicates strong dependence between the target and the input feature [32]. Fig. 10 shows the NMI score between SOC variation and available features. We can confirm that freq measurement and its modified features are essential for accurate SOC forecasting. In the experiment, we set the timestamp as the time-series index. The percent value of BESS SOC variation and its corre- sponding frequency measurement features are used for the input data. The dataset is then divided for training and testing sets in proportions of 70% and 30%. Also, 25% of the training set is used for the hyper-parameters validation during the model development. Moreover, MinMax scaling with the range from 0 to 1 is used to normalize the dataset. Then, the missing values are replaced with linear interpolation. 3.3. Forecasting model development The illustration of our SOC forecasting model can be seen in Fig. 11. N is the number of historical data samples (look-back period) of X input, and M is the number of the forecasting hori- zons of Y output. f is the number of input features. In this case, two different feature sets are generated as SOC forecasting input. First, 2-features input was selected based on Pearson correlation analysis. Second, the 6-features input has a high (over 0.5) NMI score. The forecasting output, SOC, is in one-dimensional form. In LSTM and its variant cells, the input of developed models needs to transform into a three-dimensional (3D) array. The first dimension represents the number of sample data points. The second dimension represents the time steps of look-back periods, and the third dimension represents the number of features. The look-back period defines how much historical data are used to predict the subsequent time step. For instance, if we set 48 data points for the number of look-back periods, it represents twelve-hour prior periods for the 15-min scale dataset. The out- puts are the vector of SOC values for the next 15-min of the entire forecast horizon. Also, we employ Adam optimizer [33] for tuning the developed models, and the dropout regularization [34] to avoid overfitting. A fully connected layer called the time dis- tributed dense layer is then used for outputting the forecasting results. The implementation of forecasting models is using Keras 2.3.1 deep learning application programming interface (API) [35] with Tensorflow 2.1.0 [36] as the backend in the Python 3.7.6 environment. 3.4. Forecasting model optimization The type of predictive analytics problem imposes constraints on the kind of loss function used. One of the standard loss functions for a regression-type problem is the MSE, as mentioned Table 1 Parameter setting for the model optimization. Parameter Value/Range Developed models Seq2Seq LSTM and its variant cells Training/testing data 70%/30% of total data points Validation data 25% of total training data points MinMax normalization Enabled with range from 0 to 1 Missing data imputation Enabled using linear interpolation Regularization Dropout = 0.2 in each layer Number of units/sequence 64 (128 for Bi-LSTM/Bi-GRU) Number of maximal epochs 150 Batch size 8, 16, 32 Early stop to avoid overfitting Yes with patience = 30 Number of look-back periods 12–120 data points Optimization algorithm Adam for MSE minimization Testing evaluation metrics MAE, RMSE in Section 2.2. Since time-series forecasting is part of a regres- sion type problem, the MSE loss function is used to evaluate the network minimized by the Adam optimization algorithm. Furthermore, the networks are trained in several epochs to the training and validation dataset. Each epoch is then partitioned into groups of input–output pattern pairs called batches. Note that the batch size must be multiple 8, and the fine-tuning can be done based on the performance observation. Therefore, we set the batch size as 8, 16, and 32. Fig. 12 depicts the example of model optimization results based on the configured parameters in Table 1. It is shown that both training and validation losses are decreasing, with the opti- mal number of epochs around 10. Since we applied the dropout regularization in each layer to improve testing accuracy, the train- ing loss can be slightly higher than the validation loss. It should be noted that the regularization is only applied in the training stage, not in the validation stage. 4. Numerical evaluation 4.1. Evaluation metrics for testing performance The forecasting errors ϵt are estimated by the deviation be- tween actual observation and the prediction of SOC value from time to time. The mean absolute error (MAE) and the root mean squared error (RMSE) widely used for error evaluation metrics were employed to quantify the statistical quality of forecasts for testing data points. Depicted as MAE = 1 T T∑ t=1 εt , and (13) RMSE =    √ 1 T T∑ t=1 ε2 t . (14) 4.2. Performance comparison based on testing data We analyze and compare the performance of our developed SOC forecasting models with the existing ML-based regression methods described in [12]. The existing algorithms are included DT, RF, LightGBM, CNN, and RNN. We re-implemented the ex- isting ML methods using Keras 2.3.1 API for CNN and RNN deep learning models, Scikit-learn [37] library for DT and RF regression models, and its library for LightGBM model [38]. The first experimental result is presented in Fig. 13. It is shown that not all existing algorithms can accurately perform multivari- ate and multi-step SOC forecasting. Next, We also compare the performance of the existing algorithm, e.g., DT, with our proposed method for predicting SOC variation on two different datasets, 7 Ardiansyah, Z. Masood, D. Choi et al. Sustainable Energy, Grids and Networks 32 (2022) 100939 Fig. 11. Illustration of SOC forecasting model with LSTM cells. Fig. 12. Optimization result of the SOC forecasting model with Bi-LSTM cells. Northern Europe and Central Europe, respectively. From Fig. 14, we can see that our proposed method generally provides a better result in predicting SOC variation, even though BESS participates in two different frequency regulation profiles (See Fig. 4). Fig. 15 shows that the seq2seq regression learning-based ar- chitecture with Bi-GRU cell is the best solution. It can precisely predict the SOC variation of the forecasting horizon and outper- form other methods in multivariate and multistep forecasting of BESS SOC. However, we need to re-confirm it by using a quantita- tive evaluation metric. Furthermore, the performance comparison of all forecasting models according to the evaluation using MAE and RMSE performance metrics is shown in Table 2. It indi- cates that seq2seq regression with Bi-GRU and Bi-LSTM cells may become the best model for forecasting the change of BESS SOC by achieving the minimum MSE and RMSE scores in both 15-min and hour-ahead time scales. Moreover, the forecasting performance using 15-min scale dataset is better compare to the 1-h scale dataset. It is as our expectation that the 15-min-criteria had impose on BESS producers, they should provide the required Table 2 Performance evaluation result using testing data. Models MAE-2f MAE-6f RMSE-2f RMSE-6f DT 15-min 3.380 3.305 5.393 5.259 RF 15-min 2.365 2.366 3.907 3.888 LightGBM 15-min 2.935 2.845 4.527 4.489 CNN 15-min 2.644 2.613 4.404 4.397 LSTM 15-min 2.350 2.416 4.155 4.039 GRU 15-min 2.330 2.286 4.058 3.958 Bi-LSTM 15-min 2.331 2.252 4.033 3.731 Bi-GRU 15-min 2.262 2.028 3.683 3.420 DT 1-h 14.088 13.430 19.381 18.609 RF 1-h 8.798 8.804 13.477 13.272 LightGBM 1-h 9.388 9.078 14.344 13.395 CNN 1-h 9.143 8.881 14.338 13.363 LSTM 1-h 8.908 8.711 13.644 13.424 GRU 1-h 8.864 8.656 13.533 13.335 Bi-LSTM 1-h 8.725 8.676 13.311 13.169 Bi-GRU 1-h 8.716 8.645 13.191 12.968 capacity for at least 15 min at any point of time without problem for their participation in frequency regulation service. 4.3. Statistical test of evaluation results We extend our numerical evaluation by comprehensively comparing the performance of seq2seq regression-based multi- variate and multistep SOC forecasting with Bi-LSTM and Bi-GRU cells. It is by adopting a performance comparison study in [39], in which length of look-back periods or historical data is utilized as a comparison factor. The result of the performance comparison is depicted in Fig. 16. It is shown that the best performance can be achieved when the length of look-back is 72 in most cases. Also, the Bi-GRU model provides a more stable performance when the number of look-backs is increasing. To validate the result, we also conduct a statistical test with the following question: Is there any significant difference in error values between SOC forecasting results using Bi-LSTM and Bi- GRU cells? To answer this question, the following procedure is conducted: 8 Ardiansyah, Z. Masood, D. Choi et al. Sustainable Energy, Grids and Networks 32 (2022) 100939 Fig. 13. SOC forecasting results from re-run the existing ML-based regression algorithms applied in [12]. Fig. 14. Performance evaluation of DT regression vs. Seq2Seq regression with Bi-LSTM cells on two different datasets, Northern Europe and Central Europe, respectively. 1. We develop hypotheses, HO: No different/identical and H1: Different/not identical. 2. We employ the Paired Samples Wilcoxon Test [40] method, a non-parametric to compare paired data to test our hy- potheses. 3. We set the percent of the alpha risk as 5%, and the critical value of alpha risk for total paired samples is 52. As shown in Fig. 17, V = 0 and p-value = 9.489e−05 of the test is far less than critical value and percent risk of alpha. Therefore, we can conclude that the error value of the SOC forecasting result using Bi-GRU cells is significantly different from the Bi-LSTM one. Therefore, HO is rejected. Hence, we can confirm that the seq2seq regression learning using Bi-GRU cells provides better performance than Bi-LSTM cells on the multivariate and multistep BESS SOC forecasting problem. 5. Conclusion This paper proposed and developed a multivariate and multi- step SOC forecasting based on seq2seq regression learning archi- tecture with LSTM and its variant cells. Moreover, a performance comparison with existing ML-based regression algorithms was also conducted on two real-world BESS SOC datasets. The eval- uation results show that the developed models outperform the existing methods on both evaluation time scales. The proposed learning architecture with the Bi-GRU cells model achieves the best performance based on MAE and RMSE evaluation metrics. Then, a statistical analysis test verifies it. However, several prob- lems need to be addressed in future work for better evaluation results. First, it is necessary to consider anomaly and false data injection attacks in our forecasting models. The stochastic pro- gramming and other probabilistic prediction techniques may be 9 Ardiansyah, Z. Masood, D. Choi et al. Sustainable Energy, Grids and Networks 32 (2022) 100939 Fig. 15. Example performance results of DT technique versus our proposed techniques on the 15-min time scale of the BESS SOC testing set. Fig. 16. Extended performance comparison of SOC forecasting result using Bi-LSTM vs. Bi-GRU cells with different numbers of the look-back period setting. Fig. 17. Statistical test result for Bi-LSTM and Bi-GRU models. 10 Ardiansyah, Z. Masood, D. Choi et al. Sustainable Energy, Grids and Networks 32 (2022) 100939 considered as an alternative or a combinatory solution in fu- ture directions to quantify the uncertainties of the data noise and the model parameters in prediction interval of forecast- ing solution. Second, the most recent implementation of BESS systems operates using new and dedicated grid batteries. The next research direction should consider the second-life BESS use in multi-objective grid services. As described in literatures [41, 42], variations in the charge transfer and internal resistance of second-life BESS units may give a significant challenge to the efficient operation of a smart grid application. Therefore, further analysis in this context should also be considered. CRediT authorship contribution statement Ardiansyah: Conceptualization, Methodology, Software, Vali- dation, Formal analysis, Investigation, Data curation, Writing – original draft, Visualization. Zaki Masood: Validation, Data cu- ration, Visualization. Deokjai Choi: Validation, Writing – review & editing, Supervision. Yonghoon Choi: Validation, Resources, Writing - review & editing, Supervision, Project administration, Funding acquisition. Declaration of competing interest The authors declare that they have no known competing finan- cial interests or personal relationships that could have appeared to influence the work reported in this paper. Acknowledgments This research was supported by the MSIT (Ministry of Sci- ence and ICT), Korea, under the Innovative Human Resource Development for Local Intellectualization support program (IITP- 2022-RS-2022-00156287) supervised by the IITP, and supported by Basic Science Research Program through the National Research Foundation of Korea (NRF) funded by the Ministry of Education, Korea (NRF-2019R1I1A3A01060631). References [1] L. Maeyaert, L. Vandevelde, T. Döring, Battery storage for ancillary services in smart distribution grids, J. Energy Storage 30 (2020) 101524, http:// dx.doi.org/10.1016/j.est.2020.101524, URL https://www.sciencedirect.com/ science/article/pii/S2352152X19310898. [2] D. Akinyele, R. Rayudu, Review of energy storage technologies for sustainable power networks, Sustain. Energy Technol. Assess. 8 (2014) 74–91, http://dx.doi.org/10.1016/j.seta.2014.07.004, URL https://www.sciencedirect.com/science/article/pii/S2213138814000708. [3] Y.-K. Wu, K.-T. Tang, Frequency support by BESS – review and anal- ysis, Energy Procedia 156 (2019) 187–191, http://dx.doi.org/10.1016/ j.egypro.2018.11.126, URL https://www.sciencedirect.com/science/article/ pii/S1876610218310865. 5th International Conference on Power and Energy Systems Engineering (CPESE 2018). [4] X. Cao, N. Zhao, A cooperative management strategy for battery energy storage system providing enhanced frequency response, Energy Rep. 8 (2022) 120–128, http://dx.doi.org/10.1016/j.egyr.2021.11.092, URL https:// www.sciencedirect.com/science/article/pii/S2352484721012385. 2021 The 8th International Conference on Power and Energy Systems Engineering. [5] B. Xu, Y. Shi, D.S. Kirschen, B. Zhang, Optimal battery participation in frequency regulation markets, IEEE Trans. Power Syst. 33 (6) (2018) 6715–6725, http://dx.doi.org/10.1109/TPWRS.2018.2846774. [6] H.-S. Kim, J. Hong, I.-S. Choi, Implementation of distributed autonomous control based battery energy storage system for frequency regulation, Energies 14 (9) (2021) 2672, http://dx.doi.org/10.3390/en14092672. [7] M. Killer, M. Farrokhseresht, N.G. Paterakis, Implementation of large-scale li-ion battery energy storage systems within the EMEA region, Appl. Energy 260 (2020) 114166, http://dx.doi.org/10.1016/j.apenergy.2019.114166. [8] M. Tabari, B. Shaffer, Paying for performance: The role of policy in energy storage deployment, Energy Econ. 92 (2020) 104949, http://dx.doi.org/ 10.1016/j.eneco.2020.104949, URL https://www.sciencedirect.com/science/ article/pii/S0140988320302899. [9] A. Schreider, R. Bucher, An auspicious combination: Fast-ramping battery energy storage and high-capacity pumped hydro, Energy Procedia 155 (2018) 156–164, http://dx.doi.org/10.1016/j.egypro.2018.11.059, URL https: //www.sciencedirect.com/science/article/pii/S1876610218310130. 12th In- ternational Renewable Energy Storage Conference, IRES 2018, 13-15 March 2018, Düsseldorf, Germany. [10] B. Wu, W.D. Widanage, S. Yang, X. Liu, Battery digital twins: Perspectives on the fusion of models, data and artificial intelligence for smart bat- tery management systems, Energy AI 1 (2020) 100016, http://dx.doi.org/ 10.1016/j.egyai.2020.100016, URL https://www.sciencedirect.com/science/ article/pii/S2666546820300161. [11] M.-F. Ng, J. Zhao, Q. Yan, G.J. Conduit, Z.W. Seh, Predicting the state of charge and health of batteries using data-driven machine learning, Nat. Mach. Intell. 2 (3) (2020) 161–170, http://dx.doi.org/10.1038/s42256-020- 0156-7. [12] A. Mashlakov, S. Honkapuro, V. Tikka, A. Kaarna, L. Lensu, Multi-timescale forecasting of battery energy storage state-of-charge under frequency containment reserve for normal operation, in: 2019 16th International Conference on the European Energy Market (EEM), 2019, pp. 1–8, http: //dx.doi.org/10.1109/EEM.2019.8916335. [13] A. Mashlakov, L. Lensu, A. Kaarna, V. Tikka, S. Honkapuro, Probabilis- tic forecasting of battery energy storage state-of-charge under primary frequency control, IEEE J. Sel. Areas Commun. 38 (1) (2020) 96–109, http://dx.doi.org/10.1109/JSAC.2019.2952195. [14] Ardiansyah, Y. Kim, D. Choi, LSTM-based multi-step SOC forecasting of battery energy storage in grid ancillary services, in: 2021 IEEE International Conference on Communications, Control, and Computing Technologies for Smart Grids (SmartGridComm), 2021, pp. 276–281, http://dx.doi.org/10. 1109/SmartGridComm51999.2021.9632319. [15] R. Chandra, S. Goyal, R. Gupta, Evaluation of deep learning mod- els for multi-step ahead time series prediction, IEEE Access 9 (2021) 83105–83123, http://dx.doi.org/10.1109/ACCESS.2021.3085085. [16] H. Hewamalage, C. Bergmeir, K. Bandara, Recurrent neural networks for time series forecasting: Current status and future directions, Int. J. Forecast. 37 (1) (2021) 388–427, http://dx.doi.org/10.1016/j. ijforecast.2020.06.008, URL https://www.sciencedirect.com/science/article/ pii/S0169207020300996. [17] S. Boubaker, M. Benghanem, A. Mellit, A. Lefza, O. Kahouli, L. Kolsi, Deep neural networks for predicting solar radiation at hail region, Saudi Arabia, IEEE Access 9 (2021) 36719–36729, http://dx.doi.org/10.1109/ACCESS.2021. 3062205. [18] 2.6 - (Pearson) Correlation Coefficient r | STAT 462. URL https://online.stat. psu.edu/stat462/node/96/. [19] Z. Yang, R. Algesheimer, C.J. Tessone, A comparative analysis of community detection algorithms on artificial networks, Sci. Rep. 6 (1) (2016) 30750, http://dx.doi.org/10.1038/srep30750. [20] R. Moreno, R. Moreira, G. Strbac, A MILP model for optimising multi-service portfolios of distributed energy storage, Appl. Energy 137 (2015) 554–566, http://dx.doi.org/10.1016/j.apenergy.2014.08.080. [21] B. Xu, Y. Dvorkin, D.S. Kirschen, C.A. Silva-Monroy, J.-P. Watson, A comparison of policies on the participation of storage in U.S. frequency regulation markets, in: 2016 IEEE Power and Energy Society General Meeting (PESGM), 2016, pp. 1–5, http://dx.doi.org/10.1109/PESGM.2016. 7741531. [22] Y. Shi, B. Xu, Y. Tan, D. Kirschen, B. Zhang, Optimal battery control under cycle aging mechanisms in pay for performance settings, IEEE Trans. Automat. Control 64 (6) (2019) 2324–2339, http://dx.doi.org/10.1109/TAC. 2018.2867507. [23] H.C. Hesse, M. Schimpe, D. Kucevic, A. Jossen, Lithium-ion battery storage for the grid—A review of stationary battery storage system design tailored for applications in modern power grids, Energies 10 (12) (2017) http: //dx.doi.org/10.3390/en10122107, URL https://www.mdpi.com/1996-1073/ 10/12/2107. [24] H. Hewamalage, C. Bergmeir, K. Bandara, Recurrent neural networks for time series forecasting: Current status and future directions, Int. J. Forecast. 37 (1) (2021) 388–427, http://dx.doi.org/10.1016/j.ijforecast.2020.06.008. [25] G. Bontempi, S. Ben Taieb, Y.-A. Le Borgne, Machine learning strategies for time series forecasting, in: M.-A. Aufaure, E. Zimányi (Eds.), Busi- ness Intelligence: Second European Summer School, EBISS 2012, Brussels, Belgium, July 15-21, 2012, Tutorial Lectures, Springer Berlin Heidelberg, Berlin, Heidelberg, 2013, pp. 62–77, http://dx.doi.org/10.1007/978-3-642- 36318-4_3. [26] J.J. Flores, J.R.C. González, R.L. Farias, F. Calderon, Evolving nearest neighbor time series forecasters, Soft Comput. 23 (3) (2017) 1039–1048, http://dx. doi.org/10.1007/s00500-017-2822-1. [27] D. Vassallo, R. Krishnamurthy, T. Sherman, H.J.S. Fernando, Analysis of random forest modeling strategies for multi-step wind speed forecasting, Energies 13 (20) (2020) http://dx.doi.org/10.3390/en13205488, URL https: //www.mdpi.com/1996-1073/13/20/5488. 11 Ardiansyah, Z. Masood, D. Choi et al. Sustainable Energy, Grids and Networks 32 (2022) 100939 [28] G. Nugraha, A. Musa, J. Cho, K. Park, D. Choi, Lambda-based data processing architecture for two-level load forecasting in residential buildings, Energies 11 (4) (2018) 772, http://dx.doi.org/10.3390/en11040772. [29] P. Ralon, M. Taylor, A. Ilas, H. Diaz-Bone, K. Kairies, Electricity storage and renewables: Costs and markets to 2030, 2017, https://www.irena.org/publications/2017/oct/electricity-storage-and- renewables-costs-and-markets. [30] C. Zhao, S. Hashemi, P.B. Andersen, C. Træholt, Data-driven state of health modeling of battery energy storage systems providing grid services, in: 2021 11th International Conference on Power, Energy and Electrical En- gineering (CPEEE), 2021, pp. 43–49, http://dx.doi.org/10.1109/CPEEE51686. 2021.9383356. [31] Historical market data of the nordic synchronous system, 2021, https: //data.fingrid.fi/en/dataset/frequency-historical-data. [32] I. Koprinska, M. Rana, V.G. Agelidis, Correlation and instance based feature selection for electricity load forecasting, Knowl.-Based Syst. 82 (2015) 29–40, http://dx.doi.org/10.1016/j.knosys.2015.02.017. [33] D.P. Kingma, J. Ba, Adam: A method for stochastic optimization, 2017, arXiv:1412.6980. [34] N. Srivastava, G. Hinton, A. Krizhevsky, I. Sutskever, R. Salakhutdinov, Dropout: A simple way to prevent neural networks from overfitting, J. Mach. Learn. Res. 15 (56) (2014) 1929–1958, URL http://jmlr.org/papers/ v15/srivastava14a.html. [35] Keras 2.3.1, 2019, https://keras.io. [36] M. Abadi, P. Barham, J. Chen, Z. Chen, A. Davis, J. Dean, M. Devin, S. Ghemawat, G. Irving, M. Isard, M. Kudlur, J. Levenberg, R. Monga, S. Moore, D.G. Murray, B. Steiner, P. Tucker, V. Vasudevan, P. Warden, M. Wicke, Y. Yu, X. Zheng, Tensorflow: A system for large-scale machine learning, in: Proceedings of the 12th USENIX Conference on Operating Systems Design and Implementation, OSDI ’16, USENIX Association, USA, 2016, pp. 265–283. [37] F. Pedregosa, G. Varoquaux, A. Gramfort, V. Michel, B. Thirion, O. Grisel, M. Blondel, P. Prettenhofer, R. Weiss, V. Dubourg, J. Vanderplas, A. Passos, D. Cournapeau, M. Brucher, M. Perrot, É. Duchesnay, Scikit-learn: Machine learning in python, J. Mach. Learn. Res. 12 (85) (2011) 2825–2830, URL http://jmlr.org/papers/v12/pedregosa11a.html. [38] G. Ke, Q. Meng, T. Finely, T. Wang, W. Chen, W. Ma, Q. Ye, T.-Y. Liu, Lightgbm: A highly efficient gradient boosting decision tree, in: Advances in Neural Information Processing Systems 30 (NIP 2017), 2017, URL https://www.microsoft.com/en-us/research/publication/ lightgbm-a-highly-efficient-gradient-boosting-decision-tree/. [39] S. Yang, X. Yu, Y. Zhou, LSTM and GRU neural network performance comparison study: Taking yelp review dataset as an example, in: 2020 International Workshop on Electronic Communication and Artificial Intelli- gence (IWECAI), 2020, pp. 98–101, http://dx.doi.org/10.1109/IWECAI50956. 2020.00027. [40] D.F. Bauer, Constructing confidence sets using rank statistics, J. Amer. Statist. Assoc. 67 (339) (1972) 687–690, http://dx.doi.org/10. 1080/01621459.1972.10481279, URL http://www.tandfonline.com/doi/abs/ 10.1080/01621459.1972.10481279. [41] P. Hart, P. Kollmeyer, L. Juang, R. Lasseter, T. Jahns, Modeling of second- life batteries for use in a CERTS microgrid, in: 2014 Power and Energy Conference At Illinois (PECI), 2014, pp. 1–8, http://dx.doi.org/10.1109/PECI. 2014.6804554. [42] E. Hossain, D. Murtaugh, J. Mody, H.M.R. Faruque, M.S. Haque Sunny, N. Mohammad, A comprehensive review on second-life batteries: Current state, manufacturing considerations, applications, impacts, barriers & po- tential solutions, business strategies, and policies, IEEE Access 7 (2019) 73215–73252, http://dx.doi.org/10.1109/ACCESS.2019.2917859. 12","libVersion":"0.3.2","langs":""}