{"path":"lit/lit_notes_OLD_PARTIAL/Farmann16reviewSOCpredEV.pdf","text":"Review article A comprehensive review of on-board State-of-Available-Power prediction techniques for lithium-ion batteries in electric vehicles Alexander Farmann a, c, *, Dirk Uwe Sauer a, b, c a Electrochemical Energy Conversion and Storage Systems Group, Institute for Power Electronics and Electrical Drives (ISEA), RWTH Aachen University, Germany b Institute for Power Generation and Storage Systems (PGS), E.ON ERC, RWTH Aachen University, Germany c Jülich Aachen Research Alliance, JARA-Energy, Germany hi gh li gh t s g r a p hical a bstract \u0001 Challenges and issues of on-board SoAP prediction are discussed. \u0001 All available techniques recently applied for SoAP estimation are discussed. \u0001 For every technique the pros and cons of the proposed method are described. \u0001 Examples of existing research results and patents are given. art i cle i nfo Article history: Received 6 June 2016 Received in revised form 27 July 2016 Accepted 7 August 2016 Available online 24 August 2016 Keywords: State-of-Available-Power prediction Lithium-ion battery Electric vehicle Battery management system Review Battery abstract This study provides an overview of available techniques for on-board State-of-Available-Power (SoAP) prediction of lithium-ion batteries (LIBs) in electric vehicles. Different approaches dealing with the on- board estimation of battery State-of-Charge (SoC) or State-of-Health (SoH) have been extensively dis- cussed in various researches in the past. However, the topic of SoAP prediction has not been explored comprehensively yet. The prediction of the maximum power that can be applied to the battery by dis- charging or charging it during acceleration, regenerative braking and gradient climbing is deﬁnitely one of the most challenging tasks of battery management systems. In large lithium-ion battery packs because of many factors, such as temperature distribution, cell-to-cell deviations regarding the actual battery impedance or capacity either in initial or aged state, the use of efﬁcient and reliable methods for battery state estimation is required. The available battery power is limited by the safe operating area (SOA), where SOA is deﬁned by battery temperature, current, voltage and SoC. Accurate SoAP prediction allows the energy management system to regulate the power ﬂow of the vehicle more precisely and optimize battery performance and improve its lifetime accordingly. To this end, scientiﬁc and technical literature sources are studied and available approaches are reviewed. © 2016 Elsevier B.V. All rights reserved. 1. Introduction Partial or full electriﬁcation of the vehicle powertrains opens a wide range of opportunities to implement more consumer-friendly, security-relevant functions and to discard or reduce the vehicle's * Corresponding author. Jaegerstr. 17-19, D-52066 Aachen, Germany. E-mail addresses: alexander.farmann@gmail.com, batteries@isea.rwth-aachen. de (A. Farmann), batteries@isea.rwth-aachen.de (D.U. Sauer). Contents lists available at ScienceDirect Journal of Power Sources journal h omepage: www .elsevier.co m /lo c ate/jp owsou r http://dx.doi.org/10.1016/j.jpowsour.2016.08.031 0378-7753/© 2016 Elsevier B.V. All rights reserved. Journal of Power Sources 329 (2016) 123e137 local emission. In this regard, lithium-ion batteries (LIBs) are favored as promising alternative to other energy storage systems (ESS) such as lead-acid batteries or nickel-metal hydride batteries in automotive applications. In the long term, LIBs are a worthy replacement for fossil fuels and traditional energy sources for use either in mobile or stationary applications [1,2]. High level of gravimetric and volumetric energy and power density, low self-discharge, high cell-voltage (depending on the used active materials) and high cycle and calendar lifetime are among the main advantages of LIBs [3e7]. Considering the growing amount of patent applications of lithium-based technologies from both research institutions and industry in the recent past, a high interest in pushing LIB-based ESS forward can be observed [8]. In order to fulﬁll speciﬁc power and energy requirements in electric vehicles (EVs) generally speciﬁed by car manufactures, LIBs are connected in series and/or in parallel (depending on topology), thus forming a large lithium-ion battery pack [9]. The performance of LIBs and their operation are controlled and diagnosed by means of so-called battery management systems (BMS) consisting of both software and hardware [10]. In other words, protection against battery over-voltage, under-voltage, over-current, over-tempera- ture, under-temperature and cell balancing are among the main tasks of the BMS. Fig. 1 illustrates schematically a simpliﬁed lithium-ion battery pack including the following BMS electric and electronic compo- nents [11]: \u0001 Cell Controller Board (CCB), \u0001 BMS Master, \u0001 Low-voltage (LV) and high-voltage (HV) interfaces, \u0001 Fuse, contactors etc. The main task of the CCB is to measure a particular number of cell voltages and temperatures (e.g., 1e12 cells) [11]. In fact, the CCB is the only physical interface between the BMS and the battery cells. Furthermore, cell balancing is performed by means of balancing resistances implemented on each CCB and controlled by an algo- rithm implemented on the electronic control unit (ECU) in the BMS master. Depending on the topology of the lithium-ion battery pack and the number of LIBs which have to be monitored, one or more CCBs are required. Each CCB communicates with the other CCBs via Controlled Area Network (CAN) or Isolated Communications Interface (isoSPI). Measured cell voltages and temperatures are then submitted via CAN to the BMS Master and analyzed, respec- tively. On the one hand the BMS Master is responsible for evalu- ating the measured battery pack's current and voltage as well as triggering the contactors (opening, closing) during pre-charge phases or when a crash or fault is detected, and on the other hand it performs plausibility checks and diagnoses of the battery states and parameters. Furthermore, monitoring algorithms implemented for battery state estimation (BSE) are running on the ECU. Submitting or receiving data to/from the vehicle EMS as well as the electronic power supply are all performed over a designed low-voltage (LV) interface. The accurate estimation of battery states, such as State-of- Charge (SoC), State-of-Available-Power (SoAP) or State-of-Health (SoH), is still a challenging task, keeping in mind that the imple- mented monitoring algorithms have to work accurately over years in the particular application. Monitoring algorithms use on-board measured values such as battery temperature, battery voltage and current for BSE. However, since a direct insight into electrochemical processes inside the LIBs in the ﬁeld is not possible, estimated battery states or parameters may differ from real values. For example, according to Ref. [12], the difference between the measured cell temperature on the surface and in the core may be approximately 10 K. Keeping in mind that often one single tem- perature sensor is used in a battery module for monitoring the module's temperature1 and the measurement accuracy of imple- mented temperature sensors are often low, it becomes obvious how challenging the task of reliable and accurate battery monitoring is considering all uncertainties and disturbances. The electrical and thermal performance of the battery is mainly inﬂuenced by the following factors: \u0001 Topology of the lithium-ion battery pack [13,16]. \u0001 Internal and external factors, such as unequal aging behavior of the LIBs over the battery lifetime (capacity and impedance spread between each individual LIB in the battery module/pack) [9,14], \u0001 Inconsistency of the SoCs [13,15], \u0001 System losses occurring in the battery pack (e.g., power rails, contactor resistances etc.) [9,15], \u0001 Limitation of the use of the battery's maximum power and en- ergy capacity, caused by the increase of battery impedance and decrease of available battery capacity over the battery lifetime [13], \u0001 Distribution of the temperature in the battery pack 2 etc. [7,15]. Therefore, it is necessary to consider these factors during the system design phase in order to prevent oversizing the system and reduce costs, respectively, while speciﬁed requirements are fulﬁlled. One of the state-of-the-art approaches used for static power capability determination is the hybrid pulse power characterization (HPPC) method presented by the partnership for new generation vehicles (PNGV) battery test manual, published by the Idaho Na- tional Engineering & Environmental Laboratory of the U.S. Department of Energy [17]. An improved method for the determi- nation of power capability by means of pulse tests with some modiﬁcations regarding applied current rates, resting time etc., is presented in our previous work [18]. In fact, accurate results may be achieved by applying this technique in laboratory environments. But under real conditions, such as in vehicles where available peak current or voltage for a speciﬁed time horizon need to be known, accurate power values are not provided and the results are mostly overestimated since only the operational design limit of battery voltage is considered [4,21e23]. Fig. 2 shows the dependence of battery power capability on battery SoC over the battery lifetime at 23 \u0003C in an example of a battery electric vehicle (BEV) prototype using Li(NiMnCo)O2 (NMC)/Li4Ti5O12 (LTO) LIBs. The available bat- tery power is determined based on resistance values obtained as a voltage value reached after 20 s from the beginning of the current pulse divided by the current. The power fade occurred over the battery lifetime directly in- ﬂuences the driving performance of the vehicle in terms of accel- eration or battery charging during regenerative phases and charging periods [24]. From the relationship between battery SoC and power capability shown in Fig. 2, it becomes obvious that the charging power capability decreases with the increase of SoC and vice versa. The maximum available power of a lithium-ion battery pack (Fig. 2) is derived by investigating the battery's open-circuit voltage (VOCV) and resistance as follows [25e27]: Pdischarge ¼ [Vcell,min$(VOCV cell,charge \u0004 Vcell,min)/Rcell,discharge]$ ncell,series$nmodule,parallel (1.1) 1 Each battery module consists of several cells connected in series or parallel. 2 Temperature differences between individual LIBs must be kept in a range of 3 \u0003Ce5 \u0003C [19,20]. A. Farmann, D.U. Sauer / Journal of Power Sources 329 (2016) 123e137124 Pcharge ¼ [Vcell,max$(Vcell,max \u0004 VOCV cell,charge)/Rcell,charge]$ ncell,series$nmodule,parallel (1.2) Based on Eqs. (1.1)e(1.2), it can be concluded that the power fade over the battery lifetime is mainly inﬂuenced by the increase of battery impedance. The current that can be applied to the battery can simply be derived from Eqs. (1.1)e(1.2) after some mathemat- ical calculations from Ref. [27]. It is worth noting that the applied technique for determination of the battery power capability is in- dependent of the battery chemistry used. However, it is important to ensure the constant battery temperature and to adjust the cor- rect SoC level during the tests. Generally, as an established rule in automotive applications, the End of Life (EoL) of the battery is reached when its actual capacity has decreased to 70% e 80% of its nominal value or when the impedance has increased up to 100% of its nominal value [25,29].In Ref. [25], the authors examine the power capability of a battery pack of a BEV at different aging states using three different driving cycles. The obtained results indicate that when the available battery power fades down to 50% (i.e., the battery impedance is doubled) the vehicle might have trouble accommodating the discharge or charge power at low and at high SoC ranges, respectively. Furthermore, according to the results, the decrease of available battery power leads to the increase of acceleration time, in partic- ular at low SoCs. The available battery power is limited by the safe operating area (SOA), where the SOA is deﬁned by battery temperature, current, voltage and SoC [30,31]. However, during a single applied current over a time horizon of several seconds (Dt \u0005 10 s), the battery's temperature and SoC do not change signiﬁcantly. It can be therefore concluded that in practice battery voltage and current are the major limiting factors for SoAP prediction [31,32]. Because of safety rea- sons the battery must be operated in a speciﬁed voltage window (Vmin \u0005 Voperating \u0005 Vmax); this limitation inﬂuences the maximum current which can be drawn from or fed into the battery and it is therefore often used as an indicator for the battery's power capa- bility. Consequently, the maximum power which is allowed to be applied to the battery can be determined when the pre-deﬁned SOA limit of battery current or battery voltage is reached. It is worth noting that not only the voltage of the lithium-ion battery pack but also the voltage of individual cells must be monitored. For this reason, by the beginning of the pulse (t ¼ t0), battery voltage and battery current at the end of the applied pulse (t ¼ t0 þ Dt) should be predicted (Fig. 3). 3 As by the beginning of the pulse it is not known whether the voltage or the current or both of them are limiting factors, one must distinguish between the following four different cases [32,33]: \u0001 Case A: Charging with cell or battery voltage limitation, Fig. 1. Schematic illustration of simpliﬁed modular-based lithium-ion battery pack including HV/LV interfaces, LIBs, electric and electronic components. Fig. 2. Power capability of lithium-ion battery pack of BEV prototype using NMC/LTO LIBs (Vnominal ¼ 311 V, ns ¼ 130, np ¼ 1, Vcell,min ¼ 1.5 V, Vcell,max ¼ 2.7 V) in new and aged states at 23 \u0003C determined as proposed in Eqs. (1.1)e(1.2). 3 Fig. 3 shows cases where it is assumed that constant current pulses are applied to the battery; however, depending on the application, it is also possible that constant power pulses are applied to the battery which means that both the battery current and voltage would change during the applied power pulse. A. Farmann, D.U. Sauer / Journal of Power Sources 329 (2016) 123e137 125 \u0001 Case B: Charging with battery current limitation, \u0001 Case C: Discharging with cell or battery voltage limitation, \u0001 Case D: Discharging with battery current limitation. In Fig. 3a) and c), the cases are illustrated where the battery voltage at the end of the applied charge or discharge current rea- ches exactly the allowed upper or lower voltage limit (see case A and case C above). In these two cases the predeﬁned current limit is not exceeded. At the same time in Fig. 3b) and d), the maximum limiting charge and discharge current is applied to the battery while the upper or lower voltage limit is not reached (see case B and case D above). In fact, case B is the only case among all the four listed cases where the battery is charged with the maximum limiting current while the absolute value of the available battery power is increasing. In the remaining cases, the absolute value of the available battery power decreases over particular charging or discharging periods. As a general rule, the time horizon for SoAP prediction lies be- tween 1 s and 20 s in BEVs and hybrid electric vehicles (HEVs) [10]. By knowing the available battery power in addition to the actual battery SoC and SoH, a reasonable EMS strategy can be applied and speciﬁed vehicle functions, such as vehicle acceleration, decelera- tion or gradient climbing can be performed without exiting battery SOA and affecting the lifetime of the battery or causing safety damage, respectively [26,34,35]. In addition to the discussed impacts of battery SoC, current and voltage on available battery power, it is essential not to neglect the inﬂuence of battery temperature. Since applied high charge or discharge current rates or battery temperatures may inﬂuence the aging behavior of the battery (e.g., lithium plating4 etc.) [36], the SoAP prediction algorithm must consider these boundary condi- tions as well. Fig. 4 shows the dependence of SoAP on temperature and applied current rate in an example of a BEV prototype using NMC/LTO LIBs. As expected, the available battery power for both charge and discharge direction decreases with the decrease of battery temperature, as a consequence of increasing battery resis- tance. At the same time, the available battery power increases with the increase of temperature while aging processes occurring in the LIB are faster under such operating conditions. This study aims to give an overview of available techniques for SoAP prediction of LIBs in EVs. Unfortunately, it seems that there is no uniform deﬁnition available in the literature for battery power capability. The deﬁnition used in this study, namely SoAP, differs little from the deﬁnition of State-of-Function (SoF) estimation which is often employed. SoF is a ﬁgure of merit that describes the battery capability to perform a certain task [38,39]. In the particular case of battery power capability, it may be concluded that SoF is a kind of logical signal that only allows yes or no response to the required battery power for a certain function, such as cranking capability etc. At the same time, SoAP is mainly related to the amount of power which the battery can deliver to or accept from the vehicle powertrain over a certain time horizon (Dt) [19,40e42]. Therefore, in order to prevent misinterpreting of the used param- eters, in this study we will only use the SoAP deﬁnition whose meaning and particular deﬁnition is described above. An alterna- tive deﬁnition is given in Refs. [43,44], where the authors state that SoAP is actually deﬁned as a ratio of available battery power to the maximum nominal battery power. Up to now, different approaches for SoC and SoH estimation of LIBs have been shown and reviewed in the literature by many au- thors in the past. However, the topic of SoAP prediction has not been explored enough sufﬁciently yet and there are still a lot of researches required to optimize, improve and understand this challenging task. In this context, the available techniques for pre- dicting the SoAP can generally be subdivided into the following two groups: \u0001 Methods based on (adaptive) characteristic maps (CMs), \u0001 Methods based on equivalent circuit models (ECMs). In the following sections, the methods for SoAP prediction dis- cussed in scientiﬁc and technical literatures are reviewed. It is worth noting that the focus is not to describe each individual method in detail, but rather the elaboration of the strengths and weaknesses of the respective technique. The remainder of this article is organized as follows (Fig. 5): In Section 2, techniques based on adaptive characteristic maps are introduced and dis- cussed. Estimation techniques based on ECMs and corresponding literature are reviewed in Section 3. Finally, this work is summa- rized in the conclusion. 2. Methods based on (adaptive) characteristic maps The methods based on characteristic maps (CM) use the known static interdependences between battery power capability and battery parameters and states. Related battery parameters and states generally used in this context are listed as follows [45,46]: \u0001 SoC, \u0001 Temperature, \u0001 Duration of the power pulse, \u0001 Required power, \u0001 Battery voltage. In order to build the CM: First, the above mentioned de- pendences are characterized by various battery characterization techniques, such as HPPC tests or electrochemical impedance spectroscopy (EIS). Second, the extracted parameters are stored as a more dimensional matrix in a non-volatile memory in the ECU used as initial parameter sets of the battery. As discussed in the previous section, because of aging mecha- nisms occurring in the LIBs, their impedance characteristics change over the battery lifetime. This makes the use of adaptive techniques for tracking the CMs over the battery lifetime necessary. The basic idea of the techniques using CMs is simple: The battery power measured on-board is compared with the predicted value (DP ¼ Pmeas \u0004 Pestim) and the corresponding reference point in the CM is adapted if a deviation between both values is detected. This process yields more accurate future power prediction in the cor- responding area of the map. Among the main advantages of CM-based techniques for pre- dicting the SoAP are its simple implementation and straight for- ward characteristic. However, since batteries are nonlinear devices, there are some issues which need to be considered thoroughly. First, battery's characteristics (e.g., dynamic behavior etc.) depend strongly on its previous history. Various electrochemical processes, such as charge transfer processes become pronounced when dy- namic load is applied to the battery. Since these effects are not considered in the CMs, the SoAP prediction accuracy is signiﬁcantly affected. Second, the dependences of the above mentioned pa- rameters are stored on the memory in multidimensional form. This means that a high amount of storage capacity is needed depending on the amount of parameters. Unfortunately, in most cases, data storage capability and computational resources on microcontrollers are limited. Therefore, a speciﬁc functional extension is required in order to reduce the computational effort, so that the dependences 4 Lithium plating refers to deposition of metallic lithium in form of dendrites in the anode [37]. A. Farmann, D.U. Sauer / Journal of Power Sources 329 (2016) 123e137126 of the parameters are approximated by empirical functions (e.g., polynomial functions) [33,47e49]. In Ref. [45], the authors present an adaptive CM-based (ACM) technique where the dependences between actual SoC, tempera- ture, duration of the applied load (1 se10 s) and available power of LIBs are considered. Moreover, battery voltage and current are Fig. 3. Schematic illustration of four cases for limiting available battery power in case of battery charging or discharging with constant current: a) applying constant charge current (Icharge < Imax) while battery voltage is the limiting factor (in this case the battery could be at very high SoC range); b) applying constant charge current (Icharge ¼ Imax) while current is the limiting factor (SoCcase,b < SoCcase,a); c) applying constant discharge current (Idischarge > Imin) while battery voltage is the limiting factor (in this case the battery could be at very low SoC range); d) applying constant discharge current (Idischarge ¼ Imin) while current is the limiting factor (SoCcase,d > SoCcase,c). Fig. 4. Dependence of available battery power on battery current and SoC at different temperatures in an example of a lithium-ion battery pack prototype using NMC/LTO LIBs in new state (Vnominal ¼ 311 V, ns ¼ 130, np ¼ 1, Vcell,min ¼ 1.5 V, Vcell,max ¼ 2.7 V) determined as proposed in Eqs. (1.1)e(1.2). A. Farmann, D.U. Sauer / Journal of Power Sources 329 (2016) 123e137 127 measured and observed over a pre-deﬁned time horizon and consequently compared with a reference power value of the CM. If any difference is detected and it is higher than a value speciﬁed beforehand, the respective reference point of the CM is adapted accordingly. In Ref. [47], a method for determining the maximum available charge or discharge battery power depending on actual battery SoC, temperature and its actual aging state (available discharge capac- ity) is discussed. A 5th order polynomial function is applied in order to build the interrelation function between power and SoC and between power and available discharge capacity. The interrelation function between temperature and power is built by means of a 2nd order polynomial function. In Refs. [48,49] a self-learning technique for SoAP prediction in HEVs as an example of NiMH and Lead-Acid batteries is introduced. The authors introduce an algorithm employing ACM where the 2nd order polynomial function is used to approximate the operating point of the CM by means of simple multidimensional regression techniques, resulting in less consumption of the memory on the microcontroller. Otherwise, according to the authors, about 3000 measured values would have to be stored which requires a high amount of memory capacity. In this context, the battery behavior is represented by the coefﬁcients of the used polynomial function. In order to track the battery's characteristics over its lifetime, the applied regression function is continuously updated during oper- ation. The dependences between voltage, SoC, temperature, pulse duration and the absolute power value are employed to build the ACM. The implemented algorithm is able to predict the SoAP under the above conditions by considering the allowed voltage window. In Ref. [50], an algorithm for estimating certain parameters such as battery discharge power, available charge capacity, overcharge or over discharge detection of lithium-ion battery packs in HEVs is presented. For this reason, the authors propose to use the deter- mined battery internal resistance as a reference for estimating the above mentioned battery parameters. In this regard, the proposed algorithm uses the values of internal resistance and OCV for a given SoC from CM and determines the available battery power based on Eqs. (1.1)e(1.2). However, the non-adaptive nature of the proposed algorithm and neglect of the inﬂuence of temperature are its main disadvantages. Consequently, the values of the internal resistance remain constant over the battery lifetime although an increase of battery resistance during operation is expected. 3. Methods based on equivalent circuit models As a second technique for predicting the battery SoAP, model- based methods employing ECMs are discussed in this section. These techniques differ mainly in the used ECM and methodology for on-board parameters and battery states identiﬁcation. In order to be able to predict the available battery power accurately, it is necessary to use a dynamic battery model which reproduces electrochemical processes occurring in the battery as accurately as possible. However, a feasible replica of each of the processes can rarely be obtained since up to now many processes occurring under different conditions are not identiﬁed or understood sufﬁciently. In this regard, physics-based electrochemical battery models consid- ering spatially distributed behavior of the battery states are the most promising solution for comprehensive battery analysis. In fact, because of their high complexity and the required high computational effort, such battery models are not suitable for BSE. In this context, it may be stated that model-based approaches using simple electrical models are the most promising solutions for estimating the available battery power in BEVs or HEVs where high dynamic loads are present. A simple impedance-based ECM describing the electrode re- actions in the ESS was ﬁrst proposed by Randle in Ref. [51]. The proposed ECM consisting of resistances (including ohmic and charge transfer resistance) and a double-layer capacitance is still very popular in BMS applications, mainly because of its simplicity. Since then, many other more complex ECMs representing various electrochemical processes in great detail have been proposed by other researchers. Reviews and descriptions of different impedance-based battery models may be found in Refs. [52e55]. Considering the limited computational power of BMS, reducing the model parameters to a minimum by trying to depict the elec- trochemical processes as accurately as possible becomes necessary. In this regard, ECMs employed in the BMS often consist of a VOCV,a simple linear ohmic resistance and a number of RC-elements con- nected in series. The number of applied RC-elements depends highly on the application, relevant time constants and required estimation accuracy. A higher number of RC-elements leads to higher estimation accuracy while at the same time the computa- tional effort increases [29,56e58]. An example of a possible ECM for integration in a BSE algorithm is shown in Fig. 6. Each element of the ECM refers to a certain electrochemical process during battery operation or even in a battery steady state. R0 refers to the resis- tance contribution of electrolyte, battery poles, corrosion, conduc- tors. RC-elements reproduce polarization overvoltages that mainly occur because of passivation layers on the electrodes, charge transfer processes at the interfacial between electrode and elec- trolyte, diffusion, migration and remaining convection processes. The open-circuit behavior of the battery is represented by means of a VOCV. In an example of the ECM shown in Fig. 6, the estimated battery voltage Vestim(Dt) at the end of the (dis)charging current pulse for a certain time horizon of Dt can be derived as follows: DVR0 ¼ R0$I (3-1) DV1ðDtÞ¼ V1ðt ¼ 0Þ$e \u0004Dt R1 C1 þ R1$\u00011 \u0004 e \u0004Dt R1 C1 \u0003$I (3-2) Fig. 5. Organization of the present paper. A. Farmann, D.U. Sauer / Journal of Power Sources 329 (2016) 123e137128 DV2ðDtÞ¼ V2ðt ¼ 0Þ$e \u0004Dt R2 C2 þ R2$\u00011 \u0004 e \u0004Dt R2 C2 \u0003$I (3-3) DVnðDtÞ¼ Vnðt ¼ 0Þ$e \u0004Dt Rn Cn þ Rn$\u00011 \u0004 e \u0004Dt Rn Cn \u0003$I (3-4) VestimðDtÞ¼ DVR0 þ DV1ðDtÞþ DV2ðDtÞþ DVnðDtÞþ VOCVðSoCÞ þ vðSoCÞ$Dt$I (3-5) where v(SoC) [V$A\u00041$s\u00041] represents the change of the VOCV per As of current ﬂow. In Ref. [57] a wide overview of ECMs that are often applied for BSE in BMS for automotive applications is given. Employed ECMs are compared considering their robustness, model complexity and accuracy of the estimated battery voltage. A multi-swarm particle algorithm is employed for estimating the ECM parameters on- board. On the one hand, using a complex ECM yields a higher de- gree of voltage estimation accuracy, but on the other hand the parameter identiﬁcation of such ECMs requires high computational power which is rarely given on a microcontroller. In our previous work [59], the applicability of enhanced ECMs using two ZARC- elements for on-board voltage estimation in BMS is introduced. The ZARC-elements corresponding to different electrochemical processes are approximated by means of odd number of RC- elements, where the ECM parameters are identiﬁed using the enhanced varied parameter approach technique. The presented ECM is much more accurate for battery voltage estimation in comparison to other commonly used ECMs, such as ECMs using one or two RC-elements. In order to ensure high estimation accuracy over the battery lifetime and under various operating conditions (e.g., various temperatures and SoCs), ECM parameters need to be adapted to the actual aging state of the LIB on-board [60]. In Ref. [14], the authors show that the estimation accuracy could decrease over the battery lifetime even if the parameters of the ECM are adapted to the actual aging state of the battery. Algorithms presented in many researches in the past were often validated under nominal conditions or when the battery was in a new state. However, as discussed in Refs. [30,32], the accurate prediction of the available battery power becomes more challenging at low temperatures or when the bat- tery is aged, as the LIB reaches the predeﬁned SOA and power limits, respectively, readily. As a common solution for ECM parameters estimation, the battery model is represented in a discrete-time state-space form. The methods differ in the way how the states and parameters of the model are estimated. Generally, it can be differentiated between the following two techniques [29,61]: \u0001 Adaptive joint estimation technique, \u0001 Adaptive dual estimation technique. With the joint estimation technique an adaptive ﬁlter is applied on a single vector of unknown parameters and states for their estimation. The dual estimation technique uses two ﬁlters in par- allel. One ﬁlter is used for the state estimation and the other one for the parameter estimation. A selection of well-known methodolo- gies that are often applied for the on-board estimation of the ECM parameters is listed in Fig. 7. The ﬁrst two techniques, namely Kalman ﬁlter-based (KF) and Least-Square-based (LS) estimators, belong deﬁnitely to the most often employed recursive estimators in various engineering disci- plines. In both cases, the system uses a linear regression model in a generic form [62,63]. Algorithms based on the KF technique are widely spread in the ﬁeld of BSE. KF was for the ﬁrst time presented in 1960 by Kalman in Ref. [64]. However, since KF can only be applied to linear systems and batteries show a highly nonlinear behavior (e.g., current dependence of the charge transfer resistance etc.), it is often used in combination with other extended ﬁlters (e.g., Least-square, Extended Kalman ﬁlter (EKF), Sigma-Point Kal- man ﬁlter (SPKF) etc.). There are some disadvantages of the KF-based algorithms which need to be addressed: a) required complicated matrix calculations (i.e., Jacobian matrix), b) the linearization of the nonlinearity of the battery characteristics and the necessity of knowing a priori the variable of the system noises, such as mean value, relevance and covariance matrix. An inconvenient information matrix of the system noise may yield estimation error and parameters diver- gence, respectively [65e67]. 3.1. Kalman ﬁlter-based methods In Ref. [40], a SoAP prediction technique using KF for estimating ECM parameters (R-RC) is introduced. The main differences with regard to the deﬁnitions of SoF and SoAP are carefully addressed and alternative possibilities are provided. The applied algorithm considers the change of VOCV during the applied discharge current pulse (dVOCV/dI$Dt) which consequently improves the VOCV convergence and estimation accuracy of the algorithm. For veriﬁ- cation reasons, HPPC tests and urban dynamometer driving schedule (UDDS) load proﬁle are used. Eqs. (1.1)e(1.2) are employed as a basis for SoAP prediction where battery non- linearities are neglected and only the discharging case is considered. In Ref. [68], the authors present an approach based on a KF ﬁlter for SoAP prediction in an example of lead-acid battery. An ECM (R- RC) considering the nonlinearity of charge transfer processes by means of the Butler-Volmer equation (BVE) is applied and the re- sults are compared with the same model neglecting the mentioned nonlinearity. After analyzing the results, the authors state that considering the aforementioned nonlinearity improves the esti- mation accuracy signiﬁcantly. However, there are some points which may be addressed here: First, the symmetry coefﬁcient is assumed to be equal for both anodic and cathodic reactions (i.e., a ¼ 0.5) in this work, which is actually not applicable to lead-acid batteries and could at best be applied to LIBs [66,69]. Second, for both models the exchange current density is assumed to be con- stant. In fact, the exchange current density decreases over the battery lifetime and is highly temperature-dependent as shown in our previous work [18]. This means that the accuracy of the pro- posed algorithm might decrease over the battery lifetime. Real vehicle data gathered in the ﬁeld are used to verify the algorithm whereas the SoAP estimator is only validated for cases when maximum allowable discharge current is drawn. Furthermore, in Ref. [70], the same authors investigate the Arrhenius equation and consider temperature as model input for the determination of resistance and overvoltage in an example of LIBs using LFP cathode. Based on the KF technique, parameters of the ECM are identiﬁed on-board. In contrast to the previous work, the temperature dependence of the ECM parameters is considered in the model. Obtained results indicate the necessity of considering the nonlin- earity at very low temperatures while a signiﬁcant improvement with regard to the voltage prediction accuracy could be achieved. In Ref. [71], an approach based on R-RC ECM for predicting the battery's SoAP is presented. Battery current and voltage are considered as limiting factors for the applied algorithm. As an advantage, in the employed algorithm the difference between each individual cell VOCV is considered to identify the weakest cell in the A. Farmann, D.U. Sauer / Journal of Power Sources 329 (2016) 123e137 129 battery pack. VOCV is determined based on a nonlinear SoC-OCV correlation characterized in the laboratory. Evaluating each cell's VOCV by its own has on the one hand the advantage that the weakest LIB (LIB with minimum VOCV for discharging case or LIB with maximum VOCV for charging case) in the battery pack can thus be simply identiﬁed, but it requires on the other hand a higher computational effort since in large lithium-ion battery packs often large amounts of LIBs are connected in series and each LIB have to be supervised individually. In this regard, the authors propose us- ing only the information from maximum VOCV in case of charging and minimum VOCV in case of discharging. Unfortunately, no in- formation has been provided with regard to the estimation tech- nique applied for impedance parameters; the authors mention, however, that KF-based algorithms could be applied. In Ref. [78], a novel algorithm for SoAP prediction is proposed where an impedance-based ECM using the Warburg impedance connected in series with a simple R-RC circuit is employed. An adaptive approach based on fractional joint KF is applied for on- board impedance parameters and SoAP estimation. Unfortunately, the RC-element representing the charge transfer processes is neglected and thereafter it is simpliﬁed to a linear resistance. The authors deﬁne SoC, I and V for both charge and discharge cases as limiting factors for the SoAP prediction algorithm. For veriﬁcation reasons, constant current pulses with durations of 10 s and 60 s are inserted to the FUDS load proﬁle and the predicted SoAP at the end of the pulse is analyzed. As discussed beforehand, such algorithms may work accurately and robust under the nominal condition described by the authors but it is deﬁnitely of interest to examine the applied technique under conditions beyond nominal. 3.1.1. (Dual) extended Kalman ﬁlter-based methods In the system theory, EKF is widely used for the state estimation of nonlinear systems where at each time step a linearization pro- cess of the system by means of a linear time-varying (LTV) system is performed. It is assumed that the noise processes are zero mean white Gaussian stochastic processes of covariance matrices which refer to the uncertainty of the state estimation. As a main difference to the KF algorithm, battery nonlinearities (nonlinear state transi- tion function and nonlinear measurement function) are approxi- mated by means of ﬁrst-order Taylor-series expansions at each time step [61,72]. In this context, different approaches using EKF as joint or dual estimator for SoAP predictions are discussed in great detail in Refs. [73,74]. In Ref. [73], a model-based approach using EKF for estimating impedance parameters, voltage across the RC-element and SoAP prediction in an example of a HEV is presented. Minimum charging current or maximum discharging current for (Dt ¼ 1e10 s) is determined after performing some simple mathematical calcula- tions from the employed ECM (R-RC). Based on the derived limiting current values, (dis)charge voltages of the battery pack are calcu- lated for the desired time horizon. The proposed algorithm is veriﬁed under nominal conditions in a Model-in-the-Loop (MIL) environment. Furthermore, in Ref. [74], an EKF-based algorithm for on-board impedance parameters estimation is proposed where pre-deﬁned limits for ECM-parameters depending on battery temperature Fig. 6. An example of an equivalent circuit model employed in battery management systems considering various time constants. Fig. 7. A selection of commonly applied techniques for ECM parameters estimation. A. Farmann, D.U. Sauer / Journal of Power Sources 329 (2016) 123e137130 and SoC are set. A simple R-RC ECM is employed where the correct and meaningful convergence of the impedance parameters is ensured by setting the upper and lower limits of the impedance parameters. Moreover, in Ref. [75] the authors present a novel technique for estimating the impedance parameters of the ECM and instantaneous SoAP prediction. The parameters of the lithium-ion battery pack used in a HEV are extracted by means of EIS mea- surements for an initial state. Based on various ﬁlters, such as high- pass, low-pass or band-pass ﬁlters and/or a combination thereof, the measured battery's voltage response is split up into different appropriate frequency ranges (medium to high frequency range as well as low and steady-state part). When the impedance parame- ters of the ECM for the respective frequency range are identiﬁed, the battery's limiting current and instantaneous power can then be simply determined. The authors propose an EKF-based algorithm for estimating the parameters of the RC-element on-board. How- ever, since the corresponding frequencies are inﬂuenced by many factors such as temperature and actual aging state of the battery, the impedance parameters estimation from each frequency range might be underlined some inaccuracies when the battery is oper- ated under conditions other than those initially obtained. In addi- tion, since commercially available hardware for performing EIS- measurement in the vehicles is still in a primitive development stage, accurate measurements over a wide frequency range can hardly be carried out. In contrast to the above referenced literatures where adaptive joint estimators using EKF for SoAP prediction are proposed, in Refs. [23,44], the authors propose a SoAP estimation technique based on the dual extended Kalman ﬁlter (DEKF). The DEKF method uses two EKFs (i.e., a Kalman state and a weight ﬁlter) that run concurrently at every time step, where one ﬁlter is responsible for state estimation (e.g., SoC or SoAP etc.) and the other one for pa- rameters identiﬁcation (e.g., R0, t, Rct etc.) while both of them concurrently provide each other with derived information and ensure a more stable independent estimation path in this way. In Ref. [44],an R-RC ECM using the DEKF algorithm for on-board parameters estimation is used, where battery current and voltage are considered as limiting constraints for SoAP estimation. Each of the limiting factors (current and voltage) is considered separately and its impact on SoAP is discussed thoroughly. For the applied DEKF algorithm, the ﬂowing current through the charge transfer resistance is taken into the state vector, and the remaining pa- rameters of the ECM (R0, t, Rct, VOCV) with a slower rate of change are stored in the parameter vector. The proposed algorithm is examined by performing veriﬁcation experiments on the LIBs using LFP cathode at different aging states and temperatures. For veriﬁ- cation reasons the FUDS load proﬁle is used as a reference. Furthermore, the maximum time that the current can be applied to the battery and voltage limits is determined based on an ECM employed. Unfortunately, during veriﬁcation tests a narrow range of applied current (\u00043C e þ2C) is examined. According to the au- thors, promising results for SoAP prediction with a relative esti- mation error of less than 5% could be achieved. However, the proposed technique neglects the battery nonlinearities and no SoAP prediction results for a particular time horizon are provided. In fact as discussed in Ref. [59], the impact of the applied current- rate on the voltage estimation accuracy is not negligible; there- fore, higher current rates which actually often occur in a real ﬁeld must be considered. Moreover, the obtained results indicate the decrease of voltage estimation accuracy at very low SoC range, which occurs mainly because of high pronounced diffusion pro- cesses [30]. Furthermore, in Ref. [26] the authors propose a static SoAP prediction (using SoC-Ri relationship) methodology based on the EKF technique (EKF is employed for SoC estimation). An R-RC ECM with a little deviation concerning the internal resistance is imple- mented. The instantaneous available battery power is derived based on Eqs. (1.1)e(1.2). The authors combine the ohmic and charge transfer resistance in one linear resistance connected in series with the RC-element representing diffusion overvoltage. The combination of both resistances may help to overcome the mentioned linearization problem of battery's nonlinear character- istics by EKF algorithms. However, since the impedance parameters change over the battery lifetime, it is essential to ensure their adaption to the actual battery aging state. In Refs. [23,28,76], battery voltage, current and SoC limits are considered as constraints for SoAP prediction in a lithium-ion battery pack. In Ref. [23], the possibility to employ EKF and DEKF methods for impedance parameters and SoC estimation of LFP- based LIBs is discussed comprehensively. Moreover, in Refs. [28,76], maximum discharge and minimum charge currents are determined based on derived battery SoC and resistance values. Two algorithms are proposed for SoAP prediction and their per- formances are compared, where simple ECMs employing a simple ohmic resistance connected in series with VOCV are implemented and the available battery power is determined based on Eqs. (1.1)e(1.2). In order to be able to predict the available battery cur- rent for a speciﬁc time horizon (Dt), the change of VOCV over the prediction time horizon is estimated by means of the Taylor-series expansion. In the second algorithm proposed, the ECM is imple- mented in a state-space form and the limiting battery current considering the voltage and SoC limits is estimated based on the bisection search method. However, in both cases the employed ECMs are very simple and neglect battery nonlinearities and po- larization effects. Moreover, the available battery power is deter- mined separately for individual LIBs in the battery pack; this fact requires high computational power that is actually not given on commercial microcontrollers used in the automotive industry. In comparison to the described EKF techniques, the adaptive extended Kalman ﬁlter (AEKF) improves the estimation accuracy by an adaptive update of the noise covariance. In this regard, several studies have investigated AEKF for SoAP prediction. In Ref. [77],an adaptive joint estimator employing a simple R-RC ECM for SoC and SoAP estimation is presented. LIBs using LFP cathode at various temperatures and aging states are investigated. The Nernst model is used to build and adapt the nonlinear SoC-OCV correlation over the battery lifetime and make the SoC be a part of the developing model, respectively. Battery SoC and SoAP are estimated by means of AEKF where the UDDS load proﬁle is used as a reference for veriﬁcation reasons. Moreover, a simple LS estimator is used to identify the ECM parameters. In addition to the estimated SoC, the battery's design limits, namely voltage and current, are deﬁned as constraints in the implemented SoAP estimator. The available bat- tery power is determined and validated for Dt ¼ 0 and Dt ¼ 30 s. Since current and voltage limits for the respective operating con- dition and the battery's aging state are calculated on-board, safety damaging the LIBs by either over- or underestimating the available power can be prevented. However, for veriﬁcation tests, the applied current is downscaled to ±2 C, which is actually low (especially in case of HEVs) as mentioned above and might inﬂuence the reli- ability analysis of the proposed algorithm. Furthermore, in Ref. [65] the authors present an AEKF-based six- step joint estimator for SoC and SoAP estimation (veriﬁed for Dt ¼ 15 s, 30 s, 60 s) in an example of plug-in hybrid electric vehicle (PHEV). An R-RC ECM is applied, where HPPC tests and UDDS load proﬁles are applied in order to verify the robustness and real-time applicability of the proposed algorithm. However, since the authors use the Nernst equation to build the nonlinear SoC-OCV correlation and the limiting battery current is determined based on the actual battery's SoC, the estimation accuracy of the model might decrease A. Farmann, D.U. Sauer / Journal of Power Sources 329 (2016) 123e137 131 over the battery lifetime or when the operating temperature differs extremely from the one used to parameterize the Nernst equation. In Ref. [34], the authors present a multi-states joint estimator employing the recursive least square technique with optimal forgetting factor (RLSF) for impedance parameters estimation and an AEKF for SoC and SoAP estimation. In addition, battery voltage, current and SoC are considered as limiting factors for the SoAP prediction algorithm. LIBs using LFP cathode at various aging states are used for veriﬁcation reasons and an R-RC ECM is employed, where the ohmic resistance is implemented separately for charge and discharge directions. Thus, in total there are four impedance parameters needed to be identiﬁed on-board. The identiﬁed pa- rameters are transmitted to the prior state estimator in order to update the battery's SoC. Since the SoC-OCV correlation is built by the Nernst equation, the VOCV is then updated over the equation when new SoC values are available. Thereafter, the battery's SoAP is predicted based on the results from the SoC and parameter iden- tiﬁcation estimators. According to the authors, promising results for SoAP prediction with a relative estimation error of less than 1% could be achieved. 3.2. Least-square-based methods As alternative popular technique for on-board impedance pa- rameters and state estimation, the algorithms based on the least square (LS) technique are widely used in BMS applications. The required computational effort for LS-based algorithms is low and the respective algorithms can simply be implemented on the mi- crocontroller. The underlying idea of LS-based algorithms is very simple; it is mainly based on the minimization of the sum of squared prediction errors. The LS-based ﬁlters consider input data, model states and parameters as deterministic signals. Among the main disadvantages of LS-based algorithms are their divergence problem and the fact that they are not suitable for application on very complex ECMs. There are different classiﬁcations of LS-based ﬁlters known for time varying parameters estimation, such as recursive least square (RLS), recursive extended least square (RELS), least square with forgetting factor, weighted least square (WLS), weighted recursive least square (WRLS) etc. [79]. 3.2.1. Recursive least-square-based methods In Ref. [84] the authors show the results of the applied SoAP and voltage estimator by performing veriﬁcation tests on the test bench and in HEV. The obtained results of the predicted voltage indicate an estimation accuracy of approx. 5% where the impedance pa- rameters of the ECM are identiﬁed by means of the simple RLS algorithm, and a predictive control algorithm based on step response, so-called Dynamic Matrix Control (DMC), is employed for the maximum discharge current estimation. The applied DMC al- gorithm belongs to the class of ﬁlters employed in the systems theory which is able to determine a sequence of manipulated var- iables for predicting the upcoming behavior of the model. The main important difference to the previously discussed literature lies in the applied ECM, where n RC-elements are connected in series and the time constant of each RC-element is determined ofﬂine. How- ever, the developed algorithm is only evaluated for the discharging case whereas the charging case (e.g., regenerative braking etc.) is neglected. A novel approach for SoAP prediction considering both voltage and current as limiting factors is presented in Ref. [80]. Within this approach, a so-called moving average (MA) noise covering the remaining battery overvoltages (e.g., diffusion processes etc.) is connected in series with RC-element and ohmic resistance in the ECM. Furthermore, an RELS algorithm is applied for impedance parameters identiﬁcation. The main advantage of the RELS algorithm over the common RLS algorithm is the additional implementation of a feedback process which allows the estimate of unmeasurable noise. The proposed algorithm is validated by UDDS load proﬁle and HPPC tests while the algorithm's accuracy is analyzed for various time horizons (5 s e 120 s). The achieved re- sults indicate a more accurate and reliable SoAP prediction by employing the proposed ECM rather than a simple R-RC model, especially for cases where the SoAP is predicted for a large pre- diction time horizon. As the next step, the presented approach might be investigated in more detail under real conditions and especially over a wide temperature range since it is only validated under nominal condition. In Ref. [4] the authors propose an algorithm for SoAP prediction considering SoC, current and voltage as limiting factors. A RLS- based technique with optimal forgetting factor (RLSF) is applied to estimate battery impedance parameters. The main difference of the proposed technique (RLSF) in comparison to the common RLS ﬁlter is that if the model parameters change continuously but slowly, the RLS technique is rarely able to capture the occurred changes instantaneously. Therefore, an enhanced ﬁlter is required, which gives more weight to recent data than to an older dataset as proposed in Ref. [34]. The on-board applicability of the proposed algorithm is then veriﬁed by means of hardware-in-the-loop (HIL) tests using the FUDS load proﬁle as a reference. A simple R-RC ECM is employed where the VOCV is modeled by Nernst model. Moreover, the change of the VOCV over a prediction time horizon is deter- mined, which leads to higher voltage prediction accuracy. Accord- ing to the authors, promising results could be achieved with the battery voltage estimated within an accuracy range of 1%. In Ref. [27], the authors investigate a method for SoAP predic- tion in an example of a transporter, the so-called Segway. Based on Eqs. (1.1)e(1.2) presented in Section 1, the available battery power is simply determined. The authors propose using LS or RLS-based techniques for estimating the battery resistance and VOCV. Furthermore, based on the estimated values for available battery power, the maximum velocity of the transporter is determined. In this particular case it is assumed that the current is equal to the electric-motor current and the resistance is determined as a sum of the motor winding resistance and battery resistance. In addition to the methods discussed above, in Refs. [32,85], the authors present an adaptive technique for SoAP prediction of the lithium-ion battery pack using the varied parameters approach (presented in Ref. [66]) for impedance parameters estimation. The current dependence of the Rct is considered in the proposed algo- rithm by simplifying the BVE. The authors employ a nonlinear R-RC ECM where the differences between SoCs and resistances of indi- vidual LIBs are considered in an implicit way. Battery voltage, cur- rent and SoC are considered as limiting factors for SoAP prediction. In order to identify the weakest LIB in the battery pack, VOCV and resistance are considered as supporting indices. In this regard, the LIB with the highest VOCV for charging case or lowest VOCV for dis- charging case as well as the LIBs with the highest resistance are considered as the weakest. As an improvement to the used ECM shown in references above, its extended version is presented in Ref. [30] for SoAP prediction. For this reason, a second RC-element capturing diffusion processes is added to the basis ECM. A RLS ﬁlter is used for estimating the parameters of the diffusion branch. The proposed algorithm is veriﬁed under various conditions (various SoC ranges and different temperatures) by using real vehicle data. Unfortunately, no long-term robustness analysis of the proposed algorithm is performed. 3.2.2. Weighted recursive least square-based methods In Refs. [81,82] the authors apply a direct differential (DD) al- gorithm to estimate battery states (SoC, SoAP and SoH) and the A. Farmann, D.U. Sauer / Journal of Power Sources 329 (2016) 123e137132 WRLS algorithm to identify the impedance parameters of an R- RctRdC ECM. Diffusion resistance (Rd) is derived empirically and connected in series with charge transfer resistance (Rct). According to the authors, considering the Rd in the ECM increases the SoAP prediction accuracy for discharge cases and for prediction time horizons in a range of Dt \u0006 10 s signiﬁcantly. However, the Rd is not implemented as an adaptive parameter in the proposed algorithm, and the fact that it changes over the battery lifetime and under different operating conditions [30] may lead to the decrease of the estimation accuracy over the battery lifetime. In Refs. [83,90], the authors present an algorithm based on the WRLS technique for estimating the impedance parameters of an ECM that considers the mass transport effects by incorporating the Warburg impedance. Moreover, the current dependence of the Rct is considered, and the applicability of the Tafel-equation for determining the Rct in case of high current-rates is proven. The applied algorithm is veriﬁed under various conditions (different temperatures and different aging states of the battery) by investi- gating LIBs using NMC and LFP cathode materials. Based on the developed algorithm, battery VOCV and SoC, respectively, are derived from an employed ECM by using the SoC-OCV correlation. Furthermore, the actual battery SoH using the estimated battery impedance and SoAP is determined on-board. However, for SoAP prediction the authors consider only the battery voltage as a limiting factor and determine the maximum current rate that the battery can deliver or accept. 3.3. Other adaptive ﬁlters and observer methods In Ref. [86], the authors propose an SoAP estimation algorithm putting special emphasis on investigating time horizons much larger than in the researches presented above (i.e., Dt \u0006 60 s). Asymmetric ECM parameters (R-RC-RC) for charge and discharge directions are considered in the applied algorithm. According to the authors, variation of the ECM parameters is necessary when SoAP prediction is performed for larger time horizons. The asymmetric parameter values yield higher estimation accuracy for appropriate charge and discharge directions. In this regard, two different SoAP prediction algorithms are investigated. First, a voltage limited- based method extrapolating battery resistances and VOCV (so- called VLERO) is investigated. Second, a method based on a so- called multi-step model predictive iterative (MMPI) technique. Furthermore, battery SoC, voltage and current are considered as limiting factors for SoAP prediction. Applied algorithms are able to calculate the maximum battery current whereas voltage and SoC design limits are used. For veriﬁcation reasons, the proposed al- gorithms are evaluated by means of the UDDS load proﬁle at low temperatures (0 \u0003C and \u000420 \u0003C). According to the obtained results, the MMPI technique shows a higher degree of SoAP prediction accuracy. However, since the proposed algorithms are only evalu- ated under a MIL environment, it is recommended to examine their performance under real conditions as the next step. Moreover, in Ref. [87] the authors propose a model-based approach using the Levenberg-Marquadt methodology for SoAP estimation in an example of a lithium-ion battery pack (ns ¼ 20, np ¼ 4). The proposed technique is then compared with the tech- nique based on the bisection methodology described in Ref. [76]. LIBs using NMC and LFP cathode materials are used to perform veriﬁcation tests. The applied algorithm is evaluated by means of FUDS, dynamic stress test (DST) load proﬁles and HPPC tests. The authors investigate two R-RC ECMs where the ﬁrst ECM neglects the VOCV hysteresis and the second one uses a one-state hysteresis. Battery SoC, voltage and current are considered as limiting factors for SoAP prediction. According to the authors, the bisection tech- nique shows some advantages over the proposed algorithm with regard to its computational efﬁciency. However, the inconsistency of individual LIBs in the lithium-ion battery pack is neglected and it is assumed that the LIBs show a similar behavior. Moreover, battery nonlinearities are neglected. In Ref. [21], a model-based approach for SoAP estimation in an example of a lithium-ion battery pack (ns ¼ 16, np ¼ 1) for HEVs is discussed. In addition to the battery's voltage design limits, SoC and current limits are calculated and considered as further limiting factors for SoAP prediction. An R-RC ECM is employed and based on determined impedance parameters, the SoAP is predicted. How- ever, the proposed SoAP prediction algorithm is veriﬁed under nominal conditions for LIBs in new state by comparing the results from HPPC test and DST load proﬁle. The authors do not give in- formation about the applied technique for on-board impedance parameters estimation. According to the results shown in this pa- per, the discussed theory with regard to the over and under esti- mation of the available battery power by means of the HPPC test in Section 1 is approved. In Ref. [35], contrary to the above-mentioned approaches, the authors apply the particle ﬁlter (PF) technique for estimating the SoAP where battery SoC serves as an input parameter. The main advantage of PF-based techniques in comparison to other Bayesian ﬁlters is the possibility of approximating the probability density functions (PDF) even if non-Gaussian measurement uncertainty is given. A dependence of the polarization resistance on SoC and current (R ¼ f(SoC, I)) is used as a basis for an accurate instanta- neous SoAP prediction. Thereafter, the Gaussian shape is chosen as membership function of the employed fuzzy set. The measured current and the voltage estimated from the employed ECM are used for the implemented PF algorithm. In the presented approach, the battery's SoC is ﬁrstly estimated based on the PF method, and the SoAP is determined by evaluating the resulting PDF function of the estimated SoC performed by means of a simple look-up table rep- resenting the relationship between SoAP and battery SoC. However, the authors use a simpliﬁed “fuzzy” ECM (ECM1 is responsible for charging case, ECM2 is responsible for discharging case) whereas the double-layer capacitance and the temperature's inﬂuence are neglected. In Ref. [22], the impedance parameters of the employed ECM (R- RC) and battery SoAP are estimated based on a genetic algorithm. The presented approach is validated by means of the FUDS load proﬁle for LIBs using the LFP cathode in a new state whereupon a lithium-ion battery pack (ns ¼ 1, np ¼ 9) is used. The difference between both charge and discharge ohmic resistances (Rdch, Rch)is considered in the employed ECM. In the ﬁrst step, the authors apply a SOC-limited method for instantaneous SoAP prediction. After- wards, a voltage-limited method is applied where the change of VOCV over the prediction time horizon (Dt) is considered in order to improve the SoAP prediction accuracy. The obtained results compared with the results of the HPPC-based method discussed in Section 1 indicate a higher estimation accuracy of the proposed algorithm within an accuracy range of 2%. 3.4. Fuzzy logic and machine-learning-based methods In addition to the techniques discussed above, there are some publications dealing with machine learning-based algorithms for SoAP prediction. The underlying idea of such techniques is based on the ability to learn and to adjust the relationship between input and output signals without the need of complex mathematical func- tions by using human knowledge. However, the development of machine learning based methods is still in a primitive stage and the applied techniques need to be further modiﬁed and veriﬁed under real conditions. In Ref. [88], the authors investigate a technique based on the BP A. Farmann, D.U. Sauer / Journal of Power Sources 329 (2016) 123e137 133 neural network training algorithm for SoAP prediction. The BP neural network algorithm is a forward, mono transmission multi- layers network including an input layer (containing 2 nodes), hid- den layer (containing 4 nodes) and output layer (containing 1 node) network. It allows considering the nonlinear battery behavior without the need of high-level hardware. The basic idea of the proposed algorithm is simple: When the output vector does not meet the expected values, then the output error is transformed to input layer and distributed to units of hidden layers, respectively. Thereafter, the estimation error of each layer can be obtained. Based on the obtained estimation error, the weight of each neuron is adjusted until the output vector reaches the correct values. The proposed technique is veriﬁed under nominal conditions by means of ofﬂine simulations and constant discharging power proﬁles. Its applicability on real-time applications needs to be investigated in greater detail in the future. In Ref. [89], the authors present a method using an adaptive neuro-fuzzy-inference system (ANFIS) for on-board SoAP predic- tion whereby the main focus lies on the battery voltage prognosis. The proposed approach combines the strengths of two common techniques, the artiﬁcial neuronal networks (ANN) and fuzzy inference system (FIS), in such a way that the battery parameters are adapted to the actual aging state. In this regard, according to the authors, a meaningful convergence of the parameters can be ensured. However, the authors neglect the battery current as further limiting factor for predicting the SoAP. The obtained Software-in-the-Loop (SIL) test results indicate high algorithm feasibility and estimation accuracy. For a pre-deﬁned time horizon the battery voltage is predicted within a relative estimation accu- racy of less than 1%. The implemented algorithm acts more as an SoF algorithm since the model output delivers an answer as to whether a power pulse can be performed or not. Furthermore, in Ref [91], the authors show results employing the same algorithm as before with the difference that the battery's SoC is also considered as an additional input parameter of the employed model. Battery SoC is determined by means of the robust extended Kalman ﬁlter (REKF). The algorithms mentioned above and the respective literature sources for techniques based on equivalent circuit models are listed and compared in Table 1. 4. Conclusion In this study, the available techniques for predicting the State- of-Available-Power in electric vehicles are reviewed. To this end, scientiﬁc articles, technical literature and available patents dealing with the aforementioned topic are analyzed and each individual method is thoroughly discussed. Special emphasis is put on elab- orating the strengths and weaknesses of the discussed methods. State-of-Available-Power refers to the amount of power that the battery can deliver to or accept from the vehicle powertrain. The available battery power is mainly limited by battery SoC, temper- ature, current and voltage. At the same time, the actual aging state of the battery inﬂuences the battery power capability signiﬁcantly. The techniques that have up to now been applied for predicting the State-of-Available-Power can be classiﬁed into the following two groups: The ﬁrst group is based on so-called adaptive characteristic maps; the second group, which up to now has received most attention, is based on equivalent circuit models. Since the approaches based on equivalent circuit models are most likely not able to reproduce the occurring electrochemical processes in the battery precisely, their achieved estimation accu- racy may not be sufﬁcient for particular applications under speciﬁc operating conditions (e.g., at very low temperatures etc.). There- fore, as an alternative, advanced electrochemical battery models are preferred. Electrochemical battery models use complex math- ematical equations and different approximations depicting pro- cesses in high details which yield higher estimation accuracy. However, high model ﬁdelity is actually achieved at the expense of higher computational and parametrization effort. Unfortunately, up to now techniques based on electrochemical models have received little attention for the State-of-Available-Power prediction. According to the current state of the art, it can be summarized that techniques based on equivalent circuit models are the domi- nating techniques for the prediction of State-of-Available-Power in battery management systems. But with increasing computational power of the micro-controllers implemented in BMS, a reasonable increase in the use of electrochemical model-based approaches is expected. The focus in the future may be put on improving the available techniques with regard to their robustness under varying conditions, such as wide temperature range including low tem- peratures and at different battery aging states. Table 1 Referenced works based on equivalent circuit models for SoAP prediction. Possible references Employed ECM Applied estimation technique Current dependence of the charge transfer resistance is considered? [57] e MSP No [80] R-RC-(C(z)) RELS No [32,85] R-R(I)C VPA Yes [30] R-R(I)C-RC VPA, RLS Yes [28,76] R KF No [40,71] R-RC KF No [44] R-RC DEKF No [83,90] R-R(I)C-ZW WRLS Yes [65,77] R-RC AEKF No [26,73e75] R-RC EKF No [84] R-RC RLS and DMC No [78] R-RC-ZW Fractional Joint KF No [86] R-RC-RC a) VLERO, b) MMPI No [68,70] R-RC KF Yes [34] R-RC RLSF and AEKF No [21] R-RC e No [22] R and R-RC Genetic algorithm No [35] R Particle ﬁlter Yes [89,91] ANFIS, ANFIS þ REKF [88] e BP neural network [4] R-RC RLSF No [81,82] R-RctRdC WRLS No [87] R-RC Levenberg-Marquadt No A. Farmann, D.U. Sauer / Journal of Power Sources 329 (2016) 123e137134 References [1] S. Goriparti, E. Miele, F.D. Angelis, E.D. Fabrizio, R.P. Zaccaria, C. Capiglia, Re- view on recent progress of nanostructured anode materials for Li-ion batte- ries, J. Power Sources 257 (0) (2014) 421e443. [2] B. Scrosati, J. Garche, Tillmetz, Advances in Battery Technologies for Electric Vehicles, ﬁrst ed., Woodhead Publishing, 2015. ISBN: 9781782423980. [3] B. Scrosati, J. Garche, Lithium batteries: status, prospects and future, J. Power Sources 195 (9) (2010) 2419e2430. [4] R. Xiong, H. He, F. Sun, K. Zhao, Online estimation of peak power capability of Li-ion batteries in electric vehicles by a hardware-in-loop approach, Energies 5 (0) (2012) 1455e1469. [5] M. Root, The Tab Battery Book e an In-depth Guide to Construction, Design, and Use, The McGraw-Hill Companies, 2011. ISBN: 978-0-07-173991-7. [6] X. Luo, J. Wang, M. Dooner, J. Clarke, Overview of current development in electrical energy storage technologies and the application potential in power system operation, Appl. Energy 137 (0) (2015) 511e536. [7] L. Saw, Y. Ye, A. Tay, Electro-thermal analysis and integration issues of lithium ion battery for electric vehicles, Appl. Energy 131 (2014) 97e107. [8] S.C. Mueller, P.G. Sandner, I.M. Welpe, Monitoring innovation in electro- chemical energy storage technologies: a patent-based approach, Appl. Energy 137 (0) (2015) 537e544. [9] Y. Zheng, X. Han, L. Lu, J. Li, M. Ouyang, Lithium ion battery pack power fade fault identiﬁcation based on shannon entropy in electric vehicles, J. Power Sources 223 (0) (2013) 136e146. [10] W. Waag, S. K€abitz, D.U. Sauer, Experimental investigation of the lithium-ion battery impedance characteristic at various conditions and aging states and its inﬂuence on the application, Appl. Energy 102 (0) (2013) 885e897. [11] L.H. Saw, Y. Ye, A.A. Tay, Integration issues of lithium-ion battery into electric vehicles battery pack, J. Clean. Prod. 113 (0) (2015) 1032e1045. [12] R.R. Richardson, P.T. Ireland, D.A. Howey, Battery internal temperature esti- mation by combined impedance and surface temperature measurement, J. Power Sources 265 (0) (2014) 254e261. [13] J. Jiang, C. Zhang, Fundamentals and Applications of Lithium-ion Batteries in Electric Drive Vehicles, John Wiley & Sons, Inc, 2015. ISBN: 9781118414781. [14] Y. Zou, X. Hu, H. Ma, S.E. Li, Combined state of charge and state of health estimation over lithium-ion battery cell cycle lifespan for electric vehicles, J. Power Sources 273 (0) (2015) 793e803. [15] S.F. Schuster, M.J. Brand, P. Berg, M. Gleissenberger, A. Jossen, Lithium-ion cell-to-cell variation during battery electric vehicle operation, J. Power Sources 297 (2015) 242e251. [16] S. Bhattacharya, P. Bauer, Requirements for charging of an electric vehicle system based on state of power (SoP) and state of energy (SoE), in: Power Electronics and Motion Control Conference (IPEMC), 2012 7th International, vol. 1, 2012, pp. 434e438. [17] Battery Test Manual for Electric Vehicles, U.S. Department of Energy Vehicle Technologies Program, Revision 3, 2015. [18] A. Farmann, W. Waag, D.U. Sauer, Application-speciﬁc electrical character- ization of high power batteries with lithium titanate anodes for electric ve- hicles, Energy 112C (0) (2016) 294e306. [19] B. Balagopal, M.Y. Chow, The state of the art approaches to estimate the state of health (SOH) and state of function (SOF) of lithium ion batteries, in: In- dustrial Informatics (INDIN), 2015 IEEE 13th International Conference on, 2015, pp. 1302e1307. [20] M.A. Monema, K. Trad, N. Omar, O. Hegazy, B. Mantels, G. Mulder, P.V. den Bossche, J.V. Mierlo, Lithium-ion batteries: evaluation study of different charging methodologies based on aging process, Appl. Energy 152 (0) (2015) 143e155. [21] Z. Cai-ping, Z. Cheng-ning, S. Sharkh, Estimation of real-time peak power capability of a traction battery pack used in an HeV, in: Power and Energy Engineering Conference (APPEEC), 2010 Asia-Paciﬁc, 2010, pp. 1e6. [22] F. Sun, R. Xiong, H. He, W. Li, J.E.E. Aussems, Model-based dynamic multi- parameter method for peak power estimation of lithium-ion batteries, Appl. Energy 96 (0) (2012) 378e386 (smart Grids). [23] G.L. Plett, Extended Kalman ﬁltering for battery management systems of LiPB- based HEV battery packs: Part 3. State and parameter estimation, J. Power Sources 134 (2) (2004) 277e292. [24] J. Song, R. Anderson, D. Oliver, and S. Thompson, “System and method for managing a power source in a vehicle,” Apr. 15 2014, US Patent 8,698,348. [25] S. Saxena, C.L. Floch, J. MacDonald, S. Moura, Quantifying EV battery end-of- life through analysis of travel needs with vehicle powertrain models, J. Power Sources 282 (0) (2015) 265e276. [26] J.H. Kim, S.J. Lee, J.M. Lee, B.H. Cho, A new direct current internal resistance and state of charge relationship for the li-ion battery pulse power estimation, in: Power Electronics, ICPE ’07. 7th Internatonal Conference on, 2007. [27] D. Robinson, “Power source estimation methods and apparatus,” Aug. 26 Nomenclatures AEKF Adaptive extended Kalman ﬁlter ANFIS Adaptive neuro-fuzzy-inference system BEV Battery electric vehicle BMS Battery management system BoL Begin of Life BSE Battery state estimation BVE Butler-Volmer equation CAN Controller area network CC-CV Constant current-constant voltage CDKF Central difference Kalman ﬁlter DAE Differential algebraic equation DEKF Dual extended Kalman ﬁlter DD Direct differential DMC Dynamic Matrix Control DVA Differential voltage analysis ECM Equivalent circuit model EES Energy storage system EoL End of life EKF Extended Kalman ﬁlter EMF Electro motive force EV Electric vehicle FUDRLS Fast upper-diagonal recursive least square FIS Fuzzy inference system HEV Hybrid electric vehicle HIL Hardware-in-the-Loop HV High voltage isoSPI Isolated communications interface KF Kalman ﬁlter LIB Lithium-ion battery LFP Positive electrode active materials with a common formula LiFePO4 LS Least square LTO Negative electrode active materials with a common formula Li4Ti5O12 LV Low voltage MA Moving Average MMPI multi-step model predictive iterative; MIL Model-in-the-Loop NEDC New European Driving Cycle NMC Positive electrode active materials with a common formula of Lix(NixMnyCoz)O2 OCV Open circuit voltage PDE Partial differential equation PDF Probability density function PHEV Plug-in hybrid electric vehicle REKF Robust extended Kalman ﬁlter RLS Recursive least square RELS Recursive extended least square RLSF Recursive least square with optimal forgetting factor SoA safe operating area SPM Single particle model SoH State-of-Health SoC State-of-Charge SoF State-of-Function SoAP State-of-Available Power SPKF Sigma point Kalman ﬁlter UDDS Urban dynamometer driving schedule UKF Unscented Kalman ﬁlter WLS Weighted least squares WRLS Weighted recursive least squares A. Farmann, D.U. Sauer / Journal of Power Sources 329 (2016) 123e137 135 2010, WO Patent App. PCT/US2010/023,827. [28] G. Plett, “Method for calculating power capability of battery packs using advanced cell model predictive techniques,” U.S. Patent 7,321,220 B2, Jan. 22, 2008. [29] A. Farmann, W. Waag, A. Marongiu, D.U. Sauer, Critical review of on-board capacity estimation techniques for lithium-ion batteries in electric and hybrid electric vehicles, J. Power Sources 281 (0) (2015) 114e130. [30] W. Waag, Adaptive Algorithms for Monitoring of Lithium-ion Batteries in Electrical Vehicles, Ph.D. dissertation, ISEA-RWTH Aachen University, 2014. ISBN: 978-3-8440-2976-5. [31] W. Waag, C. Fleischer, D.U. Sauer, Critical review of the methods for moni- toring of lithium-ion batteries in electric and hybrid vehicles, J. Power Sources 258 (0) (2014) 321e339. [32] W. Waag, C. Fleischer, D.U. Sauer, Adaptive on-line prediction of the available power of lithium-ion batteries, J. Power Sources 242 (0) (2013) 548e559. [33] O. Bohlen and M. Roscher, “Method for determining and/or predicting the maximum power capacity of a battery,” May 6 2014, US Patent 8,718,988. [34] R. Xiong, F. Sun, H. He, T.D. Nguyen, A data-driven adaptive state of charge and power capability joint estimator of lithium-ion polymer battery used in electric vehicles, Energy 63 (0) (2013) 295e308. [35] C. Burgos-Mellado, M.E. Orchard, M. Kazerani, R. C\u0002ardenas, D. S\u0002aez, Particle- ﬁltering-based estimation of maximum available power state in lithium-ion batteries, J. Appl. Energy 161 (0) (2016) 349e363. [36] M. Berecibar, M. Garmendia, I. Gandiaga, J. Crego, I. Villarreal, State of health estimation algorithm of LiFePO4 battery packs based on differential voltage curves for battery management system application, Energy 103 (2016) 784e796. [37] J. Vetter, P. Novak, M. Wagner, C. Veit, K.-C. M€oller, J. Besenhard, M. Winter, M. Wohlfahrt-Mehrens, C. Vogler, A. Hammouche, Ageing mechanisms in lithium-ion batteries, J. Power Sources 147 (0) (2005) 269e281. [38] S. Nejad, D.T. Gladwin, D.A. Stone, Sensitivity of lumped parameter battery models to constituent parallel-RC element parameterisation error, in: IECON 2014-40th Annual Conference of the IEEE Industrial Electronics Society, Oct 2014, pp. 5660e5665. [39] S. Nejad, D. Gladwin, D. Stone, A systematic review of lumped-parameter equivalent circuit models for real-time estimation of lithium-ion battery states, J. Power Sources 316 (2016) 183e196. [40] W. Larry, J. Phillip, J. Kollmeyer, T.M. Jahns, R.D. Lorenz, Implementation of online battery state-of-power and state-of-function estimation in electric vehicle applications, Energy Convers. Congr. Expo. (ECCE) (2012) 1819e1826. [41] E. Meissner, G. Richter, Battery monitoring and electrical energy manage- ment: precondition for future vehicle electric power systems, J. Power Sources 116 (12) (2003) 79e98. [42] G. Richter, “Method and device for determining the state of function of an energy storage battery,” U.S. Patent US 6,885,951 B2, 2005. [43] S. Rezvanizaniani, D. Liu, Y. Chen, J. Lee, Review and recent advances in battery health monitoring and prognostics technologies for electric vehicle (EV) safety and mobility, J. Power Sources 256 (0) (2014) 110e124. [44] L. Pei, C. Zhu, T. Wang, R. Lu, C. Chan, Online peak power prediction based on a parameter and state estimator for lithium-ion batteries in electric vehicles, Energy 66 (0) (2014) 766e778. [45] A. Boehm and J. Weber, “Adaptives Verfahren zur bestimmung der maximal abgebaren oder aufnehmbaren leistung einer batterie,” DE Patent WO 2011/ 095368 A1, Aug. 11, 2011, WO Patent App. PCT/EP2011/050,024. [46] Battery Test Manual For Low-Energy Energy Storage System for Power-Assist Hybrid Electric Vehicles, U.S. Department of Energy Vehicle Technologies Program, April 2013. [47] D. Kim and D. JUNG, “Method of estimating maximum output of battery for hybrid electric vehicle,” Apr. 14 2009, US Patent 7,518,375. [48] O. Bohlen, Impedance-based Battery Monitoring, Ph.D. dissertation, RWTH Aachen University, 2008. ISBN: 978-3-8322-7606-5. [49] O. Bohlen, J.B. Gerschler, D.U. Sauer, Robust algorithms for a reliable battery diagnosis managing batteries in hybrid electric vehicles, EVS 22 (2006). [50] C. Vacher, “Method for calculating the parameters of the power battery of an electric motor vehicle,” Sep. 7 2004, US Patent 6,788,069. [51] J.E.B. Randles, Kinetics of rapid electrode reactions, Discuss. Faraday Soc. 1 (1947) 11e19. [52] S. Buller, Impedance-based Simulation Models for Energy Storage Devices in Advanced Automotive Power Systems, Ph.D. dissertation, Institute for Power Electronics and Electrical Drives, RWTH Aachen University, 2003. ISBN: 978- 3-8322-1225-4. [53] D. Linzen, Impedance-based Loss Calculation and Thermal Modeling of Elec- trochemical Energy Storage Devices for Design Considerations of Automotive Power Systems, Ph.D. dissertation, ISEA RWTH-Aachen, 2006. ISBN: 978-3- 8322-5706-4. [54] M. Ceraolo, New dynamical models of lead-acid batteries, Power Syst. IEEE Trans. 15 (4) (2000) 1184e1190. [55] F.M. Gonzalez-Longatt, Circuit Based Battery Models: a Review, IEEE Pro- ceedings, 2006. [56] H. Zhang, M.-Y. Chow, Comprehensive dynamic battery modeling for PHEV applications, in: Power and Energy Society General Meeting, IEEE, 2010, pp. 1e6. [57] X. Hu, S. Li, H. Peng, A comparative study of equivalent circuit models for li- ion batteries, J. Power Sources 198 (0) (2012) 359e367. [58] J.P. schmidt, Verfahren zur Charakterisierung und Modellierung von Lithium- Ionen Zellen, Ph.D. dissertation, KIT, 2013. ISBN: 978-3-7315-0115-2. [59] A. Farmann, W. Waag, D.U. Sauer, Adaptive approach for on-board impedance parameters and voltage estimation of lithium-ion batteries in electric vehicles, J. Power Sources 299 (2015) 176e188. [60] T. Kim, Y. Wang, H. Fang, Z. Sahinoglu, T. Wada, S. Hara, W. Qiao, Model-based condition monitoring for lithium-ion batteries, J. Power Sources 295 (2015) 16e27. [61] G. Plett, Dual and joint EKF for simultaneous SOC and SOH estimation, EVS 21 (2005). [62] B. Fridholm, T. Wik, M. Nilsson, Robust recursive impedance estimation for automotive lithium-ion batteries, J. Power Sources 304 (2016) 33e41. [63] M.S. Grewal, A.P. Andrews, Kalman Filtering: Theory and Practice Using MATLAB, John Wiley & Sons, Inc., 2001. ISBN: 0-471-39254-5. [64] R.E. Kalman, A new approach to linear ﬁltering and prediction problems, J. Fluids Eng. 82 (1) (1960) 35e45. [65] R. Xiong, H. He, F. Sun, X. Liu, Z. Liu, Model-based state of charge and peak power capability joint estimation of lithium-ion battery in plug-in hybrid electric vehicles, J. Power Sources 229 (0) (2013) 159e169. [66] W. Waag, C. Fleischer, D.U. Sauer, On-line estimation of lithium-ion battery impedance parameters using a novel varied-parameters approach, J. Power Sources 237 (0) (2013) 260e269. [67] R. Xiong, X. Gong, C.C. Mi, F. Sun, A robust state-of-charge estimator for multiple types of lithium-ion batteries using adaptive extended Kalman ﬁlter, J. Power Sources 243 (0) (2013) 805e816. [68] L. Juang, P. Kollmeyer, T. Jahns, R. Lorenz, Improved nonlinear model for electrode Voltage-current relationship for more consistent online battery system identiﬁcation, Ind. Appl. IEEE Trans. (3) (2013) 1480e1488. [69] J. Kowal, Spatially-resolved Impedance of Nonlinear Inhomogeneous Devices e Using the Example of Lead-acid Batteries, Ph.D. dissertation, ISEA-RWTH Aachen, 2010, 978-3-8322-9483-0. [70] L. Juang, P. Kollmeyer, T. Jahns, R. Lorenz, Improved modeling of lithium- based batteries using temperature-dependent resistance and overpotential, in: Transportation Electriﬁcation Conference and Expo (ITEC), 2014, IEEE, June 2014, pp. 1e8. [71] J. Song, R. Anderson, Y. Li, Y. Zhao, and X. Yang, “Method for determining a power capability for a battery,” Jul. 12 2012, US Patent App. 12/987,190. [72] G.L. Plett, Extended Kalman ﬁltering for battery management systems of LiPB- based HEV battery packs: part 1. Background, J. Power Sources 134 (2) (2004) 252e261. [73] R. Anderson, Y. Zhao, X. Wang, X.G. Yang, Y. Li, Real time battery power capability estimation, in: American Control Conference (ACC), 2012, June 2012, pp. 592e597. [74] Y. Li and X. Wang, “Parameter and state limiting in model based battery control,” Mar. 5 2015, US Patent App. 14/015,241. [75] T. Lee, “Frequency based battery model parameter estimation,” Sep. 15 2015, US Patent 9,132,745. [76] G. Plett, High-performance battery-pack power estimation using a dynamic cell model, Veh. Technol. IEEE Trans. 53 (5) (2004) 1586e1593. [77] F. Sun, R. Xiong, H. He, Estimation of state-of-charge and state-of-power capability of lithium-ion battery considering varying health conditions, J. Power Sources 259 (0) (2014) 166e176. [78] X. Li, J. Sun, Z. Hu, R. Lu, C. Zhu, G. Wu, A new method of state of peak power capability prediction for Li-Ion battery, VPPC (2015) 1e5. [79] D. Schroeder, Intelligente Verfahren; Identiﬁkation und Regelung nichtli- nearer Systeme, Springer, 2010. ISBN: 978-3-642-11397-0. [80] T. Feng, L. Yang, X. Zhao, H. Zhang, J. Qiang, “Online identiﬁcation of lithium- ion battery parameters based on an improved equivalent-circuit model and its implementation on battery state-of-power prediction, J. Power Sources 281 (0) (2015) 192e203. [81] S. Wang, M. Verbrugge, J.S. Wang, P. Liu, Power prediction from a battery state estimator that incorporates diffusion resistance, J. Power Sources 214 (0) (2012) 399e406. [82] S. Wang, M. Verbrugge, J.S. Wang, P. Liu, Multi-parameter battery state esti- mator based on the adaptive and direct solution of the governing differential equations, J. Power Sources 196 (20) (2011) 8735e8741. [83] C. Fleischer, W. Waag, H.-M. Heyn, D.U. Sauer, On-line adaptive battery impedance parameter and state estimation considering physical principles in reduced order equivalent circuit battery models part 1. Requirements, critical review of methods and modeling, J. Power Sources (0) (2014) 276e291. [84] L. Wang, Y. Cheng, J. Zou, Battery available power prediction of hybrid electric vehicle based on improved dynamic matrix control algorithms, J. Power Sources 261 (0) (2014) 337e347. [85] W. Waag, C. Fleischer, and D. Sauer, “Method for determining model pa- rameters of electrochemical energy storage of e.g. electric vehicle, involves deﬁning parameter record variant as new reference dataset to describe bat- tery model and to determine maximum power of storage,” Jul. 17 2014, DE Patent App. DE201,310,000,572. [86] P. Malysz, J. Ye, R. Gu, H. Yang, A. Emadi, Battery state-of-power peak current calculation and veriﬁcation using an asymmetric parameter equivalent circuit model, Veh. Technol. IEEE Trans. PP (99) (2015), 1e1. [87] X. Hu, R. Xiong, B. Egardt, Model-based dynamic power assessment of lithium-ion batteries considering different operating conditions, Ind. Inf. IEEE Trans. 10 (3) (Aug 2014) 1948e1959. [88] W. Haiying, H. Zhonghua, H. Yu, L. Gechen, Power state prediction of battery based on BP neural network, in: 7th International Forum on, 2012, Strategic A. Farmann, D.U. Sauer / Journal of Power Sources 329 (2016) 123e137136 Technology (IFOST), 2012. [89] C. Fleischer, W. Waag, Z. Bai, D.U. Sauer, On-line self-learning time forward voltage prognosis for lithium-ion batteries using adaptive neuro-fuzzy infer- ence system, J. Power Sources 243 (0) (2013) 728e749. [90] C. Fleischer, W. Waag, H.-M. Heyn, D.U. Sauer, On-line adaptive battery impedance parameter and state estimation considering physical principles in reduced order equivalent circuit battery models part 2. Parameter and state estimation, J. Power Sources (0) (2014) 457e482. [91] C. Fleischer, W. Waag, D.U. Sauer, Adaptive on-line State-of-Available-Power prediction of lithium-ion batteries, J. Power Electron. 13 (4) (2013). A. Farmann, D.U. Sauer / Journal of Power Sources 329 (2016) 123e137 137","libVersion":"0.3.2","langs":""}