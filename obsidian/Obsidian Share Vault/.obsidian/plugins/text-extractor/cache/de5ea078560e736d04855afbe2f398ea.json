{"path":"lit/lit_notes_OLD_PARTIAL/Kavrelishvili23priceFrcstCAISOthesis.pdf","text":"UCLA UCLA Electronic Theses and Dissertations Title Forecasting of California Market Electricity Prices Permalink https://escholarship.org/uc/item/7mv166d6 Author Kavrelishvili, Gurami Publication Date 2023 Supplemental Material https://escholarship.org/uc/item/7mv166d6#supplemental Peer reviewed|Thesis/dissertation eScholarship.org Powered by the California Digital Library University of California UNIVERSITY OF CALIFORNIA Los Angeles Forecasting of California Market Electricity Prices A thesis submitted in partial satisfaction of the requirements for the degree Master of Applied Statistics & Data Science by Gurami Kavrelishvili 2023 ii ABSTRACT OF THE THESIS Forecasting of California Market Electricity Prices by Gurami Kavrelishvili Master of Applied Statistics & Data Science University of California, Los Angeles, 2023 Professor Frederic R. Paik Schoenberg, Chair The importance of electricity in modern society has become increasingly crucial for everyday life. Along with its importance comes the Monetary aspect of buying and selling power in the 21st century. This thesis focuses on predicting Market Electricity Prices in SCE (Southern California Edison) Territory to help Electric Service Providers (ESPs) maximize profits by analyzing upcoming Market prices to make better business decisions. To forecast Market Electricity prices, this thesis utilizes ARIMA modeling, Time series Regression Modeling, Random Forest Modeling, Exponential Smoothing Techniques and Extreme Gradient Boosting. iii The various models are trained on over two years of data and forecasted for Long-Term, Short- Term and Day-Ahead Market electricity prices to help ESPs across different time scales. To assess the model performance, Root Mean Square Error (RMSE) is utilized across different models. The overall goal of this thesis is to find the best performing model. iv The thesis of Gurami Kavrelishvili is approved. Oscar Hernan Madrid Padilla Nicolas Christou Frederic R. Paik Schoenberg, Committee Chair University of California, Los Angeles 2023 v Contents 1 Introduction ............................................................................................................................. 1 2 Recent Research ...................................................................................................................... 5 3 Hypothesis ............................................................................................................................... 8 4 Data .......................................................................................................................................... 9 5 Time series analysis of CAISO Market Prices ...................................................................... 10 6 Time series Decomposition, seasonality, trend and differencing .......................................... 13 7 Time series analysis of Fuel Prices and Weather Data .......................................................... 16 8 Arima Modeling .................................................................................................................... 17 8.1 Identifying optimal p, d, q .............................................................................................. 18 8.2 Model diagnostics and Fit .............................................................................................. 19 8.3 Forecasting using ARIMA models ................................................................................. 21 9 Linear Regression Models ..................................................................................................... 23 10 Random Forest Model....................................................................................................... 25 11 Extreme Gradient Boosting (XGBOOST) ......................................................................... 26 12 Exponential smoothing ...................................................................................................... 28 13 Conclusions ........................................................................................................................ 29 13.1 Best Models: Long Term, Short Term and Day-Ahead ................................................. 32 13.2 Takeaways from our Findings ........................................................................................ 33 13.3 Future Research and Suggestions ................................................................................... 35 vi A References ............................................................................................................................. 36 vii List of Figures Figure 1: Fixed Rate vs Index Rate (CAISO MARKET PRICES) ................................................ 4 Figure 2: CAISO Market Prices .................................................................................................... 11 Figure 3: 2020-2021 CAISO Market Prices ................................................................................. 12 Figure 4: 2021-2022 CAISO Market Prices ................................................................................. 12 Figure 5: Decomposition of additive time series .......................................................................... 13 Figure 6: Boxplot of Prices over Year-Month .............................................................................. 14 Figure 7: Box- Ljung, KPSS and Dickey-fuller tests ................................................................... 16 Figure 8: Fuel Prices Time Series and Decomposition ................................................................. 16 Figure 9: AVERAGE TEMPERATURES.................................................................................... 17 Figure 10: Configuration results for P and Q while fixing d =0 ................................................... 19 Figure 11: ACF ARIMA (5,0,3) residuals .................................................................................... 20 Figure 12: Ljung-Box results for ARIMA model (5,0,3) ............................................................. 21 Figure 13: Predicted values of ARIMA model ............................................................................. 22 Figure 14: Linear Model Summary results ................................................................................... 24 Figure 15: Linear Model Forecast................................................................................................. 25 Figure 16: Random Forest Model Results .................................................................................... 26 Figure 17: XGBoost Model Results .............................................................................................. 27 Figure 18: Smoothing Technique Results ..................................................................................... 29 Figure 19: All Long-Term Model Forecasts ................................................................................. 34 List of Tables Table 1: All Model Results for Various Timescales ..................................................................... 33 1 1 Introduction The importance of electricity in modern society cannot be overstated and has been essentially playing a critical role in many basic aspects of our daily lives, providing necessities of life. One cannot even imagine in the modern day what it would be like to be without electricity for extended periods of time. Electricity is also essential for economic development. It powers businesses, factories, hospitals, schools, emergency services and other industries, enabling them to produce goods and services efficiently. With the extreme importance of reliable Electricity comes the monetary side. In 2022, Southern California Edison (SCE), one of the largest utilities in California, totaled its revenue at 12.6 billion dollars. However, Utilities are not the only ones that sell electricity. In California, customers can choose to buy electricity from ESP’s (Electric Service Providers) who sell electricity produced by their clean power sources, power plants, bought electricity, or otherwise attained electric energy. Just as stock prices are always changing throughout the stock Market (NYSE.), energy prices throughout California are also changing hourly. Every ESP and Utility in California follows the California ISO (Independent System Operator) Market Prices which measure the prices of wholesale energy for each hour of the day and these prices affect how much electric energy is bought and sold for. Predicting how much energy to buy for a certain period is crucial for Utilities and ESPs in many aspects of these businesses, especially in forecasting teams and accounting since forecasting the amount of energy needed to suffice their customers electric energy usage is extremely crucial in profit. The market price of the CAISO market affects the profitability of these ESP's and Utilities. ESPs are much like regular businesses, they provide Energy to Commercial, Industrial, agricultural and residential customers across California. CAISO Market plays into PG&E 2 (Pacific Gas & Electric), SCE (Southern California Edison) and SDGE (San Diego Gas and Electric) territories. PG&E being Northern California’s biggest Utility company, San Diego Gas and Electric and SCE/Edison being the biggest Players in the Central and southern California Territories. This thesis focuses on forecasting CAISO Market prices in the SCE territories. Businesses or Residential customers can choose to purchase directly from large utilities (SCE, PG&E or SDGE) or from ESP’s, this gives them options for pricing and renewable/green choices of electricity they consume. Unlike the Stock market where there are many different stocks with their respective stock prices, the CAISO market has basically one global stock which is the price of energy at a given hour. The Market price of energy is constantly changing, and it varies even within SCE territory in different Areas and times. For example, since more people are using energy between 5pm to 8pm in the SCE territory, the Market price of energy is much higher than it would be between 1pm to 4pm due to the \"on-peak\" status of the hour. It typically peaks during the late afternoon and early evening hours when residential and commercial activities are at their highest. For similar reasons, in the summer and winter the prices of energy tend to be on the higher sides since the overall electricity usage increases due to AC usage for heating/cooling homes and businesses. In Summary, Weather conditions influence electricity demand since hot weather increases the need for air conditioning, while cold weather raises heating demand, impacting the overall load on the grid. External factors do factor into the market price of energy such as gas prices, temperature changes, large power outages, global events and more. Demand is driven by residential, commercial, and industrial consumers requiring electricity for lighting, heating, cooling, manufacturing, and other purposes. On the Supply side, Electricity supply comes from various sources such as natural gas, coal, nuclear, renewable energy (solar, wind, hydroelectric), and 3 imported power from neighboring regions. The total capacity of electricity generation available in the market affects the supply. This capacity is determined by the operational status of power plants and the availability of renewable resources like sunlight and wind. The availability of resources can be variable, especially for renewable sources like solar and wind. This can lead to fluctuations in the supply of electricity. This is where CAISO market prices come into play, CAISO operates a spot market where electricity is bought and sold in real-time. The market clears when the supply of electricity matches the demand. The price of electricity can fluctuate based on supply and demand imbalances. During periods of high demand or low supply, prices can increase. Conversely, during periods of low demand or excess supply, prices may decrease. The goal of this thesis research is to predict the CAISO Market prices in the SCE territory using time series analysis, Multivariate and Univariate ARIMA modeling, linear modeling, Random Forest Modeling, XGBOOST, smoothing techniques and more. Prediction of accurate CAISO prices of energy is crucial in many aspects of maximizing profit for ESPs. Contract management with customers, planning to buy or sell energy based on Market prices and planning for long term, predicting Market prices accurately helps save money and maximize profit for ESPs. ESPS and customers agree on rates based on current market prices and knowing the direction of the market majorly help ESP's sign better contracts. Customers usually choose to sign either a Fixed Rate or Variable Rate for a designated period. A fixed rate is self-explanatory and is basically a fixed amount such as 10 cents per Kilo-watt hour for an agreed period, plus some passthrough charges such as RPS (renewable portfolio standard), Scheduling Fee, RA (Resource Adequacy) fee and more. Some contracts with customers may span multiple quarters and years. Signing a customer for a price below the Market price may lead to the ESP basically losing money because they would be selling energy lower than the market price, and 4 overcharging the customer may cause the ESP to lose customers so it’s crucial to predict accurately. Figure 1 below shows the difference between fixed Rate vs Variable/Index Rate that uses CAISO Market Prices. Figure 1: Fixed Rate vs Index Rate (CAISO MARKET PRICES) ESPs need to manage their Rates with customers and costs effectively to provide competitive pricing to their customers. Accurate price predictions help them optimize their future strategies, ensuring they buy electricity from the market at the most cost-effective times, when prices are good. The electricity market is at times volatile, with prices subject to sudden fluctuations due to factors like supply shortages, extreme weather, world events like the ones we saw in Ukraine, and unexpected outages. Accurate price predictions and forecasts for all the unexpected fluctuations allow ESPs to anticipate and hedge against potential price spikes, reducing financial risk. Another aspect of the need to predict accurately is for regulatory purposes. Along with 5 competing ESPs, Energy markets are often regulated, and ESPs need to meet certain standards or obligations, or otherwise pay hefty penalties. From all the reasons give in this introduction on why it is so crucial to predict Market Electricity prices, we will look for the best strategies in this thesis. The Response variable being used for research in this thesis is hourly CAISO prices spanning from 2021 Jan 1st all the way to Mid-2022, in total of about a year and a half of CAISO market price data. Along with the time series analysis of CAISO prices, Average hourly prices of Gas in SCE territory and Average hourly weather data in SCE territory is used to help predict the CAISO Market prices for short term and long term. SCE territory consists of 50,000 Square miles spanning from Mono County to Orange County. 2 Recent Research Previously, Random Forest models, time series forecasting techniques, regression models and neural networks have been used to predict CAISO Market electricity prices. Throughout all the previous research on how to predict Electricity Market prices, The continuing theme and dilemma was that forecasting electricity prices are very difficult and an open problem in electricity markets to this day due to the variability and non-stationarity of the electricity markets in the world. In 2016, Ashkan Sadeghi-Mobarakeh, Mahdi Kohansal, Evangelos E. Papalexakis, and Hamed Mohsenian-Rad used a random forest model to predict the Day-Ahead CAISO market prices in 2016 for the PG&E Territory in Northern California. They utilized historical hourly market prices spanning from 2014-2016, calendar data, and ancillary service requirements as some of the variables in predicting future market prices. It turns out that Random Forest Model results 6 were very “promising” and we plan to try Random Forest modeling in our thesis as well to compare to other models. In 2011, F.M. Alvarez, A. Troncoso, J. C. Riquelme, and J. S. A. Ruiz used time series forecasting to predict CAISO prices while utilizing a version of an extrapolation method. They used quite a unique “new approach” where they First utilized a clustering technique with the aim of grouping and labeling samples from the data set, which then get averaged for matched sequences. Their results were also very good, and an improvement over previous research papers. In 2006, H. Mori and A. Awata utilized if-then rules on regression tree and normalized radial basis function networks of ANN to forecast market electricity prices. Their new proposed method utilized regression tree data mining techniques to extract if-then rules from database. In 2016, Panapakidis, Ioannis P and Dagoumas, Athanasios S utilized an Artificial Neural Network (ANN) based models to predict Day-ahead Electricity prices. Utilizing the training data, they used clustered homogenous groups for each cluster and employed a dedicated forecaster. They discovered that electricity trends were largely affected by the market clearing price patterns in the respective territory. In 2012, B. Neupane, K. S. Perera, Z. Aung, and W. L. Woon also used an ANN – an Artificial neural network-based forecasting method for electricity market prices in the Day-Ahead Market. The input features they selected were close to the variables we have chosen in our research paper as well. They utilized electricity price data, weather data and calendar data for their research. A wrapper method for feature selection was used in which the ANN model was continuously 7 trained and updated in order to select the best feature set. Their results were compared to another study that used the same variables and they achieved much superior results. In 2015, Gonzalez, Camino, Mira-McWilliams, Jose and Juarez, Isabel used regression tree based models for the Spanish-Iberian Market to forecast electricity market prices. They utilized regression tree-based models: classification and regression trees as well as bagging and random forest models to predict Day-Ahead and one hour electricity price forecasts in the Spanish- Iberian market. In their models, they used 11 years of data spanning from 2000-2011 and utilized regressors such as lagged prices, hour, day, month and year. The results showed competitive results to other existing methods at the time. Lastly, in 2015, Barta Gergo, Nagy Gyula, Borbely Gabor, Kazi Sandor and Henk Tamas used Gradient boosting when compared with ARMA models and found that Gradient boosting was the best technique. This research article uses similar models used in our thesis as well. They wanted to compare ARIMA modeling with Gradient boosting to predict electricity market prices and they tested these models on global energy forecasting data with a years worth of data points. Overall, they found that Gradient boosting performs far better and can deal with seasonality and auto correlation while achieving lower rate of normalized mean absolute error. From the all the previous research, Neural Networks and Regression trees have been the main tools used to predict electricity market prices but a lot less research using ARMA models, Extreme Gradient Boost models and classical models in prediction of electricity market prices. Throughout this paper, we use various models to predict electricity prices and identify the best models to use when predicting CAISO prices in SCE territories. 8 3 Hypothesis With the objective of predicting CAISO market prices using various models, we chose to look at Average weather data and Average gas prices in the SCE territory. We hypothesize that there is a positive relationship between electricity market prices and gas prices. This means that as gas prices increase, electricity market prices will also increase, and as gas prices decrease, electricity market prices will also decrease. Gas-fired power plants are a common source of electricity generation. When gas prices increase, the cost of producing electricity from these power plants also increases, leading to higher electricity market prices. In some cases, power plants can switch between using gas and other fuels, such as coal or oil. When gas prices are high, power plants may switch to these other fuels, which can be more expensive to use, leading to higher electricity market prices. Gas prices also impact the cost of transporting electricity. Many power plants are located far from the areas where the electricity is consumed, so the cost of transporting the electricity over long distances can be significant. When gas prices increase, the cost of transporting electricity also increases, leading to higher electricity market prices. Similarly, we hypothesize that there is a positive relationship between electricity market prices and drastic weather temperature changes. As temperatures rises drastically or lowers drastically, people tend to use more electricity to power air conditioning or heating for units and fans to keep cool or warm. As mentioned before, This increase in demand can lead to higher electricity market prices as the supply of electricity may be limited. High temperatures can also impact the production of electricity. For example, nuclear power plants may need to reduce output due to warmer water temperatures in nearby rivers and lakes, while some types of power plants may be less efficient at higher temperatures. This can lead to a reduced supply of electricity, which can result in higher market prices. Higher temperatures can also increase the costs of producing 9 electricity. For example, natural gas prices may rise as demand for gas-fired power plants increases, and cooling costs for power plants may also increase. These increased costs can be passed on to consumers through higher electricity market prices. Our initial hypothesis on the best models are that Multivariate ARIMA models and univariate Exponential smoothing models will have great performance results and be superior to Regression Modeling and Random Forest modeling. However, we are unsure on how good Extreme Gradient Boosting Models will perform for different timescales (short term, Long-Term and Day-Ahead) and may be the surprising candidate for best models based on some of the previous research. 4 Data In creating models for electricity market prices in SCE territory, we use daily market price data collected straight from California ISO outputs. The raw data can be found by navigating through the California ISO website and choosing time frames. The CAISO market price data, which is our response variable, uses hourly CAISO prices in the SCE territory for everyday spanning from January 1 st, 2020, to June 1st 2022. The CAISO market price data is imported into a CSV file, loaded into R, formatted and then converted into a time series object. A plot of market prices as seen in Figure 2. The fuel prices data is also collected from the same location under “fuel prices” Tab. The Fuel price data also spans over the same time period of January 1st 2020, to June 1st 2022 in hourly format. The fuel price data is averaged for all of SCE territories per hour, and similarly to the market prices it gets formatted and converted into time series object. A plot showing fuel prices is seen in figure 8. In our models, we use fuel data as a predictor variable. 10 The weather data is another predictors variable that is being used in our Models. The weather data was purchased from mateomatics.com which uses an API for weather data. The weather data is in hourly format averaged for SCE territories from 2020-2022. SCE Territory covers large territories spanning from counties north of San Bernardino such as Mono County, Inyo county and Tulare, as well as Kern County Los Angeles County ,Ventura County, Riverside County and Orange County. Before starting to fit models to our data, we split the data into training and test sets. Splitting data into testing and training sets is a fundamental step in evaluating the prediction accuracy and performance of time series models for all the mentioned models we plan to use. The Training set consists of 21,168 observations measured in hours, which is 882 days. The test set consists of 720 observations/hours netting to 30 days. Once the models have been trained on the training data, we will proceed to make predictions on the testing data and evaluate their performance. We plan to use the Root Mean Squared Error (RMSE) as a measure of model performance when comparing them, as well as visualizing the predicted values against actual values in line plots. In summary, we model our data from January 1 st, 2020 to May 1st, 2022 and compare the predicted values from all of our models to our test set or actual values of market prices from May 1st, 2022 to June 1st , 2022. On top of checking Long-term model performances, we also subset the test set to check for Short-Term (7-day) forecasts and Day-Ahead forecasts (1-day) for all of our models. 5 Time series analysis of CAISO Market Prices Our first step in Time series analysis of CAISO market prices involves plotting the time series data to visualize the price trends, fluctuations and possible patterns. From looking at the market 11 prices time series plot in figure 2, we see that the overall trend of market prices tends to gradually increase from 2020-2021 and similarly from 2021-2022. To further validate that the price is gradually increasing over time, yearly average means of 2020-2021 and 2021-2022 were compared. From 2020-2021, the yearly average was $35.5/KWH while 2021-2022 showed a large increase at $50.62/KWH. There are many price fluctuations and spikes due to various possibilities, reasons and world events. It is widely known that Electricity market prices are very volatile. The variability is causing the response variable to look erratic and have some possible seasonality as well, we will further observe details on seasonality and overall trend. Figure 2: CAISO Market Prices In figure 3 we focus the market prices over a year timeframe by observing closer in 2020–2021- time frame and compare it with the market prices in 2021–2022 time frame from figure 4. Figure 3 shows that even though there were large spikes in September and November of 2020, most of the market prices stayed averaging just below 40 dollars for half of 2020 and started to rise slowly towards end of 2020. 12 Figure 4 however showed that in 2021-2022, the average market price started to rise, and especially rise in the second half of 2021 along with some large spikes. A big reason for the increase of electricity market prices over 2020-2022 period could be due to the recovery from the COVID-19 pandemic where economic activity resumed causing an increase in demand for electricity, also increase in gas prices due to world events and more. Figure 3: 2020-2021 CAISO Market Prices Figure 4: 2021-2022 CAISO Market Prices 13 6 Time series Decomposition, seasonality, trend and differencing Stationarity is Essential for Time series analysis. Stationarity in summary expects statistical properties to remain constant over time. If the data is not stationary, we will consider differencing or other transformations to achieve stationarity. In this section proceeds to check CAISO Market prices for stationarity, seasonality and overall trend, so we decompose and analyze the CAISO market prices and regressor variables as well in this step. Figure 5 below shows that the trend for CAISO electricity market is generally linear with a few spikes and deviations, and shows a steady growth over time. From looking at the time series analysis of the market prices, as well as knowing some world events that played part in price increases over time, this is not surprising. Figure 5: Decomposition of additive time series 14 Seasonal variation looks to have some large spikes from Figure 4’s seasonal piece, but there is not a clear seasonal pattern displayed in Figure 5. Although the variations are very high, there is no clear seasonal pattern that shows a significant effect. To Examine seasonality effect at a deeper level, we observe Figure 6. In Figure 6, we examine a boxplot of price for each year-Month. The boxplot in figure 6 shows large spikes in August and September for 2020 but Minor spikes in August and September of 2021 so we don’t see any clear pattern of seasonality here either but rather some large spikes that are not clearly due to seasonality and perhaps due to different reasons. Figure 6: Boxplot of Prices over Year-Month The next steps were to check the Box-Ljung, augmented Dickey-Fuller and KPSS tests. Box- Ljung test, Dickey-Fuller test, and KPSS test serve different purposes in time series analysis. They help in assessing key characteristics of a time series, such as autocorrelation, stationarity, and integration. The Box-Ljung test is used to assess whether a time series exhibits significant 15 autocorrelation up to a certain lag. This helps us identify If residuals are autocorrelated. If the residuals are autocorrelated, the model may not be capturing all the patterns in the data, potentially leading to biased parameter estimates and incorrect inferences. The Dickey-Fuller test is largely used to assess whether a time series is stationary or not. Allowing us to test for stationarity helps us decide whether differencing the data is necessary to achieve stationarity. Differencing removes trends and allows us to build more accurate models. Lastly, KPSS also tests for stationarity, but unlike dickey-fuller test, it is using a null hypothesis to test for stationarity. From the Augmented Dickey fuller test and KPSS tests in Figure 6 below, the results rejected the null hypothesis that the time series of CAISO Prices is not stationary and accept that it is indeed stationary. The Box-Ljung test in figure 7 also rejects the null hypothesis that the series is independent. In summary, we are happy with the stationarity assumptions and independence assumption of the series and proceed to analyze the time series of the regressor variables below. 16 Figure 7: Box- Ljung, KPSS and Dickey-fuller tests 7 Time series analysis of Fuel Prices and Weather Data Looking at the time series analysis of fuel prices, we see a similar trend and pattern to what we saw in the Market prices for electricity. The fuel prices overall seem to gradually rise from 2020 to 2022 with some large spikes in summer of 2020, winter of 2020 and fall of 2021. Figure 8: Fuel Prices Time Series and Decomposition 17 Furthermore, to check for stationarity, running the Augmented Dickey-Fuller test and the KPSS test on Fuel prices time series, we conclude that the time series is stationary just as CAISO Prices were. To look for Seasonality and the overall trend we look at the decomposition of Fuel prices in figure 8. The decomposition chart in figure 8 shows a clear increasing linear trend just as we saw for CAISO market prices and there doesn’t seem to be a clear seasonal trend. Time series analysis of Temperatures in SCE territory are just what is expected in California seasons. From figure 9, we can see a clear pattern of seasonality of temperatures throughout the years, but temperature is expected to have seasonality. In our analysis we will be using the SCE territory average temperatures as a predictor variable. Figure 9: AVERAGE TEMPERATURES 8 Arima Modeling Since classical regression models are often insufficient to explain all the interesting dynamics that occur in a time series, an Autoregressive (AR) and autoregressive moving average (ARMA) models are a great tool to model time series data with the ability to also use regressors. 18 Autoregressive integrated moving average models (ARIMA) are based on the idea that the current value of the series, 𝑥𝑡 can be explained as a function of p past values 𝑥𝑡−1, 𝑥𝑡−2, … , 𝑥𝑡−𝑝 where p determines the number of steps into the past needed to forecast the current values. Identifying the best configuration for ARIMA Parameters are crucial for defining the model's behavior and its ability to capture the patterns and dynamics in a time series. The parameters p,d and q correspond to the autoregressive order, differencing order, and moving average order. The autoregressive component AR represents the correlation between the current value of a time series and its past values. The parameter p specifies how many past time steps are included in the model. In other words, it indicates the number of lagged values of the time series to consider for predicting the current value. Differencing is performed to achieve stationarity, where statistical properties remain constant over time. Non-stationarity can make modeling difficult and inaccurate. The d parameter indicates the number of differencing operations needed to make the time series stationary. Lastly, the moving average (MA) component represents the correlation between the current value of a time series and its past forecast errors (or residuals). In this section, we proceed to use ARIMA modeling while holding the differencing aspect d as a constant of 0. 8.1 Identifying optimal p, d, q The First step involves identifying the best configuration for our ARIMA models. Throughout our ARIMA models we use a value of 0 for differencing since we confirmed through various tests that CAISO Market prices data was indeed stationary and there were no significant autocorrelations. Transformations were also considered but the transformations did not improve our results. For our ARIMA models configurations of p,d,q while holding differencing piece as 0, to determine the optimal p and q pieces, a for loop was built to test the best results checking p 19 and q for 1-5 values in a for loop. Here we iterate through different combinations to find the best-fitting model. Figure 10 shows the top results from running the for-loop on best p, d, q configurations based on AIC and RMSE values. The configuration of p,d,q = (5,0,3) yielded the best results when running our Arima model based on AIC and RMSE as seen in Figure 10. Figure 10: Configuration results for P and Q while fixing d =0 8.2 Model diagnostics and Fit Checking model diagnostics and fit is a crucial step in ARIMA modeling to ensure that the chosen model is appropriate for the time series data and provides reliable forecasts. After Fitting Arima models using p,d,q values 5,0,3 we look at the ACF of this models residuals for long-term forecast to see if the autocorrelations have significance in Figure 11. Based on figure 11, ACF quickly drops off and even though there are values with some spikes in the middle, this ACF of the models residuals look fairly good overall and indicates that there is not a significant autocorrelation problem. However, we need to perform further tests to make sure our Model is reliable for accurate forecasting. 20 Figure 11: ACF ARIMA (5,0,3) residuals To further validate our model, we run the Ljung-Box test on the ARIMA residuals and check for significance. A p-value greater than 0.05 in the Ljung-Box test indicates that the residuals are independent, and our model is valid. Figure 12 shows the results of the Ljung-Box test. The Ljung-Box’s null hypothesis states that the autocorrelations are jointly zero while Alternate hypothesis states the autocorrelations are no jointly zero. Since p-value of 0.4435 is greater than the threshold of 0.05, we cannot reject our null hypothesis since there is not enough evidence and accept our null hypothesis that the autocorrelations are jointly zero. This further validates our model. We accept our model as satisfactory for ARIMA(5,0,3). 21 Figure 12: Ljung-Box results for ARIMA model (5,0,3) 8.3 Forecasting using ARIMA models In order to test the strength of the chosen ARIMA model, we forecast using the training data and compare these forecasted values to the test we split in earlier stages. The test data contains one month of CAISO Market prices data so we will have 720 values of predicted data to compare with the test set. To evaluate the accuracy of this model and compared to other models, we will use the root mean square error (RMSE) as well as plots of forecasted values alongside actual values to visually assess the accuracy of the models predictions. Figure 13 below shows the visualized predicted Long-term values of CAISO Market prices using our ARIMA model in a red line on the right hand side of the line chart. 22 Figure 13: Predicted values of ARIMA model To summarize our predicted ARIMA model results when compared with actual Market price values, it looks like our forecast in Figure 13 does a good job of predicting the CAISO Market prices for a one-month period in May of 2022. However, throughout this thesis, we will perform long-term forecasts, short-term forecasts and Day-Ahead forecasts. A one-month period prediction is considered as a long-term forecast in this thesis, short-term forecasts are forecasts for a one-week period and Day-Ahead forecasts are 24 hour forecasts of CAISO Market Prices. However, we need to compare ARIMA model forecasts for short-term, long-term and Day-Ahead forecasts to other models to see how good the ARIMA model performed in comparison to them. On top of the computed Multivariate ARIMA models in this section, we tried univariate ARIMA models without any regressors and they did not perform as well as the ARIMA model with regressors. Our goal is to achieve the best prediction accuracy results so we decided to use 23 Multivariate ARIMA model as the measure of how well ARIMA models are at predicting CAISO market prices. 9 Linear Regression Models Using CAISO market prices as response variable, we fit time series linear regression models using fuel prices and temperatures in SCE territory as the predictors. The linear regression model uses split data as in the ARIMA model, which is modeled on the training set and tested on the test set for model evaluation across multiple timescales (Short-term, Long-term and Day-Ahead). Our Time series Linear Regression Model fit is : After checking the basic model assumptions are met, we observe the model results. The results of the linear model are displayed in Figure 14. Looking at the Fit of the model, it corresponds to what our hypothesis was initially. Our Hypothesis was that Fuel price would have a positive, significant relationship with CAISO Market prices and this is evident in our Regression model fit. Fuel Price and Temperature are both statistically significant in predicting market price of electricity and even though Fuel price has a large Beta and contributes much more than average temperature in market price value prediction, the Multiple R-Squared is low in this linear model. However, since fuel prices are statistically significant predictors of CAISO market prices, it implies that the relationship between the two variables is not likely due to random chance. This insight is very valuable for electricity market participants, including Electricity Service Providers (ESPs), traders, and policymakers, highlighting a potential factor that is influencing price dynamics. Weather on the other hand has a very small Beta in comparison to Fuel prices, so 24 when weather is very low or very high it is significant in affecting CAISO Market prices, but it does not raise the Electric Market prices by a large amount since the Beta is very small. The AIC for our Linear regression model is much higher than our ARIMA Model, but the RMSE is slightly better than our ARIMA model results. Overall, indicators tell us that Regression Model for time series also performs very well and closely resembles the results of the ARIMA model performed in this thesis. The linear regression forecasting results are visualized in figure 15 below. Figure 14: Linear Model Summary results 25 Figure 15: Linear Model Forecast On top of acquiring Long-term Linear model forecasts, we also acquired short-term and Day- Ahead linear model forecasts to compare with all other models once all the various model results are complete. 10 Random Forest Model Random Forest Models have been used in previous research in predicting electricity prices with high performance success. In this section we utilize random forest modeling to forecast CAISO Market prices and compare short-term, long-term and Day-Ahead results with other models in this Thesis. Random Forest models involve applying machine learning algorithms that leverage an ensemble of decision trees to make accurate predictions. Random Forest models have proved to be powerful and versatile algorithms that can capture complex relationships in data. Using the training data, we built a random forest model using our regressors fuel price and average temperatures in the SCE territory. The Random Forest model results turned out very quickly to be the best performance results thus far. The Random Forest model had the lowest RMSE out of 26 ARIMA, Linear modeling and Random Forest when predicted using training data and compared to the Long-term forecasting test set. Figure 16 shows the visualized results of the Long-term Random Forest model prediction. Figure 16: Random Forest Model Results Once again, along with long-term results for random forest models, we also computed Short- term and Day ahead forecasts to find the best Long-term, Short-term and Day-Ahead once all models results are available. 11 Extreme Gradient Boosting (XGBOOST) In this section we apply a method of Extreme Gradient Boosting (XGBoost) to model for CAISO Prices. XGBoost (Extreme Gradient Boosting) is a powerful machine learning algorithm that is commonly used for regression and classification tasks. It's particularly effective for predicting complex relationships within datasets, making it suitable for predicting CAISO market prices. XGBoost has also become very popular in recent years due to its strong prediction results, 27 excelling at predictive accuracy by combining the strengths of decision trees and boosting techniques. Preparing the XGBoost model required lots of data preparation prior to modeling including splitting the data in testing and training sets and formatting. In the end, although XGBoost is not as interpretable as linear models, it helps achieve great performance results and we can still gain insights from feature importance rankings. XGBoost model results were immediately evident as superior among all other models we had ran previously in this thesis. It performed extremely well and was at the top in terms of performance when compared with Linear Regression, ARIMA modeling and Random Forest Modeling with the lowest RMSE value. In Figure 17, XGBoost prediction results are visualized. Figure 17: XGBoost Model Results 28 Short-Term, and Day-Ahead results were also produced alongside the Long-term XGBoost performance results for comparison with other models. 12 Exponential smoothing As detailed in the ARIMA modeling section, an ARIMA model was computed early on without any regressors, and it did not yield optimal results when compared with a multi-variate ARIMA Model, so we wanted to try another model in Univariate setting. In this section we use Exponential smoothing as a univariate model to see how well it performed without any predictors. Exponential Smoothing is a time series forecasting method that involves calculating a weighted average of past observations to make predictions about future data points. It's particularly useful for time series data with no significant trends or seasonality. The method assigns different weights to different past observations, with more recent observations receiving higher weights. In this section we aim to predict Market prices using the Holt-Winters exponential smoothing technique. Once again, we will use RMSE to measure the accuracy of the smoothing techniques we modeled on the training data to forecast in comparison to the Test set. The holt winters smoothing technique yielded similar results to the Linear model results. However, in the smoothing model we don’t use Fuel or temperature variables to predict Market prices, only the market prices. The Long term-prediction results are visualized in Figure 18 below. 29 Figure 18: Smoothing Technique Results Along with Long-term forecasts, Short-term and Day-Ahead forecasts are calculated and compared with actual Market prices to compare performance with other models throughout this thesis. 13 Conclusions Throughout the thesis, our objective has been to find the optimal prediction results in predicting CAISO Market Prices. Through the use of various Time series, Machine Learning and Regression models, we have achieved great model performance results. The thesis began with Introducing the importance of the Electricity Market and the profitability aspect of it. The thesis focuses on helping Electric Service Providers (ESPs) maximize Profit by forecasting California ISO Electric market prices accurately. The accurate Forecast of Electric Market prices in the California SCE territory helps ESP’s make better business decisions on what rates to sign 30 customer contracts under, when to buy or sell Electricity and how to plan for future transactions based on where the market will be from analyzing the forecasted Market prices. The initial hypothesis was also confirmed in regression modeling that Fuel Prices do indeed have a strong, significant, positive relationship with Market prices and should be a factor to evaluate for ESP business executives. After introducing all aspects of the Electricity Market, details and exploratory analysis were provided for our datasets, where they come from, how we split the datasets and descriptions of regressors and response variables. Next, we took each predictor variable and response variable and conducted time series analysis on the variables, making sure stationarity was present and seasonality absent. All variables involved in predicting Market Electricity prices were visualized and dissected through time series analysis visualizations and various autocorrelation plots. Once we had all our time series variables explored and analyzed, it was time to start testing various models on our data. We started with ARIMA modeling, with a goal to find the optimal ARIMA p,d,q settings. A for loop to check ARIMA for P and Q optimal settings was performed while holding d as constant of 0, since it was not needed. The Optimal ARIMA model was determined to be Multivariate as opposed to Univariate and with a setting determined as ARIMA(5,0,3) using predictors Fuel prices and average temperatures in the SCE territories. From initial results analysis, we had found a great model, but we wanted to keep improving the prediction results, so we moved on to Linear Regression Analysis for time series. Regression Analysis was performed, and it was surprisingly giving results that closely resembled ARIMA model results. Our hypothesis was also confirmed in the Regression results for Fuels relationship with CAISO prices. Having the performance results of Regression and ARIMA so 31 closely resembling each other, we explored Random Forest Modeling to find even better results since it has been very effective in previous research analyses. As expected, Random Forest models yielded the best results for short-term, long-term and day-ahead predictions when compared to the previous models of ARIMA and Regression. Upon looking back, Linear Regression and ARIMA models predicted values were heavily over-estimated when compared to the actual values. Random Forest Model did not overestimate the predicted values. As we dived into the world of Machine learning models, we wanted to pursue one of the most popular and widely used techniques: Extreme Gradient Boosting (XGBoost). XGBoost seemed very appealing based on previous research results and the widely known efficiency of it, so we also performed XGBoost to compare them to Random Forest Models. Performing XGBoost models on Short-term, Long-term and Day-Ahead Forecasts brought us to the best prediction results we would see in this research paper. XGBoost performed by far the best out of all the models. One last thing remained; checking a Univariate model that was not an ARIMA model since the Multivariate ARIMA was superior. The last Model performed was a Holt-Winters Exponential Smoothing model that only utilizes the CAISO Market prices Electricity prices for prediction. Still, it did not perform to the levels of XGBoost and Random Forest models. Exponential smoothing, just as ARIMA and Linear Regression models, overestimated the predicted values when compared to actual values. 32 13.1 Best Models: Long Term, Short Term and Day-Ahead With the goal of the thesis to find the best possible performing model, we wanted to compare the best models across different timescales. In predicting CAISO Market prices, forecasting at different timescales is very important for various reasons. The Day-Ahead electricity forecasting is critical for balancing energy consumption and generation, executing decisions on whether to buy/sell energy if it’s at a good price, and planning for the near future. Short Term or 7-day Forecasts give more of a clear picture of the Market direction when compared with the Day-ahead forecasts, which is important because ESPs submit Weekly settlements to CAISO to verify total Electricity Usage per week. The accuracy of weekly Settlements is extremely important because inaccurate reports result in ESPs paying very high fines if there needs to be corrections down the line. Lastly, Long term forecasts are very important for Planning, making profitable investments and signing profitable contracts with customers. ESP’s lose money from bad contracts signed with customers because of under- predicted Market prices, reiterating the importance of making correct long-term predictions. In table 1, Our complete Model results show that our best long-term Model predictions are achieved from using Extreme Gradient Boosting (XGBoost) and by a Large Margin when using RMSE for measuring the prediction Accuracy. Random Forest Model and Exponential Smoothing come in about equally in second place. Surprisingly, ARIMA model had the worst Prediction Accuracy results, when originally our preliminary thoughts lead us to believe that ARIMA model would perform at a very high level. In terms of Short-Term Models for 7 Day forecast, XGBoost once again had the best prediction Accuracy results when measuring using RMSE, with Random Forest Model coming in close second. All other model prediction accuracy results were far off from XGBoost and Random Forest Models. 33 Lastly, when forecasting the Day Ahead CAISO Market prices, just as in the short term forecasts, XGBoost once again comes in with the lowest RMSE with Random forest coming in close second with all others prediction accuracy results far off from XGBoost and Random Forest Models. Throughout forecasting models at different time scales, XGBoost is by far the best Model to use for Prediction Accuracy results, with Random Forest Model showing respectable results as well as the second-best Model to use for prediction of CAISO Market prices. Forecast Length Model Results using RMSE ARIMA Regression XGBoost Random Forest Smoothing Long Term (1 Month) 43.74 42.85 33.05 * 36.13 36.12 Short Term (7 Days) 43.73 42.97 34.12 * 35.61 39.64 Day Ahead (1 Day) 35.07 34.80 28.21 * 30.61 36.67 Table 1: All Model Results for Various Timescales 13.2 Takeaways from our Findings Based on all the Findings from this thesis, all results indicate that XGBoost is the best tool for performance results across all time scales; short term, long-term and day-ahead predictions for CAISO Market prices in the SCE territories. Unlike our initial thoughts that ARIMA models would perform the best, it was disproved quickly. XGBoost should be the primary tool used to help determine what rate customers should be signed under, when negotiating contract terms whether long-term or short-term. XGBoost Model results can help determine when to buy/sell energy to maximize profits and help Electric Service Providers plan for future transactions and investments. 34 Random forest Models can also lead to great prediction results and are a very respectable tool when predicting California’s Electric Market prices. The prediction results for linear models, ARIMA models and exponential smoothing techniques were largely overestimating predictions. The overestimations can be visualized in figure 19. Figure 19 shows Linear models, ARIMA models and Exponential smoothing estimated lines are clearly above XGBoost and Random Forest lines which appear to be more towards the bottom of the Line chart. Furthermore, our findings indicate that Multivariate models such as Random Forest, XGBoost, and Regression models perform much better than Univariate models when observing Univariate ARIMA and Smoothing models across all timescales. Figure 19: All Long-Term Model Forecasts 35 13.3 Future Research and Suggestions In this thesis, we only use Fuel prices and Average temperatures as regressor variables. In future research, it would be wise to use other relevant regressors. Interesting Variables that can be used to help predict Market Electricity prices include Coal Prices, Electric Outages data, Power Grid information, Wind blowing Strength data, Sun radiation levels, Snow melting data, Hydro data, Renewable power plant data, Holidays, World events data, and more. However, it may be complicated to get access to some of this data. It would be wise to continue testing Random Forest and Extreme Gradient Boosting Models over time on CAISO market prices throughout the years and move over to PG&E Territories in northern California, as well as SDGE Territories in Southern California. The use of a larger dataset spanning 5-10 years can also help improve the XGBoost and Random Forest models. It would also be wise to keep trying different Neural Network models and compare prediction performance with different models. 36 A References [1] Robert H. Shumway and David Stoffer “Time series Analysis and Its Applications” pp. 47- 77, 2017 [2] Public utilities commission, 2021. Community Choice Aggregation and Direct Access. URL https://www.cpuc.ca.gov/consumer-support/consumer-programs-and-services/electrical-energy- and-energy-efficiency/community-choice-aggregation-and-direct-access- [3] Sajjad Khan, Shahzad Aslam, Iqra Mustafa and Sheraz Aslam. “Short-Term Electricity Price Forecasting by Employing Ensemble Empirical Mode Decomposition and Extreme Learning Machine” URL: https://www.mdpi.com/2571- 9394/3/3/28#:~:text=Abstract,and%20dispatching%20independent%20system%20operators. [4] Zippia Career Expert, “SOUTHERN CALIFORNIA EDISON'S REVENUE IS $12.6 BILLION.” URL: https://www.zippia.com/southern-california-edison-careers-38905/revenue/ [5] Smart Energy Team, “Should You Choose a Fixed or a Variable Rate Plan?” URL: https://www.smartenergy.com/should-you-choose-a-fixed-or-a-variable-rate-plan/ [6] F. M. Alvarez, A. Troncoso, J. C. Riquelme, and J. S. A. Ruiz, “Energy time series forecasting based on pattern sequence similarity,” IEEE Trans. on Knowledge and Data Engineering, vol. 23, no. 8, pp. 1230–1243, 2011. 37 [7] H. Mori and A. Awata, “Data mining of electricity price forecasting with regression tree and normalized radial basis function network,” in Proc. of IEEE International Conference on Systems, Man and Cybernetics, 2007 pp. 3743–3748. [8] Panapakidis, Ioannis P and Dagoumas, Athanasios S, “Day-ahead electricity price forecasting via the application of artificial neural network based models,” Applied Energy, vol. 172, pp. 132–151, 2016 [9] B. Neupane, K. S. Perera, Z. Aung, and W. L. Woon, “Artificial neural network-based electricity price forecasting for smart grid deployment,” in Proc. of Computer Systems and Industrial Informatics (ICCSII), 2012. [10] Gonzalez, Camino and Mira-McWilliams, Jose and Juarez, Isabel, “ Important variable assessment and electricity price forecasting based on regression tree models: classification and regression trees, Bagging and Random Forests,” IET Generation, Transmission & Distribution, vol. 9, no. 11, pp. 1120–1128. [11] Barta, Gergo and Nagy, Gyula Borbely Gabor and Kazi, Sandor and Henk, Tamas, “GEFCOM 2014probabilistic electricity price forecasting,” in Intelligent Decision Technologies, 2015, pp. 67–76. [12] Ashkan Sadeghi-Mobarakeh, Mahdi Kohansal, Evangelos E. Papalexakis, and Hamed Mohsenian-Rad. “Data Mining based on Random Forest Model to Predict the California ISO Day-ahead Market Prices”. Internet resource.","libVersion":"0.3.2","langs":""}