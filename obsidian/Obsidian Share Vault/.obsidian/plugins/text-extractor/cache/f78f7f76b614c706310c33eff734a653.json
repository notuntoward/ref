{"path":"lit/lit_sources/Ciarreta23ForecastingElectricityPrices.pdf","text":"See discussions, st ats, and author pr ofiles for this publication at: https://www.r esearchgate.ne t/publication/361913892 Forecasting electricity prices using bid data Article  in  International Journal of Forecasting · July 2022 DOI: 10.1016/ j.ijf orecast.2022.05.011 CITATION 1 READS 205 3 author s: Aitor Ciarreta Universidad del País Vasco / Euskal Herriko Unibertsitatea 64 PUBLICATIONS   992 CITATIONS    SEE PROFILE Blanca Martínez Complutense University of Madrid 26 PUBLICATIONS   217 CITATIONS    SEE PROFILE Shahriyar Nasirov Universidad Adolfo Ibáñez 35 PUBLICATIONS   674 CITATIONS    SEE PROFILE All content following this page was uploaded by Shahriyar Nasirov on 12 July 2022. The user has requested enhancement of the downloaded file. Please cite this article as: A. Ciarreta, B. Martinez and S. Nasirov, Forecasting electricity prices using bid data. International Journal of Forecasting (2022), https://doi.org/10.1016/j.ijforecast.2022.05.011. International Journal of Forecasting xxx (xxxx) xxx Contents lists available at ScienceDirect International Journal of Forecasting journal homepage: www.elsevier.com/locate/ijforecast Forecasting electricity prices using bid data Aitor Ciarreta a,∗ , Blanca Martinez b, Shahriyar Nasirov c a Department of Economic Analysis, BETS and BRiDGE, UPV, 48015 Bibao, Spain b Department of Economic Analysis and ICAE, Complutense University of Madrid, 28223 Madrid, Spain c Center for Energy Transition (CENTRA), Faculty of Engineering and Sciences, Universidad Adolfo Ibáñez, Diagonal Las Torres 2640, Peñalolén, Santiago, Chile a r t i c l e i n f o Keywords: Electricity markets Linear functions Logistic functions Time series models Price forecasting a b s t r a c t Market liberalization and the expansion of variable renewable energy sources in power systems have made the dynamics of electricity prices more uncertain, leading them to show high volatility with sudden, unexpected price spikes. Thus, developing more accurate price modeling and forecasting techniques is a challenge for all market par- ticipants and regulatory authorities. This paper proposes a forecasting approach based on using auction data to fit supply and demand electricity curves. More specifically, we fit linear (LinX-Model) and logistic (LogX-Model) curves to historical sale and purchase bidding data from the Iberian electricity market to estimate structural parameters from 2015 to 2019. Then we use time series models on structural parameters to predict day- ahead prices. Our results provide a solid framework for forecasting electricity prices by capturing the structural characteristics of markets. © 2022 The Author(s). Published by Elsevier B.V. on behalf of International Institute of Forecasters. This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/). 1. Introduction Power pricing in modern, deregulated electricity mar- kets has become more complex and dynamic, given that it is driven by factors including day-to-day and seasonal variation on the demand and supply sides, seasonal varia- tion in temperature, the availability of energy sources, and many others. For instance, price dispersions in the day- ahead market range from 6% to 28%, compared to 2% to 3% for crude oil and 3% to 5% for natural gas (Simonsen, 2005; Zareipour et al., 2007). In recent years, growing market penetration by more intermittent renewable generation has further increased price volatility concerns in elec- tricity markets (Baldick, 2012; Brancucci Martínez-Anido et al., 2016). Price dynamics have become a complex issue with serious implications for market participants and market/system operators. Developing more accurate ∗ Correspondence to: Facultad de Ciencias Económicas y Empresariales, Avenida Lendalari Aguirre, 83, 48015 Bilbao, Spain. E-mail address: aitor.ciarreta@ehu.eus (A. Ciarreta). forecasting methods has become a fundamental task for investors to plan their bidding strategies with a view to maximizing their utility from short-, medium-, and long- term perspectives. It can also help consumers to minimize the cost of a variety of applications in dynamic pricing environments and demand responses (Cabral et al., 2020). Finally, it helps regulatory authorities to ensure the long- term adequacy and security of supply and the stability of power markets. For these reasons, there has been growing interest in the literature in developing better price mod- eling and forecasting techniques (Nowotarski & Weron, 2018; Taylor et al., 2006; Weron, 2007). Studies on price forecasting in electricity markets con- ducted around the world have been many and varied. They can be differentiated and categorized by a mainly methodological approach (Hong et al., 2020; Lago et al., 2021; Weron, 2014). Statistical (econometric) methods make up one of the largest groups of electricity price fore- casting methods. Most statistical models use time series analysis, which seeks to model the temporal structure of prices observed in a certain period of time and then pre- dict their behavior in the future. Most models of this type https://doi.org/10.1016/j.ijforecast.2022.05.011 0169-2070/© 2022 The Author(s). Published by Elsevier B.V. on behalf of International Institute of Forecasters. This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/). A. Ciarreta, B. Martinez and S. Nasirov International Journal of Forecasting xxx (xxxx) xxx are variations of the autoregressive integrated moving av- erage (ARIMA) family of models (Yang et al., 2017), where price is modeled as a function of the past realizations of prices and residuals. These models are further improved by including exogenous variables in the case of ARIMAX models (Weron & Ziel, 2019), by studying the behavior of the residuals (especially when there are price spikes) in generalized autoregressive conditional heteroskedastic (GARCH) models (Lago et al., 2018), and by considering possible correlations between different load periods in vector autoregressive (VAR) models (Shah & Ghonasgi, 2016). Electricity price forecasting using statistical mod- els is successful to a degree at modeling the temporal structure of prices observed in a certain period of time and predicting their behavior in the future. However, such models have been criticized in the literature, due to several limitations. They have difficulty in considering the market dynamics and operation of electricity markets and in representing changes in regulations and market struc- tures (Weron, 2014; Ziel & Steinert, 2016). This means that they fail to accurately forecast prices in power sectors where price formation processes are more volatile and complex than fully regulated ones. In recent years, the constant increases in computing power and in the amount of data collected have resulted in new forecasting techniques based on artificial intel- ligence (AI) and machine learning (ML). A fundamental part of these techniques is to find certain patterns or distributions from historical data, assuming that markets will behave in the same (probabilistic) way in the future. The main types of AI techniques include artificial neural networks (Aineto et al., 2019; Catalao et al., 2007; Ortiz et al., 2016), fuzzy systems (Gao et al., 2018; Itaba & Mori, 2017), support vector machines (Cizek et al., 2011), and evolutionary computation (Unsihuay-Vila et al., 2010). These models have potential advantages in handling com- plexity and nonlinearity that provide promising short- term predictions, but a number of downsides have also been reported in the literature. One major disadvantage is that they are more complex and time consuming than statistical methods. They are also so diverse and rich that it is hard to compare the outcomes of different methods. Over the last ten years, there has been growing inter- est in another group of forecasting studies which focus on probabilistic forecasting techniques. Such techniques have also become a necessary tool for trading purposes, particularly in spot price models, due to their proper rep- resentation of the volatility and dynamics of spot prices (Hong et al., 2020; Ziel & Steinert, 2016). An important feature of these models is that they take uncertainty into account and provide all the potential outcomes as probabilities that may occur. Probabilistic forecasts are examined in the literature, mainly in the form of prob- ability distributions (Andrade et al., 2017), quantiles and intervals (Nowotarski & Weron, 2015), and parametric and nonparametric approaches (Jabot, 2015). These mod- els are known to be capable of providing a simplified yet realistic picture of price dynamics and price volatility (Benth et al., 2012), but they often perform poorly at forecasting, particularly with long-term horizons. They also fail to consider the structure of the market and the price formation process, which are fundamental for the study of price dynamics in today’s deregulated scenarios. Most of the models used in previous studies of fore- casting do not incorporate auction data, a fundamental mechanism for determining the so-called system marginal price in the power sector. In today’s deregulated power markets, auction data on supply and demand curves can help to develop new forecasting techniques. Recently, there have been new advances in the field of modeling based on auction data that include supply and demand curves. These approaches have some advantages over other forecasting models in that they provide an impor- tant source of information, especially for studying price movements, which can be captured from the shape of the sale and purchase curves. The use of such analyses is par- ticularly appropriate because demand and supply curves change over time. Many models of these types combine different techniques, such as time series, regression, and neural network models, in what are known as ‘‘hybrid methods’’. Such methods are intended to make the best use of the advantages of multiple forecasting methods and improve prediction accuracy. We develop an approach that combines the fitting of curves to historical hourly demand and supply data and time series models with the objective of forecasting electricity prices on the Iberian electricity market (MIBEL). Our main contribution to the literature is to use a curve fitting approach to historical hourly demand and supply data with the goal of forecasting electricity prices. We know of several studies in the literature that use an approach based on the structural modeling of supply and demand curves, although the main difference is the way demand and supply curves are obtained.Ziel and Steinert (2016) propose a nonfunctional model, called the X-Model, for price forecasting on the EPEX market, incorporating the properties of both time series and struc- tural analyses. They forecast the bid volume of each price class to predict entire day-ahead supply and demand curves and—with the intersection of the predicted auction curves—forecast the equilibrium prices and volumes. This concept was subsequently extended in Kulakov (2020) with the objective of reducing computation time and im- proving accuracy. Shah and Lisi (2020) propose a method for forecasting through a functional prediction of sale and purchase curves on the Italian electricity market. They treat each purchase and sales curve as a single structured object in a functional space. Then, they conduct a forecast for the entire curves using parametric and nonparametric autocorrelation functional models with a control period for model identification and estimation. A similar functional model is developed by Canale and Vantini (2016) for the Italian gas market. In another study, Portela et al. (2017) propose a new functional forecasting method that seeks to simplify the standard seasonal AR- MAX time series model to a new functional framework: L2 Hilbert space. An extension of this model, a double- seasonal functional SARMAHX model, is developed by Mestre et al. (2020) to capture the short-term season- ality of hourly aggregated supply curves in day-ahead electricity markets. We proceed in several steps. First, we propose two models for demand and supply: the LinX-Model, which 2 A. Ciarreta, B. Martinez and S. Nasirov International Journal of Forecasting xxx (xxxx) xxx Fig. 1. Methodology diagram. Fig. 2. Frequency of each price-bid in the day-ahead market. (Buyers (red), Sellers (blue)).. (For interpretation of the references to colour in this figure legend, the reader is referred to the web version of this article.) assumes linear demand and supply functions, and the LogX-Model, which assumes logistic demand and supply functional forms. Second, we fit the supply and demand curves for each hour based on observed auction data. Third, we use several time series models to forecast both models and to build the predicted linear and logistic func- tional forms. Finally, forecasted prices are obtained as the intersection of the predicted functional forms. Our second contribution is an application to the Iberian electricity market (MIBEL) for the period from 2015 to 2019. The rest of the paper is organized as follows: Section 2 explains price formation and the structure of the Iberian electricity market. The methodological part is split into three main phases, as shown in Fig. 1. These are described in the following sections: Market modeling is detailed in Section 3. Section 4 estimates the LinX-Model and the Log-X Model. Section 5 presents the benchmark time se- ries price forecasting models and the coefficient forecasts under the two models. Section 6 provides the empirical results, and Section 7 concludes. 2. Price formation and market curve structure Price formation in the Iberian electricity market is structured into four main segments: the wholesale mar- ket, bilateral contracts, prices for ancillary and balancing services, and, in certain cases, capacity payments. The wholesale market is structured into a day-ahead market and six intraday auctions. Our research focuses on the day-ahead market because it negotiates the bulk of the electricity traded. The day-ahead market works as a uniform price auction and sets the system marginal price for each hour of the following day, matching the electricity sale and purchase bids of market participants. Each day, d − 1, market participants submit bids to the market operator by 11:00 a.m. for the next 24 hours. Each participant can submit a maximum of 25 price-quantity pairs for each unit that it owns. Bids can be either simple (when no conditions are included) or complex (when conditions are included). Selling (purchasing) bids are sorted in ascending (descending) order from the cheapest (most expensive) to the most expensive (cheapest) to ob- tain an increasing (decreasing) supply (demand) schedule. The final price, Pd,h, is determined by the intersection of complex purchasing and selling bids, so we restrict our attention here to such bids.1 Our analysis covers the period from January 1st, 2015 to December 31st, 2019 using data published by the Oper- ador del Mercado Ibérico de Electricidad, OMIE. 2 During this period the price range is from e0/MWh to e180.3/MWh. 3 1 For more detailed information, see the market activity rules published by the market operator, OMIE. The algorithm that determines the equilibrium price and quantity is called EUPHEMIA. It calculates day-ahead electricity prices across Europe and allocates day-ahead cross-border transmission capacity. 2 Publicly available aggregate supply and demand curves for day-ahead market files are headed with the name curva-pbc. 3 On May 6th, 2021, the National Commission for Markets and Competition, approved new operating rules for daily and intraday electricity markets to adapt the limits to those in Europe. The new bid price caps and floors are established for the daily market of e−500/MWh and e3000/MWh. 3 A. Ciarreta, B. Martinez and S. Nasirov International Journal of Forecasting xxx (xxxx) xxx Fig. 3. Day-ahead market results on September 12th, 2019 (source: OMIE and own work). (For interpretation of the references to colour in this figure legend, the reader is referred to the web version of this article.) The minimum price difference between orders is e0.01/MWh. Hence, there are at most 18,030 possible prices on the full price grid P = {0, 0.01, . . . , 180.29, 180.30}. However, in practice, the price distribution used is not uniform. Fig. 2 plots the histogram for the amounts of the different prices for each curve, taking a bin of size 100, equivalent to e1 for the period from 2015 to 2019. It can be seen that the frequency of submitted prices differs substantially between buyers (red) and sellers (blue). Among sellers, price-bids at zero are the most frequent. This is because many price-bids are made by renewable generation units and nuclear plants, which operate with close-to-zero marginal costs. Thus, most complex bids are in the range of e35–55/MWh. For simple bids, most price-bids are in the range of e40–70/MWh and at the price cap of e180/MWh. Among buyers, price- bids of around e80/MWh are the most frequent, followed by price-bids at the price cap of e180.3/MWh. This is because retailers and distributors must comply with the security of supply under penalty of fines. Next come price-bids slightly above the equilibrium price. In general, the average number of block-bids per hour is higher for selling bids than for demand bids. This is due to two major facts: more market participants make selling bids than purchasing bids, and many purchasing bids are made at the price cap (e180.3/MWh) to ensure that retailers meet customer demand. Fig. 3 presents the market results for the day-ahead market for September 12th, 2019 as a representative day. Subfigure (a) shows Pd,h and Qd,h in the day-ahead market for the representative day. There is transmission conges- tion between 4:00 p.m. and 6:00 p.m., and coupling for the remaining hours. Subfigure (b) shows the day-ahead market under the absence of congestion, with hour 21 as an example. In the presence of congestion, there is mar- ket splitting and each country has a different price (see subfigures (c) and (d) for Spain and Portugal respectively with hour 16 as an example). In subfigures (b)–(d) the thick (thin) red line corresponds to the complex (simple) demand bids, while the thick (thin) blue line corresponds to the complex (simple) supply bids. Recall that Pd,h and Qd,h are determined by the complex bids. Finally, Fig. 4 plots the time series of prices (panels a and c) and the corresponding density plots (panels b and d) for Spain and Portugal. 4 A. Ciarreta, B. Martinez and S. Nasirov International Journal of Forecasting xxx (xxxx) xxx Fig. 4. Top row OMIE spot price Pd,h in EUR/MWh (left) and kernel density (right) for Spain. Bottom row OMIE spot price Pd,h in EUR/MWh (left) and density (right) for Portugal. Observe that there is seasonality in the prices of both countries. The fact that prices can fluctuate between 0 and 180.3 prevents large spikes. Density plots show that most of the density is around e40/MWh to e60/MWh, the distribution of prices is not symmetric, and there is excess kurtosis. 4 3. Modeling market curves We propose fitting linear and logistic functional forms for complex demand and supply bids, respectively. Thus, there are two structural market models: the LinX-Model, which assumes linear demand and linear supply curves; and the LogX-Model, which assumes logistic demand and logistic supply market curves.5 The market between Spain and Portugal is integrated, so in the absence of congestion, a single demand curve and a single supply curve are fitted, while under congestion, two demand and supply curves are fitted, one for each country. 4 Table A.3 reports the Jarque–Bera test on prices. The null hypothesis of normality is rejected at the 1% significance level. 5 We borrow the capital letter ‘‘X’’ from Ziel and Steinert (2016) to symbolize the intersection of the supply and demand curves. ‘‘Lin’’ stands for linear and ‘‘Log’’ stands for logistic. Demand function We propose fitting aggregate (inverse) hourly demand functions to purchasing bid schedules using the following specifications: I. Linear (inverse) demand function: P d t (Q d t ) = { Pmax if Q d t ≤ Q d min,t a0,t + a1,t Q d t if Q d t ∈ (Q d min,t , Q d max,t ) (1) where a0,t > 0 is the intercept, and a1,t < 0 is the slope. Q d min,t is a measure of the intensity of the demand. That is, it is the perfectly inelastic consumption level for each hour t. Q d max,t is the in- tercept of the demand curve with the quantity axis. It indicates the consumption of electricity when P d t = 0. Pmax is the price cap set by regulation. It holds that a0,t > P. 5 A. Ciarreta, B. Martinez and S. Nasirov International Journal of Forecasting xxx (xxxx) xxx II. Logistic (inverse) demand function: P d t (Q d t ) = ⎧ ⎨ ⎩ Pmax if Q d t ≤ Q d min,t a0,t + a1,t 1+e −a2,t ( Q d t −a3,t ) if Q d t ∈ (Q d min,t , Q d max,t ) (2) The slope of the logistic (inverse) demand function is given by: ∂P d t ∂Q d t = a1,t a2,t e−a2,t (Q d t −a3,t ) ( 1 + e−a2,t (Q d t −a3,t ))2 Thus, to have a negative slope, a1,t and a2,t must have opposite signs. Supply function Recall that aggregate supply schedules are the result of the horizontal sum of the generators’ bid curves. Since firms are profit maximizers, the structure of the cost underlies the bid curves observed. We propose fitting ag- gregate (inverse) supply functions of the following forms: I. Linear (inverse) supply function: P s t (Q s t ) = { 0 if Q s t ≤ Q s min,t b0,t + b1,t Q s t if Q s t ∈ ( Q s min,t , Q s max,t ) (3) where b1,t > 0 is the slope, and Q s min,t is the minimum supply to the market where sellers are willing to bid. II. Logistic (inverse) supply function: P s t (Q s t ) = ⎧ ⎨ ⎩ 0 if Q s t ≤ Q s min,t b0,t + b1,t 1+e−b2,t (Q s t −b3,t ) if Q s t ∈ (Q s min,t , Q s max,t ) (4) The slope of the logistic (inverse) supply function is given by: ∂P s t ∂Q s t = b1,t b2,t e−b2,t (Q s t −b3,t ) ( 1 + e−b2,t (Q s t −b3,t ))2 Thus, to have a negative slope, b1,t and b2,t must have the same sign. Equilibrium Market integration through limited interconnection capacity gives rise to market coupling or market splitting. In the absence of restrictions in the network, a single equilibrium price arises in equilibrium, and aggregate demand (supply) is the sum of the demand (supply) of the Spanish and Portuguese poles. Therefore, the market with the lower price exports electricity to the market with the higher price (Figueiredo et al., 2015). However, under network congestion, market splitting occurs and different equilibrium prices arise. We first explicitly obtain the equilibrium solution for the linear demand and linear supply cases. We denote the two biding zones as A and B. In the absence of congestion, the linear aggregate demand is: P d t ( Q d t ) = { Pmax if Q d t ≤ Q d min,t c0,t + c1,t Q d t if Q d t ∈ (Q d min,t , Q d max,t ) where c0,t = aA 0,t aB 1,t +aB 0,t aA 1,t aA 1,t +aB 1,t , c1,t = aA 1,t aB 1,t aA 1,t +aB 1,t , and Q d t = Q A,d t + Q B,d t . The linear aggregate supply is: P s t ( Q s t ) = { Pmax if Q s t ≤ Q s min,t d0,t + d1,t Q s t if Q s t ∈ (Q s min,t , Q s max,t ) where d0,t = bA 0,t bB 1,t +bB 0,t bA 1,t bA 1,t +bB 1,t , d1,t = bA 1,t bB 1,t bA 1,t +bB 1,t , and Q s t = Q A,s t + Q B,s t . Finally, the equilibrium values are: (P ∗ t , Q ∗ t ) = ⎧ ⎨ ⎩ ( c0,t d1,t −c1,t d0,t d1,t −c1,t , c0,t −d0,t d1,t −c1,t ) if P ⋆ t < Pmax ( Pmax, Pmax−d0,t d1,t ) if P ∗ t = Pmax (5) If zone A is exporting electricity (lower prices) to zone B: Q A,d t = P ⋆ t − aA 0,t aA 1,t , Q A,s t = P ⋆ t − bA 0,t bA 1,t Q B,d t = P ⋆ t − aB 0,t aB 1,t , Q B,s t = P ⋆ t − bB 0,t bB 1,t and the electricity trade is: Q A,s t − Q A,d t = Q B,d t − Q B,s t . If there is congestion, then there is market splitting and equilibrium prices are different in the two zones. The price difference depends on the amount of electricity that cannot flow to balance prices in both markets. Assum- ing an interior solution, zone A (the exporting zone) is characterized by the following linear demand and supply functions: P A,d t = aA 0,t + aA 1,t (Q A,d t − K ) P A,s t = bA 0,t + bA 1,t Q A,s t where K is the interconnection size. The equilibrium price in zone A is given by: P A t = aA 0,t bA 1,t − aA 1,t b A 0,t − b A 1,t aA 1,t K bA 1,t − aA 1,t (6) Zone B (the importing economy) is characterized by the following linear demand and supply functions: P B,d t = aB 0,t + aB 1,t Q B,d t P B,s t = bB 0,t + bB 1,t (Q B,s t − K ) and the equilibrium price in zone B is given by: P B t = aB 0,t b B 1,t − aB 1,t bB 0,t + aB 1,t bB 1,t K bB 1,t − aB 1,t (7) 6 A. Ciarreta, B. Martinez and S. Nasirov International Journal of Forecasting xxx (xxxx) xxx Note that under market splitting, the energy traded is K . Obviously, K = Q A,s t − Q A,d t = Q B,d t − Q B,s t . By contrast with the linear case, in the logistic case, it is not possible to obtain closed-form solutions. How- ever, conditions under which an equilibrium exists can be provided. Proposition 1 summarizes those conditions: Proposition 1. When the supply and demand curves follow logistic functions similar to those in Eqs. (2) and (4) and the parameters involved meet the following conditions for every h: (i) a1,t and a2,t have opposite signs. (ii) b1,t and b2,t have the same sign. (iii) a2,t < 0, a1,t > 0 b2,t > 0, b1,t > 0 ⇒ a0,t < b0,t + b1,t a2,t < 0, a1,t > 0 b2,t < 0, b1,t < 0 ⇒ a0,t < b0,t a2,t > 0, a1,t < 0 b2,t > 0, b1.t > 0 ⇒ a0,t + a1,t < b0,t + b1,t a2,t > 0, a1,t < 0 b2,t < 0, b1,t < 0 ⇒ a0,t + a1,t < b0,t . (iv) a0,t − b0,t > b1,t 1+eb2,t b3,t 2 + a1,t 1+e a2,t a3,t 2 there exists a unique equilibrium pair (P ⋆ t , Q ⋆ t ). Proof. Parameter restrictions (i) and (ii) are needed to ensure that the demand (supply) curve is decreasing (in- creasing). The slope of the logistic demand is given by: dPt dQt = a1,t a2,t e −a2,t(Qt −a3,t) ( e−a2,t(Qt −a3,t) + 1 )2 Therefore, given that sign ⎛ ⎝ e −a2,t(Qt −a3,t) ( e −a2,t(Qt −a3,t)+1)2 ⎞ ⎠ > 0, dPt /dQt < 0 only if either a1,t > 0 and a2,t < 0 or a1,t < 0 and a2,t > 0. The slope of the logistic supply is given by: dPt dQt = b1,t b2,t e−b2,t(Qt −b3,t) (e −b2,t(Qt −b3,t) + 1 )2 Therefore, given that sign ⎛ ⎝ e −b2,t(Qt −b3,t) ( e −b2,t(Qt −b3,t)+1)2 ⎞ ⎠ > 0, dPt /dQt > 0 only if either b1,t > 0 and b2,t > 0, or b1,t < 0 and b2,t < 0. Moreover, conditions (iii) and (iv) are required to guar- antee that the demand curve is above (below) the supply function when Qt → 0 (Qt → ∞). In the former case (demand curve above supply curve), note that ai,t ̸= 0 and bi,t ̸= 0, for i = 1, 2, 3, 4, so the limit prices as Qt → 0 are: lim Qt →0 ( a0,t + a1,t 1 + exp ( −a2,t (Qt − a3,t )) ) = a0,t + a1,t 1 + exp (a2,t a3,t ) lim Qt →0 ( b0,t + b1,t 1 + exp ( −b2,t ( Qt − b3,t )) ) = b0,t + b1,t 1 + exp (b2,t b3,t ) That is, a0,t − b0,t > b1,t 1 + exp ( b2,t b3,t ) − a1,t 1 + exp ( a2,t a3,t ) In the latter condition (demand curve below supply curve) the results depend on conditions (i) and (ii). Consider the demand: If a2,t < 0, given that a1,t > 0, limQt →∞ (a0,t + a1,t 1+exp(−a2,t(Qt −a3,t)) ) = a0,t , for any value of a3,t . If a2,t > 0, given that a1,t < 0, limQt →∞(a0,t + a1,t 1+exp(−a2,t(Qt −a3,t)) ) = a0,t + a1,t , for any value of a3,t . Consider the supply: If b2,t > 0, given that b1,t > 0 then limQt →∞ ( b0,t + b1,t 1+exp(−b2,t(Qt −b3,t)) ) = b0,t + b1,t , for any value of b3,t . If b2,t < 0, given that b1,t < 0, limQt →∞ (b0,t + b1,t 1+exp(−b2,t(Qt −b3,t)) ) = b0,t , for any value of a3,t . Therefore, there are four possibilities: a2,t < 0, a1,t > 0 b2,t > 0, b1,t > 0 ⇒ a0,t < b0,t + b1,t a2,t < 0, a1,t > 0 b2,t < 0, b1,t < 0 ⇒ a0,t < b0,t a2,t > 0, a1,t < 0 b2,t > 0, b1,t > 0 ⇒ a0,t + a1,t < b0,t + b1,t a2,t > 0, a1,t < 0 b2,t < 0, b1,t < 0 ⇒ a0,t + a1,t < b0,t 4. Estimation of the LinX-Model and the LogX-Model We estimate the parameters of the LinX-Model and the LogX-Model as follows 6: • Fit hourly demand functions as defined in Eqs. (1) and (2) on purchasing complex offers. The initial values taken for the intercept comprise the amount of electricity demanded at the maximum price set by law P = e180.3/MWh, say Q d min,t . This is a measure of the intensity of demand because it is the lowest possible sale of electricity to end consumers. From the hourly fits, two sets of parameters emerge: in the linear case, ˆa0,t and ˆa1,t ; in the logistic case, ˆa0,t , ˆa1,t , ˆa2,t , and ˆa3,t . • Fit hourly supply functions as defined in Eqs. (3) and (4) on selling complex offers. The initial values taken for the intercept comprise the amount of electricity supplied at the minimum price set by law P = 0 e/MWh, say Q s min,t . This is a measure of the mini- mum quantity that suppliers are willing to offer in order to sell on the market. From the hourly fits, two sets of parameters emerge: in the linear case, ˆb0,t and ˆb1,t ; in the logistic case, ˆb0,t , ˆb1,t ˆb2,t , and ˆb3,t . 6 In our work, we use Mata-Stata and Matlab sofware. 7 A. Ciarreta, B. Martinez and S. Nasirov International Journal of Forecasting xxx (xxxx) xxx • Use the fitted values of the parameters of the LinX- Model and the LogX-Model to obtain the fitted de- mand and supply curves. • Compute the equilibrium prices, named LinX-prices and LogX-prices, for each model and each market zone. 5. Forecasting models 5.1. Data transformation and congestion dummy We control for the seasonality typically observed in electricity prices. For each variable, price, or estimated coefficient, we subtract the median of the month m, day of the week d, and hour of the day h (see Ciarreta & Zarraga, 2017; Ullrich, 2012). Logarithm transformation is commonly used to im- prove the accuracy of forecasting models by reducing spike severity and consequently stabilizing the variance (see Fig. 4). However the de-median price series record close to zero and negative values, so logarithm trans- formation is not feasible. Therefore, based on Uniejew- ski et al. (2018), we apply a normal probability integral transformation (NPIT), 7 which is constructed using the empirical cumulative distribution as an approximation of the unknown true distribution of the time series. ˜Pt = Φ−1 ( ˆFz (zt ) ) where z is the (de-median) price or (de-median) esti- mated coefficient, Φ−1 is the inverse of the standard normal CDF, and ˆFz is the empirical cumulative distribu- tion of z. Hence, the inverse of the transformation enables untransformed variables to be recovered: zt = ˆF −1 z (Φ ( ˜Pt )) The purpose of these transformations is to improve the accuracy of forecasting models. 8 As explained above, market integration means that there is a single price when there are no transmission con- straints, but there are different prices when there is mar- ket splitting. A congestion dummy is therefore included to account for the possibility of market splitting: Ct = { 1 if P sp t ̸= P pt t 0 otherwise } 7 These transformations smooth the time series, improving the forecast performance. Several other VST transformations can be used, but the NPIT provides the best results. For markets where there are many hours with zero or close-to-zero prices, Díaz and Planas (2016) proposed a new algorithm based on the Nataf transformation that was validated by numerical results. This was the case for the MIBEL in their sample period, but for our sample period, this is not the case. 8 As Uniejewski et al. (2018) mention, the NPIT does not re- quire normalizing the variables. In our study, we applied the NPIT transformation to deseasonalized variables and original variables. The results did not change significantly, and we report the results with deseasonalized variables. 5.2. Benchmark time series price forecasting models We estimate several commonly used models of price forecasting using prices as covariates to check the robust- ness of our approach. Recall that at 12:00 CET on every day d of the year, the day-ahead market session is held, where prices are set at the same time for each hour h of the next day d + 1. Based on the structure of price formation in the Iberian market, we use two forecast approaches. The first consid- ers the hourly time series (the forecast is one hour ahead) and the forecasts for day d are computed recursively. The price forecast for h = 1 is used as an explanatory variable to make the prediction for hour h = 2, and so on until h = 24; we denote the models estimated using this approach by Model-t. In the second approach, forecasting is one step ahead for the daily time series of each given hour; thus, the forecast for day d for hour h does not depend on the previous hourly prices of the same day, and models estimated accordingly are denoted by Model-d-h. When agents place their bids, there is no information as to whether there is market coupling or market splitting. We build the ad hoc dummy assuming that agents assign a probability of congestion based on the average observed over the previous seven days: ¯Ct = ∑168 i=1 Ct−i 168 for Model-t types, and ¯Cd,h = ∑7 i=1 Cd−i,h 7 for Model-d-h types. 9 The following models are estimated for the observed time series of prices, LinX-prices, and LogX-prices, for Spain and Portugal. 1. Naive model: This is a basic forecast model based on past realizations of the price where no dummies are included. Following Nogales and Conejo (2006), we estimate: ˜Pd,h = ˜Pd−1,h    One-day lag +ϵd,h (8) which we call Naive. The forecast error is given by the difference between the two prices. 10 2. AR models: We follow Ziel and Weron (2018) and estimate two different standard autoregressive pro- cess models. A congestion dummy is also included. First, ˜Pt = β0 + p∑ i=1 βi ˜Pt−i    Autoregressive effects + βp+1 ¯Ct    Congestion dummy +εt (9) 9 This is a useful ad hoc construction. We also constructed the congestion dummy with different numbers of lags and found that the results did not change significantly. However, some information was added when the models were estimated. 10 There are alternative naive models that could be used. One consists of including as the forecast of Pd,h the price one week before, Pd−7,h. Another instead uses Pd−1,h for Mondays, Saturdays, and Sundays, and Pd−7,h for the other days (Ziel & Weron, 2018). However, these two models do not outperform the one proposed in our study. So we only report forecasts based on Eq. (8). 8 A. Ciarreta, B. Martinez and S. Nasirov International Journal of Forecasting xxx (xxxx) xxx which we call AR-t.11 We consider the maximum order pmax = 168 of the autoregressive parameters βi, which corresponds to a maximum of one week in the time series. The selection seeks to balance the tradeoff between parsimony and goodness of fit.12 We also estimate the following model: ˜Pd,h = βh,0 + qh∑ i=1 βh,i ˜Pd−i,h    Autoregressive effects + βh,qh+1 ¯Cd,h    Congestion dummy +εd,h (10) which we call AR-d-h, for each h = 1, . . . , 24. These models are estimated for each Spanish and Portuguese price and for the observed price, LinX price, and LogX price, separately. Optimal lags, p and qh, are chosen using the Akaike information criterion (AIC). 3. Vector autoregressive (VAR) models: These are stochastic process models that capture the linear interdependencies between multiple time series. They follow from the fact that the price in Spain and the price in Portugal are determined simulta- neously. We estimate a VAR model of order p with a congestion dummy as an exogenous variable as follows: ˜Pt = B0 + p∑ i=1 Bi ˜Pt−i + Bp+1Ct + Et (11) where ˜Pt is the 2 × 1 vector of prices, B0 is a (2×1) vector of intercepts, Bi is a time-invariant (2 × 2) matrix, one for each lag i = 1, . . . , p, Bp+1 is a (2 × 1) vector of congestion dummies, and εt is a (2 × 1) vector of error terms. We call this model VAR-t. We also estimate the following model: ˜Pd,h = Bh,0 + qh∑ i=1 Bh,i ˜Pd−i,h + Bh,qh+1Cd,h + Ed,h (12) where ˜Pd,h is the 2 × 1 vector of prices, Bh,0 is a (2 × 1) vector of intercepts, Bh,i is a time-invariant (2 × 2) matrix, Bh,qh+1 is a (2 × 1) vector of conges- tion dummies, and εd,h is a (2 × 1) vector of error terms, for each h = 1, . . . , 24. We call this model VAR-d-h. 4. ARX model: This model is based on the fARX model proposed by Ziel and Weron (2018): 11 We also estimated a parsimonious AR model within the class of Expert models, as suggested in Ziel and Weron (2018) for MIBEL. However, the model did not outperform the more general AR(p) model. So we do not report the results for it. Those results are, however, available upon request as supplementary material. 12 We tested lags of up to one month, but there was overfitting, and the out-of-sample forecasts were frequently worse. As such, we decided to restrict the maximum number of lags to seven days. ˜Pd,h = β + 24∑ h=1 p∑ i=1 βh,i ˜Pd−i,h    Autoregressive effects + βh,24p+1 ¯Cd,h    Congestion dummy +εd,h (13) Unlike the previous models estimated, this one as- sumes the existence of interdependencies between hours. It is estimated using the lasso proposed by Tibshirani (1996), where the penalty is obtained using the adaptive lasso proposed by Zou (2006). In general, the lasso shrinks to zero the coefficients of those explanatory variables which are redundant in models that have rich structures, such as (13). In particular, we chose the adaptive lasso because it is a sequence of cross-validation lassos, where each is at least as parsimonious as the previous one. 5.3. Coefficient forecasts of the LinX-Model and the LogX- Model We forecast the structural parameters of the LinX- Model and the LogX-Model to obtain price forecasts. In this case, prices are forecasted in two stages: first, we forecast the structural parameters of both models; then, we obtain equilibrium prices as the intersection of the demand and supply functions of the LinX-Model and the LogX-Model. Recall that in the LinX-Model, there are four parameters for forecasting for each hour and each market: Y = ( a0,h, a1,h, b0,h, b1,h) . In the Log-Model, there are eight: Y = (a0,h, a1,h, a2,h, a3,h, b0,h, b1,h, b2,h, b3,h). We estimate the same family of models as for prices, except for the Naive model. 1. AR models: These models involve estimating each structural parameter separately, so for each param- eter y ∈ Y , we estimate the following models: ˜yt = γ0 + p∑ i=1 γi˜yt−i    Autoregressive effects + γp+1 ¯Ct    Congestion dummy +εt (14) which we call AR-Coef-t. We also consider the same maximum order of p to be 168. This selection is based on the similar time structure of prices and coefficients. ˜yd,h = γh,0 + qh∑ i=1 γh,i˜yd−i,h    Autoregressive effects + γh,qh+1 ¯Cd,h    Congestion dummy +εd,h (15) which we call AR-Coef-d-h, for each h = 1, . . . , 24. Optimal lags are chosen using the AIC. 2. Vector autoregressive (VAR) models: The VAR model differs depending on what assump- tions are made on the interaction between demand and supply. Based on the theoretical model, we 9 A. Ciarreta, B. Martinez and S. Nasirov International Journal of Forecasting xxx (xxxx) xxx estimate the demand and supply parameters sepa- rately for each market. That is, we use the informa- tion contained in previous values of the structural parameters estimated to forecast future values. The vector autoregressive (VAR) model to be estimated for every t and number of parameters J is: ˜yt = Γ0 + p∑ i=1 Γi˜yt−i + Γp+1Ct    Congestion dummy +Et (16) where Γ0 is a (J × 1) vector of intercepts, Γi is a time-invariant (J × J) matrix, one for each lag i = 1, . . . , p, Γp+1 is a (J × 1) vector of congestion dummies, and Et is a (J × 1) vector of error terms. We call this model VAR-Coef-t. ˜yd,h = Γh,0 + qh∑ k=1 Γh,i˜yd−i,h + Γh,qh+iCd,h    Congestion dummy +Ed,h (17) where Γh,0 is the (J × 1) vector of intercepts, and Γh,i is a (J × J) and Ed,h is a (J × 1) vector of error terms, for each h = 1, . . . , 24. We call this model VAR-Coef-d-h. 3. ARX model: This model has the same structure as (13) but for coefficients. ˜yd,h = β  Constant + 24∑ h=1 p∑ i=1 βh,i˜yd−i,h    Autoregressive effects + βh,24p+1 ¯Cd,h    Congestion dummy ϵd,h (18) We call this model ARX-Coef. Eq. (18) is also esti- mated by adaptive lasso for each coefficient. 5.4. Accuracy metrics We measure the accuracy of all the models using the mean absolute error (MAE), root mean square error (RMSE), and Theil’s U statistic (Theil’s U). These scale measures are useful when comparing different forecasting methods applied to data with the same scale. The RMSE is based on the square root of the weighted daily difference in the squared deviation between the observed price and the predicted price: RMSE =    √ 1 T T∑ t=1 [ 1 H H∑ h=1 ( Pt,h − ˆPt,h)2] . (19) The RMSE has the benefit of penalizing large errors. The MAE is based on the weighted daily difference in the deviation in absolute value between the observed price and the predicted price: MAE = 1 T T∑ t=1 [ 1 H H∑ h=1 ⏐ ⏐Pt,h − ˆPt,h⏐ ⏐ ] (20) This measure fails to punish large errors in prediction. Theil’s U statistic can be considered the RMSE of the fore- cast model divided by the RMSE of the naive model, given by ˜Pt,h = Pt−1,h. It takes a value of 1 if the forecasting method is no more accurate than a naive forecast. If it is less than 1, the forecasting method is more accurate than a naive forecast, and vice versa: Theil ′s U =    √ ∑T t=1 (( Pt,h − ˆPt,h) /Pt,h)2 ∑T t=1 (( Pt,h − ˜Pt,h) /Pt,h)2 (21) Finally, we perform the Diebold–Mariano test (Diebold & Mariano, 1995) to determine whether forecasts differ significantly between pairs of models. We anticipate the possibility that different models may have similar values in the selected error measures, in which case it cannot be concluded that one model is superior to the other. Given the observed series of prices, Pt,h, and two competing predictions, ˆP 1 t,h and ˆP 2 t,h, we select the mean absolute error as the loss criterion. 13 The null hypothesis is that the two forecasts have the same accuracy. 6. Empirical results We carry out our analysis for the period from January 1st, 2015 to December 31st, 2019 using data published by (OMIE, 2015–2019) . We begin with the in-sample prop- erties of the structural parameters estimated, in order to test the goodness of fit of each model. Then, we forecast prices using a rolling window approach. 6.1. LinX-Model and LogX-Model estimation Before estimating the model, we summarize the extent of market coupling/splitting during the sample period, be- cause this affects the forecast of the structural parameters. Table 1 reports yearly average prices and the percentage of the hours of the year, %H, at which there is either mar- ket coupling or market splitting (with standard deviations reported in parentheses). Throughout the sample period, there is market cou- pling in around 94.13% of the trading hours. Market in- tegration has increased greatly thanks to an increase in interconnections that has reduced congestion between two nodes.14 In 2007, the transaction capacity from (to) Portugal to (from) Spain was in the range of 250–1700 MW (0–1600 MW), but by 2019, it had increased to 2400– 3200 MW (3400–3600 MW). Moreover, for the whole sample, when there is market splitting, there are more hours in which the price is higher in Spain (3.1%) than in Portugal than vice versa (2.4%). This is the result of the differences in the cost structures of the generation systems in each country. 13 Other loss criteria, such as squared error or mean absolute percentage error, could be used. In this paper, we restrict our analysis to the mean absolute error. 14 In Fig. A.1, Appendix, we plot the time-varying correlation coefficient between P SP and P PT during the sample period, where a strong positive correlation in most time intervals becomes evident. 10 A. Ciarreta, B. Martinez and S. Nasirov International Journal of Forecasting xxx (xxxx) xxx Table 1 Market coupling and market splitting. Year Coupling Splitting Splitting %H P SP = P PT %H P SP > P PT %H P SP < P PT 2015 97.58 50.67 0.14 53.96 51.89 2.28 35.14 39.78 (12.00) (8.16) (7.86) (17.71) (16.38) 2016 91.80 39.83 6.98 40.10 36.03 1.22 25.13 29.57 (14.97) (12.30) (12.84) (15.67) (15.00) 2017 93.31 52.83 2.19 62.67 59.77 4.50 34.81 41.57 (11.37) (11.84) (11.21) (15.44) (13.01) 2018 94.79 57.99 1.97 60.82 57.02 3.23 34.77 41.93 (12.06) (8.10) (9.35) (15.35) (10.89) 2019 94.83 47.89 0.99 44.45 42.53 4.18 43.64 48.59 (10.61) (22.21) (22.16) (12.01) (11.04) %H: Percentage of hours of the year. P SP : Price in Spain. P PT : Price in Portugal. Standard deviation in parentheses. Fig. 5. Demand and supply fits. (For interpretation of the references to colour in this figure legend, the reader is referred to the web version of this article.) Source: Own work. We fit linear demand and supply functions (Eqs. (1) and (3)) and logistic demand and supply functions (Eqs. (2) and (4)) for each hour. There are hours where it is not possible to fit functional forms because there are not enough block-bids in the selling bids, in the purchasing bids, or in both. In particular, in the linear case, there must be at least two observations, and in the logistic case, there must be at least four. This is not a problem in the case of market coupling, but in market splitting for the Portuguese pole, there are 278 hours in which there are more than two but fewer than five block-bids. In those cases, we use the linear fit rather than the logistic fit. Fig. 5 plots observed complex demand bids (thin red lines) and observed complex supply bids (thin blue lines) against the linear and logistic fits (thick lines) at 9:00 p.m. on September 12th, 2019 as a representative time and day with no transmission congestion. Recall that our goal is to forecast prices in the day-ahead market, so only complex bids are used in the estimation. According to market activity rules, the method of con- nection for both ascending and descending orders is stairstep-up first. Given the estimated coefficients, we substitute the maximum total quantity for each bid price in either functional form. As shown in Section 2, on average there are fewer demand bids than supply bids. In this particular example, there were 63 different prices on the demand side and 228 on the supply side. This explains the shape of the fitted curves in Fig. 5. The observed price is e44.07/MWh, the price using the lin- ear fits is e51.66/MWh (a difference in absolute value of e7.59/MWh), and the price using the logistic fits is e41.11/MWh (a difference in absolute value of e2.96/MWh). To assess the goodness of fit for the whole sample, Table 2 summarizes the estimated demand co- efficients for each functional specification, Akaike infor- mation criterion (AIC), and Bayesian information criterion (BIC). 15 Under the AIC and BIC, the linear demand fit outper- forms the logistic demand fit for SP, PT, and MI, while the logistic supply fit outperforms the linear fit. Recall that 15 Appendix, Table A.1 reports descriptive statistics of the complex demand and supply bids. Summary statistics of the estimated demand and supply coefficient fits under each functional specification are available in Appendix, Table A.2.1 and Table A.2.2, respectively. 11 A. Ciarreta, B. Martinez and S. Nasirov International Journal of Forecasting xxx (xxxx) xxx Table 2 Goodness of fit. Linear Logistic Splitting Coupling– Splitting Coupling SP PT MI SP PT MI Supply AIC 772.0 198.1 1052.0 547.5 192.9 822.8 BIC 777.3 200.4 1058.1 558.2 198.2 835.2 Demand AIC 462.4 149.6 443.4 523.4 162.4 517.2 BIC 466.8 151.3 447.8 532.4 166.2 526.1 AIC: Akaike information criterion. BIC: Bayesian information criterion. SP: Spain. PT: Portugal. MI: Mibel. Mean values reported. Standard deviations in parentheses. Fits under market splitting (coupling) include 2427 (41,397) h. the AIC and BIC penalize the inclusion of more parameters to be estimated; the values of both criteria also depend on the sample size, with BIC penalizing the inclusion of parameters more than the AIC if the sample is large. 16 Finally, Fig. 6 shows the time series of the coefficients estimated under each specification. The first four figures correspond to the coefficients of the LinX-Model, and the following eight correspond to the coefficients of the LogX-Model. In short, these figures show time dependency in the estimated coefficients no matter what functional speci- fication is used. The dynamic nature of the coefficients follows that of the prices (see Fig. 4). Table 3 summarizes the yearly average observed prices and average estimated prices using the LinX-Model and the LogX-Model, respectively. The extent to which these two specifications replicate market outcomes accurately using goodness-of-fit measures is also assessed. 17 Table 3 reveals differences in the fitting performance of each model. Overall, the MAE and RMSE criteria indi- cate that the LogX-Model outperforms the LinX-Model in terms of price prediction. Observe that the standard de- viations are lower for the LogX-Model than for the LinX- Model. According to Theil’s U statistic, the logistic fit for both poles and the linear fit for the Portuguese pole out- perform the benchmark naive model as defined in (21). Thus, in-sample analysis indicates that the LogX-Model performs better than the LinX-Model. 6.2. Forecasts Accuracy in forecasting electricity prices is critical to reduce the risk of under- or overestimating revenue from generators for power companies and costs for end-demand 16 These results hold at the hourly level. That is, on average, the linear fit outperforms the logistic fit complex demand bids under both criteria and, by contrast, the logistic fit outperforms the linear fit for complex supply bids under both criteria. The results are available upon request as supplementary material. 17 Table A.4 in Appendix reports the results of Kolmogorov–Smirnov tests of the equality of distributions. For both functional form spec- ifications, the null hypothesis of an equal distribution of prices is rejected. providers, which in turn makes for better risk manage- ment. Forecast errors have significant implications for profits, market shares, and shareholder value in the short run, and for regulatory dynamics in the longer term. We use a two-year rolling window forecast approach. January 1st, 2015 to December 31st, 2016 is the training period for the models presented in Section 5. 18 We then forecast the prices for the period from January 1st, 2017 to December 31st, 2019 by adding one future observation and removing the initial one until the end of the sample. 19 Table 4 reports the forecasting performance of the models using MAE and RMSE criteria for one-day-ahead forecast of prices in Spain and Portugal. These two criteria enable us to set up a ranking of the models. Panels (A)–(C) refer to the time series models for the observed prices, LinX-Model prices, and LogX-Model prices, respectively (see Section 5.2). Panels (D) and (E) show the values when prices are obtained as the intersection of the predicted functional forms after forecasting the coefficients of these models (see the models in Section 5.3). We look first at the performance of the models in panels (A), (B), and (C). We find that the family of naive models for P, LinX-P, and LogX-P perform worse than the rest of the models for the same variables. Note that this is particularly true for the Naive LinX-P model. Naive models do not capture price dynamics accurately. The forecast performance of the models for P outperforms the same model for LogX-P, which in turn outperforms that for LinX-P. Under the MAE criterion, the best forecasting model for prices in both poles is VAR-t P. However, the RMSE criterion selects ARX P for the Spanish pole and VAR-t P for the Portuguese pole. A comparison of the forecast performance of the mod- els in panels (D) and (E) shows that the LogX-Model outperforms the LinX-Model. We therefore concentrate our analysis on the models in panel (E). The MAE crite- rion selects the VAR-Coef-d-h to forecast prices in the Spanish pole and the ARX-Coef for the Portuguese pole. The RMSE criterion selects instead VAR-Coef-t as the best forecasting model.20 A comparison of panels (A) and (E) under the MAE and for the Spanish pole shows that the VAR-Coef-d-h, where the forecast is on the coefficients of the LogX-Model, outperforms the other models. On average, the forecasting 18 We previously conducted augmented Dickey–Fuller (ADF) and Phillips and Perron (PP) stationarity tests on the observed prices and estimated parameters, respectively. Both tests rejected the null hypothesis of a unit root. The results are reported in Table A.5.1 and Table A.5.2 in Appendix. 19 There are determinants in the short-run functioning of the market that can induce structural breaks. For instance, De Marcos et al. (2020) show that the most significant dataset in the episodic, recurrent nature of electricity dynamics may not be the most recent. We did not implement their approach because it departs to a large extent from the goal of the paper. Instead, we tried different window sizes (one year, and six months) and found that the results did not change qualitatively. We take this point for future research. 20 We apply the eigenvalue stability condition after estimating the parameters of the different VAR models, as per Lütkepohl (2005). All the eigenvalues lie inside the unit circle, so the models are stable and the impulse-response functions can be interpreted. The results are available upon request as supplementary material. 12 A. Ciarreta, B. Martinez and S. Nasirov International Journal of Forecasting xxx (xxxx) xxx Fig. 6. Time series of the Lin-X and Log-X models’ estimated coefficients. 13 A. Ciarreta, B. Martinez and S. Nasirov International Journal of Forecasting xxx (xxxx) xxx Table 3 Descriptive statistics for prices. Observed LinX LogX P SP P PT P SP P PT P SP P PT 2015 50.32 50.43 50.90 51.17 48.89 49.24 (12.37) (12.22) (14.98) (14.99) (12.59) (12.48) 2016 39.66 39.44 42.59 42.51 42.51 38.33 (14.90) (14.90) (15.32) (15.39) (14.73) (15.08) 2017 52.24 52.48 53.75 54.25 49.79 50.32 (12.28) (11.73) (15.11) (14.41) (12.58) (12.45) 2018 57.29 57.45 59.46 59.94 55.10 55.77 (12.80) (12.31) (17.45) (16.75) (12.25) (13.18) 2019 47.68 47.87 49.93 50.46 46.30 46.51 (10.88) (10.81) (14.14) (14.00) (10.61) (11.41) RMSE 7.94 7.93 3.32 5.16 MAE 5.28 5.11 2.54 2.91 Theil-U 1.98 0.69 0.05 0.01 SP: Spain. PT: Portugal. MI: Mibel. LinX: Linear Fits. LogX: Logistic Fits. RMSE: Root Mean Square Error. MAE: Mean Absolute Error. Mean values reported. Standard deviations in parentheses. Number of observations: 43824. error is e2.51/MWh, compared to e3.36/MWh for VAR- t P. In the case of the Portuguese pole, the ARX-Coef is selected with the logistic fit and dominates the rest of the models, with an average forecasting error of e2.89/MWh, compared to e3.71/MWh for VAR-t P. The RMSE criterion results are consistent with those of the MAE. Therefore, differences in the performance are obtained with respect to models that use only observed prices as covariates. From this criterion, our results favor using information content on bid data to forecast electricity prices one day ahead. We perform the DM test, choosing the MAE as the loss function for the null hypothesis of the same accuracy of the different pairs of competing forecast models. We focus our discussion by presenting the results for the best models that use prices as covariates and those that use coefficients as covariates. We then determine the best price models in panels (A), (B), and (C). In this case, under the DM, the models selected are VAR-t P, VAR-d-h P, and ARX P. From the coefficient models in panels (D) and (E), VAR-Coef-t LogX-P, VAR-Coef-d-h LogX-P, and ARX-Coef LogX-P are selected. Tables 5 and 6 report the statistics (p-values in parentheses) for Spain and Portugal, respectively. Note that a negative test result means that the model in the row performs better than the model in the column. Our results support the superiority of the LogX-Model with respect to the rest of the models. To forecast electric- ity prices in the Spanish pole, the VAR-COEF-t LogX-P, the VAR-COEF-d-h LogX-P, and the ARX-COEF-d-h LogX-P are the preferred models. For the Portuguese pole, there are no significant differences in forecasting ability between the VAR-COEF-d-h LogX-P and the ARX-COEF-d-h LogX-P models. Finally, we provide accuracy results for the whole fore- casting period from January 1st, 2017 to December 31st, 2019, showing how the different models perform on an hourly basis. We select the best models (green in Table 4): VAR-t P, VAR-d-h P, ARX P, VAR-Coef-t LogX-P, VAR-Coef- Table 4 MAE and RMSE for the considered models. Spain Portugal MAE RMSE MAE RMSE Naive P 5.33 7.87 5.11 7.38 AR-t P 3.88 5.23 3.72 6.12 (A) AR-d-h P 4.27 6.18 4.44 6.01 VAR-t P 3.36 5.11 3.71 4.98 VAR-d-h P 4.16 5.76 4.23 6.07 ARX P 3.57 5.07 3.82 5.98 Naive LinX − P 8.69 11.3 8.37 10.85 AR-t LinX − P 5.36 6.23 5.21 7.11 (B) AR-d-h LinX − P 6.11 7.49 6.14 7.03 VAR-t LinX − P 5.12 6.99 5.19 6.89 VAR-d-h LinX − P 5.98 6.98 6 7.23 ARX LinX − P 5.26 6.11 5.23 6.27 Naive LogX − P 6.06 8.37 6.21 9.12 AR-t LogX − P 4.67 5.97 4.98 6.52 (C) AR-d-h LogX − P 5.55 7.1 5.46 6.46 VAR-t LogX − P 4.38 6.03 4.88 5.97 VAR-d-h LogX − P 5.21 6.02 5.34 6.89 ARX LogX − P 4.49 5.89 4.96 6.23 AR-Coef-t LinX − P 6.88 9.73 7.23 7.77 AR-Coef-d-h LinX − P 6.05 8.92 5.29 7.28 (D) VAR-Coef-t LinX − P 5.99 8.65 4.57 6.23 VAR-Coef-d-h LinX − P 4.94 6.12 4.48 6.01 ARX-Coef LinX − P 4.98 6.09 4.12 5.89 AR-Coef-t LogX − P 4.89 5.73 5.03 6.01 AR-Coef-d-h LogX − P 3.98 6.31 3.81 4.91 (E) VAR-Coef-t LogX − P 2.79 3.38 3.97 3.29 VAR-Coef-d-h LogX − P 2.51 3.44 2.90 3.81 ARX-Coef LogX − P 2.73 3.49 2.89 3.76 d-h LogX-P, and ARX-Coef LogX-P. In Fig. 7, panel (a) is for the Spanish pole, and panel (b) for the Portuguese pole. To summarize, we found that the LogX-Model im- proves price forecasting with respect to time series mod- els of prices. That is, fitting hourly logistic curves as de- fined in Eqs. (2) and (4) and then forecasting coefficients using several time series models to obtain equilibrium 14 A. Ciarreta, B. Martinez and S. Nasirov International Journal of Forecasting xxx (xxxx) xxx Table 5 DM for Spain. Naive P VAR-t P VAR-d-h P ARX P VAR-Coef-t LogX-P VAR-Coef-d-h LogX-P ARX-Coef LogX-P Naive P 18.25 10.12 13.41 22.32 26.42 21.98 (0.000) (0.000) (0.000) (0.000) (0.000) (0.000) VAR-t P −5.12 −2.16 7.36 11.22 8.14 (0.000) (0.031) (0.000) (0.000) (0.000) VAR-d-h P 4.32 8.91 9.12 8.33 (0.000) (0.000) (0.000) (0.000) ARX P 5.96 6.08 5, 65 (0.000) (0.000) (0.000) VAR-Coef-t LogX-P 1.68 0.96 (0.093) (0.337) VAR-Coef-d-h LogX-P −1.12 (0.263) ARX-Coef LogX-P Table 6 DM for Portugal. Naive P VAR-t P VAR-d-h P ARX P VAR-Coef-t LogX-P VAR-Coef-d-h LogX-P ARX-Coef LogX-P Naive P 12.26 8.98 10.11 8.67 21.23 18.77 (0.000) (0.000) (0.000) (0.000) (0.000) (0.000) VAR-t P −4.43 −2.28 −1.46 11.22 12.14 (0.000) (0.023) (0.144) (0.000) (0.000) VAR-d-h P 4.32 3, 98 8.12 8.43 (0.000) (0.000) (0.000) (0.000) ARX P −1.59 10.12 8, 65 (0.112) (0.000) (0.000) VAR-Coef-t LogX-P 3.04 3.75 (0.002) (0.001) VAR-Coef-d-h LogX-P 0.62 (0.535) ARX-Coef LogX-P Fig. 7. MAEs for each of the 24 h. prices is an accurate alternative approach to price fore- casting. 7. Conclusions In recent years, electricity price forecasting using de- mand and supply curve-based methods has become a hot topic in the literature because of the significant economic implications of developing more accurate models. There are several advantages to using such approaches. One of their main strengths is that they reflect the mecha- nism of the so-called system marginal price, connecting to basic market principles and enabling real market behav- ior to be captured, with complicated dependencies and nonlinear properties that are hard to observe in other model approaches. Considering that the demand and sup- ply curves change over time, this information may help to capture price movements from the shape of these curves. 15 A. Ciarreta, B. Martinez and S. Nasirov International Journal of Forecasting xxx (xxxx) xxx Such methods in price forecasting are also becoming in- creasingly popular because of the availability of auction data. Our research revisited the topic of price forecasting based on real auction data from sale and purchase curves in electricity markets. The main novelty of this work was to propose a curve fitting approach to historical hourly demand and supply data in order to forecast electricity prices on the Iberian electricity market. The use of linear and logistic functions for the demand and supply curves for each hour replicated equilibrium prices accurately. These fits performed well at replicating observed data and capturing the linear and nonlinear characteristics of elec- tricity prices to estimate prices. The out-of-sample fore- casting study showed that these models are useful tools for forecasting prices; in particular, the logistic model outperformed the more simple linear approach. Our study can be further expanded in several direc- tions. The proposed methodology can be applied to other electricity markets with similar market designs. This is particularly evident for those markets involved in the Price Coupling of Regions initiative. Structural models specific to those markets can be estimated thanks to the increasing availability of data published by the respective market operators. Declaration of competing interest The authors declare that they have no known com- peting financial interests or personal relationships that could have appeared to influence the work reported in this paper. Acknowledgments This work was supported by the Basque Government through research grant IT1336-19; the Ministry of Econ- omy through research grants PID2019-108718GB-I00 and PID2019-107161GB-C32; ANID/FONDAP/15110019 (SERC- CHILE) and ANID/FONDECYT/11170424. Open access fund- ing provided by the University of the Basque Country. Finally, We are grateful to Cruz Angel Echevarria and Peru Muniain for their invaluable help. Appendix A.1. Descriptive statistics of complex bids, prices, and fitted prices Table A.1 summarizes information on the structure of demand and supply offers. Dh measures the mean (stan- dard deviation) demand at hour h at the price cap of e180.3/MWh. This is a measure of price-inelastic demand. Dh measures the mean (standard deviation) equilibrium demand at hour h. Sh measures the mean (standard de- viation) supply at hour h at e0/MWh, i.e. the minimum willingness to make supply offers. Sh measures the mean (standard deviation) equilibrium supply at hour h. Market rules do not set a price cap for supply offers, but the demand price cap works as an effective cap on supply Table A.1 Descriptive statistics of complex bids. Source: OMIE and own work. SP PT MI Demand Dh 15183.5 (3286.8) 6027.5 (1810.6) 20335.1 (4375.6) Dh 21564.9 (3399.7) 6726.9 (1576.8) 26871.1 (4740.1) Dh/Dh 0.70 0.90 0.76 Block-bids 73 (16) 18 (7) 71 (14) Supply Sh 12885.2 (2047.6) 3326.9 (1343.7) 15583.8 (2614.3) Sh 21564.9 (3399.7) 6726.9 (1576.8) 26871.1 (4740.1) Sh/Sh 0.60 0.49 0.58 Block-bids 120 (54) 27 (20) 174 (64) Fig. A.1. Rolling correlation between P SP and P PT . offers. Finally, we report the average number (standard deviation) of complex block-bids because these are used to set the equilibrium price. When there is market splitting, the average number of block-bids is lower in Portugal than in Spain. This is related to the market size effect. Regardless of whether there is market coupling or market congestion, the av- erage number of supply block-bids is higher than the average number of demand block-bids because there are substantially fewer purchasers than suppliers of electric- ity. The ratio of the intensity of demand to the maximum potential demand is high, at close to one in Portugal, which means that demand is quite inelastic. In a uniform-price auction system, the intersection between demand and supply offers (X-Model) determines the equilibrium price and the equilibrium quantity for each hour, under either market coupling or market split- ting (see Section 3 on modeling market curves). In the former case, the equilibrium price is the same in both markets, and in the latter, it is different. The level of inte- gration over time between the two markets can be illus- trated by plotting the rolling window correlation between observed system marginal prices in Spain and Portugal (see Fig. A.1). The choice of the window is W = 168, equivalent to seven days, rolling every hour. 16 A. Ciarreta, B. Martinez and S. Nasirov International Journal of Forecasting xxx (xxxx) xxx Table A.2.1 Summary statistics of demand fits. Coefficient Linear Logistic Splitting Coupling Splitting Coupling SP PT MI SP PT MI ˆa0 361.4 1537.2 409.0 24.78 36.68 34.52 (55.48) (1274.6) (74.67) (26.01) (33.19) (24.73) ˆa1 −0.0154 −0.2134 −0.0138 194.85 1518.0 182.5 (0.0034) (0.1632) (0.0034) (49.86) (1172.9) (45.29) ˆa2 . . . −0.0004 −0.0024 −0.0004 (0.0018) (0.0932) (0.0161) ˆa3 . . . 16069.8 5889.2 19889.6 (4143.5) (2186.6) (7054.2) PT: Portugal. MI: Mibel. Mean values reported. Standard deviations in parentheses. Fits under market splitting (coupling) include 2427 (41,397) h. Table A.2.2 Summary statistics of supply fits. Coefficient Linear Logistic Splitting Coupling Splitting Coupling SP PT MI SP PT MI ˆb0 −103.8 −80.2 −110.0 0.0875 −9.0915 −1.7998 (64.92) (241.45) (49.64) (4.66) (18.72) (5.97) ˆb1 0.0072 0.0219 0.0027 44.16 55.28 51.95 (0.0042) (0.0526) (0.0027) (13.38) (27.69) (16.96) ˆb2 . . . 0.0020 0.0128 0.0013 (0.0016) (0.0382) (0.0011) ˆb3 . . . 18275.4 4538.8 21909.7 (2596.03) (1774.07) (3681.95) PT: Portugal. MI: Mibel. Mean values reported. Standard deviations in parentheses. Fits under market splitting (coupling) include 2427 (41,397) h. Table A.3 Jarque–Bera normality tests statistics on de-median variables. Variable ES PT MI P 2989 ∗∗∗ 2594 ∗∗∗ 2884∗∗∗ a0 3.2e+04∗∗∗ 1.3e+07∗∗∗ 3.8e+05∗∗∗ a1 1.6e+04∗∗∗ 6.8e+06∗∗∗ 2.1e+04∗∗∗ b0 4.9e+05∗∗∗ 3.7e+09∗∗∗ 5.4e+06∗∗∗ b1 3.2e+05∗∗∗ 9.1e+09∗∗∗ 6.6e+06∗∗∗ α0 3552 ∗∗∗ 1.1e+04∗∗∗ 9662∗∗∗ α1 4232 ∗∗∗ 2.6e+10∗∗∗ 1.6e+5 ∗∗∗ α2 1.1e+04∗∗∗ 1.2e+07∗∗∗ 1.3e+05∗∗∗ α3 882.2 ∗∗∗ 5537∗∗∗ 2215.2∗∗∗ β0 1.7e+06∗∗∗ 8.8e+06∗∗∗ 2.2e+06∗∗∗ β1 1.5e+04∗∗∗ 3.2e+04∗∗∗ 1.8e+04∗∗∗ β2 4.5e+05∗∗∗ 2.0e+10∗∗∗ 6.5e+06∗∗∗ β3 666.6 ∗∗∗ 3.0e+04∗∗∗ 1.1e+04∗∗∗ *** 1% critical value. Table A.4 Kolmogorov–Smirnov test results. Linear Logistic D p-value D p-value P PT 0.123 0.000 0.001 1.000 EP PT −0.007 0.462 −0.101 0.000 Combined K-S 0.123 0.000 0.101 0.000 P SP 0.099 0.000 0.001 0.982 EP SP −0.046 0.000 −0.085 0.000 Combined K-S 0.0996 0.000 0.085 0.000 D: Difference between the distribution functions. Table A.5.1 ADF stationarity test, Z(t). P SP −8.422 ∗∗∗ P PT −8.030 ∗∗∗ Linear Logistic SP PT SP PT a0 −9.393 ∗∗∗ −17.963 ∗∗∗ −7.282 ∗∗∗ −7.451 ∗∗∗ a1 −13.085 ∗∗∗ −18.615 ∗∗∗ −8.247∗∗∗ −24.018 ∗∗∗ a2 −18.868 ∗∗∗ −21.180 ∗∗∗ a3 −7.649∗∗∗ −8.429 ∗∗∗ b0 −15.079 ∗∗∗ −16.699 ∗∗∗ −15.557 ∗∗∗ −16.563 ∗∗∗ b1 −14.855 ∗∗∗ −21.405 ∗∗∗ −8.369 ∗∗∗ −8.320 ∗∗∗ b2 −15.746 ∗∗∗ −21.792∗∗∗ b3 −14.210 ∗∗∗ −16.634∗∗∗ 1% critical value: −3.960. 5% critical value: −3.410. 10% critical value: −3.120. Observe that the correlation coefficient is close to one. The minimum is 0.7 and the maximum is 1. Moreover, in 31,294 of the 43,657 windows, the correlation is strictly greater than 0.99, which means strong positive correla- tion in most time intervals. A.2. Summary statistics of demand and supply fits See Tables A.2.1 and A.2.2. A.3. Normality tests We perform a goodness-of-fit test of whether the data have skewness and kurtosis that match those of a normal 17 A. Ciarreta, B. Martinez and S. Nasirov International Journal of Forecasting xxx (xxxx) xxx Table A.5.2 PP stationarity tests, Z(p) and Z(t). P SP −1183.192 ∗∗∗ −24.523 ∗∗∗ P PT −1148.485 ∗∗∗ −24.155 ∗∗∗ Linear Logistic SP PT SP PT a0 −6789.6 ∗∗∗ −59.2 ∗∗∗ −41336.0∗∗∗ −151.1 ∗∗∗ −25308.3 ∗∗∗ −113.7 ∗∗∗ −34441.1 ∗∗∗ −132.7∗∗∗ a1 −3461.1 ∗∗∗ −42.2 ∗∗∗ −39903.6∗∗∗ −148.4 ∗∗∗ −54666.9 ∗∗∗ −167.6 ∗∗∗ −31487.6 ∗∗∗ −152.5∗∗∗ a2 −53027.9 ∗∗∗ −177.8 ∗∗∗ −62852.3 ∗∗∗ −196.0 a3 −1051.1 ∗∗∗ −23.1∗∗∗ −8813.3∗∗∗ −67.1 ∗∗∗ b0 −31238.3∗∗∗ −127.3 ∗∗∗ −33796.3∗∗∗ −133.5 ∗∗∗ −61606.0 ∗∗∗ −180.4 ∗∗∗ −70322.6 ∗∗∗ −206.7∗∗∗ b1 −29879.2∗∗∗ −124.5 ∗∗∗ −22793.4∗∗∗ −112.6 ∗∗∗ −13258.9 ∗∗∗ −82.3 ∗∗∗ −21722.1 ∗∗∗ −105.4∗∗∗ b2 −16185.2 ∗∗∗ −92.2 ∗∗∗ −46902.0 ∗∗∗ −172.8∗∗∗ b3 −3503.7 ∗∗∗ −42.5∗∗∗ −20192.3 ∗∗∗ −103.5∗∗∗ 1% critical value for Z(t): −3.960. 5% critical value for Z(t): −3.410. 10% critical value for Z(t): −3.120. distribution. It is a joint hypothesis of the skewness being zero and the excess kurtosis being zero. Conclusion: According to the Jarque–Bera test, the null hypothesis that prices and estimated parameters are drawn separately from normal distributions can be rejected. A.4. Kolmogorov–Smirnov test of the equality of prices and fitted prices The goal is to determine whether prices, LinX prices, and LogX prices are the result of the same distribution function, so the Kolmogorov–Smirnov two-sample test of the equality of distributions is performed, where the null hypothesis is the equality of distributions.21 Table A.4 reports the results of this Kolmogorov–Smirnov test. The first line tests the hypothesis that the system marginal price contains lower values than the estimated linear or logistic figures. The largest difference between the distribution functions is 0.123 with a p-value of 0.000 in the linear case, which is significant, and 0.001 with a p-value of 1.000 in the logistic case, which is not sig- nificant. The second line tests the hypothesis that the system marginal price contains higher values than the estimated linear or logistic figures. The largest difference between the distribution functions in this direction is 0.007 with a p-value for this small difference of 0.462 in the linear case, which is not significant, and 0.101 with a p-value of 0.000 in the logistic case, which is significant. Finally, the approximate p-value for the combined test is 0.000 in both cases. The p-value is lower than the chosen significance level of 0.01, so the null hypothesis of the equal distribution of prices is rejected. 21 We also performed (Goldman & Kaplan, 2018) equality of distri- bution tests. The results did not differ significantly from those of the Kolmogorov–Smirnov tests, and are available upon request. A.5. Stationarity test Augmented Dickey–Fuller (ADF ) test: The null hy- pothesis is that there is a unit root (non-stationary) and the alternative hypothesis is no unit root (stationary). The null hypothesis is rejected for a given significance level when the test statistic is lower than the corresponding critical values. The Bayesian information criterion (BIC) determines the optimal lag-length. Conclusion: According to the ADF, the prices and es- timated parameters are stationary. Therefore, the VAR methodology can be used. Phillips and Perron (PP) test: The null hypothesis is that the variable contains a unit root, and the alternative is that a stationary process generated the variable. The PP test also involves fitting the previous model equation, so the results are used to calculate the test statistics. Phillips and Perron propose two alternative statistics. The PP test statistics are seen as a Dickey–Fuller-type statistic robust to serial correlation by using the Newey and West (1987) heteroskedasticity- and autocorrelation-consistent covariance matrix estimator. Conclusion: According to PP, the prices and estimated parameters are stationary. The VAR methodology can thus be used. References Aineto, D., Iranzo-Sánchez, J., Lemus-Zuñiga, L. G., Onaindia, E., & Urchuegua, J. F. (2019). On the influence of renewable energy sources in electricity price forecasting in the Iberian market. Energies, 12(11), 2082. Andrade, J. R., Filipe, J., Reis, M., & Bessa, R. J. (2017). Probabilistic price forecasting for day-ahead and intraday markets: Beyond the statistical model. Sustainability, 9(11), 1990. Baldick, R. (2012). Wind and energy markets: A case study of Texas. IEEE System Journals, 6(1), 27–34. Benth, F. E., Kiesel, R., & Nazarova, A. (2012). A critical empirical study of three electricity spot price models. Energy Economics, 34(5), 1589–1616. 18 A. Ciarreta, B. Martinez and S. Nasirov International Journal of Forecasting xxx (xxxx) xxx Brancucci Martínez-Anido, C., Brinkman, G., & Hodge, B.-M. (2016). The impact of wind power on electricity prices. Renewable Energy, 94, 474–487. Cabral, J. A., Cabral, M. V., & Pereira Junior, A. O. (2020). Elasticity estimation and forecasting: An analysis of residential electricity demand in Brazil. Utility Policy, 66, 101–108. Canale, A., & Vantini, S. (2016). Constrained functional time series: Applications to the Italian gas market. International Journal of Forecasting, 32(4), 1340–1351. Catalao, J., Marianova, S., Mandesb, V., & Ferreirac, L. (2007). Short- term electricity prices forecasting in a competitive market: A neural network approach. Electric Power System Research, 77, 1297–1304. Ciarreta, A., & Zarraga, A. (2017). Modeling realized volatility on the spanish intra-day electricity market. Energy Economics, 58, 152–163. Cizek, P., Härdle, W., & Weron, R. (Eds.), (2011). Statistical tools for finance and insurance. Berlin: Springer. De Marcos, R. A., Bunn, D. W., Bello, A., & Reneses, J. (2020). Short-term electricity price forecasting with recurrent regimes and structural breaks. Energies, 13(5452). Díaz, G., & Planas, G. (2016). A note on the normalization of spanish electricity spot prices. IEEE Transactions on Power Systems, 31(3), 2499–2500. Diebold, F. X., & Mariano, R. S. (1995). Comparing predictive accuracy. Journal of Business & Economic Statistics, 13, 253–263. Figueiredo, N. C., da Silva, P. P., & Cerqueira, P. A. (2015). Evaluating the market splitting determinants: Evidence for the Iberian spot electricity prices. Energy Policy, 85, 218–234. Gao, W., Sarlak, V., Parsaei, M. R., & Ferdosi, M. (2018). Combination of fuzzy based on a meta-heuristic algorithm to predict electricity price in an electricity markets. Chemical Engineering Research and Design, 131, 333–345. Goldman, M., & Kaplan, D. M. (2018). Comparing distributions by mul- tiple testing across quantiles or CDF values. Journal of Econometrics, 206(1), 143–166. Hong, T., Pinson, P., Wang, Y., Weron, R., Yang, D., & Zareipour, H. (2020). Energy forecasting: A review and outlook. IEEE Open Access Journal of Power and Energy, 7, 376–388. Itaba, S., & Mori, H. (2017). A fuzzy-preconditioned GRBFN model for electricity price forecasting. Procedia Computer Science, 114, 441–448. Jabot, F. (2015). Why preferring parametric forecasting to nonparamet- ric methods? Journal of Theoretical Biology, 372, 205–210. Kulakov, S. (2020). X-model: Further development and possible modifications. Forecasting, 2(1), 20–35. Lago, J., De Ridder, F., & De Schutter, B. (2018). Forecasting spot elec- tricity prices: deep learning approaches and empirical comparison of traditional algorithms. Applied Energy, 221, 386–405. Lago, J., Marcjasz, G., De Schutter, B., & Weron, R. (2021). Fore- casting day-ahead electricity prices: A review of state-of-the-art algorithms, best practices and an open-access benchmark. Applied Energy, 293, Article 116983. Lütkepohl, H. (2005). New introduction to multiple time series analysis. Berlin: Springer Verlag. Mestre, G., Portela, J., San Roque, A. M., & Alonso, E. (2020). Forecasting hourly supply curves in the Italian day-ahead electricity market with a double-seasonal SARMAHX model. International Journal of Electrical Power & Energy Systems, 121, Article 106083. Newey, W. K., & West, K. D. (1987). Hypothesis testing with efficient method of moments estimation. International Economic Review, 28(3), 777–787. Nogales, F. J., & Conejo, A. J. (2006). Electricity price forecasting through transfer function models. Journal of the Operational Research Society, 57, 350–356. Nowotarski, J., & Weron, R. (2015). Computing electricity spot price prediction intervals using quantile regression and forecast averaging. Computational Statistics, 30, 791–803. Nowotarski, J., & Weron, R. (2018). Recent advances in electricity price forecasting: A review of probabilistic forecasting. Renewable and Sustainable Energy Reviews, 81(1), 1548–1568. OMIE (2015–2019). Market activity rules. Madrid, Spain. Ortiz, M., Ukar, O., Azevedo, F., & Múgica, A. (2016). Price forecasting and validation in the spanish electricity market using forecasts as input data. International Journal of Electrical Power & Energy Systems, 77, 123–127. Portela, J., Munoz, A., Sánchez-Úbeda, E. F., & García-González, R. (2017). Residual demand curves for modeling the effect of com- plex offering conditions on day-ahead electricity markets. IEEE Transactions on Power Systems, 32(1), 50–61. Shah, C., & Ghonasgi, N. (2016). Determinants and forecast of price level in India: A VAR framework. Journal of Quantitative Economics, 14, 57–86. Shah, I., & Lisi, F. (2020). Forecasting of electricity price through a functional prediction of sale and purchase curves. Journal of Forecasting, 39, 242–259. Simonsen, I. (2005). Volatility of power markets. Physica A. Statistical Mechanics and its Applications, 355(1), 10–20. Taylor, J. W., Menezes, L. M., & McSharry, P. (2006). Comparison of univariate methods for forecasting electricity demand up to a day. International Journal of Forecasting, 22(1), 1–16. Tibshirani, R. (1996). Regression shrinkage and selection via the lasso. Journal of the Royal Statistical Society: Series B, 58(1), 267–288. Ullrich, C. J. (2012). Realized volatility and price spikes in electric- ity markets: The importance of observation frequency. Energy Economics, 34, 1809–1818. Uniejewski, B., Weron, R., & Ziel, F. (2018). Variance stabilizing trans- formations for electricity spot price forecasting. IEEE Transactions on Power Systems, 33(2), 2219–2229. Unsihuay-Vila, C., Zambroni de Souza, A. C., Marangon-Lima, J. W., & Balestrassi, P. P. (2010). Electricity demand and spot price forecasting using evolutionary computation combined with chaotic nonlinear dynamic model. Electrical Power and Energy Systems, 32, 108–116. Weron, R. (2007). Modeling and forecasting electricity loads and prices: a statistical approach. Chichester, UK: Wiley. Weron, R. (2014). Electricity price forecasting: A review of the state- of-the-art with a look into the future. International Journal of Forecasting, 30(4), 1030–1081. Weron, R., & Ziel, F. (2019). Electricity price forecasting. In U. Soytas, & R. Sari (Eds.), Routledge handbook of energy economics, Vol. 2019 (pp. 506–521). Routledge. Yang, Z., Ce, L., & Lian, L. (2017). Electricity price forecasting by a hybrid model, combining wavelet transform, ARMA and kernel- based extreme learning machine methods. Applied Energy, 190, 291–305. Zareipour, H., Bhattacharya, K., & Canizares, C. (2007). Electricity market price volatility: The case of Ontario. Energy Policy, 35(9), 4739–4748. Ziel, F., & Steinert, R. (2016). Electricity price forecasting using sale and purchase curves: The X model. Energy Economics, 59, 435–454. Ziel, F., & Weron, R. (2018). Day-ahead electricity price forecasting with high-dimensional structures: Univariate vs. multivariate modeling frameworks. Energy Economics, 70, 396–420. Zou, H. (2006). The adaptive lasso and its oracle properties. Journal of the American Statistical Association, 101(476), 1418–1429. 19 View publication stats","libVersion":"0.3.2","langs":""}