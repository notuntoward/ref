{"path":"lit/lit_sources/Qu22AdaptiveNoiseReduction.pdf","text":"Citation: Qu, W.; Chen, G.; Zhang, T. An Adaptive Noise Reduction Approach for Remaining Useful Life Prediction of Lithium-Ion Batteries. Energies 2022, 15, 7422. https:// doi.org/10.3390/en15197422 Academic Editors: Haifeng Dai, Carlos Miguel Costa and Jingying Xie Received: 6 September 2022 Accepted: 6 October 2022 Published: 10 October 2022 Publisher’s Note: MDPI stays neutral with regard to jurisdictional claims in published maps and institutional afﬁl- iations. Copyright: © 2022 by the authors. Licensee MDPI, Basel, Switzerland. This article is an open access article distributed under the terms and conditions of the Creative Commons Attribution (CC BY) license (https:// creativecommons.org/licenses/by/ 4.0/). energies Article An Adaptive Noise Reduction Approach for Remaining Useful Life Prediction of Lithium-Ion Batteries Wenyu Qu 1,2, Guici Chen 1,2,* and Tingting Zhang 1,2 1 Hubei Province Key Laboratory of Systems Science in Metallurgical Process, Wuhan 430065, China 2 College of Science, Wuhan University of Science and Technology, Wuhan 430070, China * Correspondence: chenguici@wust.edu.cn; Tel.: +86-150-7115-6856 Abstract: Lithium-ion batteries are widely used in the electric vehicle industry due to their recyclabil- ity and long life. However, a failure of lithium-ion batteries can cause some catastrophic accidents, such as electric car battery explosion ﬁres and so on. To prevent such harm from occurring, it is essential to monitor the remaining useful life of lithium-ion batteries and give early warning. In this paper, an adaptive noise reduction approach is proposed to predict the RUL (Remaining Useful Life) of lithium-ion batteries, which uses CEEMDAN (Complete Ensemble Empirical Mode Decomposition with Adaptive Noise) combined with wavelet decomposition to achieve adaptive noise reduction de- composition, and then inputs the obtained IMF (Intrinsic Mode Function) components into LS–RVM (Least Square Relevance Vector Machine) for training, prediction, and reconstruction, so as to achieve high-precision prediction of RUL. Moreover, in order to verify the validity of the model, the model in this paper is compared with other common models. The results demonstrate that the RMSE, MAPE, and MAE of the proposed model are 0.008678, 0.005002, and 0.006894, and that it has higher accuracy than the other common prediction models. Keywords: battery; CEEMDAN; RVM; wavelet; RUL predictions 1. Introduction Lithium-ion batteries have the advantages of high energy density and low discharge rate, and they are widely used in energy storage devices and play an important role in areas such as transportation electriﬁcation and smart grids [1]. However, the failure of lithium-ion batteries can cause catastrophic accidents, such as electric car batteries exploding and catching ﬁre, aircraft parts failing, and so on [2,3]. With the increasing requirements for battery safety in related ﬁelds, it is very important to accurately predict the RUL of lithium-ion batteries and give early warning to reduce unnecessary losses. Therefore, it is of great signiﬁcance to develop a method that can accurately predict the RUL of lithium-ion batteries. The current RUL prediction of lithium-ion batteries can be mainly divided into model- based methods and data-driven methods [4]. However, the degradation of lithium-ion batteries is a complex electrochemical process, the modeling process of model-based meth- ods in practical situations is complicated, and the establishment of theoretical models is supported by expert knowledge, which makes the models not robust [5–7]. In order to simplify the complexity of the system with unmeasured variables and effectively simulate the health degradation trend of lithium-ion batteries, data-driven methods can be used to ensure the reliable and efﬁcient operation of the battery management system and avoid potential dangers caused by battery failure [8]. Wang et al. [9] proposed the method of RVM to predict and model the battery decay trajectory through online learning and, subsequently, many scholars combined RVM and other methods to predict the capacity decay trend [10–13]. MLP (Multilayer Perceptron) can capture the relationship between battery remaining life and other attributes [14], LSTM Energies 2022, 15, 7422. https://doi.org/10.3390/en15197422 https://www.mdpi.com/journal/energies Energies 2022, 15, 7422 2 of 18 (Long Short-Term Memory) can effectively describe the degradation characteristics of lithium-ion batteries [15], but it takes a lot of time to train [16]. SVMs (Support Vector Machines) have advantages on datasets with signiﬁcant capacity decay [17,18]. Chen et al. propose a transformer network for Remaining Useful Life Prediction of lithium-ion bat- teries [19]. However, the above methods ignore the inﬂuence of capacity proliferation on lithium-ion batteries. Some scholars try to use EMD (Empirical Mode Decomposition) combined with neural networks to predict the RUL of lithium-ion batteries [20]. Zhou et al. [21] pro- posed a method combining EMD and ARIMA (Autoregressive Integrated Moving Average model) to capture the local ﬂuctuations in the degradation process of lithium-ion batteries. Chen et al. [22] screened the components obtained by the EMD algorithm to improve pre- diction accuracy. However, the EMD method has some disadvantages [23], such as serious mode aliasing and end effect, and it cannot obtain reliable RUL estimation and prediction. Since the decline curve of capacity regeneration is different from the normal decline curve, Xu et al. [24] added the decline model of capacity regeneration to reduce the prediction error caused by the difference between the decline curve of capacity regeneration and the normal decline curve but ignored the inﬂuence of random ﬂuctuations. Wang et al. proposed a model combining VMD (Variational Mode Decomposition) [25], MLP, and LSTM to model the overall degradation trend and capacity regeneration component [26–28]. In addition, some scholars use stochastic processes to ﬁt the battery degradation process [29–31]. Fur- thermore, there are also some scholars who try to introduce health factors that can be used to predict the RUL of the lithium-ion battery. For instance, Wang et al. [32] proposed an in- direct health indicator extracted from the constant current charge process to aid prediction, and Lin et al. [33] extracted new indirect health indicators from the voltage and current curves during charging. Although EMD can decompose capacity regeneration trends and other random noise trends, the phenomenon of modal aliasing also appears by using EMD [34]. To address this problem, Wu and Huang proposed EEMD (Ensemble Empirical Mode Decomposition) [35], which reduced the reconstruction error by increasing the integration times. However, poor completeness and large amounts of calculation easily lead to the inefﬁcient decomposi- tion of EEMD. Thus, Torres. et al. proposed CEEMDAN [36–38], which added adaptive white noise at each stage of the decomposition, calculated a unique margin signal to ob- tain each IMF, and has a large enhancement of the decomposition efﬁciency compared with the EEMD algorithm. Nevertheless, it is still difﬁcult to avoid the interference of redundant components. For the existing problems in the above research, this paper proposes an adaptive noise reduction approach, which adopts CEEMDAN to decompose the original sequence to obtain multiple IMFs (including normal degradation trend, capacity regeneration trend, and random trend), and then inputs the IMF components into the wavelet transform, respectively, to reduce noise. Then, the denoised sequences are input into LS and RVR models for training and prediction according to the normal degradation trend and other trends. Finally, the obtained prediction components are reconstructed to obtain the ﬁnal prediction results, and RMSE, MAPE, and MAE are selected to evaluate the prediction effect of the model. The main contributions of this paper are detailed as follows: 1. The computation speed and the completeness of CEEMDAN has increased compared with EMD. 2. EMD may produce several low-frequency IMF components with small amplitudes, which have little signiﬁcance for the prediction results. Therefore, adopting the CEEMDAN method can reduce the number of these components. 3. To achieve high-precision prediction, wavelet transform is used to reduce noise and improve signal resolution for the IMF component of CEEMDAN, which contains some noise. Energies 2022, 15, 7422 3 of 18 4. Compared with other popular models, the proposed model is also very good at early prediction. Simple combinations of models are more accurate than complex ones. The rest of this paper is organized as follows. Section 2 presents the theoretical background of the proposed method. Section 3 describes the experimental analysis. A case study and comparative analysis are provided and discussed in Section 4. The conclusion is given in Section 5. 2. Theoretical Background This section describes the basic principles and speciﬁc steps of CEEMDAN, Wavelet Domain Denoising, LS, and RVM, as well as where these methods are applicable. 2.1. CEEMDAN Aiming at the problem of mode aliasing in the signal decomposed by the EMD algorithm, the EEMD algorithm adds random white noise to the signal to be decomposed to reduces the mode aliasing of EMD. In essence, white noise is a series of independent sequences which are added to the original data. The characteristics of white noise are used to amplify the degree of irrelevance of the modes that are difﬁcult to separate in the original data, so as to extract the original two inseparable modes. However, there is always a certain amount of white noise remaining in the modal components obtained by the signal decomposition algorithm, and different number of modes may be generated by the signal plus noise decomposition through EMD, which will affect the subsequent signal analysis and processing. CEEMDAN solves the above problems from two aspects: (1) The IMF component with auxiliary noise after EMD is added in each iteration; (2) EEMD is to carry out the overall average of the modal components obtained after empirical mode decomposition, while CEEMDAN is to carry out the overall average calcu- lation after the ﬁrst-order IMF component to obtain the ﬁnal ﬁrst-order IMF component, and then repeat the above operations for the residual parts. In this way, the transfer of white noise from high frequency to low frequency is effectively solved. In general, the CEEMDAN algorithm is to add a ﬁnite number of adaptive white noise at each stage of EMD. Assume that the k-th modal component obtained by CEEMDAN is I ˜MFk, Ej(·) is the j-th modal component obtained by EMD, wi is a Gaussian white noise signal satisfying the standard normal distribution, ϵk is the SNR (Signal-To-Noise Ratio), i = 1, 2, . . . , I is the number of white noise added, and x[n] is the signal to be partitioned. The steps of CEEMDAN are as follows: Step 1. Add white Gaussian noise signal to x[n] to make a new signal x[n] + ε0wi[n]. Then, the ﬁrst-order model component I MFi 1[n] is obtained by EMD: MFi 1[n] = E1(x[n] + ε0wi[n]), i = 1, 2, . . . , I (1) Step 2. Overall average the I-th modal components, and the ﬁrst IMF of CEEMDAN is obtained as follows: I ˜MFi 1[n] = 1 I I ∑ l=1 I MFi 1[n] (2) Step 3. Calculate the residual after removing the ﬁrst IMF: r1[n] = x[n] − I ˜MFi 1[n] (3) Step 4. Add white noise to r1[n] to obtain a new signal r1[n] + ϵ1E1(wi[n]). Then, the ﬁrst-order I MFi 2[n] is obtained by EMD, and the second IMF of CEEMDAN is obtained as follows: I ˜MFi 1[n] = 1 I I ∑ l=1 I MFi 2[n] = 1 I I ∑ l=1 E1(r1[n] + ε1E1(wi[n])), i = 1, 2, . . . , I (4) Energies 2022, 15, 7422 4 of 18 Step 5. Calculate the residual after removing the k-th IMF, fork = 2, . . . , K rk[n] = rk−1[n] − I ˜MFi 1[n] (5) Step 6. Add white noise to rk[n] to obtain a new signal rk[n] + ϵkEk(wi[n]). Then, the ﬁrst-order I MFi k+1[n] is obtained by EMD, and the (k + 1)-th IMF of CEEMDAN is obtained as follows: I ˜MFi k+1[n] = 1 I I ∑ l=1 I MFi k+1[n] = 1 I I ∑ l=1 Ek(rk[n] + εkEk(wi[n])), i = 1, 2, . . . , I (6) Step 7. Repeat Step 5 and Step 6 until termination conditions meet the EMD iteration. The ﬁnal residual is as follows: R[n] = I ∑ l=1 I ˜MFk + R[n] (7) The ﬁnal number of IMFs is determined only by the data and stopping criteria. The ﬂow chart of CEEMDAN is shown in Figure 1. Figure 1. The ﬂow chart of CEEMDAN. Energies 2022, 15, 7422 5 of 18 2.2. Wavelet Domain Denoising The essence of wavelet denoising is the process of suppressing the useless part and enhancing the useful part. The denoising process is divided into three parts: wavelet decomposition, threshold ﬁltering, and wavelet reconstruction [39]. (1) The wavelet decomposition is to select a kind of wavelet to decompose the signal with N-layer wavelets. (2) The threshold ﬁltering is to obtain the estimated wavelet coefﬁcients by threshold- ing the decomposed coefﬁcients of each layer. (3) The wavelet reconstruction is to obtain the denoised signal by wavelet reconstruc- tion according to the denoised wavelet coefﬁcients. The process of wavelet decomposition and noise reduction is shown in Figure 2. Figure 2. Wavelet denoising process. 2.3. LS CEEMDAN can separate the main trend degradation categories from the original signal, and the least square regression method can be used to ﬁt the trend, which can effectively predict the normal decline trend of capacity. Suppose the multivariate linear equation has the following form: F(x) = ˆw ˆx (8) where ˆw = (w1, w2, . . . , wNs−1, wNs , b)T, ˆx = (x1, x2, . . . , xNs−1, xNs , 1)T. To construct the loss function with respect to ˆw: SSELoss( ˆw) = ∥y − x ˆw∥2 2 (9) The derivative of the loss function is as follows: ∂ SSELoss( ˆw) ∂ ˆw = 2(xT x ˆw − xTy) = 0 (10) The weights can be solved as: ˆw = (xT x)−1xTy (11) Energies 2022, 15, 7422 6 of 18 2.4. RVM RVM, which has the same functional form as the support vector machine [14], is a Bayesian sparse kernel algorithm for regression and classiﬁcation. The expression of the RVM regression prediction model can be written as follows: ti = Ns ∑ i=1 wiK(x, xi) + w0 + ε (12) where {xn}Ns n=1 is the input set, {tn}Ns n=1 is the output set, and K(x, xi) is the kernel function. Linear kernel functions are used in this paper: ϵ is the noise that follows the N(0, σ2) distribution, wi is the weight, and Ns is the number of samples. Assuming that {tn}Ns n=1 is an independent random variable, the likelihood function of the sample can be expressed as: p(t | w, σ2) = (2πσ2)− Ns 2 exp{− 1 2σ2 ∥t − Φw∥2} (13) where w = {wn}Ns n=1, Φ = {Œn}Ns n=1, and ϕ(xi) = [1, K(xi, x1), K(xi, x2), . . . , K(xi, xNs )]T. To avoid overﬁtting w and σ2, impose conditions on some parameters, assume that wi follows a Gaussian conditional probability distribution with mean 0 and variance β−1 i : p(w | β) = Ns ∏ u=0 N(wu | 0, β−1 u ) (14) β is the N + 1-dimensional hyperparameter that determines the prior distribution of the weight w. Given the likelihood function and the prior distribution of w, the posterior distribution of w can be obtained according to the Bayesian formula: p(w | t, β, ⊃2) = p(t | w, ⊃2)p(w | β) p(t | β, ⊃2) ∼ N(w | µ, Σ) (15) where Σ = (σ−2ΦTΦ + A)−1 , µ = σ−2ΣΦTt , and A = diag(β0, β1, . . . , βNs ). Maximizing the marginal likelihood function to solve the hyperparameter β, the iterative formula of hyperparameter β and variance σ2 can be obtained as follows: βi,new = 1 − βiΣii µ2 i (16) σ2 new = ∥t − ϕµ∥2 Ns − ∑i(1 − βi ∑ii) (17) where ∑ii is the diagonal element of the variance matrix of the posterior weight value, and µi is the weight value of the i-th posterior distribution. The weight is calculated iteratively according to the hyperparameter β and variance σ2, and then the prediction is made. 3. Experimental Analysis This section ﬁrst introduces the basic deﬁnitions of RUL and SOH (State of Health), and the relationship between them, and then describes the process of the whole combination algorithm. Finally, three evaluation indexes RMSE, MAPE, and MAE are selected to evaluate the effect of the proposed method. 3.1. RUL SOH is an important indicator to measure the degree of battery degradation, which is usually deﬁned by capacity ratio [40]: Energies 2022, 15, 7422 7 of 18 soh(j) = ˆc(j) ˆc(1) × 100% (18) where ˆc(1) is the initial capacity of the battery, and ˆc(j) is the estimated capacity of the cell in the j-th cycle. In view of the fact that the initial battery capacity of the lithium battery selected for the data set in this paper is consistent, the capacity data of the battery is directly used to deﬁne the SOH of the battery. In general, end of battery life is deﬁned as the point when remaining capacity reaches 70–80% of initial capacity, in which SOH is equal to 0.7–0.8. RUL is the number of charge and discharge cycles left before the battery life reaches the failure threshold. According to the relationship between SOH and RUL, this paper adopts the prediction of capacity series to indirectly express the prediction results of RUL. 3.2. Experimental Design In order to further illustrate the effectiveness of CEEMDAN-wavelet adoption in this paper, a comparison of add chirps and directly used wavelet decomposition is given. The training set ratio is 0.6. Figure 3 shows that the prediction results of adding noise and wavelet ﬁltering are poor, and the predicted trajectory is not smooth under the inﬂuence of noise. Therefore, an adaptive noise reduction method is proposed in this paper, which adopts CEEMDAN and then uses the wavelet denoising method to extract more effective information of the original sequence. 0 50 100 150 1.2 1.4 1.6 1.8 2.0capacity/Ah cycle/times (a)Prediction results of B0005 by white noise addin g and filtering B0005 true value The method of adding white noise and filtering 0 50 100 150 1.0 1.2 1.4 1.6 1.8 2.0capacity/Ah cycle/times (b)Prediction results of B0006 by white noise addin g and filtering B0006 true value The method of adding white noise and filtering Figure 3. Cont. Energies 2022, 15, 7422 8 of 18 0 50 100 150 1.2 1.4 1.6 1.8 2.0capacity/Ah cycle/times (c)Prediction results of B0007 by white noise addin g and filtering B0007 true value The method of adding white noise and filtering 0 50 100 150 1.2 1.4 1.6 1.8 2.0capacity/Ah cycle/times (d)Prediction results of B0018 by white noise addin g and filtering B0018 true value The method of adding white noise and filteringFigure 3. Prediction results with white noise added and ﬁltered. The ﬂow of method proposed in this paper is as follows: Step 1. Decompose the capacity signal into a series of IMFs ranging from high fre- quency to low frequency, and then use wavelet analysis to the IMF component further noise reduction. Step 2. The decomposition step in Step 1 leads to three parts: main trend degradation part, capacity regeneration part, random interference, and noise part. Then, the training sets and test sets are constructed from these three parts, respectively. The training sets of the normal decay part are trained by LS, and the training sets of the local regeneration part and random interference and noise parts are trained by RVM. Step 3. Input the test set data of each part into the trained model according to Step 2 to obtain the predicted value, and then reconstruct the predicted value of capacity. The overall framework is shown in Figure 4. Energies 2022, 15, 7422 9 of 18 Figure 4. The overall framework. 3.3. Evaluation Indicators RMSE, MAPE, and MAE are used as evaluation indicators for the performance esti- mation of the prediction model in this paper. The three evaluation indicators are deﬁned as follows: RMSE = √ 1 n n ∑ i=1( ˆyi − yi)2 (19) MAPE = 100% n n ∑ i=1 \f \f \f \f ˆyi − yi yi \f \f \f \f (20) MAE = 1 n n ∑ i=1| ˆyi − yi| (21) where ˆyi is the predicted value, yi is the real value, and n is the length of the sample. Energies 2022, 15, 7422 10 of 18 4. Experiment and Discussion This section introduces the data set used in the experiment, and then the data of the data set are processed to obtain the training set and prediction set. Then, the training set and prediction set are combined with CEEMDAN combined with the wavelet denoising algorithm to obtain the decompression and denoising data, and the LS–RVM is used to ﬁt the data. Finally, the obtained results are analyzed. 4.1. Experimental Dataset The test data in this paper are from the 18,650 model lithium-ion battery dataset proposed by NASA PCoE Research Center [41] which includes four types of batteries (B0005, B0006, B0007, and B0018). The battery is charged with a constant current of 1.5 A at about 24 °C. The operating voltage rises to the maximum cut-off voltage of 4.2 V, then it switches to constant voltage charging. When the current drops to 20 mA, the charging stops. The battery capacity attenuation trend contained in the dataset is shown in Figure 5. 0 50 100 150 1.0 1.2 1.4 1.6 1.8 2.0 2.2capacity/Ah cycle/times B0005 B0006 B0007 B0018 Figure 5. Lithium-ion battery decay trend chart. 4.2. CEEMDAN Combined with Wavelet Denoising Algorithm The number of noise added is 100, and the SNR is 0.0005. The Daubechies function is chosen as the wavelet basis function, and the sliding window step is 4. It can be seen that IMF1 can represent the main trend degradation, IMF2 represents the capacity regeneration trend, and IMF3 and IMF4 represent the random interference and noise trend. This can provide a reference basis for reducing the complexity of the prediction model by CEEMDAN. The IMF components decomposed by CEEMDAN were divided into data sets, and the sliding window model was established to construct the initial training samples. Then, take the t time step as the input and predict the value at the t + 1 time. The B0005 Decomposition Results is shown in Figure 6. Energies 2022, 15, 7422 11 of 18 0 50 100 150 200 -0.044 -0.022 0.000 0.022 0.044 0 50 100 150 200 -0.018 0.000 0.018 0.036 0 50 100 150 200 -0.024 -0.012 0.000 0.012 0 50 100 150 200 1.36 1.53 1.70 1.87 IMF1 IMF2 IMF3 IMF4 (a) Figure 6. B0005 Decomposition Results. 4.3. The LS–RVM Fitting The modal component of CEEMDAN is decomposed into three parts: the main trend degradation part, capacity regeneration part, random interference, and noise part. The training set of the main trend degradation part is trained by the LS model, and the training set of the capacity regeneration part and random interference and noise are trained by the RVM model, and then the test set is input in order to predict. Taking B0007 as an example, the prediction results of each part are as follows: It can be seen from Figure 7a that the normal capacity degradation trend predicted by the LS model almost coincides with the real value decay trend, and from Figure 7b–d, it can be seen that the capacity regeneration trend, random interference, and noise trend can be well predicted by the RVM model. 100 105 110 115 120 125 130 135 140 145 150 155 160 165 170 1.40 1.45 1.50 1.55 1.60capacity/Ah cycle/time IMF1 true value IMF1 predicted value a The prediction results of IMF1 95 100 105 110 115 120 125 130 135 140 145 150 155 160 165 170 -0.010 -0.005 0.000 0.005 0.010 0.015 b The prediction results of IMF2capacity/Ah cycle/time IMF2 true value IMF2 predicted value Figure 7. Cont. Energies 2022, 15, 7422 12 of 18 95 100 105 110 115 120 125 130 135 140 145 150 155 160 165 170 -0.005 0.000 0.005 c The prediction results of IMF3capacity/Ah cycle/time IMF3 true value IMF3 predicted value 95 100 105 110 115 120 125 130 135 140 145 150 155 160 165 170 -0.004 -0.002 0.000 0.002 0.004 0.006 d The prediction results of IMF4capacity/Ah cycle/time IMF4 true value IMF4 predicted value Figure 7. IMF component prediction chart. 4.4. Analysis of Forecast Results To further illustrate the importance of decomposition and noise reduction, the compar- ison between the method used in this paper and the result of ﬁtting the original sequence using only RVM is as follows: As can be seen from Figure 8, due to the noise and random interference in the original sequence, the prediction results of RVM lag behind the prediction results obtained by the proposed method. The control groups are set to further compare the effectiveness of the CEEMDAN– WAVELET–LS–RVM combined method proposed in this paper. It can be seen from Figure 9 that the EMD–ARIMA–RVM model has a serious deviation phenomenon when comparing the prediction trend charts of various models, and the prediction ﬂuctuations of other models are also large. The CEEMDAN–WAVELET–LSTM– RVM prediction model only has a relatively good ﬁtting effect on the data of the B0007 and B0018 batteries. In addition, the proposed method can ﬁt all curves well. In order to better illustrate the high accuracy of the prediction method in this paper, B0005 is taken as an example, where 60% is selected as the training set and 40% as the test set. The evaluation results are shown as follows: From Table 1, the prediction accuracy of the CEEMDAN–WAVELET denoising decom- position is higher than that of the EMD method. The RMSE, MAPE, and MAE obtained by the method adopted in this paper are all the smallest, and all are below 1%. Table 1. Comparison of evaluation results. Method RMSE MAPE MAE EMD–ARIMA–RVM 0.115688 0.072286 0.101315 EMD–CNN–RVM 0.010304 0.049918 0.008432 EMD–LSTM–RVM 0.032327 0.0483 0.030372 EMD–LS–RVM 0.009334 0.005751 0.007888 CEEMDAN–WAVELET–ARIMA–RVM 0.081968 0.047125 0.061984 CEEMDAN–WAVELET–CNN–RVM 0.010126 0.048915 0.007143 CEEMDAN–WAVELET–LSTM–RVM 0.030542 0.047546 0.029042 The Proposed Approach 0.008678 0.005002 0.006894 In order to verify the effectiveness of the method, the ratio of training and testing sets are adjusted, and the index error comparison chart of each model under different training ratios is obtained: It can be seen from Figure 10 that the LS–RVM combined model ﬁt is the best among all other combined models, and the combined model proposed in this paper is superior to other prediction models regardless of the training ratio.The RMSE, MAPE, and MAE Energies 2022, 15, 7422 13 of 18 obtained by the proposed combined model are all smaller than those obtained by other methods under the condition of selecting different data proportions, which can better predict the health status of lithium-ion batteries. 0 20 40 60 80 100 120 140 160 180 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9capacity/Ah cycle/times (a)Comparison of RVM predictions for B0005 B0005 true value The Proposed Approach RVM 0 50 100 150 1.0 1.2 1.4 1.6 1.8 2.0capacity/Ah cycle/times (b)Comparison of RVM predictions for B0006 B0006 true value The Proposed Approach RVM 0 50 100 150 1.2 1.4 1.6 1.8 2.0capacity/Ah cycle/times (c)Comparison of RVM predictions for B0007 B0007 true value The Proposed Approach RVM 0 50 100 150 1.2 1.4 1.6 1.8 2.0capacity/Ah cycle/times (d)Comparison of RVM predictions for B0018 B0018 true value The Proposed Approach RVM Figure 8. Comparison of the proposed method with RVM prediction. Energies 2022, 15, 7422 14 of 18 0 50 100 150 1.2 1.4 1.6 1.8 2.0 2.2capacity/Ah cycle/times B0005 true value EMD-ARIMA-RVM EMD-CNN-RVM EMD-LSTM-RVM EMD-LS-RVM CEEMDAN-WAVELET-ARIMA-RVM CEEMDAN-WAVELET-CNN-RVM CEEMDAN-WAVELET-LSTM-RVM The Proposed Approach (a)Comparison of trends predicted by B0005 A 0 50 100 150 1.2 1.4 1.6 1.8 2.0capacity/Ah cycle/times B0006 true value EMD-ARIMA-RVM EMD-CNN-RVM EMD-LSTM-RVM EMD-LS-RVM CEEMDAN-WAVELET-ARIMA-RVM CEEMDAN-WAVELET-CNN-RVM CEEMDAN-WAVELET-LSTM-RVM The Proposed Approach (b)Comparison of trends predicted by B0006 A 0 50 100 150 200 0.0 0.2 0.4 0.6 0.8 1.0 1.2 1.4 1.6 1.8 2.0 110 112 114 116 118 120capacity/Ah cycle/times B0007 true value EMD-ARIMA-RVM EMD-CNN-RVM EMD-LSTM-RVM EMD-LS-RVM CEEMDAN-WAVELET-ARIMA-RVM CEEMDAN-WAVELET-CNN-RVM CEEMDAN-WAVELET-LSTM-RVM The Proposed Approach (c)Comparison of trends predicted by B0007 0 50 100 150 1.2 1.4 1.6 1.8 2.0 2.2capacity/Ah cycle/times B0018 true value EMD-ARIMA-RVM EMD-CNN-RVM EMD-LSTM-RVM EMD-LS-RVM CEEMDAN-WAVELET-ARIMA-RVM CEEMDAN-WAVELET-CNN-RVM CEEMDAN-WAVELET-LSTM-RVM The Proposed Approach d Comparison of trends predicted by B0018 Figure 9. Comparison of the proposed approach with other common prediction methods. Energies 2022, 15, 7422 15 of 18 0.2 0.4 0.6 0.8 0.00 0.05 0.10 0.15 0.20 0.25RMSE Proportion of training set (a)The RMSE of different models predict EMD-ARIMA-RVM EMD-CNN-RVM EMD-LSTM-RVM EMD-LS-RVM CEEMDAN-WAVELET-ARIMA-RVM CEEMDAN-WAVELET-CNN-RVM CEEMDAN-WAVELET-LSTM-RVM The Proposed Approach 0.2 0.4 0.6 0.8 0.00 0.05 0.10 0.15 EMD-ARIMA-RVM EMD-CNN-RVM EMD-LSTM-RVM EMD-LS-RVM CEEMDAN-WAVELET-ARIMA-RVM CEEMDAN-WAVELET-CNN-RVM CEEMDAN-WAVELET-LSTM-RVM The Proposed ApproachMAPE Proportion of training set (b)The MAPE of different models predict 0.2 0.4 0.6 0.8 0.00 0.05 0.10 0.15 0.20MAE Proportion of training set (c)The MAE of different models predict EMD-ARIMA-RVM EMD-CNN-RVM EMD-LSTM-RVM EMD-LS-RVM CEEMDAN-WAVELET-ARIMA-RVM CEEMDAN-WAVELET-CNN-RVM CEEMDAN-WAVELET-LSTM-RVM The Proposed Approach Figure 10. Comparison of index errors of each model. Energies 2022, 15, 7422 16 of 18 5. Conclusions Accurately predicting the RUL of lithium-ion batteries can improve the safety and reliability of energy storage systems. Aiming at the RUL problem, this paper proposes an adaptive noise reduction approach. The effectiveness of the proposed RUL prediction method is veriﬁed by using the battery charge–discharge cycle dataset published by NASA. To achieve more accurate predictions, in this paper, the original sequence is broken down into three parts by CEEMDAN. Compared with EMD, CEEMDAN can adaptively calculate the number of decomposed layers and obtain better decomposition results and then adopt the wavelet denoising to obtain more accurate signal information. Considering the phenomenon of battery capacity regeneration and the interference of random noise, the RVM is used to ﬁt the capacity regeneration part and the random noise part to reduce the complexity of the prediction model, and the trend of battery capacity degradation can be tracked stably. The proposed model can better ﬁt the capacity decay trend of lithium- ion batteries with obvious capacity proliferation phenomena and effectively improve the prediction accuracy of the remaining service life of lithium ion batteries. In addition, compared with other models, the proposed method performs better on various datasets and can effectively improve prediction accuracy. Nevertheless, due to the complexity of the actual operating environment of lithium-ion batteries, RUL prediction under multiple environmental conditions will be considered in the future. Author Contributions: Formal analysis, W.Q. and G.C.; algorithm, W.Q. and T.Z.; experiment and simulation, W.Q. and T.Z.; validation, W.Q. and T.Z.; writing—original draft preparation, W.Q. and T.Z. and G.C.; writing—review and editing, W.Q., T.Z. and G.C. All authors have read and agreed to the published version of the manuscript. Funding: Hubei Province Key Laboratory of System Science in Metallurgical Process (Wuhan Uni- versity of Science and Technology): No.Z202102; Open Research Fund of Hubei Society for Industrial and Applied Mathematics and Wuhan Society for Industrial and Applied Mathematics, No.2022003. Institutional Review Board Statement: Not applicable. Informed Consent Statement: Not applicable. Data Availability Statement: Publicly available datasets were analyzed in this study. These data can be found here: [https://ti.arc.nasa.gov/tech/dash/groups/pcoe/prognostic-data-repository/ #battery, accessed on 1 June 2022]. Conﬂicts of Interest: The authors declare no conﬂict of interest. Abbreviations The following abbreviations are used in this manuscript: CEEMDAN Complete Ensemble Empirical Mode Decomposition with Adaptive Noise RUL Remaining Useful Life SOH State of Health EMD Empirical Mode Decomposition EEMD Ensemble Empirical Mode Decomposition VMD Variational Modal Decomposition SNR Signal-to-Noise Ratio LS Least Square MLP Multilayer Perceptron SVR Support Vactor Regression RVM Relevance Vector Machine ARIMA Autoregressive Integrated Moving Average model CNN Convolutional Neural Networks LSTM Long Short-Term Memory IMF Intrinsic Mode Functions Energies 2022, 15, 7422 17 of 18 RMSE Root Mean Square Error MAPE Mean Absolute Percentage Error MAE Mean Absolute Error References 1. Liu, D.; Song, Y.; Wu, W.; Yang, C.; Peng, Y. Review of state of health estimation for lithium-ion battery pack. Chin. J. Sci. Instrum. China 2020, 41, 1–18. [CrossRef] 2. Zhao, Q.; Qin, X.; Zhao, H.; Feng, W. A novel prediction method based on the support vector regression for the remaining useful life of lithium-ion batteries. Microelectron. Reliab. 2018, 85, 99–108. [CrossRef] 3. Wang, Q.; Mao, B.; Stoliarov, S.; Sun, J. A review of lithium ion battery failure mechanisms and ﬁre prevention strategies. Prog. Energy Combust. Sci. 2019, 73, 95–131. [CrossRef] 4. Liu, C.; Wang, Y.; Chen, Z. Degradation model and cycle life prediction for lithium-ion battery used in hybrid energy storage system. Energy 2019, 166, 796–806. [CrossRef] 5. Xiao, S.; Le, X.; Xian, K. Battery lifetime prognostics. Joule 2020, 4, 310–346. [CrossRef] 6. Chen, L.; Chen, J.; Wang, H.; Wei, H.; Pan, H. Prediction of battery remaining useful life based on wavelet packet energy entropy. Trans. China Electrotech. Soc. 2020, 35, 1827–1835. 7. Xiong, R.; Li, L.; Tian, J. Towards a smarter battery management system: A critical review on battery state of health monitoring methods. J. Power Sources 2018, 405, 18–29. [CrossRef] 8. Huang, S.-C.; Tseng, K.-H.; Liang, J.-W.; Chang, C.-L.; Pecht, M.G. An Online SOC and SOH Estimation Model for Lithium-Ion Batteries. Energies 2017, 10, 512. [CrossRef] 9. Wang, D.; Miao, Q.; Pecht, M. Prognostics of lithium-ion batteries based on relevance vectors and a conditional three-parameter capacity degradation model. J. Power Sources 2013, 239, 253–264. [CrossRef] 10. Zhang, Z.-Q.; Yu, Y.-J.; Li, X. Relevance vector machine algorithm to predict state of health and remaining useful life of battery. Chin. J. Power Sources China 2021, 45, 419–423. 11. Chen, Z.-W.; Shi, N.; Ji, Y.-F.; Niu, M.; Wang, Y.-R. Lithium-ion batteries remaining useful life predictionbased on BLS–RVM. Energy 2021, 234, 121269. [CrossRef] 12. Liu, Y.-F.; Zhao, G.-Q.; Peng, X.-Y. A Lithium-Ion Battery Remaining Using Life Predition Method Based on Multi-kernel Relevance Vector Machine Optimized Mode. Acta Electron. Sin. 2019, 47, 1285–1292. 13. Zhang, X.; Miao, Q.; Liu, Z.-W. Remaining useful life prediction of lithium-ion battery using an improved UPF method based on MCMC. Microelectron. Reliab. 2017, 75, 288–295. [CrossRef] 14. Dai, Z.-W.; Wang, Y.-M.; Wu, Y.-F. Life Prediction Method of Hydrogen Energy Battery Based on MLP and LOESS. In Proceedings of the 10th International Conference on Computer Engineering and Networks (CENet2020), Xi’an, China, 16–18 October 2020; pp. 511–562. [CrossRef] 15. Li, P.-H.; Zhang, Z.-J.; Xiong, Q.-Y.; Ding, B.-C.; Hou, J.; Luo, D.C.; Rong, Y.-J.; Lin, S.-Y. State-of-health estimation and remaining useful life prediction for the lithium-ion battery based on a variant long short term memory neural network. J. Power Sources 2020, 459, 228069. [CrossRef] 16. Mo, Y.; Wu, Q.-H.; Li, X.; Huang, B.-Q. Remaining useful life estimation via transformer encoder enhanced by a gated convolu- tional unit. J. Intell. Manuf. 2021, 32, 1997–2006. [CrossRef] 17. Xu, J.-Y.; Ni, Y.-L.; Zhu, C.-B. Remaining useful life prediction for lithium-ion batteries based on improved support vector regression. Trans. China Electrotech. Soc. 2021, 36, 3693–3704. [CrossRef] 18. Yang, D.; Wang, Y.-J.; Pan, R.; Chen, R.-Y.; Chen, Z.-H. State-of-health estimation for the lithium-ion battery based on support vector regression. Appl. Energy 2017, 227, 273–283. [CrossRef] 19. Chen, D.; Hong, W.; Zhou, X. Transformer Network for Remaining Useful Life Prediction of Lithium-Ion Batteries. IEEE Access 2022, 10, 19621–19628. [CrossRef] 20. Li, X.-Y.; Zhang, L.; Wang, Z.-P.; Dong, P. Remaining useful life prediction for lithium-ion batteries based on a hybrid model combining the long short-term memory and Elman neural networks. Energy 2018, 21, 510–518. [CrossRef] 21. Zhou, Y.-P.; Huang, M.-H. Lithium-ion batteries remaining useful life prediction based on a mixture of empirical mode decompo- sition and ARIMA model. Microelectron. Reliab. 2016, 65, 265–273. [CrossRef] 22. Chen, Y.-Y.; Xia, X.-Y.; Zhou, W.-Z. Prediction of the Lithium-Ion Battery Remaining Useful Life Based on EMD-ARMA. J. Electr. Power China 2021, 36, 43–51. 23. Yu, J.-B. State of health prediction of lithium-ion batteries: Multiscale logic regression and Gaussian process regression ensemble. Reliab. Eng. Syst. Saf. 2018, 174, 82–95. [CrossRef] 24. Xu, X.; Yu, C.; Tang, S.; Sun, X.; Si, X.; Wu, L. Remaining Useful Life Prediction of Lithium-Ion Batteries Based on Wiener Processes with Considering the Relaxation Effect. Energies 2019, 12, 1685. [CrossRef] 25. Dragomiretskiy, K.; Zosso, D. Variational mode decomposition. IEEE Trans. Signal Process. 2014, 62, 531–544. [CrossRef] 26. Wang, R.; Hou, Q.-L.; Shi, R.-Y.; Zhou, Y.-X.; Hu, X. Remaining useful life prediction method of lithium battery based on variational mode decomposition and integrated deep model. J. Instrum. 2021, 42, 110–120. [CrossRef] 27. Wu, W.; Wang, Y.-R. Remaining Useful Life Prediction of Lithium-ion Batteries Based on VMD and GPR Algorithm. Comput. Mod. China 2020, 83–88. Energies 2022, 15, 7422 18 of 18 28. Netsanet, S.; Zheng, D.-H.; Zhang, W.; Teshager, G. Short-term PV power forecasting using variational mode decomposition integrated with Ant colony optimization and neural network. Energy Rep. 2022, 8, 2022–2035. [CrossRef] 29. Hu, J.; Sun, Q.; Ye, Z.S.; Zhou, Q. Joint modeling of degradation and lifetime data for RUL prediction of deteriorating products. IEEE Trans. Ind. Inform. 2020, 17, 4521–4531. [CrossRef] 30. Zhai, Q.; Ye, Z.S. RUL prediction of deteriorating products using an adaptive Wiener process model. IEEE Trans. Ind. Inform. 2017, 13, 2911–2921. [CrossRef] 31. Zhai, Q.; Ye, Z.S. Robust degradation analysis with non-Gaussian measurement errors. IEEE Trans. Instrum. Meas. 2017, 66, 2803–2812. [CrossRef] 32. Yao, F.; He, W.; Wu, Y.; Ding, F.; Meng, D. Remaining useful life prediction of lithium-ion batteries using a hybrid model. Energy 2022, 248, 123622. [CrossRef] 33. Lin, D.; Zhang, X.; Wang, L.; Zhao, B. State of health estimation of lithium-ion batteries based on a novel indirect health indicator. Energy Rep. 2022, 8, 606–613. [CrossRef] 34. Yu, X.; Dong, F.; Ding, E.-J.; Wu, S.-P.; Fan, C.-Y. Rolling bearing fault diagnosis using modiﬁed LFDA and EMD with sensitive feature selection. IEEE Access 2018, 6, 3715–3730. [CrossRef] 35. Wu, Z.-H.; Huang, N.-E. Ensemble Empirical Mode Decomposition: A Noise-Assisted Data Analysis Method. Adv. Data Sci. Adapt. Anal. 2009, 1, 1–41. [CrossRef] 36. Torres, M.-E.; Colominas, M.-A.; Schlotthauer, G.; Flandrin, P. A complete ensemble empirical mode decomposition with adaptive noise. In Proceedings of the IEEE International Conference on Acoustics, Speech and Signal Processing, Prague, Czech Republic, 22–27 May 2011; pp. 4144–4147. [CrossRef] 37. He, C.-B.; Niu, P.; Yang, R.-P.; Wang, C.-G.; Li, Z.-X.; Li, H.-K. Incipient rolling element bearing weak fault feature extraction based on adaptive second order stochastic resonance incorporated by mode decomposition. Measurement 2019, 145, 687–701. [CrossRef] 38. Li, L.; Wang, F.; Shang, F.; Jia, Y.; Zhao, C.; Kong, D. Energy spectrum analysis of blast waves based on an improved Hilbert–Huang transform. Shock Waves 2017, 27, 487–494. [CrossRef] 39. Liu, Y.-Q.; Deng, H.-W.; Wu, L.-B.; Shen, Y.-P.; Tian, Y.-Q.; Yu, S.-T. Study on signal denoising of microseismic monitoring based on combined variational mode decomposition and wavelet threshold method. Min. Res. Dev. 2020, 40, 98–103. 40. Feng, H.-L.; Zhang, X. State of health estimation and remaining using life prediction of lithium-ion batteries based on new health indicators. J. Nanjing Univ. Sci. 2021, 660–670. [CrossRef] 41. Geobel, K.; Saha, B.; Saxena, A.; Celaya, J.-R.; Christophersen, J.-P. Prognostics in battery health management. IEEE Instrum. Meas. Mag. 2008, 11, 30–40. [CrossRef]","libVersion":"0.3.1","langs":""}