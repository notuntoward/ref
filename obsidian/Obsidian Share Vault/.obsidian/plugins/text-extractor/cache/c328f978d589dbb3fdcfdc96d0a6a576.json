{"path":"lit/lit_sources.backup/Weber24OpenSourceEnergyArbitrage.pdf","text":"Citation: Weber, T.; Lu, B. An Open-Source Energy Arbitrage Model Involving Price Bands for Risk Hedging with Imperfect Price Signals. Energies 2024, 17, 13. https:// doi.org/10.3390/en17010013 Academic Editor: Yuji Yamada Received: 18 September 2023 Revised: 10 December 2023 Accepted: 15 December 2023 Published: 19 December 2023 Copyright: © 2023 by the authors. Licensee MDPI, Basel, Switzerland. This article is an open access article distributed under the terms and conditions of the Creative Commons Attribution (CC BY) license (https:// creativecommons.org/licenses/by/ 4.0/). energies Article An Open-Source Energy Arbitrage Model Involving Price Bands for Risk Hedging with Imperfect Price Signals Timothy Weber and Bin Lu * School of Engineering, Australian National University, Canberra, ACT 2600, Australia; timothy.weber@anu.edu.au * Correspondence: bin.lu@anu.edu.au Abstract: The increased uptake of variable renewable energy sources has increased electricity price volatility in many energy pool markets, providing an opportunity for storage systems to profit through energy arbitrage. Comparison between the cost or value of storage systems engaging in energy arbitrage should be performed on a levelised basis due to differences in system lifetime. Existing energy arbitrage models with bid/offer curves and imperfect forecasting are typically computationally expensive and are impractical for calculating lifetime levelised cost metrics. In this work, an open-source modular energy arbitrage model with bid and offer curve inputs was developed for a lithium-ion battery energy storage system (BESS) and pumped hydro system (PHS) to analyse lifetime levelised cost and revenue. The mixed integer linear program scheduling module included a new piece-wise linearised description of PHS charging behaviour for rapid optimisation. A one-at-a- time sensitivity analysis indicated that levelised cost and revenue were highly sensitive to discharging efficiency. In a case study based on Australia’s National Electricity Market, imperfect forecasting with no risk hedging was found to increase levelised costs by up to 24% and decrease levelised revenue by up to 50% relative to perfect price forecasting, despite 95% of prices being forecast to be within $35/MWh of the actual trading price. BESS levelised costs were more significantly correlated with consistent low risk bids (Kendall Tau-b of 0.75), since the undiscounted capital costs contribute to a larger proportion of the overall costs than in the PHS systems. Keywords: energy arbitrage; batteries; pumped hydro; open-source; price bands; risk hedging 1. Introduction From 2016 to 2022, global wind and solar photovoltaic capacity had increased at an average of 12% and 22%, respectively, each year. By the end of 2022, these variable renewable energy (VRE) sources accounted for approximately 23% of the total installed electricity generation capacity [1]. A higher proportion of VRE sources in the energy mix has been correlated with an increase in price volatility within many wholesale electricity markets [2–6]. How the VRE capacity impacts electricity price volatility depends upon the market structure and demand during the hours of VRE generation. Recently, it has been found that wind generation during low demand hours tends to increase price volatility, while solar generation typically occurs during periods of high demand and may reduce price volatility [7–9]. Energy storage systems with the capacity to discharge for several hours, such as batteries and pumped hydro, are capable of providing an energy time-shifting service, ensuring that there is an adequate electricity supply when VREs are low [10,11]. When the increased VRE supply causes an increase in price volatility, there is the opportunity for storage systems to capitalise on the price spread through energy arbitrage by performing this time-shifting service. Furthermore, ancillary services and contract markets can also constitute a large por- tion of storage system revenue. Despite only spot market arbitrage being considered in Energies 2024, 17, 13. https://doi.org/10.3390/en17010013 https://www.mdpi.com/journal/energies Energies 2024, 17, 13 2 of 31 this paper, it is important to recognise that storage systems will participate in multiple markets simultaneously. Existing arbitrage models in the literature broadly fit into two categories: simple models that ignore the risk of imperfect price forecasting but have low computational complexity, or complex model that manage the risk of imperfect price forecasting but can only reasonably be used to analyse short simulation periods. The simple models are capable of analysing the entire lifetime of an energy storage system, but often ignore important details such as the loss of revenue associated with imperfect price forecasting, battery degradation, or non-linear charging behaviours. The complex models may have increased accuracy, but the high computational complexity means that they cannot be reasonably used to calculate levelised cost of storage metrics over the lifetime of a system without extensive access to expensive supercomputing resources. Comparisons between storage systems with different lifetimes, degradation rates, and cycle behaviour must be performed on a levelised basis to enable a fair comparison of costs. Many of the low-complexity arbitrage models in the literature assume perfect price forecasting to optimise storage system behaviour [12–15]. However, when imperfect price forecasting is used for energy arbitrage modelling instead, there will be a reduction in arbitrage revenue through two mechanisms: missed opportunities to schedule at optimal charging/discharging prices or dispatch during unfavourable pricing events. Models for forecasting short-term electricity prices have typically reported errors of between 5% and 36% relative to the actual price [16]. When modelling arbitrage based on locational marginal pricing in Ontario, Antweiler [17] determined that revenue with perfect forecasting was double that predicted when using basic forecasting techniques. Improved forecasting techniques have suggested that between 81% and 85% of the potential arbitrage value can be obtained when uncertainty in the price signal exists [18–20]. Many analyses that consider imperfect price forecasting for energy arbitrage mod- elling assume that the storage system is guaranteed to win the bid or offer for each dispatch interval. Thatte et al. [21] explored the use of robust optimisation to manage price un- certainty and inform the day-ahead scheduling of capacity for a wind farm and energy storage system. Mixed integer linear programming (MILP) has also been used to model the scheduling of capacity for a cryogenic energy storage system [22] and a generic storage system [19] with imperfect price forecasting. A predictive price signal method that defines dynamic electricity price classes has been used to determine optimal intervals for schedul- ing battery capacity [23]. Battery control for arbitrage purposes has also been formulated as a Markov Decision Process to optimise the scheduling of capacity with imperfectly forecast prices [24] or co-optimising with the frequency control market based on histor- ical prices [25]. Charging and discharging decisions for batteries with uncertain energy prices have also been optimised using a dynamic matrix-based program [26]. Electricity prediction errors of 12.5% were noted to halve arbitrage revenue under a sliding-window dynamic programming strategy that attempted to minimise battery degradation during scheduling [27]. The absence of a bid/offer price strategy reduces the scope of analysis that these models can perform for storage systems in real liberalised energy-pool markets. The bid and offer price for a trading interval enables the storage system to hedge against the risk of dispatching during suboptimal intervals when uncertainty exists in the forecast spot prices. A comparison between a stochastic capacity-price bidding strategy and a deterministic capacity-only bidding strategy was performed by Kirshnamurthy et al. [28]. The authors found that the stochastic method typically obtained higher arbitrage revenue, but exposed the system to a higher level of risk. Tian et al. [29] developed a stochastic model that used downside risk constraints to define bid and offer curves for a PHS that hedge against risk when spot prices are uncertain. Li et al. [30] explored using a stochastic p-robust optimisation method instead of the downside risk constraints method to define the bid and offer price curves, noting that a 19% decline in profits could be associated with a 41% decrease in maximum relative regret. Energies 2024, 17, 13 3 of 31 An information gap decision theory (IGDT)-based risk-constrained strategy for devel- oping bid and offer capacity-price curves of a price-taker compressed air energy storage system was found to be more profitable than a deterministic strategy [31]. The method was only used to analyse short-run costs and profits over a maximum period of 4 weeks. A similar analysis was performed using a robust optimisation for a price-maker-compressed air energy storage facility, with the robust-based strategy generally obtaining a higher revenue than a risk-neutral strategy [32]. Although the stochastic bid/offer price strategies for arbitrage models in the literature were found to be more profitable when compared with deterministic strategies, their computational time is expected to be much higher. This means that it is infeasible to fairly compare the cost of storage between different technologies, since this should be performed on a levelised basis. Comparison between the cost or value of different electrical energy storage technolo- gies should be performed on a levelised basis, taking account of the difference in system lifetime and the influence of power capacity and energy capacity or storage duration on capital costs. The analysis in this study will determine the impact of a simple price band risk hedging strategy on the required average discharge price (RADP) and available average discharge price (AADP) of the levelised cost of storage metrics, as defined by Belderbos et al. [33]. These two metrics define the levelised long-run marginal cost and revenue of the system, respectively, and are an important step in estimating the return on investment of a hypothetical system. An open-source modular energy arbitrage model has been developed which uses price band curves for risk hedging in the presence of imperfect price signals. This new model balances the accuracy of non-linear models that manage the risk of imperfect price forecasts with the computational speed of a simple deterministic scheduling algorithm. The new model includes the following novel features compared to existing open-source arbitrage models: • The MILP scheduling model applies a piece-wise linearisation process to a pumped hydro storage (PHS) system. This allows the non-linear charging behaviour of the PHS to be approximated during scheduling, taking advantage of the speed of MILP optimi- sation. The piece-wise linearisation process will be a more accurate approximation than assuming the constant linear behaviour of the PHS in all operating conditions. • Battery degradation has been considered within the piece-wise linearised description of a battery developed by Sakti et al. [14]. This allows for changes to battery voltage efficiency over its lifetime to be included within the MILP scheduling algorithm while maintaining an accurate approximation of the non-linear charging behaviour. • The rapid optimisation provided by the MILP scheduling algorithm, along with the additional accuracy provided by the non-linear charging model and piece-wise linear approximation of charging behaviour during scheduling, allows the simulation period to cover the entire lifetime of each storage system. This allows for computation of the lifetime-levelised cost of storage metrics (RADP and AADP), enabling a comparison between the arbitrage revenue of storage systems with different lifetimes, cycling behaviour, and degradation rates. • Charging and discharging efficiencies are considered separately and modelled accord- ing to non-linear functions, where appropriate. Some previous studies have assumed the use of a round-trip efficiency during dispatch [19,34], though this may be inappro- priate for modelling arbitrage revenue in wholesale energy markets that have a high price ceiling. • The code for the model is available open-source on Github. The current version contains a scheduling and charging model for a Li-ion BESS and PHS. The modification of the arbitrage model to analyse alternative storage systems, such as the compressed air energy storage or other battery technologies, would only require the development of bespoke scheduling and charging modules that can be directly integrated with the rest of the system. Energies 2024, 17, 13 4 of 31 It should also be noted that the modelling results discussed in this paper may not be appropriate when considering unusual events such as the COVID-19 pandemic, the global energy price response to the Russian invasion of Ukraine, a hypothetical oil embargo or a nuclear catastrophe such as Fukushima. Arbitrage models are most appropriately employed for understanding the behaviour of a system under different conditions, rather than providing accurate estimates of lifetime revenue. The mathematical arbitrage model developed for this study is outlined in Section 2. In Section 3, a sensitivity analysis is presented, and the model is used to determine the impact of a static risk level on the levelised cost of storage metrics for a hypothetical battery energy storage system (BESS) and PHS operating in the Australian National Electricity Market (NEM). 2. Model Details 2.1. Arbitrage Model At a high level, this arbitrage model can be described as a set of interconnected mod- ules (see Figure 1). The system is designed to perform day-ahead scheduling. Optimisation for scheduling is performed by a MILP programmed using the Pyomo [35,36] modelling package for Python and solved using the COIN-OR Branch-and-Cut (CBC) solver [37]. It is assumed that the storage system is a price-taker during dispatch. Energies 2024, 16, x FOR PEER REVIEW 4 of 32 air energy storage or other battery technologies, would only require the development of bespoke scheduling and charging modules that can be directly integrated with the rest of the system. It should also be noted that the modelling results discussed in this paper may not be appropriate when considering unusual events such as the COVID-19 pandemic, the global energy price response to the Russian invasion of Ukraine, a hypothetical oil embargo or a nuclear catastrophe such as Fukushima. Arbitrage models are most appropriately em- ployed for understanding the behaviour of a system under diﬀerent conditions, rather than providing accurate estimates of lifetime revenue. The mathematical arbitrage model developed for this study is outlined in Section 2. In Section 3, a sensitivity analysis is presented, and the model is used to determine the impact of a static risk level on the levelised cost of storage metrics for a hypothetical bat- tery energy storage system (BESS) and PHS operating in the Australian National Electric- ity Market (NEM). 2. Model Details 2.1. Arbitrage Model At a high level, this arbitrage model can be described as a set of interconnected mod- ules (see Figure 1). The system is designed to perform day-ahead scheduling. Optimisa- tion for scheduling is performed by a MILP programmed using the Pyomo [35,36] mod- elling package for Python and solved using the COIN-OR Branch-and-Cut (CBC) solver [37]. It is assumed that the storage system is a price-taker during dispatch. Figure 1. Arbitrage Model Block Diagram. The dispatch module generates a set of dispatch instructions for the trading day which are sent to the storage system’s charging module. The charging module runs through each dispatch interval in series, attempting to follow all dispatch instructions whilst operating within the constraints of the system. If the storage system is a BESS, then the capacity fading and eﬃciency fading at each interval are also calculated to update the current state of the storage system. Once the charging module reaches the end of the trad- ing day, it sends a list of the charged and discharged energies for each dispatch interval Figure 1. Arbitrage Model Block Diagram. The dispatch module generates a set of dispatch instructions for the trading day which are sent to the storage system’s charging module. The charging module runs through each dispatch interval in series, attempting to follow all dispatch instructions whilst operating within the constraints of the system. If the storage system is a BESS, then the capacity fading and efficiency fading at each interval are also calculated to update the current state of the storage system. Once the charging module reaches the end of the trading day, it sends a list of the charged and discharged energies for each dispatch interval to the settlement module. Based upon the spot prices for the trading day, the settlement module determines the trading amounts in each dispatch interval. Scheduling is then repeated for the upcoming trading day. The daily energy throughputs and trading amounts are stored as aggregate values until the end of the system life. Using the lifetime discharged energy, costs and gross Energies 2024, 17, 13 5 of 31 revenue, the levelised cost of the storage module determines the long-run marginal costs and revenue made by the simulated system. Although scheduling occurs before charging within the simulation, it is necessary to understand the charging behaviour of the system before we can define the scheduling constraints. 2.1.1. Charging Module In general, the BESS and PHS charging modules determine what SOC the system would reach if it followed the dispatch instruction for a given 5-min dispatch interval t (i.e., SOCtest t ). In Equation (1), the SOC at the start of the interval, SOCpre t , is initialised to be 50% (i.e., SOCinitial) in the first interval or the SOC at the end t − 1 for all other intervals. If the system can move from SOCpre t to SOCtest t without violating the constraints of the system, then it follows the dispatch instruction. Otherwise, it ignores the dispatch instruction, as per Equation (2). SOCpre t = { SOCinitial, t = 1 SOCt−1, t > 1 (1) SOCt = { SOCtest t , SOCmin ≤ SOCtest t ≤ SOCmax SOCt−1, SOCtest t ≤ SOCmin or SOCtest t ≥ SOCmax (2) Pumped Hydro Storage Charging Module Individual pumps and turbines are indexed by g and h, respectively. The PHS is assumed to consist of pumps independent of the turbines, and the turbines are assumed to be synchronous rather than of a variable speed. Ternary PHSs have a shorter transient time when changing between pumping and generating modes, which is expected to be ideal in volatile electricity markets. Furthermore, ternary systems typically have a higher peak efficiency than variable speed systems, which should maximise discharging profits during high-price events [38]. The dispatched power of each pump and turbine, defined by Equations (3) and (4), is dependent on whether the PHS can perform the dispatch instructions it receives from the dispatch model. The charging power of pump g for time interval t, given by Pc t,g [MW], is equal to the dispatch instruction issued to the load, Pdisp load,t,g [MW], if it would result in a SOC within the bounds of the system. The discharging behaviour of turbine h is similarly defined by the dispatch instruction issued to the generator, Pdisp gen,t,h [MW], if it is capable of reaching the new SOC. Pc t,g = {Pdisp load,t,g, SOCmin ≤ SOCtest t ≤ SOCmax 0, SOCtest t ≤ SOCmin or SOCtest t ≥ SOCmax (3) Pd t,h = {Pdisp gen,t,h, SOCmin ≤ SOCtest t ≤ SOCmax 0, SOCtest t ≤ SOCmin or SOCtest t ≥ SOCmax (4) The PHS charging behaviour is non-linear and consists of a steady-state calculation of SOC with a transient adjustment. Updates to the upper reservoir are based upon Equation (5). The SOC at the end of the time interval is based on the length of the dispatch interval, τ [hours], multiplied by the steady-state flow rate through the pumps and tur- bines, as defined by Qp t,g and Qt t,h [m3/s], respectively. The transient adjustments to the reservoir volume, ∆Vp t and ∆Vt t [m3], account for the transition times required to switch between pumping and generating. The maximum volume of the upper reservoir is given by Vur [m3]. SOCtest t = 1 Vur (3600·τ·(∑g (Qp t,g) − ∑h (Qt t,h)) + dVp t + dVt t ) + SOCpre t (5) Energies 2024, 17, 13 6 of 31 The steady-state calculation is based upon the pumped hydro model developed by Mousavi et al. [39]. Equations (6) and (7) calculate the flow rate of a pump or turbine unit based upon the net head (Hp t or Ht t), efficiency of the unit (η) and dispatch instruction. Water density (ρ) and acceleration due to gravity (g) are assumed to be 997 [kg/m3] and 9.81 [m/s], respectively. The net heads of the pumps and turbines are determined using Equations (8) and (9), where the gross head is adjusted by the head loss (Hpl t or Htl t [m]) for the associated penstock within that interval. The gross head is defined by the height difference between the bottom of the upper reservoir and top of the lower reservoir (hr [m]), the water level of the upper reservoir (huwl t [m]), the maximum possible water height in the lower reservoir (hlr [m]) and the water level of the lower reservoir (hlwl t [m]). Qp t,g = Pdisp load,t,g·106·ηp t,g Hp t ·ρ·g (6) Qt t,h = Pdisp gen,t,h·106 Ht t·ρ·g·ηt t,h (7) Hp t = hr + huwl + hlr − hlwl + Hpl t (8) Ht t = hr + huwl + hlr − hlwl − Htl t (9) The head loss is dependent upon the size, materials, and shape of the penstock (defined by resistance coeffient K of the pipes and fittings, penstock pipe diameter PD [m], friction factor F and penstock pipe length L [m]), as well as the velocity of the water (WV [m/s]) required to achieve the desired flow rate (Q [m3/s]). The friction factor is based on the Reynolds number (Re) and absolute roughness (ε [m]) of the penstock. The dynamic viscosity of water (µ) is assumed to be 8.9 × 10−4 [Pa·s]. Further details of these parameters can be found in [39]. The pump head loss is calculated according to Equations (10)–(15), while the turbine head loss is calculated from Equations (16)–(21). The model used for this analysis assumes a single penstock for the pumps and another for the turbines, although it would be possible to define multiple penstocks by indexing the parameters in the relevant equations. Different pumps and turbines could then have different net heads due to any assymetry between their associated penstocks. Hpl t = Kp t ·(WVp t )2 2g (10) WVp t = ∑g Qp t,g 0.25·π·(PDp)2 (11) Kp t = Kp,pipe t + Kp,fittings (12) Kp,pipe t = Fp t ·Lp PDp (13) Fp t = [ 1.8·log ( 6.9 Rep t + ( εp/PDp 3.7 )1.11)]−2 (14) Rep t = ρ·WVp t ·PDp µ (15) Htl t = Kt t·(WVt t)2 2g (16) Energies 2024, 17, 13 7 of 31 WVt t = ∑h Qt t,h 0.25·π·(PDt)2 (17) Kt t = Kt,pipe t + Kt,fittings (18) Kt,pipe t = Ft t ·Lt PDt (19) Ft t = [ 1.8·log ( 6.9 Ret t + ( εt/PDt 3.7 )1.11)]−2 (20) Ret t = ρ·WVt t·PDt µ (21) The efficiency of the pumping system is assumed to be 91%, as per Equation (22). The constant efficiency is considered appropriate since pumps typically operate at their rated conditions [40]. The value of 91% is based upon the efficiency losses due to the pump, motor, and transformer losses, as outlined by Chen [41]. The water conductor losses described by Chen are captured by the head loss calculation. The turbine efficiency is empirically derived by fitting parameters (ξt n) to the Francis turbine hill plot in Bostan et al. [42]. The relative flow rate (Qt,rel t,h [m3/s]) is based on the actual flow rate (Qt t,h [m3/s]) relative to the flow rate at peak efficiency (Qt peak,h [m3/s]), calculated in Equation (23). The empirical function fitted according to Equation (24) assumes that the turbine is operating at a nominal head. Although turbine efficiency is technically also a function of net head, it is significantly more dependent upon flow rate; thus, the assumption is considered reasonable for this analysis [43]. Flow rate and the associated head loss are calculated by finding the steady state solution to Equations (10)–(24) [39]. ηp t,g = 0.91 (22) Qt,rel t,h = Qt t,h Qt peak,h (23) ηt t,h = ∑4 n=0 (ξt n·(Qt,rel t,h )n) (24) The transient adjustment to the SOC considers the time required to change the flow rate. The ramp times (RTTNL→T, RTT→TNL, RTTNL→P, and RTP→TNL [s]) between turbine opera- tion, turbine-no-load and pump operation are defined as parameters. The ramp time for an individual unit during a given interval is calculated from Equation (25) or Equation (26). The upper reservoir water volume is then adjusted according to Equations (27) and (28) to account for the transient behaviour. RTt t,h =    (Qt t,h − Qt t−1,h)· RTTNL→T Qt peak,h , Qt t,h ≥ Qt t−1,h (Qt t−1,h − Qt t,h)· RTT→TNL Qt peak,h , Qt t−1,h > Qt t,h (25) RTp t,g =    (Qp t,g − Qp t−1,g)· RTTNL→P Qp peak,g , Qp t,g ≥ Qp t−1,g (Qp t−1,g − Qp t,g)· RTP→TNL Qt peak,g , Qp t−1,g > Qp t,g (26) Energies 2024, 17, 13 8 of 31 dVp t =    ∑g RTp t,g 2 ·(Qp t−1,g − Qp t,g), ∑h Qt t,h = ∑h Qt t−1,h ∑g RTp t,g 2 ·(Qp t−1,g − Qp t,g), ∑g Qp t,g < ∑g Qp t−1,g and ∑h Qt t,h > ∑h Qt t−1,h ∑g ( RTp t,g 2 + max(RTt t,h))·(Qp t−1,g − Qp t,g), ∑g Qp t,g > ∑g Qp t−1,g and ∑h Qt t,h < ∑h Qt t−1,h 0, ∑g Qp t,g = ∑g Qp t−1,g (27) dVt t =    ∑h RTt t,h 2 ·(Qt t,h − Qt t−1,h), ∑g Qp t,g = ∑g Qp t−1,g ∑h RTt t,h 2 ·(Qt t,h − Qt t−1,h), ∑g Qp t,g > ∑g Qp t−1,g and ∑h Qt t,h < ∑h Qt t−1,h ∑h ( RTt t,h 2 + max(RTp t,g))·(Qt t,h − Qt t−1,h), ∑g Qp t,g < ∑g Qp t−1,g and ∑h Qt t,h > ∑h Qt t−1,h 0, ∑h Qt t,h = ∑h Qt t−1,h (28) Battery Energy Storage System Charging Module The BESS modelled for this analysis is assumed to consist of lithium-ion cells. The volt- age of the BESS is measured across the inverters before it is stepped up by the transformers for distribution or transmission. The dispatched capacity for any interval t is dependent upon whether the BESS can operate at that power without exceeding the SOC bounds. The relationship between dispatched capacity and the dispatch instructions is provided in Equations (29) and (30). Pc t = {Pdisp load,t, SOCmin ≤ SOCtest t ≤ SOCmax 0, SOCtest t ≤ SOCmin or SOCtest t ≥ SOCmax (29) Pd t = {Pdisp gen,t, SOCmin ≤ SOCtest t ≤ SOCmax 0, SOCtest t ≤ SOCmin or SOCtest t ≥ SOCmax (30) The efficiency of the BESS is defined to consist of a voltage efficiency (ηvolt t ), represent- ing the electrochemical losses of the battery, and the system efficiency (ηsys), defining the auxiliary losses of the storage system. The voltage efficiency in Equation (31) and non-linear charging behaviour in Equation (32) are based upon the simplified electrical energy storage system representation developed by Sakti et al. [14] and Darling et al. [44]. The system efficiency is assumed to be constant within the simplified model, though it is important to note that auxiliary losses are dependent upon the dynamic thermal management of the system [45]. The energy capacity of the battery is defined by CEbatt [MWh], the nominal voltage by Ubatt nom [V], the voltage for a given time interval by Ubatt t [V], the energy capacity of each cell by CEcell [MWh], and the internal resistance of the cells by ircell t [Ω]. ηvolt t = 1 2 + √ √ √ √ √ 1 4 − (Pdisp gen,t + Pdisp load,t) ηsys·SOCtest t ·CEbatt · ( Ubatt nom Ubatt t )2· ircell t ·CEcell Ucell nom (31) SOCtest t = SOCpre t − 1 CEbatt ·   Pdisp gen,t ηvolt t ·ηsys − ηvolt t ·ηsys·Pdisp load,t  ·τ (32) The open-circuit voltage of each cell is defined by Equation (33). An analysis of methods for empirically fitting open-circuit voltage characteristic curves for lithium-ion batteries by Zhang et al. [46] suggested that a fourth-order Gaussian model produced the lowest root-mean-square error compared to the other fitting methods. The general Gaussian model for fitting the characteristic curve is provided in Equation (33), with n = 4 for the purposes of this analysis. Fitting parameters ξ, ϕ and χ are used to define the characteristic curve. The nominal voltage is defined as the open-circuit voltage at 50% Energies 2024, 17, 13 9 of 31 SOC, as per Equation (34). The open-circuit voltage of the entire BESS before it is stepped up is assumed to be equal to the sum of open-circuit voltages of the cells in series (see Equation (35)). The number of cells in series is given by Nseries. The resistance in the battery created by making cell connections is ignored for the purposes of this analysis [14]. Ucell t = ∑n nn=1 ξcell n ·exp  − ( SOCtest t − ϕcell n χcell n )2  (33) Ucell nom = ∑n nn=1 ξcell n ·exp  − ( 0.5 − ϕcell n χcell n )2  (34) Ubatt t = Ucell t Nseries (35) Lithium-ion batteries are expected to experience both capacity fading and efficiency fading. The end-of-life criterion for a lithium-ion battery is typically defined to be degra- dation to 80% of its original energy capacity [47–49]. Furthermore, the internal resistance of an LFP/C battery cell held at 50% SOC at 25 ◦C is expected to increase by 71% over a 20-year period [50]. As shown in Equation (31), an increase in internal resistance would directly result in an increase in electrochemical losses. Capacity fading in lithium-ion batteries is typically separated into two components: calendar aging and cycle aging. The empirical model developed by Petit et al. [51], origi- nally based upon the work of Wang et al. [52], is used as the basis for Equations (36)–(38). The decrease in energy capacity due to cycle aging and calendar aging is given by CEcycloss t [MWh] and CEcalloss t [MWh], respectively. Cycle aging is only considered to occur when the system is charging (at an average current through each cell of Icell,avg t [A]), since this will cause a lower potential at the negative electrode, and SEI formation at the negative electrode is one of the predominant drivers of capacity loss [51]. The empirical models are fitted using an aging coefficient (AC), a coefficient for aging acceleration (γ [J/mol·A]) and an aging exponent (AE). The aging models are dependent on the amp-hour charging throughput (AhTht [Ah]), calendar loss time (CLTt [s]), an activation energy (Ea [J/mol]), the temperature (T [K]) and the universal gas constant (R = 8.314 [J/K·mol]). The number of calendar loss intervals is given by CalNt. Equation (39) defines the charging throughput of the cell in [Ah], and Equation (40) defines the calendar loss time in [s]. The maximum SOC boundary (i.e., state-of-health) is updated according to Equation (41) at each interval. Note that since empirical models based upon average current and average SOC are used, the short-term changes in energy capacity will not be modelled accurately and may fluctuate between intervals. Over the simulated system lifetime, these short-term errors will be washed out and we will expect to observe a capacity loss trend downwards at the expected rate. Short-term degradation would be more appropriately modelled using a first-principles physical model. CEcycloss t = ACcyc(Icell,avg t )·exp   −Eacyc + γ·∣ ∣ ∣Icell,avg t ∣ ∣ ∣ R·T  ·(AhTht)AEcyc (36) CEcalloss t = ACcal(SOCavg t )·exp  − Eacal(SOCavg t ) R·T  ·(CLTt)AEcal(SOCavg t ) (37) CEloss t = {CEcalloss t , Icell ≥ Icyc CEcycloss t , Icell < Icyc (38) AhTht = ∑t (SOCt − SOCt−1)·CEcell (39) CLTt = 3600·τ·CalNt (40) Energies 2024, 17, 13 10 of 31 SOHt,x = ( 1 − CEcycloss t 100 − CEcalloss t 100 ) (41) The increase in the internal resistance of the lithium-ion cell was also empirically modelled according to Equation (42) and is based upon the work of Stroe et al. [50]. As with the capacity fading, this empirical model should not be considered appropriate for short- term changes in internal resistance, but is expected to provide a reasonable description of changes over the system lifetime. The change in internal resistance is dependent on the duration of operation, given by ST [months]. The conversion from the dispatch interval t, trading interval s, and day k to the duration of operation is performed in Equation (43). ircell t = ircell initial + ircell initial 100 ·(6.9656·10−8·exp(0.05022·T))·(2.897·exp(0.006614·SOCavg t ·100))·ST0.8 (42) ST = k + (6s + t)/288 30 (43) 2.1.2. Scheduling Module Pumped Hydro Storage Scheduling Module The PHS scheduling algorithm is attempting to maximise the arbitrage revenue (AR [$]) in Equation (44) over the forecasting time horizon of S trading intervals, given the constraints defined by Equations (45)–(59). The predicted arbitrage revenue is based upon the forecasted spot prices (SPpd s ), short-term marginal costs of the system, and the loss factors defined by AEMO (MLFgen and MLFload) or the distribution network service provider (DLFgen and DLFload). Short-term marginal costs are defined using the variable operation and maintenance costs (VOMt and VOMp [$/MWh] and the charged/discharged energies Et s and Ep s [MWh]. maximise AR = ∑S s=1 (6τ·SPpd s ·(DLFgen·MLFgen·Ds − DLFload·MLFload·Cs) − (VOMt·Et s + VOMp·Ep s )) (44) In Section Pumped Hydro Storage Charging Module, a non-linear PHS charging mod- ule was described, but the MILP necessarily requires linear constraints. The linearisation process developed by Sakti et al. [14] is used to define a set of linear constraints from the non-linear PHS charging functions. Essentially, the linearisation process partitions each non-linear function, then approximates the curve for each partition as a straight line between the bounded points. Binary variables are used to activate the relevant partitions for each time interval. The scheduled SOC (SOCsch s ) is restricted to exist within the bounds of the assumed minimum and maximum SOC by Equation (45). Subsequent scheduled SOC values are defined according to Equation (46). SOCmin ≤ SOCsch s ≤ SOCmax (45) SOCsch s =    6τ·3600 Vur (∑g(Qsch,p s,g ) − ∑h(Qsch,t s,h )) + SOCs−1, 1 < s < S 6τ·3600 Vur (∑g(Qsch,p s,g ) − ∑h(Qsch,t s,h )) + SOCinitial, s = 1 SOCinitial, s = S (46) Equation (47) defines a binary variable (ws) that prevents simultaneous charging and discharging of the system. It is necessary for the lower bound of both the pump and turbine scheduled flow rates (Qsch,p s,g and Qsch,t s,h [m3/s]) to be 0 [m3/s] to ensure that the systems are allowed to idle. Additional scheduling flexibility is provided by setting an upper bound greater than the peak flow rate (Qp peak,g and Qt peak,h [m3/s]), as this was noted to greatly reduce the optimisation time (see Equations (48) and (49)). The scheduling flexibility is also Energies 2024, 17, 13 11 of 31 essential for the CBC solver to find any solution if the pump and turbine have different nameplate capacities. ws ∈ {0, 1} (47) 0 ≤ Qsch,p s,g ≤ 1.05·Qp peak,g·ws (48) 0 ≤ Qsch,t s,h ≤ 1.05·Qt peak,h·(1 − ws) (49) For the pumps and turbines, the flow rate loss must be added to the gross flow rate, as defined by Equations (50) and (51), since a non-linear function relates efficiency losses to the turbine flow rate. The load bid capacity is apportioned across pumps using Cs,g [MW] and the generator bid capacity across turbines using Ds,h [MW]. Flow rate losses (Qp,loss s,g and Qt,loss s,h [m3/s]) determined using the piecewise linear functions are used to modify the scheduled flow rates. A constant effective head (Hp effective and Ht effective [m]) is assumed for the pumps and turbines to maintain a linear scheduling model. Qsch,p s,g = Cs,g·106 Hp effective·ρ·g − Qp,loss s,g (50) Qsch,t s,h = Ds,h·106 Ht effective·ρ·g + Qt,loss s,h (51) Equations (52) and (53) calculate the energy throughput of the PHS for the purposes of determining variable operation and maintenance costs. Esch,p s = ∑g ( Cs,g − Qp,loss s,g ·Hp effective·ρ·g 106 ) ·6τ (52) Esch,t s = ∑h ( Ds,h + Qt,loss s,h ·Ht effective·ρ·g 106 ) ·6τ (53) The turbine and pump efficiency losses are calculated according to Equations (54)–(64). Before any analysis is performed, turbine efficiency is plotted against the normalised flow rate. The non-linear efficiency curve is partitioned into m segments of length cm (pumps: dm) along the normalised flow rate axis. The fraction of piece cm used in the calculation is defined by qt s,m,h (pumps: pp s,m,g). The gradient, slt,loss m (pumps: slp,loss m ), of the linear approximation of each partition is calculated. The partition lengths and gradients are initialised as parameters before scheduling. Partitions are activated using the binary variable zt,loss s,m,h (pumps: zp,loss s,m,g ) in each trading interval, depending upon the scheduled flow rate. The flow rate losses are calculated from the active partitions. The efficiency curves are also used to restrict the scheduling of the pump close to nominal capacity and to avoid cavitation conditions when scheduling the turbine. ∑m qt s,m,h = Qsch,t s,h Qt peak,h (54) 0 ≤ qt s,m,h ≤ cm·zt,loss s,m,h (55) 0 ≤ qt s,(m−1),h ≥ cm−1·zt,loss s,m,h, m ≥ 2 (56) 0 ≤ Qt,loss s,h ≤ Qt peak,h·(1 − ws) (57) Qt,loss s,h = Qt peak,h·∑m nt s,m,h·slt,loss m (58) Energies 2024, 17, 13 12 of 31 ∑m pp s,m,g = Qsch,p s,g Qp peak,g (59) 0 ≤ pp s,m,g ≤ dm·zp,loss s,m,g (60) 0 ≤ pp s,(m−1),g ≥ dm−1·zp,loss s,m,g , m ≥ 2 (61) 0 ≤ Qp,loss s,g ≤ Qp peak,g·ws (62) Qp,loss s,g = Qt peak,g·∑m pp s,m,g·slp,loss m (63) zp,loss s,m,g , zt,loss s,m,h ∈ {0, 1} (64) Battery Energy Storage System Scheduling Module BESS scheduling is primarily based upon the linear system developed by Sakti et al. [14]. Equation (65) defines the objective function for the BESS scheduling pro- cess. The total discharging and charging energy in a trading interval is given by Ed s and Ec s [MWh], respectively. maximise AR = ∑S s=1 (6τ·SPpd s ·(DLFgen·MLFgen·Ds − DLFload·MLFload·Cs) − (VOMd·Ed s + VOMc·Ec s )) (65) The binary variable that prevents simultaneous charging and discharging is defined in Equation (66). The scheduled charging and discharging power are then constrained according to Equations (67) and (68) to remain between the maximum charging power (Pmin [MW]) and maximum discharging power (Pmax [MW]). ws ∈ {0, 1} (66) 0 ≤ Cs ≤ −Pmin·ws (67) 0 ≤ Ds ≤ Pmax·(1 − ws) (68) Equation (69) ensures that the SOC during scheduling is constrained by the state-of- health (SOH) following degradation in the final dispatch interval of the previous trading day. Each SOC for subsequent trading intervals is then defined according to Equation (70). SOCmin ≤ SOCsch s ≤ SOHk−1,48,6 (69) SOCsch s =    SOCs−1 − 1 CEbatt ·(Ed s − Ec s ), 1 < s < S SOCinitial − 1 CEbatt ·(Ed s − Ec s ), s = 1 0.5, s = S (70) To reduce the size of the solution space, the maximum power for any trading interval is restricted to keep BESS efficiency above 80%. Equation (71) calculates the average SOC during a trading interval. Modifications were made to the model developed by Sakti et al. [14], such that the maximum power limit parameters are defined before scheduling according to Equations (72) and (73) to account for the internal resistance of the cells at the end of the previous trading day. Based upon the linear partitioning of the maximum power limit as a function of SOC, the scheduled charging and discharging capacities are constrained according to Equations (74)–(86). The average SOC within the trading interval is given by βs. The charging power limit function is partitioned into j (discharging: i) pieces of length bj (discharging: ai) along the SOC axis. The maximum power for partition jj (discharging: ii) is given by Pc max,jj [MW] (discharging: Pd max,ii). The gradient of linear segments of the piecewise function is given by slc j (discharging: sld i ). The fraction of piece bj that is used is given by ys,j (discharging: Energies 2024, 17, 13 13 of 31 fraction of piece ai used is xs,i). The fraction of maximum power that could be dispatched by the system is given by αc s (discharging: αd s ). A binary decision variable, zc s,j (discharging: zd s,i), is used to activate segments of the piecewise linear function. βs =    [SOCsch s−1+SOCsch s ] 2 , s ≥ 2 [SOCinitial+SOCsch 1 ] 2 , s = 1 (71) Pc max,jj = ∑j=jj j=1 bj·CEbatt·Ucell nom· ( η2 sys 4 − (0.8 − 0.5·ηsys)2) ηsys·( Ubatt nom Ubatt j )2·ircell k−1,48,6·CEcell (72) Pd max,ii = ∑i=ii i=1 ai·CEbatt·Ucell nom· ( η2 sys 4 − (0.8 − 0.5·ηsys)2) ηsys·( Ubatt nom Ubatt i )2·ircell k−1,48.6·CEcell (73) slc j =    Pmax,j−Pmax,j−1 bj , j > 1 Pmax,j bj , j = 1 (74) sld i = { Pmax,i−Pmax,i−1 ai , i > 1 Pmax,i ai , i = 1 (75) ∑j ys,j·slc j = αc s ≥ 0 (76) ∑j ys,j = βs ≥ 0 (77) 0 ≤ ys,j ≤ bj·zc s,j (78) ys,(j−1) ≥ bj−1·zc s,j, j ≥ 2 (79) ∑i xs,i·sld i = αd s ≥ 0 (80) ∑i xs,i = βs ≥ 0 (81) 0 ≤ xs,i ≤ ai·zd s,i (82) xs,(i−1) ≥ ai−1·zd s,i, i ≥ 2 (83) Cs ≤ −Pmin·αc s (84) Ds ≤ Pmax·αd s (85) zc s,j, zd s,i ∈ {0, 1} (86) The charged or discharged energy within the BESS, accounting for auxiliary and elec- trochemical power losses (Pc,loss s and Pd,loss s [MW]), is defined by Equations (87) and (88). Ed s = (Ds + Pd,loss s )·6τ (87) Ec s = (Cs − Pc,loss s )·6τ (88) Through the process of linear partitioning, the power losses at a given dispatch power are constrained according to Equations (89)–(105). It should be noted that power loss as a function of SOC is not considered within this arbitrage model, unlike in the model developed by Sakti et al. [14], since the increased complexity was noted to dramatically increase optimisation time during testing. The parameters that define power loss are Energies 2024, 17, 13 14 of 31 updated before scheduling to account for increases in the internal resistance of the cells in Equations (95)–(98). Efficiency fading is not considered in the models developed by Sakti et al. [14], but we have included its effects in the below model. The charging power loss curve is partitioned into m pieces of length dm (discharging: cm) along the dispatch power axis. The fraction of each piece dm that is used in a trading interval is defined by pc s,m (discharging: qd s,m). Partitions are activated with the binary variable zc,loss s,m (discharging: zd,loss s,m ). Voltage efficiency for a specific piece, m = mm, is defined by ηvolt,c mm (discharging: ηvolt,d mm ). The slope of a linear segment of the piecewise linear function is given by slc,loss m (discharging: sld,loss m ). The maximum power loss value for segment mm is Pc,loss mm (discharging: Pd,loss mm ). ∑m pc s,m = Cs (89) 0 ≤ pc s,m ≤ dm·zc,loss s,m (90) 0 ≤ pc s,(m−1) ≥ dm−1·zc,loss s,m , m ≥ 2 (91) ∑m qd s,m = Ds (92) 0 ≤ qd s,m ≤ cm·zd,loss s,m (93) 0 ≤ qd s,(m−1) ≥ cm−1·zd,loss s,m , m ≥ 2 (94) ηvolt,c mm = 1 2 + √ 1 4 − ∑m=mm m=1 dm ηsys·0.5·CEbatt · ircell t ·CEcell Ucell nom (95) ηvolt,d mm = 1 2 + √ 1 4 − ∑m=mm m=1 cm ηsys·0.5·CEbatt · ircell t ·CEcell Ucell nom (96) Pc,loss mm = (1 − ηvolt,c mm ·ηsys)· ∑m=mm m=1 dm ηvolt,c mm ·ηsys (97) Pd,loss mm = (1 − ηvolt,d mm ·ηsys)· ∑m=mm m=1 cm ηvolt,d mm ·ηsys (98) slc,loss m =    Pc,loss m −Pc,loss m−1 dm , m > 1 Pc,loss m dm , m = 1 (99) sld,loss m =    Pd,loss m −Pd,loss m−1 cm , m > 1 Pd,loss m cm , m = 1 (100) 0 ≤ Pc,loss s ≤ −Pmin·ws (101) 0 ≤ Pd,loss s ≤ Pmax·(1 − ws) (102) zc,loss s,m , zd,loss s,m ∈ {0, 1} (103) Pc,loss s = ∑m pc s,m·slc,loss m (104) Pd,loss s = ∑m qd s,m·sld,loss m (105) 2.1.3. Price Band Module Bid and offer price bands for each day are specified to be parameters within this arbitrage model (u number of bid prices, bpk,u [$/MWh], and v number of offer prices, opk,v [$/MWh], for trading day k). The lowest bid above the forecast spot price is given by bpk,s,uu and the highest offer below the forecast spot price by opk,s,vv. The risk level is defined by RL. The bid or offer price (Bs and Os [$/MWh]) for a particular trading interval on the Energies 2024, 17, 13 15 of 31 following trading day is chosen based upon the forecast spot price, the price bands for the day, and a specified risk level (see Equations (106)–(109)). There are 10 bid and 10 offer price bands defined for each trading day as an ordered list, with u,v = 1 representing the lowest [$/MWh] price band. A higher risk level indicates that the participant is more likely to win the bid or offer during dispatch, but is also more open to the possibility of dispatching during an unfavourable pricing period. The bid and offer curves are not optimised within the energy arbitrage model itself. Rather, the intention is to use real bid/offer data when evaluating existing systems or to develop the bid/offer curves through a separate algorithm to input into the arbitrage model. This paper is not proposing an improved bid/offer curve optimisation algorithm, but intends to model the impact of imperfect price forecasting at different levels of bid/offer risk on lifetime levelised costs and revenue. The current version of the model does not consider real-time energy markets or the potential for re-bidding prior to dispatch (as is possible within the NEM). These added complexities could affect arbitrage revenue by reducing the risk posed by longer term price forecasting and will be a topic for future work. bpk,s,uu = min(bpk,u), bps,k,uu > SPpd s (106) Bs, = {bbk,s,uu+RL, uu + RL ≤ 10 bbk,10, uu + RL > 10 (107) opk,s,vv = max(opk,v), ops,k,vv < SPpd s (108) Os = { opk,s,vv+RL, vv − RL ≥ 1 opk,1, vv − RL < 1 (109) 2.1.4. Dispatch Module The dispatch module compares the bid and offer prices for a given trading interval (DPt [$/MWh]), modified by the marginal loss factors, with the dispatch price for each associated dispatch interval. It assumes price-taker behaviour for the storage system. The dispatch instructions are determined according to Equations (110) and (111). Pdisp gen,s,t = {Ds, Os MLFload·DLFload ≤ DPt 0, Os MLFload·DLFload ≥ DPt (110) Pdisp load,s,t = {Cs, Bs MLFgen·DLFgen ≥ DPt 0, Bs MLFload·DLFload ≤ DPt (111) 2.1.5. Settlement Module The energy that is traded at the connection point during the dispatch (MEs [MWh]) is calculated according to Equation (112). In accordance with rule 3.15.4 in the National Electricity Rules [53], adjusted energy at the connection point (AGEs [MWh]) is calculated using Equation (113). The trading amount for each trading interval (TAs [$]) is finally calculated using Equation (114), as per rule 3.15.6 in the National Electricity Rules [53]. The spot price for a trading interval is given by SPs [$/MWh]. Note that marginal losses in the NEM are expected to change from a static annual value to a dynamic calculation through locational marginal pricing (LMP) in the future. The use of LMP is currently being explored through the Coordination of Generation and Transmission Investment Implementation review [54]. MEs = ∑t=6 t=1 ((Pd t − Pc t )·τ) (112) AGEs = { MEs·DLFgen, MEs ≥ 0 MEs·DLFload, MEs < 0 (113) Energies 2024, 17, 13 16 of 31 TAs = { AGEs·MLFgen·SPs, AGEs ≥ 0 AGEs·MLFload·SPs, AGEs < 0 (114) 2.1.6. Levelised Cost of Storage Module The levelised cost of storage metrics that are output by the arbitrage model include the required average discharge price (RADP) and available average discharge price (AADP), originally presented by Belderbos et al. [33]. The overnight capital cost (OCC [$]) is calculated within this arbitrage model according to Equation (115). Energy capacity capital costs are given by CAPEXe [$/MWh], power capacity capital costs by CAPEXP [$/MW], power capacity by CP [MW] and fixed costs by CAPEXfixed [$]. If cost assumptions are only apportioned across power capacity, then it is important to only compare storage systems with the same energy capacity (e.g., a 6 h BESS with a 6 h PHS). OCC = CAPEXe·CE + CAPEXP·CP + CAPEXfixed (115) The RADP, outlined in Equation (116), specifies the average price of the energy that must be sold by the storage system to recover investment, operation and maintenance, and charging costs. It is expressed in units of [$/MWhd]. For the purposes of demonstrating this model, the storage system is assumed to be valueless and to have no disposal costs at the end of its system lifetime. Fixed operation and maintenance costs in year l are given by FOMl [$/MW]. Costs are discounted at a rate of δ each year over the system lifetime of Y [years]. RADP = OCC·Λ + ∑Y l=1((FOMl·CP·103 − ∑k ∑s TAl,k,s)·(1 + δ)−l) ∑Y l=1 ∑k ∑s MEl,k,s·(1 + δ)−l + ∑Y l=1 VOMl·(1 + δ)−y, MEl,k,s > 0, TAl,k,s < 0 (116) Within the RADP calculation, the overnight capital cost is modified by a tax factor (Λ), as shown in Equation (117). The tax factor was originally defined by Reichelstein and Yorston [55] and was included in the Appendix of Belderbos et al. [33]. Additional considerations, such as the corporate tax rate (λ), investment tax credits (ITC) and asset depreciation (σl for year l) are used to modify the overnight capital cost in order to provide a more realistic description of the upfront investment costs that must be recouped. Λ = 1 − ITC − λ·(1 − ITC)·∑Y l=1 σl·(1 + δ)−l 1 − λ (117) The tax deduction based on the depreciation of the asset has been calculated according to the diminishing value method for post 9 May 2006 assets. Details of this method are defined in sections 40–72 of the Income Tax Assessment Act 1997 (Cth) [56]. The base value of the asset in year l (BVl [$]) is calculated according to Equation (118), assuming that the base value in the first year of ownership equals the overnight capital cost. The percentage of tax deduction is then specified using Equation (119). For the purposes of demonstrating this arbitrage model, the entire storage system is considered to be a single depreciating asset. If the model were used to evaluate specific storage systems in future, then it would be more appropriate to consider each component to be a depreciating asset. BVl = { OCC, l = 1 BVl−1 − BVl−1· max(kl−1) 365 · 200% Y , l > 1 (118) σl = BVl· max(kl−1) 365 · 200% Y OCC (119) Energies 2024, 17, 13 17 of 31 Dividing the discharged energy trading amounts by the amount of energy discharged for each year, ensuring that discounting is applied to each year, provides the AADP (see Equation (120)). AADP = ∑Y l=1 ∑k ∑s TAl,k,s·(1 + δ)−l ∑Y l=1 ∑k ∑s MEl,k,s(1 + δ)−l , MEl,k,s, TAl,k,s > 0 (120) 2.2. Model Assumptions For the PHS, it is assumed that the upper and lower reservoirs are cubes. Such an assumption means that heads can be expressed through the simple calculations provided in Equations (121) and (122). The full supply levels of the upper and lower reservoir are given by FSLur and FSLlr [m], while the minimum operating levels are given by MOLur and MOLlr [m]. The maximum volume of the lower reservoir is defined by Vlr [m]. Hp t = (SOCpre t ·(FSLur − MOLur) + MOLur − ((1 − SOCpre t )· Vur Vlr ·(FSLlr − MOLlr)) − MOLlr) + Hpl t (121) Ht t = (SOCpre t ·(FSLur − MOLur) + MOLur − ((1 − SOCpre t )· Vur Vlr ·(FSLlr − MOLlr)) − MOLlr) − Htl t (122) Furthermore, it is assumed that the ratio between the maximum pump head and minimum turbine head is approximately 1.4 [43]. The bandwidth within which the net head can exist is defined by relating the full supply levels and minimum operating levels of the upper and lower reservoirs at the boundaries, as per Equations (123)–(126). FSLur = hr + hur + hlr (123) FSLlr = hlr (124) FSLur − MOLlr + Hpl MOLur − FSLlr − Htl ≈ 1.4 (125) 1.4·(MOLur) + MOLlr ≈ hr + hur + 2hlr + Hpl + Htl (126) The cycle aging and calendar aging parameters used for the BESS are specific to A123s 2.3 Ah LFP/C cell technology [51,52,57]. A summary of these parameters is provided in Table 1. The arbitrage model uses linear interpolation to approximate these parameters as a function of SOC and the current. Table 1. Capacity Fade Parameters. Calendar Aging SOC 30% 65% 100% ACcal 7.34 × 105 6.75 × 105 2.18 × 105 Eacal [J/mol] 73,369 69,804 56,937 AEcal 0.943 0.900 0.683 Cycle Aging Icell [A] 1 4 12 20 ACcyc 2.16 × 103 2.17 × 104 1.29 × 104 1.55 × 104 Eacyc [J/mol] 31,700 AEcyc 0.55 γ [J·mol−1·A−1] 370.3 It has been assumed that the discount rate is equal to the weighted average cost of the capital (WACC). WACC, the system lifetime, and operation and maintenance costs Energies 2024, 17, 13 18 of 31 were based on AEMO’s 2020 Inputs and assumptions workbook [58]; PHS capital costs were from the CSIRO’s GenCost 2020-21 consultation draft report [59]; and BESS capital costs were from AURECON’s 2020 Costs and Technical Review consultation report [60]. The parameters defining the cell voltage curve in Equations (33) and (34) were drawn from Zhang et al. [46], and the transition times for the pumped hydro system were provided through a consultation with SMEC [43]. The BESS system efficiency was equal to that used by Sakti et al. [14]. A company tax rate of 30% is assumed as per section 23(2)(b) of the Income Tax Rates Act 1986 (Cth) [56]. PHS penstock roughness and coefficients of the friction were informed by Mousavi et al. [39]. An order 4 polynomial was fitted to the efficiency curve for a Francis turbine with a unitary speed of 70 [rot/min] [42] to determine the turbine efficiency parameters in Equation (24). To incorporate imperfect forecasting into the model, AEMO pre-dispatch prices were used during the day-ahead scheduling [61]. These inputs should be considered upper bounds on the accuracy of the actual forecasting methods used by market participants. Piece-wise linear functions were developed to define the linearisation parameters used in the MILP scheduling model. The BESS power loss, as defined by Equation (127), was plotted and then partitioned into linear segments in Figure 2d [14]. Ploss = Pbatt ηvoltηsys ·(1 − ηvoltηsys) (127) Energies 2024, 16, x FOR PEER REVIEW 19 of 32 Figure 2. Piece-wise Linear Functions: (a) PHS Turbine Flow Rate Loss, (b) PHS Pump Flow Rate Loss, (c) BESS Maximum Power Limit, and (d) BESS Power Loss. 3. Results and Discussion 3.1. One-at-a-Time Sensitivity Analysis A one-at-a-time sensitivity analysis was conducted for a 100 MW/100 MWh BESS and a 100 MW/1200 MWh PHS using 2019 historical price data in the SA1 region of the NEM. Each parameter was varied from a baseline according to two low and two high scenarios: −20%, −10%, +10% and +20%, where possible. Spider plots relating the RADP and AADP changes to the parameter changes for notable variables are shown in Figures 3 and 4 [62]. The complete set of results from the sensitivity analysis is provided in Supplementary Information A. Figure 2. Piece-wise Linear Functions: (a) PHS Turbine Flow Rate Loss, (b) PHS Pump Flow Rate Loss, (c) BESS Maximum Power Limit, and (d) BESS Power Loss. The maximum power limit piece-wise linear function in Figure 2c ensures that the total efficiency (electrochemical and auxiliary) is always greater than 80%. Note that the BESS power loss and maximum power limit functions are updated before scheduling each day to account for efficiency fading. Figure 2a plots the piece-wise linear function defining turbine flow rate losses, with the 100% flow rate loss used to block scheduling in the region where cavitation conditions may occur. The pump flow rate piece-wise linear function in Figure 2b is used to prevent scheduling far away from the nominal flow rate. Energies 2024, 17, 13 19 of 31 3. Results and Discussion 3.1. One-at-a-Time Sensitivity Analysis A one-at-a-time sensitivity analysis was conducted for a 100 MW/100 MWh BESS and a 100 MW/1200 MWh PHS using 2019 historical price data in the SA1 region of the NEM. Each parameter was varied from a baseline according to two low and two high scenarios: −20%, −10%, +10% and +20%, where possible. Spider plots relating the RADP and AADP changes to the parameter changes for notable variables are shown in Figures 3 and 4 [62]. The complete set of results from the sensitivity analysis is provided in Supplementary Information A. Energies 2024, 16, x FOR PEER REVIEW 20 of 32 Figure 3. (a) RADP and (b) AADP Sensitivity Analysis Spider Plots for Key BESS Parameters. Figure 4. (a) RADP and (b) AADP Sensitivity Analysis Spider Plots for Key PHS Parameters. Figure 3. (a) RADP and (b) AADP Sensitivity Analysis Spider Plots for Key BESS Parameters. It was determined that RADP is dramatically reduced by increasing the system effi- ciency for the BESS or turbine efficiency for the PHS. An increase in the system efficiency or turbine efficiency also causes a significant increase in AADP. A low efficiency means the maximum power limit reduces for all SOCs, so the system is both bidding/offering lower capacities and experiencing higher energy losses on the dispatched power. These results align with the results of Walawalkar et al. [34] and Biggins et al. [63]. In contrast, McConnell et al. [19] concluded in their analysis of arbitrage in the NEM that revenue was relatively insensitive to round-trip efficiency. Their model did not consider the impact of efficiency on the settlement amounts calculated according to their objective function. Furthermore, if we assume that arbitrage revenue is highly dependent upon peak pricing events, as McConnell et al. suggested, then we might expect the storage system to discharge at a maximum power during these periods. With a low discharge efficiency, the storage system cannot dispatch as much energy into the grid during the high pricing event. Simplifying the arbitrage model to use a round-trip efficiency is a limitation that can impact arbitrage revenue calculations. Energies 2024, 17, 13 20 of 31 Energies 2024, 16, x FOR PEER REVIEW 20 of 32 Figure 3. (a) RADP and (b) AADP Sensitivity Analysis Spider Plots for Key BESS Parameters. Figure 4. (a) RADP and (b) AADP Sensitivity Analysis Spider Plots for Key PHS Parameters. Figure 4. (a) RADP and (b) AADP Sensitivity Analysis Spider Plots for Key PHS Parameters. The RADP was also found to be highly sensitive to both generator MLF and load MLF. Small changes in the load MLF also caused significant changes to the AADP. The impact of a static MLF is expected to be less relevant if the NEM switches to using locational marginal pricing. For the BESS, the temperature of the system also strongly affects RADP, but does not significantly influence the AADP. At higher temperatures, the efficiency fading and capacity fading occur at a higher rate and the BESS degrades more rapidly, meaning that it experiences higher voltage losses and is unable to discharge for as long towards the end of its life. Lower total discharge time means that long-term costs must be covered using less energy, increasing the RADP. The reduction in discharged energy may not have as much of an influence on AADP, so long as the system maintains enough energy capacity to capture extreme price events. A 20% increase in power capacity costs was associated with a 7% and 5% increase in RADP for PHS and BESS, respectively. Increasing energy capacity costs by 20% resulted in a 7% increase in RADP for PHS and a 10% increase for BESS. AADP was unaffected by capital costs, since the bid/offer strategy is not affected by long-run costs. Since energy capacity capital costs are currently much higher for BESS than PHS, each percentage increase in cost will have a more significant impact on the BESS. The opposite is true for power capacity costs, since PHS pumps, turbines, and powerhouses are much more expensive than the power delivery components for BESS. It is important to note that the sensitivity of RADP to capital costs may also be dependent on the size of the energy storage system (power and energy capacity), but this dependence is not possible to derive through a one-at-a-time sensitivity analysis. The RADP and AADP are also both expected to be heavily influenced by the market conditions. Markets with lower price ceilings could significantly reduce AADP since the majority of arbitrage revenue is expected to be obtained from high price events [19]. Smaller price spreads (i.e., lower price volatility) may also reduce AADP and increase RADP through an increase in charging costs relative to the discharging revenue. The AADP and RADP for a 100 MWh BESS, 1200 MWh PHS, and 2400 MWh PHS were estimated using the arbitrage model based on historical price data for each NEM region from 2010 to 2020. Price volatility was calculated to be the standard deviation of the spot prices within Energies 2024, 17, 13 21 of 31 the year. A statistical dependence between AADP and the price volatility (p < 0.05) was found for all systems, as well as a statistical dependence between RADP and the price volatility for the PHS systems (p < 0.05) (refer Table 2). Due to their longer lifetime and lower energy capacity capital costs, the PHS RADP has a higher contribution from charging costs compared with the BESS, making it more sensitive to market price volatility. Table 2. Non-parametric Correlation between Levelised Cost of Storage Metrics on Price Volatility. Storage System Metric Kendall Tau-b for Metric vs. Price Volatility p-Value 1 h BESS RADP 0.1703 6.6260 × 10−2 12 h PHS RADP 0.2593 5.1912 × 10−3 24 h PHS RADP 0.2498 7.0751 × 10−3 1 h BESS AADP 0.4936 1.0306 × 10−7 12 h PHS AADP 0.4182 6.5388 × 10−6 24 h PHS AADP 0.4114 9.1825 × 10−6 3.2. Hedging Risk with Price Bands The difference between the forecast pre-dispatch price and the actual spot price for each trading interval in all NEM regions between 2010–2020 was calculated and plotted in Figure 5. Over 95% of trading intervals were forecast to be within 35 [$/MWh] of the actual spot price. Energies 2024, 16, x FOR PEER REVIEW 22 of 32 Table 2. Non-parametric Correlation between Levelised Cost of Storage Metrics on Price Volatility. Storage System Metric Kendall Tau-b for Metric vs. Price Volatility p-Value 1 h BESS RADP 0.1703 6.6260 × 10−2 12 h PHS RADP 0.2593 5.1912 × 10−3 24 h PHS RADP 0.2498 7.0751 × 10−3 1 h BESS AADP 0.4936 1.0306 × 10−7 12 h PHS AADP 0.4182 6.5388 × 10−6 24 h PHS AADP 0.4114 9.1825 × 10−6 3.2. Hedging Risk with Price Bands The diﬀerence between the forecast pre-dispatch price and the actual spot price for each trading interval in all NEM regions between 2010–2020 was calculated and plotted in Figure 5. Over 95% of trading intervals were forecast to be within 35 [$/MWh] of the actual spot price. Figure 5. Frequency Distribution of Errors in Forecast Pre-dispatch Price. The arbitrage model was used to determine RADP and AADP for a 100 MWh BESS, 1200 MWh PHS, and 2400 MWh PHS in each NEM region using historical price data from 2010 to 2020. All systems had a power capacity of 100 MW. The changes in RADP and AADP resulting from the switch from perfect to imperfect forecasting was calculated. The use of imperfect forecasting with no risk hedging resulted in a change of between −12% and +24% in RADP, and a change in AADP of between −0.72% and −50% relative to the perfect forecasting scenarios. In general, the BESS had a larger change in AADP than the PHS, with a maximum change of −50% compared to −25%, respectively. The shorter cycle time of the BESS in- creases the likelihood that the system misses important high-price events during its sched- uled discharge intervals compared to the PHS. Therefore, the uncertainty present in im- perfect forecasting poses a higher risk to the revenue of the BESS than the PHS. The simulation was repeated for the BESS in the SA1 region and both PHS systems in the QLD1 region. The historical energy bid and oﬀer price bands for the Hornsdale Power Reserve (DUIDs: HPRG1 and HPRL1) from 2018 to 2020 were used for the BESS. Figure 5. Frequency Distribution of Errors in Forecast Pre-dispatch Price. The arbitrage model was used to determine RADP and AADP for a 100 MWh BESS, 1200 MWh PHS, and 2400 MWh PHS in each NEM region using historical price data from 2010 to 2020. All systems had a power capacity of 100 MW. The changes in RADP and AADP resulting from the switch from perfect to imperfect forecasting was calculated. The use of imperfect forecasting with no risk hedging resulted in a change of between −12% and +24% in RADP, and a change in AADP of between −0.72% and −50% relative to the perfect forecasting scenarios. In general, the BESS had a larger change in AADP than the PHS, with a maximum change of −50% compared to −25%, respectively. The shorter cycle time of the BESS increases the likelihood that the system misses important high-price events during its Energies 2024, 17, 13 22 of 31 scheduled discharge intervals compared to the PHS. Therefore, the uncertainty present in imperfect forecasting poses a higher risk to the revenue of the BESS than the PHS. The simulation was repeated for the BESS in the SA1 region and both PHS systems in the QLD1 region. The historical energy bid and offer price bands for the Hornsdale Power Reserve (DUIDs: HPRG1 and HPRL1) from 2018 to 2020 were used for the BESS. Price bands for one pump and turbine from the Wivenhoe Power Station (DUIDs: PUMP1, W/HOE#1) from 2010 to 2020 were used for the PHS. A baseline RADP and AADP was calculated for each system in each year by assuming that there was no risk hedging (i.e., the system places a maximum price bid and minimum price offer for every interval). A risk level between 1 and 10 was then defined for each subsequent simulation, with lower risk levels choosing price bands closer to the forecast spot price (refer to Equations (106)–(109)). The absolute difference between the offer price or bid price with the pre-dispatch price in each trading interval was calculated to define an offer risk price and bid risk price. An average offer risk price and average bid risk price were then calculated for each simulation. The change in RADP and AADP relative to the baseline for each year was calculated; then, a Kendall Tau-b correlation coefficient was calculated with respect to the average offer risk prices and average bid risk prices. The non-parametric correlation is summarised in Table 3. The change in RADP and AADP from the baseline was correlated with the magnitude of the average offer and bid risk prices in all cases (p < 0.05). That is, consistently placing bids and offers closer to the forecast pre-dispatch price resulted in an increase in long-run marginal costs and a decrease in the long-run marginal revenue. Table 3. Kendall Tau-b Correlation between Levelised Cost of Storage Metrics and Risk Prices. Technology Variable 1 Variable 2 Kendall Tau-b p-Value BESS Average Offer Risk Price [$/MWh] Change in RADP [%] −0.40 1.2 × 10−3 Change in AADP [%] 0.36 4.2 × 10−3 Average Bid Risk Price [$/MWh] Change in RADP [%] −0.75 1.4 × 10−9 Change in AADP [%] 0.43 5.1 × 10−4 12 h PHS Average Offer Risk Price [$/MWh] Change in RADP [%] −0.33 7.7 × 10−8 Change in AADP [%] 0.39 4.0 × 10−10 Average Bid Risk Price [$/MWh] Change in RADP [%] −0.37 2.4 × 10−9 Change in AADP [%] 0.44 1.3 × 10−12 24 h PHS Average Offer Risk Price [$/MWh] Change in RADP [%] −0.37 2.0 × 10−9 Change in AADP [%] 0.38 6.3 × 10−10 Average Bid Risk Price [$/MWh] Change in RADP [%] −0.43 3.0 × 10−12 Change in AADP [%] 0.44 2.0 × 10−12 The amount of energy discharged by the system over its lifetime with any amount of risk hedging was reduced compared to no hedging, which would have worked to drive up the RADP and AADP. Although the cost of charging was reduced over the system lifetime for all risk hedging cases, it was not enough to cause a sizeable reduction in RADP, since the costs are primarily governed by capital costs and the tax factor. Upfront capital costs are not discounted, which exacerbates the impact of a reduction in discharged energy on the RADP. The BESS capital costs are a larger share of the overall system costs than the PHS system capital costs, meaning that the reduction in discharged energy had a greater impact on RADP for the BESS. This was evident in the very large Kendall Tau-b coefficient of Energies 2024, 17, 13 23 of 31 −0.75 when comparing the change in RADP from the baseline with the average bid risk price for the BESS. Revenue is evenly distributed across the lifetime of the system (since the spot prices and dispatch prices for a single year were assumed to repeat for the system lifetime), which means that the change in AADP would not be significantly impacted by discounting. If multiple years of price data were used in each simulation, the change in AADP could be dependent upon the discounting of high price events within the simulation period. The positive correlation between the change in AADP and average bid/offer risk prices indicates that the gross revenue decreased at a faster rate than the discharged energy at lower risk levels. Consistently placing bids and offers close to the forecast dispatch price may have resulted in more consistent revenue by avoiding discharging during low price events, but resulted in a lower long-run marginal revenue over the system lifetime. Although there were three cases where AADP increased relative to the baseline (risk level 1 for all systems in 2019), the reduction in discharging revenue typically led to an overall decrease in AADP for all simulations. The spot price is the time-weighted average of dispatch prices within the 30-min trading interval. Therefore, there are expected to be some dispatch prices that are higher and some that are lower than the spot price. If a price band close to the forecasted spot price is chosen, then it is likely that a number of bids and offers are lost by the storage system due to fluctuations in the dispatch prices. This effect would be exacerbated when there is a volatile dispatch price. Since the NEM has moved to 5 min settlement as of 1 October 2021, there may be value in exploring whether lower risk levels provide increased arbitrage value, since there is the possibility to hedge against the risk present in each individual dispatch interval. The static risk hedging strategy assigns the entire scheduled capacity into the chosen price band, which means that these results could be considered a lower bound on AADP and upper bound on RADP. Future investigations should seek to incorporate capacity-price curve optimisation into the scheduling module in order to maximise revenue, while still protecting the system from serious suboptimal scheduling. Robust or information gap decision theory algorithms are one avenue of incorporating this optimisation into the model. The optimisation of the capacity-price curve is expected to result in an increase in arbitrage revenue for modelled systems. 3.3. Comparison with Other Energy Arbitrage Models Existing arbitrage models that manage imperfect price forecasting risk generally have a high computational complexity, which reduces the time period over which the model can feasibly simulate. The energy arbitrage model presented in this paper is capable of both managing risk in the face of imperfect price forecasts, while maintaining the computational speed necessary to simulate the dispatch behaviour over the lifetime of the storage systems through a deterministic MILP. By simulating over the entire system lifetime, the levelised cost of storage (RADP and AADP) can be calculated and compared across systems that have very different lifetimes, capital costs and power/energy capacities. The lifetime simulation also allows the effects of battery degradation on RADP and AADP to be captured by the model. Rather than simply assuming constant values for efficiency within the MILP, piece- wise linearised descriptions of the non-linear charging behaviour of both PHS and BESS are included to maintain accuracy without compromising computational speed. Further descriptions of the arbitrage model behaviour and validation against expected results are provided in Supplementary Information B. The current version of the model is not capable of assessing the impact of cycling on the battery degradation during scheduling. That is, it will only consider short-term rewards when scheduling charging/discharging capacity, even if it causes rapid cycling that degrades the battery rapidly over the long-term. Arbitrage models developed by Wankmüller et al. and Ortega-Vazquez include a degradation cost within the MILP objective function to modify scheduling behaviour in a way that minimises cycle aging [12,64]. Bai Energies 2024, 17, 13 24 of 31 et al. also attempt to minimise battery degradation during scheduling [27]. Developing a method of optimising a degradation cost and incorporating it into our arbitrage model is a topic for future work. This new model also only considers participation within a day-ahead energy pool market. Energy storage systems are expected to co-participate in energy pool, ancillary service, and contract markets within liberalised electricity markets. Some existing energy storage models co-optimise participation in both the energy market and ancillary services market [25,65–67]. These models may be preferred if only short-run costs are relevant to a particular analysis. They are not, however, designed to rapidly optimise over the lifetime of a storage system. 4. Conclusions An open-source modular energy arbitrage model was developed which enables two different storage technologies, Li-ion BESS and synchronous PHS, to be optimised in an energy spot market. The model incorporated bid and offer capacity-price curve inputs and the levelised cost of storage metric outputs. Previous energy arbitrage models that include bid/offer price strategies for managing the risk of imperfect price forecasting are computationally intensive and thus infeasible for analysing lifetime levelised costs or revenue without access to expensive computational resources. Due to significant differences in the power capacity cost, energy capacity cost, and project lifetime between BESS and PHS systems, it is essential to compare these technologies during the scenario analysis using levelised metrics. The use of piece-wise linear functions in our MILP scheduling module was determined to be an appropriate method for increasing model accuracy without a significant increase in computation time. It was noted during testing, though, that attempting to partition non-linear functions along two variables (e.g., the flow rate loss partitioned along the flow rate and head) would dramatically slow down the optimisation. Therefore, it is still sometimes necessary to approximate some non-linear behaviour using constant parameters (e.g., effective head) during scheduling with a MILP. The significant increase in computation time caused by partitioning a function along two variables is consistent with the analysis presented in Sakti et al. [14]. The one-at-a-time sensitivity analysis for the BESS and PHS using 2019 SA1 region price data suggested that both RADP and AADP were highly sensitive to efficiency and static loss factors. The sensitivity to efficiency contradicts the results from McConnell et al. [19] but aligns with the results from Walawalkar et al. [34] and Biggins et al. [63]. McConnell et al. [19] did not consider the fact that a lower round-trip efficiency could indicate a lower discharging efficiency, effectively limiting the amount of energy that could physically be discharged during a high-price event. The BESS outputs were also highly sensitive to the temperature, which supports the suggestion by Wankmüller et al. [12] that battery aging has a significant impact on arbitrage revenue. Within the case study, the use of imperfect price forecasting was found to increase RADP by up to 24% and decrease AADP by up to 50% relative to the perfect price forecast- ing, despite 95% of forecast prices being within 35 [$/MWh] of the actual trading price. A risk hedging method involving the use of a static risk level to select bid/offer price bands was integrated into the arbitrage model. Historical energy bids and offers from the Hornsdale Power Reserve and Wivenhoe Power Station were used to define price bands for the BESS and PHS systems. In nearly all cases, consistently placing bids/offers close to the forecast price was correlated with an increase in RADP (up to +42% for 1 h BESS and up to 20% for 24 h PHS) and a decrease in AADP (down to −7.1% for 1 h BESS and down to −12% for 24 h PHS). The reduced arbitrage revenue appeared to result from the decrease in total discharged energy outpacing the reduction in charging costs, leading to overall increases in long-run marginal costs and a reduction in revenue. Since capital costs were significantly higher than lifetime charging costs for the 1 h battery, the RADP was more Energies 2024, 17, 13 25 of 31 significantly affected by the reduction in discharged energy compared to both the 12 h and 24 h PHS systems. Future work will include: • It is possible that the method would provide increased value in a 5 min settlement analysis. Additionally, integrating a capacity-price pair optimisation into the schedul- ing module, such as a robust or information gap decision theory algorithm, would be expected to maximise the arbitrage revenue while still protecting the system from scheduling during suboptimal events. The impact of such an algorithm on optimisa- tion time would need to be considered to ensure that the model could still generate lifetime levelised cost and revenue metrics. • The current version of the BESS scheduling module does not account for the long-term impact of battery degradation on arbitrage revenue. Including a degradation cost in the MILP objective function may modify the scheduling behaviour to minimise cycle aging, further increasing the arbitrage revenue. • A detailed econometric analysis can be performed to determine the influence of vari- ables within the electricity market on RADP and AADP. The econometric analysis could help to tailor risk hedging strategies for BESS and PHS under various market conditions. The charging and scheduling modules will also be expanded to consider other storage systems, such as compressed air energy storage and alternative battery technologies (e.g., nickel, zinc-hybrid or redox-flow batteries). Due to its modular na- ture, this arbitrage model can be readily extended to analyse alternative energy storage systems by integrating a scheduling and charging module for that storage system. Supplementary Materials: The following supporting information can be downloaded at: https: //www.mdpi.com/article/10.3390/en17010013/s1. Supplementary Information A: Assumptions and Results Workbook. Supplementary Information B: Model Validation. References [68–71] are cited in supplementary materials. Author Contributions: T.W.: Methodology, Software, Validation, Formal Analysis, Investigation, Data Curation and Writing—original draft preparation. B.L., Conceptualisation, Writing—review and editing and Supervision. All authors have read and agreed to the published version of the manuscript. Funding: This work was supported by computational resources provided by the Australian Govern- ment through the National Computational Infrastructure under the ANU Merit Allocation Scheme (project ID mg82). Data Availability Statement: The open-source energy arbitrage model software is available at: https://github.com/TimWeberRE100/Energy_Arbitrage_Model (accessed on 10 March 2023). His- torical dispatch prices, spot prices, predispatch spot prices, and dispatchable unit bid/offer price bands for the National Electricity Market are available at: https://aemo.com.au/en/energy-systems/ electricity/national-electricity-market-nem/data-nem/market-data-nemweb (accessed on 16 May 2021). Cycle aging and calendar aging parameters for the battery system are available at https://doi. org/10.1016/j.apenergy.2016.03.119, https://doi.org/10.1016/j.jpowsour.2010.11.134, and https:// doi.org/10.1149/04513.0073ecst. Cost data for the storage systems are available at https://aemo.com. au/-/media/files/electricity/nem/planning_and_forecasting/inputs-assumptions-methodologies/ 2020/2020-inputs-and-assumptions-workbook-dec20.xlsx?la=en (accessed on 12 June 2021), https:// www.csiro.au/-/media/News-releases/2020/renewables-cheapest/GenCost2020-21.pdf (accessed on 18 September 2021), and https://aemo.com.au/-/media/files/electricity/nem/planning_and_ forecasting/inputs-assumptions-methodologies/2021/aurecon-cost-and-technical-parameters-review- 2020.pdf?la=en (accessed on 18 September 2021). Cell voltage curve parameters are available at https://doi.org/10.3390/en11092408. Pumped hydro penstock roughness, coefficients of friction and turbine efficiency curves are available at https://doi.org/10.1016/j.apenergy.2019.03.015 and http://anale-ing.uem.ro/2015/13.pdf. Data output by the energy arbitrage model and analysed within this paper are available in the supplementary information files or on request from the corre- sponding author. Energies 2024, 17, 13 26 of 31 Acknowledgments: Appreciation is given to the expertise of Jeremy Kent-Johnston who provided guidance on the pumped hydro charging module and assumptions. Thanks also to Nigel Hicks for the discussion regarding grid-scale batteries and Andrew Blakers for his feedback on the manuscript. Conflicts of Interest: The authors declare that they have no known competing financial interest or personal relationships that could have appeared to influence the work reported in this paper. Abbreviations Abbreviations AADP Available average discharge price AEMC Australian Energy Market Commission AEMO Australian Energy Market Operator BESS Battery energy storage system CBC COIN-OR Branch-and-Cut DLF Distribution loss factor DUID Dispatchable unit identifier LCOS Levelised cost of storage MILP Mixed-integer linear programming MLF Marginal loss factor NEM National Electricity Market NER National Electricity Rules O&M Operation and maintenance PHS Pumped hydro storage RADP Required average discharge price the Rules The National Electricity Rules SOC State of charge VRE Variable renewable energy WACC Weighted average cost of capital Nomenclature Latin symbols a Size of a piece along the SOC axis of a maximum power limit piece-wise linear function, % AADP Available average discharge price, $/MWh AC Ageing coefficient, Ah/sAEcal (calendar ageing), Ah1−AEcyc (cycle ageing) AE Ageing exponent, dimensionless AGE Adjusted gross energy, MWh AhTh Amp-hour charging throughput, Ah AR Arbitrage revenue, $ b Size of a piece along the SOC axis of a maximum power limit piece-wise linear function, % B Bid price, $/MWh bp Bid price band, $/MWh BV Base value, $ c Size of a piece along the charging loss piece-wise linear function, m3/s (flow rate), MW (power) C Load bid capacity, MW CalN Number of calendar loss intervals, dimensionless CAPEX Capital cost, $/MWh (energy), $/MW (power), $ (fixed) CE Energy capacity, MWh CLT Calendar loss time, s CP Oower capacity, MW d Size of a piece along the discharging loss piece-wise linear function, m3/s (flow rate), MW (power) D Generator offer capacity, MW DLF Distribution loss factor, % DP Dispatch price, $/MWh dV Transient adjustment to water volume, m3 E Optimal energy charged/discharged, MWh Energies 2024, 17, 13 27 of 31 Ea Ageing activation energy, J/mol F Friction factor, dimensionless FOM Fixed operation and maintenance cost, $/kW FSL Full supply level, m g Acceleration due to gravity, 9.81 m/s2 h Vertical height, m H Head, m I Current, A ii Value of index i, dimensionless ir Internal resistance, Ω ITC Investment tax credit, % jj Value of index j, dimensionless K Resistance coefficient L Penstock pipe length, m ME Exported energy, MWh MLF Marginal loss factor, % mm Value of index m, dimensionless MOL Minimum operating level, m N Quantity, dimensionless n Fraction of piece c used, % nn Value of open-circuit voltage fitting parameter, dimensionless O Offer price, $/MWh OCC Overnight capital cost, $ op Offer price band. $/MWh p Fraction of piece d used, % P Power, MW PD Penstock pipe diameter, m q Fraction of piece c used, % Q Flow rate, m3/s R Universal gas constant, 8.314 J/K·mol RADP Required average discharge price, $/MWh RL Risk level, {1,10} RT Ramp time, s Re Reynolds number, dimensionless S Scheduling forecast horizon sl Gradient of a piece-wise linear function SOC State of charge, % SOH State-of-health, % SP Spot price, $/MWh ST Duration of operation, months T Temperature, K TA Trading amount, $ U Open-circuit voltage, V uu Value of index u, dimensionless V Volume, m3 VOM Variable operation and maintenance cost, $/MWh vv Value of index v, dimensionless w Charging/discharging decision, {0,1} WV Water velocity, m/s x Fraction of piece a used, % y Fraction of piece b used, % Y Estimated system lifetime, years z Piece behaviour, {0,1} Greek symbols α Fraction of maximum power that could be used, dimensionless β Average SOC, % γ Coefficient for ageing acceleration, Jmol−1A−1 δ Discount rate, % Energies 2024, 17, 13 28 of 31 ε Absolute roughness, m η Efficiency, % λ Effective corporate income tax rate, % Λ Tax factor, % µ Dynamic viscosity of water, 8.9 × 10−4 Pa·s ξ First fitting parameter of empirical function, dimensionless ρ Water density, 997 kg/m3 σ Allowable tax depreciation charge, % τ Dispatch interval length, h ϕ Second fitting parameter of empirical function, dimensionless χ Third fitting parameter of empirical function, dimensionless Subscripts e Energy parameter effective Constant approximation of variable fixed Fixed parameter g Pump system index gen Parameter associated with the generator DUID h Turbine system index i Piece of the piece-wise linear function for maximum discharge power limit initial Initial value at the start of the trading day j Piece of the piece-wise linear function for maximum charge power limit k Day index l Year index load Parameter associated with the load DUID m Piece of the piece-wise linear function for charge/discharge power loss max Maximum possible value for a variable min Minimum possible value for a variable n Open-circuit voltage fitting parameter nom Nominal P Power parameter peak Value at peak efficiency point s Trading interval index t Dispatch interval index u Bid band index v Offer band index Supercripts avg Average batt Battery parameter c Variable or parameter associated with charging battery cal Calendar ageing parameter cal loss Loss due to calendar ageing cell Cell parameter cyc Cycle ageing parameter cyc loss Loss due to cycle ageing d Variable or parameter associated with discharging battery disp Dispatch instruction fittings Penstock fittings loss Variable or parameter associated with the piece-wise function for flow rate/power loss lr Lower reservoir (internal) lwl Lower water level relative to bottom of lower reservoir p Variable or parameter associated with a pump parallel Cell groups in parallel peak Parameter when system is at peak flow rate pipe Penstock pipe pl Pump loss pre Previous pd Predispatch Energies 2024, 17, 13 29 of 31 P←TNL Pump operation to turbine no load r Bottom of upper reservoir to top of lower reservoir rel Relative sch Scheduled series Cell groups in series sys Auxiliary system t Variable or parameter associated with a turbine test Test variable tl Turbine loss T←TNL Turbine operation to turbine no load TNL→P Turbine no load to pump operation TNL→T Turbine no load to turbine operation ur Upper reservoir (internal) uwl Upper water level relative to bottom of upper reservoir volt Voltage References 1. IRENA. Renewable Capacity Statistics 2023; The International Renewable Energy Agency: Abu Dhabi, United Arab Emirates, 2023. 2. Da Silva, P.P.; Horta, P. The effect of variable renewable energy sources on electricity price volatility: The case of the Iberian market. Int. J. Sustain. Energy 2019, 38, 794–813. [CrossRef] 3. Rintamäki, T.; Siddiqui, A.S.; Salo, A. Does renewable energy generation decrease the volatility of electricity prices? An analysis of Denmark and Germany. Energy Econ. 2017, 62, 270–282. [CrossRef] 4. Wozabal, D.; Graf, C.; Hirschmann, D. The effect of intermittent renewables on the electricity price variance. OR Spectr. 2015, 38, 687–709. [CrossRef] 5. Johnson, E.P.; Oliver, M.E. Renewable Generation Capacity and Wholesale Electricity Price Variance. Energy J. 2019, 40, 143–168. [CrossRef] 6. Rai, A.; Nunn, O. On the impact of increasing penetration of variable renewables on electricity spot price extremes in Australia. Econ. Anal. Policy 2020, 67, 67–86. [CrossRef] [PubMed] 7. Maniatis, G.I.; Milonas, N.T. The impact of wind and solar power generation on the level and volatility of wholesale electricity prices in Greece. Energy Policy 2022, 170, 113243. [CrossRef] 8. Maciejowska, K. Assessing the impact of renewable energy sources on the electricity price level and variability—A quantile regression approach. Energy Econ. 2019, 85, 104532. [CrossRef] 9. Tselika, K. The impact of variable renewables on the distribution of hourly electricity prices and their variability: A panel approach. Energy Econ. 2022, 113, 106194. [CrossRef] 10. Denholm, P.; Ela, A.; Kirby, B.; Milligan, M. The Role of Energy Storage with Renewable Electricity Generation; National Renewable Energy Laboratory: Golden, CO, USA, 2010. 11. Akhil, A.; Huff, G.; Currier, A.; Kaun, B.; Rastler, D.; Chen, S.; Cotter, A.; Bradshaw, D.; Gauntlett, W. Electricity Storage Handbook in Collaboration with NRECA; Sandi National Laboratories: Albuquerque, NM, USA; Livermore, CA, USA, 2015. 12. Wankmüller, F.; Thimmapuram, P.R.; Gallagher, K.G.; Botterud, A. Impact of battery degradation on energy arbitrage revenue of grid-level energy storage. J. Energy Storage 2017, 10, 56–66. [CrossRef] 13. Arcos-Vargas, A.; Canca, D.; Núñez, F. Impact of Battery Technological Progress on Electricity Arbitrage: An Application to the Iberian market. Appl. Energy 2020, 260, 114273. [CrossRef] 14. Sakti, A.; Gallagher, K.G.; Sepulveda, N.; Uckun, C.; Vergara, C.; de Sisternes, F.J.; Dees, D.W.; Botterud, A. Enhanced representa- tions of lithium-ion batteries in power systems models and their effect on the valuation of energy arbitrage applications. J. Power Sources 2017, 342, 279–291. [CrossRef] 15. Fares, R.L.; Webber, M.E. A flexible model for economic operational management of grid battery energy storage. Energy 2014, 78, 768–776. [CrossRef] 16. Zareipour, H.; Janjani, A.; Leung, H.; Motamedi, A.; Schellenberg, A. Classification of Future Electricity Market Prices. IEEE Trans. Power Syst. 2010, 26, 165–173. [CrossRef] 17. Antweiler, W. Microeconomic models of electricity storage: Price Forecasting, arbitrage limits, curtailment insurance, and transmission line utilization. Energy Econ. 2021, 101, 105390. [CrossRef] 18. Sioshansi, R.; Denholm, P.; Jenkin, T.; Weiss, J. Estimating the value of electricity storage in PJM: Arbitrage and some welfare effects. Energy Econ. 2009, 31, 269–277. [CrossRef] 19. McConnell, D.; Forcey, T.; Sandiford, M. Estimating the value of electricity storage in an energy-only wholesale market. Appl. Energy 2015, 159, 422–432. [CrossRef] 20. Connolly, D.; Lund, H.; Finn, P.; Mathiesen, B.; Leahy, M. Practical operation strategies for pumped hydroelectric energy storage (PHES) utilising electricity price arbitrage. Energy Policy 2011, 39, 4189–4196. [CrossRef] 21. Thatte, A.A.; Xie, L.; Viassolo, D.E.; Singh, S. Risk Measure Based Robust Bidding Strategy for Arbitrage Using a Wind Farm and Energy Storage. IEEE Trans. Smart Grid 2013, 4, 2191–2199. [CrossRef] Energies 2024, 17, 13 30 of 31 22. Khani, H.; Dadash Zadeh, M.R. Real-Time Optimal Dispatch and Economic Viability of Cryogenic Energy Storage Exploiting Arbitrage Opportunities in an Electricity Market. IEEE Trans. Smart Grid 2015, 6, 391–401. [CrossRef] 23. Zamani-Dehkordi, P.; Chitsaz, H.; Rakai, L.; Zareipour, H. A price signal prediction method for energy arbitrage scheduling of energy storage systems. Int. J. Electr. Power Energy Syst. 2020, 122, 106122. [CrossRef] 24. Cao, J.; Harrold, D.; Fan, Z.; Morstyn, T.; Healey, D.; Li, K. Deep Reinforcement Learning-Based Energy Storage Arbitrage With Accurate Lithium-Ion Battery Degradation Model. IEEE Trans. Smart Grid 2020, 11, 4513–4521. [CrossRef] 25. Cheng, B.; Powell, W. Co-Optimizing Battery Storage for the Frequency Regulation and Energy Arbitrage Using Multi-Scale Dynamic Programming. IEEE Trans. Smart Grid 2018, 9, 1997–2005. [CrossRef] 26. Díaz, G.; Gómez-Aleixandre, J.; Coto, J.; Conejero, O. Maximum income resulting from energy arbitrage by battery systems subject to cycle aging and price uncertainty from a dynamic programming perspective. Energy 2018, 156, 647–660. [CrossRef] 27. Bai, Y.; Wang, J.; He, W. Energy arbitrage optimization of lithium-ion battery considering short-term revenue and long-term battery life loss. In Proceedings of the 7th International Conference on Advances on Clean Energy Research (ICACER), Lille, France, 27–29 April 2024; pp. 364–371. 28. Krishnamurthy, D.; Uckun, C.; Zhou, Z.; Thimmapuram, P.R.; Botterud, A. Energy Storage Arbitrage Under Day-Ahead and Real-Time Price Uncertainty. IEEE Trans. Power Syst. 2017, 33, 84–93. [CrossRef] 29. Tian, M.-W.; Yan, S.-R.; Tian, X.-X.; Nojavan, S.; Jermsittiparsert, K. Risk and profit-based bidding and offering strategies for pumped hydro storage in the energy market. J. Clean. Prod. 2020, 256, 120715. [CrossRef] 30. Li, Z.; Zhang, Q.; Guo, Q.; Nojavan, S. RETRACTED: Pumped hydro energy storage arbitrage in the day-ahead market in smart grid using stochastic p-robust optimization method. Sustain. Cities Soc. 2021, 75, 103274. [CrossRef] 31. Shafiee, S.; Zareipour, H.; Knight, A.M.; Amjady, N.; Mohammadi-Ivatloo, B. Risk-Constrained Bidding and Offering Strategy for a Merchant Compressed Air Energy Storage Plant. IEEE Trans. Power Syst. 2016, 32, 1. [CrossRef] 32. Shafiee, S.; Zareipour, H.; Knight, A.M. Developing Bidding and Offering Curves of a Price-Maker Energy Storage Facility Based on Robust Optimization. IEEE Trans. Smart Grid 2017, 10, 650–660. [CrossRef] 33. Belderbos, A.; Delarue, E.; Kessels, K.; D’haeseleer, W. Levelized cost of storage—Introducing novel metrics. Energy Econ. 2017, 67, 287–299. [CrossRef] 34. Walawalkar, R.; Apt, J.; Mancini, R. Economics of electric energy storage for energy arbitrage and regulation in New York. Energy Policy 2007, 35, 2558–2568. [CrossRef] 35. Hart, W.E.; Laird, C.D.; Watson, J.-P.; Woodruff, D.L.; Hackebeil, G.A.; Nicholson, B.L.; Siirola, J.D. Pyomo—Optimization Modeling in Python, 2nd ed.; Springer: Berlin/Heidelberg, Germany, 2017. 36. Hart, W.E.; Watson, J.-P.; Woodruff, D.L. Pyomo: Modeling and solving mathematical programs in Python. Math. Program. Comput. 2011, 3, 219–260. [CrossRef] 37. Forrest, J.J.; Vigerske, S.; Santos, H.G.; Ralphs, T.; Hafer, L.; Kristjansson, B.; jpfasano; EdwinStraver; Lubin, M.; rlougee; et al. coin-or/Cbc: Version 2.10.5, COIN-OR. 2020. Available online: https://zenodo.org/badge/latestdoi/173509563 (accessed on 5 September 2021). 38. Nag, S.; Lee, K.Y.; Suchitra, D. A Comparison of the Dynamic Performance of Conventional and Ternary Pumped Storage Hydro. Energies 2019, 12, 3513. [CrossRef] 39. Mousavi, N.; Kothapalli, G.; Habibi, D.; Khiadani, M.; Das, C. An improved mathematical model for a pumped hydro storage system considering electrical, mechanical, and hydraulic losses. Appl. Energy 2019, 247, 228–236. [CrossRef] 40. Sun, J. Hydraulic Machinery. In Davis’ Handbook of Applied Hydraulics; Zipparro, V., Hasen, H., Eds.; McGraw Hill: New York, NY, USA, 1993; p. 21.23. 41. Chen, H. Pumped Storage. In Davis’ Handbook of Applied Hydraulics; Zipparro, V., Hasen, H., Eds.; McGraw Hill: New York, NY, USA, 1993; p. 20.23. 42. Bostan, A.; Dorian, N.; Peris-Bendu, F. The Hill Chart Calculation for Francis Runner Models using the HydroHillChart—Francis Module Software. Analele Univ. Eftimie Murgu Re¸si¸ta 2015, 22, 107–116. 43. Kent-Johnston, J.; SMEC. Energy Arbitrage Undergraduate Research Interview via Zoom to Timothy Weber. 29 July; 2021. 44. Darling, R.M.; Gallagher, K.G.; Kowalski, J.A.; Ha, S.; Brushett, F.R. Pathways to low-cost electrochemical energy storage: A comparison of aqueous and nonaqueous flow batteries. Energy Environ. Sci. 2014, 7, 3459–3477. [CrossRef] 45. Rancilio, G.; Merlo, M.; Lucas, A.; Kotsakis, E.; Delfanti, M. BESS modeling: Investigating the role of auxiliary system consumption in efficiency derating. In Proceedings of the 2020 International Symposium on Power Electronics, Electrical Drives, Automation and Motion, Sorrento, Italy, 24–26 June 2020; pp. 189–194. 46. Zhang, R.; Xia, B.; Li, B.; Cao, L.; Lai, Y.; Zheng, W.; Wang, H.; Wang, W.; Wang, M. A Study on the Open Circuit Voltage and State of Charge Characterization of High Capacity Lithium-Ion Battery Under Different Temperature. Energies 2018, 11, 2408. [CrossRef] 47. Ahmadi, L.; Yip, A.; Fowler, M.; Young, S.B.; Fraser, R.A. Environmental feasibility of re-use of electric vehicle batteries. Sustain. Energy Technol. Assess. 2014, 6, 64–74. [CrossRef] 48. Woody, M.; Arbabzadeh, M.; Lewis, G.M.; Keoleian, G.A.; Stefanopoulou, A. Strategies to limit degradation and maximize Li-ion battery service lifetime—Critical review and guidance for stakeholders. J. Energy Storage 2020, 28, 101231. [CrossRef] 49. Spotnitz, R. Simulation of capacity fade in lithium-ion batteries. J. Power Sources 2003, 113, 72–80. [CrossRef] Energies 2024, 17, 13 31 of 31 50. Stroe, D.-I.; Swierczynski, M.; Kar, S.K.; Teodorescu, R. Degradation Behavior of Lithium-Ion Batteries During Calendar Ageing— The Case of the Internal Resistance Increase. In Proceedings of the 8th Annual IEEE Energy Conversion Congress and Exposition (ECCE), Nashville, TN, USA, 29 October–2 November 2023; pp. 517–525. 51. Petit, M.; Prada, E.; Sauvant-Moynot, V. Development of an empirical aging model for Li-ion batteries and application to assess the impact of Vehicle-to-Grid strategies on battery lifetime. Appl. Energy 2016, 172, 398–407. [CrossRef] 52. Wang, J.; Liu, P.; Hicks-Garner, J.; Sherman, E.; Soukiazian, S.; Verbrugge, M.; Tataria, H.; Musser, J.; Finamore, P. Cycle-life model for graphite-LiFePO4 cells. J. Power Sources 2011, 196, 3942–3948. [CrossRef] 53. National Electricity Rules version 204 (SA). Available online: https://energy-rules.aemc.gov.au/ner/499 (accessed on 18 September 2021). 54. AEMC. Interim Report: Transmission Access Reform: Updated Technical Specifications and Cost-Benefit Analysis. 7 September 2020. Available online: https://www.aemc.gov.au/sites/default/files/2020-09/Interim%20report%20-%20transmission%20 access%20reform%20-%20Updated%20technical%20specifications%20and%20cost-benefit%20analysis%202020_09_07.PDF (ac- cessed on 11 October 2022). 55. Reichelstein, S.; Yorston, M. The prospects for cost competitive solar PV power. Energy Policy 2013, 55, 117–127. [CrossRef] 56. Income Tax Assessment Act 1997 (Cth). 1997. Available online: https://www.legislation.gov.au/Details/C2023C00472 (accessed on 18 September 2021). 57. Grolleau, S.; Molina-Concha, B.; Delaille, A.; Revel, R.; Bernard, J.; Pélissier, S.; Peter, J. The French SIMCAL Research Network For Modelling of Calendar Aging for Energy Storage System in EVs And HEVs—EIS Analysis on LFP/C Cells. ECS Trans. 2013, 45, 73–81. [CrossRef] 58. AEMO. Current Inputs, Assumptions and Scenarios. 11 December 2020. Available online: https://aemo.com.au/-/media/ files/electricity/nem/planning_and_forecasting/inputs-assumptions-methodologies/2020/2020-inputs-and-assumptions- workbook-dec20.xlsx?la=en (accessed on 12 June 2021). 59. Graham, P.; Hayward, J.; Foster, J.; Havas, L.; CSIRO. GenCost 2020–21 Consultation Draft. December 2020. Available online: https://www.csiro.au/-/media/News-releases/2020/renewables-cheapest/GenCost2020-21.pdf (accessed on 18 September 2021). 60. Moss, S.; AURECON. 2020 Costs and Technical Parameters Review Consultation Report. 10 December 2020. Available on- line: https://aemo.com.au/-/media/files/electricity/nem/planning_and_forecasting/inputs-assumptions-methodologies/2021 /aurecon-cost-and-technical-parameters-review-2020.pdf?la=en (accessed on 18 September 2021). 61. AEMO. Pre-Dispatch (SO_OP_3704). 2021. Available online: https://www.aemo.com.au/-/media/files/electricity/nem/5ms/ procedures-workstream/stakeholder-consultation/dispatch-procedures/so_op_3704---predispatch---marked-up.pdf (accessed on 16 May 2021). 62. Saraiva, J.P.; Lima, B.S.; Gomes, V.M.; Flores, P.H.R.; Gomes, F.A.; Assis, A.O.; Reis, M.R.C.; Araujo, W.R.H.; Abrenhosa, C.; Calixto, W.P. Calculation of sensitivity index using one-at-a-time measures based on graphical analysis. In Proceedings of the 2017 18th International Scientific Conference on Electric Power Engineering (EPE), Kouty nad Desnou, Czech Republic, 17–19 May 2017; pp. 1–6. 63. Biggins, F.; Ejeh, J.; Brown, S. Going, Going, Gone: Optimising the bidding strategy for an energy storage aggregator and its value in supporting community energy storage. Energy Rep. 2022, 8, 10518–10532. [CrossRef] 64. Ortega-Vazquez, M.A. Optimal scheduling of electric vehicle charging and vehicle-to-grid services at household level including battery degradation and price uncertainty. IET Gener. Transm. Distrib. 2014, 8, 1007–1016. [CrossRef] 65. Biggins, F.; Homan, S.; Ejeh, J.; Brown, S. To trade or not to trade: Simultaneously optimising battery storage for arbitrage and ancillary services. J. Energy Storage 2022, 50, 104234. [CrossRef] 66. Gundogdu, B.M.; Gladwin, D.T.; Nejad, S.; Stone, D.A. Scheduling of grid-tied battery energy storage system participating in frequency response services and energy arbitrage. IET Gener. Transm. Distrib. 2019, 13, 2930–2941. [CrossRef] 67. Pusceddu, E.; Zakeri, B.; Gissey, G.C. Synergies between energy arbitrage and fast frequency response for battery energy storage systems. Appl. Energy 2020, 283, 116274. [CrossRef] 68. SMA. SUNNY TRIPOWER 15000TL/20000TL/25000TL. 2021. Available online: https://files.sma.de/downloads/STP15-25TL- 30-DS-en-41.pdf?_ga=2.240538051.1910003011.1633326314-555238174.1633326314 (accessed on 4 October 2021). 69. Tesla. Tesla, Inc. Annual Report on Form 10-K for the Year Ended December 31. 2019. Available online: https://www.sec.gov/ Archives/edgar/data/1318605/000156459020004475/tsla-10k_20191231.htm (accessed on 19 September 2021). 70. Sangal, S.; Garg, A.; Kumar, D. Review of optimal selection of turbines for hydroelectric projects. Int. J. Emerg. Technol. Adv. Eng. 2013, 3, 424–430. 71. Avellan, F. Introduction to cavitation in hydraulic machinery. In Proceedings of the 6th International Conference on Hydraulic Machinery and Hydrodynamics, Timisoara, Romania, 21–22 October 2004; pp. 11–22. Disclaimer/Publisher’s Note: The statements, opinions and data contained in all publications are solely those of the individual author(s) and contributor(s) and not of MDPI and/or the editor(s). MDPI and/or the editor(s) disclaim responsibility for any injury to people or property resulting from any ideas, methods, instructions or products referred to in the content.","libVersion":"0.3.2","langs":""}