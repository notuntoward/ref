{"path":"lit/lit_sources/Smith10ModelingLongitudinalDataSupplement.pdf","text":"This article was downloaded by: [Dalhousie University] On: 28 December 2012, At: 03:38 Publisher: Taylor & Francis Informa Ltd Registered in England and Wales Registered Number: 1072954 Registered office: Mortimer House, 37-41 Mortimer Street, London W1T 3JH, UK Journal of the American Statistical Association Publication details, including instructions for authors and subscription information: http://amstat.tandfonline.com/loi/uasa20 Modeling Longitudinal Data Using a Pair-Copula Decomposition of Serial Dependence Michael Smith, Aleksey Min, Carlos Almeida and Claudia Czado Michael Smith is Professor of Management, Melbourne Business School, University of Melbourne, 200 Leicester Street, Carlton, VIC, 3053, Australia . Aleksey Min is Postdoctoral Fellow, Carlos Almeida is Postdoctoral Fellow, and Claudia Czado is Chair of Mathematical Statistics, Zentrum Mathematik, Technische Universität München, 85748 Garching, Germany. The work of Michael Smith was partially supported by Australian Research Council grant DP0985505. Claudia Czado and Carlos Almeida gratefully acknowledge the financial support from the Deutsche Forschungsgemeinschaft (Cz 86/1-3: Statistical inference for high dimensional dependence models using pair- copulas). The authors thank three referees and associate editor, all of whom made comments that improved the paper. Version of record first published: 01 Jan 2012. To cite this article: Michael Smith, Aleksey Min, Carlos Almeida and Claudia Czado (2010): Modeling Longitudinal Data Using a Pair-Copula Decomposition of Serial Dependence, Journal of the American Statistical Association, 105:492, 1467-1479 To link to this article: http://dx.doi.org/10.1198/jasa.2010.tm09572 PLEASE SCROLL DOWN FOR ARTICLE Full terms and conditions of use: http://amstat.tandfonline.com/page/terms-and-conditions This article may be used for research, teaching, and private study purposes. Any substantial or systematic reproduction, redistribution, reselling, loan, sub-licensing, systematic supply, or distribution in any form to anyone is expressly forbidden. The publisher does not give any warranty express or implied or make any representation that the contents will be complete or accurate or up to date. The accuracy of any instructions, formulae, and drug doses should be independently verified with primary sources. The publisher shall not be liable for any loss, actions, claims, proceedings, demand, or costs or damages whatsoever or howsoever caused arising directly or indirectly in connection with or arising out of the use of this material. Supplementary materials for this article are available online. Please click the JASA link at http://pubs.amstat.org. Modeling Longitudinal Data Using a Pair-Copula Decomposition of Serial Dependence Michael SMITH, Aleksey MIN,Carlos ALMEIDA, and Claudia CZADO Copulas have proven to be very successful tools for the ﬂexible modeling of cross-sectional dependence. In this paper we express the de- pendence structure of continuous-valued time series data using a sequence of bivariate copulas. This corresponds to a type of decomposition recently called a “vine” in the graphical models literature, where each copula is entitled a “pair-copula.” We propose a Bayesian approach for the estimation of this dependence structure for longitudinal data. Bayesian selection ideas are used to identify any independence pair- copulas, with the end result being a parsimonious representation of a time-inhomogeneous Markov process of varying order. Estimates are Bayesian model averages over the distribution of the lag structure of the Markov process. Using a simulation study we show that the selection approach is reliable and can improve the estimates of both conditional and unconditional pairwise dependencies substantially. We also show that a vine with selection outperforms a Gaussian copula with a ﬂexible correlation matrix. The advantage of the pair-copula for- mulation is further demonstrated using a longitudinal model of intraday electricity load. Using Gaussian, Gumbel, and Clayton pair-copulas we identify parsimonious decompositions of intraday serial dependence, which improve the accuracy of intraday load forecasts. We also propose a new diagnostic for measuring the goodness of ﬁt of high-dimensional multivariate copulas. Overall, the pair-copula model is very general and the Bayesian method generalizes many previous approaches for the analysis of longitudinal data. Supplemental materials for the article are also available online. KEY WORDS: Bayesian model selection; Copula diagnostic; Covariance selection; D-vine; Goodness of ﬁt; Inhomogeneous Markov process; Intraday electricity load; Longitudinal copulas. 1. INTRODUCTION Modeling multivariate distributions using copulas has proven to be highly popular. This is largely due to the ﬂexibility that copula models provide, whereby the marginal distributions can be modeled arbitrarily, and any dependence captured by the copula. Major applications include survival analysis where much early work occurred (Clayton 1978; Oakes 1989), ac- tuarial science (Frees and Valdez 1998), and ﬁnance (Cheru- bini, Luciano, and Vecchiato 2004; Patton 2006); Joe (1997) and Nelsen (2006) provide introductions to copula models and their properties. While there are many copulas from which to choose, only a few are readily applicable to high-dimensional problems. Copula built from elliptical distributions, such as the Gaussian (Song 2000)or t (Demarta and McNeil 2005), are most popular in this case. However, these can prove restric- tive and in the recent graphical models literature alternative copulas have been proposed that are constructed from a se- ries of bivariate copulas (Joe 1996). There are a large number of permutations in which this can be undertaken, and Bedford and Cooke (2002) organize the different decompositions in a systematic way. They label the resulting multivariate copulas “vines,” while Aas et al. (2009) label the component bivari- ate copulas “pair-copulas”; see Kurowicka and Cooke (2006), Haff, Aas, and Frigessi (2010), and Czado (2010) for recent overviews. To date copula models have been employed largely to ac- count for cross-sectional dependence. Applications to serial de- pendence in time series and longitudinal data are rare, although Michael Smith is Professor of Management, Melbourne Business School, University of Melbourne, 200 Leicester Street, Carlton, VIC, 3053, Australia (E-mail: mike.smith@mbs.edu). Aleksey Min is Postdoctoral Fellow, Carlos Almeida is Postdoctoral Fellow, and Claudia Czado is Chair of Mathemati- cal Statistics, Zentrum Mathematik, Technische Universität München, 85748 Garching, Germany. The work of Michael Smith was partially supported by Australian Research Council grant DP0985505. Claudia Czado and Car- los Almeida gratefully acknowledge the ﬁnancial support from the Deutsche Forschungsgemeinschaft (Cz 86/1-3: Statistical inference for high dimensional dependence models using pair-copulas). The authors thank three referees and associate editor, all of whom made comments that improved the paper. the potential is large. Here, the marginal distribution of the process at each point in time can be modeled arbitrarily, while dependence over time is captured by a multivariate copula. Meester and MacKay (1994) and Joe (1997, pp. 243–280) pro- vide early examples, while more recent examples include Lam- bert and Vandenhende (2002), Frees and Wang (2006), Sun, Frees, and Rosenberg (2008), and Domma, Giordano, and Perri (2009). However, many of these authors employ multivariate copulas that do not fully exploit the time ordering of the mar- gins. In this paper we aim to show that doing so results in a more ﬂexible representation that is both more insightful and al- lows for improved estimates for continuous data. We decompose the distribution of a continuous process at a point in time, conditional upon the past, into the product of a sequence of bivariate copula densities and the marginal density. This type of copula is called a D-vine by Bedford and Cooke (2002), where any mix of bivariate copulas can be used for the component pair-copulas, resulting in an extremely ﬂexible modeling framework. When the process is Markovian, this can be accounted for by setting appropriate pair-copulas to the independence copula. For longitudinal data this results in a time-inhomogeneous Markov process with order that also varies over time. As we demonstrate here, not only does this produce greater insight into the underlying process, in high- dimensional longitudinal applications this parsimony can also lead to a substantial improvement in the quality of inference. Bedford and Cooke (2002) give the theoretical construc- tion of regular vines, however no estimation of pair-copula parameters is attempted. Kurowicka and Cooke (2006) esti- mate Gaussian vine copula parameters by minimizing the de- terminant of the correlation matrix. Aas et al. (2009)estimate pair-copula using maximum likelihood for Gaussian and non- Gaussian pair-copulas in both C-vine and D-vines. Min and © 2010 American Statistical Association Journal of the American Statistical Association December 2010, Vol. 105, No. 492, Theory and Methods DOI: 10.1198/jasa.2010.tm09572 1467Downloaded by [Dalhousie University] at 03:38 28 December 2012 1468 Journal of the American Statistical Association, December 2010 Czado (2010a) suggest a Bayesian method for the estimation of D-vines using Markov chain Monte Carlo (MCMC). Min and Czado (2010b) use vine copulas to model the dependency among foreign exchange rates using maximum likelihood. In all cases cross-sectional dependence is examined, where the deter- mination of an appropriate ordering of the dimensions for the decomposition remains an open problem. However, for time- ordered data this issue does not arise, and one of the insights of this paper is that a pair-copula decomposition is arguably more appropriate. We suggest a Bayesian approach for the estimation of a pair- copula decomposition for longitudinal data. Indicator variables are introduced to identify which pair-copulas are independence copulas. By doing so, we extend existing Gaussian covariance selection methods to a ﬂexible non-Gaussian framework, both in the longitudinal case (Pourahmadi 1999; Smith and Kohn 2002; Huang et al. 2006; Liu, Daniels, and Marcus 2009) and more generally. We use a Metropolis–Hastings scheme to gen- erate the indicator variable and dependence parameter(s) of a pair-copula jointly, where the proposal is based on a latent vari- able representation of the pair-copula parameter(s). The full spectrum of posterior inference is available, including measures of conditional and marginal pairwise dependence. All estimates are model averages over the distribution of the order of the Markov process. We also propose a diagnostic for the quality of ﬁt of a multivariate copula using the distribution of the sum of the transformed uniform margins. A simulation study using Gaussian, Gumbel, and Clay- ton pair-copulas highlights the accuracy and reliability of the Bayesian procedure for both the selection and estimation of pair-copulas. The results show that selection can improve the estimated dependence structure, and that the vine copula pro- vides a substantial improvement over the alternative of using a multivariate Gaussian copula; both when the Gaussian copula correlation matrix is unrestricted, or parsimonious in the fash- ion of Smith and Kohn (2002). We demonstrate the usefulness of the method using a longitudinal model for intraday electricity load in the Australian state of New South Wales. Here, marginal regressions with t disturbances are used with time and weather based covariates and load the previous day. Intraday depen- dence is captured ﬂexibly using Gaussian, Gumbel, and Clay- ton pair-copulas. A time-varying Markov structure is identiﬁed that is inline with that used in the energy forecasting literature (Cottet and Smith 2003; Soares and Medeiros 2008). We ﬁnd that intraday dependence is nonlinear and better captured us- ing the Gumbel pair-copula model. We demonstrate this using a forecasting study, where the choice of pair-copula type and selection are shown to improve the accuracy of out-of-sample intraday forecasts. The rest of the paper is organised as follows. In Section 2 we outline the pair-copula decomposition of the joint distribu- tion of time-ordered data, along with the resulting likelihood for longitudinal data. Section 3 discusses priors, Bayesian estima- tion, and pair-copula selection. Also discussed are measures of conditional and unconditional pairwise dependence, and the di- agnostic for the quality of ﬁt. Section 4 contains the simulation study, Section 5 the electricity load example, and Section 6 the conclusion. The supplementary materials contain an illustration of a Gaussian D-vine, additional ﬁgures, and empirical results for the electricity example and a second empirical example. 2. THE MODEL 2.1 Pair-Copula Construction for Time Series Consider a univariate time series X ={X1,..., XT } of contin- uously distributed data observed at T possibly unequally spaced points in time. If the underlying process is Markovian, then this can be exploited by selecting models for the conditionals in the decomposition of the joint density of X: f (x) = T∏ t=2 f (xt|xt−1,..., x1)f (x1), (2.1) where x = (x1,..., xT ). Copulas can be used to construct a gen- eral representation for each conditional as follows. For s < t there always exists a density ct,s on [0, 1]2, such that f (xt, xs|xt−1,..., xs+1) = ct,s(F(xt|xt−1,..., xs+1), F(xs|xt−1,..., xs+1); xt−1,..., xs+1) × f (xt|xt−1,..., xs+1)f (xs|xt−1,..., xs+1). (2.2) Here, F(xt|xt−1,..., xs+1) and F(xs|xt−1,..., xs+1) are the con- ditional distribution functions of Xt and Xs, respectively. This is the theorem of Sklar (1959) conditional upon {Xt−1,..., Xs+1}. In vine copula models ct,s is simpliﬁed by dropping dependence upon (xt−1,..., xs+1) and is called a “pair-copula”; see Haff, Aas, and Frigessi (2010). We adopt this simpliﬁcation through- out, and by setting s = 1, application of Equation (2.2)gives f (xt|xt−1,..., x1) = ct,1(F(xt|xt−1,..., x2), F(x1|xt−1,..., x2)) × f (xt|xt−1,..., x2). Repeated application with s = 2, 3,..., t − 1 leads to the fol- lowing: f (xt|xt−1,..., x1) = t−2∏ j=1 {ct,j(F(xt|xt−1,..., xj+1), F(xj|xt−1,..., xj+1)) } × ct,t−1(F(xt), F(xt−1))f (xt), (2.3) where F(xt) and f (xt) are the marginal distribution function and density of Xt, respectively. We denote ut|j ≡ F(xt|xt−1,..., xj) and uj|t ≡ F(xj|xt,..., xj+1), where j < t. They correspond to projections backwards and forwards t − j steps, respectively. By also denoting ut|t ≡ F(xt), the joint density at Equation (2.1) can be written as f (x) = T∏ t=2 {t−1∏ j=1 { ct,j(ut|j+1, uj|t−1)} f (xt) } f (x1), (2.4) which is a product of T marginal densities and T(T − 1)/2 pair- copula densities. Equation (2.4) can be recognised as a “D-vine” and is one of a wider class of vine decompositions recently discussed in the context of graphical models by Bedford and Cooke (2002) and others. In this literature, the notation used makes the conditioning set explicit; for example, ct,j|t−1,t−2,...,j+1 would denote the copula density in Equation (2.4). This is essential for differentiating between vine decompositions ofDownloaded by [Dalhousie University] at 03:38 28 December 2012 Smith et al.: Pair-Copula Decomposition of Serial Dependence 1469 general vectors X. However, it is not necessary to uniquely identify the pair-copulas of the D-vine decomposition when the elements of X are time ordered. Throughout the rest of the paper we employ parametric models for the pair- copulas and write each density as ct,j(u1, u2; θt,j), where θt,j are the parameters. If u = (u1|1,..., uT|T ), then c†(u; \u0003) = ∏T t=2 ∏t−1 j=1 ct,j(ut|j+1, uj|t−1; θt,j) is the density of the multivari- ate D-vine copula with parameters \u0003 ={θt,s; (t, s) ∈ I} and I ={(t, s); t = 2,..., T, s < t}. In the special case where ct,j are bivariate Gaussian copula densities, Aas et al. (2009)show that c† is the density of a T-dimensional Gaussian copula. The most challenging aspect of the D-vine representation is the evaluation of ut|j+1 and uj|t−1 in Equation (2.4). The follow- ing property (Joe 1996, p. 125) proves useful in this regard: Lemma. Let u1 = F(x1|y) and u2 = F(x2|y) be conditional distribution functions, and F(x1, x2|y) = C(u1, u2; θ), where C is a bivariate copula function with parameters θ , then F(x1|x2, y) = h(u1|u2; θ), where h(u1|u2; θ) ≡ ∂C(u1, u2; θ) ∂u2 . For j < t, application of the lemma to Equation (2.2) with y ={xt−1,..., xj+1} gives the following recursive relationships: ut|j = F(xt|xt−1,..., xj) = ht,j( ut|j+1|uj|t−1; θt,j) , (2.5) uj|t = F(xj|xt,..., xj+1) = ht,j( uj|t−1|ut|j+1; θt,j) , (2.6) where ht,j(u1|u2; θt,j) = ∂ ∂u2 Ct,j(u1, u2; θt,j) and Ct,j is the dis- tribution function corresponding to pair-copula density ct,j.We label Equation (2.6) a forwards recursion and Equation (2.5) a backwards recursion, and from these it can be seen that ut|j and uj|t are functions not only of θt,j, but also of the parameters of other pair-copulas. The recursions give the following algo- rithm for the evaluation of the values of ut|j and uj|t employed in Equation (2.4): Algorithm 1. Step (1): For t = 1,..., T set ut|t = F(xt). Step (2): For k = 1,..., T − 1 and i = k + 1,..., T: Backwards Step: ui|i−k = hi,i−k(ui|i−k+1|ui−k|i−1; θi,i−k). Forwards Step: ui−k|i = hi,i−k(ui−k|i+1|ui|i−k+1; θi,i−k). Note that Step (2) involves the evaluation of the T(T − 1)/2 functions ht,j,for j < t, twice. Table 1 provides analytical ex- pressions of h for some popular bivariate copulas. Figure S1 in the supplementary materials depicts the dependencies be- tween ut|j, uj|t resulting from the recursions in Algorithm 1. As an illustration, Part A of the supplementary materials shows how a Gaussian AR(2) can be decomposed into a D-vine using Gaussian pair-copulas and Gaussian margins. 2.2 Conditional Distributions and Simulation From Equation (2.5) F(xt|xt−1,..., x1) = ut|1 = ht,1(ut|2| u1|t−1; θt,1), where ut|2 = F(xt|xt−1,..., x2) is a function of xt, but u1|t−1 is not. Repeated use of Equation (2.5) provides ex- pressions for ut|2,..., ut|t−1, and by noting that ut|t = F(xt),the conditional distribution function can be expressed as F(xt|xt−1,..., x1) = ht,1 ◦ ht,2 ◦ ··· ht,t−1 ◦ F(xt). (2.7) To evaluate ht,j(·|uj|t−1,θt,j),for j = t − 1,..., 1, the values u1|t−1,..., ut−1|t−1 also need computing, which can be ob- tained by running Algorithm 1, but with T = t. The expres- sion at Equation (2.7) can be used to provide the efﬁcient al- gorithm below for simulating from D-vine via the method of composition. We simulate T independent uniforms w1,..., wT , and compute x1 = F−1(w1) and xt = F−1(wt|xt−1,..., x1) for t = 2,..., T, so that x has the density at Equation (2.4) and u that of c†. Algorithm 2. For t = 1,..., T: Step (1): Generate wt ∼ Uniform(0, 1). Step (2): If t = 1set x1 = F−1(w1), otherwise set xt = F−1 ◦ h−1 t,t−1 ◦ ··· ◦ h−1 t,1 (wt). Step (3): Set ut|t = F(xt), and if t > 1 compute: ut|j = ht,j( ut|j+1|uj|t−1; θt,j) for j = t − 1,..., 1, uj|t = ht,j( uj|t−1|ut|j+1; θt,j) for j = 1,..., t − 1. The functions h−1 t,j are easily computed either analytically or numerically for commonly used copula; see Table 1. More- over, Algorithm 2 can be adjusted to produce an iterate from the conditional distribution F(xT , xT−1,..., xt0+1|xt0,..., x1) sim- ply by skipping Steps (1) and (2) for t = 1,..., t0, but not Step (3). This can be useful in computing forecasts, partic- ularly when the vector is longitudinal as we demonstrate in Section 5. Both Kurowicka and Cooke (2007) and Aas et al. (2009) give algorithms that are equivalent to Algorithm 2,al- though the former do not provide an expression for the condi- tional distribution function, while that of the latter is less suc- cinct. 2.3 Longitudinal Data and Pair-Copula Selection While the decomposition at Equation (2.4) provides a ﬂexi- ble representation for time series data generally, we focus here on the longitudinal case. That is, where there are n indepen- dent observations x ={x1,..., xn} on a dependent time se- ries vector xi = (xi,1,..., xi,T ). In the case where the number of pair-copulas, T(T − 1)/2, is large compared to the num- ber of scalar observations nT, it can prove hard to obtain re- liable estimates without imposing strong restrictions, and thus a data-driven method that allows for parsimony is useful. Fol- lowing Smith and Kohn (2002) we introduce indicator variables \u0005 ={γt,s; (t, s) ∈ I}, so that ct,s(u1, u2; θt,s) = 1iff γt,s = 0, (2.8) ct,s(u1, u2; θt,s) = c⋆ t,s(u1, u2; θt,s) iff γt,s = 1. In the above c⋆ t,s is a prespeciﬁed bivariate copula density, such as a Gaussian, t, Gumbel, or Clayton. While there is no rea- son why the pair-copula cannot vary with (t, s), for simplicity we assume c⋆ t,s are all of the same form in our empirical work and therefore drop the subscripts of the copula density c⋆ and corresponding distribution function C⋆. When γt,s = 0 the copula is the independence copula Ct,s(u1, u2; θt,s) = u1u2, and implies that ht,s(u1|u2; θt,s) = u1. There- fore, \u0005 determines the form of the time series dependency. For example, if γt,s = 0 for all s ≤ t − p, then f (xt|xt−1,..., x1) = f (xt|xt−1,..., xt−p) and the process is Markov of order p.InDownloaded by [Dalhousie University] at 03:38 28 December 2012 1470 Journal of the American Statistical Association, December 2010 Table 1. Copula distribution functions, densities, h-functions, and inverses for the Gaussian, t, Clayton, Gumbel, and Galambos bivariate copulas. Function \b(·) denotes the standard normal distribution function and Tν (·) the t distribution function with ν degrees of freedom. The distribution function of a bivariate normal distribution with standard normal margins and correlation θ is denoted as \b2, while that of a bivariate t distribution with ν degrees of freedom, zero mean and correlation θ is denoted as T2,ν Gaussian (or Normal) copula (−1 ≤ θ ≤ 1) C(u1, u2; θ) = \b2(\b−1(u1), \b−1(u2)) c(u1, u2; θ) = 1√ 1−θ 2 exp{− θ 2(w2 1+w2 2)−2θ w1w2 2(1−θ 2) },where w1 = \b−1(u1), w2 = \b−1(u2) h(u1|u2; θ) = \b([\b−1(u1) − θ\b−1(u2)](1 − θ 2)−1/2) h−1(u1|u2; θ) = \b(\b−1(u1)(1 − θ 2)1/2 + θ\b−1(u2)) t copula (θ ={ξ, ν}, −1 ≤ ξ ≤ 1,ν > 0) C(u1, u2; θ) = T2,ν (T−1 ν (u1), T−1 ν (u2)) c(u1, u2; θ) = \u0005((ν+2)/2)\u0005(ν/2)√ 1−ξ 2[\u0005((ν+1)/2)]2 (1 + w2 1/ν)(ν+1)/2(1 + w2 2/ν)(ν+1)/2(1 + (w2 1 + w2 2 − 2ξ w1w2)/(ν(1 − ξ 2)))−(ν+2)/2, where w1 = T−1 ν (u1), w2 = T−1 ν (u2) h(u1|u2; θ) = Tν+1([T−1 ν (u1) − ξ T−1 ν (u2)][ (ν+(T−1 ν (u2))2)(1−ξ 2) ν+1 ]−1/2) h−1(u1|u2; θ) = Tν (T−1 ν+1(u1)[ (ν+(T−1 ν (u2))2)(1−ξ 2) ν+1 ]1/2 + ξ T−1 ν (u2)) Clayton copula (θ ∈ (−1, ∞) \\{0}) C(u1, u2; θ) = max{(u−θ 1 + u −θ 2 − 1)−1/θ , 0} c(u1, u2; θ) = max{(1 + θ)(u1u2)−1−θ (u−θ 1 + u −θ 2 − 1)−1/θ−2, 0} h(u1|u2; θ) = max{u −θ −1 2 (u−θ 1 + u −θ 2 − 1)−1−1/θ , 0} h−1(u1|u2; θ) = ([u1u θ +1 2 ]−θ/(θ+1) + 1 − u −θ 2 )−1/θ Gumbel copula (θ > 1) C(u1, u2; θ) = exp(−[(− log u1)θ + (− log u2)θ ]1/θ ) c(u1, u2; θ) = C(u1, u2; θ)(u1u2)−1((− log u1)θ + (− log u2)θ )−2+2/θ (log u1 log u2)θ −1 ×[1 + (θ − 1)((− log u1)θ + (− log u2)θ )−1/θ ], h(u1|u2; θ) = C(u1, u2; θ) 1 u2 (− log u2)θ −1[(− log u1)θ + (− log u2)θ ]1/θ−1 h−1(u1|u2; θ) obtained numerically using Newton’s method. Galambos copula (θ > 0) C(u1, u2; θ) = u1u2 exp(−[(− log u1)−θ + (− log u2)−θ ]−1/θ ) c(u1, u2; θ) = C(u1, u2; θ)u−1 1 u −1 2 [1 − ((− log u1)−θ + (− log u2)−θ )−1−1/θ ×((− log u1)−θ −1 + (− log u2)−θ −1)]((− log u1)−θ + (− log u2)−θ )−2−1/θ ×(log u1 log u2)−θ −1(1 + θ + ((− log u1)−θ + (− log u2)−θ )−1/θ ) h(u1|u2; θ) = C(u1, u2; θ)u−1 1 [1 − ((− log u1)−θ + (− log u2)−θ )−1−1/θ (− log u2)−1−θ ] h−1(u1|u2; θ) obtained numerically using Newton’s method. general, \u0005 determines a parsimonious dependence structure that can vary with time t, extending antedependent models for longitudinal data (Gabriel 1962; Pourahmadi 1999; Smith and Kohn 2002) and covariance selection for Gaussian copulas (Pitt, Chan, and Kohn 2006). The likelihood f (x|\u0003, \u0005) = ∏n i=1 f (xi|\u0003, \u0005), where f (xi|\u0003, \u0005) = T∏ t=2 {t−1∏ j=1 {( c⋆( ui,t|j+1, ui,j|t−1; θt,j))γt,j }f (xi,t) } f (xi,1). Here, the conditional copula data ui,t|j+1 = F(xi,t|xi,t−1,..., xi,j+1) and ui,j|t−1 = F(xi,j|xi,t−1,..., xi,j+1) are computed us- ing Algorithm 1 applied separately to each observation xi.The following adjustment to Step (2) of Algorithm 1 can be em- ployed: hi,i−k(u1|u2; θi,i−k) = u1 if γi,i−k = 0, hi,i−k(u1|u2; θi,i−k) = h⋆(u1|u2; θi,i−k) ≡ ∂ ∂u2 C⋆(u1, u2; θi,i−k) if γi,i−k = 1. Exploiting this observation substantially increases execution speed when the proportion of zeros in \u0005 is high; something that is likely to be the case in many longitudinal studies. When the marginal distributions are Gaussian, the framework nests a wide range of existing longitudinal models. If c⋆ is a bi- variate Gaussian copula, then the longitudinal vector follows a Gaussian AR(p) when γt,j = 0for t > p and j > t − p, while γt,j = 1 otherwise. When the Gaussian pair-copula parameters {θt,j | t > p, j > t − p} vary with t, a time-varying parameter Gaussian autoregression is obtained. If the elements of \u0005 vary, then the model is further extended to an antedependent model. However, by choosing non-Gaussian pair-copula densities c⋆, the approach allows for more complex models of nonlinear de-Downloaded by [Dalhousie University] at 03:38 28 December 2012 Smith et al.: Pair-Copula Decomposition of Serial Dependence 1471 pendence. We show in our empirical work that this can have a considerable impact. 3. BAYESIAN INFERENCE 3.1 Priors The prior on \u0005 can be chosen to represent a preference for shorter Markov orders by setting the marginal priors π(γt,s = 1) ∝ δ(t−s),for 0 <δ < 1. Similarly, an informative prior can be used to ensure that if γt,s = 0 then γt,s−1 = 0 also. How- ever, in our empirical work we do neither and place equal mar- ginal prior weight upon each indicator. As observed by Kohn, Smith, and Chan (2001) such a prior can still prove highly informative when N = T(T − 1)/2 is large. For example, if K\u0005 = ∑ (t,s)∈I γt,s is the number of nonzero elements of \u0005, then assuming the ﬂat prior π(\u0005) = 2−N puts very high prior weight on values of \u0005 which have K\u0005 ≈ N/2. To avoid this, beta priors can be employed (Kohn, Smith, and Chan 2001; Liu, Daniels, and Marcus 2009), although we adopt the prior π(\u0005) = 1 N + 1 ( N K\u0005 )−1 , which has been used successfully in the component selection literature (Cripps, Carter, and Kohn 2005; Panagiotelis and Smith 2008). It results in equal marginal priors, uniform prior weight on π(K\u0005) = 1/(1 + N), and the conditional prior π(γt,s|{\u0005 \\ γt,s}) ∝ B(N − K\u0005 + 1, K\u0005 + 1)/(N + 2), (3.1) where B(x, y) is the beta function. The priors of the dependence parameters θt,s vary according to choice of copula function C⋆. When Gaussian pair-copulas are employed, the θt,s are partial correlations, and independent beta priors can be adopted as sug- gested by Daniels and Pourahmadi (2009) or ﬂat priors as in Pitt, Chan, and Kohn (2006). When non-Gaussian pair-copulas are used, following Equation (2.3), the parameters θt,s capture conditional dependence more generally. Unless mentioned oth- erwise, we employ independent ﬂat priors on the domain of these dependence parameters. This extends the approaches sug- gested by Joe (2006) and Daniels and Pourahmadi (2009)for modeling covariance matrices for Gaussian data, and we show that this is an effective strategy for a range of copula functions in our empirical work. 3.2 Sampling Scheme Given the margins, we generate iterates from the joint poste- rior f (\u0005, \u0003|x) by introducing latent variables ˜θt,s,for (t, s) ∈ I, such that θt,s = ˜θt,s iff γt,s = 1. Following the deﬁnition of the indicator variables in Equation (2.8), the pair-copula parameters θt,s are known exactly from ( ˜θt,s,γt,s). The prior π( ˜θt,s|γt,s = 1) ∝ π(θt,s|γt,s = 1), and we assume prior independence be- tween the latent and indicator variables, so that π( ˜\u0003, \u0005) = π(\u0005) ∏(t,s)∈I π( ˜θt,s), with ˜\u0003 ={ ˜θt,s; (t, s) ∈ I}. We evaluate the posterior distribution using MCMC. The sampling scheme consists of Metropolis–Hastings (MH) steps that traverse the latent and indicator variable space by generating each pair ( ˜θt,s,γt,s), one at a time for t = 2,..., T and s = 1,..., t − 1. In the case where the pair-copula has a single dependence pa- rameter, we adopt a MH proposal with density q that is indepen- dent in γt,s and ˜θt,s, so that q( ˜θt,s,γt,s) = q1(γt,s)q2( ˜θt,s). When there are multiple dependence parameters for a pair-copula, we simply generate each parameter separately in the same man- ner. Kohn, Smith, and Chan (2001) and Nott and Kohn (2005) compare the relative efﬁciency of a number of choices for q1 in the regression variable selection problem. In this paper we consider two choices for q1. The ﬁrst corresponds to the simple proposal q1(γt,s = 1) = q1(γt,s = 0) = 1/2, while the second is Sampling Scheme 2 proposed by Kohn, Smith, and Chan (2001). This was the most computationally efﬁcient scheme suggested by the authors, and employs the conditional prior at Equation (3.1) as the proposal. For clarity, we label the result- ing two sampling schemes SS1 and SS2, respectively. In both cases we use a random walk proposal for q2, with ˜θt,s generated using a t-distribution with d degrees of freedom and scale σ 2. Dropping the subscripts for notational convenience for the rest of this subsection, the new iterate ( ˜θ new,γ new) is accepted over the old ( ˜θ old,γ old) with probability min(1,αR), where R is an adjustment due to any bounds on the domain of θ .We denote the conditional prior at Equation (3.1) for the case when γ = 1as π1, and π0 = 1 − π1. If the likelihood in Section 2.3 is denoted as a function of the element ( ˜θ, γ ) as L( ˜θ, γ ), then α can be computed for the four different combinations of γ old and γ new as: α00 ≡ α((γ old = 0, ˜θ old) → (γ new = 0, ˜θ new)) = π( ˜θ new) π( ˜θ old) , α01 ≡ α((γ old = 0, ˜θ old) → (γ new = 1, ˜θ new)) = L( ˜θ new,γ new = 1)π( ˜θ new)π1 L(γ old = 0)π( ˜θ old)π0 × q1(0) q1(1) , α10 ≡ α((γ old = 1, ˜θ old) → (γ new = 0, ˜θ new)) = L(γ new = 0)π( ˜θ new)π0 L( ˜θ old,γ old = 1)π( ˜θ old)π1 × q1(1) q1(0) , α11 ≡ α((γ old = 1, ˜θ old) → (γ new = 1, ˜θ new)) = L( ˜θ new,γ new = 1)π( ˜θ new) L( ˜θ old,γ old = 1)π( ˜θ old) . The likelihood L is not a function of ˜θ when γ = 0, while L( ˜θ, γ = 1) = L(θ, γ = 1). If the prior for ˜θ is uniform, as is the case in much of our empirical work, π( ˜θ new)/π( ˜θ old) = 1. If θ is constrained to the domain (a, b),sois ˜θ and the factor R = Td((b − ˜θ old)/σ ) − Td((a − ˜θ old)/σ ) Td((b − ˜θ new)/σ ) − Td((a − ˜θ new)/σ ) , where Td is the distribution function of a td distribution. Note that the likelihood is not computed in the evaluation of α00, and that with this proposal α00 = 1. Therefore, the more frequently this case arises, the faster the estimation. For SS1, the choice of q1 further simpliﬁes α01 = L( ˜θ new,γ new = 1)π1/L(γ old = 0)π0, while α10 = L(γ new = 0)π0/L( ˜θ old,γ old = 1)π1.Forthe choice of q1 in SS2, α01 = L( ˜θ new,γ new = 1)/L(γ old = 0) and α10 = L(γ new = 0)/L( ˜θ old,γ old = 1). In our empirical work we condition on any marginal esti- mates and focus on studying inference for the serial dependence structure on [0, 1]T . However, because the likelihood can be computed in closed form, the copula parameters can be esti- mated joint with any marginal parameters by appending addi- tional MH steps as outlined by Pitt, Chan, and Kohn (2006)for the Gaussian copula. Nevertheless, joint estimation often doesDownloaded by [Dalhousie University] at 03:38 28 December 2012 1472 Journal of the American Statistical Association, December 2010 not affect the estimated dependence structure meaningfully; see Silva and Lopes (2008) for an empirical demonstration. 3.3 Posterior Inference The sampling schemes are run for a burnin period, and then J iterates {\u0003[j],\u0005[j]}∼ f (\u0003, \u0005|x) collected. From these posterior inference is computed, including posterior means which we use in our empirical work as point estimates. Of particular interest here is Pr(γt,s = 0|x) ≈ 1 J ∑ j(1 − γ [j] t,s ), which is the estimate of the marginal probability that the (t, s)th pair-copula is the inde- pendence copula. We found little difference between SS1 and SS2, and all empirical results are from SS1. We assess conver- gence by checking our estimates are invariant to different initial conditions, and employ sample sizes between J = 20,000 and J = 50,000. Because in our analysis we consider different pair-copula families it is important to measure dependence with a common metric. There is an extensive literature on measures of concor- dance, with a comprehensive summary given by Nelsen (2006, chapter 5). We measure the level of dependence in each pair- copula using Kendall’s tau. For each pair (t, s) ∈ I this can be expressed (Nelsen 2006, p. 159) as τt,s = 4 ∫ 1 0 ∫ 1 0 Ct,s(u1, u2; θt,s) dCt,s(u1, u2; θt,s) − 1. For the independence copula τt,s = 0, while Kendall’s tau can be expressed as a function of θt,s for many common bivari- ate copulas (Embrechts, Lindskog, and McNeil 2003); for the Gaussian τt,s = arcsin( 2 π θt,s),forthe t τt,s = arcsin( 2 π ξt,s),for the Clayton τt,s = θt,s/(θt,s + 2) and for the Gumbel τt,s = 1−θ −1 t,s deﬁned in Table 1. In these cases we can write Kendall’s tau as τt,s(θt,s) and compute E(τt,s|x) = ∫ τt,s(θt,s)f (θt,s|x) dθt,s = ∫ τt,s( ˜θt,s)f ( ˜θt,s,γt,s = 1|x) d ˜θt,s ≈ 1 J J∑ j=1 τt,s( ˜θ [j] t,s) γ [j] t,s . This shows that the posterior mean is a model average over the indicator γt,s. From Equation (2.2), τt,s measures dependence between Xt and Xs, conditional upon intermediate values. To obtain a mea- sure of marginal pairwise dependence, we use Spearman’s rho ρs,t(\u0003) = 12E(UtUs|\u0003) − 3, where Ut = F(Xt) and Us = F(Xs) (Nelsen 2006, p. 170). We calculate its posterior mean by com- puting a Monte Carlo estimate of ms,t(\u0003) = E(UtUs|\u0003), based upon iterates {u[1],..., u[J]} of U = (U1,..., UT ) simulated us- ing Algorithm 2 appended to the end of each sweep of the sam- pling scheme. The estimate is E(ms,t|x) = ∫ ms,t(\u0003)f (\u0003|x) d\u0003 ≈ 1 J J∑ j=1 ∫ usutf ( u|\u0003 [j]) du ≈ 1 J J∑ j=1 u[j] s u[j] t =ˆmt,s, where u[j] ∼ f (u|\u0003[j]) and \u0003[j] ∼ f (\u0003|x). Because Algorithm 2 is fast to implement, we actually generate 100 iterates of U at each sweep to make the estimate ˆmt,s more accurate. 3.4 Diagnostic Currently, there are only a few approaches for judging the adequacy of the ﬁt of a multivariate copula; for exam- ple, Glidden (2007) proposes diagnostics based upon pair- wise dependence. We consider the sum S(\u0003) = ∑T j=1 \b−1(Uj), where U has a multivariate copula as a distribution function. The sum S is both highly sensitive to the dependence struc- ture of the copula and comparable across different copulas. From a Bayesian perspective, we consider the ﬁtted distrib- ution f (S|x) = ∫ f (S|\u0003)f (\u0003|x) d\u0003, where the parameters are integrated out with respect to their posterior distribution. For a Gaussian copula, f (S|\u0003) can be shown to be a Gaussian density, and f (S|x) ≈ 1 J ∑J j=1 f (S|\u0003[j]) is straightforward to compute. For non-Gaussian D-vines we select every 20th iterate from {u[1],..., u[J]}, which are simulated as in Section 3.3, to obtain an approximately independent sample from the ﬁtted vine. We then compute iterates S[k] = ∑T j=1 \b−1(u[k] j ), which form an approximately independent sample from f (S|x) and can be used to construct a kernel density estimate (KDE). The ﬁtted distri- bution f (S|x) can be compared to two different benchmarks. The ﬁrst is where the elements of X are assumed independent, so that U1,..., UT are independent uniforms and S ∼ N(0, T). The second is the empirically observed distribution of S.This is given as the KDE based on the sample Si = ∑T t=1 \b−1(uobs i,t ), for i = 1,..., n, where uobs i,t = ˆFt(xi,t), and ˆFt(xi,t) is the empir- ical distribution function of the data {x1,t,..., xn,t}. A paramet- ric model that more adequately ﬁts the observed dependence in the data will have f (S|x) closer to this second benchmark distribution. 4. SIMULATION STUDY We study the effectiveness of the approach in estimating the dependence structure on [0, 1]T using a simulation study. We assume the marginal distributions are known, and consider the Gaussian, Clayton, and Gumbel bivariate copulas. The latter two are popular Archimedean copulas; see Joe (1997, chap- ter 5) for an introduction to their properties. We simulate 100 datasets from each of three models in two cases. The ﬁrst case is with T = 7 margins and n = 100 observations on the longitu- dinal vector, and the second case is with dimension T = 14 and n = 200. The three models we consider are: Model A. The dependence structure of a Gaussian AR(1) with autoregressive coefﬁcient 0.85 and unit variance distur- bances. In this case γt,t−1 = 1, γt,s = 0for t − s > 1, and θt,t−1 = 0.85. Figure 1(a) depicts the resulting values of τt,s for each pair-copula when T = 7. Model B. Clayton pair-copula model with γt,s = 1 for all t − s ≤ 2, and zero otherwise. This corresponds to a second order time-inhomogeneous Markov process, with dependence parameters set so that the values of τt,s for each pair-copula are as depicted in Figure 1(b) when T = 7.Downloaded by [Dalhousie University] at 03:38 28 December 2012 Smith et al.: Pair-Copula Decomposition of Serial Dependence 1473 Figure 1. Simulation design when T = 7 and results for estimator E1s, with the three columns of panels corresponding to Models A, B, and C, respectively. Panels (a)–(c) plot the true values of τt,s for the models in each row t and column s of each panel. Panels (d)–(f) plot the values of ¯Pt,s deﬁned in Section 4 in row t and column s of each panel. Panels (g)–(i) plot the estimated bias values ˆb(τt,s) in row t and column s of each panel. Throughout, darker cells correspond to higher absolute values, lighter cells to lower absolute values and transparent cells to zero. Model C. Gumbel pair-copula model with dependence pa- rameters set so that the values of τt,s for each pair-copula are as depicted in Figure 1(c) when T = 7. This speciﬁes a time- inhomogeneous Markov process with varying order. When T = 14 the designs are direct extensions, and Fig- ure S2 in the supplementary materials depicts the values of τt,s for each pair-copula. We ﬁt the following estimators to each dataset: Estimators E1s/E1f. Estimation using the correctly speciﬁed pair-copula type and with/without selection, where the latter corresponds to assuming γt,s = 1 for all (t, s) ∈ I. Estimator E2s/E2f. Estimation using an incorrectly speciﬁed pair-copula type (Clayton for Model A; Gumbel for Model B; and Gaussian for Model C) and with/without selection. Estimator E3. Estimation with a Gaussian copula con- structed from Gaussian pair-copulas without selection. Estimator E4. Estimation with a Gaussian copula with ﬂexi- ble correlation matrix based upon the prior and method of Smith and Kohn (2002). Estimator E3 employs ﬂat priors on the parameters of the Gaussian pair-copulas. Estimator E4 corresponds to ﬁtting a N(0,\u0011) distribution to the transformed copula data x⋆ i,j =Downloaded by [Dalhousie University] at 03:38 28 December 2012 1474 Journal of the American Statistical Association, December 2010 \b−1(ui,j), where ui,j ∈[0, 1] is the ith observation of the cop- ula data from the jth margin. The covariance selection prior and method outlined in Smith and Kohn (2002) are used, but where the ﬁtted Gaussian copula is based on the posterior mean of the correlation matrix diag(\u0011)−1/2\u0011 diag(\u0011)−1/2. We note that Estimators E1f and E3 coincide for Model A, and E2f and E3 coincide for Model C. Figure 1 provides a summary of the reliability of the pair- copula selection procedure of estimator E1s when T = 7. To quantify this, for each pair-copula we compute the mean posterior probability of being dependent over the simulation ¯Pt,s = 1 100 ∑100 i=1 Pt,s(i), where Pt,s(i) is the posterior probabil- ity Pr(γt,s = 1|x) in the ith dataset. Panels (d)–(f) plot these values for all pair-copulas and the three models, showing that the Bayesian selection approach is highly accurate. To con- ﬁrm this, we also examine the performance of the approach for classiﬁcation using a simple threshold. For each replicated dataset we classify each pair-copula as being dependent when Pr(γt,s = 1|x)> 0.5, or the independence copula otherwise. Over the three models, two cases, all pair-copulas and all sim- ulation replicates, 99.8% of dependent pair-copulas and 99.5% of independence pair-copulas were correctly classiﬁed by esti- mator E1s. To also show that the method produces reliable es- timates of the conditional dependence structure, for each pair- copula we estimate the bias ˆb(τt,s) = 1 100 ∑100 i=1(τt,s(i) − τ ∗ t,s), where τ ∗ t,s is the true value and τt,s(i) the posterior mean for the ith dataset of Kendall’s tau for pair-copula ct,s. Figure 1(g)– (i) reports these estimated biases, with most being zero to two decimal places. Table 2 compares the performance of all the estimators. The top and bottom half contains for the two combinations of di- mension and sample size considered, although relative perfor- mance of the estimators is the same in both cases. Each column corresponds to a different combination of the six estimators and three models. Estimators E1 to E3 are D-vines, and for these summaries of the estimated Kendall’s tau (τt,s) for each pair- copula are provided. The ﬁrst summary is the mean absolute bias (MAB), broken down by pair-copula type (dependent or independence) and also over all pair-copulas. Estimator E1 pro- duces the best results throughout, highlighting the importance of the appropriate choice of pair-copula type for c⋆. Estimator E1s dominates E1f, suggesting that Bayesian identiﬁcation of a Table 2. Summary of simulation results over all 100 replicates, with the ﬁrst case in the top half of the table, and the second in the bottom half. The columns give the results for each combination of the three models and six estimators. For Model A, estimators E1f and E3 coincide, as do estimators E2f and E3 for Model C. For estimators E1 to E3 summaries of the estimates of Kendall’s tau τt,s for the pair-copulas are given, broken down by type (dependent or independence) and overall. The summaries are the mean absolute bias (MAB) and mean posterior interval width ˆw(τt,s). For all estimators the MAB of the estimates of the pairwise unconditional Spearman’s rho values {ρt,s; (t, s) ∈ I} is giveninthe last row. Figures in parentheses are standard errors of the sample means immediately above. They are computed over the replicates as the standard error of the sample mean of 100 MAB values, each evaluated over the elements in I Model A Model B Model C Estimator: E1s E1f/E3 E2s E2f E4 E1s E1f E2s E2f E3 E4 E1s E1f E2s E2f/E3 E4 Simulation Case 1: T = 7, n = 100 MAB(τt,s) × 102 Dependent 2.14 2.39 12.3 13.7 – 1.87 1.88 16.3 15.4 9.48 – 2.31 2.27 5.37 5.46 – Independent 1.11 4.85 0.36 4.25 – 0.35 3.93 1.86 7.15 8.44 – 0.12 4.34 2.60 5.28 – Overall 1.40 4.15 3.77 6.94 – 1.15 2.86 9.44 11.5 8.98 – 1.27 3.26 4.05 5.37 – (0.05) (0.12) (0.53) (0.44) (0.12) (0.14) (0.94) (0.75) (0.46) (0.17) (0.18) (0.39) (0.37) Mean ˆw(τt,s) × 102 Dependent 8.72 9.00 10.9 11.3 – 7.23 7.29 13.3 13.5 10.9 – 8.64 8.70 10.1 10.2 – Independent 6.35 20.8 1.12 14.9 – 1.46 16.1 3.71 12.8 21.2 – 0.34 9.80 12.4 19.3 – Overall 7.03 17.4 3.92 13.9 – 4.48 11.5 8.72 13.2 15.8 – 4.69 9.22 11.2 14.5 – (0.12) (0.55) (0.46) (0.17) (0.47) (0.58) (0.66) (0.45) (0.67) (0.61) (0.47) (0.49) (0.60) MAB(ρt,s) × 102 2.56 3.84 15.7 14.0 3.24 0.95 1.04 13.6 11.2 3.86 4.23 1.55 2.31 3.02 4.30 5.50 (0.09) (0.12) (0.23) (0.23) (0.16) (0.04) (0.07) (0.44) (0.27) (0.12) (0.20) (0.09) (0.08) (0.20) (0.20) (0.27) Simulation Case 2: T = 14, n = 200 MAB(τt,s) × 102 Dependent 1.42 1.70 12.2 13.8 – 1.43 1.58 15.5 15.5 9.49 – 1.53 1.67 4.73 4.96 – Independent 0.34 3.60 0.13 2.95 – 0.08 2.78 1.28 4.30 6.07 – 0.03 3.03 0.66 3.73 – Overall 0.49 3.33 1.85 4.50 – 0.45 2.45 5.20 7.37 7.01 – 0.41 2.68 1.69 4.04 – (0.04) (0.07) (0.42) (0.39) (0.08) (0.08) (0.80) (0.71) (0.45) (0.09) (0.10) (0.31) (0.27) Mean ˆw(τt,s) × 102 Dependent 6.03 6.30 7.70 8.06 – 5.11 5.26 9.86 9.60 7.89 – 5.83 5.96 6.78 7.02 – Independent 1.42 14.7 0.40 10.2 – 0.29 11.1 2.02 7.74 15.4 – 0.08 7.02 2.91 14.5 – Overall 2.08 13.5 1.45 9.86 – 1.61 9.52 4.17 8.25 13.3 – 1.53 6.75 3.89 12.6 – (0.17) (0.30) (0.26) (0.08) (0.28) (0.32) (0.48) (0.29) (0.40) (0.23) (0.24) (0.30) (0.41) MAB(ρt,s) × 102 1.51 3.70 13.0 10.7 3.41 0.99 1.25 15.0 12.2 3.33 4.46 1.06 2.17 1.85 4.13 4.93 (0.04) (0.09) (0.13) (0.06) (0.14) (0.09) (0.11) (0.36) (0.22) (0.08) (0.18) (0.03) (0.04) (0.07) (0.08) (0.16)Downloaded by [Dalhousie University] at 03:38 28 December 2012 Smith et al.: Pair-Copula Decomposition of Serial Dependence 1475 parsimonious representation of a D-vine can substantially im- prove the estimation of the conditional dependence structure. Even when an incorrect pair-copula family is chosen, selec- tion can enhance the estimated dependence structures, with E2s dominating E2f. The second summary is the width ˆw(τt,s) of the 90% poste- rior probability interval for τt,s, deﬁned for each dataset as fol- lows. Order the iterates {τt,s(θ [1] t,s ),...,τt,s(θ [J] t,s )} from smallest to largest, and then compute the Monte Carlo estimate of the interval by counting off the lower and upper 5% of the iter- ates. The mean width, computed across pair-copulas and simu- lation replicates, is reported over all pair-copulas and also bro- ken down by pair-copula type. Estimator E1s has substantially lower widths than the other estimators, and by at least an order of magnitude for the independence pair-copulas, again suggest- ing that the selection methodology is working well. For the se- lection estimators E1s and E2s, the posterior distribution of τt,s has a sizable point mass at 0 for many (t, s) ∈ I. Consequently, posterior intervals of τt,s for different probabilities can be indis- tinguishable, inﬂating the coverage statistics and making them uninformative, so that we do not report them here. To assess the accuracy of the estimation of the unconditional dependence structure we also compute the MAB for the mar- ginal pairwise Spearman’s correlations ρs,t. For Model A, esti- mators E1s, E1f/E3, and E4 all ﬁt Gaussian copulas, which are the correct parametric form for this model. Nevertheless, the ﬂexible estimators E1s and E4 which employ Bayesian selec- tion methodologies provide the best results. However, selection based on the D-vine decomposition is superior to that based on the Cholesky decomposition employed by Smith and Kohn (2002). Moreover, E1s dominates E4 in all three models. The standard errors in Table 2 show that the differences between estimator performance are signiﬁcant. Overall, the simulation suggests that the selection method works well, and can improve both the estimated conditional and unconditional dependence structure. In every case, selection with the correct pair-copula family substantially out-performs all alternatives. Throughout, the pair-copula model substantially out-performs the common alternative of ﬁtting a Gaussian copula, with or without a ﬂexi- ble correlation matrix. 5. NEW SOUTH WALES INTRADAY ELECTRICITY LOAD Modeling and forecasting electricity load at an intraday res- olution is an important problem faced by all electricity util- ities; see Soares and Medeiros (2008) for a recent overview. When observed intraday, load has both strong periodic behav- ior and meteorologically induced variation (Pardo, Meneu, and Valor 2002). Numerous models have been proposed for intraday load, but some of the most successful are longitudinal (Cottet and Smith 2003) because they allow all aspects of the model to vary diurnally. We model electricity load in New South Wales (NSW) observed between January 2, 2002 and January 2, 2005 in MegaWatt hours (MWh). The data were used previously by Panagiotelis and Smith (2008), who employ a longitudinal model with multivariate Gaussian disturbances over the day. We also use a longitudinal model, but where the intraday depen- dence is captured by a more ﬂexible pair-copula formulation. For every hour (t = 1,..., 24) load Li,t on day i is modeled with the marginal regression Li,t = α1 t + α2 t i + β′ t zi,t + α3 t |Ti,t − 18.3|+ δtLi−1,t + ϵi,t, (5.1) where {ϵ1,t,...,ϵn,t} are t distributed with scale σ 2 t and degrees of freedom νt. The coefﬁcients α1 t and α2 t measure level and linear time trend, δt captures interday linear correlation, and zi,t is a vector containing the 12 seasonal polynomials and 14 day type dummy variables listed in Panagiotelis and Smith (2008). The effect of air temperature (the temperature Ti,t is ambient air temperature in degrees centigrade at Bankstown airport in western Sydney, which is considered the centroid of demand in NSW by regulators) Ti,t is nonlinear with a minimum at 18.3◦C (65◦F), which is a commonly employed functional form in the demand modeling literature (Pardo, Meneu, and Valor 2002). Each of the T = 24 marginal models is estimated using max- imum likelihood. Residual plots show that the regressions re- move the strong signal in the load data, and quantile plots in- dicate that the marginal t distribution in Equation (5.1)isap- propriate. Figure S3 in the supplementary materials plots the estimates of σt and νt. To account for the strong intraday dependence a pair-copula decomposition with xi = (Li,1,..., Li,24)′ is used, where the ﬁrst element corresponds to load at 03:30, which is the approx- imate time of the overnight low in demand. We ﬁrst employ Gaussian pair-copulas and selection, which produces strong positive dependencies between load at times t and t − 1, with Pr(γt,t−1 = 1|x) ≈ 1 throughout, and 0.51 ≤ E(τt,t−1|x) ≤ 0.78. The dependence structure is sparse, with Pr(γt,s = 1|x)< 0.5 for 212 of the N = 276 pair-copulas, and Figure S4 in the sup- plementary materials presents the estimated vine in full. We also employ Gumbel pair-copulas with selection. The Gumbel admits only positive dependence, but has proven particularly successful in modeling the bivariate dependence of ﬁnancial re- turns. Figure 2 plots the estimates of Pr(γt,s = 1|x) in panel (a) and E(τt,s|x) in panel (b). As with the Gaussian pair-copula vine, strong dependencies between loads at time t and t − 1 are captured, although the dependence structure is more sparse, with Pr(γt,s = 1|x)< 0.5 for 243 of the Gumbel pair-copulas. To judge the adequacy of different copulas we employ the di- agnostic based on the distribution of the sum discussed in Sec- tion 3.4. However, as our empirical benchmark we employ the copula data ui,t = Tν((Li,t − ˆLi,t;ˆσt), where Tν(·; σ) is a t dis- tribution function with scale σ and ν degrees of freedom, com- puted over a 210 day long forecast period January 3 to July 31, 2005, so that i = n,...,(n + 210). These are the marginal pre- dictive distributions with parameter values estimated from the in-sample data, but evaluated at the out-of-sample data points. Figure 3 plots KDEs constructed from the thinned Monte Carlo samples of S for vine copulas constructed from Gaussian, Gum- bel, and Clayton pair-copulas with and without selection. These are the Bayesian estimates of the ﬁtted distribution f (S|x).Also plotted is the distribution of S based on an assumption of in- dependence, and that observed empirically over the forecast period. Ignoring the intraday dependence in the data leads to substantial under-statement of future variation in the sum. This translates directly into an under-statement in the variation of future daily total load, a quantity that is also important to elec- tricity utilities. All three pair-copula models improve substan- tially on this benchmark; however, the Gaussian and GumbelDownloaded by [Dalhousie University] at 03:38 28 December 2012 1476 Journal of the American Statistical Association, December 2010Figure2.Gumbelpair-copulaestimatesfortheNSWelectricityexample.Panel(a)depictstheprobabilitiesPr(γt,s=1|x),andpanel(b)theestimatedposteriormeansE(τt,s|x),inrowtandcolumns.Inbothpanels,higherabsolutevaluescorrespondtodarkercellsandlowerabsolutevaluescorrespondtolightercells.Downloaded by [Dalhousie University] at 03:38 28 December 2012 Smith et al.: Pair-Copula Decomposition of Serial Dependence 1477 Figure 3. Distributions of diagnostic S for the NSW electricity load example. The solid line corresponds to an assumption of intraday in- dependence, while the distribution of the empirically observed data is given by the dashed (red) line. The distributions corresponding to the three parametric pair-copula models are also shown with line types (colors) as indicated. The online version of this ﬁgure is in color. pair-copula models appear to be more inline with the observed load than the Clayton. To further compare the three pair-copula models, we under- take a small intraday forecasting trial. We use a daily rolling window over the period January 3–30, 2005, and set T = 12, so that each margin corresponds observations at two-hour in- tervals. Intraday forecasts are essential for effective system management by electricity utilities. Forecasts for peak peri- ods are typically made at midmorning, and are much more accurate than those made prior to 09:00 (Cottet and Smith 2003). The forecasts are constructed by evaluating the distri- bution F(Li,12,..., Li,h+1|Li,h,..., Li,1), where \u0003 is integrated out with respect to f (\u0003|x) and h = 4 in our work, which cor- responds to 09:30. To evaluate this conditional distribution we append Algorithm 2 to the end of the sampling scheme, but skip Steps (1) and (2) for t ≤ h. Using the predictive means as forecasts, Table 3 reports the mean absolute deviation (MAD) and mean squared error (MSE) for all three vine copulas. The Gumbel pair-copula model produces the most accurate fore- casts, and selection improves the forecasts throughout, showing the usefulness of a data-based parsimonious model here. Cap- turing intraday dependence is important, with all copula models out-performing the marginal models substantially. The forecasts show there is a substantial difference between vines constructed from different pair-copulas. To further illus- trate this, Figure 4 plots contours of the marginal bivariate dis- tributions of load at 09:30 along with load at 11:30, 13:30, 15:30, and 17:30 on January 3, 2005. This is estimated by sim- ulating iterates from the Gumbel pair-copula model with \u0003 in- tegrated out with respect to f (\u0003|x) in a Monte Carlo fashion. The four distributions are highly nonelliptical and pairwise de- pendence is nonlinear. Table 3. Performance of intraday forecasts for the three pair-copula models with selection (Select) and without selection (Full). Also reported is the performance of forecasts made from the marginal regression models which do not account for any intraday dependence. Forecasts are made at 09:30 for periods ahead at two-hour intervals. The best performing model at each forecast period is denoted in bold Gaussian Clayton Gumbel t (hour) Full Select Full Select Full Select Marginal Mean Absolute Deviation (MAD) 5 (11:30) 0.276 0.280 0.337 0.345 0.249 0.247 0.424 6 (13:30) 0.255 0.260 0.364 0.369 0.229 0.221 0.459 7 (15:30) 0.232 0.233 0.380 0.382 0.220 0.208 0.556 8 (17:30) 0.223 0.211 0.361 0.353 0.199 0.176 0.812 9 (19:30) 0.152 0.133 0.269 0.263 0.142 0.122 0.918 10 (21:30) 0.097 0.091 0.200 0.196 0.107 0.082 0.479 11 (23:30) 0.078 0.074 0.138 0.135 0.079 0.061 0.374 12 (01:30) 0.077 0.077 0.123 0.121 0.082 0.066 0.407 Mean Squared Error (MSE) 5 (11:30) 0.125 0.131 0.195 0.200 0.107 0.106 0.265 6 (13:30) 0.112 0.116 0.226 0.231 0.098 0.093 0.371 7 (15:30) 0.095 0.097 0.265 0.267 0.098 0.092 0.479 8 (17:30) 0.081 0.072 0.231 0.224 0.073 0.062 0.867 9 (19:30) 0.049 0.031 0.138 0.132 0.0405 0.034 1.129 10 (21:30) 0.018 0.016 0.093 0.092 0.0275 0.021 0.343 11 (23:30) 0.011 0.012 0.043 0.042 0.0141 0.011 0.184 12 (01:30) 0.011 0.010 0.027 0.027 0.012 0.008 0.216 6. DISCUSSION We argue in this paper that pair-copula constructions, and in particular the D-vine, are suitable for the modeling of longitudi- nal data, where the time ordering of the data is exploited. This is unlike the graphical models case, where establishing an order- ing of the margins is often difﬁcult. Bivariate Archimedean cop- ulas (Genest and Rivest 1993), t copulas (Demarta and McNeil 2005), and skew t copulas (Smith, Gan, and Kohn 2010)are promising choices of pair-copula, with the resulting D-vines capturing serial dependence in a more ﬂexible manner than multivariate elliptical copula. Our approach extends the current literature on covariance modeling for longitudinal data from the Gaussian case (Smith and Kohn 2002; Huang et al. 2006;Lev- ina, Rothman, and Zhu 2008) to a wide range of non-Gaussian situations. Ibragimov and Lentzas (2008) and Domma, Gior- dano, and Perri (2009) both construct time series models using bivariate copulas to capture serial dependence. However, these are ﬁrst-order Markov models, where the resulting multivariate copulas are not recognized as D-vines, and inference for higher order Markov models is not considered. Our method extends the Bayesian selection approach of Pitt, Chan, and Kohn (2006) for Gaussian copula, and also of Smith and Kohn (2002) when applied to the correlation matrix of a Gaussian copula. We show in our empirical work that the ap- proach is highly reliable in identifying any parsimony in the conditional dependence structure, and provides more efﬁcient estimates of both conditional and marginal pairwise dependen- cies when such parsimony exists. The practical beneﬁts are demonstrated by the substantial improvement in forecasts that are obtained in the electricity load example. Bayesian selec- tion is particularly appropriate for computing inference whenDownloaded by [Dalhousie University] at 03:38 28 December 2012 1478 Journal of the American Statistical Association, December 2010 Figure 4. Contour plots of marginal bivariate densities of load (in gigawatt hours) on January 3, 2005 from the ﬁtted Gumbel pair-copula model. The four panels are for load at (09:30, 11:30), (09:30, 13:30), (09:30, 15:30), and (09:30, 17:30). The densities were constructed using KDEs of 19,500 iterates simulated by appending Algorithm 2 to the end of each sweep of the sampling scheme. the data have the potential to exhibit Markovian properties, by allowing exploration of the high dimensional model space. We mention here that because Algorithm 1 has to be run in its entirety to evaluate the likelihood, estimation of the D-vine for higher values of T is computationally burdensome. This is particularly the case when the pair-copula densities and cor- responding h functions involve more computations to evalu- ate. However, if the dependence structure is parsimonious, so that γt,s = 0for many (t, s) ∈ I, estimation can be substantially faster. Alternative shrinkage methods (Huang et al. 2006;Lev- ina, Rothman, and Zhu 2008) also have potential for the efﬁ- cient estimation of vine copula models. While modeling serial dependence is our objective, we note here that vine copula models have also been used to model cross-sectional dependence (Aas et al. 2009; Czado, Gärtner, and Min 2009; Min and Czado, 2010a). Recent work by Haff, Aas, and Frigessi (2010) suggests that vine copulas can account for a wide range of dependence, including that exhibited by el- liptical copulas. Our Bayesian selection method can be used to estimate other vines as well. However, in the cross-sectional case the method identiﬁes a parsimonious multivariate depen- dence structure, without the interpretation that is possible when using a D-vine to model serial dependence. SUPPLEMENTAL MATERIALS Parts A–C: Part A: An illustration of how a Gaussian AR(2) model can be represented as a D-vine. Part B: Second em- pirical example using cow liveweight data which has a low sample size and uses t pair-copulas. Part C: Additional ﬁg- ures and tables numbered with preﬁx “S.” (SM_smith_min_ almeida_czado.pdf) Part D: Data ﬁles for the two real data examples. (eg1.dat, eg2.dat) [Received September 2009. Revised June 2010.] REFERENCES Aas, K., Czado, C., Frigessi, A., and Bakken, H. (2009), “Pair-Copula Con- structions of Multiple Dependence,” Insurance: Mathematics and Eco- nomics, 44 (2), 182–198. [1467,1469,1478] Bedford, T., and Cooke, R. (2002), “Vines—A New Graphical Model for Dependent Random Variables,” The Annals of Statistics, 30, 1031–1068. [1467,1468] Cherubini, U., Luciano, E., and Vecchiato, W. (2004), Copula Methods in Fi- nance, Chichester, England: Wiley. [1467] Clayton, D. (1978), “A Model for Association in Bivariate Life Tables and Its Application to Epidemiological Studies of Family Tendency in Chronic Dis- ease Incidence,” Biometrika, 65, 141–151. [1467] Cottet, R., and Smith, M. (2003), “Bayesian Modeling and Forecasting of Intra- day Electricity Load,” Journal of the American Statistical Association, 98, 839–849. [1468,1475,1477] Cripps, E., Carter, C., and Kohn, R. (2005), “Variable Selection and Covariance Selection in Multivariate Regression Models,” in Handbook of Statistics 25: Bayesian Thinking: Modeling and Computation, eds.D.Dey andC.Rao, Amsterdam: North-Holland, pp. 519–552. [1471] Czado, C. (2010), “Pair-Copula Constructions of Multivariate Copulas,” in Workshop on Copula Theory and Its Applications,eds.F.Durante,W.Här- dle, P. Jaworki, and T. Rychlik, Dordrecht: Springer. [1467] Czado, C., Gärtner, F., and Min, A. (2009), “Analysis of Australian Electric- ity Loads Using Joint Bayesian Inference of D-Vines With Autoregressive Margins,” in Dependence Modeling—Handbook on Vine Copulae,eds.D. Kurowicka and H. Joe, to appear. [1478]Downloaded by [Dalhousie University] at 03:38 28 December 2012 Smith et al.: Pair-Copula Decomposition of Serial Dependence 1479 Daniels, M., and Pourahmadi, M. (2009), “Modeling Covariance Matrices via Partial Autocorrelations,” Journal of Multivariate Analysis, 100 (10), 2352– 2363. [1471] Demarta, S., and McNeil, A. (2005), “The t-Copula and Related Copulas,” In- ternational Statistical Review, 73, 111–129. [1467,1477] Domma, F., Giordano, S., and Perri, P. (2009), “Statistical Modeling of Tempo- ral Dependence in Financial Data via a Copula Function,” Communications in Statistics, 38, 703–728. [1467,1477] Embrechts, P., Lindskog, F., and McNeil, A. (2003), “Modelling Dependence With Copulas and Applications to Risk Management,” in Handbook of Heavy Tailed Distributions in Finance, ed. S. Rachev, Amsterdam: Else- vier. [1472] Frees, E., and Valdez, E. (1998), “Understanding Relationships Using Copulas,” North American Actuarial Journal, 2 (1), 1–25. [1467] Frees, E., and Wang, P. (2006), “Copula Credibility for Aggregate Loss Mod- els,” Insurance: Mathematics and Economics, 38, 360–373. [1467] Gabriel, K. (1962), “Ante-Dependent Analysis of an Ordered Set of Variables,” The Annals of Mathematical Statistics, 33, 201–212. [1470] Genest, C., and Rivest, L.-P. (1993), “Statistical Inference Procedures for Bi- variate Archimedean Copulas,” Journal of the American Statistical Associ- ation, 88, 1034–1043. [1477] Glidden, D. (2007), “Pairwise Dependence Diagnostics for Clustered Failure- Time Data,” Biometrika, 94, 371–385. [1472] Haff, I., Aas, K., and Frigessi, A. (2010), “On the Simpliﬁed Pair-Copula Construction—Simply Useful or Too Simplistic?” Journal of Multivariate Analysis, 101, 1296–1310. [1467,1468,1478] Huang, J., Liu, N., Pourahmadi, M., and Liu, L. (2006), “Covariance Matrix Selection and Estimation via Penalised Normal Likelihood,” Biometrika, 93, 85–98. [1468,1477,1478] Ibragimov, R., and Lentzas, G. (2008), “Copulas and Long Memory,” Discus- sion Paper 2160, Harvard Institute of Economics Research. [1477] Joe, H. (1996), “Families of m-Variate Distributions With Given Margins and m(m − 1)/2 Bivariate Dependence Parameters,” in Distributions With Fixed Marginals and Related Topics, eds. L. Rüschendorf, B. Schweizer, and M. Taylor, Hayward, CA: Institute of Mathematical Statistics. [1467,1469] (1997), Multivariate Models and Dependence Concepts, London: Chapman & Hall. [1467,1472] (2006), “Generating Random Correlation Matrices Based on Partial Correlations,” Journal of Multivariate Analysis, 71, 2177–2189. [1471] Kohn, R., Smith, M., and Chan, C. (2001), “Nonparametric Regression Using Linear Combinations of Basis Functions,” Statistics and Computing, 11, 313–322. [1471] Kurowicka, D., and Cooke, R. (2006), Uncertainty Analysis With High Dimen- sional Dependence Modelling, New York: Wiley. [1467] (2007), “Sampling Algorithms for Generating Joint Uniform Distrib- utions Using the Vine-Copula Method,” Computational Statistics and Data Analysis, 51, 2889–2906. [1469] Lambert, P., and Vandenhende, F. (2002), “A Copula-Based Model for Multi- variate Non-Normal Longitudinal Data: Analysis of a Dose Titration Safety Study on a New Antidepressant,” Statistics in Medicine, 21, 3197–3217. [1467] Levina, E., Rothman, A., and Zhu, J. (2008), “Sparse Estimation of Large Co- variance Matrices via a Nested Lasso Penalty,” The Annals of Applied Sta- tistics, 1, 245–263. [1477,1478] Liu, X., Daniels, M., and Marcus, B. (2009), “Joint Models for the Association of Longitudinal Binary and Continuous Processes With Application to a Smoking Cessation Trial,” Journal of the American Statistical Association, 104, 429–438. [1468,1471] Meester, S., and MacKay, J. (1994), “A Parametric Model for Cluster Correlated Categorical Data,” Biometrics, 50, 954–963. [1467] Min, A., and Czado, C. (2010a), “Bayesian Inference for Multivariate Copulas Using Pair-Copula Constructions,” Journal of Financial Econometrics,to appear. [1468,1478] (2010b), “SCOMDY Models Based on Pair-Copula Constructions With Application to Exchange Rates,” working paper, Zentrum Mathe- matik, Technische Universität München. [1468] Nelsen, R. (2006), An Introduction to Copulas (2nd ed.), New York: Springer. [1467,1472] Nott, D., and Kohn, R. (2005), “Adaptive Sampling for Bayesian Variable Se- lection,” Biometrika, 92, 747–763. [1471] Oakes, D. (1989), “Bivariate Survival Models Induced by Frailties,” Journal of the American Statistical Association, 84, 487–493. [1467] Panagiotelis, A., and Smith, M. (2008), “Bayesian Identiﬁcation, Selection and Estimation of Semiparametric Functions in High-Dimensional Addi- tive Models,” Journal of Econometrics, 143, 291–316. [1471,1475] Pardo, A., Meneu, V., and Valor, E. (2002). “Temperature and Seasonality Inﬂu- ences on Spanish Electricity Load,” Energy Economics, 24, 55–70. [1475] Patton, A. (2006), “Modelling Asymmetric Exchange Rate Dependence,” In- ternational Economic Review, 47, 527–556. [1467] Pitt, M., Chan, D., and Kohn, R. (2006), “Efﬁcient Bayesian Inference for Gaussian Copula Regression Models,” Biometrika, 93, 537–554. [1470, 1471,1477] Pourahmadi, M. (1999), “Joint Mean-Covariance Models With Applications to Longitudinal Data: Uncontrained Parameterisation,” Biometrika, 86, 677– 690. [1468,1470] Silva, R., and Lopes, H. (2008), “Copula, Marginal Distributions and Model Se- lection: A Bayesian Note,” Statistics and Computing, 18, 313–320. [1472] Sklar, A. (1959), “Fonctions de répartition à n dimensions et leurs marges,” Publications de l’Institut de Statistique de l’Universit de Paris, 8, 229–231. [1468] Smith, M., and Kohn, R. (2002), “Parsimonious Covariance Matrix Estimation for Longitudinal Data,” Journal of the American Statistical Association,91 (460), 1141–1153. [1468-1470,1473-1475,1477] Smith, M., Gan, Q., and Kohn, R. (2010), “Modeling Dependence Using Skew t Copulas: Bayesian Inference and Applications,” working paper, Melbourne Business School, University of Melbourne. [1477] Soares, L., and Medeiros, M. (2008), “Modeling and Forecasting Short-Term Electricity Load: A Comparison of Methods With an Application to Brazil- ian Data,” International Journal of Forecasting, 24, 630–644. [1468,1475] Song, P. (2000), “Multivariate Dispersion Models Generated From Gaussian Copula,” Scandinavian Journal of Statistics, 27, 305–320. [1467] Sun, J., Frees, E., and Rosenberg, M. (2008), “Heavy-Tailed Longitudinal Data Modeling Using Copulas,” Insurance: Mathematics and Economics, 42, 817–830. [1467]Downloaded by [Dalhousie University] at 03:38 28 December 2012","libVersion":"0.3.2","langs":""}