{"path":"lit/lit_notes_OLD_PARTIAL/Zilko16mixedDscrtContinCopula.pdf","text":"Computational Statistics and Data Analysis xx (xxxx) xxx–xxx Q1 Contents lists available at ScienceDirect Computational Statistics and Data Analysis journal homepage: www.elsevier.com/locate/csda Copula in a multivariate mixed discrete–continuous model Q2 Aurelius A. Zilko ∗, Dorota Kurowicka Delft Institute of Applied Mathematics, Delft University of Technology, The Netherlands a r t i c l e i n f o Article history: Received 11 June 2015 Received in revised form 15 February 2016 Accepted 15 February 2016 Available online xxxx Keywords: Copula Vine Mixed models a b s t r a c t The use of different copula-based models to represent the joint distribution of an eight- dimensional mixed discrete and continuous problem consisting of five discrete and three continuous variables is investigated. The discussion starts with the theoretical properties of the copula-based models. Four different models are constructed for the data collected for the purpose of predicting the length of disruption caused by problems with the train detec- tion system in the Dutch railway network and their performance is tested. The more com- plex models turn out to represent the data better. Nevertheless, it is shown that the simpler eight dimensional Normal copula still constitutes a statistically sound model for the data. © 2016 Elsevier B.V. All rights reserved. 0. Introduction 1 Copulas separate information present in the margins from the dependence in the joint distribution. They have been 2 proven to be very attractive in many different applications where a joint distribution of continuous variables is of interest. 3 However, when copulas are used for discrete models, Genest and Nešlehová (2007) show that the popular way of copula 4 parameters estimation, through finding an empirical dependence measure and equating it to the theoretical one, is highly bi- 5 ased. Nevertheless, the maximum likelihood technique can still be used, even if it is much more computationally expensive. 6 Maximum likelihood estimation of copula parameters for discrete models requires an approximation of a multidimen- 7 sional integral or evaluating 2n finite differences of the copula to find the value of the probability mass function of an 8 n-dimensional model. Due to computational costs, many copula applications of discrete models have only involved lower 9 dimensional problems. Nikoloulopoulos and Karlis (2008) constructed a four-dimensional Bernoulli distribution with the 10 help of several different copula families with three parameters and Song et al. (2009) built a trivariate discrete distribution 11 with the Normal copula. In both cases, the copula models worked well and the authors highlighted that the dependence 12 structure between the variables did not only come from the copula but also from the margins. 13 Nikoloulopoulos (2013) proposed computing the rectangle probabilities using the simulated maximum likelihood 14 approach method. The new approach has been shown in Nikoloulopoulos (2015) to be applicable in dimension of up to 225, 15 even though as dimension and sample size increase, computational burden becomes heavy. Another alternative technique 16 to estimate the parameters uses the Bayesian methods as proposed by Smith and Khaled (2012). However, this technique is 17 also computationally intensive. 18 The reduction in estimation cost of copula parameters has been achieved in Panagiotelis et al. (2012) by using the 19 copula-vine approach. The multivariate discrete distribution has been constructed with a set of pairwise bivariate (con- 20 ditional) copulas arranged according to a graphical structure called a regular vine (for more information about vines, see 21 Kurowicka and Joe, 2011). The conditional copulas in this construction are assumed not to depend on the conditioning vari- 22 ables. The computation cost of calculating the probability mass function with this approach only grows as 2n(n − 1), which 23 makes this model applicable even for very high dimensional problems. 24 ∗ Corresponding author. E-mail address: A.A.Zilko@tudelft.nl (A.A. Zilko). http://dx.doi.org/10.1016/j.csda.2016.02.017 0167-9473/© 2016 Elsevier B.V. All rights reserved. 2 A.A. Zilko, D. Kurowicka / Computational Statistics and Data Analysis xx (xxxx) xxx–xxx Similarly to purely discrete models, mixed discrete and continuous models with copulas encounter problems. Most1 applications of copulas to low dimensional problems are available in the literature. Song et al. (2009) model a bivariate2 mixed binary discrete (disposition) and continuous (severity of burn injury) variables with a Normal copula. De Leon and3 Wu (2010) proposed two strategies to compute the maximum likelihood for a bivariate mixed discrete and continuous4 distribution with a simulation study and an application to the same data set as in Song et al. (2009). He et al. (2012) used5 the Normal copula to construct two and three dimensional mixed discrete and continuous models each with one discrete6 variable to study the relationship between the genotype (discrete) and a few continuous phenotypes such as the cholesterol7 density and the protein concentration. Stöber et al. (2015) constructed a six-dimensional mixed discrete and continuous8 model with five binary variables and one continuous variable representing six chronic diseases by following the copula-9 vine approach with constant conditional copulas as described in Panagiotelis et al. (2012).10 In the first part of this paper, we concentrate on theoretical issues concerning the use of copulas for purely discrete and11 mixed discrete–continuous models. A few simple results of the existence of a copula model for the joint distribution of12 binary variables are provided. This investigation provides a background for the exploration of copula models for a mixed13 discrete and continuous data presented in Zilko et al. (2015), where five binary and three continuous variables are used to14 construct a latency time model that is part of the railway disruption length model. The goal is to choose a model that allows15 fast and accurate prediction of the latency time for different combinations of values of the other variables in the model.16 The rest of the paper is organized as follows. Section 1 introduces copula models for multivariate Bernoulli distribution.17 In Section 2 mixed discrete–continuous models with copulas are presented. Section 3 is concerned with the application of18 copula models to the latency time data. This section contains the results. Finally, conclusions and short discussions on how19 the model that is constructed in this paper will be used in practice are presented in Section 4.20 1. Multivariate Bernoulli distribution with copulas21 The aim of this section is to lay a theoretical background and discuss copula models for discrete and mixed22 discrete–continuous distributions. We start with the multivariate Bernoulli distribution and investigate the existence of23 a copula family that allows representation of such a distribution. We present a copula construction that allows to model any24 multivariate Bernoulli distribution.25 Let X = (X1, . . . , Xn) be a random vector taking values in {0, 1} n and x = (x1, . . . , xn) be a realization of X. The joint26 probability is27 P(X1 = x1, X2 = x2, . . . , Xn = xn) = p(x1, x2, . . . , xn) = p(0, 0, . . . , 0) n j=1(1−xj)p(1, 0, . . . , 0) x1 n j=2(1−xj) . . . p(1, 1, . . . , 1) n j=1 xj (1) where all the p’s must sum up to 1. The marginal distribution of Xi is28 P(Xi = 0) = pi =  x1,...,xi−1,xi+1,...,xn∈{0,1} p(x1, . . . , xi−1, 0, xi+1, . . . , xn).29 Another popular representation of a multivariate Bernoulli distribution is the log-linear expansion. Taking the logarithm of30 the probability in (1) and collecting the appropriate terms leads to:31 log p(x1, x2, . . . , xn) = log p(0, 0, . . . , 0) +  i uixi +  i,j uijxixj32 +  ijk uijkxixjxk + · · · + u12...nx1x2 . . . xn. (2)33 The u-terms in (2) represent the two, three, . . . , n-way interactions between the variables (see e.g. Whittaker, 1990) and they can be obtained from the probabilities as follows: u1 = log p(1, 0, 0, . . . , 0) p(0, 0, 0, . . . , 0) , u12 = log p(1, 1, 0, . . . , 0)p(0, 0, 0, . . . , 0) p(1, 0, 0, . . . , 0)p(0, 1, 0, . . . , 0) , (3) u123 = log p(1, 1, 1, 0, . . . , 0)p(1, 0, 0, 0, . . . , 0)p(0, 1, 0, 0, . . . , 0)p(0, 0, 1, 0, . . . , 0) p(1, 1, 0, 0, . . . , 0)p(1, 0, 1, 0, . . . , 0)p(0, 1, 1, 0, . . . , 0)p(0, 0, 0, 0, . . . , 0) . The interactions between the variables contain information about dependence. The term u12 is also known as the log34 cross-product ratio (cpr) between variables X1 and X2. Notice that the cross product ratio cpr(X1, X2) can be rewritten in35 terms of conditional probabilities of variables X1 and X2 given all remaining variables X3, . . . , Xn equal zero. Moreover, u12336 A.A. Zilko, D. Kurowicka / Computational Statistics and Data Analysis xx (xxxx) xxx–xxx 3 is the logarithm of the ratio of the cross product ratio of variables X1, X3 given X2 = 1, and the cross product ratio of X1, X3 1 given X2 = 0. 2 The symbol uij represents the two-way dependence between the variables Xi and Xj. However the dependence between 3 Xi and Xj is also affected by all higher order interactions containing these variables. 4 Example 1.1 (The Trivariate Bernoulli Distribution). The trivariate Bernoulli distribution of (X1, X2, X3) is 5 P(X1 = x1, X2 = x2, X3 = x3) = p(0, 0, 0)(1−x1)(1−x2)(1−x3) . . . p(1, 1, 1) x1x2x3 (4) 6 for x1, x2, x3 ∈ {0, 1}. Its log-linear expansion is: log p(x1, x2, x3) = u∅ + u1x1 + u2x2 + u3x3 + u12x1x2 + u13x1x3 + u23x2x3 + u123x1x2x3 (5) where u∅ = log p(0, 0, 0) and the u-terms are as presented in (3). 7 The conditional distribution of X1 and X3 given X2 = x2 is a bivariate Bernoulli distribution. Let the log cross product 8 ratio of this conditional distribution be denoted as u13|2=x2 . When u13|2=x2 = 0, the variables X1|X2 = x2 and X3|X2 = x2 9 are independent. Moreover, when u13|2=x2 = 0 for both realizations of x2 = 0 and x2 = 1, the variables X1 and X3 are 10 conditionally independent given variable X2. Notice that u13 = u13|2=0 and u123 = log  cpr(X1,X3|X2=1) cpr(X1,X3|X2=0) . Hence X1 and X3 are 11 conditionally independent given variable X2 if and only if u123 = 0 and u13 = 0. 12 The above relationships can be generalized for higher-order interactions and allow independencies and conditional 13 independencies to be read from the log-linear expansion by examining the u-terms. Moreover, if the random vector 14 (X1, . . . , Xn) has the Bernoulli distribution, then it is easy to see that the conditional distributions are also Bernoulli. 15 The dependences between variables with Bernoulli distributions are contained in the u-terms of its log-linear expansion. Q3 16 A very popular way of examining dependence in a joint distribution, especially for continuous distributions, is to study its 17 corresponding copula. 18 A copula is the joint distribution of n uniform variables in the n-dimensional unit hypercube. Due to the Sklar’s theorem 19 (Sklar, 1959), any joint cumulative distribution of variables (X1, . . . , Xn), denoted as F1,...,n, can be rewritten in terms of the 20 corresponding copula C as 21 F1,...,n(x1, . . . , xn) = P(X1 ≤ x1, . . . , Xn ≤ xn) = C(P(X1 ≤ x1), . . . , P(Xn ≤ xn)). (6) 22 The copula satisfying Eq. (6) is unique if the variables are continuous. When one or more variables are discrete, however, 23 the copula satisfying (6) is no longer unique. 24 1.1. Bivariate Bernoulli distribution with copulas 25 To illustrate how copulas are used to model discrete distributions and to present the graphical interpretation of Eq. (6), a bivariate Bernoulli random vector (X1, X2) with margins p1, p2 is considered. Moreover, let UX1 and UX2 be uniform random variables with copula C . The probability mass function of (X1, X2) can be represented in terms of latent variables UX1 and UX2 with copula C as follows: P(X1 = x1, X2 = x2) =    p(0, 0), UX1 ≤ p1, UX2 ≤ p2; p(0, 1), UX1 ≤ p1, UX2 > p2; p(1, 0), UX1 > p1, UX2 ≤ p2; p(1, 1), UX1 > p1, UX2 > p2. (7) Fig. 1 shows the above construction graphically. The two axes in Fig. 1 correspond to the latent vector (UX1 , UX2 ). The 26 range UX1 ∈ (0, p1] in the vertical axes corresponds to the realization X1 = 0; and UX2 ∈ (0, p2] on the horizontal axes to 27 X2 = 0. The mass in the bottom left rectangle is P(X1 = 0, X2 = 0) = p(0, 0). 28 In this case, Eq. (6) takes the form of 29 P(X1 ≤ x1, X2 ≤ x2) = C(P(X1 ≤ x1), P(X2 ≤ x2)). (8) 30 Since P(X1 ≤ 1, X2 ≤ x2) = P(X2 ≤ x2) = C(1, P(X2 ≤ x2)) for x2 ∈ {0, 1} and P(X1 ≤ x1, X2 ≤ 1) = P(X1 ≤ x1) = 31 C(P(X1 ≤ x1), 1) for x1 ∈ {0, 1} hold for any copula, the only constraint on C to realize the distribution of (X1, X2) is: 32 p(0, 0) = P(X1 ≤ 0, X2 ≤ 0) = C(P(X1 ≤ 0), P(X2 ≤ 0)) = C(p1, p2). (9) 33 For continuous random vectors, there exists a unique copula that models the dependence of the joint distribution. 34 However, the copula is constrained to satisfy the Sklar’s theorem in every point of the unit hypercube. In the bivariate 35 Bernoulli case, where the constraint is at only one point in the unit square, any copula satisfying (9) will be appropriate to 36 model the dependence of (X1, X2). The bounds on copulas satisfying (9) have been presented in Carley (2002). The upper 37 (lower) Carley bound belongs to the family of copulas constructed as a shuffle of the upper (M) and lower (W ) Fréchet 38 bounds, where M = min(u, v) and W (u, v) = max(u + v − 1, 0) for (u, v) ∈ (0, 1)2 (Nelsen, 2006). The mass in M and W 39 4 A.A. Zilko, D. Kurowicka / Computational Statistics and Data Analysis xx (xxxx) xxx–xxx Fig. 1. The unit square corresponding to the latent variables (UX1 , UX2 ). is concentrated uniformly on the diagonal and anti-diagonal of the unit square, respectively. For (UX1 , UX2 ) with copula M1 (W ), the Spearman’s correlation is ρ(UX1 , UX2 ) = 1(−1).2 If a one-parametric copula family is already chosen to work with, the non-uniqueness problem of the copulas satisfying3 (9) is avoided. However, then one might face the problem of non-existence of a copula in the chosen class that satisfies4 Eq. (9). In the theorem below, the conditions that a copula has to satisfy to be able to recover a bivariate Bernoulli distribution5 are given.6 Theorem 1.1. Let (X1, X2) be Bernoulli distributed random vector. Let Cθ be a one-parametric copula that is continuous with7 respect to θ and satisfies:8 lim θ→θL Cθ (u, v) = W (u, v) and lim θ→θU Cθ (u, v) = M(u, v) for (u, v) ∈ (0, 1) 2 9 for some θL and θU , where W (u, v) and M(u, v) are the lower and upper Fréchet bounds, respectively. Then, there exists a θ which10 satisfies11 Cθ (P(X1 ≤ 0), P(X2 ≤ 0)) = Cθ (p1, p2) = p(0, 0) = P(X1 ≤ 0, X2 ≤ 0). (10)12 Proof. Since any copula at point (p1, p2) has to lie between the lower and upper Fréchet bounds at (p1, p2), p(0, 0) has to13 satisfy14 W (p1, p2) ≤ p(0, 0) ≤ M(p1, p2). (11)15 Since limθ→θL Cθ (p1, p2) = W (p1, p2), limθ→θU Cθ (p1, p2) = M(p1, p2), and Cθ is continuous with respect to θ , inequality16 (11) together with the Intermediate Value Theorem guarantee the existence of θ ∈ [θL, θU ] such that Eq. (10) is satisfied. □17 Corollary 1.1. The bivariate Normal copula is defined as:18 Cρ(u, v) = Φρ(Φ−1(u), Φ−1(v)), (u, v) ∈ (0, 1)2, ρ ∈ (−1, 1). (12)19 This copula is known to be a continuous function of the parameter ρ and20 lim ρ→−1 Cρ(u, v) = W (u, v) and lim ρ→1 Cρ(u, v) = M(u, v).21 Therefore, according to Theorem 1.1, the solution to Eq. (10) exists for the Normal copula.22 The corollary above states that one can always find a Normal copula which corresponds to a bivariate Bernoulli random23 variable. This paper mainly concentrates on the Normal copula as this is the copula that is intended to be used in the24 application part further on.25 In Fig. 2 (left), the relationship between the parameter of the Normal copula and the probability p(0, 0) = P(X1 =26 0, X2 = 0) of Bernoulli distribution with margins p1 = 0.4 and p2 = 0.8 is shown. The joint probability p(0, 0) is bounded27 by max(p1 + p2 − 1, 0) and min(p1, p2). When p(0, 0) = 0.37, the parameter of the Normal copula is ρ = 0.4868. Fig. 228 (right) illustrates the relationship between the parameter of the Normal copula and p(0, 0) in case of different univariate29 margins.30 The Normal copula is often applied in practice. However, the relationships between the margins, p(0, 0), and the param-31 eters of other copulas can be found as well. These relationships are not available in nice analytic form but in the bivariate32 case they can be calculated easily. Fig. 3 illustrates the relationship between p(0, 0) and Spearman’s correlations realized33 A.A. Zilko, D. Kurowicka / Computational Statistics and Data Analysis xx (xxxx) xxx–xxx 5 Fig. 2. The plot of the parameter of the Normal copula versus the joint probability of variables X1 and X2. Fig. 3. The plot of the Spearman’s correlation of the copula versus the joint probability between variables X1 and X2. by Normal, Frank’s and Student t copula in case of the bivariate Bernoulli distribution as in the example depicted in Fig. 2 1 (left). Fig. 3 shows that for different copula families, the relationships differ slightly. 2 Next, it will be checked whether the properties of the latent random vector (UX1 , UX2 ) translate to equivalent properties of 3 its corresponding Bernoulli distributed variables (X1, X2). The example below shows that, in contrast to continuous variables, 4 two Bernoulli distributions constructed with the same copula have very different dependences. 5 Example 1.2. Let a bivariate Normal copula with parameter ρ = 0.4868 be a distribution of latent variables UX1 , UX2 . We 6 fix the first margin to be p1 = 0.4 and the second margin can vary p2 ∈ (0, 1). For each p2, the log cross product ratio and 7 rank correlation of the corresponding Bernoulli distribution are calculated. It turns out that both values are different for 8 different choice of p2 as presented in Fig. 4. Moreover, the minimum log cross product ratio is obtained at p2 = 0.4459 and 9 the maximum rank correlation is obtained at p2 = 0.4375. 10 6 A.A. Zilko, D. Kurowicka / Computational Statistics and Data Analysis xx (xxxx) xxx–xxx Fig. 4. The log cross product ratio and rank correlation of bivariate Bernoulli with varying p2 ∈ (0, 1). Example 1.2 shows that dependences of Bernoulli distributed random vector depend not only on the copula, but also on1 the marginal distributions. This observation is in line with previous contributions in Denuit and Lambert (2005), Mesfioui2 and Tajar (2005) and Nešlehová (2007).3 1.2. Trivariate Bernoulli distribution with copulas4 In the case of a three-dimensional Bernoulli distribution, the Sklar’s equality (6) takes the following form:5 P(X1 ≤ x1, X2 ≤ x2, X3 ≤ x3) = C(P(X1 ≤ x1), P(X2 ≤ x2), P(X3 ≤ x3)).6 Given that the univariate margins of the Bernoulli random vector (X1, X2, X3) are fixed and all probabilities have to sum7 to one, a copula C needs to satisfy the following four equations8    P(X1 ≤ 0, X2 ≤ 0, X3 ≤ 0) = C(P(X1 ≤ 0), P(X2 ≤ 0), P(X3 ≤ 0)), P(X1 ≤ 0, X2 ≤ 0, X3 ≤ 1) = C(P(X1 ≤ 0), P(X2 ≤ 0), P(X3 ≤ 1)) = C(P(X1 ≤ 0), P(X2 ≤ 0), 1), P(X1 ≤ 0, X2 ≤ 1, X3 ≤ 0) = C(P(X1 ≤ 0), P(X2 ≤ 1), P(X3 ≤ 0)) = C(P(X1 ≤ 0), 1, P(X3 ≤ 1)), and P(X1 ≤ 1, X2 ≤ 0, X3 ≤ 0) = C(P(X1 ≤ 1), P(X2 ≤ 0), P(X3 ≤ 0)) = C(1, P(X2 ≤ 0), P(X3 ≤ 1)), (13)9 to model the dependence of (X1, X2, X3). The second, third, and fourth equations of (13) correspond to the three bivariate10 margins of the copula. The first equation completes the information needed to construct a trivariate Bernoulli distribution.11 Consider a Normal copula CR with a symmetric and positive definite matrix R of bivariate correlations12 R =  1 ρ12 ρ13 ρ12 1 ρ23 ρ13 ρ23 1  .13 It is easy to see why there might be a problem with the existence of a Normal copula that realizes a given trivariate Bernoulli14 distribution. The three correlations in the correlation matrix are determined by the second, third, and fourth equations in15 (13), and each can be computed as in Section 1.1. These three correlations have to (1) form a positive definite matrix R. If16 this is the case, additionally (2) the first equation in (13) has to be satisfied. In the following example, these problems are17 highlighted.18 Example 1.3. Consider a trivariate Bernoulli distribution with margins P(X1 = 0) = 0.4, P(X2 = 0) = 0.8, and19 P(X3 = 0) = 0.2 and joint probabilities20 • P(X1 = 0, X2 = 0, X3 = 0) = 0.01 • P(X1 = 0, X2 = 0, X3 = 1) = 0.3621 • P(X1 = 1, X2 = 0, X3 = 0) = 0.16 • P(X1 = 1, X2 = 0, X3 = 1) = 0.2722 • P(X1 = 0, X2 = 1, X3 = 0) = 0.02 • P(X1 = 0, X2 = 1, X3 = 1) = 0.0123 • P(X1 = 1, X2 = 1, X3 = 0) = 0.01 • P(X1 = 1, X2 = 1, X3 = 1) = 0.16.24 A.A. Zilko, D. Kurowicka / Computational Statistics and Data Analysis xx (xxxx) xxx–xxx 7 The bivariate margins of this distribution are: 1 • P(X1 = 0, X2 = 0) = 0.37 • P(X2 = 0, X3 = 0) = 0.17 2 • P(X1 = 0, X3 = 0) = 0.03. 3 Notice that the bivariate margin of (X1, X2) of the Bernoulli has been discussed in Section 1.1. From the last three equations 4 in (13), we find ρ12 = 0.4868, ρ13 = −0.4868, ρ23 = 0.1340. These form a positive definite matrix. However with the 5 obtained matrix R, CR(0.4, 0.8, 0.2) = 0.0298 ̸= 0.01 = P(X1 = 0, X2 = 0, X3 = 0). Hence the Bernoulli distribution 6 cannot be recovered with a Normal copula. 7 A Bernoulli distribution inherits some properties from its corresponding copula. However, it is not easy to specify con- 8 ditions under which a Bernoulli distribution can be constructed with a given copula. For some special cases we can give 9 conditions under which the construction is possible. 10 Proposition 1.1. If the trivariate Bernoulli distribution (Y1, Y2, Y3) obtained from a trivariate Normal copula CR has margins 11 P(Yi = 0) = 0.5 for all i ∈ {1, 2, 3}, then the three-way interaction u123 is zero. 12 Proof. Since the Normal copula realizes the trivariate Bernoulli distribution of (Y1, Y2, Y3) and ∀y1, y2, y3 ∈ {0, 1} when 13 P(Yi = 0) = 0.5, the radial symmetry of the trivariate Normal distribution implies: 14 p(y1, y2, y3) = p(1 − y1, 1 − y2, 1 − y3). 15 Therefore, in this case we get u123 = log  p(1, 1, 1)p(1, 0, 0)p(0, 1, 0)p(0, 0, 1) p(1, 1, 0)p(1, 0, 1)p(0, 1, 1)p(0, 0, 0)  = log  p(0, 0, 0)p(0, 1, 1)p(1, 0, 1)p(1, 1, 0) p(1, 1, 0)p(1, 0, 1)p(0, 1, 1)p(0, 0, 0)  = 0. □ By the construction of the Bernoulli distribution from a copula, we can immediately get the following result. 16 Proposition 1.2. If the margins of the Bernoulli distribution are P(Xi = 0) = 0.5 for all i ∈ {1, 2, 3} and the distribution has 17 a radial symmetry, i.e. p(x1, x2, x3) = p(1 − x1, 1 − x2, 1 − x3) for xi ∈ {0, 1}, (X1, X2, X3) can be realized with a trivariate 18 Normal copula. 19 Proof. Since the margins are equal to 0.5, writing p(1, 1, 1) in terms of p(0, 0, 0) leads to: 20 p(1, 1, 1) = −0.5 + p(0, 0, 0) + p(0, 0, 1) + p(0, 0, 0) + p(0, 1, 0) + p(0, 0, 0) + p(1, 0, 0) − p(0, 0, 0). 21 Because of the radial symmetry, the above equation becomes: 22 p(0, 0, 0) = P(X1 ≤ 0, X2 ≤ 0, X3 ≤ 1) + P(X1 ≤ 0, X2 ≤ 1, X3 ≤ 0) + P(X1 ≤ 1, X2 ≤ 0, X3 ≤ 0) − 0.5 2 . 23 The numerator of the right hand side of the above equation is determined from the second, third, and fourth equations of (13). 24 Therefore, the first equation of (13) is automatically satisfied by the parameters obtained from the other three equations. □ 25 Proposition 1.3. If the three-way interaction of a trivariate Bernoulli distribution (X1, X2, X3) is zero and P(Xi = 0) = 0.5 for 26 all i ∈ {1, 2, 3}, a trivariate Normal copula is able to realize (X1, X2, X3). 27 Proof. The proof can be found in the Appendix. 28 Proposition 1.3 implies that a zero three-way interaction does not guarantee the existence of a Normal copula that 29 corresponds to the given Bernoulli distribution. 30 Let the latent vector (UY1 , UY2 , UY3 ) be joined by a Normal copula CR such that UY1 and UY3 are independent conditionally 31 on UY2 . This happens when the correlations in R are such that ρ13 = ρ12 · ρ23 (Whittaker, 1990). The example below 32 shows that the conditional independence of latent variables does not translate to the corresponding Bernoulli random vector 33 (Y1, Y2, Y3). 34 Example 1.4. Let (Y1, Y2, Y3) be a trivariate Bernoulli distribution realized by a bivariate Normal copula C with parameters 35 ρ12 = 0.5, ρ13 = −0.5, and ρ23 = ρ12 · ρ13 = −0.25 and let P(Y1 = 0) = 0.4, P(Y2 = 0) = 0.8, and P(Y3 = 0) = 0.2. We 36 have that UY2 , UY3 are conditionally independent given UY1 . 37 The variables Y2|Y1 and Y3|Y1 where (Y1, Y2, Y3) is constructed with copula C are not conditionally independent. In fact, 38 the u-terms of the distribution of (Y1, Y2, Y3) are: u123 = −0.1408 ̸= 0 and u23 = −0.7485 ̸= 0. 39 Even in the case when P(Yi = 0) = 0.5 for all i ∈ {1, 2, 3}, the conditional independence of the latent variables does 40 not translate to the conditional independence of the Y ’s. With the same correlation matrix as above and all margins equal 41 to 0.5, the u-term are: u23 = −0.6491 ̸= 0 and u123 = 0. 42 Corollary 1.2. From Proposition 1.3, if X1 and X3 are conditionally independent given X2 and the margins are P(Xi = 0) = 0.5 43 for all i ∈ {1, 2, 3}, then (X1, X2, X3) can be recovered with a trivariate Normal copula. 44 8 A.A. Zilko, D. Kurowicka / Computational Statistics and Data Analysis xx (xxxx) xxx–xxx 1.3. Non-constant conditional copula-vine1 In the previous section, we have investigated the existence of Normal copula for a given Bernoulli distribution. It was2 shown that in general it is not easy to give conditions which assert the existence or non-existence of the Normal copula3 for a specified Bernoulli distribution. This section examines a copula-vine approach to construct a multivariate discrete4 distribution proposed by Panagiotelis et al. (2012), which is based on the copula-vine specification (Kurowicka and Cooke,5 2006).6 In the copula-vine approach, the conditional distributions in the standard factorization of the joint probability mass7 function of (X1, . . . , Xn), namely8 P(X1 = x1, X2 = x2, . . . , Xn = xn) = P(X1 = x1)P(X2 = x2|X1 = x1) . . . P9 × (Xn = xn|X1 = x1, . . . , Xn−1 = xn−1) (14)10 are decomposed with specially chosen bivariate conditional distributions which are represented with conditional copulas.11 Following Panagiotelis et al. (2012), let V denote the conditioning set of the jth term on the right hand side of (14), and let12 V\\i represent V without Xi. Each term P(Xj = xj|V) for all j and i < j on the right hand side of (14) becomes13 P(Xj = xj|V = v) = P(Xj = xj, Xi = xi|V\\i = v\\i) P(Xi = xi|V\\i = v\\i) . (15)14 The numerator of the right-hand side of (15) can be rewritten and then expressed with copula P(Xj = xj, Xi = xi|V\\i = v\\i) = xj sj=0 xi si=0(−1)(sj+si)P(Xj ≤ xj − sj, Xi ≤ xi − si|V\\i = v\\i) = xj sj=0 xi si=0(−1) (sj+si)CXj,Xi|V\\i  P(Xj ≤ xj − sj|V\\i = v\\i), P(Xi ≤ xi − si|V\\i = v\\i) . (16) For i ̸= k < j, the arguments of the copula on the right-hand side of the above expression can also be expressed with copula: P(Xj ≤ xj − sj|V\\i = v\\i) = xk sk=0 (−1) sk CXj,Xk|V\\i,k P(Xj ≤ xj − sj|V\\i,k), P(Xk ≤ xk − sk|V\\i,k)  P(Xk = xk|V\\i,k) . (17) Note that the decomposition above is performed sequentially until the conditioning set V is empty. All (conditional)15 copulas appearing in this decomposition can be organized using a graphical structure called regular vine (Kurowicka and16 Cooke, 2006).17 In Panagiotelis et al. (2012), the assumption has been made that all conditional copulas do not depend on the conditioning18 variables. The conditional copulas in general do not have to be constant, so the following conditions have been proposed in19 Panagiotelis et al. (2012) to ensure the existence of constant conditional copulas for the multivariate Bernoulli case.20 Proposition 1.4. Let pj,(1), . . . , pj,(κ1) denote the ordered κ1 distinct values of P(Xj ≤ 0|V\\i = v\\i) and pi,(1), . . . , pi,(κ2) denote21 the ordered κ2 distinct values of P(Xi ≤ 0|V\\i = v\\i). A constant bivariate copula C exists over the conditioning set V\\i = v\\i if22 it solves23 P(Xj ≤ 0, Xi ≤ 0|V\\i = v\\i) = C  P(Xj ≤ 0|V\\i = v\\i), P(Xi ≤ 0|V\\i = v\\i)  24 for each member in the conditioning set. For this to happen, all of the (κ1 +1)(κ2 +1) values of P(pj,(a), pi,(b))−P(pj,(a−1), pi,(b))−25 P(pj,(a), pi,(b−1)) + P(pj,(a−1), pi,(b−1)) must be non-negative.26 Even if a constant conditional copula exists for the above construction, the copula does not have to be a Normal copula.27 To the best of the authors’ knowledge, there is no result ensuring when the constant Normal copula exists.28 For large models the assumption of constant conditional copula is understandable. In case of moderate sized models with29 variables that do not contain many states, it might be not prohibitive to consider the non-constant conditional copula-vine30 model. In such cases, different copulas can be specified for each combination of conditioning variables in (16).31 Theorem 1.2. Any multivariate Bernoulli random variables can be represented with the bivariate Normal copulas with the32 non-constant conditional copula-vine model.33 Proof. Because the conditional distribution of a multivariate Bernoulli distribution is also multivariate Bernoulli and for34 each combination of conditioning variables in Panagiotelis et al. (2012) the copulas are allowed to be different, then the35 result follows immediately from Theorem 1.1. □36 A.A. Zilko, D. Kurowicka / Computational Statistics and Data Analysis xx (xxxx) xxx–xxx 9 To illustrate how the non-constant conditional copula-vine model works, a simple example on the trivariate Bernoulli 1 variable is presented. 2 Example 1.5. Let (X1, X2, X3) be a trivariate Bernoulli distribution. First, two bivariate unconditional copulas are fixed, say 3 C12 and C23. Then, conditional copulas need to be specified for both realizations of variable X2 which are denoted as: C13|2=0 4 and C13|2=1. 5 The parameters of four bivariate Normal copulas have to be such that Eqs. (13) are all satisfied. The parameters ρ12 and ρ23 of the Normal copula C12 and C23 are found from the second and fourth equations of (13), respectively. One finds the parameter of copula C13|2=0 to satisfy the first equation and C13|2=1 the fourth equation as follows: P(X1 ≤ 0, X2 ≤ 0, X3 ≤ 0) = P(X1 ≤ 0, X2 = 0, X3 ≤ 0) = P(X1 ≤ 0, X3 ≤ 0|X2 = 0)P(X2 = 0) = C13|2=0(P(X1 ≤ 0|X2 = 0), P(X3 ≤ 0|X2 = 0))P(X2 = 0) and P(X1 ≤ 0, X2 ≤ 1, X3 ≤ 0) = P(X1 ≤ 0, X2 = 1, X3 ≤ 0) + P(X1 ≤ 0, X2 = 0, X3 ≤ 0) = C13|2=1(P(X1 ≤ 0|X2 = 1), P(X3 ≤ 0|X2 = 1))P(X2 = 1) + P(X1 ≤ 0, X2 = 0, X3 ≤ 0). Since there is no constraint on copulas in the above representation, any copula can be chosen and all four equations in 6 (13) are satisfied. These conditional copulas correspond to P(X1 ≤ 0, X3 ≤ 0|X2 = 0) and P(X1 ≤ 0, X3 ≤ 0|X2 = 1); both 7 are bivariate Bernoulli distributions. 8 For the Bernoulli distribution in Example 1.3, the parameters of the Normal copulas can be calculated as above and are 9 equal to: ρ12 = 0.4868, ρ23 = 0.1340, ρ13|2=0 = −0.7612, and ρ13|2=1 = 0.8552. We see that the Normal copula 10 parameters are very different for different realization of variable X2. 11 Moreover, (X1, X3|X2) cannot be represented with any constant conditional copula. In this example, P(X1 = 0|X2 = 12 0) = 0.4625 > P(X1 = 0|X2 = 1) = 0.1500, P(X3 = 0|X2 = 0) = 0.2125 > P(X3 = 0|X2 = 1) = 0.1500, and 13 P(X1 = 0, X3 = 0|X2 = 0) = 0.0125 < P(X1 = 0, X3 = 0|X2 = 1) = 0.1000. This results in the probability in the region 14 ([0, P(X1 = 0|X2 = 0)] × [0, P(X3 = 0|X2 = 0)]) \\ ([0, P(X1 = 0|X2 = 1)] × [0, P(X3 = 0|X2 = 1)]) to be negative which 15 is a violation of the condition in Proposition 1.4. 16 For a joint Normal copula, each marginal as well as conditional copula are Normal and the conditional copulas do not 17 depend on the conditioning variables. This property does not translate to the trivariate Bernoulli distribution (Y1, Y2, Y3) 18 implied by the Normal copula. It is not always the case that the conditional copulas C13|2=0 and C13|2=1 are equal. 19 Proposition 1.5. Let the univariate margins of a trivariate Bernoulli distribution (X1, X2, X3) are P(Xi = 0) = 0.5 for all 20 i ∈ {1, 2, 3}. The trivariate Normal copula realizes (X1, X2, X3) if and only if Cij|k=0 = Cij|k=1 for any combinations of 21 i, j, k ∈ {1, 2, 3} where Cij|k is a radially symmetric copula. 22 Proof. The proof can be found in the Appendix. 23 According to Proposition 1.5, if C13|2=0 and C13|2=1 are the independent copulas and the margins are 0.5, then the 24 distribution of (Y1, Y2, Y3) can be represented by the Normal copula and the variables Y1 and Y3 are conditionally 25 independent given variable Y2. However, the latent variables UY1 and UY3 are not conditionally independent given UY2 . This 26 is illustrated in the following example. 27 Example 1.6. Let (Y1, Y2, Y3) be a trivariate Bernoulli distribution with P(Yi = 0) = 0.5 for all i ∈ {1, 2, 3} and both C13|2=0 28 and C13|2=1 are the independent copulas. Assume that the bivariate margins (Y1, Y2) and (Y2, Y3) are represented by the 29 bivariate Normal copula with parameters 0.5 and −0.5, respectively. Then Y1 and Y3 are conditionally independent given 30 Y2 and the trivariate Normal copula with parameters r12 = 0.5, r23 = −0.5, and r13 = −0.1736 represents the trivariate 31 Bernoulli distribution (Y1, Y2, Y3). However, r12 · r23 = −0.25 ̸= −0.1736 = r13 which means that the latent variables UY1 32 and UY3 are not conditionally independent given UY2 . 33 Any multivariate Bernoulli distribution can always be recovered with the non-constant conditional copula-vine approach. 34 This means that it can be constructed using building blocks consisting of bivariate Normal copulas. It is, however, not the 35 case when the conditioning copulas in the copula-vine approach are assumed not to depend on the conditioning variables, 36 and neither in the case of multivariate Normal copula. 37 2. Mixed discrete–continuous distributions with copulas 38 In this section, we discuss the extension of the copula modeling to discrete distributions with more than two states and 39 mixed discrete–continuous models. In case when the variables have more states, a copula used in the construction of such 40 a discrete distribution must satisfy more constraints. 41 10 A.A. Zilko, D. Kurowicka / Computational Statistics and Data Analysis xx (xxxx) xxx–xxx (a) X2 with three states. (b) X2 with four states. (c) X2 continuous. Fig. 5. The unit square corresponding to the latent variable (UX1 , UX2 ) for distributions of X2 with different number of states. (For interpretation of the references to colour in this figure legend, the reader is referred to the web version of this article.) 2.1. Bivariate case1 We start the exposition with the simplest possible case: a bivariate discrete distribution (X1, X2) with a margin taking2 values on {0, 1} and another taking values on {0, 1, 2}. In this case, a copula C that realizes (X1, X2) must satisfy the following3 conditions:4 P(X1 ≤ 0, X2 ≤ 0) = C(P(X1 ≤ 0), P(X2 ≤ 0)), P(X1 ≤ 0, X2 ≤ 1) = C(P(X1 ≤ 0), P(X2 ≤ 1)). (18)5 The Normal copula cannot always represent (X1, X2) anymore because of the over-determined system (18) that needs to be6 satisfied.7 With more states of the variables, the problem deteriorates simply because the number of equations in (18) increases8 while the number of parameters remains the same. When X2 is continuous, it has infinitely many states and a copula C that9 is able to recover the distribution of (X1, X2) needs to satisfy the following constraint for all realizations of X2:10 P(X1 ≤ 0, X2 ≤ x2) = C(P(X1 ≤ 0), P(X2 ≤ x2)). (19)11 Fig. 5 illustrates the problems of finding a copula graphically for distributions with more than two states. Fig. 5(a) is whenQ412 X2 has three states, Fig. 5(b) is when X2 has four states, and Fig. 5(c) is when X2 is continuous. The blue dots in Fig. 5(a) and13 (b) show where in the unit square the copula is constrained. When X2 is continuous, the copula is constrained at all points14 on the horizontal blue line in Fig. 5(c).15 Using (19), to see whether the copula C can model the mixed discrete–continuous bivariate variable (X1, X2), the16 conditional distribution of X2 given X1 should be compared with the conditional distribution of a copula:17 P(X2 ≤ x2|X1 ≤ 0) = C(P(X1 ≤ 0), P(X2 ≤ x2)) P(X1 ≤ 0) . (20)18 The following example illustrates this.19 Example 2.1. Let (X1, X2) be a mixed discrete–continuous bivariate random variable with X1 binary, P(X1 = 0) = 0.75, and20 X2 continuous with marginal distribution P(X2 ≤ x2). Fig. 6(a) shows the conditional distribution of the latent variable UX2 21 given UX1 ≤ 0.75 for Normal copulas with different parameters. Fig. 6(b) illustrates the conditional distributions as in (a) in22 case when Frank and Gumbel copulas are used to model dependence between UX2 and UX1 .23 When the variable X1 is also taken to be continuous, the conditions on the copula become24 P(X1 ≤ x1, X2 ≤ x2) = C(P(X1 ≤ x1), P(X2 ≤ x2)),25 which is none other than Sklar’s equation (6). In this case, the copula must conform to all points in the unit square of the26 latent variable (UX1 , UX2 ).27 2.2. Multivariate case28 In the higher-dimensional case, it becomes even more difficult to find the copula that generates the mixed model. The non-constant conditional copula-vine approach is presented in Section 1.3 can be seen as the most flexible model in this case. The conditional probabilities in (16) containing only discrete variables in the conditioning set have to be replaced by the followingQ5 A.A. Zilko, D. Kurowicka / Computational Statistics and Data Analysis xx (xxxx) xxx–xxx 11 (a) Three different UX2 |UX1 ≤ 0.75 from three Normal copulas. (b) Six different UX2 |UX1 ≤ 0.75 from three Frank copulas and three Gumbel copulas. Fig. 6. The conditional distribution of the latent variable UX2 given variable UX1 ≤ 0.75 with different copulas. P(Xj = xj, Xi ≤ xi|V\\i = v\\i) = xj sj=0(−1) sj P(Xj ≤ xj − sj, Xi ≤ xi|V\\i = v\\i) (21) = xj sj=0(−1) sj CXj,Xi|V\\i P(Xj ≤ xj − sj|V\\i = v\\i), P(Xi ≤ xi|V\\i = v\\i) (22) where Xj corresponds to the binary variable, Xi corresponds to the continuous variable, and V\\i contains only discrete 1 variables. In this case, the approach as illustrated in Example 2.1 can be used for each combination of conditioning variables 2 in (22). 3 3. Copula application for the latency time data 4 In this section, we apply the theory discussed in the first part of the paper to model the disruption length data presented 5 in Zilko et al. (2015). This data has been collected for the purpose of predicting the length of disruptions caused by problems 6 with the train detection system in the Dutch railway network. In this paper, we have chosen five discrete and two continuous 7 variables that are going to be used as predictors of a continuous variable describing the latency time (the time needed for a 8 mechanic to arrive at the problematic site). The full model will contain an additional part that deals with the repair time of 9 the failures. 10 3.1. The data 11 The data set contains information of the detection system failure in the Dutch railway network from 1 January 2011 12 until 30 June 2013. During this period, 1932 urgent detection system incidents are recorded. First, we present the variables 13 involved in the latency time model. The latency time model consists of eight variables: 14 1. The contract type (Contract Type/CT ): 1 corresponds to the new contract type and 0 corresponds to old contract type. 15 The new contract introduces a penalty factor if the repair work takes too long. 16 2. The distance to the nearest mechanics workshop (Workshop Distance/WD) in kilometers. 17 3. The distance to the nearest level crossing (Level Cross Distance/LC ) in meters. 18 4. Whether the failure occurs during the mechanic’s contractual working time or not (Working Time/WT ): 1 corresponds 19 to the contractual working time and 0 otherwise. 20 5. Whether the failure occurs during the rush hour period or not (Rush Hour/RH): 1 corresponds to the rush hour time and 21 0 otherwise. 22 6. Whether the temperature at the time of failure is 25 °C and above or the otherwise (Warm/WM): 1 corresponds to 23 temperature of 25 °C and above and 0 otherwise. 24 7. The existence of another failure that occurs at the same time (Overlap/OV ): 1 corresponds to the existence of an 25 overlapping failure and 0 otherwise. 26 8. The latency time (Latency Time/LAT ) in minutes. 27 Three of the variables, Workshop Distance, Level Cross Distance, and Latency Time, are continuous while the other five are 28 binary. 29 The margins of the five binary variables are P(CT = 0) = 0.4550, P(WT = 0) = 0.6755, P(RH = 0) = 0.7505, 30 P(WM = 0) = 0.9415, and P(OV = 0) = 0.9513. Zilko et al. (2015) have tested the three continuous variables for 31 12 A.A. Zilko, D. Kurowicka / Computational Statistics and Data Analysis xx (xxxx) xxx–xxx (a) Workshop Distance (WD). (b) Level Cross Distance (LC ). (c) Latency Time (LAT ). Fig. 7. The empirical distributions of the three continuous variables: Workshop Distance, Level Cross Distance, and latency time. (For interpretation of the references to colour in this figure legend, the reader is referred to the web version of this article.) the possibility of representing them with parametric distributions. The margins were tested against the exponential, log-1 normal, Gamma, and Weibull distributions whose parameters were calculated with maximum likelihood. The considered2 parametric distributions were rejected for all three variables. The best p-values of the Kolmogorov–Smirnov goodness of3 fit test (KS Test) of these parametric distributions were 3.11e−05 for the Weibull distribution and WD, 1.68e−10 for the4 Weibull distribution and LC , and 1.52e−15 for the Gamma distribution and LAT . The dashed blue lines in Fig. 7 are the5 empirical marginal distributions of the three continuous variables while the red lines represent the corresponding fitted6 parametric distributions. In the following sections where the dependence structure is modeled with copulas, we use the7 empirical distribution functions to estimate the margins of the continuous variables.8 Using the procedure as in Breymann et al. (2003) which is based on the probability integral transform (PIT test) to test9 whether Normal copula recovers the dependence between the three continuous variables, we obtain a p-value of 0.7936,10 indicating good fit of the copula.11 3.1.1. Normal copula12 The correlation matrix R of the multivariate Normal copula representing a mixed discrete and continuous random vector13 (X1, . . . , Xk, Xk+1, . . . , Xn), where the first k variables are binary and the rest are continuous, is estimated via likelihood14 maximization. We consider M realizations of (X1, . . . , Xn) where the ith realization is denoted as (xi1, . . . , xin) = (xid, xic ).15 We denote R[k + 1, . . . , n] as the part of the correlation matrix corresponding to the purely continuous part of the model16 and R[1, . . . , k|k + 1, . . . , n] as the correlation matrix of the Normal copula CR[1,...,k|k+1,...,n] corresponding to the conditional17 distribution of discrete variables given the continuous variables in the model. The log-likelihood is defined as18 ℓ(R) = M i=1 log  cR[k+1,...,n](xic )pR[1,...,k|k+1,...,n](xid|xic ) , (23)19 where the probability mass function is obtained through calculating the finite difference of the multivariate Normal copula20 of discrete variables conditional on the continuous variables:21 pR[1,...,k|k+1,...,n](xi1, . . . , xik) = xi1 s1=0 . . . xik sk=0(−1) k j sj CR[1,...,k|k+1,...,n]22 × (P(X1 ≤ xi1 − s1), . . . , P(Xk ≤ xik − sk)). (24)23 The parameters of the Normal copula that maximize (23), computed with the built-in MATLAB command, are shown in24 Table 1. The computation was heavy where with an Intel(R) Core i5-3470 3.2 GHz processor and 8 GB RAM, the parameter25 estimation took approximately 18 h with the correlations accuracy set to 10 −5.26 The log-likelihood of this model is −9475.9. The Normal copula recovers the continuous part of the model well with27 the PIT Test’s p-value of 0.7729. However, comparing the observed and predicted frequencies in the 32 cells contingency28 table for the five binary variables with the Kullback–Leibler divergence test (KL test), a p-value of 0.0030 is obtained. This29 indicates that the discrete part is not recovered well.30 The Normal copula model with parameters as in Table 1 is a saturated model where the correlations between all pairs are31 considered. However, it is observed that some of the estimates are small suggesting independencies, for instance between32 variables CT and WM. In principal, confidence intervals can be computed via simulation, but this is not feasible due to the33 very slow parameters estimation. Therefore, we simplify the model by including some conditional independencies implied34 by the structure of a Bayesian Network (BN) for the latency time model. This structure has been found in Zilko et al. (2015) by35 performing the hill-climbing greedy search in the space of all possible BN structures on the discretized version of the model36 where the continuous variables were discretized into four states each based on the algorithm presented in Margaritis (2003).37 The chosen structure is displayed in Fig. 8.38 A.A. Zilko, D. Kurowicka / Computational Statistics and Data Analysis xx (xxxx) xxx–xxx 13 Table 1 The parameters of the Normal copula. Parameter Value Parameter Value Parameter Value ρCT ,WD 0.1909 ρWD,RH −0.0717 ρWT ,RH 0.5762 ρCT ,LC −0.3009 ρWD,OV 0.2092 ρWT ,OV 0.1152 ρCT ,WT −0.1259 ρWD,LAT 0.1282 ρWT ,LAT −0.1404 ρCT ,WM 0.0131 ρLC,WT 0.0529 ρWM,RH 0.1349 ρCT ,RH −0.0733 ρLC,WM 0.0209 ρWM,OV 0.3571 ρCT ,OV 0.0387 ρLC,RH 0.0240 ρWM,LAT 0.0741 ρCT ,LAT −0.1078 ρLC,OV 0.0183 ρRH,OV 0.1574 ρWD,LC −0.0215 ρLC,LAT 0.1087 ρRH,LAT −0.0304 ρWD,WT −0.0802 ρWT ,WM 0.0616 ρOV ,LAT 0.1446 ρWD,WM 0.0855 Fig. 8. The Bayesian Network model of Latency Time. The variable WM is independent of CT , WD, LC , WT , and RH, as indicated by the graph. Moreover, WD and WT are 1 conditionally independent given CT . The log-likelihood of this model is −9482.7. The model recovers the continuous part 2 well with the PIT test’s p-value of 0.3239. However, the discrete part is not recovered well as indicated by the KL Test’s 3 p-value of 0.0005. In contrast to the saturated Normal copula model which has 28 parameters, the simplified model has 4 only 18 parameters and the likelihood has not decreased much. Performing the Likelihood Ratio Test applied to the two 5 models yields p-value of 0.1920. This indicates that the BN model is a better model for the data. 1 6 3.1.2. Copula-vine models 7 First of all for the copula-vine models, a vine structure needs to be chosen. With 8 nodes, there are 3.426e + 16 possible 8 vines (Morales Napoles, 2009). We choose to keep the purely discrete and purely continuous parts of the model as the 9 sub-vines of the full vine hence clustering the continuous and discrete variables. The discrete and continuous variables 10 are ordered as: CT , WM, WT , RH, OV and WD, LC, LAT , respectively. Even after clustering the continuous and discrete 11 variables in different sub-vines, there are still 64 different ways to merge these vines (Cooke et al., 2015). We choose the 12 decomposition of the joint that is known as one type of vine structure that is called the D-vine (Fig. 9). The choice is motivated 13 by the observed correlations between pairs of variables in the data and graphical simplicity of a D-vine model. Other choices 14 could be considered (some heuristic procedures to choose a vine structure for the data have been investigated in Kurowicka 15 and Joe, 2011). 16 A regular vine on n variables is a graphical structure. It is a nested set of n − 1 trees with nodes and edges. Nodes in 17 tree j become edges in tree j + 1 where j = 1, . . . , n − 1, and two edges in tree j can be connected by an edge in tree 18 j + 1 if they share a common node in tree j. In Fig. 9, the eight variables (numbers have been assigned to the variables to 19 simplify the notation) are represented in the D-vine as nodes. The five discrete variables are shown as white rectangles 20 1 Because a semi-parametric model is estimated where the margins are modeled with empirical distribution functions, the asymptotic theory of the likelihood ratio test, in principle, does not apply. 14 A.A. Zilko, D. Kurowicka / Computational Statistics and Data Analysis xx (xxxx) xxx–xxx Fig. 9. The chosen D-vine structure. (For interpretation of the references to colour in this figure legend, the reader is referred to the web version of this article.) while the three continuous variables as yellow rectangles. The edges in different trees are represented with different line1 styles. The red edges of the D-vine correspond to the purely discrete part of the model, the yellow lines correspond to the2 purely continuous part, and the rest represents the mixed pairs. The edges of the vine indicate the conditioned|conditioning3 variables and they correspond to the bivariate (conditional) copulas needed in the model.4 The distribution of (CT , WM, WT , RH, OV , WD, LC, LAT ) = (X1, . . . , X8) is decomposed using factorization (14) and5 (15) that correspond to the D-vine structure in Fig. 9. In this decomposition, the probabilities in (15) contain two discrete,6 two continuous, or discrete and continuous variables in the conditioned set. This corresponds to the red, yellow, and blue7 and black edges in Fig. 9. When both conditioned variables are discrete, their conditional probabilities are calculated as in8 Section 1.3. When one is continuous and the other discrete, their conditional probability is given by (21). For both continuous9 variables this probability becomes the conditional copula density.10 Estimation.11 We consider M realizations of the eight variables in the D-vine model where the ith realization is denoted as (xi1, . . . , xi8).12 As in the Normal copula model, the continuous variables are represented with their empirical distribution functions. The13 likelihood is14 ℓ(R) = M i=1 log (P(X1 = xi1, . . . , X5 = xi5)P(X6 = xi6|X1, . . . , X5)P(X7 = xi7|X1, . . . , X6)15 × P(X8 = xi8|X1, . . . , X7)) , (25)16 where R is the set of parameters of the vine model containing (conditional) correlations of Normal copula assigned to17 the edges of the vine in Fig. 9. P(X1 = xi1, . . . , X5 = xi5) is calculated with Eqs. (15), (16), and (17) as in Section 1.3,18 P(X6 = xi6|X1, . . . , X5) contains the product of factors as in Eq. (22), and the last two parts of the decomposition contain19 factors as in Eq. (22) and the copula densities when both conditioned variables are continuous.20 All copulas are assumed to be Normal. Estimation of the copulas’ parameters is performed sequentially starting from the21 unconditional copulas of (CT , WM), (WM, WT ), (WT , RH), (RH, OV ), (OV , WD), (WD, LC), and (LC, LAT ) in the first tree at22 the top of the D-vine structure in Fig. 9. Then, we estimate the copulas’ parameters in the second tree which contains pairs23 with one variable in the conditioning set. After that, we estimate the third tree and so on.24 To check the significance of the parameters, for each parameter we find its 95% confidence interval using simulation with25 1000 samples. If zero is contained in the confidence interval, the parameter value of the copula is set to be equal to 0. This26 procedure is applied in both the constant and non-constant copula-vine models which follow shortly. In Appendix C, we27 test the procedure on two artificial data sets whose true parameters values are known. It is shown that the procedure works28 well as the true values of the parameters are captured in the corresponding confidence intervals.29 A.A. Zilko, D. Kurowicka / Computational Statistics and Data Analysis xx (xxxx) xxx–xxx 15 Table 2 The parameters of the bivariate constant (conditional) copulas. If the corresponding confidence bound includes zero, the parameter is taken to be zero (shown in bold in a bracket). Parameter Value Parameter Value (Conf. bound) (Conf. bound) ρCT ,WM 0.0158 (0) ρWM,OV |WT ,RH 0.3851 (−0.2957, 0.3138) (0.1739, 0.4952) ρWM,WT 0.0540 (0) ρWT ,WD|RH,OV −0.0683 (−0.2446, 0.3794) (−0.1309, −0.0102) ρWT ,RH 0.5769 ρRH,LC|OV ,WD 0.0203 (0) (0.3932, 0.7187) (−0.0465, 0.0635) ρRH,OV 0.1288 (0) ρOV ,LAT |WD,LC 0.1141 (−0.2880, 0.3702) (0.0553, 0.2242) ρOV ,WD 0.2035 ρCT ,OV |WM,WT ,RH −0.4344 (0) (0.0143, 0.3571) (−0.9887, 0.0259) ρWD,LC −0.0080 (0) ρWM,WD|WT ,RH,OV 0.0152 (0) (−0.0604, 0.0572) (−0.0633, 0.1143) ρLC,LAT 0.0876 ρWT ,LC|RH,OV ,WD 0.0515 (0) (0.0179, 0.1554) (−0.0329, 0.1273) ρCT ,WT |WM −0.1213 ρRH,LAT |OV ,WD,LC −0.0279 (0) (−0.1724, −0.0692) (−0.1147, 0.0391) ρWM,RH|WT −0.1268 ρCT ,WD|WM,WT ,RH,OV 0.1761 (−0.2912, −0.0067) (0.0891, 0.2374) ρWT ,OV |RH −0.1880 ρWM,LC|WT ,RH,OV ,WD 0.0120 (0) (−0.2847, −0.0716) (−0.0643, 0.0926) ρRH,WD|OV −0.1002 ρWT ,LAT |RH,OV ,WD,LC −0.1523 (−0.1957, −0.0314) (−0.2187, −0.0899) ρOV ,LC|WD 0.0045 (0) ρCT ,LC|WM,WT ,RH,OV ,WD −0.2830 (−0.0680, 0.0756) (−0.3374, −0.2199) ρWD,LAT |LC 0.1154 ρWM,LAT |WT ,RH,OV ,WD,LC 0.0413 (0) (0.0440, 0.1837) (−0.0255, 0.1145) ρCT ,RH|WM,WT 0.2050 ρCT ,LAT |WM,WT ,RH,OV ,WD,LC −0.1279 (0.0074, 0.3635) (−0.1874, −0.0393) Constant copula-vine model. 1 In the constant copula-vine model, each pair in the second tree and higher is modeled with one conditional copula. 2 Applying the above procedure, we get a constant conditional Normal copula vine with parameters presented in Table 2. 3 The procedure simplifies the model by introducing some (conditional) independencies between the variables. We see the 4 variables WM and WT can be modeled independently and the variables OV and LC given WD can be modeled with Normal 5 copula with parameter 0. The log-likelihood of this model is −7692.4. With this model, the discrete part is also not well 6 recovered with the KL test’s p-value of 0.0245. However, the continuous part is recovered well with the PIT test’s p-value of 7 0.5582. 8 In this model, one Normal copula is used to represent a pair of variables regardless the values of their conditioning 9 variables. Fig. 10 shows the conditional distribution of WD|WT = 0, RH, OV and WD|WM = 0, WT , RH, OV for different 10 combinations of variables WT , RH, and OV . The dashed blue lines represent the empirical conditional distributions given 11 different values in each corresponding conditioning set and the solid red lines correspond to the fitted constant Normal 12 copula-vine model. It appears that the solid red lines do not deviate a lot from the dashed blue lines, indicating that the 13 constant Normal copula actually represents the data quite well. 14 So far the parameters of the D-vine model have been estimated sequentially. This estimation is fast and takes a few min- 15 utes to complete. The next step is to perform a full optimization of all parameters in the model together. Only parameters 16 that are not zero after the sequential fitting are considered in the full optimization. This approach is certainly computa- 17 tionally expensive. It took about 12 h to find the parameters of the model with a computer on an Intel(R) Core i5-3470 18 3.2 GHz processor and 8 GB RAM. The log-likelihood improves to −7476.5. The discrete part is still not well recovered with 19 the KL test’s p-value of 0.0329. However, the continuous part is recovered well with PIT test’s p-value of 0.8224. 20 16 A.A. Zilko, D. Kurowicka / Computational Statistics and Data Analysis xx (xxxx) xxx–xxx (a) The conditional distribution of (WD|WT = 0, RH, OV ). (b) The conditional distribution of (WD|WM = 0, WT , RH, OV ). Fig. 10. Empirical and constant copula based conditional distributions of variable WD given two conditioning sets. (For interpretation of the references to colour in this figure legend, the reader is referred to the web version of this article.) Non-constant copula-vine model.1 In the non-constant copula-vine model, all pairs where the conditioning sets contain only discrete variables are modeled2 with non-constant conditional copulas (which correspond to the red and blue edges of the D-vine in Fig. 9). This means3 that additionally to the non-constant copulas for the purely discrete part of the model, the copulas of the following4 variables are assumed to depend on the values of the conditioning variables as well: (RH, WD|OV ), (WT , WD|RH, OV ),5 (WM, WD|WT , RH, OV ), and (CT , WD|WM, WT , RH, OV ). The other eleven conditional copulas with at least one continuous6 variable in the conditioning set are assumed to be constant. Other orderings of variables could be considered in which more7 conditional copulas would be non-constant. One such structure is presented in Appendix D.8 As before, the significance of the parameters is tested by means of simulation. For the pairs where constant conditional9 copulas are assumed, the procedure is as in the constant copula-vine model. For the other pairs that are modeled with10 non-constant conditional copulas, the parameters’ estimates are calculated for each value of the conditioning variables11 and the 95% confidence bounds are computed via simulation each with 1000 samples. If the confidence bounds of all the12 estimates within a pair overlap, the conditional copula of the pair is set to be constant. If additionally the overlapping part13 contains zero, the parameter is set to 0.14 Table 3 shows the Normal copulas’ parameters of (WT , RH|OV ) and (CT , WD|WM, WT , RH, OV ) where two and sixteen,15 respectively, conditional copulas are estimated. Moreover the p-value of the KS test of the conditional distributions of WD16 for different combinations of conditioning variables are presented as well. We observe that the conditional distributions of17 the Normal copulas fit the data well.18 The conditional probability P(RH, WD|OV ) can be modeled with constant conditional copula with parameter −0.100219 because the confidence bounds of ρRH,WD|OV =0 and ρRH,WD|OV =1 overlap. This indicates weak dependence between RH|OV20 and WD|OV . Conditioning on WM = 0, WT = 1, RH = 1, OV = 1, there are only 7 samples of WD in the data set. With21 very few data, unsurprisingly the parameter’s confidence bound is very wide and contains zero so that CT and WT given22 WM = 0, WT = 1, RH = 1, OV = 1 can be modeled with the independent copula.23 Fig. 11 presents an illustration of the pair (WT , RH|OV ) where the dashed blue lines correspond to the empirical24 conditional distributions and the red solid lines correspond to the fitted copulas for the variables WD|RH = 0, OV = 025 and WD|RH = 0, OV = 1. The conditional distribution of WD|RH = 0, OV = 0 shown in Fig. 11(a) with the solid red line is26 obtained from the copula model and the dashed blue line is the empirical one obtained from the 1389 samples. The red and27 blue lines appear to be very close to each other and close to the diagonal, indicating the good fit of Normal copula (confirmed28 with the KS-test p-value of 0.4210) and their closeness to independence.29 The entire parameters of the non-constant copula-vine model along with their confidence bounds are presented in30 Table C.1. We notice that many parameters are set to zero. We observe that the parameters of the Normal copulas for31 some pairs conditioned on different values of conditioning variables can differ quite significantly as well. For instance,32 the parameters of the four Normal copulas fitted to the pair (CT , RH|WM, WT ) are ρCT ,RH|WM=0,WT =0 = −0.1860,33 ρCT ,RH|WM=0,WT =1 = 0, ρCT ,RH|WM=1,WT =0 = 0.4710 and ρCT ,RH|WM=1,WT =1 = 0.34 The log-likelihood of this model is −7644.1. The discrete part is recovered well with p-value of the KL test to be 0.2155.35 The continuous part of this model is the same as in the constant copula-vine model where it is already observed to be36 well-recovered.37 Similarly as in the constant copula-vine approach, full optimization via maximum likelihood approach can also be per-38 formed to estimate the parameters. With this approach, the log-likelihood improves to −7344.7. The discrete part is recov-39 ered with the KL test’s p-value of 0.2237 and the continuous part is recovered well with the PIT test’s p-value of 0.6390.40 Performing the Likelihood Ratio Test, the p-values are very close to 0 for both the sequential and full-optimized41 approaches between the constant and non-constant copula-vine models. This indicates that the non-constant copula-vine42 model provides better fit for the data.43 A.A. Zilko, D. Kurowicka / Computational Statistics and Data Analysis xx (xxxx) xxx–xxx 17 Table 3 Parameters of the bivariate (conditional) normal copulas of (RH, WD|OV ), (WM, WD|WT , RH, OV ) along with the p-values of the conditional distribution of WD for different combinations of the conditioning variables for the copula model and the data. Parameter Value # Sam Conditional distribution p-value (Conf. bound) ρRH,WD|OV =0 −0.0738 (−0.1002) 1389 FWD|RH=0,OV =0 0.4210 (−0.1300, −0.0209) ρRH,WD|OV =1 −0.1213 (−0.1002) 61 FWD|RH=0,OV =1 0.9964 (−0.1567, −0.0656) ρCT ,WD|WM=0,WT =0,RH=0,OV =0 0.2444 431 FWD|CT =0,WM=0,WT =0,RH=0,OV =0 0.2051 (0.1635, 0.3111) ρCT ,WD|WM=0,WT =0,RH=0,OV =1 0.1546 (0) 14 FWD|CT =0,WM=0,WT =0,RH=0,OV =1 0.5824 (−0.2278, 0.5959) ρCT ,WD|WM=0,WT =0,RH=1,OV =0 0.2118 75 FWD|CT =0,WM=0,WT =0,RH=1,OV =0 0.7046 (0.0462, 0.4135) ρCT ,WD|WM=0,WT =1,RH=0,OV =0 0.0965 (0) 152 FWD|CT =0,WM=0,WT =1,RH=0,OV =0 0.6232 (−0.0491, 0.2421) ρCT ,WD|WM=1,WT =0,RH=0,OV =0 0.1094 (0) 25 FWD|CT =0,WM=1,WT =0,RH=0,OV =0 0.8916 (−0.3646, 0.5012) ρCT ,WD|WM=1,WT =1,RH=0,OV =0 −0.1013 (0) 12 FWD|CT =0,WM=1,WT =1,RH=0,OV =0 0.8323 (−0.6242, 0.4463) ρCT ,WD|WM=1,WT =0,RH=1,OV =0 0.2608 (0) 6 FWD|CT =0,WM=1,WT =0,RH=1,OV =0 0.9989 (−0.3939, 0.8685) ρCT ,WD|WM=1,WT =0,RH=0,OV =1 0.0012 (0) 3 FWD|CT =0,WM=1,WT =0,RH=0,OV =1 0.8833 (−0.0720, 0.0995) ρCT ,WD|WM=0,WT =1,RH=1,OV =0 0.0747 (0) 137 FWD|CT =0,WM=0,WT =1,RH=1,OV =0 0.7577 (−0.0569, 0.2192) ρCT ,WD|WM=0,WT =1,RH=0,OV =1 0.2528 (0) 6 FWD|CT =0,WM=0,WT =1,RH=0,OV =1 0.8740 (−0.5006, 0.7496) ρCT ,WD|WM=0,WT =0,RH=1,OV =1 0.0021 (0) 7 FWD|CT =0,WM=0,WT =0,RH=1,OV =1 0.9971 (−0.7106, 0.3661) ρCT ,WD|WM=1,WT =1,RH=1,OV =0 −0.9891 (0) 1 FWD|CT =0,WM=1,WT =1,RH=1,OV =0 0.3489 (−0.9991, 0.9921) ρCT ,WD|WM=1,WT =1,RH=0,OV =1 −0.8765 (0) 1 FWD|CT =0,WM=1,WT =1,RH=0,OV =1 0.3353 (−0.9451, 0.9871) ρCT ,WD|WM=1,WT =0,RH=1,OV =1 0.7518 (0) 2 FWD|CT =0,WM=1,WT =0,RH=1,OV =1 0.7754 (−0.7714, 0.8989) ρCT ,WD|WM=0,WT =1,RH=1,OV =1 −0.5228 (0) 7 FWD|CT =0,WM=0,WT =1,RH=1,OV =1 0.4689 (−0.9708, 0.3070) ρCT ,WD|WM=1,WT =1,RH=1,OV =1 0.0039 (0) 3 FWD|CT =0,WM=1,WT =1,RH=1,OV =1 0.7055 (−0.9990, 0.9819) 3.2. Models validation 1 In this section, we compare the performance of different Latency Time models that we have constructed: 2 1. Eight dimensional Normal copula. 3 2. Eight dimensional Normal copula with conditional independence statements represented by the BN structure in Fig. 8. 4 3. The copula-vine approach with constant conditional Normal copula. 5 4. The copula-vine approach with non-constant conditional Normal copula. 6 The Akaike Information Criterion (AIC) is used as a criteria for model validation. Moreover, a validation test is performed 7 where for each data point, the quantile of the conditional distribution of latency time corresponding to the observed latency 8 18 A.A. Zilko, D. Kurowicka / Computational Statistics and Data Analysis xx (xxxx) xxx–xxx (a) The conditional distribution of (WD|RH = 0, OV = 0) with 1389 samples from data. (b) The conditional distribution of (WD|RH = 0, OV = 1) with 61 samples from data. Fig. 11. Empirical and non-constant copula based conditional distributions of variable WD for different combinations of conditioning variables. (For interpretation of the references to colour in this figure legend, the reader is referred to the web version of this article.) Table 4 The log-likelihood, the number of parameters, the AIC score, and the p-value of the KS-test of each of the four models with the training data. Model Log-likelihood # parameters AIC score p-value Normal copula −9475.9 28 19 007.8 0.8886 Normal copula with conditional independence −9482.7 18 19 001.4 0.8808 Constant copula-vine (sequential) −7692.4 16 15 416.8 0.2152 Constant copula-vine (full optimization) −7476.5 16 14 985.0 0.2247 Non-constant copula-vine (sequential) −7644.1 24 15 336.2 0.2372 Non-constant copula-vine (full optimization) −7344.7 24 14 737.4 0.2508 Table 5 The RMSE of the four models when the mean of the conditioned latency time is used as the prediction. Model RMSE Normal copula 29.0023 Normal copula with conditional independence 29.1309 Constant copula-vine (sequential) 29.5089 Constant copula-vine (full optimization) 29.5975 Non-constant copula-vine (sequential) 29.1893 Non-constant copula-vine (full optimization) 29.3628 time is computed. The model represents the data well if these quantiles are distributed uniformly on (0, 1). We use the KS1 Test to test the closeness of the quantiles of each model to uniform.2 The results of both validation tests are summarized in Table 4.3 The second and third columns of Table 4 present the log-likelihood and the number of parameters in each model. The4 AIC score of each model is shown in the fourth column. The quantiles are tested against the uniform distribution in (0, 1)5 with the KS-Test and the p-values are presented in the fifth column.6 The results show that all models perform well in the prediction of the latency time’s conditional distribution. The7 non-constant copula-vine model has the highest log-likelihood value as was to be expected. It also has the lowest AIC score8 which means it is the best model to represent the data.9 The aim of the latency time model is to provide a prediction of the latency time when an incident occurs, given the10 information of the other seven variables. One candidate for the prediction is the expected value of the conditional latency11 time. For each data point, the conditional distribution of latency time given the realization of the other variables is simulated12 using 500 samples.13 To obtain samples of the conditional latency time distributions of all models, samples are generated from the intervals14 of the latent variables corresponding to the discrete observations. For the multivariate Normal copula model, the copula15 is conditioned on these samples and the observed continuous variables. For the copula-vine models, the vine structure16 conditioned on the latent samples and the observed continuous variables is sampled as in Kurowicka and Cooke (2006) to17 obtain the conditional latency time distribution.18 For each model, the expected value of this sampled distribution is compared to the observed latency time in the data to19 obtain the root mean squared error (RMSE) for each model. Table 5 summarizes the result.20 A.A. Zilko, D. Kurowicka / Computational Statistics and Data Analysis xx (xxxx) xxx–xxx 19 Table 6 The log-likelihood, the AIC score, the p-value of the KS-test, and the RMSE of each of the four models with the test data. Model Log-likelihood AIC score p-value RMSE Normal copula −1852.6 3761.2 0.1755 19.8789 Normal copula with conditional independence −1849.5 3735.1 0.1038 19.9068 Constant copula-vine (sequential) −1615.2 3262.4 0.1444 19.9165 Constant copula-vine (full optimization) −1613.8 3259.6 0.1196 20.0192 Non-constant copula-vine (sequential) −1589.4 3226.8 0.1755 19.7433 Non-constant copula-vine (full optimization) −1529.4 3106.8 0.1202 19.6875 The result shows that the performance of all four models is very similar, not surprising considering the result shown 1 in Table 4. However, the standard deviation of the latency time in the data is observed at 30.2128. This means that the 2 coefficient of determination value R2 is approximately only 5% for all models. This illustrates the highly uncertain and 3 complex nature of railway disruption length, in particular the latency time, in the Netherlands. Additional influencing factors 4 could be considered when new, better data is collected. 5 While Tables 4 and 5 present the results of models validation with the training set, we are also interested to observe the 6 model performance against a set of test data. The test data comes from the train detection problem in the Dutch railway 7 network from 1 May 2014 up to 31 October 2014. A total of 339 urgent incidents were recorded within these six months 8 period. Table 6 summarizes the result. 9 The result shows that all models perform well with similar performance. The non-constant copula vine model yields the 10 highest log-likelihood and the lowest AIC score hence it is the best model to represent the data. Similarly as in the training 11 set case, with the latency time’s standard deviation of 20.3546, the coefficient of determination is approximately only 5% 12 for all models. 13 4. Discussions and conclusions 14 Four copula-based models are constructed in this paper to represent the dependence between an eight-dimensional 15 mixed discrete and continuous variable. These models are based on two construction techniques: through the multivariate 16 Normal copula and through the copula-vine approach. When the multivariate Normal copula is used, it is not easy to give 17 conditions which assert the existence or non-existence of the Normal copula for a specified Bernoulli distribution. With 18 the copula-vine approach, it is shown that the multivariate Bernoulli part of the model can be recovered with a set of 19 non-constant (conditional) bivariate Normal copulas. 20 The performance of the four models is similar. In practice, the chosen model is aimed to produce the conditional dis- 21 tribution of latency time given information about the other influencing variables. The conditional distribution is obtained 22 through sampling for all models. Generating 500 samples of this conditional distribution with a computer on an Intel(R) Core 23 i5-3470 3.2 GHz processor and 8 GB RAM, the multivariate Normal copula models require, on average, 3.0128 s while the 24 copula-vine models require 3.6684 s on average. This means that the non-constant copula-vine model is the most attractive 25 one because, while the time needed to obtain the conditional latency time distribution is not very different between the 26 models, the parameters estimation can be done much faster when they are performed sequentially. 27 The latency time model constitutes only one part of the disruption length model. The full disruption length model is 28 going to be constructed by considering two more variables: the cause of failures and the repair time. 29 In this paper, we take the expected value of the conditioned latency time as a prediction for the length of latency time 30 needed when a disruption occurs. However, even though this choice leads to the minimum RMSE, it might not be the most 31 desired in practice. The aim of the disruption length model is to provide a prediction for the train traffic controllers to 32 deal with the disrupted train traffic caused by an incident. When the traffic controllers have information about possible 33 disruption length, they will take certain steps to reschedule the train traffic. The goal is to return to normal train operation 34 as soon as possible. Thus, the choice of prediction other than the expected disruption length could be of larger benefit to 35 achieve the final goal. We plan to investigate this issue in more detail when we combine our model with a parallel project 36 dealing with effective and efficient train dispatching. 37 Acknowledgments 38 This work is funded by ExploRail, a partnership program of the Dutch Technology Foundation STW and ProRail, project 39 no. 12257: ‘‘Smart information and decision support for railway operation control centres (SmartOCCR)’’. The authors would 40 like to acknowledge Dirk Kes, André Duinmeijer, and Erwin van Wonderen from ProRail for the supervision and access to 41 the data set. 42 Appendix A. Proof of Propositions 1.3 and 1.5 43 Proof of Proposition 1.3. The zero three-way interaction means: 44 p(1, 1, 1)p(1, 0, 0)p(0, 1, 0)p(0, 0, 1) = p(0, 0, 0)p(1, 1, 0)p(1, 0, 1)p(0, 1, 1). (A.1) 45 20 A.A. Zilko, D. Kurowicka / Computational Statistics and Data Analysis xx (xxxx) xxx–xxx Fig. B.12. The D-vine structure. Since the margins are equal to 0.5, we obtain: p(0, 1, 0) + p(0, 0, 1) + p(0, 1, 1) + p(0, 0, 0) = p(1, 0, 1) + p(1, 1, 0) + p(1, 0, 0) + p(1, 1, 1) (A.2) p(1, 0, 0) + p(0, 0, 1) + p(1, 0, 1) + p(0, 0, 0) = p(0, 1, 1) + p(1, 1, 0) + p(0, 1, 0) + p(1, 1, 1) (A.3) p(1, 0, 0) + p(0, 1, 0) + p(1, 1, 0) + p(0, 0, 0) = p(0, 1, 1) + p(1, 0, 1) + p(0, 0, 1) + p(1, 1, 1). (A.4) Subtracting (A.3) from (A.2), (A.4) from (A.3), and (A.2) from (A.4) yields p(0, 1, 0) + p(0, 1, 1) = p(1, 0, 1) + p(1, 0, 0) (A.5) p(0, 0, 1) + p(1, 0, 1) = p(1, 1, 0) + p(0, 1, 0) (A.6) p(1, 1, 0) + p(1, 0, 0) = p(0, 0, 1) + p(0, 1, 1). (A.7) Substituting (A.5) to (A.2) yields1 p(0, 0, 0) + p(0, 0, 1) = p(1, 1, 1) + p(1, 1, 0). (A.8)2 It can be shown that Eqs. (A.1), (A.5), (A.6), and (A.7) are satisfied if and only if p(x1, x2, x3) = p(1 − x1, 1 − x2, 1 − x3)3 for all x1, x2, x3 ∈ {0, 1}. We see immediately that the symmetric distribution satisfies the above equations. To see that4 the symmetry is also necessary, let us assume that e.g. p(1, 0, 0) > p(0, 1, 1). Then, from (A.5), p(0, 1, 0) > p(1, 0, 1)5 which leads to p(0, 0, 1) > p(1, 1, 0) from (A.6). Further, this means p(0, 0, 1) > p(1, 1, 0) from (A.7) which leads to6 p(1, 1, 1) > p(0, 0, 0) from (A.8). Combining this information together yields7 p(1, 1, 1)p(1, 0, 0)p(0, 1, 0)p(0, 0, 1) > p(0, 0, 0)p(1, 1, 0)p(1, 0, 1)p(0, 1, 1)8 which cannot be true because of (A.1). Therefore, the proof is complete. □9 Proof of Proposition 1.5. Without loss of generality, let X2 be the conditioning variable. Because P(Xi = 0) = 0.5 = P(Xi =10 1) for all i ∈ {1, 2, 3},11 P(X1 ≤ 0|X2 = 1) = 1 − P(X1 ≤ 0|X2 = 0) (A.9)12 and P(X1 ≤ 0, X3 ≤ 0|X2 = 1) = P(X1 ≤ 0, X3 ≤ 0) 0.5 − P(X1 ≤ 0, X3 ≤ 0|X2 = 0) C13|2=1(P(X1 ≤ 0|X2 = 1), P(X3 ≤ 0|X2 = 1)) = P(X1 ≤ 0, X3 ≤ 0) 0.5 − C13|2=0(P(X1 ≤ 0|X2 = 0), P(X3 ≤ 0|X2 = 0)). (A.10) Using (A.9), the symmetricity of C13|2, and the Total Law of Probability, the left hand side of (A.10) becomes:13 C13|2=1(P(X1 ≤ 0|X2 = 1), P(X3 ≤ 0|X2 = 1)) = P(X1 ≤ 0, X2 = 0, X3 ≤ 0) + P(X1 > 0, X2 = 0, X3 > 0) 0.5 14 − C13|2=1(P(X1 ≤ 0|X2 = 0), P(X3 ≤ 0|X2 = 0)). (A.11)15 ⇒ With the radial symmetry of a trivariate Normal copula, (A.11) becomes: = P(X1 ≤ 0, X2 = 0, X3 ≤ 0) + P(X1 ≤ 0, X2 = 1, X3 ≤ 0) 0.5 − C13|2=1(P(X1 ≤ 0|X2 = 0), P(X3 ≤ 0|X2 = 0)) = P(X1 ≤ 0, X3 ≤ 0) 0.5 − C13|2=1(P(X1 ≤ 0|X2 = 0), P(X3 ≤ 0|X2 = 0)). A.A. Zilko, D. Kurowicka / Computational Statistics and Data Analysis xx (xxxx) xxx–xxx 21 Table B.7 The estimated parameters values of the constant copula-vine data set with the constant copula-vine approach. Parameter True value Estimate Parameter True value Estimate (Conf. bound) (Conf. bound) ρ12 0.3 0.3032 ρ24|3 −0.3 −0.3033 (0.1267, 0.4346) (−0.3361, −0.2740) ρ23 0 0.0542 (0) ρ35|4 0.2 0.2067 (−0.1256, 0.2177) (0.1364, 0.2587) ρ34 0.2 0.1880 ρ14|23 0 0.0001 (0) (0.0700, 0.2975) (−0.0453, 0.0813) ρ45 −0.1 −0.1088 ρ25|34 −0.3 −0.2462 (−0.1904, −0.0336) (−0.3237, −0.1768) ρ13|2 0.11 0.0983 ρ15|234 0.5 0.5174 (0.0405, 0.1497) (0.4626, 0.5740) Table B.8 The estimated parameters values of the constant copula-vine data set with the non-constant copula-vine approach. Parameter True value Estimate Parameter True value Estimate (Conf. bound) (Conf. bound) ρ12 0.3 0.3032 ρ35|4 0.2 0.2067 (0.1267, 0.4346) (0.1419, 0.2802) ρ23 0 0.0542 (0) ρ14|2=0,3=0 0 −0.0543 (0) (−0.1256, 0.2177) (−0.1904, 0.0503) ρ34 0.2 0.1880 ρ14|2=0,3=1 0.1344 (0) (0.0700, 0.2975) (−0.0241, 0.2990) ρ45 −0.1 −0.1088 ρ14|2=1,3=0 0.0083 (0) (−0.1904, −0.0336) (−0.0711, 0.0928) ρ13|2=0 0.11 0.1488 (0.0983) ρ14|2=1,3=1 −0.1035 (0) (0.0425, 0.2665) (−0.2228, 0.0513) ρ13|2=1 0.0693 (0.0983) ρ25|34 −0.3 −0.2462 (−0.0248, 0.1592) (−0.3403, −0.1786) ρ24|3=0 −0.3 −0.3177 (−0.3033) ρ15|234 0.5 0.5174 (−0.3714, −0.2602) (0.4702, 0.5731) ρ24|3=1 −0.2430 (−0.3033) (−0.3122, −0.1871) Substituting this result back to (A.10) yields C13|2=0(P(Y1 ≤ 0|Y2 = 0), P(Y3 ≤ 0|Y2 = 0)) = C13|2=1(P(Y1 ≤ 1 0|Y2 = 0), P(Y3 ≤ 0|Y2 = 0)). 2 ⇐ Because C13|2=0 = C13|2=1, substituting (A.11) back to (A.10) yields 3 P(X1 ≤ 0, X2 = 0, X3 ≤ 0) + P(X1 > 0, X2 = 0, X3 > 0) 0.5 = P(X1 ≤ 0, X3 ≤ 0) 0.5 4 which leads to P(X1 > 0, X2 = 0, X3 > 0) = P(X1 ≤ 0, X2 = 1, X3 ≤ 0). Substituting this result into Eqs. (A.5), (A.6), (A.7), and (A.8) yields 5 p(x1, x2, x3) = p(1 − x1, 1 − x2, 1 − x3) 6 for all xi ∈ {0, 1} for all i ∈ {1, 2, 3}. This means the trivariate Bernoulli distribution has a radial symmetry. 7 Therefore, the trivariate Normal copula is able to realize (X1, X2, X3). □ 8 22 A.A. Zilko, D. Kurowicka / Computational Statistics and Data Analysis xx (xxxx) xxx–xxx Table B.9 The estimated parameters values of the non-constant copula-vine data set with the constant copula-vine approach. Parameter Estimate Parameter Estimate (Conf. bound) (Conf. bound) ρ12 0.3489 ρ24|3 −0.3028 (0.1577, 0.4978) (−0.3421, −0.2673) ρ23 −0.0042 (0) ρ35|4 0.2023 (−0.1489, 0.1807) (0.1413, 0.2607) ρ34 0.1906 ρ14|23 0.0312 (0) (0.0674, 0.3085) (−0.0491, 0.1126) ρ45 −0.1147 ρ25|34 −0.2954 (−0.1921, −0.0389) (−0.3724, −0.2186) ρ13|2 0.1027 ρ15|234 0.5234 (0.0395, 0.1534) (0.4678, 0.5722) Table B.10 The estimated parameters values of the non-constant copula-vine data set with the non-constant copula-vine approach. Parameter True value Estimate Parameter True value Estimate (Conf. bound) (Conf. bound) ρ12 0.3 0.3489 ρ35|4 0.2 0.2023 (0.1577, 0.4978) (0.1413, 0.2607) ρ23 0 −0.0042 (0) ρ14|2=0,3=0 0.1 0.0405 (−0.1489, 0.1807) (0.0254, 0.1540) ρ34 0.2 0.1906 ρ14|2=0,3=1 0 −0.0572 (0) (0.0674, 0.3085) (−0.2293, 0.1153) ρ45 −0.1 −0.1147 ρ14|2=1,3=0 0.4 0.4399 (−0.1921, −0.0389) (0.3722, 0.5204) ρ13|2=0 0.2 0.1917 ρ14|2=1,3=1 0 0.0004 (0) (0.0899, 0.3107) (−0.1484, 0.1174) ρ13|2=1 0 −0.0096 (0) ρ25|34 −0.3 −0.2954 (−0.1180, 0.0742) (−0.3724, −0.2186) ρ24|3=0 −0.3 −0.2751 (−0.3028) ρ15|234 0.5 0.5422 (−0.3342, −0.2183) (0.4879, 0.5982) ρ24|3=1 −0.3 −0.2506 (−0.3028) (−0.3267, −0.1863) Appendix B. Simulation study1 In this section, a small simulation study is performed to test the performance of the (non)-constant copula-vine models.2 Three binary discrete variables X1, X2, and X3 with margins P(X1 = 0) = 0.6, P(X2 = 0) = 0.4, and P(X3 = 0) = 0.7,3 respectively, and two uniform continuous variables X4 and X5 are involved. The five variables are joint together with a4 D-vine with structure depicted in Fig. B.12.5 Two sets of parameters values are chosen (indicated in the column True Value in the corresponding tables below) and6 are used to sample the vine structure to generate two data sets each containing 2000 samples. Then, the parameters are7 estimated with constant and non-constant copula vines as in the main body of this paper for each data set. The following8 are the results.9 1. Constant copula-vine data set.10 The first simulated data set contains data generated with the constant copula-vine approach. Tables B.7 and B.8 showcase11 the results when the constant and non-constant copula-vine approaches are used to model the data’s dependence.12 The true parameter values are recovered with the constant copula-vine approach. Moreover, the discrete part of the13 model is recovered well with the KL divergence test yields p-value of 0.2048. The continuous part is also well-recovered14 with p-value of 0.9104.15 The true parameter value is recovered with the non-constant conditional copula vine approach where the procedure16 notices that the three conditional distributions with discrete only conditioning variables can be modeled with constant17 A.A. Zilko, D. Kurowicka / Computational Statistics and Data Analysis xx (xxxx) xxx–xxx 23 Table C.1 The parameters of the non-constant conditional copula-vine model with the first vine structure. The bolded brackets indicate if the parameter value is taken to be zero or constant. Parameter Value Parameter Value (Conf. bound) (Conf. bound) ρCT ,WM 0.0158 (0) ρCT ,OV |WM=0,WT =1,RH=1 −0.5118 (−0.2957, 0.3138) (−0.8400, −0.1854) ρWM,WT 0.0540 (0) ρCT ,OV |WM=1,WT =0,RH=1 0.5648 (0) (−0.2446, 0.3794) (−0.1247, 0.9496) ρWT ,RH 0.5769 ρCT ,OV |WM=1,WT =1,RH=0 0.7001 (0.3932, 0.7187) (0.2727, 0.9900) ρRH,OV 0.1288 (0) ρCT ,OV |WM=1,WT =1,RH=1 −0.0105 (0) (−0.2880, 0.3702) (−0.8197, 0.7740) ρOV ,WD 0.2035 ρWM,WD|WT =0,RH=0,OV =0 0.0424 (0) (0.0143, 0.3571) (−0.1039, 0.1650) ρWD,LC −0.0080 (0) ρWM,WD|WT =0,RH=0,OV =1 0.3599 (0) (−0.0604, 0.0572) (−0.3366, 0.8918) ρLC,LAT 0.0876 ρWM,WD|WT =0,RH=1,OV =0 0.2210 (0) (0.0179, 0.1554) (−0.0286, 0.4438) ρCT ,WT |WM=0 −0.1299 (−0.1213) ρWM,WD|WT =1,RH=0,OV =0 −0.0972 (0) (−0.1910, −0.0649) (−0.3071, 0.1023) ρCT ,WT |WM=1 −0.1137 (−0.1213) ρWM,WD|WT =0,RH=1,OV =1 0.2894 (0) (−0.3764, 0.1722) (−0.6480, 0.9041) ρWM,RH|WT =0 0.3705 ρWM,WD|WT =1,RH=0,OV =1 0.8917 (0) (0.2488, 0.4954) (−0.0575, 0.9900) ρWM,RH|WT =1 −0.2464 ρWM,WD|WT =1,RH=1,OV =0 0.2312 (0) (−0.4333, −0.0605) (−0.0554, 0.5121) ρWT ,OV |RH=0 0.2558 ρWM,WD|WT =1,RH=1,OV =1 −0.0916 (0) (0.0739, 0.3680) (−0.7500, 0.4982) ρWT ,OV |RH=1 −0.2800 ρWT ,LC|RH,OV ,WD 0.0514 (0) (−0.5151, −0.0807) (−0.0331, 0.1290) ρRH,WD|OV =0 −0.0738 (−0.1002) ρRH,LAT |OV ,WD,LC −0.0261 (0) (−0.1300, −0.0209) (−0.1047, 0.0441) ρRH,WD|OV =1 −0.1213 (−0.1002) ρCT ,WD|WM=0,WT =0,RH=0,OV =0 0.2444 (−0.1567, −0.0656) (0.1635, 0.3111) ρOV ,LC|WD 0.0045 (0) ρCT ,WD|WM=0,WT =0,RH=0,OV =1 0.1546 (0) (−0.0680, 0.0756) (−0.2278, 0.5959) ρWD,LAT |LC 0.1154 ρCT ,WD|WM=0,WT =0,RH=1,OV =0 0.2118 (−0.0440, 0.1837) (0.0462, 0.4135) ρCT ,RH|WM=0,WT =0 −0.1860 ρCT ,WD|WM=0,WT =1,RH=0,OV =0 0.0965 (0) (−0.2762, −0.0559) (−0.0491, 0.2421) ρCT ,RH|WM=0,WT =1 0.0850 (0) ρCT ,WD|WM=1,WT =0,RH=0,OV =0 0.1094 (0) (−0.0304, 0.2271) (−0.3646, 0.5012) ρCT ,RH|WM=1,WT =0 0.4710 ρCT ,WD|WM=0,WT =0,RH=1,OV =1 0.0021 (0) (0.1671, 0.7451) (−0.7106, 0.3661) ρCT ,RH|WM=1,WT =1 −0.3282 (0) ρCT ,WD|WM=0,WT =1,RH=0,OV =1 0.2528 (0) (−0.6950, 0.2561) (−0.5006, 0.7496) ρWM,OV |WT =0,RH=0 0.1057 (0) ρCT ,WD|WM=1,WT =0,RH=0,OV =1 0.0012 (0) (continued on next page) 24 A.A. Zilko, D. Kurowicka / Computational Statistics and Data Analysis xx (xxxx) xxx–xxx Table C.1 (continued) Parameter Value Parameter Value (Conf. bound) (Conf. bound) (−0.0002, 0.3236) (−0.0720, 0.0995) ρWM,OV |WT =0,RH=1 0.7767 ρCT ,WD|WM=0,WT =1,RH=1,OV =0 0.0747 (0) (0.4771, 0.9207) (−0.0569, 0.2192) ρWM,OV |WT =1,RH=0 0.7417 ρCT ,WD|WM=1,WT =0,RH=1,OV =0 0.2608 (0) (0.6117, 0.8770) (−0.3939, 0.8685) ρWM,OV |WT =1,RH=1 0.5844 (0) ρCT ,WD|WM=1,WT =1,RH=0,OV =0 −0.1013 (0) (−0.0023, 0.8859) (−0.6242, 0.4463) ρWT ,WD|RH=0,OV =0 −0.1116 (−0.0683) ρCT ,WD|WM=0,WT =1,RH=1,OV =1 −0.5228 (0) (−0.1896, −0.0442) (−0.9708, 0.3070) ρWT ,WD|RH=0,OV =1 −0.1125 (−0.0683) ρCT ,WD|WM=1,WT =0,RH=1,OV =1 0.7518 (0) (−0.4796, 0.2657) (−0.7714, 0.8989) ρWT ,WD|RH=1,OV =0 −0.0174 (−0.0683) ρCT ,WD|WM=1,WT =1,RH=0,OV =1 0.8765 (0) (−0.1251, 0.0887) (−0.9451, 0.9871) ρWT ,WD|RH=1,OV =1 0.2840 (−0.0683) ρCT ,WD|WM=1,WT =1,RH=1,OV =0 −0.9891 (0) (−0.1238, 0.6281) (−0.9991, 0.9921) ρRH,LC|OV ,WD 0.0206 (0) ρCT ,WD|WM=1,WT =1,RH=1,OV =1 0.0039 (0) (−0.0719, 0.0727) (−0.9990, 0.9819) ρOV ,LAT |WD,LC 0.1141 ρWM,LC|WT ,RH,OV ,WD 0.0118 (0) (0.0582, 0.2014) (−0.0643, 0.0926) ρCT ,OV |WM=0,WT =0,RH=0 0.1087 (0) ρWT ,LAT |RH,OV ,WD,LC −0.1522 (−0.0691, 0.3166) (−0.2280, −0.0878) ρCT ,OV |WM=0,WT =0,RH=1 −0.2696 (0) ρCT ,LC|WM,WT ,RH,OV ,WD −0.2829 (−0.6787, 0.1655) (−0.3484, −0.2172) ρCT ,OV |WM=0,WT =1,RH=0 0.6394 ρWM,LAT |WT ,RH,OV ,WD,LC 0.0413 (0) (0.4190, 0.7696) (−0.0255, 0.1145) ρCT ,OV |WM=1,WT =0,RH=0 −0.6379 (0) ρCT ,LAT |WM,WT ,RH,OV ,WD,LC −0.1227 (−0.9036, 0.0017) (−0.1967, −0.0373) Table D.2 The log-likelihood, the number of parameters, the AIC score, and the p-value of the KS-test of the two vine structures. The result of the first structure is presented in brackets. Model Log-likelihood # parameters AIC score p-value Constant, sequential −7617.2 (−7692.4) 20 (16) 15 274.4 (15 416.8) 0.2384 (0.2152) Constant, full optimization −7489.9 (−7476.5) 20 (16) 15 019.8 (14 985.0) 0.2501 (0.2247) Non-constant, sequential −7593.1 (−7644.1) 28 (24) 15 242.2 (15 336.2) 0.2417 (0.2372) Non-constant, full optimization −7309.7 (−7344.7) 28 (24) 14 675.4 (14 737.4) 0.2717 (0.2508) conditional copula. Also, the discrete part of the model is recovered well with this approach with p-value of 0.2048. As1 in the constant case, the continuous part is also well-recovered with the same p-value.2 2. Non-constant copula-vine data set.3 The second simulated data set contains data generated with the non-constant copula-vine approach. Tables B.9 and4 B.10 showcase the results when the constant and non-constant copula-vine approaches are used to model the data’s5 dependence.6 With the constant copula-vine approach, the discrete part of the model is not recovered because the data is generated7 with non-constant copula-vines. The KL divergence test yields p-value of 0.0156. The parameter ρ13|2 is taken to be8 constant while the data is generated with non-constant conditional copula of ρ13|2=0 = 0.2 and ρ13|2=1 = 0. However,9 the continuous part is recovered well with the p-value of 0.8673.10 The true parameter value is recovered with the non-constant conditional copula vine approach. Moreover, the discrete11 part of the model is recovered well with this approach with p-value of 0.9497. The continuous part is recovered well with12 p-value as in the constant case for this data set.13 A.A. Zilko, D. Kurowicka / Computational Statistics and Data Analysis xx (xxxx) xxx–xxx 25 Table D.3 The parameters of the non-constant conditional copula-vine model with the second vine structure. The bolded brackets indicate if the parameter value is taken to be zero or constant. Parameter Value Parameter Value (Conf. bound) (Conf. bound) ρWD,CT 0.1917 ρWD,OV |CT =0,WM=1,WT =0,RH=0 0.0021 (0) (0.1056, 0.2773) (−0.0535, 0.6521) ρCT ,WM 0.0158 (0) ρWD,OV |CT =0,WM=1,WT =0,RH=1 0.0347 (0) (−0.3057, 0.2988) (−0.9900, 0.9286) ρWM,WT 0.0540 (0) ρWD,OV |CT =0,WM=1,WT =1,RH=0 0.7979 (0) (−0.2347, 0.3612) (−0.5865, 0.8125) ρWT ,RH 0.5769 ρWD,OV |CT =0,WM=1,WT =1,RH=1 −0.6522 (0) (0.4001, 0.7189) (−0.8752, 0.2321) ρRH,OV 0.1288 (0) ρWD,OV |CT =1,WM=0,WT =0,RH=0 0.1171 (0) (−0.2879, 0.3812) (−0.0601, 0.3007) ρOV ,LC 0.0048 (0) ρWD,OV |CT =1,WM=0,WT =0,RH=1 −0.0474 (0) (−0.1550, 0.1846) (−0.8984, 0.6787) ρLC,LAT 0.0876 ρWD,OV |CT =1,WM=0,WT =1,RH=0 0.2015 (0) (0.0255, 0.1643) (−0.1376, 0.5172) ρWD,WM|CT =0 0.1164 (0.0799) ρWD,OV |CT =1,WM=0,WT =1,RH=1 0.2260 (0) (0.0110, 0.2311) (−0.2172, 0.7088) ρWD,WM|CT =1 0.0525 (0.0799) ρWD,OV |CT =1,WM=1,WT =0,RH=0 0.4038 (0) (−0.0592, 0.2003) (−0.2102, 0.8559) ρCT ,WT |WM=0 −0.1299 (−0.1002) ρWD,OV |CT =1,WM=1,WT =0,RH=1 0.3689 (0) (−0.1879, −0.0449) (−0.8062, 0.9023) ρCT ,WT |WM=1 −0.1137 (−0.1002) ρWD,OV |CT =1,WM=1,WT =1,RH=0 0.6910 (0) (−0.3664, 0.1822) (−0.4852, 0.7102) ρWM,RH|WT =0 0.3705 ρWD,OV |CT =1,WM=1,WT =1,RH=1 0.0450 (0) (0.2578, 0.4877) (−0.7890, 0.89991) ρWM,RH|WT =1 −0.2464 ρCT ,LC|WM=0,WT =0,RH=0,OV =0 −0.3077 (−0.4201, −0.0591) (−0.3869, −0.2382) ρWT ,OV |RH=0 0.2558 ρCT ,LC|WM=0,WT =0,RH=0,OV =1 −0.2434 (0) (0.0799, 0.3770) (−0.5945, 0.2589) ρWT ,OV |RH=1 −0.2800 ρCT ,LC|WM=0,WT =0,RH=1,OV =0 −0.1166 (0) (−0.5201, −0.0937) (−0.3313, 0.1014) ρRH,LC|OV =0 0.0221 (0) ρCT ,LC|WM=0,WT =0,RH=1,OV =1 0.1810 (0) (−0.0536, 0.0676) (−0.9859, 0.9105) ρRH,LC|OV =1 0.0475 (0) ρCT ,LC|WM=0,WT =1,RH=0,OV =0 −0.4050 (−0.0356, 0.1213) (−0.5365, −0.2839) ρOV ,LAT |LC 0.1345 (0) ρCT ,LC|WM=0,WT =1,RH=0,OV =1 0.2889 (0) (−0.0505, 0.1792) (−0.7398, 0.9262) ρWD,WT |CT =0,WM=0 0.0039 (−0.0705) ρCT ,LC|WM=0,WT =1,RH=1,OV =0 −0.1858 (0) (−0.0718, 0.0921) (−0.3254, 0.0279) ρWD,WT |CT =0,WM=1 −0.0131 (−0.0705) ρCT ,LC|WM=0,WT =1,RH=1,OV =1 0.1443 (0) (−0.4530, 0.4603) (−0.6481, 0.7972) ρWD,WT |CT =1,WM=0 −0.1262 (−0.0705) ρCT ,LC|WM=1,WT =0,RH=0,OV =0 −0.3548 (−0.2042, −0.0441) (−0.7212, −0.0048) ρWD,WT |CT =1,WM=1 −0.2133 (−0.0705) ρCT ,LC|WM=1,WT =0,RH=0,OV =1 −0.0132 (0) (continued on next page) 26 A.A. Zilko, D. Kurowicka / Computational Statistics and Data Analysis xx (xxxx) xxx–xxx Table D.3 (continued) Parameter Value Parameter Value (Conf. bound) (Conf. bound) (−0.4898, −0.0596) (−0.3285, 0.4215) ρCT ,RH|WM=0,WT =0 −0.1860 ρCT ,LC|WM=1,WT =0,RH=1,OV =0 −0.3088 (0) (−0.2962, −0.0669) (−0.8474, 0.2670) ρCT ,RH|WM=0,WT =1 0.0850 (0) ρCT ,LC|WM=1,WT =0,RH=1,OV =1 −0.8929 (0) (−0.0294, 0.2311) (−0.9892, 0.2102) ρCT ,RH|WM=1,WT =0 0.4710 ρCT ,LC|WM=1,WT =1,RH=0,OV =0 −0.4044 (0) (0.1661, 0.7513) (−0.7651, 0.3944) ρCT ,RH|WM=1,WT =1 −0.3282 (0) ρCT ,LC|WM=1,WT =0,RH=1,OV =1 −0.8541 (0) (−0.6871, 0.2444) (−0.9120, 0.1714) ρWM,OV |WT =0,RH=0 0.1057 (0) ρCT ,LC|WM=1,WT =1,RH=1,OV =0 0.8752 (0) (−0.0044, 0.3536) (−0.2158, 0.8952) ρWM,OV |WT =0,RH=1 0.7767 ρCT ,LC|WM=1,WT =1,RH=1,OV =1 0.1058 (0) (0.4769, 0.9217) (−0.9912, 0.9137) ρWM,OV |WT =1,RH=0 0.7417 ρWM,LAT |WM,WT ,RH,OV ,LC 0.0482 (0) (0.6154, 0.8840) (−0.0282, 0.1168) ρWM,OV |WT =1,RH=1 0.5844 (0) ρWD,LC|CT =0,WM=0,WT =0,RH=0,OV =0 0.1327 (−0.0413, 0.8359) (0.0325, 0.2354) ρWT ,LC|RH=0,OV =0 0.0989 (0.0518) ρWD,LC|CT =0,WM=0,WT =0,RH=0,OV =1 −0.1660 (0) (0.0249, 0.1775) (−0.6103, 0.3359) ρWT ,LC|RH=0,OV =1 −0.0254 (0.0518) ρWD,LC|CT =0,WM=0,WT =0,RH=1,OV =0 −0.1555 (0) (−0.3784, 0.3627) (−0.3646, 0.0429) ρWT ,LC|RH=1,OV =0 −0.0499 (0.0518) ρWD,LC|CT =0,WM=0,WT =0,RH=1,OV =1 0.0270 (0) (−0.1707, 0.0583) (−0.5905, 0.6237) ρWT ,LC|RH=1,OV =1 1248 (0.0518) ρWD,LC|CT =0,WM=0,WT =1,RH=0,OV =0 0.0412 (0) (−0.3387, 0.6159) (−0.1530, 0.2015) ρRH,LAT |OV ,LC −0.0378 (0) ρWD,LC|CT =0,WM=0,WT =1,RH=0,OV =1 −0.1182 (0) (−0.1009, 0.0294) (−0.6320, 0.5787) ρWD,RH|CT =0,WM=0,WT =0 0.0 − 0.0885 (0) ρWD,LC|CT =0,WM=0,WT =1,RH=1,OV =0 0.0088 (0) (−0.2119, 0.0557) (−0.1520, 0.1420) ρWD,RH|CT =0,WM=0,WT =1 0.0331 (0) ρWD,LC|CT =0,WM=0,WT =1,RH=1,OV =1 −0.5884 (0) (−0.0953, 0.1447) (−0.7108, 0.5534) ρWD,RH|CT =0,WM=1,WT =0 −0.0110 (0) ρWD,LC|CT =0,WM=1,WT =0,RH=0,OV =0 0.3723 (0) (−0.6160, 0.5105) (−0.0190, 0.6955) ρWD,RH|CT =0,WM=1,WT =1 0.6528 ρWD,LC|CT =0,WM=1,WT =0,RH=0,OV =1 0.0025 (0) (0.1277, 0.9858) (−0.6094, 0.5787) ρWD,RH|CT =1,WM=0,WT =0 −0.0964 (0) ρWD,LC|CT =0,WM=1,WT =0,RH=1,OV =0 0.4145 (0) (−0.2475, 0.0042) (−0.5369, 0.6384) ρWD,RH|CT =1,WM=0,WT =1 −0.0357 (0) ρWD,LC|CT =0,WM=1,WT =0,RH=1,OV =1 0.4555 (0) (−0.2025, 0.1097) (−0.65 335, 0.5923) ρWD,RH|CT =1,WM=1,WT =0 0.0501 (0) ρWD,LC|CT =0,WM=1,WT =1,RH=0,OV =0 −0.0666 (0) (−0.4512, 0.4445) (−0.6293, 0.5766) ρWD,RH|CT =1,WM=1,WT =1 0.2930 (0) ρWD,LC|CT =0,WM=1,WT =1,RH=0,OV =1 −0.0032 (0) (−0.2297, 0.7713) (−0.9355, 0.6207) ρCT ,OV |WM=0,WT =0,RH=0 0.1087 (0) ρWD,LC|CT =0,WM=1,WT =1,RH=1,OV =0 0.0003 (0) (continued on next page) A.A. Zilko, D. Kurowicka / Computational Statistics and Data Analysis xx (xxxx) xxx–xxx 27 Table D.3 (continued) Parameter Value Parameter Value (Conf. bound) (Conf. bound) (−0.0721, 0.3212) (−0.6187, 0.6770) ρCT ,OV |WM=0,WT =0,RH=1 −0.2696 (0) ρWD,LC|CT =0,WM=1,WT =1,RH=1,OV =1 0.5232 (0) (−0.6687, 0.1721) (−0.6394, 0.6745) ρCT ,OV |WM=0,WT =1,RH=0 0.6394 ρWD,LC|CT =1,WM=0,WT =0,RH=0,OV =0 −0.0422 (0) (0.4190, 0.7696) (−0.1206, 0.0312) ρCT ,OV |WM=0,WT =1,RH=1 −0.5118 ρWD,LC|CT =1,WM=0,WT =0,RH=0,OV =1 −0.0009 (0) (−0.8215, −0.1795) (−0.3849, 0.4802) ρCT ,OV |WM=1,WT =0,RH=0 −0.6379 (0) ρWD,LC|CT =1,WM=0,WT =0,RH=1,OV =0 0.2766 (−0.8902, 0.0120) (0.0699, 0.5152) ρCT ,OV |WM=1,WT =0,RH=1 0.5648 (0) ρWD,LC|CT =1,WM=0,WT =0,RH=1,OV =1 0.4752 (0) (−0.1297, 0.9321) (−0.7275, 0.5070) ρCT ,OV |WM=1,WT =1,RH=0 0.7001 ρWD,LC|CT =1,WM=0,WT =1,RH=0,OV =0 −0.0838 (0) (0.2802, 0.9902) (−0.2379, 0.0686) ρCT ,OV |WM=1,WT =1,RH=1 −0.0105 (0) ρWD,LC|CT =1,WM=0,WT =1,RH=0,OV =1 −0.0317 (0) (−0.8297, 0.7251) (−0.6738, 0.5990) ρWM,LC|WT =0,RH=0,OV =0 0.1031 (0) ρWD,LC|CT =1,WM=0,WT =1,RH=1,OV =0 0.0539 (0) (−0.0104, 0.2448) (−0.0930, 0.2170) ρWM,LC|WT =0,RH=0,OV =1 0.4134 (0) ρWD,LC|CT =1,WM=0,WT =1,RH=1,OV =1 0.3084 (0) (−0.0495, 0.8440) (−0.5442, 0.6368) ρWM,LC|WT =0,RH=1,OV =0 −0.2080 (0) ρWD,LC|CT =1,WM=1,WT =0,RH=0,OV =0 0.2437 (0) (−0.4908, 0.0423) (−0.1330, 0.6317) ρWM,LC|WT =0,RH=1,OV =1 −0.3524 (0) ρWD,LC|CT =1,WM=1,WT =0,RH=0,OV =1 −0.3865 (0) (−0.9641, 0.5087) (−0.6357, 0.5463) ρWM,LC|WT =1,RH=0,OV =0 −0.1405 (0) ρWD,LC|CT =1,WM=1,WT =0,RH=1,OV =0 0.1461 (0) (−0.4141, 0.0432) (−0.5465, 0.6277) ρWM,LC|WT =1,RH=0,OV =1 0.2428 (0) ρWD,LC|CT =1,WM=1,WT =0,RH=1,OV =1 −0.4752 (0) (−0.2875, 0.3106) (−0.5262, 0.6218) ρWM,LC|WT =1,RH=1,OV =0 −0.0932 (0) ρWD,LC|CT =1,WM=1,WT =1,RH=0,OV =0 0.2478 (0) (−0.3622, 0.2421) (−0.2941, 0.7060) ρWM,LC|WT =1,RH=1,OV =1 −0.0365 (0) ρWD,LC|CT =1,WM=1,WT =1,RH=0,OV =1 0.0001 (0) (−0.7570, 0.5941) (−0.5741, 0.7188) ρWT ,LAT |WH,OV ,LC −0.1573 ρWD,LC|CT =1,WM=1,WT =1,RH=1,OV =0 0.5495 (0) (−0.2402, −0.0745) (−0.5960, 0.5883) ρWD,OV |CT =0,WM=0,WT =0,RH=0 0.3105 ρWD,LC|CT =1,WM=1,WT =1,RH=1,OV =1 0.5520 (0) (0.0854, 0.5598) (−0.5217, 0.5804) ρWD,OV |CT =0,WM=0,WT =0,RH=1 0.0768 (0) ρCT ,LAT |WM,WT ,RH,OV ,LC −0.1110 (−0.3225, 0.5967) (−0.1976, −0.0368) ρWD,OV |CT =0,WM=0,WT =1,RH=0 0.1082 (0) ρWD,LAT |CT ,WM,WT ,RH,OV ,LC 0.0997 (−0.4586, 0.5742) (0.0115, 0.1690) ρWD,OV |CT =0,WM=0,WT =1,RH=1 0.4862 (0.1721, 0.8688) We observe that the parameters estimation procedure of the (non)-constant copula-vine models works for the two 1 artificially generated data sets as the true parameters values are captured in the corresponding confidence intervals. The 2 constant copula-vine model does not recover the discrete part of the data well in the non-constant data set. 3 28 A.A. Zilko, D. Kurowicka / Computational Statistics and Data Analysis xx (xxxx) xxx–xxx Appendix C. Table of parameters1 Q6 See Table C.1.2 Appendix D. A second vine structure3 In the main body of this paper, the ordering of CT , WM, WT , RH, OV , WD, LC, LAT is chosen in a D-vine. This is one of the4 many ordering possibilities which cluster the discrete and continuous variables together. Another ordering with a D-vine5 can be chosen such that more parameters are involved in the model. The ordering of WD, CT , WM, WT , RH, OV , LC, LAT6 increases the parameters number to 28 as more mixed discrete–continuous pairings are introduced in the left part of the7 structure. Table D.3 presents the parameters values of the second structure with the non-constant conditional copula-vine8 model.9 As with the first structure, constant and non-constant conditional copula-vine model each with sequential and full10 optimization approach can be constructed. The log-likelihoods, numbers of parameters, AIC scores, and p-values of the11 latency time predictions of the four models are presented in Table D.2. Moreover, the corresponding results from the first12 structure as in Table 4 are presented as well in brackets as comparisons. We observe that the log-likelihoods are slightly13 improved with the second structure. Moreover, both structures predict the latency time distribution well.14 References15 Breymann, W., Dias, A., Embrechts, P., 2003. Dependence structures for multivariate high-frequency data in finance. Quant. Finance 3, 1–14.16 Carley, H., 2002. Maximum and minimum extensions of finite subcopulas. Comm. Statist. Theory Methods 31, 2151–2166.17 Cooke, R.M., Kurowicka, D., Wilson, K., 2015. Sampling, conditionalizing, counting, merging, searching regular vines. J. Multivariate Anal. 138, 4–18.18 De Leon, A.R., Wu, B., 2010. Copula-based regression models for a bivariate mixed discrete and continuous outcome. Stat. Med. 30, 175–185.19 Denuit, M., Lambert, P., 2005. Constraints on concordance measures in bivariate discrete data. J. Multivariate Anal. 93 (1), 40–57.20 Genest, C., Nešlehová, J., 2007. A primer on copulas for count data. Astin Bull. 37 (2), 475–514.21 He, J., Li, H., Edmonson, A.C., Rader, D.J., Li, M., 2012. A Gaussian copula approach for the analysis of secondary phenotypes in case-control genetic association studies. Biostatistics 13, 497–508. 22 Kurowicka, D., Cooke, R., 2006. Uncertainty Analysis with High Dimensional Dependence Modelling. In: Wiley Series in Probability and Statistics, Wiley.23 Kurowicka, D., Joe, H., 2011. Dependence Modeling. Vine Copula Handbook. World Scientific.24 Margaritis, D., 2003. Learning Bayesian network model structure from data (Ph.D. thesis), Carnegie-Mellon University, Pittsburgh, PA.25 Mesfioui, M., Tajar, A., 2005. On the properties of some nonparametric concordance measures in the discrete case. J. Nonparametr. Stat. 17 (5), 541–554.26 Morales Napoles, O., 2009. Bayesian belief nets and vines in aviation safety and other applications (Ph.D. thesis), Delft University of Technology.27 Nelsen, R.B., 2006. An Introduction to Copula. Springer.28 Nešlehová, J., 2007. On rank correlation measures for non-continuous random variables. J. Multivariate Anal. 98 (3), 554–567.29 Nikoloulopoulos, A.K., 2013. On the estimation of normal copula discrete regression models using the continuous extension and simulated likelihood. J. Statist. Plann. Inference 143, 1923–1937. 30 Nikoloulopoulos, A.K., 2015. Efficient estimation of high-dimensional multivariate normal copula models with discrete spatial responsesd. Stoch. Environ. Res. Risk Assess. 1–13. 31 Nikoloulopoulos, A.K., Karlis, D., 2008. Multivariate logit copula model with an application to dental data. Stat. Med. 27, 6393–6406.32 Panagiotelis, A., Czado, C., Joe, H., 2012. Pair copula constructions for multivariate discrete data. Am. Stat. Assoc. 107 (499), 1063–1072.33 Sklar, A., 1959. Fonctions de répartition à n dimensions et leurs marges. Publ. Inst. Statist. Univ. Paris 8, 229–231.34 Smith, M.S., Khaled, M.A., 2012. Estimation of copula models with discrete margins via Bayesian data augmentation. Am. Stat. Assoc. 107 (497), 290–303.35 Song, P.X.K., Li, M., Yuan, Y., 2009. Joint regression analysis of correlated data using Gaussian copula. Biometrics 65, 60–68.36 Stöber, J., Hong, H.G., Czado, C., Ghosh, P., 2015. Comorbidity of chronic diseases in the elderly: Patterns identified by a copula design for mixed responses. Comput. Statist. Data Anal. 88, 28–39. 37 Whittaker, J., 1990. Graphical Models in Applied Multivariate Statistics. John Wiley & Sons.38 Zilko, A.A., Kurowicka, D., Hanea, A.M., Goverde, R.M., 2015. The copula Bayesian network with mixed discrete and continuous nodes to forecast railway39 disruption lengths. In: Proc. 6th International Conference on Railway Operations Modelling and Analysis, RailTokyo2015, Tokyo, Japan, March 2015.40","libVersion":"0.3.2","langs":""}