{"path":"lit/lit_notes_OLD_PARTIAL/Cros14cmvSatSolPow.pdf","text":"EXTRACTING CLOUD MOTION VECTORS FROM SATELLITE IMAGES FOR SOLAR POWER FORECASTING Cros S., Liandrat O., Sébastien N., Schmutz N. Reuniwatt SAS, Reunion Island, France. E-mail: sylvain.cros@reuniwatt.com ABSTRACT The high temporal variability of solar power is a real issue to achieve a balanced production and consumption. Solar power forecasting is then necessary to better exploit this variability and to increase the penetration of photovoltaic power into the energy mix. Solar energy forecasting involves prediction of cloud property above a given point. For several hour ahead forecasts, using images from meteorological geostationary satellite is the most suitable solution. We propose a forecasting method based on a phase correlation algorithm for motion estimation between subsequent cloud maps derived from Meteosat-9 images. The method is assessed against state-of-the-art over a limited area over South of France for a 4-hour period. Cloud index maps are predicted. Our forecasting are 21 % better than persistence in relative RMSE of cloud index. If state-of-the-art shows better results (23 %), our algorithm reduces computing of 25 % and then minimize operational solar forecasting constraints. Index Terms— solar irradiance, forecasting, Meteosat, motion vectors, cloud, phase correlation, photovoltaic 1. INTRODUCTION Photovoltaic (PV) power production relies on solar irradiance reaching solar panels: it makes it highly dependable on the weather and its intensity significantly varies with cloud cover optical thickness. This intermittency presents an impediment to the massive injection of photovoltaic on electricity grids. Indeed, the integration of intermittent renewable energy sources is voluntarily limited so as to maintain network stability: to deliver a guaranteed electricity, power production must equal power consumption at all times. This essential precaution unfortunately means that part of a clean and renewable energy is lost to fossil energy. The most appropriate solution to turn PV from an intermittent energy into a guaranteed one is solar power forecasting. Giving predictions to PV plant managers and electricity grid operators, helps them better plan their solar storage and their use of other energies. The integration of PV in the grid is therefore eased and optimized [1]. Solar irradiance forecasting ends up to predict the presence and optical thickness of clouds at any time scales, from minutes up to several days ahead. At intra-day horizon, the stochasticity of cloud cover behavior cannot be accurately predicted with traditional numerical weather prediction (NWP) models. Cloud cover must be directly observed. All-sky camera permit to observe, from the ground, the celestial vault with a hemispheric angle. Cloud velocity can then be derived from time-series of images acquired with such instruments, leading to an intra-hour irradiance forecast horizon above a punctual site [2]. Forecast at intraday horizon requires cloud cover observation at meso-scale with a high temporal resolution. Therefore, observation through a geostationary meteorological satellite is the most suitable solution, providing irradiance predictions with a better accuracy than NWP in a time horizon smaller than 6 hours [3]. In this approach, cloud patterns are detected through the use of images from visible channels of such satellites. The cloud index (assumed to be proportional to cloud optical depth) can be calculated accurately from the reflectance measured by the sensor. Cloud index extraction is a mature approach that has been used extensively in solar resource mapping [4], [5],[6],[7]. Then, cloud motion vectors can be determined from two subsequent cloud index maps, assuming cloud features do not change between two images. Vectors field is used to extrapolate future cloud pattern from current cloud index map. Solar irradiance forecast are then derived by combining predicted cloud index map with modelled clear sky irradiance. Such approaches have been implemented on Meteosat data by [8] by extracting, from a long image time-series the most probable motion vectors field between cloud pattern of two consecutive images. Such method outperformed the persistence forecast algorithm up to 2-hour ahead. [9] proposed a block-matching method by selecting a rectangular area on the image at time t and scanned the surrounding area in the next image (t+15 min.) with a rectangle of same size. Similar cloud patterns are supposed to be found in the next image if mean square pixel differences between the rectangle of image at t and the one at t+15 min is minimized. Then, a vector is established between the two positions. [10] showed that combining NWP model outputs with this method improves the quality of the forecast after 4 hours ahead. [11] confirmed such statement using the method on NOAA-GOES satellites. However, this block-matching method is certainly the only one used for operational solar irradiance forecast from meteorological geostationary satellite images. Motion vector extraction is a well-known activity in the field of image processing such as video compression, but only one process 4123978-1-4799-5775-0/14/$31.00 ©2014 IEEE IGARSS 2014 has been retained for solar energy forecasting using satellite images. We propose to implement a motion vector extraction technique used for video compression based on the phase correlation. It exploits the property that translation in the spatial domain has its counterpart in the frequency domain. This paper present briefly this method (section 2). Then, its implementation is described using a Meteosat-9 time-series images over South of France (section 3). Results are compared to persistence algorithm and state-of-the-art method [9] and discussed in section 4. Section 5 presents the ongoing work for operational solar irradiance forecast. 2. PHASE CORRELATION ALGORITHM The original Phase Correlation image alignment method [12] was designed for measuring the relative displacement between images. Consider two (infinite) images f1 and f2, and let f2 be a replica of gt, shifted over d = (dx , dy ), such that f2(X) = f1(X - d). Then, according to the Fourier shift theorem, their Fourier transforms are related by: G2 (f) = G1(f).e -j2Лfd (1) Calculating the cross-power spectrum and extracting its phase gives: ejФ(f) = e-j2Лfd (2) from which it follows that the phase correlation function, p(x), is a delta-function located at the point of registration: p(x) = δ (x – d) (3) In the practical case of finite images, even when the overlap between the images is small, the delta-function is replaced by a correlation surface, which is characterized by a narrow peak at the point of registration and lower amplitude peaks at other locations. The resulting correlation measure is relatively scene-independent and not confused by brightness changes in the scene, or noise. Large shifts can be measured with a high accuracy. The Phase Correlation method as described above can only be used for measuring global motion, but a two stage method has been proposed to be able to measure the movements of multiple objects in a scene. First, on fairly large blocks, a limited number of candidate vectors are calculated using a phase correlation step; then, for smaller blocks, one of these candidate vectors is selected using a block matching criterion. In the first stage, the input picture is divided into fairly large blocks, typically 64 pixels square. The dimensions of these blocks must be at least twice the size of the largest movement that can be measured, to make sure there is enough overlap between the image material in corresponding blocks. The phase correlation function (3) is calculated for corresponding blocks in two successive images, resulting in a correlation surface for each block in the image. Each correlation surface is searched for a small number of dominant peaks, which are the candidate vectors for the second stage. The highest peaks in the correlation surface are the result of the motion of objects in the block, and the relative height of the peaks reflects the relative size of the objects. Candidate vectors with a sub-pixel accuracy can be estimated by interpolating the correlation surface. In the second stage, each of the large blocks is divided into smaller blocks, typically 8 pixels square. The small blocks from the current image are shifted over each candidate vector from the phase correlation step, and the match error with the previous image is calculated. The vector with the lowest match error is assigned to each block. A simple, and popular, match error function is the Summed Absolute Difference (SAD) criterion [13]: SAD (X, d) = Σ | f2(x) = f1(x – d) | (4) where SAD is the match error, X is the center of the current small block, d is the displacement vector under evaluation, f1(x) respectively f2(x) are the cloud index values at position x in the current, respectively, previous, image. The position x is included in the current small block centered in X. To improve the result, candidate vectors from surrounding blocks might be included. Thus, the Phase Correlation method is similar to the full search block matching algorithm, except that the number of candidate displacements is limited to those resulting from the phase correlation process. This allows the number of candidate vectors to be kept low, while still enabling large displacements to be measured accurately [14]. 3. APPLICATION ON CLOUD INDEX MAP DERIVED FROM SATELLITE IMAGE We performed the study to a 1024*1024 pixels image centered on Carpentras (France). Figure 1 present the Meteosat-9 images taken June 16th, 2012 at 1100 UTC. Firstly, we applied a algorithm converting such images into cloud index maps using the Heliosat-II method (Rigollier et al. ). A cloud index represent the cloud amount enable to attenuate solar shortwave irradiance reaching the Earth surface. Its value is roughly comprised between 0 (clear sky) and 1 (overcast). Working with such image permit to concentrate only on cloud features and avoid solar illumination dependence during the day. Using two subsequent images (one at T0 = 1100 UTC and the second at T0 +15 min., 1115 UTC), we extracted cloud motion vectors with phase correlation method (figure 2) as well as state-of-the-art method [9]. 4124 Next stage consists in assuming that cloud trajectories remain constant 4-hour ahead, then cloud index maps can be extrapolated. Rectangular low pass filter has been applied to predicted images. It permits to reduce the impact of inaccuracies in the extrapolated images, which mainly occur because of spatial differences between predicted and actual cloud positions. These deviations are caused by undetected changes in cloud-motion direction and speed and by propagation of fine cloud structures, which are likely reshaping during cloud movement and are therefore unpredictable [15]. 4. RESULTS Actual cloud index maps have been compared with predicted ones at each time-steps. We computed RMSE and bias and compared results of both methods against persistence. Persistence algorithm assumes any cloud index posterior cloud index image at T0 is equal to the one at T0. Figure 3 shows the evolution of relative RMSE for the three cloud index forecasting algorithm with 4-hour ahead. Results show that Phase Correlation approach did not beat state-of-art algorithm. RMSE difference between both algorithms remains constant within 3-hour ahead. However, the scores are close and the gain against persistence is significant (about 21 %) after at a time time horizon of 4 hour. Relative bias comparisons gained 12 % against persistence at the same time. At significant point of the Correlation Phase algorithm is the computing, 25 % shorter than the method of [9]. 6. CONCLUSION In this paper, we implemented a new approach for solar irradiance forecasting with meteorological geostationary satellite visible channel images. We use a proven method from video processing and applied it to satellite images. We computed predicted cloud index maps and compared them against state-of-the-art and persistence algorithms. Loss in accuracy compared to existing method remains small but a real progress in time computing have been highlighted. Conclusive works must be undertaken by comparing solar irradiance derived from these cloud index maps against ground measurements. However, comparing performance of cloud index maps is very representative of forecasting algorithms over extended areas. Figure 1: Area of study taken by Meteosat-9 Figure 2 : Meteosat-9 images with cloud motion vectors derived from Phase Correlation algorithm Figure 3: Relative RMSE evolution with time horizon for three cloud index forecasting algorithms 4125 11. REFERENCES [1] Diagne, M., David, M., Lauret, P., Boland, J., Schmutz, N. (2013). Review of solar irradiance forecasting methods and a proposition for small-scale insular grids. Renewable and Sustainable Energy Reviews, 27, 65-76. [2] Chow CW, Urquhart B, Kleissl J, Lave M, Dominguez A, Shields J, Washom B. “Intra hour forecasting with a total sky‐ imager at the UC San Diego solar energy testbed”, Solar Energy 2011; doi:10.1016/j.solener.2011.08.025. [3] Perez, R., Kivalov, S., Schlemmer, J., Hemker Jr, K., Renné, D., & Hoff, T. E. (2010). Validation of short and medium term operational solar radiation forecasts in the US. Solar Energy, 84(12), 2161-2172. [4] Rigollier, C., Lefèvre, M., and Wald, L.: The method Heliosat-2 for deriving shortwave solar radiation from satellite images, Solar Energy, 77, 159–169, 2004. [5] Cros S., Albuisson M., Lefèvre M., Rigollier C., Wald L., 2004. HelioClim: a long-term database on solar radiation for Europe and Africa. In Proceedings of Eurosun 2004, published by PSE GmbH, Freiburg, Germany, pp. (3)916-920, ISBN 3-9809656-4-3. [6] Perez, R., Ineichen, P., Moore, K., Kmiecik, M., Chain, C., George, R., Vignola, F., 2002. A new operational satellite-to-irradiance model. Solar Energy 73 (5), 307–317. [7] Stackhouse, P. W., Eckman, R. S., Zhang, T., Mikovitz, J. C., Whitlock, C. H., Chandler, W. S., ... & Leng, G. S. (2006, July). Supporting Energy-Related Societal Applications Using NASAs Satellite and Modeling Data. In Geoscience and Remote Sensing Symposium, 2006. IGARSS 2006. IEEE International Conference on (pp. 425-428). IEEE. [8] Hammer A, Heinemann D, Lorenz E and Lückehe B. “Short term forecasting of solar radiation: A statistical approach‐ using satellite data”. Solar Energy 67. 1999 [9] Heinemann, D., Lorenz, E., Girodo, M., 2006. Forecasting of solar radiation. Solar energy resource management for electricity generation from local level to global scale. Nova Science Publishers, New York. [10] Lorenz E, Kühnert J, and Heinemann D: Short Term Forecasting of Solar Irradiance by Combining Satellite Data and Numerical Weather Predictions, 2012, .Proc. of 27th EUPVSEC, p 4401 – 4405, Frankfurt, Germany. [11] Hoff E., and Perez R., 2012, Predicting Short-Term Variability of High-Penetration PV. Proc. World Renewable Energy Forum (ASES Annual Conference), Denver, Co.(Perez et al., 2012) [12] Kuglin, C.D. and D.C. Hines, THE PHASE CORRELATION IMAGE ALIGNMENT METHOD, In: Proceedings of the IEEE 1975 International Conference on Cybernetics and Society, San Francisco, 23-25 September 1975. [13] Haan, G. de, VIDEO PROCESSING FOR MULTIMEDIA SYSTEMS. Eindhoven: University Press Eindhoven, 2000. [14] Thomas, G.A. TELEVISION MOTION MEASUREMENT FOR DATV AND OTHER APPLICATIONS. BBC Research Department, Engineering Division, 1987. Internal report no. BBC RD 1987/1. [15] Lorenz, E., Heinemann, D., 2012. Prediction of Solar Irradiance and Photovoltaic Power. In: Comprehensive Renewable Energy. Elsevier, vol. 1, pp. 239–292. ACKNOWLEDGEMENTS This work is part of the project Soleka RI, cofinanced by the European Union and Regional Council La Réunion. Europe involves in La Réunion with European Regional Development Fund (ERDF). 4126","libVersion":"0.3.2","langs":""}