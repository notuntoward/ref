{"path":"lit/lit_notes_OLD_PARTIAL/Taquet22theoryDescrConformScores.pdf","text":" » Theore\u0000cal Descrip\u0000on Conformity Scores : contents Theoretical Description for Conformity Scor es The mapie.conformity_scores.ConformityScore class implements various methods to compute conformity scores for regression. We give here a brief theore\u0000cal descrip\u0000on of the scores included in the module. Note that it is possible for the user to create any conformal scores that are not already included in MAPIE by inheri\u0000ng this class. Before describing the methods, let’s brieﬂy present the mathema\u0000cal se\u0000ng. With conformal predic\u0000ons, we want to transform a heuris\u0000c no\u0000on of uncertainty from a model into a rigorous one, and the ﬁrst step to do it is to choose a conformal score. The only requirement for the score func\u0000on is that larger scores should encode worse agreement between and . [1] There are two types of scores : the symmetric and asymmetric ones. The symmetric property deﬁnes the way of compu\u0000ng the quan\u0000le of the conformity scores when calcula\u0000ng the interval’s bounds. If a score is symmetrical two quan\u0000les will be computed : one on the right side of the distribu\u0000on and the other on the le\u0000 side. 1. Th e a bsolute r esidual scor e The absolute residual score (mapie.conformity_scores.AbsoluteConformityScore ) is the simplest and most commonly used conformal score, it translates the error of the model : in regression, it is called the residual. The intervals of predic\u0000on’s bounds are then computed from the following formula : Where is the quan\u0000le of the conformity scores. (see Theore\u0000cal Descrip\u0000on for more details). With this score, the intervals of predic\u0000ons will be constant over the whole dataset. This score is by default symmetric (see above for deﬁni\u0000on). 2. Th e gamma scor e The gamma score [2] (mapie.conformity_scores.GammaConformityScore ) adds a no\u0000on of adap\u0000vity with the normaliza\u0000on of the residuals by the predic\u0000ons. It computes adap\u0000ve intervals : intervals of diﬀerent size on each example, with the following formula : Where is the quan\u0000le of the conformity scores. (see Theore\u0000cal Descrip\u0000on for more details). This score is by default asymmetric (see deﬁni\u0000on above). Compared to the absolute residual score, it allows us to see regions with smaller intervals than others which are interpreted as regions with more certainty than others. It is important to note that, this conformity score is inversely propor\u0000onal to the order of magnitude of the predic\u0000ons. Therefore, the uncertainty is propor\u0000onal to the order of magnitude of the predic\u0000ons, implying that this score should be used in use cases where we want greater uncertainty when the predic\u0000on is high. 3. Th e r esidual n ormalized scor e The residual normalized score [1] (mapie.conformity_scores.ResidualNormalisedScore ) is slightly more complex than the previous scores. The normaliza\u0000on of the residual is now done by the predic\u0000ons of an addi\u0000onal model which learns to predict the base model residuals from . is trained on and the formula of the score is: This score provides adap\u0000ve intervals : intervals of diﬀerent sizes in each point with the following formula : Where is the quan\u0000le of the conformity scores. (see Theore\u0000cal Descrip\u0000on for more details). This score is by default symmetric (see deﬁni\u0000on above). Unlike the scores above, and due to the addi\u0000onal model required this score can only be used with split methods. Normaliza\u0000on by the learned residuals from adds to the score a knowledge of and its similarity to the other examples in the dataset. Compared to the gamma score, the other adap\u0000ve score implemented in MAPIE, it is not propor\u0000onal to the uncertainty. Key tak eaways The absolute residual score is the basic conformity score and gives constant intervals. It is the one used by default by mapie.regression.MapieRegressor . The gamma conformity score adds a no\u0000on of adap\u0000vity by giving intervals of diﬀerent sizes and is propor\u0000onal to the uncertainty. The residual normalized score is a conformity score that requires an addi\u0000onal model to learn the residuals of the model from . It gives very adap\u0000ve intervals without speciﬁc assump\u0000ons on the data. References [1] Lei, J., G’Sell, M., Rinaldo, A., Tibshirani, R. J., & Wasserman, L. (2018). Distribu\u0000on-Free Predic\u0000ve Inference for Regression. Journal of the American Sta\u0000s\u0000cal Associa\u0000on, 113(523), 1094–1111. Available from h\u0000ps://doi.org/10.1080/01621459.2017.1307116 [2] Cordier, T., Blot, V., Lacombe, L., Morzadec, T., Capitaine, A. &amp; Brunel, N.. (2023). Flexible and Systema\u0000c Uncertainty Es\u0000ma\u0000on with Conformal Predic\u0000on via the MAPIE library. Available from h\u0000ps://proceedings.mlr.press/v204/cordier23a.html.","libVersion":"0.3.2","langs":""}