{"path":"lit/sources/Driesse08curvesEfficPVinvert.pdf","text":"BEYOND THE CURVES: MODELING THE ELECTRICAL EFFICIENCY OF PHOTOVOLTAIC INVERTERS Anton Driesse, Praveen Jain Dept. of Electrical Engineering, Queen’s University, Canada Steve Harrison Dept. of Mechanical Engineering, Queen’s University, Canada driessea@queensu.ca ABSTRACT It has been noted that the models typically used to represent inverters in simulation and design tools at the present are inadequate because they do not capture the variations in electrical efficiency over the full range of operating conditions. Data to develop more detailed models have been scarce in the past, but are now increasingly available from multiple sources, therefore it is time to rectify the situation. This paper examines efficiency measurements for a wide range of different inverter products at multiple power levels and input voltages. A model is developed that expresses efficiency as a function of both power and voltage, and it is demonstrated that this model can approximate the efficiency with an appropriate level of accuracy using a small number of parameters. This combination of accuracy and simplicity should facilitate implementation in software and dissemination of model parameters. INTRODUCTION Power conversion equipment such as grid-tie invert- ers are key components in photovoltaic power systems. They may represent only a fraction of the system cost, and do not even appear in most system photographs, but they influence system performance to a large extent. A seemingly small improvement in efficiency, for example, reduces the number of PV modules needed for a given energy output, and can therefore reduce total system cost significantly [1]. Manufacturers make every effort to increase the elec- trical efficiency of their inverters and to tailor their effi- ciency profiles to the needs of the industry. However it is a challenge for system designers to select the optimal inverter for a particular array, or to dimension an array to best match a particular inverter. Most simulation and design tools simply do not account for the changes in efficiency over the full range of operating conditions that may be encountered. As such, they cannot maximize the strengths of individual products. While maximum efficiencies still make headlines, there is a clear trend to more comprehensive treatment of efficiency specifications, passing from weighted averages such as the Euro-efficiency to comprehensive tables published by either the manufacturer or an independent agency. Such tables clearly document the dependency of efficiency on both output (or input) power level and input voltage. To make the best use of this information it must be integrated into simulation and design software. The inverter model described in this paper has been developed with this purpose in mind. OBJECTIVES The proposed model will calculate the power losses and output power, and hence also efficiency, of grid- connect PV inverters over the full range of operating conditions. To serve the intended purpose—integration into design and simulation tools—our model should have certain qualities. Above all, it should produce performance predictions with the appropriate level of accuracy; that is, a level that is both significant and achievable. This accuracy should also be uniform over the operating range of the inverter, or optimized based on the expected operating range. The model is expected to work with a broad range of products, and therefore needs suitable parameters to capture the relevant differences. The smaller the number of parameters, the more convenient it will be to implement and use the model. The option to use only a subset of the parameters is a practical quality as well, since it permits the use with an incomplete product description. Finally, a logical or intuitive link between the parame- ters and the inverter characteristics is desirable so that the parameter values can give insight into the causes and/or consequences of those characteristics. This also implies that products with similar characteristics should have similar parameter values. While existing models exhibit these qualities to varying degrees, none do so as com- pletely as the model proposed here. EFFICIENCY DATA At present the most comprehensive single source of data on inverter efficiency appears to be the California Energy Commission (CEC) [2]. As of December 2007, 192 inverter test reports are available with details on inverter efficiency over a range of different AC output power levels (10%, 20%, 30% 50% 75% and 100% of nominal), and DC input voltage levels (minimum, nominal and maximum) as shown in Fig. 1. The actual measurements from which the summary tables are derived are also provided. Several very detailed inverter analyses are available from the Berner Fachhochschule - Technik und Informatik, Switzerland albeit in the German language only [3]. Their summary data are provided at 5%, 10%, 20%, 30% 50% and 100% of nominal power and three voltage levels, whereas the numerous graphs show additional measure- ment points. The German magazine Photon also publishes very detailed reports on one inverter each month, and periodic summary reports. And finally, some inverter manufacturers are providing more detailed information. A good example of this is Sunways, in Germany [4]. The availability of these data is an open invitation to develop more comprehensive models. The data in and of themselves can provide useful insights into certain strengths and weaknesses of each inverter, but to evaluate their impact on system performance by means of simulation, the data are better first transformed into a mathematical model. Accuracy The accuracy of efficiency measurements is dis- cussed in some detail in [1]. Absolute uncertainty is expected to be around 0.2% to 0.6% of reading using state-of-the-art equipment, whereas relative changes in efficiency might be determined with a resolution of 0.05% to 0.15%. Based on this analysis, a reasonable objective for model development is an RMS error of 0.2% or less. Model errors reported by [5] are of similar magnitude. In some cases the CEC measurements themselves show excessive variation between samples at the same operating point, so it is impossible to achieve the target RMS error in any model. If the efficiency values are uniformly accurate over the power range of the inverter, the absolute tolerance on Ploss or Pout will be small at low power values, and larger at high power values. Uniform model accuracy in Ploss is more appropriate, but the target accuracy for efficiency is still useful for evaluation purposes. Fig. 1. Example of efficiency data available from the CEC. These curves are for a Xantrex model PV20-208. MODELS CAPTURING POWER DEPENDENCY The electrical conversion efficiency (η) indicates what fraction of the input power, Pin, is transferred to the output, Pout. The difference, Ploss, is converted to heat inside the inverter. An excellent summary and comparison of earlier models for representing the electrical conversion efficiency as a function of power level is found in [6]. The quadratic function 2 out2out10loss PaPaaP ⋅+⋅+= (1) provides a good fit for empirical data and can be explained more or less in physical terms. First of all, for grid-tie inverters the output voltage is relatively constant, making Pout proportional to Iout. The three quadratic terms have been explained as “self-consumption” (such as drive and auxiliary circuits); losses proportional to Iout due to fixed voltage drops in semiconductors; and ohmic losses that are proportional to Iout2 [1,6-8]. The explanation for the linear term is probably not adequate to cover all the linear losses, but there is another explanation also. The switching losses, which are losses incurred during on-off and off-on transitions in power semiconductors, are approximately proportional to both the on-current and to the off-voltage. In principle all three coefficients should be positive since each represents a distinct type of physical loss. However, negative values for the a1 coefficient do occur for at least one inverter. It is possible that within a multistage inverter, an increase in power causes the control system to change an internal bus voltage. This would violate the assumption of the model that the internal currents are roughly proportional to the power level, and may be the cause for the negative coefficient. Efficiency is calculated from Ploss as follows: lossout out PP P + =η (2) MODELS CAPTURING VOLTAGE DEPENDENCY Double quadratic model The quadratic equation above (1) has been adapted to incorporate the effect of input voltage dependency on Ploss and efficiency by transforming each of the three coefficients into a quadratic function of voltage, such as: 2 ini,2ini,1i,0i VaVaaa ⋅+⋅+= (3) The resulting “double quadratic” model achieves good fits in the published examples [1,8] and also on the data sets that we have analyzed. An additional Vin 3-dependent term has also been considered in [7] but deemed unnecessary. Although it is accurate, this model lacks other quali- ties. Unlike in the original equation (1), the new voltage- dependent terms have not yet been explained in physical terms. Also, it has quite a large number of parameters (9 coefficients); the magnitudes of the parameters cover many orders of magnitude; and the model cannot be applied progressively or with partial information. Sandia model The Sandia model [5] has been developed precisely to meet the objective of accommodating partial information and providing progressively better accuracy as more information becomes available. It expresses Pac as a function of Pdc, and optionally also of Vdc. The main equation expressing the power-dependent losses is still a quadratic just like (1), but it has been transformed to use coefficients such as rated AC and DC power, (Paco, Pdco), and self-consumption (Pso) directly from the inverter specifications. This is appealing; however, the remaining factor that quantifies the “curvature” of the Pac – Pdc relationship (C0) appears to be without physical meaning. ( ) ( ) ( ) 2 sodco sodcsodcoo sodco aco ac PPC PPPPC- PP P P −+ −       −      − = (4) Voltage dependencies are obtained by adjusting Pdco as follows: ( ){ }dcodc1dcodco V-VC1PP' += (5) where Vdco is the nominal input voltage. The parameters Pso and Co are adjusted in a similar manner. Using ∆V rather than V to express the voltage dependency allows the model to be used as a function of P alone, or of both P and V. In cases where only the most basic specifications are available the authors suggest that a default value of zero be used for Co. However, this value effectively removes the P 2 term from the equation, which implies no ohmic losses, and as a result the maximum efficiency is achieved at the maximum power level. This is usually not the case in PV inverters. It would be better, therefore, to calculate a default value for Co from a condition such as the power level at which maximum efficiency is achieved. This value is sometimes available, or could be estimated at ½Pdco to create a more typical efficiency profile. A drawback to this model, in our view, is the large range in magnitudes of the parameters, which make transcription error-prone, and interpretation or comparison between products difficult. Another drawback appears to be that the model is forced to fit the upper and lower extremes of the power range, which suggests that accuracy in the midrange may be sacrificed. In fact, accuracy is needed most in the midrange, since that is where the inverter would be operating most of the time. Finally, it is interesting to note that when the complete model is rearranged as a polynomial of P and V, 12 terms emerge, with powers as high as P2, P 2V, PV 2, and V 3. The manner in which the voltage dependency is represented is convenient, but how this dependency relates to the three types of losses in the inverter is not so obvious. MODEL DEVELOPMENT Dependent and independent variable Regardless of how the inverter performance data are presented, there are only two fundamental measurements: Pin or PDC and Pout or PAC. From these, Ploss and efficiency (η) are calculated. The term efficiency is sometimes also used with reference to MPPT tracking effectiveness, but in the present discussion it is only used as an indicator of electrical conversion efficiency. As discussed in [6] and [8], there are various ways to represent the relationship between these variables: ( ) ( ) ( ) ( ) ( )ininout ininloss inoutloss inin inout V,PfP V,Pf P V,Pf P V,Pf η V,Pf η = = = = = (5) For the purpose of building a model, not all options are equal. The choice of independent variable affects the calculation process. For example, a function of Pin will be easier to evaluate in a grid-tie inverter simulation than a function of Pout since Pin is most of the time dictated by the PV array. Nevertheless, it is still possible to solve even complex functions of Pout numerically when Pin is given. The choice of dependent variable has a more subtle effect. The curve fitting procedures that are used in the process of determining model parameters usually minimize the RMS error in the dependent variable. When the error in Ploss or Pout is minimized, the efficiency curve will have a looser fit at low powers, whereas when the error on efficiency is minimized, the Ploss curve will have a looser fit at high powers. Thus, the dependent variable should be chosen based on the type of fit required. In design and simulation tools the objective is not to reproduce efficiency curves, but rather to calculate power output and energy production over a period of time. For this purpose a uniform accuracy for Ploss is more suitable, and hence Ploss should be chosen as the dependent variable. Hence, to both simplify the calculations and obtain suitably uniform accuracy, the following form is selected: ( )ininloss V,Pf P = (6) The uniformity of fit is also influenced by the distribu- tion of data points. The CEC data are not uniformly distributed, but more measurements are given in the lower half of the power range. Ideally, the smallest model errors would be in the middle of the power range where most of the energy production takes place. This could be achieved by taking additional measurements, or by applying weights to the available measurements in the fitting process—but this does not influence model form. Normalization The Sandia model uses true voltage and power val- ues, and several authors using the double quadratic model do the same. In both cases this leads to parameter values spanning several orders of magnitude, and different parameters for products with similar looking efficiency curves but different operating ranges. Normalization of both power and voltage solves these problems: Power can be normalized to the nominal maximum rating, Pnom (usually output power); and input voltage can be normal- ized to a nominal input voltage, Vnom giving the form:     = nom in nom in nom loss V V , P P f P P (7) From this point forward small letters will identify the normalized power and voltage values. The exact values of Pnom and Vnom are not critical, however they should chosen in a consistent manner. Voltage dependency The most elusive question is how to represent voltage dependency in a manner that is both meaningful and general, and affords the appropriate accuracy. As others have described [8], there are many possible ways in which input voltage can influence efficiency, and this depends greatly on the topology of the inverter. Lacking the internal details, only an analysis of the data can reveal whether there are perhaps only a small number of dominant factors, and whether this complexity can be safely ignored. Fig. 2. Coefficients of the quadratic model at three separate voltages (Xantrex PV20-208). A useful way to visualize the voltage dependencies, is to produced separate quadratic fits using equation (1) with normalized power values, and plotting the three coeffi- cients as a function of Vin (also normalized). An example is shown in Fig. 2., which shows self-consumption and ohmic losses increasing almost linearly with input voltage, while the losses proportional to power decrease with voltage. Since both power and voltage are normalized, the coefficients represent power losses as fractions of nominal power, and generally fall in the range 0.00 to 0.05 (0 to 5%). The nature of these graphs is telling: A nearly horizon- tal line indicates no influence of Vin. A straight inclined line indicates a simple linear voltage dependency. A curved but monotonically increasing or decreasing line may indicate a dependency on a power of Vin, which can be graphically explored, or it may result from a combination of factors such as different powers of Vin or other functions of Vin. Finally, a curve with a peak or valley must be interpreted as a combination of different voltage- dependent factors. The true shape of the more complex dependencies cannot be identified with only three points at three voltages. However, the curvature hinted by the three points is usually relatively modest, suggesting that a linear approximation of the voltage dependency may be adequate. Also, the three coefficients show three quite different voltage dependencies, with no apparent pattern to link them. This suggests that three separate voltage dependencies exist. Preferred model The foregoing observations suggest that a quadratic model with linear voltage dependency would be appropri- ate. This is essentially the double quadratic model with the three Vin2 terms removed. Expressing this in normal- ized form, and using voltage deviation from nominal rather than absolute voltage, gives the equation: ( )( ) ( )( ) ( )( ) 2 inin2,12,0 inin1,11,0 in0,10,0loss p1vbb p1vbb 1vbbp ⋅−++ ⋅−++ −+= (8) This model was tested with the CEC data for 12 dif- ferent inverters and achieved the target accuracy in efficiency with an RMS error less that 0.2% in all but one case. Figs. 3 and 4 show the results for the second best case, and Table 1 lists the RMS errors in both Ploss and efficiency for all 12 inverters. Fig. 3. Efficiency calculated using the preferred model of equation 8 (Xantrex PV20-208). Fig. 4. Ploss calculated using the preferred model of equation 8 (Xantrex PV20-208). Table 1. Model errors obtained using the preferred model of equation 8. Model RMS Error Inverter Effciency Ploss Ballard EPC-PV-208-75 0.0003 0.0001 Kaco 3601xi 0.0018 0.0004 Magnetek PVI3600 0.0080 0.0027 PVPowered PVP3200-240 0.0013 0.0003 PVPowered PVP3500 0.0006 0.0001 Satcon AE-225-60-PV-A 0.0005 0.0003 SMA SB3800U-240 0.0006 0.0005 SMA SWR2500U-240 0.0012 0.0007 Sunways NT6000 0.0008 0.0002 Xantrex GT3.8 0.0010 0.0004 Xantrex PV20-208 0.0018 0.0006 Xantrex PV225S-480 0.0011 0.0006 Enhanced model The one inverter that does not fit the model has the unique characteristic that all three of the loss types are minimized at the nominal input voltage. The dual quad- ratic model is able to capture this, however with no specific evidence for a Vin2 dependency it seems more intuitive to incorporate an inverse voltage dependency to capture the idea that multiple voltage dependencies exist with opposing influences. Adding these terms to Equation (8) produces: ( ) ( ) ( ) 2 in in 2,2in2,12,0 in in 1,2in1,11,0 in 0,2in0,10,0loss p1 v 1 b1vbb p1 v 1 b1vbb 1 v 1 b1vbbp ⋅           −+−++ ⋅           −+−++           −+−+= (9) This model produces the target accuracy for all in- verters analyzed. It has the same number of parameters as the dual quadratic, but is normalized, somewhat more intuitive, and can be used with as many or few parameters as desired to achieve a good fit. In fact, only two of the three additional terms are required to reach the target accuracy for the outlier. It is important to note that for the remaining inverters the additional model complexity offers only small, and in some cases no improvement at all. The variations between samples in the measured data points simply prevent further improvement and the linear voltage dependency is adequate. Table 1. Model errors obtained using the enhanced model of equation 9. Model RMS Error Inverter Efficiency Ploss Ballard EPC-PV-208-75 0.0003 0.0001 Kaco 3601xi 0.0018 0.0004 Magnetek PVI3600 0.0015 0.0003 PVPowered PVP3200-240 0.0012 0.0002 PVPowered PVP3500 0.0006 0.0001 Satcon AE-225-60-PV-A 0.0003 0.0002 SMA SB3800U-240 0.0006 0.0003 SMA SWR2500U-240 0.0012 0.0007 Sunways NT6000 0.0008 0.0002 Xantrex GT3.8 0.0010 0.0002 Xantrex PV20-208 0.0017 0.0005 Xantrex PV225S-480 0.0006 0.0004 Despite the one exception, we believe that the need to incorporate more complex voltage dependencies will be minimal and probably negligible. With increased attention given to the voltage dependencies, inverter designers and manufacturers will no doubt do everything possible to achieve more uniform efficiencies over the operating range, thereby reducing the modeling errors resulting from the linear approximation. DISCUSSION AND CONCLUSIONS This paper documents an investigation of the effect of input voltage and power on the efficiency of grid-connect inverters using data sources that have recently become available. We have examined existing approaches to model those effects, and propose a model to offer a combination of practical qualities, including: sufficient and uniform accuracy; a small and variable number of parameters; and parameters that offer a means to compare different products. The data suggest that in most inverters the internal voltage dependent loss mechanisms are multiple and complex, however the net effects can usually be approxi- mated as linear dependencies using the preferred model presented here. In the exceptional cases additional inverse voltage dependencies can be used to create an enhanced model, although this offers minimal improve- ment in accuracy for the majority. Fortunately, the manner in which the models are formulated allow the enhanced model to be implemented and used with as few or as many voltage dependency parameters as required for a particular product. We do expect that inverter designs will evolve to mini- mize the variations in efficiency with input voltage, and therefore the simpler model that captures these variations with linear approximations will be most appropriate for integration into design and simulation software. ACKNOWLEDGMENTS The author would like to thank NSERC for the finan- cial support provided to this research project throught the Canadian Solar Buildings Research Network. I am also grateful to the Ontario Centres of Excellence for support- ing my participation in this conference. REFERENCES [1] F. P. Baumgartner, H. Schmidt, B. Burger, R. Bruendlinger, H. Haeberlin, and M. Zehner, “Status and relevance of the DC voltage dependency of photovoltaic inverters,” in 22nd European Photovoltaic Solar Energy Conference, Sept 2007. [2] California Energy Commision, “Inverter performance test results,” http://www.consumerenergycenter.org/ erprebate/inverter_tests/index.html, Nov 2007. [3] H. Haeberlin, “Testbericht SunnyBoy 3800,” Berner Fachhochschule - Technik und Informatik, Tech. Rep., 2006. [4] Sunways AG, Product Literature: Sunways NT Series Solar Inverters, Jul 2007. [Online]. Available: www.sunways.de [5] D. King et al, “Performance model for grid-connected photovoltaic inverters,” Sandia National Laboratories, Sept. 2007 [6] A. E.-M. M. A. El-Aal, J. Schmid, J. Bard, and P. Caselitz, “Modeling and optimizing the size of the power conditioning unit for photovoltaic systems,” Journal of Solar Energy Engineering, Transactions of the ASME, vol. 128, no. 1, pp. 40–44, Feb. 2006. [7] F. P. Baumgartner, “Euro realo inverter efficiency: DC- voltage dependency,” in 20th European Photovoltaic Solar Energy Conference, Sept 2005. [8] H. Schmidt et al, Modellierung der Spannungs- abhängigkeit des Wechselrichter-Wirkungsgrades,” 23. Symposium Photovoltaische Solarenergie, Staffelstein, 2008.","libVersion":"0.3.1","langs":""}