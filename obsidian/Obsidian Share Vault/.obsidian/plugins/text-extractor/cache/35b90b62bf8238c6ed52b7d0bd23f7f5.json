{"path":"lit/sources/papers_added.SAVE/papers/Aiad16NonintrusiveLoadDisaggregationa.pdf","text":"See discussions, st ats, and author pr ofiles f or this public ation at : https://www .r ese ar chg at e.ne t /public ation/307542338 Non-intrusive load disaggregation with adaptive estimations of devices main power effects and two-wa y interactions Article    in    Ener g y and Buildings · Oct ober 2016 DOI: 10.1016/ j. enbuild.2016.08.050 CIT A TIONS 20 READS 243 2 author s , including: Some o f the author s o f this public ation ar e also w orking on these r elat ed pr ojects: Ener g y Disaggr e g ation V ie w pr oject Misb ah Aiad Nany ang T echnologic al Univ er sity 6 PUBLICA TIONS     78 CIT A TIONS     SEE PROFILE All c ont ent f ollo wing this p ag e w as uplo aded b y Misb ah Aiad on 17 Oct ober 2017. The user has r equest ed enhanc ement of the do wnlo aded file. 1 Non-Intrusive Load Disaggregation With Adaptive Estimations of Devices Main Power Effects and Two-Way Interactions Misbah Aiad * Peng Hin Lee School of Electrical and Electronic Engineering Nanyang Technological University 50 Nanyang Avenue, Singapore 639798 * Corresponding Author. Email: misb0001@e.ntu.edu.sg ABSTRACT Energy management and savings in residential homes are emerging concerns nowadays because of several challenges facing the energy sector such as energy sources limitations and environmental impacts. Non-intrusive load monitoring (NILM) was introduced as a set of methods and techniques that aim to decompose the total aggregate consumption measured by the smart meter into the consumptions by individual appliances present in the household. The detailed information on energy usage for each device were found to be a good influencing method for the residents to adopt better devices usage profiles which lead eventually to noticeable energy savings. Recent research had shown that the Hidden Markov Models (HMMs) and its extensions are effective models in the load disaggregation problem. The authors had introduced a new unsupervised approach for load disaggregation that includes the mutual devices interactions information into the Factorial Hidden Markov Model (FHMM) representation of the aggregate signal in an earlier work. In this paper, we introduce an adaptive approach for estimating devices main power consumptions and their two-way interactions during the disaggregation process. The adaptive approach is used to mimic the changes in devices consumptions and two-way interactions. The adaptive estimation process was carried out only for cases when there are four devices or less that are operating/ON instantaneously. The proposed approach was tested with data from the REDD public data set and it showed better performance in terms of energy disaggregation accuracy compared with the standard FHMM. The adaptive estimating of main factors effects (primary power consumptions) and two-way interactions during the disaggregation process provided higher disaggregation accuracy results, in general, than those with fixed factors and two-way interactions values. Keywords: non-intrusive load monitoring, energy disaggregation, devices interactions, Factorial Hidden Markov Models, adaptive estimation, fractional factorial design. 1. INTRODUCTION Several challenges and concerns have arisen nowadays in the energy sector worldwide such as limitation of resources, sustainability, integration of new resources and environmental impacts. Energy saving is becoming a vital issue in an attempt to reduce the effects of some of these challenges. Research has shown that the knowledge of the power consumed by the individual appliances in the house can influence its users and hence lead to energy savings [1]. Energy savings from 9% to 20% were observed in studies conducted (see e.g. [1, 5]). Non-intrusive load monitoring, or energy disaggregation, is a set of methods and techniques whose objective is to decompose the total consumption measurements from smart meters and break them down into the appliances individual consumption. Such information on a specific appliance consumption was found to be helpful for the inhabitants to take further actions that will eventually achieve energy savings [1]. The concept and work on non-intrusive load monitoring was first proposed by Hart in 1992 [2]. Formally, the energy disaggregation problem can be defined as follows: Given the total measured power consumption 𝑝(𝑡) at any time instant 𝑡, we have 𝑝(𝑡) = ∑ 𝑝𝑗(𝑡) 𝑁 𝑗=1 (1) 2 The problem is to estimate each 𝑝𝑗(𝑡), the individual power drawn by the device 𝑗 at time instant of 𝑡, where 𝑗 = 1, 2, … 𝑁, 𝑡 = 1, 2, … 𝑇 and 𝑁 is the total number of the operating appliances within the disaggregation period 𝑇 [3]. The NILM process makes use of the total aggregate readings from the smart meter. There is no need for sub-metering or to install a unique sensor for each device as done in the intrusive monitoring methods. For this reason, non-intrusive methods gain more advantages such as applicability and lower implementation cost. 2. BACKGROUND AND RELATED WORK The concept and initial work of NILM was first proposed by Hart in 1992 [2]. He showed the possibility to identify the operation of individual devices using the total aggregate signal only. He suggested to perform the disaggregation process in two steps. Firstly, to estimate main devices signatures such as active and reactive power drawn when an event (a device goes ON or OFF) is detected as shown in Figure 1 [2]. Secondly, to group elements with similar features (signatures) into clusters that represent the individual devices. Fig. 1. Power versus time (total load) shows step changes due to individual appliance events [2] It was noticed that there are still some overlapping points between two or more clusters. This can happen between close clusters of low power consuming devices [2]. Therefore, advances in new features extraction and good performance classification methods are required to achieve more accurate energy disaggregation results [4]. The nature and number of features that can be extracted from the total aggregate signal depend significantly on the sampling frequency used in measurements. Main features that can be captured by low frequency meters (like 1 Hz smart meters) include the consumption pattern of a device and its real and reactive power consumptions. In contrast, high sampling frequency measurements (several kHz) can provide more detailed and finer information on distinct devices features such as harmonics, transients, electromagnetic interference (EMI) and noise Fast Fourier Transform (noise FFT) [3]. Even though these fine signatures are useful in the classification process, using high frequency measurement is still unreasonable since it would require installation of new and costly metering equipment rendering it an impractical solution. For these reasons, research should be directed on low frequency data obtained from the currently installed smart meters which report total consumptions at a rate of 1 Hz, for example. Sometimes it is also helpful to use non-electric features for classifications. These features are usually dependent on the users’ behavior or environment factors such as outside temperature, day/time of operations, durations of use, interdependency between appliances, …, etc. [5]. After extracting all possible features from the aggregate consumption signal, the classification of devices can be done either by a supervised or an unsupervised learning approaches. Supervised approaches include a learning phase where a database of devices together with their distinct signatures 3 (features) is initially built. Subsequently, the disaggregation process can be done either by optimization or pattern recognition methods. Many classification methods such as Bayesian classifiers, Artificial Neural Networks (ANNs) and Hidden Markov Model (HMM) and its extensions were used [3]. Since information on individual devices consumptions are usually unavailable, supervised learning approaches are less realistic solutions to the energy disaggregation problem. Conversely, the unsupervised learning approaches perform online training during the disaggregation process. The process is usually done based on probabilistic analysis and classification methods [5, 6]. Recent research had showed that the Hidden Markov Models (HMMs) and their extensions are effective models in the energy disaggregation problem. The observations sequence in HMMs can represent the measured total consumption, while the hidden states chain represents the states of the devices in the household. Kolter and Jaakkola [6] proposed a new approximate inference method for energy disaggregation based on Factorial Hidden Markov Model (FHMM), which is an extension of the standard HMM with several states chains evolving in parallel and the observation is a joint function of these chains [7]. They utilized two complementary models, the additive and the difference FHMM. The additive FHMM captures the total aggregate output signal while the difference FHMM encodes the signal differences between subsequent levels (when a device switches ON or OFF). Kim et al. [5] worked on and tested four different extensions of Hidden Markov Model (HMM) for better representations and disaggregation results. Parson [1, 8] proposed an approach in which a one-time supervised learning process with already labeled data set was used to create general probabilistic models of appliances. Thereafter, these general models can be tuned to previously unseen households in an unsupervised manner. The tuning process resulted in specific models of devices that were present in the testing households. The lack of public data sets was one of the main challenges for researchers to be able to test their new proposed algorithms. Currently, few data sets are available for research goals such as those discussed in [8]. The largest and detailed public data set available is the Reference Energy Disaggregation Data Set (REDD) [9]. REDD includes both individual devices and total consumption measurements of six real houses for an approximate period of two weeks. Individual appliances consumptions can be used for training in supervised approaches and for algorithms validation and accuracy calculations. 3. ANALYSIS OF DEVICES MAIN EFFECTS AND INTERACTIONS An experimental factorial model was considered where the output response is driven by a set of controllable and uncontrollable factors (such as noise) as shown in Figure 2 [10, 11]. The output response in our case represents the measured total power consumption signal. This response y is controlled by the hidden states of the devices (the controlling factors). We considered a 2𝑘 factorial model where there exist k controllable factors (devices) and each one has only two possible states (ON/OFF). Multi-state devices or Finite State Machines (FSM) can also be modeled using this representation as they can be encoded as several two-state devices [5]. The proposed factorial model was explained in details in [12]. Here, we shall give a brief summary of the proposed factorial model used. 4 Fig. 2. Experimental factorial model 3.1. Devices main power effects and interactions from statistical perspective We only need to consider the main devices effects (main power consumption of each device) and their two-way interactions. The three-way and higher order interactions were neglected in accordance with the principle of sparsity [10, 11]. The principle of sparsity, in factorial design of experiments, states that a factorial design is dominated by main factors and low order interactions (e.g. two-way interactions). Hence, high order interactions (such as third order, etc.) are usually neglected. To articulate the concept of interaction between factors (individual devices), we use the notations for the response y in the case of two devices that are present and their various states of operations as shown in Table 1. It is noted that even though when all devices (factors) are OFF, we may still have a response i due to some unknown factors or natural system responses. In our case, response i will represent the minimum power consumption level when all the devices to be detected are in the OFF state and it is termed as the base load here. Table 1. Response y for different devices DA and DB states Device DA state Device DB state Response y OFF OFF i ON OFF a OFF ON b ON ON ab In some experiments, the difference in response between the levels (Low/High) of one factor is not the same when the other factors are at different levels. When this occurs, there is an interaction between the factors [10, 11]. The main factors effects (A and B) and the two-way interaction effect (AB) can be estimated from the average of differences between High and Low levels as follows: 𝐴 = (𝑎𝑏 + 𝑎 − 𝑖 − 𝑏)/2 (2) 𝐵 = (𝑎𝑏 + 𝑏 − 𝑖 − 𝑎)/2 (3) 𝐴𝐵 = (𝑎𝑏 + 𝑖 − 𝑎 − 𝑏)/2 (4) The above equations imply that to be able to estimate the interaction values between two devices, it is necessary that we must be able to observe when both are operating alone and when both are operating together simultaneously. This could limit the number of interactions that can be estimated as will be shown in the results section. In the context of modeling a household as a factorial design, each main factor (device) effect represents the corresponding primary or rated power consumption of this device. The two-way (mutual) interaction between two devices represents the change of power consumption of these devices caused mainly due to being operating simultaneously and being susceptible to possible power quality issues as explained in subsection 3.2. 5 3.2. Devices main effects and interactions from power quality perspective In the ideal case of devices operations, each device is seen to operate as an isolated entity. That is, it does not affect or will be affected by other devices connected to the same feeder line. However, due to the increased number of electronic devices and their complex functionalities, devices may interact with each other and with other electrical network components [13]. Generally, there is a possibility for two circuits to interact if they share a common point of connection. Due to the electronic nature and low power quality in the operations of some devices, the point of common connection allows the inter-flow of different interference components such as harmonics and electromagnetic interference currents. The design or manufacturing of a device is considered to have low power quality issues when its operation does not satisfy the desired status of operation [12]. The desired status of operation denotes the case when a device performs its assigned work very well whilst being immune to noise and other effects from nearby devices. Studies on the devices interactions and their effects on power quality issues had been carried out. Gil-de-Castro et al. [14] studied harmonic interactions between different devices and found that the presence of a neighboring device could have a strong influence on the harmonics emitted by the Electric Vehicle (EV). In addition, the current charging the EV was found to be affected by different emissions (amplitudes and frequencies) coming from nearby devices. Gil-de-Castro et al. [15] investigated harmonic emissions of different domestic equipment combined with different types of lighting. Their study showed that the total emissions produced by the domestic equipment depended on the lamps that were connected in the background. Pavas et al. [16] carried out a statistical analysis of power quality disturbances propagation by means of the method of disturbances interactions. Their study was performed on a large scale to estimate possible interactions between two buildings at a MV/LV substation. The presence of disturbances in the feeder line was found to be changing in accordance with interactions of the two buildings circuits and all connected devices inside these buildings. 4. ENERGY DISAGGREGATION ALGORITHM WITH ADAPTIVE ESTIMATIONs OF DEVICES MAIN EFFECTS AND INTERACTIONS As in [12], we adopted a FHMM with added chains for possible interactions to represent the time series data of states and observations sequences as shown in Figure 3. The FHMM was chosen over HMM mainly for two considerations: representative structure and model complexity (for details, see e.g. [5, 6, 17]). The observations (X0 through XT) chain represents the observed total aggregate signal taken from the smart meter. The main factors (A, B, …, etc.) in hidden state chains represent a single state device or one state in a Finite State Machine (FSM). The two-way interactions chains (e.g. AB, BC, …, etc.) represent the interactions between the corresponding respective devices. As an illustration, an interaction AB is considered only when both devices DA and DB are operating in the ON state. The interaction AB encodes the amount of change in power consumptions when both DA and DB are ON than that when any operates alone as seen from equation (4). The observed aggregate signal is the total additive response of all active factors effects and their interactions at any time instant. The infrastructure and properties of FHMM are well described in the literature (see e.g. [6, 8]). The problem is to find the most probable sequence of hidden states that resulted in the given sequence of observations. This problem can be solved by the Viterbi algorithm [18]. This approach was used in [12]. Here, we focus on how the presence of the interaction effects and the adaptive estimations of factors and two-way interactions could enhance the accuracy of the energy disaggregation as explained later in subsection 4.2. 6 Fig. 3. FHMM with interactions chains [12] Since the power consumed by a device is not always constant during its operation period [19], e.g. refrigerators and heating devices, we have chosen to model the power consumed by a device (or a state of a device) with three power levels: initial (𝑝𝑖), average (𝑝̅) and final (𝑝𝑓 ) power consumption levels. The initial power level is the level of power consumed directly when a device switches to ON state. We have used a period of five seconds after a device is switched on to estimate the initial power consumption level. Conversely, the final power level is the power consumed five seconds before a device goes OFF. The average power level is the mean power level during the entire period of operation. This way gives a more accurate model of assigning power consumptions to a device than that of assuming only one constant consumption level [12]. If a device switches to the ON state for a few seconds only (e.g. less than five seconds), it will mostly be filtered out as undesired noise signal. In this work, we use a median filter to remove outliers and noisy signals. 4.1. Devices identification when a transition in total aggregate signal is detected When a transition up is detected in the total aggregate signal, the model will search for the most probable device that has been switched ON by comparing the transition with the initial power of the recorded devices in the database obtained in step 1 of the disaggregation algorithm described in the subsection 4.3. In addition, the interaction effects between this possible device and currently operating devices are considered. The new device will be detected by means of the Viterbi algorithm. Similar manner was used to work with detected transitions down in the aggregate total signal. In other words, when a transition up is detected in the aggregate signal, we search for a device DX such that 𝐷𝑋∗~ arg min |(𝑋𝑖 + 2 ∙ ∑ 𝑋𝑌 𝑌 ) − |𝑡𝑥|| (5) Similarly, when a transition down is detected, we search for a device DX such that 𝐷𝑋∗~ arg min |(𝑋𝑓 + 2 ∙ ∑ 𝑋𝑌 𝑌 ) − |𝑡𝑥|| (6) where, Xi is the initial power level of the possible device 𝐷𝑋, Xf is the final power level of the possible device 𝐷𝑋, Y represents the set of currently ON devices, XY represents the pair interactions of devices 𝐷𝑋 and 𝐷𝑌 and |𝑡𝑥| is the absolute value of the transition caused by the switching of the device 𝐷𝑋. To illustrate these relations, we assume an event happened at time 𝑡𝑘 (a device goes ON or OFF). Noting that at 𝑡𝑘−1, we have two groups of devices: ON devices and OFF devices. Therefore, when a device turns ON, it moves from the OFF group into the ON group, which means that its main effect (primary power consumption) will be added to the aggregate signal plus all possible interactions with already 7 operating (ON) devices. Conversely, when a device goes into the OFF state, it moves from the ON group into the OFF group which means that its main effect and interactions with already operating (ON) devices will be suppressed from the total signal [12]. To illustrate the above, we can re-write equation (4) as 𝑎𝑏 − 𝑎 = (𝑏 − 𝑖) + 2 ∙ 𝐴𝐵 (7) Since the term (𝑏 − 𝑖) gives an approximate value for the main factor B, we can write |𝑡𝑥| = 𝑎𝑏 − 𝑎 ≈ 𝐵 + 2 ∙ 𝐴𝐵 (8) Therefore, the algorithm searches for the most probable device 𝐷𝑋 that caused the transition in the total aggregate signal and considering interactions with currently operating devices. Algorithms such as [1, 2 and 6] search for the device 𝐷𝑋 without considering others devices that are already in operations. Our proposed method in [12] have considered devices interactions which help in the disaggregation process. Test results on the public REDD data set showed an improved accuracy on disaggregation as illustrated in section 5. Since power measurements have normal fluctuations, we only considered significant transitions larger than some threshold value. A threshold of 25 W was used in our approach testing. We used this moderate threshold value because a lower value will make the system very sensitive to small changes in the aggregate signal, while a higher threshold value may result in the possible missing of some low but valuable changes and hence low power consuming devices may not to be detected. 4.2. Adaptive estimations of devices main factors and two-way interactions Updating the estimates of main factors and two-way interaction during the disaggregation process could be useful in terms of following up or mimicking the changes in power consumption profiles of the operating devices. Since the total aggregate signal is usually a very long sequence of data, we shall use sequential mean updating based on the current mean value and the new sample that belong to the same population. That is, the new mean as a function of the current mean can be given by [18] 𝜇𝑘+1 = 𝜇𝑘 + 1 𝑁 (𝑥 − 𝜇𝑘) (9) where 𝜇𝑘+1 is the new updated mean value to be used in the next processing cycle, 𝜇𝑘 is the current mean value and N is the new total number of observed samples, including the new sample x used to calculate the mean value. It is interesting to note that the shift (amount of deviation) from the current mean to the new mean values depends on how far the value of the new sample x is from the current mean value. In addition, since N is always increasing, the deviations from the current mean to the new mean caused by new samples gradually become smaller. The updating process at any time instant is carried out on the main factors and interactions of the operating (ON) devices only. This is intuitive because the corresponding total aggregate signal is the summative response of all ON devices main factors effects (power consumptions) and their mutual interactions. Although many appliances could be present in a household, only few of them do operate simultaneously in normal situations [5]. This is demonstrated in the results section on a public data set and illustrated in Table 6. Therefore, we focused on main factors and interactions adaptive estimations when there are four devices or less operating simultaneously in the ON state as shown in Figure 4. 8 Fig. 4. Criteria of adaptive estimations (updates) based on the number of ON devices To articulate the adaptive estimation process of main factors and two-way interactions in these cases, we considered the following: - Case 1: when only one device (say a device DA) is detected to be operating in the ON state. In this case, the total aggregate signal can be considered as the response a. Therefore, a new instance (sample) of the main factor 𝐴 can be easily obtained from: 𝐴′ = 𝑎 − 𝑖 (10) where i is the base load response, i.e. the measured total power consumption when all devices (to be considered for detection) are in the OFF state and 𝐴′ is the new sample to be used to update the value of the main factor 𝐴. Thereafter, the main factor A is updated using the equation (9) noting that number of samples N in equation (9) is always increased by one every time it is updated. - Case 2: when only two devices (say devices DA and DB) are detected to be operating in the ON state. In this case, the total aggregate signal can be considered as the response ab. Thereafter, this new response (ab) is updated using equation (9) same as done in case 1. Main factors (A and B) and their interaction (AB) are then estimated again using equations (2 to 4) using the new updated value of the response ab. - Case 3: when only three devices (say DA, DB and DC) are operating in the ON state. In this case the total aggregate signal can be considered as the response abc. Here, we are using the positive half fraction of the 23−1fractional factorial design. Using the defining relation (𝐼 = +𝐴𝐵𝐶), all possible combinations of the factorial design are as shown in Table 2 [10, 11]. The defining relation is the column used to divide the factorial design into two halves based on the plus and minus signs. A plus sign means that the factor is in the High state, which correspond to the ON state in our case of devices representations. Conversely, a minus sign means that the corresponding factor is in the Low or OFF state. Table 2. Plus (ON) and Minus (OFF) signs for the 𝟐 𝟑 Factorial Design Combination Factorial Effect A B C AB AC BC ABC a + - - - - + + b - + - - + - + c - - + + - - + 9 abc + + + + + + + ab + + - + - - - ac + - + - + - - bc - + + - - + - i - - - + + + - We have mainly used the positive half fraction (when ABC is positive) to help in the adaptive estimations of main factors A, B and C. We ignored the negative half fraction (when ABC is negative) since it is more likely we do not already know all estimates of the ab, ac and bc responses combinations. It is important to notice the aliasing between A and BC, B and AC and C and AB. It is said that two factors are aliased (or confounding) when an estimate of one of them already includes the influence of the other. In aliasing cases, we are able to observe the summation of the confounding factors whilst each cannot be observed individually. Hence, we can write these linear combinations of the aliased factors as follows [10, 11] 𝐿𝐴 = 1 2 (𝑎𝑏𝑐 + 𝑎 − 𝑏 − 𝑐) = 𝐴 + 𝐵𝐶 (11) 𝐿𝐵 = 1 2 (𝑎𝑏𝑐 + 𝑏 − 𝑎 − 𝑐) = 𝐵 + 𝐴𝐶 (12) 𝐿𝐶 = 1 2 (𝑎𝑏𝑐 + 𝑐 − 𝑏 − 𝑎) = 𝐶 + 𝐴𝐵 (13) We can utilize these relations to update the values of main factors A, B and C and two-way interactions, when possible. Here, we have two possible scenarios regarding any two-way interaction. First scenario happens when we do not have an estimate for a two-way interaction (the value is set at zero). Hence, we shall use the quantity of 𝐿𝐴, 𝐿𝐵 or 𝐿𝐶 as a new sample for the current estimate of the main factors A, B or C, respectively. Here, the main factor is updated with the new sample but the two-way interaction is kept at zero value. The second scenario happens when we already have an estimate for a two-way interaction. Here, we shall update both main factor effect and its aliasing two-way interaction using their corresponding ratios. For illustration, let us assume the case of factor A and its alias BC. We can obtain new samples for both from the value of 𝐿𝐴 as following: 𝐴 ′ = 𝐴̃ [ 𝐿𝐴 𝐴̃ + 𝐵𝐶̃ ] (14) 𝐵𝐶′ = 𝐵𝐶̃ [ 𝐿𝐴 𝐴̃ + 𝐵𝐶̃ ] (15) Where, 𝐿𝐴 represents the new measurement of 𝐴 + 𝐵𝐶, 𝐴̃ and 𝐵𝐶̃ are the current averaged values for the main factor 𝐴 and the interaction 𝐴𝐵, respectively. Thereafter, these new samples (𝐴′ and 𝐵𝐶′) can be used to update the corresponding main factor and two-way interaction using equation (9) like before for case 1. - Case 4: when only four devices (say DA, DB, DC and DD) are operating in the ON state. In this case the total aggregate signal can be considered as the response abcd. Here, we use the positive half fraction of the 24−1fractional factorial design and the defining relation (𝐼 = +𝐴𝐵𝐶𝐷). We ignored the negative half fraction since it is more likely we do not already know the included three-way responses combinations (abc, abd, acd and bcd). The full table and further information can be found in [10, 11]. In this design, main factors alias with three-way interactions (which are neglected in accordance with principal of sparsity) and two-way interactions alias with other two-way interactions. Table 3 shows only the portion of this 24−1 design which we have used to accomplish the updating process. Table 3 ignored three-way interactions as they are neglected. Table 3. Portion of the 𝟐 𝟒−𝟏 fractional factorial design Response A B AB C AC BC D AD BD CD ABCD i - - + - + + - + + + + 10 ab + + + - - - - - - + + ac + - - + + - - - + - + bc - + - + - + - + - - + ad + - - - - + + + - - + bd - + - - + - + - + - + cd - - + + - - + - - + + abcd + + + + + + + + + + + From Table 3, we can obtain new samples for main factors (A, B, C and D) to be used for updating the corresponding factor as in case 1. It is noticeable that some two-way responses (ab, ac, …, etc.) may not be already available. In this case, we shall use an estimated value. For example, an estimate for ab (if not available) can be found from 𝑎𝑏 ≈ 𝐴 + 𝐵 + 𝑖 (16) If an estimate ab is used rather than an observed ab response, then we are unable to estimate the value of the interaction AB and so on for other pairs. On the other hand, since each two-way interaction aliases with another two-way interaction, we are able to compute an instant of their summation as a confounded value. We are unable to find each alias of factors directly. In this design, we have AB aliases with CD, AC aliases with BD and AD aliases with BC. From Table 3, we can write the linear combination to illustrate the aliasing relations as follow 𝐿𝐴𝐵 = 1 4 (𝑎𝑏𝑐𝑑 + 𝑖 + 𝑎𝑏 + 𝑐𝑑 − 𝑎𝑐 − 𝑏𝑐 − 𝑎𝑑 − 𝑏𝑑) = 𝐴𝐵 + 𝐶𝐷 (17) 𝐿𝐴𝐶 = 1 4 (𝑎𝑏𝑐𝑑 + 𝑖 + +𝑎𝑐 + 𝑏𝑑 − 𝑎𝑏 − 𝑏𝑐 − 𝑎𝑑 − 𝑐𝑑) = 𝐴𝐶 + 𝐵𝐷 (18) 𝐿𝐴𝐷 = 1 4 (𝑎𝑏𝑐𝑑 + 𝑖 + 𝑎𝑑 + 𝑏𝑐 − 𝑎𝑏 − 𝑎𝑐 − 𝑏𝑑 − 𝑐𝑑) = 𝐴𝐷 + 𝐵𝐶 (19) We can update the values of two aliasing interactions only if we already know both from a previous measurement or estimation. To obtain the new sample for each interaction, we consider the example of the linear combination of 𝐿𝐴𝐵 for illustration purpose. New samples, hence, can be obtained from the following 𝐴𝐵′ = 𝐴𝐵̃ [ 𝐿𝐴𝐵 𝐴𝐵̃ + 𝐶𝐷̃ ] (20) 𝐶𝐷′ = 𝐶𝐷̃ [ 𝐿𝐴𝐵 𝐴𝐵̃ + 𝐶𝐷̃ ] (21) Where, 𝐿𝐴𝐵 represents the new measurement of 𝐴𝐵 + 𝐶𝐷, 𝐴𝐵̃ and 𝐶𝐷̃ are the current averaged values for the interactions 𝐴𝐵 and 𝐶𝐷, respectively. Thereafter, the new samples 𝐴𝐵′ and 𝐶𝐷′ can be used to update the two-way interactions 𝐴𝐵 and 𝐶𝐷 respectively same as explained in case 1. If one interaction of each linear combination is unknown, or both are unknown, then we are unable to update any of them due to insufficient information. Therefore, only main factors are updated in these two cases. - Case 5: when five or more devices are operating in the ON state. We have made no updating in this case since it is very unlikely to occur as shown in the results section. 4.3. Energy disaggregation algorithm with adaptive estimations of devices main factors effects and two-way interactions Our energy disaggregation approach can thus be summarized in the following four steps: - Step 1: using an initial portion of the aggregate total signal, models of devices were built and devices interactions were estimated, where it was possible. 11 - Step 2: the process of disaggregation was performed on the remaining part of the aggregate total signal. - Step 3: at every sample processed for disaggregation in step 2, the main factors effects and two- way interactions of operating devices were adaptively estimated following the methodology described in the subsection 4.2. - Step 4: accuracy of disaggregation was evaluated by comparing the resulting estimates to actual individual consumptions of devices available. That is, we check for how much of the consumed energy was assigned correctly to individual devices. The accuracy metric for each device j is given by 𝐴𝑐𝑐𝑗 = 1 − ∑ |𝑦̂𝑡(𝑗) − 𝑦𝑡(𝑗)| 𝑇 𝑡=1 2 ∑ 𝑦𝑡(𝑗) 𝑇 𝑡=1 (22) where 𝑦𝑡(𝑗) is the true power consumed at time t by device j, and 𝑦̂𝑡(𝑗) is the estimated power consumption at time t by device j and T is the time length of the sequence used for the disaggregation process. The factor of 2 in the denominator comes from the fact that the absolute value will “double count” errors [9, 20]. This metric is used in this paper as it gives a better evaluation in terms of how close the estimated energy consumed by a device is to its actual consumption. Energy disaggregation algorithms in the literature are also assessed by other different metrics such as those used in [5, 8 and 21]. 5. RESULTS We used the low frequency data measurements of house 2 available in the REDD public data set [9] to carry out and test the proposed approach. House 2 was used in order to better illustrate our approach as it includes nine devices which made it easier to investigate interactions per pair of devices. We have used a 9 samples median filter to eliminate outliers or very noisy points, so that processing steps can be performed with a lower possibility of false detections and estimations. Firstly, the base load was determined by observing the minimum level of consumed power in both mains 1 and mains 2 circuits. They were found to be as shown in Table 3. Table 4. Base load for mains 1 and mains 2 Circuit Mains 1 Mains 2 Base load (W) 15.7 22.8 The base loads here represent the response i in Table 1 when all devices to be detected are assumed to be in the OFF state. Although the base load could include devices that are always ON, we considered this as the response i because all significant devices to be detected are still in the OFF state. The always ON devices are lumped together to represent the response when all other significant devices (to be detected) are OFF. Using the disaggregation procedure described in subsection 4.3, the energy disaggregation was carried out. In step 1, models were built according to the detected devices in a two-day portion of aggregate data. Unseen or rarely used devices can be added during the disaggregation process (step 2). In step 1, we were able to estimate three interactions between corresponding observed devices and they are as shown in Table 5. Table 5. Estimated interactions between observed devices Device A Device B Interaction AB (W) Outlet 1 Outlet 2 -27.7 Outlet 2 Unknown (40 W) -12.5 Refrigerator Microwave -31.5 In step 2, the disaggregation task was performed on the measured total signal of one-day length sequences separately. Meanwhile, the estimated values of factors and their corresponding two-way interactions (step 3) were updated at every cycle of processing (every one sample of aggregate total signal). Since there could be wrong devices detections, we have restricted all adaptive estimations to be 12 done only in the case when the new sample value of the main factor or interaction is within ±20% deviation from the current value. For the data set, the time occupancy versus number of simultaneously ON devices in a given day was obtained and the results were found as shown in Table 6. These results give a good indication for cases that should be considered in the updating process as discussed in the subsection 4.2. For example, the likelihood that five devices or more are turned on simultaneously is very low. Table 6. Time occupancy versus number of ON devices Number of ON devices Average time occupancy in hours / day Percentage (%) Base load only 14.45 60.22% One device is ON 5.81 24.21% Two devices are ON 2.69 11.22% Three devices are ON 0.81 3.37% Four devices are ON 0.21 0.87% Five devices or more are ON 0.03 0.11% Total 24 hours 100% In step 4, comparisons of outcome estimates of power consumptions to actual consumptions per device was done to determine the disaggregation accuracy using our approach. The results are as tabulated and shown in Table 7. We have repeated the experiment three times, once considering the interactions in the Hidden Markov chains as in [12] and another by ignoring them (setting to zero) as in the standard FHMM. A third run was by considering interactions and performing all possible adaptive estimations. Table 7. Disaggregation accuracy for each device Device FHMM (without interactions) FHMM (with interactions) FHMM (with interactions and adaptive estimations) Microwave 54.26% 57.29% 58.61% Outlet 2 78.66% 81.40% 85.83% Refrigerator 64.11% 64.57% 66.41% Outlet 1 68.66% 68.80% 65.89% Washer dryer 77.26% 77.26% 87.37% Lights 51.62% 51.66% 52.43% Stove 81.56% 81.56% 80.66% 6. DISCUSSIONS The addition of the interaction property chains to the FHMM in our proposed approach considers the behavior of a device when there are other devices operating in the background. The proposed model showed an improvement in the disaggregation accuracy whenever a mutual interaction between two devices was observed and estimated. Moreover, the adaptive estimation step gives improved accuracy for almost all devices except for the stove and outlet 1. In step 1 of the proposed disaggregation procedure described in subsection 4.3, we were able to observe and estimate a limited number of interactions. This is because to estimate an interaction between two devices, we must be able to observe each device operating alone in different time instants, in addition to observing when both are operating simultaneously. In reality, each pair of devices could interact, either with small or significant amount. Whenever we are able to estimate the interactions, they will help to improve the accuracy of disaggregation process as illustrated in our example with an actual household data set as shown in Table 7. The transition of the unknown device in Table 5 was detected but we were unable to match with any of known devices in the household. It could belong to an unmeasured device since all other devices have no such transition in their consumptions at the same time instant. Hence, it was given a generic unknown device name. From the disaggregation results, it can be seen that embedding devices interactions characteristics to the FHMM improved the disaggregation accuracy for a set of devices such as the microwave, 13 refrigerator, outlet 1 and outlet 2. No significant improvement was obtained for the rest of other devices as no interaction was observed from the set of measured data for these devices. This showed that energy consumption was assigned more accurately to devices with known interaction properties. It is observed that either we embed interaction chains to FHMM or not, devices with unknown mutual interactions were not significantly affected in terms of the disaggregation accuracy. The continuous adaptive estimation process for main factors and interactions of operating devices, where applicable, has improved the outcomes accuracy for almost all present devices except for the stove and outlet 1. From Table 6, it can be seen that considering the updating process when four devices or less are ON simultaneously is reasonable. Observing five devices or more to operate at the same time was found to be rare in this case study on a typical household from the REDD data set. The adaptive estimation step, which was done within the disaggregation step 3, enabled the process to follow up and mimic the changes of devices power consumption levels. In doing so, the desired goal of being closer in estimating the assigned energy for each device to actual values in different consumption levels and various combinations of operating devices may be achieved. From Table 7, it was found that updating the primary power consumption (main factor effect), even when no interaction information is available, may provide a good enhancement in the disaggregation accuracy as in the case of the washer dryer. The lights are taken as a lumped model but they are actually several distributed independent light bulbs as can be seen from the individual consumption of the public data. This resulted in a poor modeling of lights in step 1 described in the subsection 4.3. This may explain the low disaggregation accuracy results even in the considered basic FHMM. The disaggregation accuracy obtained for the stove and outlet 1 is not better than those obtained in case of no adaptive estimation process was considered. This could happen since there are still some errors in devices detections or energy consumption assignments. These errors could have accumulated and contributed to the results obtained. From the individual consumption data of outlet 1, we observed that it sometimes consumed different amounts of power as it is possible to have more than one device (or a multi-state device) connected to outlet 1. Also, it showed a low power consumption state (about 15 W) for some periods, which is undetectable by our approach but could affect the adaptive estimation process. The adaptive estimations process is affected by small transitions because the measured total consumptions always play a role in the adaptive estimations process as clarified in the subsection 4.2. The stove was observed in operations only in day 2 and day 7 of the disaggregation period. The drop in the disaggregation accuracy for the stove is because there was a smooth gradual transitions (instead of clear or sharp transition) that happened in day 2 of the disaggregation period and this is not detectable by our algorithm. This type of smooth transitions over noticeable rising time requires different modeling and detection methods such as the non-event based supervised learning algorithms [19]. Two other devices in house 2, the dishwasher and the disposal, were not shown in Table 7. From the individual power consumption data in REDD, it was observed that the dishwasher operated only once during the entire two-week period when data was collected. This may be sufficient to build a model but the device was not used again for the rest of the two-week period for detection by our proposed disaggregation algorithm. The disposal consumed varying powers over the period of data collection and such device is not able to be detected by our proposed algorithm. We also investigated the computational complexity of the proposed adaptive estimations approach. We have applied our method on one-day sequences of samples using Matlab 2013a installed on a PC with Intel Core i5 3230M dual CPU 2.60 GHz and 4.00 GB of RAM. The average simulation and execution time increased from 13.1 s (without adaptive estimations) to 15.4 s (with adaptive estimations). We feel that this is acceptable with the improved accuracy gained from the adaptive approach. As in many other proposed approaches [4], we are still unable to detect or classify continuously variable devices. Only single state or FSM devices can be disaggregated by our approach. Since unsupervised approaches result in unlabeled groups, manual matching of the devices was performed at the end of the process. 7. CONCLUSION 14 The property of devices interactions was estimated and embedded in a FHMM representation to improve energy disaggregation accuracy. Although devices interactions would mean low power quality in their design or in electricity network components, we utilized this characteristic to further enhance the energy disaggregation. A further step of main factors and interactions adaptive estimations was introduced in this paper in the disaggregation process. The new approach was tested in a selected home from available public data. Models were first built and possible interactions were observed from a portion of aggregate total signal. Then, the disaggregation process was performed on the remaining portion. Meanwhile during the disaggregation process, main factors and interactions of operating devices were adaptively estimated to give closer estimations of the consumed power per individual device. It was found that devices with known mutual interactions were detected with higher accuracy than those with unknown interactions. The new model helped in assigning consumed energy to devices more accurately. Moreover, the addition of main factors and interactions adaptive estimation step was able, for most of devices, to enhance the results in terms of disaggregation accuracy. For future work, we suggest to test the proposed methods in more houses to gain a better degree of confidence and validation. 8. ACKNOWLEDGMENT The authors would like to acknowledge the Singapore International Graduate Award (SINGA) for the support in carrying out this work. 9. REFERENCES [1] O. Parson, S. Ghosh, M. Weal and A. Roger, An unsupervised training method for non-intrusive appliance load monitoring, Artificial Intelligence 217, 2014, pages 1-19. [2] G. Hart, Non-intrusive appliance load monitoring, Proceedings of the IEEE 12 (80) 1992, pages 1870-1891. [3] A. Zoha, A. Gluhak, M. Imran and S. Rajasegara, Non-intrusive load monitoring approaches for disaggregated energy sensing: a survey, Sensors 12, 2012, pages 16838-16866. [4] M. Zeifman and K. Roth, Non-intrusive appliance load monitoring: review and outlook, IEEE Transactions on Consumer Electronics, Vol. 57, No. 1, Feb. 2011. [5] H. Kim, M. Marwah, M. Arlitt, G. Lyon and J. Han, Unsupervised disaggregation of low frequency power measurements, SIAM International Conference on Data Mining (SDM), 2010, pages 747-758. [6] J. Kolter and T. Jaakkola, Approximate inference in additive factorial HMMs with application to energy disaggregation, International Conference on Artificial Intelligence and Statistics (AISTATS) 2012, pages 1472-1482. [7] Z. Ghahramani and M. Jordan, Factorial Hidden Markov Models, Machine Learning 27, 1997, pages 245-273. [8] O. Parson, Unsupervised training methods for non-intrusive appliance load monitoring from smart meter data, PhD thesis, University of Southampton, UK, April 2014. [9] J. Kolter and M. Johnson, REDD: A public data set for energy disaggregation research, SustKDD 2011, San Diego, CA, USA. [10] D. Montgomery, Design and analysis of experiments, fifth edition, 2001, John Wiley and Sons, Inc. [11] D. Montgomery and G. Runger, Applied statistics and probability for engineers, fifth edition, 2011, John Wiley and Sons, Inc. [12] M. Aiad, P. H. Lee, Unsupervised approach for load disaggregation with devices interactions, Energy and Buildings 116, 2016, pages 96-103. [13] S. Bhattacharyya, J.M.A. Myrzik and W.L. Kling, Consequences of poor power quality – an overview, Universities Power Engineering Conference UPEC, 2007, pages 651 - 656. [14] Aurora Gil-de-Castro, Sarah K. Rönnberg, Math H. J. Bollen, A study about harmonic interaction between devices, IEEE 16th International Conference on Harmonics and Quality of Power (ICHQP), 2014, pages 728-732. [15] Aurora Gil-de-Castro, Sarah K. Rönnberg, Math H.J. Bollen, Antonio Moreno-Muñoz, Study on harmonic emission of domestic equipment combined with different types of lighting”, Electrical Power and Energy Systems 55, 2014, pages 116-127. 15 [16] A. Pavas, Statistical analysis of power quality disturbances propagation by means of the method of disturbances interaction, 3rd IEEE PES Innovative Smart Grid Technologies Europe (ISGT Europe), 2012, Berlin. [17] Michael I. Jordan, Zoubin Ghahramani, Tommi S. Jaakkola, Lawrence K. Saul, An Introduction to Variational Methods for Graphical Models, a chapter in: Learning in graphical models, 1998, pages 105-161. [18] C. Bishop, Pattern Recognition and Machine Learning, 2006, Springer-Verlag New York, Inc. Secaucus, NJ, USA. [19] S. Barker, Model-driven analytics of energy meter data in smart homes, PhD thesis, University of Massachusetts Amherst, June 2014. [20] M. Johnson and A. Wilsky, Bayesian nonparametric Hidden Semi-Markov Models, Journal of Machine Learning Research 14, 2013, pages 673-701. [21] J. Liang, S. K. K. Ng, G. Kendall, J. W. M. Cheng, Load signature study—Part I: Basic concept, structure and methodology, IEEE Transactions on Power Delivery, vol. 25, pp. 551-560, 2010. View publication statsView publication stats","libVersion":"0.3.1","langs":""}