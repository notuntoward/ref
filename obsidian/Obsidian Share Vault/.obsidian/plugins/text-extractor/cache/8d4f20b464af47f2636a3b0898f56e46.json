{"path":"lit/sources/papers_added/papers/Munkhammar17AutocorrelationbasedCopulaModel.pdf","text":"See discussions, st ats, and author pr ofiles f or this public ation at : https://www .r ese ar chg at e.ne t /public ation/319986980 An autocorrelation-based copula model for generating realistic clear-sky index time-series Article    in    Solar Ener g y · Sept ember 2017 DOI: 10.1016/ j.solener.2017.09.028 CIT A TIONS 13 READS 502 2 author s: Some o f the author s o f this public ation ar e also w orking on these r elat ed pr ojects: Syst em Eff ects of Impr o v ed Ener g y Efficienc y in Sw edish District -He at ed Buildings V ie w pr oject Solar ener g y on hist oric al buildings V ie w pr oject Jo akim Munkhammar Uppsala Univ er sity 91 PUBLICA TIONS     1,206 CIT A TIONS     SEE PROFILE Jo akim Widén Uppsala Univ er sity 139 PUBLICA TIONS     4,026 CIT A TIONS     SEE PROFILE All c ont ent f ollo wing this p ag e w as uplo aded b y Jo akim Munkhammar on 17 Dec ember 2018. The user has r equest ed enhanc ement of the do wnlo aded file. An autocorrelation-based copula model for generating realistic clear-sky index time-series Joakim Munkhammara , Joakim Wid´enb (a) (Corresponding author) Built Environment Energy Systems Group, Department of Engineering Sciences, Uppsala University, SE- 751 21 Uppsala, Sweden. e-mail: joakim.munkhammar@angstrom.uu.se, phone: +46704464271 (b) Built Environment Energy Systems Group, Department of Engineering Sciences, Uppsala University, SE- 751 21 Uppsala, Sweden. e-mail: joakim.widen@angstrom.uu.se Abstract This study presents a method for using copulas to model the temporal variability of the clear-sky index, which in turn can be used to produce realistic time- series of photovoltaic power generation. The method utilizes the autocorrelation function of a clear-sky index time-series, and based on that a correlation matrix is set up for the dependency between clear-sky indices at N time-steps. With the use of this correlation matrix an N -dimensional copula function is conﬁgured so that correlated samples for these N time-steps can be obtained. Results from the copula model are compared with the original data set and an uncorrelated model based on zero correlated clear-sky index data in terms of distribution, autocorrelation, step changes and distribution. The copula model is shown to be superior to the uncorrelated model in these aspects. The copula model is also applied to a set of bins of daily mean clear-sky index and the use of bins is shown to improve the results. Keywords: Clear-sky index, autocorrelation function, copula modeling, probability distribution modeling. 1. Introduction The variability of solar irradiance on Earth’s surface has an eﬀect on many solar engineering applications, in particular those involving photovoltaic (PV) power generation [1, 2, 3]. By quantifying the solar irradiance variability, it is possible to improve the design and operation of power systems where large amounts of distributed PV power might be injected into the grid [1, 3]. This is useful in order to avoid costly grid reinforcements [1, 4]. Solar irradiance, normalized via the clear-sky irradiance to the clear-sky index, has interesting variability on minute to instantaneous scale [5] and for such resolution the clear-sky index distribution can be modeled as a probability Preprint submitted to Solar Energy August 7, 2017 distribution with typically two or three peaks [6, 7, 8, 9]. Studies on clear- sky index ramp rates, and general temporal variability, include Markov-chain modeling [5], neural network modeling [10] and pure sampling from probability distributions [8, 11]. Models vary in terms of input data complexity from uti- lizing cloud size, coverage and morphology [5] to analysis of the clear-sky index time-series [8, 11, 12]. A challenge is to not only obtain an accurate probability distribution, but to obtain a realistic synthetic time-series of the clear-sky index as well [13]. In terms of time-series realism, autocorrelation is a useful measure. Auto- correlation of the clear-sky index has been studied previously for instantaneous irradiance [14, 15, 16, 17] and for step-changes as well [17], where the autocor- relation function is positive and follows an exponential slope for hour resolution [15, 16, 18], while it has also shown negative values for minute resolution [17, 19]. Models utilizing the autocorrelation of the clear-sky index include Gaussian- Markov [14], auto-regressive Gaussian [16], neural networks [10] and fractal cloud modeling [20]. So-called clear-sky index generators are useful, since they use some existing data set of, e.g., lower resolution or averaged clear-sky index data to estimate higher resolution data (temporal or spatial), see e.g. [13, 21]. Autocorrelation functions of clear-sky index step changes have also been used in so-called virtual networks to study the variability of spatially distributed ﬂeets of photovoltaic plants, see [3]. This indicates that the autocorrelation function might be useful for both temporal and spatial solar irradiance studies. Regarding spatial solar irradiance variability, copulas have been used to model the variability of solar irradiance in a spatial network [12, 22]. Copula modeling is an increasingly common method for modeling correlation between stochastic variables [23], which has been used in studies of wind power [24], wave power [25] and spatial solar irradiance variability [12, 22]. This study develops an autocorrelation-based copula model for generating synthetic clear-sky index data, including the development of a model for gener- ating synthetic clear-sky index data for binned daily mean clear-sky index levels. A copula based-model for quantifying the temporal variability of the clear-sky index on binned daily mean clear-sky index has not been done previously. This study continues the work on correlation modeling of the clear-sky index in [26] and [12, 22], where the latter two studies presented models on spatial variabil- ity in the clear-sky index by using copulas and a spatiotemporal data set of the clear-sky index. If spatial modeling of solar irradiance is modeled under vir- tual network assumptions, generated from temporally shifted time-series based on cloud advection velocity, this model could also directly be used for spatial irradiance variability studies. This paper is organized as follows. In Section 2 the methodology and data are presented, in Section 3 the results are presented and in Section 4 the results are discussed in a wider context. 2 2. Methodology The methodology is organized so that the clear-sky index and the main method is presented in Section 2.1, the formal modeling in Section 2.2, the goodness-of-ﬁt statistic used in this study is presented in Section 2.3 and the data set is presented in Section 2.4. 2.1. The clear-sky index In order to focus on the temporal variability of instantaneous solar irradiance the clear-sky index is used. Formally, the clear-sky index κ is deﬁned as the ratio between the measured global horizontal irradiance (GHI) G(t) and the estimated global horizontal clear-sky irradiance Gc(t) over time t: κ(t) ≡ G(t) Gc(t) . (1) The temporal copula model developed in this paper is based on the assumption that the clear-sky index is not dependent on time of day or season. Generally, throughout this study, it is assumed that the time-series of the clear-sky index is approximately stationary, a property of time-series which means that the joint probability distribution of a set of equivalently separated data points in a time-series does not change over time [27]. Since the clear-sky index is primarily deﬁned only during daytime, when Gc(t) > 0, there is a maximum length of each daily vector of consecutive points of the clear-sky index. In order to have suﬃcient data for modeling this prompts the use of clear-sky index for a number of days, each with the same length vector. Based on the assumption that the clear-sky index time-series for each day is stationary and a data set of clear-sky index for a number of days is available, the main model of the paper is based on the following algorithmic steps. 1. Obtain a clear-sky index data set for N data points on M days, thus generating an N × M data set. 2. Estimate the autocorrelation function of the clear-sky index for each day, generating a data set of size N × M . 3. Compute the mean autocorrelation function, for N steps, over all M days, generating a vector of the mean autocorrelation function of size N . 4. Deﬁne a correlation matrix, of size N × N , from the N mean autocorre- lation function values. 5. Deﬁne a copula based on the empirical distribution of the clear-sky index data set for N data points on all M days and the autocorrelation-based correlation matrix. 6. Generate, with the copula model, M number of synthetic correlated clear- sky index time-series with N data points each. 3 The concepts of these steps will be clariﬁed, in a formal sense, in the following section. The proposed copula model is validated by comparing the synthetic copula-generated data sets with: • Original clear-sky index data set of daily time-series. (The data set) • Generated uncorrelated daily data sets of clear-sky index time-series. (The uncorrelated model) The latter of these, the generated uncorrelated clear-sky index time-series, is the special case of the copula model with zero autocorrelation for non-zero lag, rendering the correlation matrix an identity matrix. This model is equivalent to a model of random sampling of the clear-sky index probability distribution and will generally be called the uncorrelated model in this study, since it lacks temporal correlation, which makes it equivalent to conventional probability dis- tribution clear-sky index models (similar to the models used in e.g. [7, 8]). In spatial correlation modeling the uncorrelated model was studied in for example [12]. In addition to applying the copula model to mean autocorrelation function over all days (in step 3) a copula model is made for each bin of daily mean clear-sky index as well. The daily mean clear-sky index (calculated for the N = 120 data points for each day) was binned in ﬁve bins equally separated on the interval [0, 1]. Then a mean autocorrelation function for the clear-sky index was obtained for all days within each bin. The algorithmic steps were then performed for each binned data set. In terms of machine learning it is customary to divide up training and testing data sets. This was tested and proved to have little eﬀect on this study, it only gave a shorter sample of days to use for both training and testing (and thus mainly higher variability when comparing results). 2.2. Temporal copula modeling of the clear-sky index This section describes the formal copula modeling of the clear-sky index time-series. It is introduced for the general case along with how the modeling is applied to the clear-sky index in this study. Copula modeling is a statistical framework based on the concept that corre- lated samples from a given number of stochastic variables, which have a depen- dency that is reﬂected in the correlation between variables, can be modeled via a so-called copula. The idea is that the joint distribution function of the variables can be expressed by a copula joining the univariate marginal distributions. An N -variable copula is used in this paper, and it models the dependency between N stochastic variables by generating sets of N correlated values for each stochastic variable based on their marginal distribution. For this paper the distributions are all of the same type: each is the empirical clear-sky index distribution (from the entire data set). Formally, it is common to use the so-called inversion method for sampling values from a copula and marginal distributions, this is also used in this paper. 4 This method is brieﬂy deﬁned as follows [23, p.51], with comments on how it is applied in this study. Assume N stochastic variables X1, X2, ..., XN with given cumulative dis- tribution functions (CDFs) FX1, FX2, ..., FXN . In this case X1 represents the stochastic variable of one single time-step, and X2 the stochastic variable of another time-step, etc. The main point is to model the dependency between temporally separated time-steps in a time-series, and that this variability is universal for any set of such points in the time-series, since the time-series is considered approximately stationary. N = 120 consecutive data points (a se- ries) are modeled in this study. There is, however, in principle no requirement of the model for using consecutive time-steps. Based on this setup, if we recall Sklar’s theorem, which certiﬁes the existence of a copula, see [23], these distributions can be joined via a copula C if the copula can be expressed as: FX1,X2,...,XN (X1, X2, ..., XN ) = (2) C(FX1 (x1), FX2(x2), ..., FXN (xN )). (3) The copula function can be written: C(u1, u2, ..., uN ) = (4) FX1,X2,...,XN (F −1 X1 (u1), F −1 X2 (u2), ..., F −1 XN (uN )). (5) for FXi(xi) = ui, i = 1, 2, ..., N , where u1, u2, ..., uN are realizations of uniform variables U1, U2, ..., UN . A special case is a copula with two stochastic variables X1 and X2: a bivariate copula. Such a copula would, in this study, correspond to modeling the dependency between a single pair of time-steps, and be represented by a copula function C: C(u1, u2) = FX1,X2(F −1 X1 (u1), F −1 X2 (u2)). (6) The key to setting up a copula function is to have a correlation matrix which expresses the correlation between the stochastic variables. Such a matrix is by necessity square. In this case, the correlation matrix is generated from a time-series of the clear-sky index with N data points. This correlation matrix is based on the mean autocorrelation function of the clear-sky index, over all days, according to step 3 in the algorithm. For the binned scenarios, the mean autocorrelation of the binned days is used instead. In formal terms the autocorrelation function for n steps can be deﬁned as A(n) for a lag of n steps (n = 0 represents zero-lag autocorrelation). For a data set with N number of data points yi, mean value ¯y and standard deviation σ the autocorrelation function A(n) for lag n is deﬁned as [28]: A(n) = 1 σN N −n∑ t=0 (yt − ¯y)(yt−n − ¯y). (7) 5 ρ 1N , ρ N1 ρ 13 , ρ 31 ρ 23 , ρ 32 ρ 2N , ρ N2 ρ 3N , ρ N3 ρ 12 , ρ 21 κ 1 CSI (κ t) at time t Correlations κ 2 κ 3 κ N Clear-sky index data Copula model Correlated time-series Uncorrelated time-series Comparison and evaluation Copula model Figure 1: An illustration of the copula-based autocorrelation method developed in this study. On the left the process of the modeling is presented and on the right the autocorrelation modeling concept is presented. Elements of the correlation matrix ρ are obtained from the autocorrelation function of the clear-sky index. It should be noted that estimates of the autocorrelation function are only rea- sonable for n up to approximately N/4, see [28, p.31]. In this study the auto- correlation function is used up to and including n = N in the modeling, but the interpretation of the results might only be reasonable up to N/4. The temporal correlation matrix in this study, incorporating the correlation between the set of consecutive time-steps, becomes an autocorrelation matrix with elements based on A(n), deﬁned according to [29]: ρ =      A(0) A(1) · · · A(n − 1) A(1) A(0) · · · A(n − 2) ... ... . . . ... A(n − 1) A(n − 2) · · · A(0)  | | |  , (8) which is symmetric, with elements A(0) = 1. This matrix is used as correlation matrix in copula-modeling, see [12, 22] for more information relating to the clear- sky index application. See Fig. 1 for a schematic illustration of the modeling and the proposed autocorrelation concept. The next key step in copula modeling is the choice of distribution for each stochastic variable to be correlated by the copula. In this case the empirical distribution of the clear-sky index (for all days and all time-steps of the data set) is chosen. For the binned scenarios, the empirical distribution of the clear-sky index for the binned days was used. The copula itself is based on a separate distribution, the type of which has to be set a priori in the modeling, but since this is the ﬁrst study of its kind, by temporally modeling the clear-sky index, the commonly used normal distribution, i.e. Gaussian copula, conﬁguration was chosen. The copula modeling with input data set of binned daily clear-sky index values works equivalent to the case with the whole year clear-sky index data, only reduced amounts of data are used. 6 Table 1: Daily clear-sky index interval, number of days and number of data points for the binned scenarios. Daily mean CSI Days Data points 0 < CSI < 2 46 5’520 0.2 < CSI < 0.4 82 9’840 0.4 < CSI < 0.6 52 6’240 0.6 < CSI < 0.8 62 7’440 0.8 < CSI < 1.0 51 6’120 The model developed in this paper was implemented in MATLAB, and the functions autocorr for the autocorrelation function, and copularnd for the copula random number generator, were used. 2.3. Kolmogorov-Smirnov goodness-of-ﬁt test statistic In this study the Kolmogorov-Smirnov (K-S) test statistic was used to deter- mine probability distribution goodness-of-ﬁt. This is a commonly used estimate to quantify the similarity between two probability distributions. The test statis- tic S is based on the maximum deviation between two distributions [30]: S = max x |F1(x) − F2(x)| (9) where F1(x) and F2(x) are empirical (or analytical) cumulative distribution functions. Here K-S test statistics are used to estimate the goodness-of-ﬁt for the resulting aggregate clear-sky index distributions from data and simulations. This type of measure has been used in previous studies as well, for example in probability distribution modeling [8] and power generation and grid interaction [11]. For this study the Matlab function kstest2 was used. 2.4. Data set The data used for this study is based on radiometer measurements of global horizontal irradiance for one year (2008) obtained from the Swedish Meteoro- logical and Hydrological Institute (SMHI) for Norrk¨oping, Sweden (59◦35 ′31” N 17 ◦11′8” E) [31]. The clear-sky index was calculated with estimates of the clear-sky irradiance, obtained from the Ineichen-Perez model [32]. In order to avoid low solar angles, while maintaining the same amount of time-step data per day (a necessity of the model), 120 data points (minutes) per day (centered around noon each day) were used. This totals 43’800 (120 × 365) data points of clear-sky index data, which generates a 120 × 120 autocorrelation matrix. The simulations of the models were also set to generate 120 × 365 = 43′800 data points. In the simulations for binned data the binned number of data points was used in the simulations, see Table 1. 7 3. Results In Fig. 2 the distribution, autocorrelation function and step-change distri- bution for the clear-sky index data set, the copula model simulation and the uncorrelated model simulation are presented. As a check for consistency in the modeling, the clear-sky index generated by the models should be similar com- pared with the original data set, which appears to be the case when inspecting the histograms of the original data set and 43’800 simulated data points from each model, presented in subplots (A)-(C). In subplot (D) the copula model is shown to follow the autocorrelation function closely, in particular when com- pared with the uncorrelated model. The discrepancy between the input (data set) and the output (copula model) autocorrelation is some artifact of the cop- ula modeling, probably because the linear autocorrelation as deﬁned in Eq. 7 is not preserved during inverse sampling, which could be diﬀerent if rank corre- lations were used instead. This is left as an open issue for further investigation. Subplots (E-G) represent step-changes, and the copula model (F) is closer to the data set for step-changes compared with the uncorrelated model (G). In terms of relative K-S test statistics, deﬁned here as the ratio of K-S test statistics, the ratio of the test statistic of uncorrelated model output to the data set and correlated output to the data set is 1.94. Thus, in the K-S test statistic measure, the copula model has a near factor 2 improvement on this measure compared with the uncorrelated model. In Fig. 3 the mean autocorrelation function for the data set and for the copula model output is given along with the autocorrelation function for N data points on each of the 365 days in the data set. Results show that the copula model appears to capture the autocorrelation features of the clear-sky index, while the uncorrelated model is less accurate. Despite the completely uncorrelated time-series generated by the uncorrelated model, there is a span of non-zero autocorrelation functions for each day evident in the ﬁgure. This is an artefact of applying the autocorrelation function to the 120 generated points of each day, since this will cause daily variability of the autocorrelation function due to random ﬂuctuations, which on average is zero. That is, 120 randomly sampled data points will make for a form of random autocorrelation function, which creates a unique autocorrelation function each day, which accumulates a span of autocorrelation functions over all days that on average is zero. It is interesting that the mean autocorrelation function for both the data set and the copula model show negative values. It should be noted that, as was mentioned in Section 2.2, the autocorrelation function of a data set of N points is only reasonable up to about n = N/4, which in this case becomes n = 30. However, the mean autocorrelation is negative even at n = 30. Negative values of the autocorrelation function has been obseved, in e.g. [19]. More studies on the autocorrelation of the clear-sky index, for various time-scales and even spatial dispersion (under assumption of the validity virtual network modeling), could assist in determining this. The sorted (ascending) mean clear-sky index level each day (each 120 point data set) can be seen in Fig. 4 for the data set, the copula model simulation and 8 Figure 2: Subplots (A-C) represent histograms of the clear-sky index, for (A) the data set, (B) the copula model simulation and (C) the uncorrelated model simulation. Subplot (D) represents the autocorrelation function for the data set and the two model simulations. Subplots (E-G) represent histograms of step changes of (E) the data set, (F) the copula model simulation and (G) the uncorrelated model simulation. 9 Figure 3: The autocorrelation function over time for each day for (A) the data set, (B) the copula simulation and (C) the uncorrelated model. The red line in each subplot represents the mean autocorrelation function for each minute over all the 365 days measured and simulated data. 10 0 50 100 150 200 250 300 350 Days 0 0.2 0.4 0.6 0.8 1 1.2Sorted mean CSI Data Copula model Uncorr. model Figure 4: Sorted (ascending) daily mean (over 120 data points) clear-sky index for the data set, the copula model simulation and the uncorrelated model sim- ulation. the uncorrelated model simulation. Although the copula model yields a result that is closer to the data set than the uncorrelated model the copula model does not entirely capture the variability in daily mean clear-sky index. It shows that although the copula generated model simulation closely represents the clear-sky index data set in terms of mean autocorrelation and variability, as seen in Fig. 3, this variability is restricted to each day and not spread out over days with diﬀerent mean clear-sky index, as in the original data set. As an attempt to improve this result, copula modeling of bins of mean daily clear-sky irradiance was carried out. 3.1. Binned daily clear-sky index model In this section we will present results for modeling the clear-sky index for a set of bins of daily mean clear-sky index levels. See Table 1 for a list of bins, number of days and the number of data points for each bin. In subplots (A-E) in Figure 5 the clear-sky index distribution for each bin of mean clear-sky index is presented for both the data set and the copula model, and in subplot (F) a diagram of K-S test statistics for each bin is presented (be- tween data set and model). By visual inspection the probability distributions are similar to the data set, which is further veriﬁed by the K-S test statistics, where all models are below 0.05 in K-S test statistic. These distributions also ﬁt well with previous investigations, such as [9], regarding other data sets of solar irradiance. See [9] for more information on the probability distribution characteristics of the clear-sky index for these particular bins. One particular discrepancy between the copula model and the data set is the general model over-estimation for zero level clear-sky index. The reason for this is likely re- lated to the approximation of using a copula to model the dependency. The 11 Figure 5: Histograms of the data set and from simulations of the copula model in each bin of daily clear-sky index in subplots (A-E) and a K-S test statistic in subplot (F). use of diﬀerent copula distribution or rank correlations could be interesting to investigate further. In Figure 6 the autocorrelation function for each binned data set and for the copula model is shown. The mean autocorrelation function for each bin show a similar slope with some smaller variations, all slopes include negative values. The autocorrelation function shape appears to be essentially universal regard- less of mean clear-sky index level, indicated by both data and model. These represent data for 46 days (the smallest available binned data set number was used for all), which means that there could be additional features in the auto- correlation for larger data sets. In similarity with the mean autocorrelation plot in Figure 3, only autocorrelation up to N/4 (for N being the total number of autocorrelation steps), can be considered statistically reliable, still at 30 points most autocorrelation functions of binned data show negative values. By visual inspection the autocorrelation functions of the copula model ﬁts the autocor- relation function of the data sets, with an apparent model underestimate in correlation for lower number of minutes lag and an overestimate in correlation for larger number of minutes lag. The sorted mean daily mean clear-sky index for diﬀerent clear-sky index bins is shown in Figure 7. In comparison with Figure 4, which presented the sorted daily mean clear-sky index for the whole data set and the copula model, the sorted mean daily clear-sky for each bin is considerably improved for each bin. The number of days chosen for each bin was again the same as for the bin with the lowest number of days (46), see Table 1. In order to show the output of the model, in terms of clear-sky index, a set of six consecutive 120-minute consecutive time-series sessions of clear-sky index 12 0 50 100 Minutes -0.2 0 0.2 0.4 0.6 0.8 1Autocorrelation (A) Data set Copula model 0<CSI<0.2 0 50 100 Minutes -0.2 0 0.2 0.4 0.6 0.8 1Autocorrelation (B) Data set Copula model 0.2<CSI<0.4 0 50 100 Minutes -0.2 0 0.2 0.4 0.6 0.8 1Autocorrelation (C) Data set Copula model 0.4<CSI<0.6 0 50 100 Minutes -0.2 0 0.2 0.4 0.6 0.8 1Autocorrelation (D) Data set Copula model 0.6<CSI<0.8 0 50 100 Minutes -0.2 0 0.2 0.4 0.6 0.8 1Autocorrelation (E) Data set Copula model 0.8<CSI<1.0 Figure 6: The autocorrelation function for the data set and simulations with the copula model for each bin of daily clear-sky index in subplots (A-E). 13 5 10 15 20 25 30 35 40 45 Days 0 0.2 0.4 0.6 0.8 1Sorted mean CSI Data set Copula model 0.0<CSI<0.2 0.2<CSI<0.4 0.4<CSI<0.6 0.6<CSI<0.8 0.8<CSI<1.0 Figure 7: Sorted daily mean clear-sky index for the data set and the copula model for each bin. 14 0 100 200 300 400 500 600 700 Minutes 0 0.5 1 1.5CSI Uncorr. model Copula model Data set Figure 8: Two hour sessions of clear-sky index from the data set, correspondingly binned copula model simulations and uncorrelated simulations (without bins). Each two hour session is separated with a vertical black line. is given in Figure 8. In this case the data set for each session is chosen from a random day of clear-sky index and the mean clear-sky index of that day was used in the copula model to generate bin-speciﬁc synthetic clear-sky index data to match that. This is also compared with the output of the uncorrelated model. The variability of the clear-sky index generated by the copula model reproduces the original data set, at least to a higher degree than the uncorrelated model, especially 120-240, 360-480, 480-600 and 600-720 minutes sessions. However, the variability does not always match the data set properly. Spikes can be mismatching for example, as shown in the 240-360 minutes session. Also, the 1-120 minutes session shows essentially clear sky conditions in the data set, which has low variability in clear-sky index, whereas the copula model shows considerably more variability here. This is because the variability is determined from each bin, having a mean CSI between 0.8 and 1 in this case. This means that it is possible that it represents the low-variability CSI level, but it might as well be that of a broken cloud day, as in this example. How this might be improved is not known to the authors and left for future investigation. As an application example, the solar irradiance of day 134 (partly cloudy) in the data set is presented together with copula model simulations in Figure 9. 15 Figure 9: Example of clear-sky index for day 134 in the data set compared with simulated binned data from copula model simulations in terms of power in subplot (A) and energy in subplot (B). The coloring of data in subplot (B) is based on one color for the data set and one color for the copula model simulations and an overlapping color. The copula model simulation is based on known mean clear-sky index (known bin) for each 120-minute session. The data set for solar irradiance is shown in subplot (A) along with estimated clear-sky irradiance weighed with the clear- sky index from the copula model (for each two hour bin) and a subplot (B) which shows the total mean irradiance per hour (in terms of kWh/h). The data on solar irradiance is reproduced by the copula model simulations, with some inherent smaller diﬀerence in variability. One typical discrepancy is the over-representation of zero clear-sky index levels in the model, which was also discussed regarding Figure 5. As the model is run, selecting a binned copula model for the mean clear- sky index level, the variability in total irradiance varies, and the variability is inherent to the bin width (here 0.2 clear-sky index points). A larger data set and more narrow bin width could possibly help bring higher accuracy in this modeling. 16 4. Discussion This paper presented a general method for using copulas to model the tem- poral variability, and to produce a realistic time-series, of the clear-sky index. Results show that the copula model simulation produces a clear-sky index time- series which, in terms of step-changes, autocorrelation and daily mean clear-sky index variability shows superior realism, compared to the uncorrelated model simulations. A copula model for diﬀerent daily clear-sky index bins was also pre- sented, and it was shown to be more accurate than the model without binned mean clear-sky index data. The method is useful for generating realistic synthetic clear-sky index time- series, which in turn, with the aid of an appropriate photovoltaic power gen- eration model can be used to generate realistic synthetic photovoltaic power generation time-series. See [33] for a simple combination of methods that can generate synthetic PV power generation on arbitrarily oriented PV system based on synthetic clear-sky index time-series. This, in turn, could be useful for grid-integration studies, where probabilistic load-ﬂow calculations potentially could be complemented with a synthetic time series of PV power generation. Since copula modeling of spatially dispersed PV power generation was recently shown to improve estimates for grid simulations, in [34], the use of temporal copula modeling could prove useful as well. Generally, applying this type of temporal copula modeling to diﬀerent clear- sky index data sets, including for diﬀerent locations or resolution, could be interesting. Also, since the modeling is general, it could be used to model the temporal variability of any general time-series, such as for example electricity use, net-demand or grid interaction in power systems research. Developing a method for forcasting that utilizes this particular copula-method could prove fruitful, in particular for devising demand side management strate- gies for matching electric power use with intermittent generation. Acknowledgment This project was funded by the project “Development and evaluation of fore- casting models for solar power and electricity use over space and time”, and the EU-ERA.Net Smart Grids Plus project “Increased Self Consumption of Photo- voltaic Power for Electric Vehicle Charging in Virtual Networks”, both funded by the Swedish Energy Agency. References [1] Bollen, M. H. J., F. Hassan, 2011. Integration of Distributed Generation in the Power System. Wiley IEEE press series on Power Engineering. [2] Kleissl, J., 2013. Solar Energy Forecasting and Resource Assessment. 1st Edition, Academic Press. 17 [3] Wid´en, J., 2015, A model of spatially integrated solar irradiance variability based on logarithmic station-pair correlations. Solar Energy 122, 1409-1424. [4] Holttinen, H., Milligan, M.,Kirby, B., Acker, T., Neimane, V., Molinski, T., 2008. Using standard deviation as a measure of increased operational reserve requirement for wind power. Wind Engineering 32, 355-378. [5] Bright, J. M., Smith, C. J., Taylor, P. G., Crook, R., 2015. Stochastic generation of synthetic minutely irradiance time series derived from mean hourly weather observation data. Solar Energy 115, 229-242. [6] Hollands, K. G. T., Huget, R. G., 1983. A probability density function for the clearness index, with applications. Solar Energy 30, 195-209. [7] Hollands, K. G. T., Suehrcke, H., 2013. A three-state model for the probability distribution of instantaneous solar radiation, with applications. Solar Energy 96, 103-112. [8] Munkhammar, J., Ryd´en, J., Wid´en, J., Lingfors, D., 2015. Simulating dispersed photovoltaic power generation using a bimodal mixture model of the clear-sky index. In proceedings of EU-PVSEC, Hamburg, Germany 14-18 September 2015, 1560-1567. [9] Wid´en, J., Shepero, M., Munkhammar, J., 2017. On the properties of aggregate clear-sky index distributions and an improved model for spatially correlated in- stantaneous solar irradiance, manuscript. [10] Voyant, C., Muselli, M., Paoli, C., Nivet, M.-L., 2011. Optimization of an artiﬁcial neural network dedicated to the multivariate forecasting of daily global radiation. Energy 36, 348-359. [11] Munkhammar, J., Ryd´en, J., Wid´en, J., 2015. On a probability distribution model combining household power consumption, electric vehicle home-charging and pho- tovoltaic power production. Applied Energy 142, 135-143. [12] Munkhammar, J., Wid´en, J., Hinkelman, L., 2017. A copula method for estimat- ing aggregate instantaneous solar irradiance in spatial networks. Solar Energy 143, 10-21. [13] Bright, J. M., Babacan, O., Kleissl, J., Taylor, P. G., Crook, R., 2017. A synthetic, spatially decorrelating solar irradiance generator and application to a LV grid model with high PV penetration. Solar Energy 147, 83-98. [14] Brinkworth, B. J., 1977. Autocorrelation and stochastic modelling of insolation sequences. Solar Energy 19, 343-347. [15] Skartveit, A., Olseth, J. A., 1992. The probability density and autocorrelation of short-term ﬂobal and beam irradiance. Solar Energy 49, 477-487. [16] Aguiar, R., Collares-Pereira, M., 1992. TAG: A time-dependent, autoregressive, Gaussian model for generating synthetic hourly radiation. Solar Energy 49, 167- 174. 18 [17] Hansen, C. W., Stein, J. S., Ellis, A., 2010. Statistical Criteria for Characterizing Irradiance Time Series. Sandia Report SAND2010-7314. [18] Hammer, A., Beyer, H. G., 2013. Solar Radiation, Spatial and Temporal Variabil- ity, in Richter, C., Lincot, F., Guermard, A.,(Eds), Solar Energy, Springer New York 2013, pp. 634-648. [19] Perez, R., Kivalov, S., Schlemmer, J., Hemker Jr., K., Hoﬀ, T. E., 2012, Short- term irradiance variability: Preliminary estimation of station pair correlation as a function of distance, Solar Energy 86, 2170-2176. [20] Lohmann, G. H., Hammer, A,, Monahan, A. H., Schmidt, T., Heinemann, D., 2017. Simulating clear-sky index increment correlations under mixed sky conditions using a fractal cloud model. Solar Energy 150, 255-264. [21] Grantham, A. P., Pudney, P. J., Ward, L. A., Belusko, M., Boland, J. W., 2017. Generating synthetic ﬁve-minute solar irradiance values from hourly observations. Solar Energy 147, 209-221. [22] Munkhammar, J., Wid´en, J., Copula correlation modeling of aggregate solar irra- diance in spatial networks. In proceedings of Solar Integration Workshop, Vienna 15-17 November 2016. [23] Nelsen, R. B., 2006. An Introduction to Copulas, Second edition, Springer Series in Statistics, New York. [24] Hagspiel, S., Papaemannouli, A., Schmid, M., Andersson, G., 2012. Copula-based modeling of stochastic wind power in Europe and implications for the Swiss power grid. Applied Energy 96, 33-44. [25] Li, W., Isberg, J., Chen, W., Engstr¨om, J., Waters, R., Svensson, O., Leijon, M., 2016. Bivariate joint distribution modeling of wave climate data using a copula method. Energy Stat. 04, 1650015. [26] Munkhammar, J., Wid´en, J., 2017. An autocorrelation-based copula model for producing realistic clear-sky index and photovoltaic power generation time-series. In proceedings of IEEE PVSC 2017, Washington DC, USA, June 25-30 2017. [27] Koopmans, L. H., 1995. The spectral analysis of Time Series, Probability and mathematical statistics. Elsevier Science, Albuquerque, USA. [28] Box, G. E. P., Jenkins, G. M., Reinsel., G. C., Ljung, G. C., 2016. Time Series Analysis: Forecasting and Control. Fifth edition, Wiley Series in Probability and Statistics, Wiley. [29] Hayes, M. H., 1996. Statistical Digital Signal Processing and Modeling. John Wiley & Sons, Inc. [30] Conover, W. J. 1999. Practical Nonparametric Statistics. Wiley 3rd edition. [31] Swedish Meteorological and Hydrological Institute [Internet]. Norrk¨oping, Swe- den: SMHI; 2008. Available from: http://www.smhi.se/en. [32] Ineichen, P., Perez, R., 2002. A new airmass independent formulation for the Linke turbidity coeﬃcient. Solar Energy 73, 151-157. 19 [33] Munkhammar, J., Wid´en, J., 2016. Correlation modeling of instantaneous solar irradiance with applications to solar engineering. Solar Energy 133, 14-23. [34] Wid´en, J., Shepero, M., Munkhammar, J., 2017. Probabilistic load ﬂow for distri- bution grids with high PV penetrations using copula-based modeling of spatially correlated solar power. In proceedings of IEEE PVSC 2017, Washington DC, USA, June 25-30 2017. 20 View publication statsView publication stats","libVersion":"0.3.1","langs":""}