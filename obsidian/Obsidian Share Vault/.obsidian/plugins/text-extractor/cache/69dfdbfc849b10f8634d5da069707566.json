{"path":"lit/sources/papers_added/papers/SilvaFilho12ModelingDependenceDynamics.pdf","text":"Modelling the Dependence Dynamics through Copulas with Regime Switching Osvaldo Candido da Silva Filho Graduate Program of Economics - Catholic University of Brasilia CGAN 916 - Module B W5 - Room A 120 - Asa Norte 70790-160 Brasilia - DF - BRAZIL Tel: +55 61 3522 7052 e-mail: osvaldoc@ucb.br Fl´avio Augusto Ziegelmann Department of Statistics - London School of Economics (LSE, UK) Department of Statistics - Federal University of Rio Grande do Sul (UFRGS, Brazil) Av. Bento Gon¸calves, 9500 - Pr´edio 43-111 - Agronomia 91509-900 Porto Alegre - RS - BRAZIL Tel: +55 51 3308 6194 Fax: +55 51 3308 7301 e-mail: ﬂavioz@ufrgs.br June 23, 2010 Abstract Measuring dependence dynamics between international ﬁnancial markets has been a subject of great interest in ﬁnancial econometrics literature recently. In this work, using conditional copulas as introduced by Patton (2006), we propose a novel approach to measure dependence dynamics. We include a hidden Markov chain (MC) in the equation describing the dynamics, allowing in this way that the unobserved time-varying dependence parameter varies not only according to a restricted ARMA as in Patton (2006), but also according to an unobserved two- state MC. In our equation the intercept is responsible for capturing the MC inﬂuence, resulting in a generalization of the work by Chollete, Heinen and Valdesogo (2009). Estimation is carried out via the inference from the margins method proposed by Joe and Xu (1996) in conjunction with Kim’s ﬁltering and smoothing algorithms (Kim and Nelson 1999). We use block bootstrap to estimate the covariance matrix of our estimators. Monte Carlo simulations are run to compare the performances of regime switching and no switching modeling, suggesting the appropriate- ness of our approach. Finally the proposed modeling methodology is applied to empirical data, through the study of BOVESPA (Brazil), S&P500 (USA) and FTSE100 (UK) ﬁnancial market indexes. Keywords: Asymmetric dependence, Copulas, Markov switching, Bootstrap test. JEL Classiﬁcation: C15, C46, G15. 1 1 Introduction The study of dependence structures between international ﬁnancial markets has attracted the interest of researchers and professionals both in theoretical and empirical ﬁeld. Aiming to con- trol risks they face, portfolio managers and regulators need to take into account the dependence between assets in the international ﬁnancial market, for example. Issues such as the existence of asymmetric dependence structures, like greater interdependence in some periods or markets, have strong inﬂuence on measuring and evaluating risk. Moreover, the beneﬁts resulting from interna- tional diversiﬁcation of assets can also be considerably aﬀected by these asymmetric dependence structures. Thus, appropriately determining this dependence is of great importance in portfolio and risk management, option pricing and hedging. Assets in ﬁnancial markets tend to show asymmetric dependence as asserted by Chollete, Heinen and Valdesogo (2009). It means that returns of ﬁnancial markets indexes are more dependent in downturn movements than in upward movements. Besides, the data generation processes of these returns may be non-linear, non-stationary and/or heavy-tailed. Moreover the marginal distributions may be asymmetric, leptokurtic and/or show conditional heteroscedasticity. Therefore, we need to construct ﬂexible models capable of incorporating these features. GARCH family models have been used to address conditional heteroscedasticity and kurtosis excess, as described by Engel (1982), Bollerslev (1986) and Hansen (1994), but mostly considering elliptical distributions. The use of copula-based models has become common practice in ﬁnancial literature when it comes to coping with asymmetric dependence structures between random variables. The main feature of these models is the possibility of splitting the problem of identifying the joint distribu- tion into two components: marginal densities and dependence structure. The modeling procedure consists ﬁrstly of specifying the functional form of the marginal distributions, which allows one to ﬁrstly explore in detail stylized facts about ﬁnancial variables individually (using GARCH models, for example), and secondly determine the adequate copula function that caracterizes the depen- dence between the variables. Recently, we have observed the emergence of works dealing with non-normality and depen- dence dynamics over time using copula-based models. Patton (2006), using the conditional copula deﬁnition, studies the dependence time evolution allowing the dependence parameter evolve over time in a similar way of ARMA models, being the marginal distributions modelled as GARCH processes. Jondeau and Rockinger (2006) use copula-GARCH models to study the dependence be- tween international ﬁnancial markets. Other authors have considered such models including regime switching like Chollete, Heinen and Valdesogo (2009), Rodriguez (2007) and Pelletier (2006). They found signiﬁcative asymmetry in the dependence structure between ﬁnancial markets returns. In this paper, we propose a novel procedure to capture dependence structure over time. The dependence parameter is allowed to evolve according to Patton (2006), i.e., following an ARMA(1,10) restrict process. Nevertheless it also depends on a hidden two-state Markov chain (MC) through the intercept term. In our approach we estimate in the ﬁrst step the marginal distributions, while the de- pendence parameter is estimated in a second step through copulas. To evaluate the dependence structure we use the tail dependence measure. The choice of univariate skewed-t GARCH models ensures that any asymmetry found in the multivariate dependence structure reﬂects the dependence structure by itself and is not an eﬀect from marginal modeling misspeciﬁcation. Note that the estimation procedure via maximum likelihood occurs in two steps. Due to this two-step procedure, the method does not take into account the uncertainty about the estimators simultaneously. Therefore, due to the eﬀects of parameter estimates from the GARCH 2 models in the ﬁrst step, the asymptotic covariance matrix for the copula parameters estimates might be diﬀerent from that obtained via full maximum likelihood. To overcome this issue and calculate adequate standard erros for the parameter estimates, we obtain the covariance matrix by block bootstrap. In order to evaluate the performance of our modeling approach we compare it to the one used in Silva Filho and Ziegelmann (2009), without regime switching, through Monte Carlo simulations. We also apply our methodology to empirical data, aiming to measure and study the dependence structure between BOVESPA index (´ındice da Bolsa de Valores de S˜ao Paulo)and the indexes FTSE100 (Financial Times and London Stock Exchange Index) and S&P500 (Standard and Poor 500 index). Our proposed approach, both for empirical data and for simulated data, proves to be ﬂexible, appropriate and oﬀers good insights about the dependence dynamics between ﬁnancial market indexes. In the simulation experiment, we can note that the model with regime switching and non-elliptical distribution is successful reproducing and estimating the features commonly found in ﬁnancial markets indexes. Indirectly we also observe that extreme negative returns are more tail-dependent than extreme positive returns. Regarding the application with empirical data sets, we can identify two distinct regimes: high dependence and low dependence. Besides the diﬀerence in the magnitude of the parameters, we can infer that both asymmetry and kurtosis may diﬀer across regimes, i.e., the high dependence regime tends also to show higher asymmetry and heavier tails. This suggests that besides the existence of an asymmetric dependence we can also have the dependence structure by itself changing over time1. The rest of this paper is organized as follows: sections 2 and 3 present some methodological aspects concerning copulas, tail dependence and copula-GARCH model; in section 4 we discuss the estimation procedures in a context with regime switching and also obtain standard erros by block bootstrap; in section 5 we compare the performance of our proposed approach with regime switching with that without regime switching using a Monte Carlo experiment; in section 6 the proposed model is applied to empirical data (ﬁnancial market indexes returns), and ﬁnally some closing comments are exposed. 2 Copulas: basic concepts In accordance to Schweizer and Sklar (1983), an n-dimensional copula C(u1, ..., un)is a multivariate distribution function in [0, 1]n whose marginal distributions are uniform in the [0, 1] interval. Besides for any joint distribution H(x1, ..., xn) with marginals F1(x1), ..., Fn(xn), we have H(x1, ..., xn)= C(F1(x1), ..., Fn(xn)). (1) If F1, ..., Fn are continuous, then the copula C associated to H is unique and may be obtained by C(u1, ..., un)= H(F (−1) 1 (u1), ..., F (−1) n (un)) , (2) where u1 = F1(x1), ..., un = Fn(xn). The density function related to the joint distribution in (1) can be easily obtained because F1, ..., Fn and C are n-diﬀerentiable. 1See Garcia and Tsafak (2009) for an application where the dependence structure can change over time. 3 Thus, in a bivariate case the density function is given by h(x1,x2)= c(F1(x1),F2(x2)) 2∏ i=1 fi(xi) , (3) where h is the density function associated to H, fi is the density function for each marginal, and the copula density c is obtained diﬀerentiating (1), which can be written as c(F1(x1), ..., Fn(xn)) = h(F (−1) 1 (u1),F (−1) 2 (u2)) ∏2 i=1 fi(F (−1) i (ui)) . (4) Copula functions often used in ﬁnance have elliptical forms, e.g. gaussian (Normal) and t-Student copulas. They are called elliptical because they are associated to a quadratic form of correlation between the marginals. The dependence structure related to this copula family is the Pearson’s correlation coeﬃcient which belongs to the [−1, 1] interval. Indeed, distribution functions of that kind of family are symmetric. Other copulas that have been used are Archimedean, which, depending on the functional form of the generating factor2 associated with them, may have the dependence measure belonging to the most diverse ranges of variation. An example may be given by the copulas used in the extreme value theory (EVT), where we can cite the Gumbel (1960) copula. It allows only positive dependence structures (or the upper tail dependence), for which the parameter belongs to the interval [1, +∞). This diversity of copula functions with speciﬁc dependence structures would make it impossible to compare diﬀerent functional forms for copulas. To make this comparison possible we focus on a dependence measure known as Tail Dependence3, which is deﬁned below. Deﬁnition 1 If the limit lim ε→0 Pr [U1 ≤ ε|U2 ≤ ε] = lim ε→0 Pr [U2 ≤ ε|U1 ≤ ε] = lim ε→0 C(ε, ε)/ε = τ L ex- ists, then copula C has a lower tail dependence if τ L ∈ (0, 1].Otherwise, C has no lower tail depen- dence. If the limit lim δ→1 Pr [U1 >δ|U2 >δ] = lim δ→1 Pr [U2 >δ|U1 >δ] = lim δ→1 (1 − 2δ + C(δ, δ)) /(1 − δ)= τ U exists, then copula C has upper tail dependence if τ U ∈ (0, 1].Otherwise, C has no upper tail dependence. Using tail dependence measures allows us to investigate which model is capable of repro- ducing empirical facts, or stylized facts, about ﬁnancial markets. Additionally, we can think of the tail dependence measure as the probability that an extreme event occurs in a market, given that this event is occurring in another market. Besides, tail dependence is completely deﬁned by the de- pendence structure, in this case by the related copula, and is not aﬀected by marginal distributions variations. There are many functional forms that can be used as copulas. In Nelsen (2006) some ex- amples of copula families are found as well as a guidance on learning to construct copulas functions. For our purpose we test four copula functions, they are4 as follows. 2This generating factor for Archimedean copulas needs to meet some criteria like convexity, among others, in order to also satisfy the assumptions about copulas seen in the previous section. See Nelsen (2006). 3Other measures of dependence have been used to try to compare copulas, as the measures of concordance Kendall’s τ ,Spearman’s ρ and Gini’s co-graduation index. For further details see Cherubini, Luciano and Vecchiato (2004), Nelsen (2006), Patton (2006). 4We show only bivariate copula functions since our work focus on this dimension. 4 Gumbel Copula - has only upper tail dependence. CG(u1,u2|θ)= exp (− ( (− log u1) θ +(− log u2)θ)1/θ) ,θ ∈ [0, +∞) Rotated Gumbel Copula - has only lower tail dependence. CRG(u1,u2|θ)= u1 + u2 − 1+ CG(1 − u1, 1 − u2|θ),θ ∈ [0, +∞) Symmetrized Joe-Clayton Copula CSJC(u1,u2|τ U ,τ L)= 0.5 · (CJC ( u1,u2|τ U ,τ L) + CJC (1 − u1, 1 − u2|τ U ,τ L) + u1 + u2 − 1) , where CJC is the Joe-Clayton copula, also called ”BB7”, is given by CJC (u1,u2|τ U ,τ L) =1 − (1 − { [1 − (1 − u1) κ] −γ +[1 − (1 − u2) κ] −γ − 1 }−1/γ)−1/κ , with κ =1/ log2 ( 2 − τ U ) , γ = −1/ log2 ( τ L) and τ U ,τ L ∈ (0, 1). The SJC has both upper and lower tail dependence parameters. Its own dependence parameters, τ U and τ L, are the measures of dependence on the upper and lower tail, respectively. Furthermore, τ U and τ L range freely and are not dependent on each other. Normal Copula - has no tail dependence and its dependence parameter is the linear correlation coeﬃcient. CN (u1,u2|ρ)= ∫ Φ−1(u1) −∞ ∫ Φ−1(u2) −∞ 1 2π√(1 − ρ2) exp { −(r2 − 2ρrs + s2) 2(1 − ρ2) } drds, ρ ∈ (−1, 1). t-Student Copula - just like Normal copula, t-Student copula has the linear correlation coeﬃcient as measure of dependence. But, diﬀerently from the normal, it shows some tail dependence. Indeed, it possesses symmetric tail dependence. Ct(u1,u2|ρ, ν)= ∫ t −1 ν (u1) −∞ ∫ t −1 ν (u1) −∞ 1 2π√1 − ρ2 (1+ r2 − 2ρrs + s2 ν(1 − ρ2) )− ν+2 2 drds . 3 Copula-GARCH model Considering xt =(x1t,x2t), t =1, 2,... , a 2-dimensional time series vector, we can repre- sent the copula-GARCH model as follows H(xt|μ, ht)= Cθct (F1(x1t|μ1,h1t),F2(x2t|μ2,h2t)) , (5) where Cθct is the copula function with time-varying dependence parameter θct and Fi(xit|μi,hit), i =1, 2, are the marginal distributions speciﬁed as standard univariate GARCH processes. 5 A GARCH model can be described by the following equations: xit = μi + h 1/2 it εit hit = ωi + βihit−1 + αiε 2 it−1 , where hit is the conditional variance given past information, εit, t =1, 2,... , are i.i.d. random variables, ωi,βi,αi > 0and αi + βi < 1 assuring hit > 0 and covariance stationarity, respectively. We also assume that εit has a skewed-t distribution, i.e., εit ∼ skewed − t(νi,λi). This density is given by g(z|ν, λ)= ⎧ ⎪⎪⎪⎨ ⎪⎪⎪⎩ bc (1+ 1 ν−2 ( bz+a 1−λ )2)−(ν+1)/2 z< −a/b bc (1+ 1 ν−2 ( bz+a 1+λ )2)−(ν+1)/2 z ≥−a/b , where the constants a, b and c are obtained by a =4λc ( ν − 2 ν − 1 ) ,b 2 =1 + 3λ 2 − a 2,c = Γ ( ν+1 2 ) √π(ν − 2)Γ ( ν 2 ) , with ν and λ representing the number of degrees of freedom and asymmetry, respectively. Thus, the conditional distribution function for each marginal is Fi(xit|μi,hit)= skewed−tνi,λi ( (xit − μi)h −1/2 it ) . As said before, the dependence parameter is allowed to vary over time. Its time evolution follows a restricted ARMA(1,10) process, where the intercept term switches according to a ﬁrst or- der Markov chain, i.e., θct,St =Λ(ωSt c +βcθct−1 +ψt)and St ∼ Markov(P ). Here St may assume two possible states (or regimes), P is a 2x2 transition matrix for these states and the Markov chain is irreducible and ergodic5. ψt represents a “forcing variable” deﬁned as the mean absolute diﬀerence between u1 and u2 for RGC and SJC copulas, given by αc · 1 10 ∑10 j=1 |u1,t−j − u2,t−j|,and the mean of the products between αc· 1 10 ∑10 j=1 Φ−1(u1,t−j) · Φ−1(u2,t−j)and αc· 1 10 ∑10 j=1 T −1 ν (u1,t−j) · T −1 ν (u2,t−j)6 for Normal and t-Student copulas across ten previous periods (Patton 2006). Λ(·) is a logistic transformation for each copula function to constrain the dependence parameter in a ﬁxed interval. Indeed, θct, as a measure of dependence, describes features of its associated copula function. So, in this case, we use the tail dependence measure calculated as in Deﬁnition 1 (except for the Normal copula which has no tail dependence). 4 Estimation We can write the log-likelihood for our problem as follows: l(θ|xt)= T∑ t=1 log ( cθct (F1(x1t|θ1),F2(x2t|θ2)|θct,St) 2∏ i=1 fit(xit|θi) ) , (6) where θi = μi,hit, i =1, 2, and θ is a vector with all model parameters. Evaluating the log-likelihood in (6) may be computationally very intensive due to the existence of unobserved processes as h1t, h2t and St. However, being (6) a separable function we 5See Kemeny and Snell (1960) for details. 6Where Φ −1 and T −1 ν are the inverses of Normal and t-Student c.d.f, respectively. 6 can use the maximum likelihood estimation procedure in two steps, i.e., we can use the inference function from the margins (IFM) method proposed by Joe and Xu (1996). The IFM method consists in estimating the parameters of the univariate marginal distri- butions in a ﬁrst step and, using these estimates, estimating the dependence parameters in a second step. This procedure made copula-GARCH models popular7. Marginal distributions are modeled as univariate GARCH processes and the dependence parameters are speciﬁed by copula function choice. Thus, we can use this approach to our purpose. Fitting the marginal distributions is straightforward because it follows the traditional approach for GARCH models. However the dependence parameter estimation through copulas in our case deserves some additional discussion because θct dependes on a non-observable discrete variable St which follows a Markov chain. To proceed with the estimation process, we use Kim’s ﬁlter as described by Kim and Nelson (1999). 4.1 Copula estimation The log-likelihood in (6) can be rewritten as l(θ|xt)= T∑ t=1 log ( cθct(F1(x1t|μ1,h1t,θ1),F2(x2t|μ2,h2t,θ2)|θct,St) 2∏ i=1 fit(xit|μi,hit,θi) ) = T∑ t=1 log f 1t(x1t|μ1,h1t; θ1)+ T∑ t=1 log f 2t(x2t|μ2,h2t; θ2) + T∑ t=1 log ct(u1t,u2t|μ1,μ2,h1t,h2t; θct,St) l(θ|xt)= ℓf1(θ1)+ ℓf2(θ2)+ ℓc(θct,St) , where ℓf1(θ1)= ∑T t=1 log f 1t(x1t|μ1,h1t; θ1), ℓf2(θ2)= ∑T t=1 log f 2t(x2t|μ2,h2t; θ2)and ℓc(θct,St)= ∑T t=1 log ct(u1,u2|μ1,μ2,h1t,h2t; θct,St), and ℓf1(θ1)and ℓf2(θ2) are log-likelihood functions used to estimate parameters of the marginal distributions in the ﬁrst step. Thus, we can move to the evaluation of ℓc(θct,St). Rewriting ℓc(θct,St)takingintoaccount non-observable variables and decomposing ct,we have ℓc = T∑ t=1 log ( 1∑ St=0 ct(u1,u2|St,wt−1)Pr[St|wt−1] ) . (7) As the states St are non-observable, to evaluate the log-likelihood in (7) we need to calcu- late the weights Pr[St|wt−1]for St =0 e St = 1, since we are considering two states only. Applying Kim’s ﬁlter we get the following algorithm which should be iterated for t =1, ..., T . (a) Prediction of St Pr[St = l|wt−1]= 1∑ k=0 pt−1 kl Pr(St−1 = k|wt−1) 7See for instance Dias and Embrechts (2004), Rodriguez (2007), Hu (2006), Bartram, Taylor and Wang (2007), Patton (2006), Jondeau and Rockinger (2006). 7 for l =0, 1and pt−1 kl =Pr(St = l|St−1 = k, wt−1), the transition probabilities between the states k and l. (b) Filtering of St Pr(St = l|wt)= ct(u1,u2|St = l, wt−1)Pr[St = l|wt−1] ∑1 k=0 ct(u1,u2|St = k, wt−1)Pr[St = k|wt−1] where wt =[wt−1,u1t,u2t]. In t = 1, the ﬁlter is initialized using stationary probabilities of St for Pr(S0 = k|w0). With the ﬁlter described above we obtain the probability distribution of St given the information set by t. However, as we are dealing with time series, it is useful to know the distribution of St given the full sample information set, i.e., we can obtain better estimates in the sample using all T observations (opposed to prediction and ﬁltering process), since in a time series context we can extract information about the past from the future. Thus, the smoothed probabilities regarding St,Pr(St = l|wT )= ∑1 k=0 Pr(St = l, ST = k|wT ), are obtained and Pr(St = l, ST = k|wT ) can be calculated recursively from the ﬁltered probabilities. This smoothing process works like a backward-smoothing algorithm as follows: 1. Given the ﬁltering process cited above, we obtain Pr(St = l|wt)for l =0, 1and t =1, ..., T . 2. Then we can initialize the smoothing algorithm in t = T and go backwards recursively, being Pr(ST = l|wT ) equal to the ﬁltered probability in t = T . 3. For each t = T − 1,T − 2, ..., 1, the smoothed probability distribution Pr(St = l|wT )is given by Pr(St = l|wT )= 1∑ k=0 plk(t)Pr(St = l|wt)Pr(St+1 = k|wT ) ∑1 j=0 pjk(t)Pr(St = j|wt) , where plk(t)= Pr(St+1 = k|St = l, wt) are the transition probabilities between the states l and k. At t = 0 the smoothing algorithm gives us Pr(S0 = l|wT ) that can be used as initial value in the ﬁltering algorithm. Thus, we complete the forward-ﬁltering-backward-smoothing algorithm and we can proceed to maximize (7) in relation to the model parameters directly in a numeric fashion. 4.2 Computing standard errors by block bootstrap Note that IFM estimator for θ, ˆθ, was obtained by solving ( ∂ℓf1 ∂θ1 , ∂ℓf2 ∂θ2 ∂ℓc ∂θct,St )′ =0 separately, i.e., marginal distributions parameters in the ﬁrst step and dependence parameters in the second step. 8 Assuming that certain regularity conditions are held (the same used for maximum like- lihood estimators) for both the multivariate model and the marginal models, the parameters es- timated by IFM can be considered asymptotically multivariate normal (Joe 1997; Patton 2006). Therefore, we have √T (ˆθ − θ0) → N (0, G−1(θ0) ) , where G(θ0) is the Godambe information matrix (Godambe 1960). Deﬁning a score function to our problem as s(θ)= ( ∂ℓf1 ∂θ1 , ∂ℓf2 ∂θ2 , ∂ℓc ∂θct,St )′ , the Godambe matrix is then given by G(θ0)= D−1V (D−1)′,where D = E [∂s(θ)/∂θ]and V = E [s(θ)s(θ)′]. The estimation of this covariance matrix involves calculating quite a few derivatives (in our case score functions for likelihood functions) which can be computationally intensive. Moreover, the main problem in implementing the IFM method is its loss of performance (when compared to full maximum likelihood method) in estimating the parameters due to the marginal estimation procedure in the ﬁrst step that ignores the possible dependence between θ1 and θ2 when estimating ˆθct,St (Liua and Luger 2009). Therefore, in order to adequately calculate standard errors for our model we use block bootstrap approach8 to estimate the covariance matrix. The block optimal length is calculated in accordance to Politis and White (2004) and Politis, White and Patton (2007). In other words, we use the following procedure: 1. Obtain parameter estimates via IFM (as described in previous subsections). 2. Sample n/l sub-samples (with replacement) from the observed data and generate a set of time series with size n,where l is the block size. 3. Re-estimate parameters using the generated time series. 4. Repeat steps (2) and (3) R times. 5. Using the covariance matrix R−1 ∑R r=1( ˆΩ(r) − ˆΩ)( ˆΩ(r) − ˆΩ)′,where ˆΩ(r) is the estimated parameters vector for each replication r and ˆΩ is the parameter vector obtained in (1), calculate standard errors for the parameters. 5 Monte Carlo simulations In this section, we consider simulated data sets to evaluate the proposed model. These data is obtained from two diﬀerent underlying generating models (origins): (i) a Markov model with regime switching (2 regimes), i.e., from the time-variant copula-GARCH model described in 8We use two block bootstrap procedures for estimating standard errors: stationary bootstrap (SB) and non- overlapping block bootstrap (NBB). The results presented here refer to NBB. Given the sample size we use, the estimators variance via SB or NBB tend to be close to each other. However NBB bias is lower (see Politis (2003) and H¨ardle, Horowitz and Kreiss (2001) for details). 9 previous sections, and (ii) a model without regime change (1 regime), based on time-variant copula- GARCH model described in Patton (2006) and applied to ﬁnancial market indexes by Silva Filho and Ziegelmann (2009). In the experiment, we use bivariate time series of sizes T = 1000, T = 2000, T = 50009 generated from Normal copula and symmetrized Joe-Clayton copula and replicated 1000 times. We choose Normal e SJC copulas to observe the performance of the model with and without tail dependence. The dependence dynamics for the models we use to simulate our data set is given by Normal Copula Model 1 (with regime switching): ρct(St)=Λ([0.1 · (1 − St)+ 0.5 · St]+ 1.6 · ρct−1 − 0.06 · 1 10 10∑ j=1 Φ−1(u1,t−j) · Φ−1(u2,t−j)) , where St = 0 or 1. Model 2 (without regime switching): ρct =Λ(0.3+ 0.14 · ρct−1 +1.6 · 1 10 10∑ j=1 Φ−1(u1,t−j) · Φ−1(u2,t−j)) SJC Copula Model 1 (with regime switching): τ L ct(St)= Λ([0.3 · (1 − St)+ 1.1 · St] − 0.5 · τ L ct−1 − 3 · 1 10 10∑ j=1 |u1,t−j − u2,t−j|) τ U ct (St)= Λ([0.9 · (1 − St)+ 2.6 · St] − 2 · τ U ct−1 − 6 · 1 10 10∑ j=1 |u1,t−j − u2,t−j|) , where St = 0 or 1. Model 2 (without regime switching): τ L ct =Λ(−1.7 − 0.8 · τ L ct−1 +3.6 · 1 10 10∑ j=1 |u1,t−j − u2,t−j|) τ U ct =Λ(−1.8 − 1.2 · τ U ct−1 +4 · 1 10 10∑ j=1 |u1,t−j − u2,t−j|) . In possession of simulated data, we estimate models with and without regime switching and calculate the mean error based on the diﬀerence between the true dependence dynamics and the estimated. To compare the models we present the results on box plots. Figures 5-7 show these results. On the left hand side of these ﬁgures the source model is indicated while the sample size 9The sample begins to be counted after the ﬁrst 1000 observations are discarded. This is to avoid any eﬀect from starting values for the parameters. 10 goes on the top. The boxes represent the values for 1000 mean errors (one for each replication) corresponding to each estimated model. To simplify the exercise, we use the right copula function so that, given the copula function used to generate the data for models 1 and 2, we estimate models with and without regime switching having the same functional form of the original model, then comparing the results. Figure 5 shows results for Normal copula. We can observe that when the data comes from a model without regime switching (Model 2) the estimated model without regime switching has a better performance. The median is closer to zero, the mean error variability is lower than that of the estimated model with regime switching. Moreover its distribution seems to be symmetric, as observed by looking at the proportional division of the box and whiskers around the median10. While the model with regime switching leads to a mean error median higher than that found for the model without regime switching, the mean error variability is also higher and its dispersion tends to be asymmetric to the left, which indicates the model with regime switching tends to underestimate the dependence between the variables. This result is expected and it remains as the sample size increases. At the second row in the same ﬁgure when the underlying data generating model has regime switching (Model 1), we can note that the mean error median for either estimated models are closer to each other regardless the sample size. For T = 1000, the model without regime switching shows higher dispersion than the model with regime switching and that dispersion tends to be asymmetric to the left, indicating overestimation of the dependence parameter. Besides, that asymmetry decreases as the sample size increases. For both cases, the results are expected and the model with regime switching has a better performance, i.e., lower error dispersion. When the sample size is T = 5000, the model without regime switching shows lower variability and seems better, which is unexpected. Figures 6 and 7 show box plots related to the lower and upper tail dependence, respectively, for SJC copula. Concerning to lower tail dependence (ﬁgure 6) we can observe that when the simulated data comes from a model without regime switching (Model 2) the mean error median for either estimated model is negative, whereas their variabilities tend to be symmetric. Besides the model with regime switching shows less dispersion as the sample size increases. Furthermore, the negative mean error medians indicate that both models overestimate the lower tail dependence. The model without regime switching has a better performance than the model with switching, i.e., the median is closer to zero, and for sample size T = 1000 the mean error has less variability. As the sample size increases the best model remains that without regime switching, although the mean error variability of the model with regime switching is also decreasing. Considering the data generating process as the model with regime switching (Model 1) we note, as we look at the second row in ﬁgure 6, that the mean errors of the model without regime switching have a positive median while its variability is also higher than the model with regime switching. On the other hand the model with regime switching has a median closer to zero. For both models the mean error shows symmetric dispersion as indicated by the box and whiskers positioning, equally spaced around their median. These results remain as the sample size increases. Given the lower mean error variability for the model with regime switching we conclude that this model has a better performance. Observing the results for upper tail dependence (ﬁgure 7), we can note that when the data comes from a model without regime switching (Model 2), the estimated model with regime switching surprisingly shows less mean error variability. However it tends to overestimate the upper 10The whiskers extend from each end of the box to the adjacent values in the data and represents the most extreme values within 1.5 times the interquartile range from the ends of the box. 11 tail dependence, as we can see from the negative mean error median regardless the sample size. The estimated model without regime switching has median closer to zero and decreasing mean error variability as the sample size increases. The mean error dispersion looks symmetric in both models. Therefore, as expected, the model without regime switching seems to present a better performance. When the underlying model presents regime switching (Model 1), the estimated model without switching tends to overestimate the upper tail dependence parameter as shown by the negative mean error median. For both estimated models the distribution seems symmetric and the degree of dispersion decreases as the sample size increases. In this case, the model with regime switching is the best choice. This is conﬁrmed by the smaller range of the box when compared to the model without switching. One feature of the model we propose is that the mean error tends to have a lower variability than the model without regime switching, except for the case where the underlying model is the normal copula under no regime switching. 6 Empirical application In our empirical analysis we use three ﬁnancial market indexes: FTSE100 (Financial Times and London Stock Exchange Index), BOVESPA (´Indice da Bolsa de Valores de S˜ao Paulo)and S&P500 (Standard and Poor’s 500 Index). The data sets are of daily frequency (business days), comprising the period from January 1st, 1999 to July 10th, 2009, totalizing 2435 points. Table 1 shows some summary statistics for our sample. They clearly suggest non-normality, negative asymmetry (except for BOVESPA) and heavy tails for all series. 6.1 Marginal distributions The results regarding marginal model ﬁtting are shown in table 2. We can observe that the asymmetry coeﬃcient is negative and signiﬁcative for all series. This indicates a heavy tail to the left (lower tail) for the marginal distributions, i.e., large negative returns, as observed in downturn periods, are more likely than large positive returns. Note also that the low estimate for the degrees of freedom coeﬃcient of the nuisance term related to BOVESPA and S&P500 indicates heavy tails. As so, the use of Normal distribution might not be appropriated. Besides, the high value for the estimated βi indicates a high volatility persistence. Therefore, there is a clear suggestion that the use of multivariate Normal or symmetric t-Student distributions would not be a good choice to describe the joint distribution of our returns. We can also observe that there is no autocorrelation, neither squared autocorrelation, on the residuals terms as we can infer by Lijung-Box Q statistic indicating that the model for the marginal distributions is not misspeciﬁed. Besides, Kolmogorov-Smirnov (KS), Berkowitz (Berk) and Anderson-Darling (AD) tests, which are used as uniformity tests for the transformed marginals of these residuals, do not indicate evidences against the uniform (0,1). 6.2 Copulas Table 3 shows copula estimation results for our four copula functions (with regime switch- ing) we use in this work. Is noticeable that both regimes, named high and low dependence, are 12 persistent as indicate the high values for the probabilities p and q. We also verify an expressive change on the intercept term in the equation describing the dependence dynamics. In ﬁgures 1 and 2 we have smoothing probabilities concerning to high dependence regime for the pairs BOVESPA-S&P500 and BOVESPA-FTSE100, respectively. We can observe that starting from mid 2006 the dependence relation in both pairs under analysis “jumps” to the high dependence regime. It should be reminded that at that time the ﬁrst hints about what became one of the worst ﬁnancial crises ever seen are raised. Observing ﬁgures 3 and 4, representing the dependence dynamics11 captured by estimated copulas, we can see the changing of dependence degree starting at 2006. Panel (a) at each ﬁgure gives us Pearson’s correlation (Pearson’s ρ), the dependence parameter for the Normal copula. Note that this parameter comes from values around 0.5 and 0.2 to values around 0.8 and 0.6 after 2006 for the relations BOVESPA-S&P500 and BOVESPA-FTSE100, respectively. The same behavior is observed in the tail dependence parameters from t-Student, SJC and rotated Gumbel copulas (panels (b), (c) and (d), respectively). The tail dependence parameter for t-Student copula (the same for both tails) is found around zero just before 2006, when jumps to around 0.25 for BOVESPA-S&P500 relation, and 0.1 for BOVESPA-FTSE100. This result suggests that in a regime of low dependence there is no tail dependence, whereas in a regime of high dependence tail dependence is positive. The lower tail dependence captured by SJC and rotated Gumbel copulas shows a higher degree of dependence than we ﬁnd for t-Student copula, probably due to the imposed symmetry by its elliptical funcional form. Both parameters τ L and θ (lower tail dependence parameters related to SJC and rotated Gumbel, respectively) show similar results for BOVESPA-S&P500, remaining around 0.4 in the low dependence regime and around 0.6 in the high dependence regime. In the pair BOVESPA-FTSE100, the parameter θ indicates a lower tail dependence, in the low dependence regime, higher than τ L (average 0.2 and 0.1 respectively). In the high dependence regime both parameters are found around 0.4, but τ L seems to be more volatile than θ. Concerning to the upper tail dependence parameter τ U related to SJC copula, we can see that in the low dependence regime, for BOVESPA-S&P500 relation, τ U is found around 0.3 and in the high dependence regime it is found around 0.6. In the pair BOVESPA-FTSE100, this parameter remains around 0.3 for both regimes. According to our results we can suggest the following: (i) there is a higher dependence relation between BOVESPA and S&P500 than the relations between BOVESPA and FTSE100 due to higher dependence parameter estimates for the BOVESPA-S&P500 relation compared to BOVESPA-FTSE100 relation; (ii) the smaller tail dependence we ﬁnd in the low dependence regime suggests either the non-existence of tail dependence or that it might be symmetric. In this case, one could explore not just dependence parameter changing over time but also the dependence structure itself, i.e., the functional form of the multivariate joint distribution could chance over time or alternate between a symmetric form, without tail dependence or with low tail dependence (e.g. elliptical form), and a more general functional form, as the rotated Gumbel copula which we have used in this work. Concluding remarks In the present work we study copula functions with time-varying parameters to model dependence dynamics between random variables. Our proposed model includes a novel procedure 11Considering the regimes suggested from the smoothed probabilities in ﬁgures 1 and 2. 13 of capturing time evolution of this dependence parameter, allowing it to evolve not only through a restricted ARMA, but also according to a hidden ﬁrst order Markov Chain. We propose an inference methodology to deal with this problem, pointing to asymptotic results for the estimators as well as implementing a block bootstrap procedure to estimate the parameter covariance matrix. The method performance is checked via Monte Carlo numerical simulation exercises. The approach is also applied to real data sets, explicitly to ﬁnancial market indexes. The results suggest it to be ﬂexible, adequate and capable of oﬀering relevant insights about the dependence dynamics between ﬁnancial market indexes over time. In the Monte Carlo experiments, we can notice that the model with regime switching and non-elliptical copula form not only suitably reproduces empirical features commonly found on ﬁnancial market returns as well as it is successful in estimating those features. Indirectly, we see that extreme negative returns tend to be tail-dependent whereas extreme positive returns tend to be tail-independent. In our empirical application we aim to capture the dependence structure, along with its dynamics, between BOVESPA and S&P500 and between BOVESPA and FTSE100 indexes in pairs. For this, we assume asymmetry and heavy tails in the joint distribution and use the tail dependence measure as main dependence parameter in our analysis. It is done due to the asymmetries and kurtosis excesses found in the marginal distributions. The analysis is made in a way to observe the bivariate dependence structure related to the pairs BOVESPA/S&P500 and BOVESPA/FTSE100 in two steps. Firstly, univariate skewed-t GARCH models are ﬁtted for the marginal distributions and the transformed probability integral of their residuals terms for each marginal are tested to be an uniform distribution on (0,1) interval. All used three tests, Kolmogorov-Smirnov (KS), Berkowitz (Berk) and Anderson-Darling (AD), lead to no rejection of the null hypothesis that the disturbance term for each marginal has uniform (0,1) distribution. Additionally, we infer that the marginal distributions are asymmetric as shown by the signiﬁcant estimates for coeﬃcient λi, i =BOVESPA, S&P500 e FTSE100. In a second step, using the marginal estimates, four diﬀerent time-varying copula func- tions with regime switching are ﬁtted (rotated Gumbel, Symmetrized Joe-Clayton, Normal and t-Student) to the joint distribution, and consequently to the dependence parameter. From this we can observe the dependence structure behavior over time between ﬁnancial market indexes as described in the text. With our model it is possible to identify two distinct regimes: a high dependence regime and a low dependence one. Besides the quantitative diﬀerence across the regimes, we conclude that asymmetry and kurtosis can vary across the regimes, i.e., the high dependence regime may also have a higher asymmetry and heavier tails. This can suggest that, besides the existence of asymmetric dependence, we can also have the dependence structure itself changing over timeSee Garcia and Tsafak (2009) for an application related to this issue.. Although we identify two regimes, high and low dependence, taking into account mostly just tail dependence measures, if we observe the Normal copula we can see that for both regimes BOVESPA index has a high dependence relationship with the others indexes (in this case, considering Pearson’s ρ). To avoid problems related to two step estimation process due to the fact that this procedure do not take into account the uncertainty about the parameter estimates simultaneously, we estimate the covariance matrix via block bootstrap. Therefore, in accordance with our ﬁnal consideration, our novel proposed model/method to measure the dependence dynamics between random variables that, in other words, extends the model described in Patton (2006) by introducing a hidden Markov chain to capture unobserved regime switching, seems adequate to measure and evaluate the dependence structure exhibiting features commonly found in ﬁnancial econometrics literature, such as asymmetry, among others. 14 References Anderson, T. W. and Darling, D. A. 1952. Asymptotic theory of certain goodness-of-ﬁt criteria based on stochastic processes. Ann. Math. Statistics, 23:193–212. Bartram, S.; Taylor, S. and Wang, Y. H. 2007. The euro and european ﬁnancial market integration. Journal of Banking and Finance, 31:1461–1481. Berkowitz, J. 2001. Testing density forecasts with applications to risk management. Journal of Business and Economic Statistics, 5:489–501. Bollerslev, T. 1986. Generalized autoregressive conditional heteroskedasticity. Journal of Econometrics, (94):238–276. Cherubini, U.; Luciano, E. and Vecchiato, W. 2004. Copula methods in ﬁnance. Wiley Finance. John Wiley & Sons, Ltd. Chollete, L.; Heinen, A. and Valdesogo, A. 2009. Modeling international ﬁnancial returns with a multivariate regime switching copula. Journal of Financial Econometrics, 7(4):437–480. Dias, A. and Embrechts, P. 2004. Dynamic copula models for multivariate high-frequency data in ﬁnance. Engel, R. 1982. Autoregressive conditional heteroskedasticity models with estimation of vari- ance of united kingdom inﬂation. Econometrica, (50):987–1007. Garcia, R. and Tsafak, G. 2009. Dependence structure and extreme comovements in interna- tional equity and bond markets. CIRANO Scientiﬁc series. Godambe, V. P. 1960. An optimal property of regular maximum likelihood estimation. Ann. Math. Statist., 31:1208–1211. Gumbel, E. J. 1960. Distributions des valeurs extrˆemes en plusieurs dimensions. Publications de l’Institut de Statistique de l’Universit´ede Paris. Hansen, B. 1994. Autoregressive conditional density estimation. International Economic Re- view, (35):705–730. H¨ardle, W.; Horowitz, J. and Kreiss, J.-P. 2001. Bootstrap methods for time series. Working Paper. Hu, L. 2006. Dependence patterns across ﬁnancial markets: a mixed copula approach. Applied Financial Economics, 10:717–729. Joe, H. 1997. Multivariate models and dependence concepts. Chapman & Hall, London. Joe, H. and Xu, J. 1996. The estimation method of inference functions for margins for mul- tivariate models. Technical Report 166, University of British Columbia, Department of Statistics. Jondeau, E. and Rockinger, M. 2006. The copula-garch model of contitional dependencies: an international stock market application. Journal of International Money and Finance, (25):827–853. Kemeny, J. G. and Snell, J. L. 1960. Finite markov chains. Springer-Verlag. Kim, C.-J. and Nelson, C. 1999. State-space models with regime switching: classical and Gibbs- sampling approaches with applications. MIT press. Liua, Y. and Luger, R. 2009. Eﬃcient estimation of copula-garch models. Computational Statis- tics and Data Analysis, 53:2284–2297. 15 Nelsen, R. 2006. An introduction to copulas. Springer-Verlag, New York. Patton, A. J. 2006. Modelling asymmetric exchange rate dependence. International Economic Review, 2(47):527–556. Pelletier, D. 2006. Regime-switching for dynamic correlation. Journal of Econometrics, (131):445–473. Politis, D. N. 2003. The impact of bootstrap methods on time series analysis. Statist. Science, 18:219–230. Politis, D. N. and White, H. 2004. Automatic block-length selection for the dependent boot- strap. Econometric Reviews, 23(1):53–70. Politis, D. N.; White, H. and Patton, A. J. 2007. Correction: Automatic block-length selection for the dependent bootstrap. Working Paper. Rodriguez, J. 2007. Measuring ﬁnancial contagion: a copula approach. Journal of Empirical Finance, (14):401–423. Schweizer, B. and Sklar, A. 1983. Probabilistic metric spaces. Elsevier Science. Silva Filho, O. C. and Ziegelmann, F. A. 2009. Assessing dependence between ﬁnancial market indexes using conditional time-varying copulas: Applications to value at risk (var). In Fourth Brazilian Conference on Statistical Modelling in Insurance and Finance.S˜ao Paulo- Rio de Janeiro. 16 7Tables FTSE100 BOVESPA S&P500 Mean -0.000145 0.000814 -0.000139 Median 0.000254 0.001153 0.000399 Maximum 0.093842 0.288325 0.109572 Minimum -0.092646 -0.122260 -0.094695 Standard deviation 0.013911 0.022353 0.014360 Asymmetry -0.126056 0.725801 -0.105590 Kurtosis 8.541590 16.91562 9.911983 Table 1: Summary statistics: log-return of FTSE100, BOVESPA and S&P500 BOVESPA S&P500 FTSE100 ωi 0.000014 0.000001 0.000002 (0.000000) (0.000000) (0.000000) αi 0.066197 0.10867 0.13823 (0.000151) (0.004137) (0.005505) βi 0.8985 0.88685 0.85403 (0.000112) (0.001158) (0.003215) νi 10.175 8.0198 17.519 (2.8345) (1.3563) (30.143) λi -0.095352 -0.09229 -0.13125 (0.000989) (0.003451) (0.007569) Q2(10) 0.5294 0.2237 0.9935 Q2(20) 0.8995 0.6886 0.9918 KS 0.2758 0.1832 0.3544 Berk 0.2507 0.2296 0.1273 AD 0.3910 0.3520 0.1790 Table 2: Marginal distributions results Model estimates of univariate skewed-t GARCH (mean omitted). Standard errors between brackets. Last three rows show goodness-of-ﬁt tests to the probability integral transform from margins. KS - Kolmogorov-Smirnov test p-value, Berk - Berkowitz test p-value, proposed by (Berkowitz 2001), and AD - Anderson-Darling test p-value (Anderson and Darling 1952) for uniformity. 17 BOVESPA/S&P500 BOVESPA/FTSE100 BOVESPA/S&P500 BOVESPA/FTSE100 Coeﬃcient Coeﬃcient Normal Rotated Gumbel ω0 c 4.5861 0.1121 ω0 c 0.3332 -0.8897 (0.3185) (0.0024) (0.0097) (0.0274) ω1 c 2.4842 0.4596 ω1 c -1.089 -1.5898 (0.1708) (0.0463) (0.1282) (0.0765) βc -2.7011 1.6026 βc 0.3754 0.5981 (0.0881) (0.2491) (0.0957) (0.0276) αc 0.0409 -0.0639 αc -0.4409 -0.5403 (0.0184) (0.0112) (0.1361) (0.0891) p 0.9949 0.9828 p 0.9939 0.9895 (0.0004) (0.0038) (0.0003) (0.0006) q 0.9868 0.9837 q 0.9899 0.9877 (0.0009) (0.0042) (0.0006) (0.0007) logL 616.7258 246.4187 logL 580.8390 240.8120 Coeﬃcient Coeﬃcient Symmetrized Joe-Clayton t-Student ω0 c,U 0.8662 -0.6244 ω0 c 1.3325 1.0723 (1.7861) (1.3647) (0.0921) (0.0802) ω1 c,U 2.6533 2.2947 ω1 c 2.5377 1.9853 (0.5051) (0.6377) (0.1704) (0.4438) βc,U -2.090 -4.9323 βc -0.5090 -1.5101 (1.2702) (0.0952) (0.0726) (0.0305) αc,U -6.0344 -9.9576 αc 0.1390 0.1768 (1.3270) (0.5492) (0.0244) (0.0017) ω0 c,L 0.2843 -4.5779 ν0 22.7868 18.7491 (0.1754) (1.2767) (2.0186) (2.6023) ω1 c,L 1.1107 -0.7192 ν1 11.4656 12.2976 (0.8702) (0.2104) (0.2288) (0.0937) βc,L -0.5226 -4.1666 - - - (1.7343) (0.7124) - - - αc,L -2.9645 8.3531 - - - (1.5617) (1.8906) - - - p 0.9974 0.9924 p 0.9957 0.9993 (0.0002) (0.0005) (0.0003) (0.0001) q 0.9989 0.9895 q 0.9984 0.9995 (0.0001) (0.0007) (0.0001) (0.0000) logL 594.8453 246.4440 logL 618.8957 250.2763 Table 3: Copula estimation results 18 8Figures jan/2000 jan/2001 jan/2002 jan/2003 jan/2004 jan/2005 jan/2006 jan/2007 jan/2008 jan/2009 0 0.2 0.4 0.6 0.8 1 (a) Normal jan/2000 jan/2001 jan/2002 jan/2003 jan/2004 jan/2005 jan/2006 jan/2007 jan/2008 jan/2009 0 0.2 0.4 0.6 0.8 1 (b) t−student jan/2000 jan/2001 jan/2002 jan/2003 jan/2004 jan/2005 jan/2006 jan/2007 jan/2008 jan/2009 0 0.2 0.4 0.6 0.8 1 (c) SJC jan/2000 jan/2001 jan/2002 jan/2003 jan/2004 jan/2005 jan/2006 jan/2007 jan/2008 jan/2009 0 0.2 0.4 0.6 0.8 1 (d) Rotated Gumbel Figure 1: Smoothed probabilities for high dependence regime (BOVESPA-S&P500) jan/2000 jan/2001 jan/2002 jan/2003 jan/2004 jan/2005 jan/2006 jan/2007 jan/2008 jan/2009 0 0.2 0.4 0.6 0.8 1 (a) Normal jan/2000 jan/2001 jan/2002 jan/2003 jan/2004 jan/2005 jan/2006 jan/2007 jan/2008 jan/2009 0 0.2 0.4 0.6 0.8 1 (b) t−student jan/2000 jan/2001 jan/2002 jan/2003 jan/2004 jan/2005 jan/2006 jan/2007 jan/2008 jan/2009 0 0.2 0.4 0.6 0.8 1 (c) SJC jan/2000 jan/2001 jan/2002 jan/2003 jan/2004 jan/2005 jan/2006 jan/2007 jan/2008 jan/2009 0 0.2 0.4 0.6 0.8 1 (d) Rotated Gumbel Figure 2: Smoothed probabilities for high dependence regime (BOVESPA-FTSE100) 19 jan/2000 jan/2001 jan/2002 jan/2003 jan/2004 jan/2005 jan/2006 jan/2007 jan/2008 jan/2009 0 0.2 0.4 0.6 0.8 1 (a) Normal jan/2000 jan/2001 jan/2002 jan/2003 jan/2004 jan/2005 jan/2006 jan/2007 jan/2008 jan/2009 0 0.2 0.4 0.6 0.8 1 (b) t−student jan/2000 jan/2001 jan/2002 jan/2003 jan/2004 jan/2005 jan/2006 jan/2007 jan/2008 jan/2009 0 0.2 0.4 0.6 0.8 1 (c) SJC Lower Upper jan/2000 jan/2001 jan/2002 jan/2003 jan/2004 jan/2005 jan/2006 jan/2007 jan/2008 jan/2009 0 0.2 0.4 0.6 0.8 1 (d) Rotated Gumbel Figure 3: Dependence dynamics (BOVESPA-S&P500) jan/2000 jan/2001 jan/2002 jan/2003 jan/2004 jan/2005 jan/2006 jan/2007 jan/2008 jan/2009 0 0.2 0.4 0.6 0.8 1 (a) Normal jan/2000 jan/2001 jan/2002 jan/2003 jan/2004 jan/2005 jan/2006 jan/2007 jan/2008 jan/2009 0 0.2 0.4 0.6 0.8 1 (b) t−student jan/2000 jan/2001 jan/2002 jan/2003 jan/2004 jan/2005 jan/2006 jan/2007 jan/2008 jan/2009 0 0.2 0.4 0.6 0.8 1 (c) SJC Lower Upper jan/2000 jan/2001 jan/2002 jan/2003 jan/2004 jan/2005 jan/2006 jan/2007 jan/2008 jan/2009 0 0.2 0.4 0.6 0.8 1 (d) Rotated Gumbel Figure 4: Dependence dynamics (BOVESPA-FTSE100) 20 1 regime 2 regimes −0.1 −0.05 0 0.05 0.1Error T = 1000 1 regime 2 regimes −0.1 −0.05 0 0.05 0.1Error T = 2000 1 regime 2 regimes −0.1 −0.05 0 0.05 0.1Error T = 5000 1 regime 2 regimes −0.1 −0.05 0 0.05 0.1Error 1 regime 2 regimes −0.1 −0.05 0 0.05 0.1Error 1 regime 2 regime −0.1 −0.05 0 0.05 0.1Error T = 1000 T = 2000 T = 5000 Model with 1 regime Model with 2 regimes Figure 5: Box plot - mean error for dependence parameter (Normal copula) 1 regime 2 regimes −0.3 −0.2 −0.1 0 0.1 0.2 0.3Error 1 regime 2 regimes −0.3 −0.2 −0.1 0 0.1 0.2 0.3Error 1 regime 2 regimes −0.3 −0.2 −0.1 0 0.1 0.2 0.3Error 1 regime 2 regimes −0.3 −0.2 −0.1 0 0.1 0.2 0.3Error 1 regime 2 regimes −0.3 −0.2 −0.1 0 0.1 0.2 0.3Error 1 regime 2 regimes −0.3 −0.2 −0.1 0 0.1 0.2 0.3Error T = 1000 T = 2000 T = 5000 Model with 1 regime Model with 2 regimes Figure 6: Box plot - mean error for lower tail dependence parameter (SJC copula) 21 1 regime 2 regimes −0.3 −0.2 −0.1 0 0.1 0.2 0.3Error 1 regime 2 regimes −0.3 −0.2 −0.1 0 0.1 0.2 0.3Error 1 regime 2 regimes −0.3 −0.2 −0.1 0 0.1 0.2 0.3Error 1 regime 2 regimes −0.3 −0.2 −0.1 0 0.1 0.2 0.3Error 1 regime 2 regimes −0.3 −0.2 −0.1 0 0.1 0.2 0.3Error 1 regime 2 regimes −0.3 −0.2 −0.1 0 0.1 0.2 0.3Error T = 1000 T = 2000 T = 5000 Model with 1 regime Model with 2 regimes Figure 7: Box plot - mean error for upper tail dependence parameter (SJC copula) 22","libVersion":"0.3.1","langs":""}