{"path":"lit/lit_notes_OLD_PARTIAL/Ziel16priceFrcstElecXmodel.pdf","text":"See discussions, stats, and author profiles for this publication at: https://www.researchgate.net/publication/281487498 Electricity Price Forecasting using Sale and Purchase Curves: The X-Model Article  in  Energy Economics · September 2016 DOI: 10.1016/ j.eneco.2016.08.008  · Source: arXiv CITATIONS 81 READS 733 2 author s, including: Florian Ziel University of Duisburg-Essen 75 PUBLICATIONS   1,707 CITATIONS    SEE PROFILE All content following this page was uploaded by Florian Ziel on 26 Oct ober 2017. The user has requested enhancement of the downloaded file. Electricity Price Forecasting using Sale and Purchase Curves: The X-Model Florian Ziel, Rick Steinert Europa-Universit¨at Viadrina, Große Scharrnstraße 59, 15230 Frankfurt (Oder), Germany Abstract Our paper aims to model and forecast the electricity price by taking a completely new perspective on the data. It will be the ﬁrst approach which is able to combine the insights of market structure models with extensive and modern econometric analysis. Instead of directly modeling the electricity price as it is usually done in time series or data mining approaches, we model and utilize its true source: the sale and purchase curves of the electricity exchange. We will refer to this new model as X-Model, as almost every deregulated electricity price is simply the result of the intersection of the electricity supply and demand curve at a certain auction. Therefore we show an approach to deal with a tremendous amount of auction data, using a subtle data processing technique as well as dimension reduction and lasso based estimation methods. We incorporate not only several known features, such as seasonal behavior or the impact of other processes like renewable energy, but also completely new elaborated stylized facts of the bidding structure. Our model is able to capture the non-linear behavior of the electricity price, which is especially useful for predicting huge price spikes. Using simulation methods we show how to derive prediction intervals for probabilistic forecasting. We describe and show the proposed methods for the day-ahead EPEX spot price of Germany and Austria. Keywords: electricity price forecasting, supply and demand curves, price spikes, auction data, bidding behavior, probabilistic forecasting 1. Introduction In the recent decades modeling electricity prices have become a complex and broad ﬁeld of research. Due to the liberalization of markets and increasing disclosure of data, new insights concerning the structure and behavior of the prices were gained. Researchers pointed out that there are typical characteristics of electricity prices regardless where it has been traded. These are summarized as the stylized facts of electricity prices, see e.g. Weron (2006). One of these stylized facts concerns tremendous deviations of the price pattern from its mean, called price spikes. This speciﬁc feature of electricity prices has huge impacts for research as well as politics and companies. Many electricity companies, e.g. in Germany, are obliged to market some of their electricity at an exchange, which makes their earnings prone to heavy price spikes and creates a complex task for their risk management department. Moreover, many ﬁnancial contracts such as futures or options are dependent on the variance of the price process and therefore demand eligible estimation techniques. Also long-term cost calculation for investment projects or political programs like the development of renewable energy are dependent on stable and reliable methods for calculation of electricity prices, which can account for the likelihood of price spikes. Therefore, a great variety of models for estimating the electricity price occurred during the past decades. Those models are often related to well-known models of the ﬁnance literature but Email addresses: ziel@europa-uni.de (Florian Ziel), steinert@europa-uni.de (Rick Steinert) Preprint submitted to Elsevier August 18, 2016arXiv:1509.00372v2 [q-fin.TR] 17 Aug 2016 can originate from many other ﬁelds of research. Weron (2014) for instance divides electricity price models into ﬁve diﬀerent groups, multi-agent, fundamental, reduced-form, statistical and computational intelligence models. Besides the multi-agent and fundamental approaches all models have in common that they focus on the price itself or related time series like renewable energy or electricity demand. Multi-agent models usually focus on the supply and demand of electricity to obtain prices by equilibrium, optimization or simulation (Ventosa et al. (2005), Liu et al. (2012)), but hence often do not incorporate the time-series of electricity bids and asks of a real exchange into their approaches. Fundamental approaches cover a great variety of models but mainly emphasize the basic economic and physical relationships of the market (Weron, 2014). Concerning price spikes, the distinction between diﬀerent model approaches can be reﬁned when the explicit or implicit incorporation of price spikes is considered. In the area of time series models the usage of speciﬁc heteroscedastic models for the variance of the process are typical (e.g. Bowden and Payne (2008), Liu and Shi (2013)). But standard GARCH-type models cannot account for all of the extreme price events within the data (Swider and Weber (2007)). Hence, many researcher developed extended models which can account for severe price movements. These models commonly fall into two main categories. First, there are regime- switching models, which introduce diﬀerent regimes, usually a base and a spike regime, with diﬀerent probabilities for a price spike to occur (see, for instance Karakatsani and Bunn (2008), Janczura and Weron (2012), Eichler and Tuerk (2013)). Second, there are diﬀusion models, which add a jump component, e.g. a Poisson process, to allow for price spikes (see, for instance Weron (2008), Escribano et al. (2011)). Rarely there are approaches which focus solely on the price spike itself and try to forecast the event without modeling the whole price time series, e.g. in Christensen et al. (2012). However, all of these approaches for modeling price spikes have in common that they are focused mainly on the price time series and not of the underlying mechanic which determines the price process. The electricity price can also be seen as the intersection between the part of the electricity supply and demand which was traded at an exchange. The resulting sale and purchase curves, which are also referred to as ask and bid curves or market supply and market demand curves, contain all the information which is needed to determine the market price but provide even further information on all the other prices for other market volumes. This information can be necessary especially for the estimation of the likelihood of extreme price events, as the elasticity of the price, which can be obtained from the shape of the sale and purchase curves, vastly accounts for price movements. But even though a time-series approach for modeling and especially forecasting auction data is relatively new and has not been applied for electricity price data in a comprehensible manner, modeling the structure of the supply and demand curves in general has been done by some authors, even if very little of them do utilize real auction data. Most of these models belong to the ﬁeld of fundamental models, but are also often referred to as structural models, as they try to capture the structure of the market. Many of them originate from the ﬁeld of derivative pricing and do not focus on forecasting the electricity price itself and therefore avoid the uncertainties which come along with it. Barlow (2002) is one of the ﬁrst authors in electricity price research who formulates a model motivated by real auction data of an electricity market. In his paper he uses a non-linear Ornstein-Uhlenbeck process to obtain a realistic image of the true underlying price process and is also able to capture extreme price events. In the book of Eydeland and Wolyniec (2003) in chapter 7 a basic market model approach which maps the energy supply to the price of electricity is introduced. They make use of the structure of the market by constructing the so called bid stack, which refers to the marketed aggregated supply of energy for diﬀerent prices and should, in theory, be equivalent to the sale curve at the investigated auction market.1 1We want to point out that the bid stack is not necessarily the same as the energy supply, as the bid stack includes also e.g. bidding behavior. For more information on this we suggest to read Eydeland and Wolyniec (2003) 2 Given the speciﬁc cost functions of energy generators they are able to determine the bid stack function and afterwards the system price of electricity. Another promising approach arose in the working paper of Buzoianu et al. (2005), who model the marketed supply and demand curves. They assume a linear demand function and a nonlinear supply function to construct a price-quantity model, where the intersection of both curves equals the market clearing price. To approximate the market curves they use external factors like temperature, gas energy supply and gas price. Boogert and Dupont (2008) use a market structure approach which includes the relationship of electricity demand to available capacity to forecast electricity prices and the probability of spikes for the Dutch electricity market. Another structural approach can be found in Howison and Coulon (2009) and Carmona et al. (2013) who perform an analysis of the sale and purchase structure and integrate some of its aspects by incorporating the bid stack model. Extensions to basic structural models are often done via the introduction of market speciﬁc determinants, as for instance the solar and wind power feed-in as done by Wagner et al. (2014) or CO2-emissions as done by Hendricks and Ehrhardt (2013). Some of the recent approaches try to capitalize the increasing amount of available data, especially the hourly auction data of the EPEX, which allows for a deep analysis of the real oﬀered volumes for selling and purchasing electricity. As this results usually in a large amount of data and therefore complexity, some researcher tried to simplify the resulting market curves by merging them into a new curve with desirable properties. For instance, Eichler et al. (2012) illustrate in an extended abstract an idea for modeling the German/Austrian EPEX price using the supply/demand curves. They utilize the curves to model a scaled supply and demand spread using an autoregressive time series model with weekday eﬀects. Coulon et al. (2014) try to overcome the common issue of the assumption of inelastic demands by constructing a “price curve” out of the marketed supply and demand curve for the same hour. The resulting curve exhibits many well-known typical behavioral attributes, e.g. weekday eﬀects. The price curve is then matched with a pseudo-demand curve, which is again a vertical line, where the intersection of both results in the market clearing price. A related approach is used by Aneiros et al. (2013) for the Spanish electricity market. They consider a functional modelling approach for a similar price curve as deﬁned in Coulon et al. (2014), but call it “residual demand curve”. However, in electricity price research the term residual demand curve is usually more common in the framework of market and bidding behavior (as in Hortacsu and Puller (2008), V´azquez et al. (2014) or Portela et al. (2016)). Hildmann et al. (2015) analyze empirically the impact of renewables to the real auction data of the EPEX, if they were not subsidized by the government. For instance, by manipulating the marketed supply curve accordingly they show that negative prices diminish completely when the wind power feed-in is marketed at its true marginal costs. A more detailed survey on structural models can be found in Carmona and Coulon (2014). All of these papers have in common, that they exhibit at least one of the following major drawbacks. They do not incorporate real auction data (e.g. Boogert and Dupont (2008)), they assume, that the demand is inelastic and therefore focus only on the bid stack (e.g. Eydeland and Wolyniec (2003), Howison and Coulon (2009), Carmona et al. (2013)) 2, they use simpliﬁca- tions or modulations which skip the important correlation structure between bids (e.g. Buzoianu et al. (2005), Coulon et al. (2014)) or they are not properly adjusted for forecasting real elec- tricity prices (e.g. Barlow (2002)). Besides electricity price research an econometric time- series approach which actually covers the contemporaneous nature of functionally related and time- dependent auction data can be found in Bowsher (2004), who applies a functional signal plus noise time series model to a security of the FTSE100. Our idea aims to ﬁll the gap between research done in time-series analysis, where the structure of the market is usually left out and the research done in structural analysis, where empirical 2The assumption of an inelastic demand can be justiﬁed for some markets. In the case of the electricity market for Germany and Austria on the contrary, where a large proportion of trading is done between diﬀerent energy companies on a national and international basis, the assumption of inelastic demand is not realistic. 3 data is utilized very rarely and even less thoroughly. It is especially new in the sense that it gets the best of both ends, it will provide deep inside on the bidding behavior of market participants, while still remaining a high accuracy in probabilistic forecasting of the market price. We will therefore use the true data generating process, e.g. the sale and purchase curves of the electricity price, to provide better probabilistic forecasts for extreme price movements while still modeling the time series of electricity prices by an autoregressive approach. We will use the hourly day- ahead electricity price auction data of Germany and Austria provided by the EPEX Spot, also known as Phelix. It will be shown that incorporating the sale and purchase data yields promising results for forecasting the likelihood of extreme price events. Within our approach we will be able to estimate the full prediction density of electricity prices. Our paper is organized as follows. The next section focuses on our idea and will describe the data and our observations for the EPEX Spot day-ahead auctions. We will follow up with a detailed description of our model and its speciﬁc setup for the auction data. Afterwards we show the empirical results of our approach. Our last section discusses our ﬁndings and will provide insights for possible improvements and future research. During the paper we will use the phrase “price curves” for both, the sale and purchase curve. Every price will be provided in EUR/MWh and every volume in MW, if not speciﬁed otherwise. Note that the market clearing volume is reported by the EPEX as energy in MWh. As we will only consider hourly data we denote the volume in MW. 2. Price formation process and price curves structure The electricity price of exchanges is the result of competitive bidding and oﬀering. Focusing merely on the time series of prices therefore neglects their true source. If the true sale and purchase curves were known, the price could be solely determined by the intersection of both curves - regardless of any time dependencies between diﬀerent prices. Many authors point out that the price is driven by external factors, e.g. wind and solar or electricity demand, see for instance Weron (2014). However, taking a closer look on the underlying price process, it can be stated that it is the buyers and sellers on an electricity exchange who are inﬂuenced by those factors and therefore adjust their bids. Reasons for that can be e.g. that these market participants are electricity companies who are facing heavy overproduction of electricity due to an unexpected change in wind speed or temperature or an underproduction due to outages of power plants. But those market participants are not equal, they can be investment companies, electricity producers or transmission service operators, among others. Also not all electricity producers are equal - they have distinct production portfolios and are therefore more or less likely prone to e.g. heavy weather conditions. An unexpected shift in wind production levels for instance can therefore lead to a little or vast change in prices, dependent on if the equilibrium price of the market was already mainly driven by wind producers. This diversiﬁed information is summarized in the sale and purchase curve of electricity prices. Hence, especially for estimating heavy price movements it is essential to know, if the market is capable of adjusting for external shocks easily or if a tremendous price spike will occur. This sensitivity of the intersection price can therefore be obtained by analyzing the original price curves instead of only their outcome as price time series. To motivate our idea even further, we decided on showcasing the day-ahead price of the 12.04.2015 of the EPEX Spot for Germany and Austria. We will use this day throughout our whole paper, as it provides easily traceable insights for the typical price movement process when an extreme price spike occurs. The left-hand side of Figure 1 shows the day-ahead electricity price of the 12.04.2015. In the upper and lower right-hand side the price curves for 12:00 and 13:00 and 19:00 and 20:00 respectively are provided. The horizontal axis of this area represents the trading volume and the vertical axis the price. It is shown that during the afternoon hours the electricity price heavily declined reaching even negative values. Examining the price curves for 12:00 that day on the 4 ●●● ●●●●● ● ●●●●● ● ● ● ● ● ● ●●●●● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ●● ●●●●● ● ● ● ● ● ● ● ●●●●● ● ● ● ● Sun Mon Tue −50 0 50 TimePrice in EUR/MWh ● ● 40000 45000 50000 Volume in MWh ● ● Sun 12.04.2015 12:00 supply demand intersection line Sun 12.04.2015 13:00 supply demand intersection line ●●● ●●●●● ● ●●●●●● ● ● ● ● ● ●●●●● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ●● ● ●● ●●●●● ● ● ● ● ● ● ● ●●●●● ● ● ● ● Sun Mon Tue −50 0 50 TimePrice in EUR/MWh ● ● 25000 30000 35000 Volume in MWh ● ● Sun 12.04.2015 19:00 supply demand intersection line Sun 12.04.2015 20:00 supply demand intersection line Figure 1: Market clearing price time series with supply and demand curves for 12:00 and 13:00, and 19:00 and 20:00 hours resp. on 12.04.2015 auctions. upper right-hand side two typical phenomena for such an observation can be seen. First, the traded volume is, in comparison to other hours that day, relatively high. Second, the slope of the demand curve for any price and volume combination with a lower price than the market price is extremely negative. Simultaneously, the slope of the supply curve is extremely positive for price and volume combinations with a lower price than the market price - at least for price combinations close to the actual market price. Monitoring the left- hand side of the ﬁgure shows that the price exhibited a tremendous price decline from 12:00 to 13:00. Taking into account the phenomena mentioned beforehand gives insights on why such a heavy price spike was even possible. The high amount of supplied electricity shifted the price to a level, where usually only a relatively small proportion of bids can be found, e.g. the supply and demand curves exhibited high “steps” (i.e. in horizontal). Those “steps” result in the second observation of curves having extreme negative or positive slopes close to the market price. This in turn indicates, that the equilibrium price is very sensitive to external shocks. Any sudden decrease in demand which would lead to a left-shift of the demand curve or any sudden increase in production which would lead to a right-shift of the supply curve has a great impact on the price - especially in comparison to other, higher price levels. But we can also see that the supply curve for 13:00 exhibits a slope of almost zero around the intersection price, indicating that any further decrease in demand or increase in supply will not have the same vast eﬀects than before. And indeed, the price movement from 13:00 to 14:00 was much smaller than the one from 12:00 to 13:00. In contrast, the price curves for 19:00 and 20:00 on the lower right-hand side of the ﬁgure show the typical 5 behavior of price curves when the market is not very prone to extreme events. The slopes of the price curves right from the intersection price seem not to have extremely positive and negative slopes respectively. Only the demand curve left of the intersection price seem to have a very negative slope, but matching it with the supply curve it can be seen that any shifts to the right or left will be captured by the supply curve easily and can therefore not result in a heavy price spike. Under the assumption that not only the price but also the price curves are dependent on time, we will derive a model which is tailor-made for the day-ahead auction market of the EPEX Spot in Germany and Austria for the purpose of estimating the likelihood of heavy price movements. Therefore and in order to introduce our model we need to take a closer look at the EPEX Spot market and the observed bidding structure of their participants. For our summary statistics and all computation results up to section 4 we use the data from 01.10.2012 to 19.04.2015. However, all techniques can be applied to other electricity markets in exactly the same way but under considering of their corresponding market features. The day-ahead electricity spot price of the EPEX will be traded in daily auctions at 12:00 CET for the hours of the next day. So there are in general 24 prices everyday. Due to the daylight saving time we have once a year 23 values in March and 25 values in October. For the 24 auctions on a common day we use the labels 0:00, 1:00, . . ., 23:00 within this paper. Since 2008 the electricity spot price is set to be between Pmin = −500 and Pmax = 3000. Before that there were no negative prices allowed. The traders at the EPEX can make bids for either selling or buying a certain amount of electric power. By the EPEX regulations, the minimal order size for Germany and Austria is 0.1 MW for a one hour block and the minimal price diﬀerence between diﬀerent orders is 0.1 EUR/MWh. Hence, there are in total 35001 diﬀerent possible prices on the full price grid P = {−500, −499.9, . . . , 2999.9, 3000}. But in practice not every of those possible prices is utilized. Also, a single trader can only submit up to 256 distinct price and volume combinations as oﬀers. Usually there are about 700 diﬀerent featured prices which construct each curve, which we depicted in Figure 2. The illustration shows the histogram for the amount of diﬀerent prices for both, the demand and the supply curve of electricity at the EPEX Spot. It can be seen that the range of diﬀerent prices covers approximately 200 to 1000, depending on which side of the market is considered. In general we have slightly more diﬀerent prices for the supply side. In total there were about 31000 bids on distinct prices within the considered period. Different bid prices per auction 400 600 800 10000.0000.0020.004 Demand Supply Figure 2: Amount of diﬀerent bid prices for the auctions. Moreover, there are other order types allowed, e.g. standard block orders, linked block orders and exclusive block orders. The underlying market coupling algorithm to derive the market clearing price from all submitted bids is very complex. Since February 2014 the EUPHEMIA 6 (acronym of Pan-European Hybrid Electricity Market Integration Algorithm) is used to compute the market clearing price and volume by maximizing the total welfare. This involves a market coupling of several European markets like the EPEX, APX, Nordpool and OMIE. However, the EPEX provides only the sale and purchase curves as illustrated in Figure 1, not every single bid. Solely this dataset is used for our empirical supply and demand analysis. Thus we assume indirectly that, given a certain hour, all underlying bids are standard bids (single 1-hour block). This implies that we neglect the speciﬁc impact of potential complex bids like block orders. As mentioned before, most of the prices in the price grid P where not bid at all. Nevertheless, given the price grid P we can explore the bid supply and demand volumes VS,t(P ) and VD,t(P ) at price P ∈ P and time t. Later on we will see that especially the prices with an actual bid at time t play an important role in the price coupling algorithm for the shape of the sale and purchase curves. Therefore we introduce with PS,t and PD,t the bid prices on the supply and demand side at time point t. Obviously they are deﬁned to be all prices with a positive bid volume PS,t = {P ∈ P|VS,t(P ) > 0} and PD,t = {P ∈ P|VD,t(P ) > 0}. (1) When the bids VS,t and VD,t are aggregated the well-known price curves for a certain hour can be constructed, which maps a certain amount of supply or demand to a certain price. The aggregated supply and demand volumes VS,t(P ) with P ∈ PS,t and VD,t(P ) with PD,t match exactly the corresponding points at the sale and purchase curve illustrated in the Figure 1. Mathematically precise the sale and purchase curves are characterized by St(P ) = ∑ p∈PS,t p≤P VS,t(p) for P ∈ PS,t and Dt(P ) = ∑ p∈PD,t p≥P VD,t(p) for P ∈ PD,t. (2) However, equation (2) deﬁnes the supply curve explicitly only on the price grids PS,t and PD,t. As mentioned, according to the operational rules of the EPEX the market clearing price is determined by the EUPHEMIA algorithm which involves complex orders as well. Nevertheless, it is assumed by the EPEX that the relation of two diﬀerent bid price and quantity combinations of one market participant is linear. Therefore and to simplify the used algorithm we will use linear interpolation between to diﬀerent price and quantity combinations given by {(St(P ), P )|P ∈ PS,t} and {(Dt(P ), P )|P ∈ PD,t} for the supply and demand. The market clearing price will be calculated by the resulting intersection of both price curves, rounded to two decimal places. Consequently there is sometimes a small but rather negligible diﬀerence to the true market price. In particular in 64% of all cases this price matches the market coupling price, in 89% of all cases the diﬀerence is less than 0.1 EUR/MWh which is the smallest bidding unit and in 99.8% this diﬀerence is less than 1 EUR/MWh. This fact is managed by certain rules for the traders, so that the amount of volume of the market clearing price must be delivered. To understand the characteristics of the bid volumes VS,t(P ) and VD,t(P ) better we ignore the time dependency in a ﬁrst step. We evaluate the mean bid volumes VS(P ) = 1 T T∑ t=1 VS,t(P ) and VD(P ) = 1 T T∑ t=1 VD,t(P ) (3) for the supply and demand side given a P ∈ P and the number of observations T across all hours in the database. Figure 3 shows the average bid volume of supply and demand volumes VS(P ) and VD(P ) with P ∈ P within the price range of -20 to 100. Additionally we highlighted the realized amount. We can observe that for the supply side almost all bid low prices were realized whereas for high prices only a few were. This relation is reversed for the demand side. We also observe some patterns in the bidding behavior of some traders. For example, we have quite large volumes at a price of 0, but very small amounts for e.g. 0.3 or -0.3. Furthermore we have spikes at multiples of 5, so e.g. 70.0 has a larger value than 69.0 or 71.0. This shows that agents seem to prefer to bid on round numbers. This may give indication towards the assumption that at 7 −20 0 20 40 60 80 100050100150 Price in EUR/MWhVolume in MW mean bid volume mean realized volume (a) Bid and realized volumes: supply −20 0 20 40 60 80 100050100150200250300 Price in EUR/MWhVolume in MW mean bid volume mean realized volume (b) Bid and realized volumes: demand Figure 3: Average bid volumes VS(P ) and VD(P ) for P ∈ P in the price range -20 to 100. least a noticeable amount of trading is done by human decision and not based on algorithmic trading rules. The large bid volumes at a certain price leads to a price cluster around this price. The most intense price cluster can be found at a value of zero, which can be retrieved from Figure 3. Even in the small time frame shown in Figure 1 there are four realized electricity price values very close to zero. For the auction at 12:00 we see that the high possibility for a price of zero is mainly driven by the supply side. Figure 1 also shows that for the auction at 12:00 there is another price cluster at -65, which is again driven by the supply side. And again, for the realized price we can observe two values very close to -65, e.g. the realized price for 13:00 is exactly -65.02. Price in EUR/MWhDensity −20 0 20 40 60 80 1000.000.040.08Figure 4: Histogram of realized prices (market clearing prices) in the price range -20 to 100. In Figure 4 we see the histogram of all market clearing prices. To visualize the price cluster eﬀect it is important to choose tiny histogram bins. Here every tiny rectangle represents about 0.33% of the probability mass. We observe a very spiky histogram that exhibits some properties of the bid prices in Figure 3. For example we see clearly a price cluster at zero. Here the relative frequency that the market clearing price is between -0.5 and 0.5 is with 0.634% relatively large. In contrast, the relative frequency to get a price in the neighboring intervals of the same size from -1.5 to -0.5 and 0.5 to 1.5 is only 0.079% and 0.056%, so about 10 times smaller. Other price clusters can again be found at all full integers between 10 and 60, where those clusters that are divisible by 5 are more distinct. In general the density of the electricity price is complicated due to its multi-modal shape. The modi are at the mentioned price clusters. As far as we know there is no model in electricity price modeling that at least tries to capture this behavior. In 8 contrast to that, our modeling approach will incorporate this eﬀect and thus try to capture the true market behavior more realistically. 3. Model for the supply and demand curve Modeling the supply and demand curve of electricity prices is a very complex task. Researcher who try to analyze the complex bidding structure of the supply and demand at electricity exchange usually utilize multi-agent models or fundamental models (Weron (2014)). But those approaches do rarely take into account the real time series of auction data and are therefore unsuitable for giving practical information on short-term forecasts of the electricity price time series. This is especially interesting when taking a closer look at the price curves over time. In Figure 5 we show the time series of both price curves from 13.04.2015 to 19.04.2015 in a three-dimensional plot. To put emphasis on the price scale, which is presented at the y-axis, we added a colored legend for them which can be found in the lower two pictures of the ﬁgure. The upper two pictures show the price curves on the full price grid, whereas the the two pictures in the middle focus on the price range close to the market clearing price. Judging only by the ﬁgure it can be obtained that both, the supply and the demand curve, exhibit a seasonal pattern over time with at least daily dependence. However, to our knowledge there is not a single paper for the electricity market which actually models real price curves and uses them directly to forecast real electricity price time-series by an econometric approach. Therefore the following sections will describe the necessary setup for such a model highly detailed and use references whenever our model idea makes use of a well-known econometric technique. For our model we proceed in three steps: 1. To overcome the massive amount of data we will organize the bid volumes in price classes. This will be discussed in Section 3.1. 2. We provide a stochastic model to forecast the bid volume of each price class. Section 3.2 will cover this step. 3. Given the forecasted bids within each price class we reassemble the precise bidding struc- ture by reconstructing the classes. Then we calculate the supply and demand curves to compute the market clearing price by the intersection of both curves. This will be explained in Section 3.3. We will refer to our model for the sale and purchase curves of the electricity price as X-Model throughout the paper. We choose the letter X, as it symbolizes visually the intersection of the supply and demand curve. 3.1. Price classes for bids As mentioned there are 35001 possible volumes on the full price grid P. Theoretically we could model each of these processes but this is almost unfeasible due to computational burdens. Therefore we show how to choose and apply a simple dimension reduction procedure to the price formation process that is computational manageable and still balances the related loss of information. Therefore, we merge the 35001 prices in P into a smaller amount of classes. For the bids within a price class we will assume later on that they behave similarly over time. For creating the price classes we consider the mean bid volume VS(P ) and VD(P ) at price P as deﬁned in equation (3). We use them as a measure of the importance for the price P for the supply and demand side of trading. Similarly to the deﬁniton of the price curves in equation (2), we deﬁne the mean supply and demand curves S and D. They are characterized by accumulating the mean bid volumes from equation (3) S(P ) = ∑ p∈PS p≤P VS(p) for P ∈ PS and D(P ) = ∑ p∈PD p≥P VD(p) for P ∈ PD (4) 9 TimePrice in EUR/MWhVolume in GWh ● ● ● ● ● ● ● 13.04.15 14.04.15 15.04.15 16.04.15 17.04.15 18.04.15 19.04.15 ● ● ● ● ● ● ● ● −500 0 500 1000 1500 2000 2500 3000 ● ● ● ● ● ● ● ● ● ● 15 20 25 30 35 40 45 50 55 60 (a) Supply from -500 to 3000 in EUR/MWh TimePrice in EUR/MWhVolume in GWh ● ● ● ● ● ● ● 13.04.15 14.04.15 15.04.15 16.04.15 17.04.15 18.04.15 19.04.15 ● ● ● ● ● ● ● ● 3000 2500 2000 1500 1000 500 0 −500 ● ● ● ● ● ● ● ● 20 25 30 35 40 45 50 55 (b) Demand from -500 to 3000 in EUR/MWh TimePrice in EUR/MWhVolume in GWh ● ● ● ● ● ● ● 13.04.15 14.04.15 15.04.15 16.04.15 17.04.15 18.04.15 19.04.15 ● ● ● ● ● ● ● ● −40 −20 0 20 40 60 80 100 ● ● ● ● ● ● ● ● 20 25 30 35 40 45 50 55 (c) Supply from -20 to 100 EUR/MWh TimePrice in EUR/MWhVolume in GWh ● ● ● ● ● ● ● 13.04.15 14.04.15 15.04.15 16.04.15 17.04.15 18.04.15 19.04.15 ● ● ● ● ● ● ● ● ● 120 100 80 60 40 20 0 −20 −40 ● ● ● ● ● ● ● 20 25 30 35 40 45 50 (d) Demand from -20 to 100 EUR/MWh ● ● −500 0 500 1000 1500 2000 2500 3000 Price in EUR/MWh (e) Legend from -500 to 3000 in EUR/MWh ● ● −20 0 20 40 60 80 100 Price in EUR/MWh (f) Legend from -20 to 100 in EUR/MWh Figure 5: 3d price curves from 13. April 2015 to 19. April 2015 in a price color plot with color legends. The colored circles represent the market clearing price and volume, the color matches the price in the color legends. where PS = ⋃T t=1 PS,t and PD = ⋃T t=1 PD,t are the sets of all bid prices for the supply and demand side. As in (2) the complete mean supply and demand curve is given by the linear interpolation of the characterized points of (4). The resulting mean supply and demand curve is given in Figure 6. Note that the corresponding mean supply and demand functions S and D on the price grid P are monotonically increasing. Therefore we can use the inverse functions S−1 and D−1 for the creation of the price classes. For creating the price classes we additionally require an amount of volume V∗ which will give the average amount of volume that should be represented by every price class. Then we deﬁne an equidistant volume grid V∗ = {iV∗|i ∈ N}. Using V∗ and the inverse supply and demand S−1 and D−1 we deﬁne the upper and lower values of the price classes by CS = S−1(V∗) = {S−1(iV∗)|i ∈ N} and CD = D−1(V∗) = {D−1(iV∗)|i ∈ N}. (5) Figure 6 visualizes the classifying procedure for a volume of V ∗ = 1000. For our modeling approach later on we decided to stick with a volume size for classifying of 1000, as it provides us a manageable size of classes to estimate. However, other amounts of volume are deﬁnitely plausible. Given our data we receive a total of MS = 16 and MD = 16 classes for the supply 10 24000 28000 32000 36000−500050015002500 Volume in MWPrice in EUR/MWh Mean supply Volume grid Price grid (a) Mean supply on range -500 EUR/MWh to 3000 EUR/MWh 25000 30000 35000 40000−500050015002500 Volume in MWPrice in EUR/MWh Mean demand Volume grid Price grid (b) Mean demand on range -500 EUR/MWh to 3000 EUR/MWh 26000 28000 30000 32000 34000−20020406080100 Volume in MWPrice in EUR/MWh Mean supply Volume grid Price grid (c) Mean supply on range -20 EUR/MWh to 100 EUR/MWh 28000 30000 32000 34000 36000 38000−20020406080100 Volume in MWPrice in EUR/MWh Mean demand Volume grid Price grid (d) Mean demand on range -20 EUR/MWh to 100 EUR/MWh Figure 6: Mean supply and demand curves S and D on two selected price ranges with volume grid V∗, price class bounds CS and CD for V ∗ = 1000. side and demand size. The collection of the price class bounds CS and CD which represent the price classes are given in Table 1. Note that for supply price classes c ∈ CS the price class is price class bounds CS -500, -103.9, -55.1, 1.3, 19.5, 27.5, 31.3, 36.2, 42.4, 49.2, 58.0, 72.2, 225.0, 950.0, 2883.0, 3000 CD 3000, 499.9, 157.4, 52.6, 37.3, 30.9, 28.0, 24.5, 17.8, 13.8, 11.2, 8.4, 0.0, -10.7, -200.0, -500 Table 1: Price class bounds in CS for the supply and CD and for the demand always represented by the upper bound c, whereas for demand price classes c ∈ CD the price class is always represented by the lower bound c. The price classes PS(c) for an price class upper bound c ∈ CS and PD(c) for an price class lower bound c ∈ CD are given by PS(c) = {P ∈ P|P > max{p ∈ CS|p < c}, P ≤ min{p ∈ CS|p ≥ c}} , PD(c) = {P ∈ P|P ≥ max{p ∈ CD|p ≤ c}, P < min{p ∈ CD|p > c}} . Here PS(c) and PD(c) are all prices that belong to the same price class as c. This means for instance that PS(−500) = {−500} and PS(−103.9) = {−499.9, −499.8, . . . , −103.9}. As c ∈ CS 11 and c ∈ CD uniquely describe the price classes PS(c) and PD(c) we can take c as the price class representative and refer to CS and CD as price classes even though they are only collections of price class bounds. Moreover, the associated volumes at time t to the prices classes CS and CD are given by X (c) S,t = ∑ P ∈PS (c) VS,t(P ) for c ∈ CS X (c) D,t = ∑ P ∈PD(c) VD,t(P ) for c ∈ CD. Hence X (−500) S,t gives the amount of volume bid on the supply side at exactly -500 at time t and X (−103.9) S,t the amount between inclusively -499.9 and -103.9 at time t. As an example we show several bid volume processes of selected price classes in Figure 7 in a short time perspective. Note that the illustrated bid volumes X (−500) S,t and X (3000) D,t are very important in practice, as they represent large volumes. Moreover, both bids are favored by some market participants as they will always be realized. The corresponding bid volumes are covering the price inelastic supply or demand and are also known as the must-run stack. However, these volumes are not only covering the must-run bids but also the net import and export positions and speciﬁc block orders like limit orders. We observe that they have a more distinct seasonal structure than the common bids. Due to the way we construct our classes, X (−500) S,t and X (3000) D,t are independent of the choice of volume V ∗. Every other bid volume processes, e.g. X (19.5) S,t , X (8.4) D,t , X (58.0) S,t and X (37.3) D,t , in Figure 7 has a a more complex structure. But many of them exhibit also a daily and weekly seasonal pattern. In the online appendix we provide time series plots as in Figure 7 for all bid volume processes for the full time range. As mentioned X (−500) S,t and X (3000) D,t represent large volumes. The other processes cover ap- proximately a volume of 1000, but there is an exception as well. Because of the construction of the price classes using the equidistant volume grid the last classes X (3000) S,t and X (−500) D,t tend to cover smaller volumes. However, as the corresponding bids are hardly realized the inﬂuence is negligible. 3.2. Time series model for bid classes Now we provide a model for the bid volume process X (c) S,t and X (c) D,t of the price classes PS(c) and PD(c). Therefore, we introduce X (c) S,d,h and X (c) S,d,h as the bid supply and demand volume of price class c ∈ CS resp. c ∈ CD at day d and hour h. For the well-known issue with the clock change due to daylight saving time we decided to interpolate the missing hour in March with the two hours around the missing hour and use the average of the double hours in October so that there are 24 observable prices each day. Thus, the volume processes X (c) S,d,h and X (c) S,d,h are well deﬁned. As mentioned above the processes X (−500) S,d,h and X (3000) D,d,h play an important role. But we also consider the impact of other possible sources that might inﬂuence the bidding behavior. In particular we use the EPEX market clearing price and volume of Germany and Austria of previous auctions, the planned electric power generation in Germany of conventional power plants with more than 100 MW power as well as the planned wind and solar power feed-in. The last three processes are provided by the EEX transparency database. Hence, we assume that market participants have access to this database or similar information and base their bids at least partially on those time series. Especially the impact of wind and solar energy on electricity prices due to the merit-order eﬀect is well known (see e.g. Hirth (2013), Cludius et al. (2014) or Ketterer (2014)). Therefore we introduce MX = 5 additional processes denoted by Xprice,t, Xvolume,t, Xgeneration,t, Xwind,t Xsolar,t that represent the additional information that is available at the time where the auction will take place. A sample of the considered processes is given in Figure 8. 12Mar 26 Mar 31 Apr 05 Apr 10 Apr 15 Apr 20150002500035000Volume in MW (a) X (−500) S,t with bids at exactly −500 Mar 26 Mar 31 Apr 05 Apr 10 Apr 15 Apr 20200003000040000Volume in MW (b) X (3000) D,t with bids at exactly 3000 Mar 26 Mar 31 Apr 05 Apr 10 Apr 15 Apr 2001000200030004000Volume in MW (c) X (19.5) S,t with bids in [1.4, 19.5] Mar 26 Mar 31 Apr 05 Apr 10 Apr 15 Apr 2002004006008001200Volume in MW (d) X (8.4) D,t with bids in [8.4, 11.1] Mar 26 Mar 31 Apr 05 Apr 10 Apr 15 Apr 205001000150020002500Volume in MW (e) X (58.0) S,t with bids in [49.3, 58] Mar 26 Mar 31 Apr 05 Apr 10 Apr 15 Apr 200500150025003500Volume in MW (f) X (37.3) D,t with bids in [37.3, 52.5] Figure 7: Bid volumes of certain price classes for supply and demand for four observed weeks in 2015. Similarly to X (c) S,d,h and X (c) D,d,h we introduce the slightly transformed processes Xprice,d,h, Xvolume,d,h, Xgeneration,d,h, Xwind,d,h and Xsolar,d,h at day d and hour h. Note that the planned generation as well as the projected wind and solar power is known for one day in advance so we can use e.g. Xsolar,d+1,h to predict X (c) S,d+1,h and X (c) S,d+1,h. The considered model is a simple regression approach and similar to the basic autoregressive model as used in Weron and Misiorek (2008), Maciejowska et al. (2016) or Ziel (2016a) for mod- eling the electricity price. But we will use it in a more ﬂexible way for the bid volume processes of the price classes. For example, Weron and Misiorek (2008) allow for a linear dependency of Xprice,d,h to Xprice,d−1,h, Xprice,d−2,h and Xprice,d−7,h as well as dummies on Sunday, Monday and Saturday. However, the choice of lags 1, 2 and 7 as well as the selection of the weekday dummies 13 ●●● ●●●● ● ● ●● ● ● ● ●●●●● ● ● ● ● ● ●●●●●●● ● ●●● ● ● ● ● ●●●● ● ● ●●●●●● ●●●●●● ●● ● ● ● ●●●●● ● ● ●● ●●●●●●●● ● ● ●● ● ● ●●●●●● ● ● ● ●●●● ● ●●●●● ● ●● ● ● ● ●●●●●●●●●● ●●●●●● ● ● ● ●●●● ● ●●●●●●●●●●●●●●●●●● ● ●●●●● ●●●●●●●●●●●●●●●●● ● ● ● ●●● ● ●●●●●●●●●●●●●●●●●● ● ● ●●● ●●●●●● ● ● ●● ●●● ●●●● ● ● ● ●● ● ● ● ●●●●● ● ● ●●●●●●●●●●● ● ●●● ● ● ●●●●● ● ● ●● ●●●●●●●●● ● ●● ● ●● ●●●●● ● ● ●● ● ● ● ●●●● ● ● ● ●● ● ● ● ● ●●●●●●●●●●● ●● −20 0 20 40 60 80Power in GW \u0000 \u0000 \u0000 Sun Mon Tue Wed Thu Fri Sat Sun Mon Tue Wed Thu Fri Sat 29Mar15 31Mar15 02Apr15 04Apr15 06Apr15 08Apr15 10Apr15 Price Volume Generation Wind SolarPrice in EUR/MWh −20 0 20 40 60 80 Figure 8: Sample of Xprice,t, Xvolume,t, Xgeneration,t, Xwind,t Xsolar,t from 29.03.2015 to 11.04.2015. is the same for all 24 hours. As in Ziel (2016a), we will allow for much more ﬂexibility in the model, as the structure of the data is far more complex. This applies to both, the autoregressive lag structure and the weekday structure. In Figure 9 the weekly sample mean of the bid volume processes X (−500) S,d,h and X (3000) D,d,h for our full sample time range is given. There we can see that the daily seasonal structure seems to ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● 0 5 10 15 20 18 20 22 24 26 28 30 32 HourVolume in GW ● Sun Mon Tue Wed Thu Fri Sat (a) Supply X (−500) S,d,h ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● 0 5 10 15 20 22 24 26 28 30 HourVolume in GW ● Sun Mon Tue Wed Thu Fri Sat (b) Demand X (3000) D,d,h Figure 9: Weekly mean bid volumes for each day of the week and hour of the day. depend on the day of the week, as it is typical for the electricity market clearing price or the electricity load (see e.g. Ziel et al. (2015a)). So we see that the Saturdays and Sundays have a clearly diﬀerent behavior than the other weekdays. But from 0:00 to 6:00 the Saturday seems to leave the typical pattern of a Sunday. Furthermore, we recognize that for the demand side the hours from 8:00 to 19:00 are clearly on a higher level during the working days. This is interesting, as it exactly matches the peakload standard block order at EPEX. 14 For modeling the day of the week impact we deﬁne the weekday indicators Wk(d) = { 1 , W(d) < k 0 , W(d) ≥ k where W(d) is a function that gives a number that corresponds to the weekday of day d. We use without loss of generality k = 1 for a Monday, for a Tuesday k = 2 up to k = 7 for a Sunday. To fully present the considered time series model, it is necessary to introduce the object X d,h = (X1,d,h, . . . , XM,d,h) ′ = ((X (c) S,d,h)c∈CS , (X (c) D,d,h)c∈CD, Xprice,d,h, Xvolume,d,h, Xgeneration,d+1,h, Xwind,d+1,h, Xsolar,d+1,h)′. As the planned processes (generation, wind and solar) are known one day in advance they are represented with the day d + 1 in the object X d,h. Note that the dimension of X d,h is M = MS + MD + MX (M = 16 + 16 + 5 = 37 given the used data). However, we have to model and forecast only the ﬁrst MS + MD components for each hour h which exactly match the bid volume processes of the supply and demand price classes. Moreover, we do not impose a time series model to X d,h directly, but to its zero mean process Y d,h = X d,h − µh with µh = E(X d,h). We estimate the mean µh by the corresponding sample mean. Now for each hour h the considered time series model of Y d,h = (Y1,d,h, . . . , YM,d,h)′ is con- structed that it can potentially depend linearly on Y d−k,h, but also on a diﬀerent hour Y d−k,j with j ̸= h and the introduced weekday dummies. The considered time series model for Ym,d,h for each hour h and m ∈ {1, . . . , MS + MD} is given by Ym,d,h = M∑ l=1 24∑ j=1 ∑ k∈Im,h(l,j) φm,h,l,j,kYl,d−k,j + 7∑ k=2 ψm,h,kWk(d) + εm,d,h (6) with parameters φm,h,l,j,k and ψm,h,k, Im,h(l, j) as lag sets of lags and εm,d,h as error term. We assume that the error process (εm,d,h)d∈Z is i.i.d. with constant variance σ2 m,h. The introduced parameters φm,h,l,j,k will model the linear autoregressive impact and ψm,h,k the day of the week eﬀect. The choice of lag sets Im,h(l, j) in (6) is crucial for the full model, as they specify the possible model structure. In general it holds true that larger sets Im,h(l, j) increase the likelihood of overﬁtting, even though this likelihood is limited due to our used regularized estimation technique. However, if the lag sets were chosen too small, we might miss important features in the data. Thus, we should always choose Im,h(l, j) of reasonable size. This size is determined by the user and can be chosen freely or be backed up by fundamental data analysis, e.g. the correlation structure. Please note that this procedure only determines the possible lag structure and not the ﬁnal lag structure as it only deﬁnes the set of lags which our estimation algorithm will consider. The coeﬃcients that correspond to these lags can have zero impact because of the estimation procedure. For this paper we decided on Im,h(l, j) =    {1, 2, . . . , 36} , m = l and h = j {1, 2, . . . , 8} , (m = l and h ̸= j) or (m ̸= l and h = j) {1} , m ̸= l and h ̸= j for every bid volume process of price class m. Thus, the process Ym,d,h of price class m at day d and hour h can depend on the values of the past 36 days of price class m at hour h. In contrast, Ym,d,h for a speciﬁc price class m and a speciﬁc hour h is only allowed to depend on the value of another process at another hour one with a maximum lag of 1. In all other cases a maximum lag of eight is possible. To illustrate this setting Figure 10 shows the possible dependency structure of Ym,d,h for an exemplary price class m for an hour h = 2. The left hand side of the ﬁgure 15 d 0 1 2 3 . . . 22 23 0 1 2 3 . . . 22 23 0 1 2 3 . . . 22 23 d − 1 0 1 2 3 . . . 22 23 0 1 2 3 . . . 22 23 0 1 2 3 . . . 22 23 d − 2 0 1 2 3 . . . 22 23 0 1 2 3 . . . 22 23 0 1 2 3 . . . 22 23 . . . . . . . . . . . . d − 7 0 1 2 3 . . . 22 23 0 1 2 3 . . . 22 23 0 1 2 3 . . . 22 23 d − 8 0 1 2 3 . . . 22 23 0 1 2 3 . . . 22 23 0 1 2 3 . . . 22 23 d − 9 0 1 2 3 . . . 22 23 0 1 2 3 . . . 22 23 0 1 2 3 . . . 22 23 . . . . . . . . . . . . d − 36 0 1 2 3 . . . 22 23 0 1 2 3 . . . 22 23 0 1 2 3 . . . 22 23 day target price class (h=2) g other class planned class hour hour hour X target response X possible dependency X no possible dependency X not available Figure 10: Illustration of the dependency structure for a target bid volume process of a price class at hour 2. shows a speciﬁc price class m, called target price class. The blue rectangle symbolizes the hour which was modeled, e.g. the hour 2:00. Every green rectangle gives information, if this lag is considered for modeling that hour. Red rectangles indicate that the lag is not considered as it lays outside of our lag deﬁnition, gray rectangles indicate that this data is not available as it is future information. Therefore, the target price class for one hour can be dependent on every other hour for that same price class up to eight days back in time, and on the same hour for the same price class up to 36 days back in time. The possible dependencies on other price classes is provided in the illustration in the middle. The allowed dependencies on planned regressors (generation, wind and solar) is depicted on the right hand side of the ﬁgure. The color scheme applies as well to those classes. It is worth mentioning that the model for hour 2:00 of a speciﬁc day and price class can be dependent on other hours of the regressors for planned generation of that same day, as those information is indeed available before the auction starts. Besides that it can only depend on their lagged values for exactly hour 2:00 of the previous seven days. The shift in dependence on historical values is due to our deﬁnition of the regressors. For the estimation of the parameters in (6) we use a method of high-dimensional statistics, namely the lasso estimation procedure, introduced by Tibshirani (1996). Recently it was also used in a context of electricity price forecasting by Ziel et al. (2015a), Ludwig et al. (2015), Ziel (2016a) and Gaillard et al. (2016). The lasso estimator is a penalized least square estimator, thus we require the regression representation of model (6). Therefore, let the multivariate ordinary least squares representation of (6) be: Ym,d,h = Xm,d,hβm,h + εm,d,h, (7) with the pm,h-dimensional vector of regressors Xm,d,h = (Xm,d,h,1, . . . , Xm,d,h,pm,h) ′ and βm,h = (βm,h,1, . . . , βm,h,pm,h) ′ as pm,h-dimensional parameter vector. For the considered lasso estimation procedure it is also important that the regressors in (7) are standardized. Thus, we introduce with ̃Ym,d,h = ̃Xm,d,h ̃βm,h + ̃εm,d,h, (8) the standardized version of equation (7). Here ̃Ym,d,h and the elements of ̃Xm,d,h are scaled so that they have a variance of 1. Given the scaled parameter vector ̃βm,h we can easily reproduce βm,h by rescaling. We estimate the scaled parameter vectors ̃βm,h given n observable days by 16 using the lasso estimator ̂̃βm,h: ̂̃βm,h = arg min β∈R pm,h n∑ d=1( ̃Ym,d,h − ̃Xm,d,hβ) 2 + λm,h pm,h∑ j=1 |βj| (9) where λm,h ≥ 0 is a penalty parameter. Note that for λm,h = 0 we receive the common ordinary least square estimator and for suﬃciently large λm,h we get ̂̃βm,h = 0. In general, the lasso estimator is a biased estimator. However, under certain regularity conditions the lasso estimator is consistent and asymptotic normal for the non-zero parameter components. For example, if we impose stationarity to the underlying process ̃Ym,d,h we arrive at the mentioned asymptotic properties. Still, even if the process is heteroscedastic or only periodically stationary we can achieve the same asymptotic results, see e.g. Ziel (2016b). But in general, it holds roughly spo- ken, the more the stationarity assumption of process is violated and the stronger the correlation structure in the process the worse the convergence behavior of the lasso estimator. For more theoretical and applied details on the lasso estimator we suggest Hastie et al. (2015). As estimation algorithm we use the coordinate descent approach of Friedman et al. (2007) which is a fast estimation procedure. For implementation we use the R package glmnet, see Friedman et al. (2010). The algorithm solves the lasso problem on a given grid Λm,h of λm,h values. This grid Λm,h is usually chosen to be exponential decaying. Given a grid Λm,h, we select our optimal tuning parameter λm,h by minimizing the popular Baysian information criteria (BIC) which performs conservative model selection. However, the tuning parameter could be chosen by another information criteria. Cross-validation techniques or test based approaches as introduced in Lockhart et al. (2014) might be plausible as well. Given the estimated parameters ̂̃βm,h for ̃βm,h, we calculate the lasso estimator ̂βm,h for βm,h by rescaling. With ̂βm,h which contains the estimates for ̂φm,h,l,j,k and ̂ψm,h,k we can compute a day-ahead point forecast by ̂Ym,n+1,h = M∑ l=1 24∑ j=1 ∑ k∈Im,h(l,j) ̂φm,h,l,j,kYl,n+1−k,j + 7∑ k=2 ̂ψm,h,kWk(n + 1). If we have the predicted values ̂Y1,n+1,h, . . . , ̂YMS +MD,n+1,h we obtain the bid volume forecasts ̂X1,n+1,h, . . . , ̂XMS +MD,n+1,h by adding the sample means. Using residual based bootstrap as in Ziel and Liu (2016) we can compute B bootstrap samples ̂X b m,n+1,h for b ∈ {1, . . . , B}. To capture the correlation structure of the residuals adequately we sample from the residual vector ̂εd,h = (̂ε1,d,h, . . . , ̂εMs+MD,d,h) ′ only over the days d. So, if ̂Ed = (̂εd,0, . . . , ̂εd,23) ′ denotes the daily residual vector for a day we sample from ( ̂E1, . . . , ̂En). This guarantees that the residual correlation structure within the 24 single auctions is preserved. The B bootstrap samples together with the reconstruction scheme described in the next subsection are used to receive probabilistic forecasts for Xm,n+1,h. 3.3. Reconstructing bids and price curves After computing the forecast ̂Xm,n+1,h for each class m ∈ {1, . . . , MS + MD} and hour h we model the apportionment of the forecasted bid volume ̂Xm,n+1,h for each price class. This will be useful for computing both point and probabilistic forecasts of the price curves. Especially, for the probabilistic forecast it is important to understand the bidding structure within a price class as we can use it for simulation methods. However, for forecasting the overall behavior, e.g. if we just want to see if there is a large probability for high prices, the reconstruction of the bids is not that relevant. We show that the reconstruction of the bids is relevant for the local price behavior, especially to explain price clustering. For example, if we forecast the sale volume of the price class ranging from -55.0 EUR/MWh to 1.3 EUR/MWh to be 1000 MW, we have to redistribute this volume over the diﬀerent price 17 levels within that class, e.g. -55.0, -54.9, . . ., 1.3, so that the real bidding behavior is captured well. In this example due to price clustering it is very likely that a signiﬁcant amount of the 1000 MW is bid at 0.0 EUR/MWh, as already explained in the previous section. Furthermore we have to take into account that many prices are not bid at all. This is important because of the considered linear interpolation method for creating the price curves. So even a tiny bid of 0.1 MW can have a relatively big impact on the electricity price. This holds for both, bids on the supply and demand side. As this procedure is crucial for our analysis, we brieﬂy discuss this issue in a toy example for a minor change in the supply bidding structure. Therefore we consider two scenarios, A and B, for the supply curve and keep the demand curve constant. The scenario A diﬀers only marginal from the scenario B in the bidding structure. In A there are 100 MW oﬀered at 10 EUR/MWh, whereas in B 99.9 MW were bid at 10 EUR/MWh and 0.1 MW are bid at 9.9 EUR/MWh. The detailed assumed bids and the corresponding price curves are given in Figure 11. There we can observe that the supply curve in scenario B looks more rectangular. ● ● ● ● 1000 1050 1100 1150 1200 1250 1300−10−505101520 Volume in MWPrice in EUR/MWh ● ● ● ● ● ● ● ● ● Supply curve A Supply curve B Demand curve Intersection line A Intersection line B (a) Supply and Demand curves with the corre- sponding market clearing prices. Supply, Scenario A Price -500 -10 0 10.0 20 3000 Volume 1000 20 50 200.0 50 70 Supply, Scenario B Price -500 -10 0 9.9 10.0 20 3000 Volume 1000 20 50 0.1 199.9 50 70 Demand Price 3000 22 10 0 -10 -500 Volume 1000 10 50 50 200 20 (b) Bidding structure of the supply and demand curves. Figure 11: Toy example for two supply scenarios A and B Indeed, also judging by our dataset market participants on the sale and purchase side seem to aim for a price curve that is close to a step function. In our short example, scenario A results in a market clearing price of 1.60 at a volume of 1102.0, whereas the market clearing price in B is 7.98 at a volume of 1070.1. The market clearing price is 6.38 EUR/MWh higher. This shows exemplarily, that minor change in the bidding structure can cause a severe price change, especially in price areas with only some bids, e.g. very large or very small (negative) prices. Even though this is a toy example it is surprisingly real. We can assume that the described behavior is known by at least some market participants, as we can observe that some agents try to strategically chose their bids to achieve the rectangular shape of the function. To take into account whether a certain price is traded or not, we have to model the probability of that event. We will refer to this approach as “reconstructing” throughout our paper. For reconstructed objects, we will use the accent˘. Remember that VS,t(P ) and VS,t(P ) denote the bid volume for the supply and demand at price P ∈ P at time t. Similarly as for the bid classes X (c) S,d,h and X (c) D,d,h, we introduce the hour-day transformation VS,d,h(P ) and VS,d,h(P ) of VS,t(P ) and VS,t(P ) that handles the clock change. We can express the bid volumes X (c) S,d,h and X (c) D,d,h of the price classes by X(c)S,d,h = ∑ P ∈PS (c) VS,d,h(P ) and X (c) D,d,h = ∑ P ∈PD(c) VD,d,h(P ), the sum of the bid volumes VS,d,h and VD,d,h of the prices within the price classes. However, after the price class forecasting we only have bid volumes X (c) S,d,h and X (c) D,d,h available to derive the price bids VS,d,h(P ) and VD,d,h(P ) for all prices P ∈ P. Therefore, we introduce the reconstructed bid volumes ˘VS,d,h(P ) and ˘VD,d,h(P ) at price P ∈ P for the supply and demand side. The 18 reconstructed volumes ˘VS,d,h(P ) and ˘VD,d,h(P ) should be as close as possible to the true bids VS,d,h(P ) and VD,d,h(P ) for all P ∈ P. Let πS,d,h(P ) and πD,d,h(P ) be the probabilities that VS,d,h(P ) and VD,d,h(P ) respectively is greater than zero, so there is actually a bid at this price. We assume these probabilities for the bids are constant over time. We simply estimate πS,d,h(P ) and πD,d,h(P ) by the relative frequencies ̂πS,d,h(P ) and ̂πD,d,h(P ) in the given sample. Furthermore, we assume proportionality within the bid prices in the price classes with respect to the mean volume V S(P ) and V D(P ). Then we can express the reconstructed volumed ˘VS,d,h(P ) and ˘VD,d,h(P ) by ˘VS,d,h(P ) = RS(P )V S(P ) ∑ Q∈PS (c) RS(Q)V S(Q)X (c) S,d,h, (10) ˘VD,d,h(P ) = RD(P )V D(P ) ∑ Q∈PD(c) RD(Q)V D(Q)X (c) D,d,h (11) where c is the price class of CS or CD associated with price P ∈ P and RS(P ) ∼ Ber(πS,d,h(P )) as well as RD(P ) ∼ Ber(πD,d,h(P )) are Bernoulli random variables with probabilities πS,d,h(P ) and πD,d,h(P ). We assume that the Bernoulli random variables RS(P ) and RD(P ) are independent from each other over the full price grid. Furthermore, we assume that they are independent from the error term εd,h of the time series model in (6) as well. As we have estimates for the probabilities of the Bernoulli random variables πS,d,h and πD,d,h and the mean bid volumes V S and V D we can easily simulate ˘VS,n+1,h(P ) and ˘VD,n+1,h(P ) by equations (10) and (11) given the volume forecast X (c) S,n+1,h and X (c) D,n+1,h of price classes from the time series model. These simulations can be utilized to construct forecasts. If we only want to receive point estimates for ˘VS,n+1,h(P ) and ˘VD,n+1,h(P ) we recommend to set RS(P ) and RD(P ) to one, if ̂πS,n+1,h(P ) and ̂πD,n+1,h(P ) are greater than a certain threshold and to zero otherwise. For our purpose we will consider the probability threshold of 1/12. So in our point forecasts a price is active if it occurs in average at least twice a day. For probabilistic forecasts we utilize the bootstrap samples ̂X b m,n+1,h. For any bootstrap sample ̂X b m,n+1,h we can reconstruct the prices bidding structure using (10) and (11) as well. As we assume independence between the Bernoulli random variables and the error term, we simply draw from the underlying Bernoulli distributions independently for each bootstrap sample. Similarly to equation (2) and (4) we can calculate the supply and demand volumes ˘Sd,h(P ) and ˘Dd,h(P ) associated with the price curves given the volumes ˘VS,d,h(P ) and ˘VD,d,h(P ) for the full price grid P by aggregating ˘Sd,h(P ) = ∑ p∈˘PS,d,h p≤P ˘VS,d,h(p) for P ∈ ˘PS,d,h and ˘Dd,h(P ) = ∑ p∈˘PD,d,h p≥P ˘VD,d,h(p) for P ∈ ˘PD,d,h, (12) where ˘PS,d,h = {P ∈ P|RS(P ) = 1} and ˘PD,d,h = {P ∈ P|RD(P ) = 1} are the sets of recon- structed bid prices. As for the sale and purchase curves in (2) the reconstructed points of the curve (12) must be interpolated linearly to receive the fully reconstructed supply and demand curve. The intersection of the reconstructed sale and purchase curves ˘Sd,h and ˘Dd,h provides the required market clearing volume and price. In Figure 12 illustrates the resulting reconstructed supply and demand curves ˘Sd,h and ˘Dd,h with its plain price class approximation counterpart for a selected example. As mentioned, in the main price region around 20 to 50 with many bids the diﬀerence is marginal. But in uncommon price regions, e.g. around 0, the impact is larger. In general the reconstructed price curves look much more realistic than the grouped versions. 19 20000 25000 30000 35000−500050015002500 Volume in MWPrice in EUR/MWh ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ●● ● ● ● ●●● ● ● ● ● ● ● ● ● ● ● ● Supply: price class approximation Supply: reconstructed Demand: price class approximation Demand: reconstructed (a) -500 to 3000 26000 28000 30000 32000 34000 36000−20020406080100 Volume in MWPrice in EUR/MWh ● ● ● ● ● ● ● ● ● ● ● ●● ● ● ● ● ● ● ● ● ● Supply: price class approximation Supply: reconstructed Demand: price class approximation Demand: reconstructed (b) -20 to 100 Figure 12: Example of price class approximation and reconstructed price curves ˘Sd,h and ˘Dd,h for selected price ranges. 4. Empirical results In order to show the results of our X-Model under real world conditions, we performed an rolling window out-of-sample study for the time period from 01.11.2014 to 19.04.2015. To evaluate our results, we compare our model with the results of standard models and models used frequently in the literature. Additionally, we show a detailed forecasting analysis for three days namely the 19.12.2014, 24.03.2015 and 12.04.2015. We chose those days for the following reasons. The ﬁrst day is suitable to show how price clusters can be predicted. The second day and third day are these days in the selected out-of-sample data range with the largest positive and negative price spike respectively. All in all, these days are also suitable to show all important features of the model, even though they are far from having the best point forecast performance. The detailed forecasting results of all considered days can be found in the appendix. For estimation and forecasting we use for all days in the previous 730 = 2 × 365 days (2 years) of data. Note that as we consider a rolling window forecasting study with re-estimation, all objects like the estimated price classes CS and CD as given in Table 1 vary in the out- of-sample period. We forecast the supply and demand curves and compute the corresponding market clearing price and volume as described in the previous section. For receiving probabilistic forecasts we perform residual based bootstrap with a bootstrap sample size of B = 10000. First, we will discuss the forecasted results for the market clearing price and volume of the beforementioned three selected days. This is followed up by the results for the forecasted price curves of some hours of the 12.04.2015. Finally we will show an out-of-sample forecasting study for market clearing price over the whole forecasting period For comparing our results regarding the probabilistic forecast, we consider two benchmarks. As a simple benchmark we take the weekly persistent model, sometimes called naive model, given by Xprice,d,h = Xprice,d−7,h + εd,h with εd,h iid ∼ N (0, σ2 h). (13) Furthermore, we take a more advanced regime switching model that is in principle able to cover price spikes. The model, is very close to the one used in Karakatsani and Bunn (2008). It is a Markov switching model and is given by Xprice,d,h = Xd,hbs(d,h) + εs(d,h),h with εs(d,h),h iid ∼ N (0, σ2 s(d,h),h) (14) 20 with Xd,h = (1, Xprice,d−1,h, Xprice,d−7,h, X price,d−1, Xgeneration,d,h, Xwind,d,h, Xsolar,d,h), parameter vec- tor bs(d,h), transition probabilities pi,j = P (s(d, h) = i|s(d − 1, h) = j) and s(d, h) as the latent regime at day d and hour h with smax possible states. Here X price,d−1 is the mean price of the last day. Note that the solar component is not included for the hours from 0:00, 1:00, 2:00, 3:00 and 23:00 as there is no solar energy produced during night. We estimate the regime switch- ing model with smax = 2 regimes by maximizing the likelihood with the EM-algorithm. For all benchmarks we consider the same amount of data as used for the X-Model estimation and forecasting, namely always two years. The results of the X-Model for the market clearing price and the volume of the three chosen days are given in Figure 13. The price forecast of the two benchmarks are given in Figure 14. Both ﬁgures provide probabilistic forecasts for the quantiles ranging from 0.1% to 99.9% which can be regarded as prediction intervals. For the volume forecasts in 13 we see no special behavior, the prediction intervals seem to map the daily pattern well. The observations lie all clearly within the 95% prediction bands. Thus, it seems that the method provides reliable forecasting results for the volume of these days. More interesting are the results of the X-Model for the market clearing prices, in Figures 13b, 13d and 13f. There we observe the distinct non-linear behavior of the prices. For small (especially negative) prices in 13b and 13f we see clearly left skewed prediction densities. Similarly we have noticeable right-skewed prediction densities for large prices as in 13d. Therefore, the information of previous auction data seems to capture the increased likelihood of extreme price events very well. In Figure 13b we observe that the beforementioned price clustering at diﬀerent integer price levels, e.g. at 0, can be modeled by this forecasting method. For the ﬁrst four hours of the day the three point forecast for the electricity price were extremely close to zero. So it was relatively likely to receive values at the price cluster around 0. And indeed, the three market clearing prices were in this price cluster, namely 0.05 at 1:00, 0.02 at 2:00 and 0.07 at 3:00. In general, we can observe possible price clusters in Figure 13. They are at those spots, where the transition between the colors of the legend changes abruptly. For example in Figure 13b at the price cluster at 0 at 2:00 there is an abrupt color change from cyan to ultramarine and another cluster at -50 with color change from red to yellow. The forecast plot 13f for the 12.04.2015 is also suitable to highlight the diﬀerence between common statistical outliers, i.e. random events that can happen, but are extremely rare, and price spikes that are predictable in the sense that the probability for such an event is relatively large given the available information. The 12.04.2015 was a Sunday, one week after the Easter holidays. But the 12th April opened with a clearly negative price of -14.47 at 0:00 and reached values between -79.94 to 31.93 during the day. The prices of the past week were all in the range of 12.00 to 69.03 with the last observation on 11.04.2015 23:00 at 22.11. Thus, it is usually very complicated to forecast a realistic likelihood for such negative prices with an autoregressive approach. However, our X-Model, which focuses on auction data, seems to have recognized the pattern within the data and provided a realistic conﬁdence interval nonetheless. Regarding the prediction bands in 13f we see clear changes over the day. It starts quite narrow at 0:00, becomes signiﬁcantly wider and more left-skewed at around 5:00. This peaks at 14:00 where the observed price also reaches its daily minimum. Afterwards the prediction intervals become smaller and more symmetric as the forecasts moves closer to common price levels. However, for the ﬁrst hours of the day the negative prices are not predicted by the X-Model. Thus, we have classical outliers. The benchmark models in 14e and 14f suﬀer from the same problem. However, it is remarkable that the X-Model predicts a quite large probability for negative prices for the morning and afternoon hours, especially from 13:00 to 15:00. For instance, the clear negative price at 13:00 with -65.06 lies clearly within the 99% prediction intervals. Both benchmark models in Figure 14e and 14f were not able to predict these price spikes well. Many standard electricity price models only allow for errors where the shape of the density does not depend on the predicted value. As in the persistent model the shape of the prediction density is kept 21350004000045000 HourVolume in MW 0 2 4 6 8 10 12 14 16 18 20 22 0.1% 10% 20% 30% 40% 50% 60% 70% 80% 90% 99.9% ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● (a) Volume forecast for 19.12.2014−60−40−200204060 HourPrice in EUR/MWh 0 2 4 6 8 10 12 14 16 18 20 22 0.1% 10% 20% 30% 40% 50% 60% 70% 80% 90% 99.9% ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● (b) Price forecast for 19.12.20142000025000300003500040000 HourVolume in MW 0 2 4 6 8 10 12 14 16 18 20 22 0.1% 10% 20% 30% 40% 50% 60% 70% 80% 90% 99.9% ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● (c) Volume forecast for 24.03.201520406080100120140 HourPrice in EUR/MWh 0 2 4 6 8 10 12 14 16 18 20 22 0.1% 10% 20% 30% 40% 50% 60% 70% 80% 90% 99.9% ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● (d) Price forecast for 24.03.20152500030000350004000045000 HourVolume in MW 0 2 4 6 8 10 12 14 16 18 20 22 0.1% 10% 20% 30% 40% 50% 60% 70% 80% 90% 99.9% ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● (e) Volume forecast for 12.04.2015−100−50050 HourPrice in EUR/MWh 0 2 4 6 8 10 12 14 16 18 20 22 0.1% 10% 20% 30% 40% 50% 60% 70% 80% 90% 99.9% ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● (f) Price forecast for 12.04.2015 Figure 13: Probabilistic volume and price forecast of the X-Model with point estimate (black line) and observed values (colored dots) with legend for the 19.12.2014, 24.03.2015 and 12.04.2015. The observed prices are colored as in Figure 5. constant and simply gets shifted and scaled over time. Thus they are deﬁnitely not suitable to capture the real underlying behavior. In contrast, the regime switching model in 14f is in general able to cover price spikes, as the forecast density is a mixture density. We see that at 22−40−20020406080100 HourPrice in EUR/MWh 0 2 4 6 8 10 12 14 16 18 20 22 0.1% 10% 20% 30% 40% 50% 60% 70% 80% 90% 99.9% ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● (a) Persistent model for 19.12.2014−80−60−40−200204060 HourPrice in EUR/MWh 0 2 4 6 8 10 12 14 16 18 20 22 0.1% 10% 20% 30% 40% 50% 60% 70% 80% 90% 99.9% ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● (b) Markov-Chain-Switching for 19.12.2014−20020406080100 HourPrice in EUR/MWh 0 2 4 6 8 10 12 14 16 18 20 22 0.1% 10% 20% 30% 40% 50% 60% 70% 80% 90% 99.9% ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● (c) Persistent model for 24.03.201520406080100 HourPrice in EUR/MWh 0 2 4 6 8 10 12 14 16 18 20 22 0.1% 10% 20% 30% 40% 50% 60% 70% 80% 90% 99.9% ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● (d) Markov-Chain-Switching for 24.03.2015−50050 HourPrice in EUR/MWh 0 2 4 6 8 10 12 14 16 18 20 22 0.1% 10% 20% 30% 40% 50% 60% 70% 80% 90% 99.9% ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● (e) Persistent model for 12.04.2015−80−60−40−2002040 HourPrice in EUR/MWh 0 2 4 6 8 10 12 14 16 18 20 22 0.1% 10% 20% 30% 40% 50% 60% 70% 80% 90% 99.9% ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● (f) Markov-Chain-Switching for 12.04.2015 Figure 14: Probabilistic price forecast of considered benchmarks with point estimate (black line) and observed values (colored dots) with legend for the 19.12.2014, 24.03.2015 and 12.04.2015. The observed prices are colored as in Figure 5. 14:00 and 15:00 the prediction density becomes left skewed, which provides clear indication for a price spike. However, the magnitude is not well predicted. The largest weakness of all models known so far that are designed for modeling such price 23 spikes is that they use only the information of the observed past market clearing prices and related processes like wind and solar energy. The amount of historical extreme prices, which are considered by most common models, is typically very low as they occur only rarely. Hence, such models often simply have too little data points to learn from the behavior at these price levels. The X-Model on the other hand uses the bidding information from all time points in all price regions. Thus, it can learn a lot about the price behavior in every price region, even for market clearing prices, which were never realized so far. In general, Figure 13 shows that the X-Model adopts the non-linear shape of the price curves and hands it down to the forecasts. This automatically adjusts the shape of the prediction densities. In Figure 15 the coverage probability of all out-of-sample results is visualized. Each bar represents a diﬀerent 1% quantile, whereas the color of the bar matches the speciﬁc quantile as shown in e.g. Figure 13. The ordinate represents the observed amount of values which fell into a speciﬁc estimated quantile divided by the theoretical amount of values of that quantile. If the values for the quantiles were all estimated perfectly, the bars would in our case all have a value of 1. Nevertheless, we observe that the low and high probability regions around 0 and 1 (especially the yellow to red colored regions) are clearly overrepresented, indicated by their values of greater than 1.5. This suggests that the X-Model may estimate too conservative, as it forecasts extreme events with a too small probability. For the quantile areas around 20% to 60% we observe an underrepresentation. QuantileCoverage probability 0.0 0.5 1.0 1.5 2.0 2.5 3.0 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 Figure 15: Histogram of the empirical coverage of the X-Model with uniform distribution (dashed line). The colors for the quantile match these in Figures (13) and (14). Moreover, we are able to perform forecasts and compute prediction intervals for the full price curves. In Figure 16 we exemplarily plot the forecast for the four selected hours that we discussed in the introduction. Figures 16a and 16b show a forecast at 12:00 and 13:00 where the realized price dropped from -4.96 to -65.06. In Figures 16c and 16d we have the price curves at 19:00 and 20:00 where the market clearing price increased from 27.92 to the hightest value of that day 31.93. Remember that in the 12:00 and 13:00 case in 13f the prediction densities of the market clearing price were highly left skewed and in the 19:00 and 20:00 case relatively symmetric. Both graphs of 16 show additionally to the forecasted price curves with its prediction intervals the realized supply and demand curves of the actual auction. Note that we only show the most relevant price region between -100 and 150. For the 13:00 case with the clear negative price, the observed demand and supply curves lie within the relatively narrow 90% prediction bands of both curves. But this does not mean that the market clearing price lies in the 90% prediction interval as well. The reason is that both conﬁdence intervals have a complex dependence structure. In fact, the observed price in 16b 24 35000 40000 45000 50000 55000 60000 65000−50050100150 Volume in MWPrice in EUR/MWh Supply: forecasted Supply: observed Demand: forecasted Demand: observed Prediction intervals Supply Demand 99.9% 99% 90% 50% 99.9% 99% 90% 50% (a) 12:00 35000 40000 45000 50000 55000 60000 65000−50050100150 Volume in MWPrice in EUR/MWh Supply: forecasted Supply: observed Demand: forecasted Demand: observed Prediction intervals Supply Demand 99.9% 99% 90% 50% 99.9% 99% 90% 50% (b) 13:00 20000 25000 30000 35000 40000 45000−50050100150 Volume in MWPrice in EUR/MWh Supply: forecasted Supply: observed Demand: forecasted Demand: observed Prediction intervals Supply Demand 99.9% 99% 90% 50% 99.9% 99% 90% 50% (c) 18:00 20000 25000 30000 35000 40000 45000−50050100150 Volume in MWPrice in EUR/MWh Supply: forecasted Supply: observed Demand: forecasted Demand: observed Prediction intervals Supply Demand 99.9% 99% 90% 50% 99.9% 99% 90% 50% (d) 19:00 Figure 16: Supply and demand curves forecasts with prediction bands for the 12.04.2015 and selected hours. lies only in the 99% prediction interval in Figure 13f. However, we can see quite well that the predicted intersection is at a region where both, the supply and demand curve, have a relatively large absolute slope. The magnitude of the slope even increases for more negative values. This is the reason for the clearly left-skewed prediction density, because a relatively moderate increase in the supply curve or decrease in the demand curve causes relatively large price movements. In economic terms this coincides with a situation where both the supply and the demand side is relatively inelastic in the negative price region. This induces high price volatility. At 19:00, where the market clearing price turned out to be relatively high, the prediction intervals look similar in general, but also have important diﬀerences in the detail. Here the demand side is still elastic at the region close to the market clearing price. However, for a price level of around 30 to 40 the demand side also seems to loose elasticity quite dramatically. The supply side is still quite elastic up to a price region of 50 to 60. Small volume shocks in the bidding structure are therefore likely to be compensated by the elastic supply resulting in a high likelihood of small price changes to occur. However, for medium to large volume shocks the intersection might be shifted out of the quite elastic area of the demand curve. This is detected by our model and indicated by a large volatility with a clear right-skewness of the conﬁdence interval, as can be also obtained from Figure 13b. Now we want to compare the point forecast of the proposed X-Model in the out-of-sample region from 01.11.2014 to 19.04.2015 with several common benchmarks. Even though the model is primarily designed to detect and model extreme price events with the corresponding prediction densities, it is interesting to see the performance purely based on standard error measures in comparison to other established electricity models. Denote ̂Xprice,d,h the predicted point forecast of a electricity price model at day d and hour h that corresponds to Xprice,d,h. Further we denote by D the set of all days from 01.11.2014 to 19.04.2015, except for the 29.03.2015 which we ignore here as it is the day where the time was 25 switched due to daylight saving time. So D contains in total #(D) = 169 days. We deﬁne the common error measures, e.g. the absolute mean absolute error (MAEh) at hour h and the root mean square error (RMSEh) at hour h by MAEh = 1 #(D) ∑ d∈D |Xprice,d,h − ̂Xprice,d,h|, RMSEh = √ 1 #(D) ∑ d∈D |Xprice,d,h − ̂Xprice,d,h|2. Both measures are suitable to compare point-forecasts of diﬀerent models at a certain h. Simi- larly to the MAEh and RMSEh, we deﬁne the overall MAE and RMSE by MAE = 1 24#(D) ∑ d∈D 23∑ h=0 |Xprice,d,h − ̂Xprice,d,h|, RMSE = √ √ √ √ 1 24#(D) ∑ d∈D 23∑ h=0 |Xprice,d,h − ̂Xprice,d,h|2. In general the MAE is more robust than the RMSE, as the latter is by far more sensitive to outliers. The ﬁrst two benchmarks we consider are the persistent model (Persistent) given in equation (13) and the regime switching model as presented in equation (14) with smax = 2 (Regime). The next simple benchmark that we consider is a very powerful one in terms of MAE. It uses diﬀer- ent information as our model, namely the electricity price from the Energy Exchange Austria (EXAA). This is an electricity price for Germany and Austria with the same zones for physical settlement as the German and Austrian EPEX spot price. It is traded everyday at 10:12 and the prices are known at 10:20 for market participants, which means they are especially known in advance to the EPEX auction at 12:00. Ziel et al. (2015b) show that the very simple naive estimator ̂X price d,h = X EXAA,price d,h with X EXAA,price d,h as EXAA electricity price at day d and hour h is very competitive. However, the EXAA benchmark model (EXAA) is basically beyond the competition, as it uses information which we did not explicitly include in our X-Model. But still, it can help to gain insights about possible improvements. Furthermore, we introduce two AR(p) based models, namely a univariate on Xprice,t (AR(p)) and a 24-dimensional model with 24 simple univariate AR models on X price d,h for each hour h (24-dim. AR). They are formally deﬁned by Xprice,t = φ0 + p∑ k=1 φkXprice,t−k + εt with εt iid ∼ N (0, σ2), Xprice,d,h = φh,0 + ph∑ k=1 φh,kXprice,d−k,h + εd,h with εd,h iid ∼ N (0, σ2 h). We estimate the AR models by solving the Yule-Walker equations. The optimal orders p and ph are determined by minimizing the Akaike Information Criterion (AIC) on a grid of possible orders. For the univariate AR model we search the optimal p on {1, 2, . . . , 700} which allows for dependencies of more than four weeks. For the 24-dimensional model the optimal order ph is searched on {1, 2, . . . , 50}, which allows for a memory of up to seven weeks and one day. Furthermore, we consider two more models from the literature, a wavelet based model and a more advanced time series approach. The wavelet based approached is basically the popular wavelet-ARIMA model introduced by Conejo et al. (2005). We use Daubechies 4 wavelet decom- position and model the coeﬃcients of the wavelet decomposition by an ARIMA(12,1,1). The second benchmark model is a time series based approach that is analyzed by Keles et al. (2012). 26 We select the ARMA(5,1) model with a trend component as well as their sophisticated annual, weekly and daily seasonal components. The model is suggested as one of the best models in the comparison study by Keles et al. (2012). We refer to the two models as Conejo et al. and Keles et al. respectively. The estimated MAE and RMSE values of all considered models with their estimated standard deviations are given in Table 2. The hourly MAEh and RMSEh for all models are visualized in Figure 17. Models MAE (std.dev.) % of persistent RMSE (std.dev.) % of persistent X-Model 4.35 (0.076) 40.8 6.46 (0.217) 44.3 Persistent 10.66 (0.159) 100.0 14.60 (0.240) 100.0 Regime 8.83 (0.117) 82.9 11.60 (0.197) 79.5 EXAA 3.26 (0.065) 30.6 5.23 (0.303) 35.8 AR(p) 5.91 (0.090) 55.4 8.25 (0.222) 56.5 24-dim. AR 6.96 (0.103) 65.3 9.55 (0.219) 65.4 Conejo et al. 8.02 (0.112) 75.3 10.72 (0.213) 73.4 Keles et al. 7.11 (0.099) 66.7 9.53 (0.219) 65.3 Table 2: MAE and RMSE in EUR/MWh of the X-Model and several benchmark models ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● 0 5 10 15 hMAEh in EUR/MWh 0 2 4 6 8 10 12 14 16 18 20 22 ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● X−Model Persistent EXAA Regime AR(p) 24−dim. AR Conejo et al. Keles et al. (a) MAEh ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● 0 5 10 15 20 hRMSEh in EUR/MWh 0 2 4 6 8 10 12 14 16 18 20 22 ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● X−Model Persistent EXAA Regime AR(p) 24−dim. AR Conejo et al. Keles et al. (b) RMSEh Figure 17: MAEh and RMSEh for h ∈ {0, . . . , 23} for the considered models. There we observe that the proposed X-Model performs surprisingly well, even though does not directly model the electricity price. With an MAE of 4.35 and RMSE of 6.46 it clearly outperforms all considered models, except the EXAA model with an MAE of 3.26 and RMSE of 5.23. In the night hour from 0:00 to 5:00 as well at 23:00 the X-Model seems to be at the same error magnitude as the EXAA-model and sometimes outperforms every other model under consideration. The out-of-sample MAE proportion of the X-Model in comparison to the persistent model is about 40.6%. The second best model which uses the same information as the X-Model is the AIC-selected univariate AR with a relative MAE proportion of 55.4%. Here the MAE is in absolute value 1.58 larger than the MAE of the X-Model. 5. Summary and conclusion We present a model for the day-ahead electricity spot price by directly modeling the supply and demand curves. We call our model the X-Model, as we estimate the market clearing price 27 as the intersection of the sale and purchase curve of the German-Austrian day-ahead electricity market of the EPEX. Simple dimension reduction techniques and high-dimensional statistical methods allow us to deal with the huge amount of bid data. We group the possible bid prices to price classes and assume a linear model for the bid volume for each price class. Afterwards we forecast the bid volumes in the price classes, reconstruct the sale and purchase curves and receive the corresponding market clearing price. Our empirical results show that it is possible to model the electricity prices using such an approach in a very promising way. We can capture known stylized eﬀects of the electricity price, like daily and weekly seasonalities, very well and are also able to model the newly elaborated stylized facts of price bids. The complex bidding structure for day-ahead prices allows us to model and predict extreme and rare price events by estimating realistic prediction densities for the market clearing price. The conducted out-of-sample study shows that the introduced model clearly outperforms standard methods and even very well performing methods of the recent literature in terms of densities as well as error measures like MAE and RMSE. Especially the latter was stunning and remarkable to us, as the model approach is relatively simple in its core and mainly developed for the purpose of modeling extreme price events. The provided X-Model approach opens the door to many other diﬀerent applications, es- pecially those related to policy making. One very important issue is for example the impact of market regularizations. Many countries provide subsidies for renewable energy. This causes automatically the so called merit-order eﬀect on the corresponding electricity markets. There are many papers (e.g. Sensfuß et al. (2008), McConnell et al. (2013), Cludius et al. (2014), Dillig et al. (2016)) that aim for estimating these eﬀects. With a sell and purchase curve based approach we can directly model the impact of the renewable energy. The only condition which must be met is the availability of data, like for the German and Austrian market. The advan- tage is that the sale and purchase curve based approach directly takes into account the market behavior with all its complex dependencies and non-linear properties. Common model approach are hardly able to cover such behavior. Another important application could be the evaluation of the price eﬀect by closing a power plant, e.g. due to a phase-out of nuclear or lignite based power plants. By proposing just a few assumptions for the bidding behavior and the fuel costs it is possible to postulate a proper model for the electricity market. This would allow the researcher to get realistic price forecasts that can be utilized from decision-makers. Note that such forecasts could be achieved for more than one day ahead. Given a proper model design even long run studies of several months and years are possible. This could be combined with diﬀerent scenarios for related indicators like GDP growth or fuel costs. Moreover, the paper with its proposed model can support the dialog of two model disciplines in electricity price modeling. At the moment there are classical statistical, time series and machine learning techniques that forecast the market clearing price based on observations and related time series. The other model approaches are mainly fundamental or multi-agent based electricity price models, which analyze the electricity market from a theoretical point of view and usually ignore real auction data. Even though both disciplines may diﬀer in their targeted goal of e.g. forecasting the electricity price versus understanding the market relationships, they have a major similarity. Overall they are both modeling the electricity price and aiming to approximate it as close as possible - they just take diﬀerent perspectives on it. Our approach, which is indeed based on econometric approaches, took one step towards the fundamental way of modeling and was therefore able to gain new insights which were crucial for our approach. Hence, we are convinced that this paper may provide a good starting point for increased communication between representatives of both model disciplines. Future research should also improve the considered model for the time series of bids. First of all our simpliﬁcation of linear interpolating the bids without explicitly including more complex bids like block bids should be replaced by a more realistic algorithm which provides a closer approximation to the EUPHEMIA (see e.g. Dourbois and Biskas (2015)). In this sense, the 28 market coupling in Europe as well as the inﬂuence of import and export to electricity prices can be incorporated as well (see e.g. Wehinger et al. (2013)). Also, more investigation could also be done in terms of optimizing the way of classifying the bids. Applying other methods of dimension reduction techniques for the bid data might grant great improvements as well. Another important issue concerns other relevant data used for modeling the bid volume of the price classes. For example, we ignored so far the impact of public holidays. On holidays like Christmas Eve, Christmas Day or New Year’s Day the model performs relatively poorly. Here improvement is relatively easy possible. Moreover, the inclusion of market price time series of diﬀerent markets like the intra-day price as well as auction results of related markets, such as those from neighboring countries, could be beneﬁciary for the model quality. Other useful regressors could be diﬀerent fuel costs or CO2 allowances. Also the restructuring procedure that was used for mapping the local price behavior provides a lot of space for further improvement. The probabilities that a certain price is traded or not could be modeled time-varying. 29 References Aneiros, G., Vilar, J. M., Cao, R., and San Roque, A. M. (2013). Functional prediction for the residual demand in electricity spot markets. IEEE Transactions on Power Systems, 28(4):4201–4208. Barlow, M. T. (2002). A diﬀusion model for electricity prices. Mathematical Finance, 12(4):287– 298. Boogert, A. and Dupont, D. (2008). When supply meets demand: the case of hourly spot electricity prices. Power Systems, IEEE Transactions on, 23(2):389–398. Bowden, N. and Payne, J. E. (2008). Short term forecasting of electricity prices for MISO hubs: Evidence from ARIMA-EGARCH models. Energy Economics, 30(6):3186–3197. Bowsher, C. G. (2004). Modelling the dynamics of cross-sectional price functions: an econometric analysis of the bid and ask curves of an automated exchange. Technical report, Nuﬃeld Economics Working Paper. Buzoianu, M., Brockwell, A., and Seppi, D. J. (2005). A dynamic supply-demand model for electricity prices. Technical report, Carnegie Mellon University. Carmona, R. and Coulon, M. (2014). A survey of commodity markets and structural models for electricity prices. In Quantitative Energy Finance, pages 41–83. Springer. Carmona, R., Coulon, M., and Schwarz, D. (2013). Electricity price modeling and asset valuation: a multi-fuel structural approach. Mathematics and Financial Economics, 7(2):167–202. Christensen, T., Hurn, A., and Lindsay, K. (2012). Forecasting spikes in electricity prices. International Journal of Forecasting, 28(2):400–411. Cludius, J., Hermann, H., Matthes, F. C., and Graichen, V. (2014). The merit order eﬀect of wind and photovoltaic electricity generation in Germany 2008–2016: Estimation and distributional implications. Energy Economics, 44:302–313. Conejo, A. J., Plazas, M. A., Espinola, R., and Molina, A. B. (2005). Day-ahead electricity price forecasting using the wavelet transform and ARIMA models. IEEE Transactions on Power Systems, 20(2):1035–1042. Coulon, M., Jacobsson, C., and Str¨ojby, J. (2014). Hourly resolution forward curves for power: statistical modeling meets market fundamentals. In Energy pricing models: recent advances, methods and tools. Palgrave Macmillan. Dillig, M., Jung, M., and Karl, J. (2016). The impact of renewables on electricity prices in germany–an estimation based on historic spot prices in the years 2011–2013. Renewable and Sustainable Energy Reviews, 57:7–15. Dourbois, G. A. and Biskas, P. N. (2015). European market coupling algorithm incorporating clearing conditions of block and complex orders. In PowerTech, 2015 IEEE Eindhoven, pages 1–6. IEEE. Eichler, M., Sollie, J., and Tuerk, D. (2012). A New Approach for Modelling Electricity Spot Prices Based on Supply and Demand Spreads. In Conference on Energy Finance 2012, Trond- heim, Norway, pages 1–4. Eichler, M. and Tuerk, D. (2013). Fitting semiparametric Markov regime-switching models to electricity spot prices. Energy Economics, 36:614–624. 30 Escribano, A., Ignacio Pe˜na, J., and Villaplana, P. (2011). Modelling Electricity Prices: Inter- national Evidence. Oxford Bulletin of Economics and Statistics, 73(5):622–650. Eydeland, A. and Wolyniec, K. (2003). Energy and Power Risk Management: New Developments in Modeling, Pricing, and Hedging. John Wiley & Sons, NJ, USA. Friedman, J., Hastie, T., H¨oﬂing, H., and Tibshirani, R. (2007). Pathwise coordinate optimiza- tion. The Annals of Applied Statistics, 1(2):302–332. Friedman, J., Hastie, T., and Tibshirani, R. (2010). Regularization paths for generalized linear models via coordinate descent. Journal of statistical software, 33(1):1. Gaillard, P., Goude, Y., and Nedellec, R. (2016). Additive models and robust aggregation for gefcom2014 probabilistic electric load and electricity price forecasting. International Journal of Forecasting. Hastie, T., Tibshirani, R., and Wainwright, M. (2015). Statistical learning with sparsity: the lasso and generalizations. CRC Press. Hendricks, C. and Ehrhardt, M. (2013). Clean spread options in the german electricity market. Working Paper, Bergische Universit¨at Wuppertal. Hildmann, M., Ulbig, A., and Andersson, G. (2015). Empirical analysis of the merit-order eﬀect and the missing money problem in power markets with high res shares. Power Systems, IEEE Transactions on, 30(3):1560–1570. Hirth, L. (2013). The market value of variable renewables: The eﬀect of solar wind power variability on their relative price. Energy economics, 38:218–236. Hortacsu, A. and Puller, S. L. (2008). Understanding strategic bidding in multi-unit auctions: a case study of the texas electricity spot market. The RAND Journal of Economics, 39(1):86– 114. Howison, S. and Coulon, M. C. (2009). Stochastic behaviour of the electricity bid stack: from fundamental drivers to power prices. The Journal of Energy Markets, 2(1):1–27. Janczura, J. and Weron, R. (2012). Eﬃcient estimation of Markov regime-switching models: An application to electricity spot prices. AStA Advances in Statistical Analysis, 96(3):385–407. Karakatsani, N. V. and Bunn, D. W. (2008). Forecasting electricity prices: The impact of fundamentals and time-varying coeﬃcients. International Journal of Forecasting, 24(4):764– 785. Keles, D., Genoese, M., M¨ost, D., and Fichtner, W. (2012). Comparison of extended mean- reversion and time series models for electricity spot price simulation considering negative prices. Energy Economics, 34(4):1012–1032. Ketterer, J. C. (2014). The impact of wind power generation on the electricity price in Germany. Energy Economics, 44:270–280. Liu, H. and Shi, J. (2013). Applying ARMA–GARCH approaches to forecasting short-term electricity prices. Energy Economics, 37:152–166. Liu, Z., Yan, J., Shi, Y., Zhu, K., and Pu, G. (2012). Multi-agent based experimental analysis on bidding mechanism in electricity auction markets. International Journal of Electrical Power & Energy Systems, 43(1):696–702. 31 Lockhart, R., Taylor, J., Tibshirani, R. J., and Tibshirani, R. (2014). A signiﬁcance test for the lasso. Annals of statistics, 42(2):413. Ludwig, N., Feuerriegel, S., and Neumann, D. (2015). Putting big data analytics to work: Feature selection for forecasting electricity prices using the lasso and random forests. Journal of Decision Systems, 24(1):19–36. Maciejowska, K., Nowotarski, J., and Weron, R. (2016). Probabilistic forecasting of electricity spot prices using factor quantile regression averaging. International Journal of Forecasting, 32(3):957–965. McConnell, D., Hearps, P., Eales, D., Sandiford, M., Dunn, R., Wright, M., and Bateman, L. (2013). Retrospective modeling of the merit-order eﬀect on wholesale electricity prices from distributed photovoltaic generation in the Australian National Electricity Market. Energy Policy, 58:17–27. Portela, J., Munoz, A., Sanchez-Ubeda, E., Garcia-Gonzalez, J., and Gonzalez, R. (2016). Resid- ual demand curves for modeling the eﬀect of complex oﬀering conditions on day-ahead elec- tricity markets. Power Systems, IEEE Transactions on. Sensfuß, F., Ragwitz, M., and Genoese, M. (2008). The merit-order eﬀect: A detailed analysis of the price eﬀect of renewable electricity generation on spot market prices in Germany. Energy Policy, 36(8):3086–3094. Swider, D. J. and Weber, C. (2007). Extended ARMA models for estimating price developments on day-ahead electricity markets. Electric Power Systems Research, 77(5):583–593. Tibshirani, R. (1996). Regression shrinkage and selection via the lasso. Journal of the Royal Statistical Society: Series B (Statistical Methodology), 58(1):267–288. V´azquez, S., Rodilla, P., and Batlle, C. (2014). Residual demand models for strategic bidding in european power exchanges: revisiting the methodology in the presence of a large penetration of renewables. Electric power systems research, 108:178–184. Ventosa, M., Baıllo, A., Ramos, A., and Rivier, M. (2005). Electricity market modeling trends. Energy Policy, 33(7):897–913. Wagner, A. et al. (2014). Residual demand modeling and application to electricity pricing. Energy Journal, 35(2):45–73. Wehinger, L. A., Hug-Glanzmann, G., Galus, M. D., and Andersson, G. (2013). Modeling electricity wholesale markets with model predictive and proﬁt maximizing agents. Power Systems, IEEE Transactions on, 28(2):868–876. Weron, R. (2006). Modeling and Forecasting Electricity Loads and Prices: A Statistical Approach. John Wiley & Sons, Chichester, England. Weron, R. (2008). Market price of risk implied by Asian-style electricity options and futures. Energy Economics, 30(3):1098–1115. Weron, R. (2014). Electricity price forecasting: A review of the state-of-the-art with a look into the future. International Journal of Forecasting, 30(4):1030–1081. Weron, R. and Misiorek, A. (2008). Forecasting spot electricity prices: A comparison of paramet- ric and semiparametric time series models. International Journal of Forecasting, 24(4):744– 763. 32 Ziel, F. (2016a). Forecasting electricity spot prices using lasso: On capturing the autoregressive intraday structure. IEEE Transactions on Power Systems. Ziel, F. (2016b). Iteratively reweighted adaptive lasso for conditional heteroscedastic time se- ries with applications to ar–arch type processes. Computational Statistics & Data Analysis, 100:773–793. Ziel, F. and Liu, B. (2016). Lasso estimation for GEFCom2014 probabilistic electric load fore- casting. International Journal of Forecasting, 32(3):1029–1037. Ziel, F., Steinert, R., and Husmann, S. (2015a). Eﬃcient modeling and forecasting of electricity spot prices. Energy Economics, 47:98–111. Ziel, F., Steinert, R., and Husmann, S. (2015b). Forecasting day ahead electricity spot prices: The impact of the EXAA to other European electricity markets. Energy Economics, 51:430– 444. 33 View publication stats","libVersion":"0.3.2","langs":""}