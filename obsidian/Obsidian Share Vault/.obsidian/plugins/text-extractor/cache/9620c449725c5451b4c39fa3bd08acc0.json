{"path":"lit/lit_sources.backup/Yurdakul23RiskAvrsBattDecentMktsAEMO.pdf","text":"Risk-Averse Self-Scheduling of Storage in Decentralized Markets Ogun Yurdakul∗† and Farhad Billimoria‡ ∗Energy Systems and Infrastructure Analysis Division, Argonne National Laboratory, Lemont, IL 60439, USA. †Department of Electrical Engineering and Computer Science, Technical University of Berlin 10623 Berlin, Germany ‡Department of Engineering Science, University of Oxford, Oxford OX1 2JD, United Kingdom Abstract—Storage is expected to be a critical source of ﬁrming in low-carbon grids. A common concern raised from ex-post assessments is that storage resources can fail to respond to strong price signals during times of scarcity. While commonly attributed to forecast error or failures in operations, we posit that this behavior can be explained from the perspective of risk- averse scheduling. Using a stochastic self-scheduling framework and real-world data harvested from the Australian National Electricity Market, we demonstrate that risk-averse storage resources tend to have a myopic operational perspective, that is, they typically engage in near-term price arbitrage and chase only few extreme price spikes and troughs, thus remaining idle in several time periods with markedly high and low prices. This has important policy implications given the non-transparency of unit risk aversion and apparent risk in intervention decision-making. Index Terms—electricity markets, electricity storage, self- scheduling, risk-aversion. I. INTRODUCTION In renewable-dominated power systems, electricity storage is expected to play an important role in maintaining system balance and resource adequacy. In decentralized markets, system operators (SOs) do not issue commitment instructions, instead relying upon full-strength price formation and iterative pre-dispatch systems to signal the need for additional or reduced resource commitment. During periods of scarcity, understanding the projected available capacity of resources to service load at intraday system stress points is critical to the SO’s decision-making on whether to intervene or apply emergency protocols, such as load shedding. Storage resources introduce new complexity to the problem because while the resource may be operationally available, whether it can actually charge or discharge at a point in time depends upon its state of charge (driven by prior decisions) and technical constraints. As a case in point, the lack of trans- parency on the availability of energy-limited plants was one of the key drivers of the Australian Energy Market Operator’s (AEMO) decision to suspend the National Electricity Market (NEM) in June 2022 during a period of extreme scarcity. In certain cases, storage resources were observed to not discharge during the highest prices of the day (while discharging at more Mr. Yurdakul gratefully acknowledges the support of the German Federal Ministry of Education and Research and the Software Campus program under Grant 01IS17052. Mr. Billimoria’s Doctor of Philosophy at the University of Oxford is supported by the Commonwealth PhD Scholarship, awarded by the Commonwealth Scholarship Commission of the UK (CSCUK). muted prices earlier in the day). 1 This seemingly non-intuitive behavior is commonly attributed to error or failure (e.g., in forecasting or operational management) of storage operations. Our work however proposes a second explanation: that of risk-averse self-scheduling under uncertainty, a concomitant of which is that such behavior could well be rational and utility- maximizing, and thus persist in energy markets. In the literature, risk-averse self-scheduling of thermal re- sources has been extensively studied. Risk-constrained self- scheduling is explored in [2], [3] given the internalization of the non-convex attributes of thermal resources. In [4], the conditional Value-at-Risk measure is used to develop bidding curves derived from an optimal self-schedule. For storage and in relation to decentralized markets, inter-temporal tradeoffs are considered from the perspective of look-ahead bidding to optimize state-of-charge and maximize proﬁts [5]. In [6] a risk-constrained problem is formulated for a pumped storage plant to trade-off between expected proﬁt and risks in energy and ancillary service markets. In this paper, we work out a novel risk-averse stochastic optimization framework for the self-scheduling of storage in decentralized markets under uncertain prices. In Section II, we develop the mathematical background and market architecture, leading to the precise mathematical formulation of the risk- averse scheduling problem in Section III. In Section IV, we conduct several experiments using real-world actual data from the NEM and storage resources bidding therein. Using the insights we draw from the experiments, we lay out in Section IV two key contributions of this work. First, we provide a novel explanation for the seemingly non-intuitive behavior of storage. Speciﬁcally, we demonstrate how the increasing uncertainty of prices with longer horizons can lead a risk-averse decision-maker to adopt a rational but myopic approach to dispatch. We illustrate how such a decision-maker can favor low-risk near-term dispatch decisions at more mod- erate prices rather than higher-reward but more uncertain peaks and troughs. Second, we present valuable insights into the sensitivity of the expected proﬁts to the duration and the degree of risk-aversion of a storage resource. We observe that while increasing the capacity of a storage resource can signiﬁcantly boost proﬁts for a risk-neutral decision-maker, it barely makes a dent for relatively more risk-averse decision-makers. We set 1Our online companion [1] provides an empirical record of many such observations of battery dispatch and energy prices for the NEM.arXiv:2212.00209v3 [math.OC] 17 Feb 2023 out concluding remarks and policy implications in Section V. II. MATHEMATICAL BACKGROUND We consider a storage resource trading in a decentralized electricity market. The adopted market setting does not include a centrally organized short-term forward market for energy and relies solely on the real-time market (RTM) for the spot trading of energy, settled under a marginal pricing scheme2. We assume that the resource acts as a price-taker, that is, it has no capability to exercise market power or alter market prices. We denote by k the index of each time period for which the RTM is cleared and by K the total number of time periods in the problem horizon. We represent by κ the duration of each time period k in minutes, which is the smallest indecomposable unit of time in our analysis, during which we assume the system conditions hold constant. Using our notation, an RTM cleared for a day at half-hourly intervals would correspond to κ = 30 min and K = 48. Deﬁne the set K := {k : k = 1, . . . , K}. We denote by ˜λk, k ∈ K as the uncertain energy price in time period k at the transmission system bus or zone into which the storage resource is located. We construct the vector ˜λ := [˜λ1 · · · ˜λk · · · ˜λK] T. We assume that the SO determines and publishes pre-dispatch energy prices over the K time periods in order to provide market participants and itself with advance information necessary to plan the physical operation of the power system. We write the relation ˜λ := ¯λ + ˜ϵ, where ¯λ denotes the vector of pre-dispatch energy prices and ˜ϵ is a random vector of forecast errors representing the difference between the pre-dispatch and market-clearing prices. Typically, the uncertain forecast error exhibits a greater degree of variance with extending horizon [1]. While the forecast error between pre-dispatch and market-clearing prices are likely small for the periods close to the dispatch interval, the pre-dispatch prices that eventuate may signiﬁcantly de- viate from the market price for forecast horizons well away from the actual dispatch time. We use a set of scenarios to model ˜ϵ, where ϵω denotes the vector of forecast errors in scenario ω ∈ Ω and πω denotes its associated probability of realization. We deﬁne the vector of LMPs for each scenario by λω := ¯λ + ϵω and write λω := [λ ω 1 · · · λω k · · · λ ω K], where λω k denotes the energy price in time period k of scenario ω. We next turn to the mathematical modeling of storage. We denote by p c k and p d k the charging and discharging power of the storage resource in time period k with maximum values p c M and p d M , respectively. To ensure the mutual exclusivity of the charging and discharging modes, and to reduce the computational burden of the problem, we draw upon the single binary variable storage formulation presented in [7] and enforce the following constraints: p d k − p d M uk ≤ 0, p c k − p c M (1 − uk) ≤ 0 ∀k ∈ K . (1) uk ∈ {0, 1}, p c k, p c k ≥ 0 ∀k ∈ K . (2) 2In this paper we are focused upon energy prices and do not consider, at this stage, ancillary service or other spot markets for which storage is eligible We denote the efﬁciency of the storage unit by η (assuming symmetry between charging and discharging efﬁciencies). We represent by Ek the stored energy level at the end of the time period k and write the intertemporal operational constraints: Ek = Ek−1 − 1 η pd kκ 1 h 60 min + ηp c kκ 1 h 60 min ∀k ∈ K \\ 1, (3) Ek = Eo − 1 η pd kκ 1 h 60 min + ηp c kκ 1 h 60 min ∀k ∈ {1}, (4) where Eo denotes the initial stored energy level at the begin- ning of the problem horizon. The stored energy level in each period k is bounded from above and below by EM and Em, respectively: Em ≤ Ek ≤ EM ∀k ∈ K . (5) In the next section, we harness the mathematical models laid out in this section to work out a framework for the risk-averse self-scheduling problem of a storage resource. III. RISK-AVERSE SELF-SCHEDULING Absent a short-term forward market, the storage resource is directly exposed to the uncertainty in the RTM prices. A great deal of studies in the literature considers a risk-neutral market participant, for which the storage resource may bring about large losses in some scenarios as long as those are offset by even greater gains in other scenarios. Such studies however do not cater to risk-averse decisions-makers, who constitute the focus of this work, that prefer to ward off large losses independent of potential proﬁts. A widely used measure for incorporating risk into decision- making is the Value-at-Risk (VaR). For a speciﬁed risk conﬁ- dence level α in (0, 1), α-VaR is an upper estimate of losses that is exceeded with probability 1 − α. We denote the α-VaR of the loss associated with a decision x by ζα(x). Despite presenting an intuitive representation of losses, VaR exhibits several undesirable properties, including not taking account of the losses suffered beyond ζα(x), non-coherence, and non- convexity when computed using scenarios. Instead, we draw upon the CVaR measure to manage risk in our framework. For continuous distributions, the α-CVaR of the loss for a decision x, which we denote by φα(x), is the expected loss given that the loss is greater than or equal to ζα(x). The deﬁnition of CVaR for discrete distributions is yet more subtle, which is the case in our framework as we rely on scenarios to represent uncertain prices. Rockafellar and Uryasev [8] deﬁne φα(x) for general distributions as the weighted average of ζα(x) and the expected loss strictly exceeding ζα(x). From a mathematical standpoint, CVaR presents several appealing features. Pﬂug [9] shows that it is a coherent risk measure. Most notably, φα(x) can be efﬁciently computed by minimizing a piecewise linear and convex function [8, Theorem 10], which can be cast as a linear programming (LP) problem by introducing an additional variable. A key thrust of our framework is to hedge the decision- maker against the risk of incurring high charging costs. For an associated conﬁdence level α, the α-CVaR of the uncertain charging cost over the problem horizon can be evaluated by solving the following LP problem: minimize zω,ζ Rα(x) := ζ + 1 1 − α ∑ ω∈Ω πωzω, (6) subject to zω ≥ ∑ k∈K λ ω k pc k − ζ, zω ≥ 0 (7) where the decision vector x succinctly represents the storage variables p c k, pd k, and Ek for all k in K , ζ, and the auxiliary variable zω introduced for each ω in Ω and πω denotes the probability of the scenario ω ∈ Ω. In conjunction with minimizing the risk of incurring high charging costs, 3 the decision-maker seeks to maximize the expected proﬁts of the resource over the K time periods: P(x) := ∑ ω∈Ω πω[ K∑ k=1 λ ω k (p d k − pc k)] . (8) We adjust the trade-off between these seemingly conﬂicting objectives by minimizing the weighted combination of R(x) and P(x) subject to the storage constraints laid out in Section II and the CVaR constraints presented in this section. The risk-averse self-scheduling (RASS) problem is expressed as: RASS : minimize −P(x) + βR(x), subject to (1)–(5), (7). The weight parameter β ∈ [0, ∞) tunes the decision-maker’s degree of risk-aversion. While increasing values of β under- scores the decision-maker’s desire to mitigate risk, driving down β toward zero represents a more risk-neutral decision- maker. Setting β = 0 implies that the sole objective of the decision-maker is to maximize her proﬁts—independent of the risk that her decisions entail. The RASS problem is solved on a rolling-window basis with a shrinking horizon. At the outset, it is solved for the time periods k = 1 · · · K before the uncertain price for any of the time periods is revealed, yet the optimal decisions for only the ﬁrst time period are implemented. After the RTM price for k = 1 is observed, the RASS problem is solved again for k = 2 · · · K, this time implementing the optimal decision for only k = 2, and so forth. The process repeats until the RASS problem is solved for k = K with a single-period horizon. The binding decisions of each rolling window are passed along to the subsequent window by explicitly enforcing that the stored energy level at the end of the ﬁrst, binding time period of each window be equal to the initial stored energy level at the beginning of the ensuing window. IV. CASE STUDY AND RESULTS In this section, we conduct two case studies to gain in- sights into the self-scheduling of a storage resource under different pre-dispatch price signals. The price data of both 3We would be remiss if we did not set forth that the resource faces a risk while discharging as well, that of recording low revenues if the RTM prices materialize at signiﬁcantly lower levels than their pre-dispatch counterparts. We choose to omit this risk in this paper and defer it to our future work. case studies are from the NEM. As spelled out below, we use the actual pre-dispatch prices observed in the NEM in two representative days to form the vector of pre-dispatch prices in our experiments. To construct the scenarios λω, ω ∈ Ω, we draw upon the historical differences between the pre-dispatch and RTM prices that eventuated in the NEM across 2019, yielding 11,680 observations, from which we randomly select 100 observations to form the scenarios of each case study. The price data have a temporal granularity of 30 min, that is, κ = 30 min and K = 48. Commensurate with the price data, we harness the data of the storage resources currently bidding in the NEM [10] in our experiments. Unless otherwise stated, we pick the risk conﬁdence level as α = 0.95 and the storage efﬁciency as η = 0.85 in all experiments. The data and the source code of all experiments are furnished in the online companion [1]. A. Case Study I The storage data of Case Study I are from that of the Vic- torian Big Battery, which is a grid-connected storage resource in the Australian state of Victoria with a charging/discharging power limit of 300.0 MW and an energy storage capacity of 450.0 MWh. We use the pre-dispatch prices in Victoria for June 12, 2022, which constitutes the last day before the cumulative price threshold was exceeded in Victoria, triggering the onset of a series of market interventions that culminated in AEMO suspending the NEM on June 15, 2022. We start out by solving the RASS problem for β = 0 and β = 0.4. We observe from Fig. 1 that the net discharging power (i.e., discharging power less charging power) under β = 0, by and large, closely follows the pre-dispatch prices, effectively exploiting price differences across three time windows, with the ﬁrst being between k = 11 and k = 19, second between around k = 24 and k = 36, and ﬁnally that around the price spike at k = 46. Fig. 1. Case Study I optimal storage dispatch decisions for β = 0. Each time period k has a duration of 30 minutes. We note from Fig. 2 that whereas the risk-neutral decision- maker (β = 0) waits until the price reaches the early-hour minimum at k = 11 to start charging, the risk-averse decision- maker (β = 0.4) charges at its maximum limit right at the ﬁrst two time periods, during which the pre-dispatch price is higher than that at k = 11. We attribute this seemingly counter- intuitive behavior to the fact that when the RASS problem is solved at the beginning of the horizon, charging at k = 1 entails a lower risk compared to k = 11, as the market-clearing price for the initial time periods is expected hover closely around the pre-dispatch price. Since the uncertainty in forecast error increases with the length of the look-ahead period, the risk-averse decision-maker is driven to store more energy at the beginning of the horizon vis-à-vis the risk-neutral counterpart. Fig. 2. Case Study I optimal storage dispatch decisions for β = 0.4 In this light, the risk-averse decision-maker incurs a greater lost opportunity cost by storing a higher level of energy at k = 1 and k = 2 and discharging very little before k = 11. This is because, by doing so, it reaches its maximum capacity at k = 12 and foregoes its ability to store energy when the prices are around their lowest ebb of the day at k = 13 and k = 14. In contrast, the risk-neutral decision-maker manages to store 195 MWh of energy at k = 13 and k = 14. Tellingly, in order to store energy when the prices reach the minimum of the PM hours at k = 27, the risk-averse decision maker winds up discharging at k = 25. Although it could have well discharged between k = 15 and k = 22 at higher prices and could have recorded greater revenues, it prefers to discharge at a time period closer to that during which it charges again. Indeed, the dispatch decisions under β = 0.4 is overall marred by a myopic focus. The risk averse decision-maker exploits price differences primarily at extremely short time windows, such as between k = 10 and k = 11 or between k = 25 and k = 27, unless the price signiﬁcantly rises as around k = 46. The prevailing myopic focus under β = 0.4 can be ascribed to the increasing uncertainty in forecast error with longer horizons, driving the risk-averse decision-maker to arbitrage primarily between shorter windows. A ramiﬁcation of this behavior is that the resource fails to respond to pre-dispatch price signals at time periods during which the system is in dire need. For instance, after the pre-dispatch price reaches A$481.1/MWh at k = 33 (more than a sevenfold increase from that at k = 27) the risk-averse decision-maker does not discharge any energy. Similarly, when the pre-dispatch price precipitously falls around k = 41, the risk-neutral decision- maker stores 352.9 MWh, whereas the risk-averse decision- maker does not charge at all, failing to respond to the available 65.5% price drop. As a result, after the price spikes at k = 46, the risk-neutral decision-maker discharges 176.5 MWh more energy compared to the risk-averse decision-maker, greatly aiding the SO during a period of extreme scarcity. Fig. 3 makes evident that the so-called myopic focus of the decision-maker becomes more conspicuous under increasing values of β. Around the price spike at k = 19, the storage resource discharges the highest level of energy under β = 0, followed by β = 0.1 and β = 0.2, whereas no energy is Fig. 3. Case Study I optimal net discharging levels (i.e., discharging less charging power) under different values of the weight parameter β. discharged under β = 0.3 and β = 0.4. These decisions impart the relatively less conservative decision-makers (β = 0, β = 0.1, and β = 0.2) the capability to store more energy during the price drop around k = 24 compared to those under β = 0.3 and β = 0.4. These observations are echoed in the dispatch decisions throughout the rest of the day. For instance, as β is reduced, the storage resource manages to more closely follow the pre-dispatch price signal before and around the sharp rise at k = 46. Under decreasing values of β, the storage resource discharges a higher level of energy around k = 38, gaining in turn the capability to store more energy during the dip in prices after k = 41, which it can discharge when the pre- dispatch price abruptly climbs at k = 46. B. Case Study II We next examine the battery dispatch decisions for a day in which the pre-dispatch prices are highly volatile. For this purpose, we draw upon the pre-dispatch prices in South Australia for January 16, 2019. The storage data are taken from that of the ESCRI storage resource, which is connected to the grid in South Australia and has a charging/discharging power limit of 30 MW and a capacity of 8 MWh. Fig. 4. Case Study II optimal net discharging levels under different values of the weight parameter β for α = 0.95. We begin by solving the RASS problem by increasing β from 0 to 0.5 in 0.1 increments. The results in Fig. 4 show that the relatively more risk-neutral cases (β = 0 and β = 0.1) closely follow the pre-dispatch price signals, charging/discharging at all of the seven price troughs/peaks of the day. Under β = 0.2 and β = 0.3, however, the storage resource prefers to arbitrage between only six and four time windows, respectively, whereas under β = 0.4, it capitalizes on only the widest price spread, charging and discharging once throughout a highly volatile day. Most notably, under β = 0.4, the resource relinquishes the chance to take advantage of a 56.7% price difference between k = 22 and k = 23 when the price falls precipitously, yet changes course three periods later and records a 126.7% rise between k = 23 and k = 26. Fig. 5. Total expected proﬁts under different values of β and EM . We observe that the storage fails to reach its maximum charging and discharging power in the simulations, because if it were to sustain its maximum charging power over 30 minutes, it would exceed its total energy capacity. As such, we explore how the recorded proﬁts would have evolved had the storage resource had a different capacity. To this end, we repeat the experiments by varying EM from 4.0 MWh to 24.0 MWh with 4.0 MWh increments. We note from Fig. 5 that, across most values of β, the total expected proﬁts rise under growing values of EM , which can be ascribed to an increased ability to leverage price differences under a larger storage capacity. As β increases, however, the proﬁts seem to be plagued by diminishing returns, and indeed plateau at a certain EM level as β increases beyond 0.2. These observations bring home that risk attitudes (via increasing β values) can create higher hurdles to notching greater proﬁts, which are not necessarily mitigated by a larger storage capacity. Fig. 6. Total expected proﬁts under different values of α and β. In Fig. 6, we examine the inﬂuence of the risk conﬁdence level α as well as β on the total expected proﬁts over the K time periods. Note that, driving down α toward zero brings Rα(x) toward the expected value of the charging costs, signifying a more risk-neutral decision-maker. In contrast, in- creasing α toward one drives Rα(x) towards the highest value the costs can take, representing a more conservative decision- maker. Fig. 6 bears out the diminished capability of risk-averse decision-maker to respond to pre-dispatch price signals and to arbitrage, manifesting itself through dwindling proﬁts under increasing values of β and α. These results reafﬁrm the well- known relationship between risk and proﬁt, whereby expected proﬁts climb under less conservative decisions, characterized by the values of α and β approaching zero. V. CONCLUSION AND POLICY IMPLICATIONS We model the self-scheduling problem of a risk-averse storage resource in decentralized markets. Four core results are gleaned from the analysis. First that risk-aversion tends to lead to a myopic approach to dispatch most notably evident in seeking to arbitrage between near-term intervals, rather than taking charging positions in the expectation of more proﬁtable but risky revenues much later in the look-ahead period. Second that risk aversion tends to lead to reduced proﬁts because of the conservative operating stance adopted by the resource. Third, that this conservatism can mean that the resource forgoes opportunities to dispatch at peak spot prices, which are times of highest system scarcity. Finally, and importantly, while higher energy storage capacity can mitigate low proﬁts, increasing the storage capacity has virtually no impact on proﬁtability for higher risk-aversion levels. There are important policy implications that ﬂow from this study. First, SOs need to be acutely aware of the role of risk aversion in storage resource dispatch and bidding. In particular, higher levels of risk aversion may mean that storage resources may not be available for dispatch at times where scarcity price signals are most evident. As risk aversion itself is a non-observable quantity, this introduces uncertainty into an SO’s short-term and medium term reliability forecasts, and risk into its decision-making on market intervention. This points to an increasing need for system transparency on key storage parameters including state-of-charge so that SOs have a better view on available storage capacity. Finally, it points to the need for the SO itself to develop a set of tools that quantify such risks and allow for better risk-adjusted decisions on intervention and other system operations during scarcity. REFERENCES [1] O. Yurdakul and F. Billimoria. Online companion to risk-averse self-scheduling of storage in decentralized markets. [Online]. Available: https://github.com/oyurdakul/pesgm23 [2] A. Conejo, F. Nogales, J. Arroyo, and R. Garcia-Bertrand, “Risk- constrained self-scheduling of a thermal power producer,” IEEE Trans- actions on Power Systems, vol. 19, no. 3, pp. 1569–1574, 2004. [3] A. Papavasiliou, Y. He, and A. Svoboda, “Self-Commitment of Com- bined Cycle Units Under Electricity Price Uncertainty,” IEEE Transac- tions on Power Systems, vol. 30, no. 4, pp. 1690–1701, 2015. [4] R. A. Jabr, “Robust self-scheduling under price uncertainty using con- ditional value-at-risk,” IEEE Transactions on Power Systems, vol. 20, no. 4, pp. 1852–1858, 2005. [5] Y. Wang, Y. Dvorkin, R. Fernandez-Blanco, B. Xu, T. Qiu, and D. S. Kirschen, “Look-ahead bidding strategy for energy storage,” IEEE Transactions on Sustainable Energy, vol. 8, no. 3, pp. 1106–1117, 2017. [6] J. Kazempour, M. Moghaddam, M. Haghifam, and G. R. Youseﬁ, “Risk-constrained dynamic self-scheduling of a pumped-storage plant in the energy and ancillary service markets,” Energy Conversion and Management, vol. 50, no. 5, pp. 1368–1375, 2009. [7] Y. Chen and R. Baldick, “Battery storage formulation and impact on day ahead security constrained unit commitment,” IEEE Transactions on Power Systems, 2022. [8] R. T. Rockafellar and S. Uryasev, “Conditional value-at-risk for general loss distributions,” Journal of banking & ﬁnance, vol. 26, no. 7, pp. 1443–1471, 2002. [9] G. C. Pﬂug, “Some remarks on the value-at-risk and the conditional value-at-risk,” in Probabilistic constrained optimization. Springer, 2000, pp. 272–281. [10] AEMO. (2022) Market Data NEMWeb - Information Registry. [Online]. Available: https://https://aemo.com.au/en/energy-systems/electricity/ national-electricity-market-nem/data-nem/market-data-nemweb","libVersion":"0.3.2","langs":""}