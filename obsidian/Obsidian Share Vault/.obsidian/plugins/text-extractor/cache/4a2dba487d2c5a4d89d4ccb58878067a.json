{"path":"lit/sources/Wang21FlexibleMethodStateofhealth.pdf","text":"Energy Reports 7 (2021) 6375–6383 Contents lists available at ScienceDirect Energy Reports journal homepage: www.elsevier.com/locate/egyr Research paper A flexible method for state-of-health estimation of lithium battery energy storage system Zhenpo Wang a,b, Chunbao Song a,b, Changgui Yuan a,b, Xiaoyu Li c,∗ a National Engineering Laboratory for Electric Vehicles, School of Mechanical Engineering, Beijing Institute of Technology, Beijing 100081, China b Collaborative Innovation Center of Electric Vehicles in Beijing, Beijing Institute of Technology, Beijing 100081, China c Tianjin Key Laboratory of Power Transmission and Safety Technology for New Energy Vehicles, School of Mechanical Engineering, Hebei University of Technology, Tianjin 300401, China a r t i c l e i n f o Article history: Received 19 June 2021 Received in revised form 14 August 2021 Accepted 13 September 2021 Available online 4 October 2021 Keywords: Lithium-ion batteries State of health Curvature analysis Numerical model a b s t r a c t Prognostics of battery health conditions are regarded as significant tools for ensuring safety and stabil- ity of battery energy storage systems. Meanwhile, flexible and practical techniques are promising and innovative for achieving accurate and cost-effective state estimation. Herein, a novel curvature-based method is proposed to track battery degradation conditions. The proposed technique can ingeniously capture the health features of an aged battery from incremental capacity curves. Specifically, an advanced filter is employed to smooth the incremental capacity curves. Secondly, a self-definition sine function is applied to fit the smoothed incremental capacity curves. The curvature-based technique provides an essential manner for extracting the health features including the peak value and position from the fitted incremental capacity curves. On this basis, a flexible cost-effective numerical aging model is constructed by mapping the relationship between the feature indicators and battery capacity for battery health prognostic. Finally, for verification of the generalization and accuracy, the developed model is to estimate battery health conditions with the same type of battery under different experimental conditions. Experimental results of two types of batteries manifest that the proposed algorithm can provide accurate and credible battery health conditions with maximum relative errors of less than 4%. © 2021 The Authors. Published by Elsevier Ltd. This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/). 1. Introduction Lithium-ion batteries have widely penetrated into various ap- plications such as portable devices, electric vehicles (EVs), and energy storage systems (ESSs), owing to prominent properties in power and energy density, long cycle lifetime, and low self- discharging (Hu et al., 2019; Roman et al., 2021; Yang et al., 2021). However, the performances of battery capacity and power will gradually decrease with the irreversible physicochemistry process during the continuous operation conditions. The phe- nomenon not only affects the users’ experience but also can reduce the safety and reliability of these battery applications (Wei et al., 2018b; Li et al., 2020). Hence, flexible and practical tech- niques are necessary to predict and estimate battery actual avail- able capacity and states for the sake of realizing intelligent bat- tery health management. Reviewing amounts of previous literature, the existing battery health prognostic approaches can be concluded as experiment- based and algorithm-based methods (Yang et al., 2018a; Ma et al., ∗ Corresponding author. E-mail address: lixiaoyu@hebut.edu.cn (X. Li). 2021; Gao et al., 2018). According to the fundamental battery health definition, there exist many determinate stress factors such as temperature, current-rate (C-rate), depth-of-discharging (DOD) affecting battery degradation (Deng et al., 2018; Cai et al., 2018). Hence, the experiment-based method requires sufficient tested data, which usually takes many months or years and causes a tremendous financial burden. Obviously, the method is very cumbersome and unpractical for online battery health diagnostics (Yuan et al., 2017). To avoid the time-consuming of the experiment-based method, some battery degradation models such as equivalent circuit model (ECM) and block-box model are constructed considering various stress factors during the battery aging process (Wang et al., 2017; Hu et al., 2016). Here, the algorithm-based method can be divided into model-based and data-driven based according to these mentioned before models. The model-based algorithm profoundly explores the relation- ship between battery degradation and inside physicochemistry changes (Hannan et al., 2017; Jokar et al., 2016). Typically, the battery aging process along with internal resistance increase and capacity fade. Chen et al. utilized a genetic algorithm to identify physical elements of first-order ECM during the discharging stage. Then the actual ohm internal resistance is used to reflect battery https://doi.org/10.1016/j.egyr.2021.09.054 2352-4847/© 2021 The Authors. Published by Elsevier Ltd. This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by- nc-nd/4.0/). Z. Wang, C. Song, C. Yuan et al. Energy Reports 7 (2021) 6375–6383 Nomenclature EVs electric vehicles ESSs energy storage systems SOC state of charge RUL remaining useful lifetime CC constant-current ECM equivalent circuit model OCV open circuit voltage ELM extreme learning machine SVM support vector machine MA moving averaging MAE mean absolute error RLS recursive least square BMS battery management system DOD depth of discharging SOH state of health IC incremental capacity CV constant-voltage RC resistance–capacitance Ah ampere hour SEI solid-electrolyte interface GPR Gaussian process regression SG Savitzky–Golay RMSE root mean square error health conditions (Chen et al., 2013). Lv et al. employed extreme learning machine (ELM) to predict battery health state with bat- tery internal resistance identified by the least square method (Pan et al., 2018). Although the ECM-based model has been recognized as a straightforward approach to evaluating battery health levels, the parameter identification of the model cannot accurate and steady represents battery health conditions. To compensate for this drawback, some scholars analyzed the growth of the solid- electrolyte interface (SEI) film is primary mechanism for battery degradation (Li et al., 2018b; Park et al., 2017). The finding gives important guidelines for building an accurate electrochemical aging model. However, the model contains tens of various param- eters that dynamic with battery aging and operation conditions. The circumstance seems to be an impenetrable barrier to realize online battery health estimation. Hence, to compromise the trade-off between accuracy and computation cost, data-driven models are considered to capture battery health conditions using acceptable datasets. Benefiting from the fast-growing machine learning algorithm, exemplary algorithms including artificial neural network, supporting vector machine (SVM), and Gaussian process regression (GPR) are ap- plied to extract significant health indicators from tested data and estimate battery health conditions (Weng et al., 2013; Wei et al., 2018a). Yang et al. extracted high-related health indicators from evolved voltage curves during the charging process. Then the SVM algorithm is applied to modeling the mapping relationship between features and battery capacities (Yang et al., 2018b; Patil et al., 2015). Similarly, Howey et al. also obtained significant features from battery charging voltage curves and the modified GPR algorithm is used to estimate battery SOH (Li et al., 2018a; Richardson et al., 2017). Although the methods mentioned above have demonstrated promising prediction results, the data-driven models are without considering specified physical meanings of corresponding experimental data. Driven by this thought, com- bining the physical meanings with machine learning algorithm, our previous publish proposed a dual GPR-based model to predict battery remaining useful lifetime (RUL) and estimate SOH by ex- tracting the significant features from the incremental capacity (IC) curves (Li et al., 2019a,b). However, there exist some drawbacks to this coupled method, which still spend plenty of modeling cost and these feature mutual interference as well as sensitive to noise disturbances. Summarily, the battery internal state parameter estimation can be divided into model-based and data-driven-based methods. For the model-based method, the models generally contain tens of various parameters that will be an impenetrable barrier to real- ize online battery health estimation. Additionally, the data-driven methods primarily utilize machine learning algorithms, which require a high-performance processor with an inappropriate cost. To realize flexible and practical battery health estimation, a novel and reasonably simple method based on IC curves is proposed to capture significant features under constant-current charging stage. In particular, the concept of curvatures and specified volt- age of IC curves are introduced and some significant features are adopted to analyze battery degradation. Assisting the proposed modified curvature-based method, the corresponding specified voltages of IC peaks can be picked easily from disordered voltage data. Whereafter, the strong-nonlinear relationship between the specific voltages and battery health conditions is fitted using a two-order polynomial. Then the battery health conditions can be tracked through the fitting polynomial. Four batteries under var- ious test profiles, which include different C-rates and discharging cut-off voltages, are used to verify the developed method. Some error analysis methods are used to comprehensively evaluate the performances of the proposed method. The remainder of this paper is organized as follows: Section 2 introduces battery aging phenomena and specific experimental profiles. Based on the aging data, the curvature technique for capturing significant health features is presented in Section 3. Section 4 describes the results and discussions of the proposed numerical models for two application scenarios, followed by the key conclusions are summarized in Section 5. 2. Battery degradation data description To provide enough experimental data, four lithium batteries are selected from two different manufacturers and are carried out at different tested schedules in this section. Two of four batteries are labeled N5#, N7#, which are the second-generation, Gen 2, 18650-size LIBs produced by Idaho National Laboratory, are obtained from the NASA Ames Prognostics Center of Excel- lence (Goebel et al., 2008). The other two batteries are named Y1#, Y2#, which also are 18650-size LIBs made in Shen Zhen, China. The degradation tests of four batteries all undergo three stages including constant-current (CC) and constant-voltage (CV) charging mode, constant-current discharging mode, where the four batteries are tested at ambient temperature (24 ◦C) with a sampling frequency of 1 Hz. For charging mode, the four bat- teries are carried out with one C-rate in the CC stage and CV stage. During the CV stage, the charging process stops until the current drop into 0.01 C-rate with all four batteries reach upper cut-off voltages. Here, the specific experimental conditions are summarized in Table 1. Considering battery actual operation conditions, the batteries N5#, N7# are discharging with continued one current-rate under two different low cut-off voltages 2.7 V and 2.2 V, respectively. To simulate extreme discharging conditions, the batteries Y1#, Y2# discharge with continued 3 C-rate and 3.6 C-rate at temperatures 24 ◦C. The test profiles and capacity degradation tendencies of four batteries are presented in Fig. 1. The four batteries charge with the same CC–CV modes and the evolution curves of current and voltage are described in Fig. 1(a). Here the two charging 6376 Z. Wang, C. Song, C. Yuan et al. Energy Reports 7 (2021) 6375–6383 Fig. 1. The battery aging cycle schemes and capacity degradation profiles: (a) Two completed aging cycle tests for voltage and current for the two types’ batteries; (b) capacity degradation tendencies of the four batteries. currents keep 1 C-rate until the corresponding voltage reaches an upper cut-off voltage of 4.2 V. Whereafter, the charging process stops when the charging current below to 20 mA during the CV period. The battery capacities of aging experiments are shown in Fig. 1(b), where the capacity tendencies present different non- linear changes. Meanwhile, the different discharging C-rates and depth-of-discharging can lead to the degradation routes inconsis- tent. Hence, it is necessary to provide some practical techniques to solve these mentioned above severe problems. 3. Incremental capacity analysis and curvature calculation The peak value and position of IC curves have a strong re- lationship with battery capacity degradation, which has been widely reported in many publications. The general discussed bat- tery operation in an ideal environment or offline experiment condition. However, the battery features of IC curves are obtained using various signal sample devices. Typically, battery manage- ment systems (BMS) are inconvenient or even impossible to extract the corresponding features during the actual operation period. Thus, the most challenging problem is to determine and capture the peak of IC curves accurately. In fact, the approximate scope of peak position has been learned according to many offline experimental results. Currently, the primary two questions for flexible estimation battery SOH are included: (1) how to obtain steady IC curves? (2) how to capture the peak position of IC curves flexibly? 3.1. Obtaining steady IC curves—filter methods IC curves are treated as an effective tool for estimating battery SOH, which is defined as a proportion of differential capacity and voltage during ideal CC charging conditions. Hence, before calculating the values of IC curves, the battery charged capacity and voltage should be known. The corresponding battery capacity and voltage can be calculated as follows, Q = ∫ t τ =1 Idτ (1) V = f (Q ), Q = f −1(V ) (2) here t and I are charging time and current, respectively. Owning to the charging current is constant in the CC stage, the calculation formula of IC curve is derived as (f −1) ′ = dQ dV = I · dt dV = I · dt dV (3) From the Eq. (3), the values of IC have a significant relation with voltage interval. The small voltage interval easily suffers from noise perturbations while the large interval may lose the vital feature information. To overcome these problems, some filter methods are utilized to assistant extraction significant infor- mation from smooth IC curves. In this work, the moving averaging (MA) and Savitzky–Golay (SG) filter methods are proposed to smooth the IC curves. Here, the data collected from the first cycle of battery Y1# that are used to analyze and compare the results of two filter methods. MA method uses the partial average for smoothing purposes, where takes raw IC data as a series of number and the moving window is set as N. The MA method is described as follows, y(i) = 1 N N−1∑ j=0 x(i + j) (4) where x(·) and y(·) are input–output signals, respectively. Gener- ally, the noise perturbations can be eliminated using the thought of average. Obviously, the smooth results of the method strictly rely on window size. However, it is difficult and time-consuming to choose a suitable size for quantitative analysis. SG filter takes advantage of property in the high-frequency digital signal filter, which mainly uses the local least-squares polynomial approximation algorithm for a time-domain data fil- ter (Cleveland et al., 2017). The prominent characteristics of the SG filter have maintained the shape and height of the IC curves. The simple construction of the filter is following, y(i) = j=m∑ j=−m 1 N Cjx(i + j) (5) The basic formula is similar to the MA method, where x(i) is the original IC data and Cj is the coefficient given by the least square algorithm, and y(·) is the output signals. N denotes the number of convoluting integers, which is equal to the win- dow size (2m+1). The specific SG filter algorithm is described in Table 2. Theoretically, the SG filter method takes advantage of fitting its neighbors’ data and using the least-square algorithm to calcu- late corresponding coefficients for achieving smooth each sample point. Nevertheless, the thought of the MA method is to average some noises for eliminating the interferences of extreme noises, where the filter results primarily depend on suitable window size. Additionally, the SG filter method has an excellent capability to get more steady filtered curves in peak, head and tail. Here the two methods are used to compare and analyze the smooth results of the original IC curves in the first cycle of the battery Y1#, as shown in Fig. 2(a). In the zoom figures, the SG filter method can not only obtain smooth IC curves in peak positions but also can obtain steadier results in the head and the tail of the IC curve. Therefore, the method can give significant feature indicators for battery health diagnosis in the future step. The SG filter method 6377 Z. Wang, C. Song, C. Yuan et al. Energy Reports 7 (2021) 6375–6383 Table 1 The four batteries’ specific cycle condition. Battery label Batteries’ cycle condition Charging cut-off voltage (V) Discharging cut-off voltage (V) Charging constant current (A) Discharging current (A) Temperature ( ◦C) N5# 4.2 2.7 1.5 2 24 N7# 4.2 2.2 1.5 2 24 Y1# 4.2 2.7 2.5 7.5 24 Y2# 4.2 2.7 2.5 9 24 Fig. 2. The IC curves analysis of the exemplary battery: (a) compared two different filter methods for initial IC curve; (b) the tendencies of IC curves for the degradation battery Y1#. Table 2 The Savitzky–Golay filter. (1) Initialization N = 2m + 1 x = [x−m, x−m+1, . . . , xm−1, xm] (2) Fit data points by polynomial yi = a0 + a1xi + a2xi 2 + . . . + ak−1xi k−1 Y(2m+1)×1 = X(2m+1)×k · Ak×1 + E(2m+1)×1 (3) A least-squares solution of A ˙A = (X T · X )−1 · X T · Y (4) The filtering result of Y ˙Y = X · A = X · (X T · X )−1 · X T · Y has prominent performances to extract the peak position from the IC curve. Therefore, in this study, the SG method is applied to smooth the IC curves. Based on the SG method, the detailed tendencies of filtered IC curves for the degradation battery Y1#, as shown in Fig. 2(b). 3.2. Capturing the peak position of IC curves—curvature calculation In this section, the techniques’ difficulties in capturing peak positions are addressed in the two-step procedure to fit the IC curve and calculate curvature. For the sake of obtaining the peak position for quantitative analysis, the self-definition sine function is proposed to fit the IC peak curves considering the fundamental shape. Meanwhile, the fitting parameters are identified using the least square algorithm as well. The constructed function is described as follows, ICfit (V ) = n∑ i=1 ai sin(biV + ci) (6) where a is the amplitude of the fitting curves, which can adjust the height of the IC peak. The parameters b and c can control the wavelength for sine wave. For realizing the accurate fitting, here the recursive least square (RLS) is applied to obtain the related parameters. The detailed process of parameter identification is list in Table 3. ε is the model error, the φ and θ are data matrix (voltage, IC) and parameters matrix. However, the fitting error cannot be avoided when execute to identify procedures. Herein, Table 3 The RLS based parameter identification. (5) Initialization φ0, θ0, P0, K0 (6) Data iteration{ φk = [Et,k−1 Et,k−2 I0,k I0,k−1 I0,k−2] θk = [α1 α2 α3 α4 α5]T (7) Computation for error covariance matrix and gain{ Kk = Pk−1φT k 1+φk Pk−1φT k Pk = Pk−1 − KkφT k Pk−1 (8) Update model parameter{ εk = yk − φkθk ⌢ θ k = ⌢ θ k−1 + Kkεk to balance the identification accuracy and complexity, n is set as 3 for handling with curve fitting process. After getting the fitting function, the core issue is to accurately pick the peak position from IC curves. Considering the rela- tionship between peak and curvature, a novel curvature-based method is proposed to track the peak position by capturing max- imum curvature. Combining the proposed fitting function Eq. (6) with the regular curvature formula, the calculation process of IC curvatures as follows (Gong and Goksel, 2019), K = ⏐ ⏐d 2 ( ICfit ) /dV 2⏐ ⏐ (1 + ( dICfit /dV )2) 3 2 (7) where K refers to the curvature of IC curves, d2(IC fit )/dV 2 and d(IC fit )/dV are the second and first derivatives of fitting IC func- tion. It is worth noting that the curvatures are scalar and positive values, which may result in incorrect extraction. In-depth analysis the mechanism of IC curves, the peak positions of IC curves should occur in a positive axis during the charging process. Mean- while, the neighbors of IC peak impossible exist in a similar valley. Hence, it is guaranteeing that the maximum curvatures are corresponding to the peak of IC curves. Additionally, analyzing the peak arisen rough position, the curvature calculation can be limited in a specific voltage range that also can reduce the computation burden for further practical application. 6378 Z. Wang, C. Song, C. Yuan et al. Energy Reports 7 (2021) 6375–6383 Fig. 3. The proposed curvature technique for capturing feature variables of the battery Y1# under different cycles based on IC curves. (a) An example of curvature technique for capturing peak position; (b) the features extraction from IC curves under different cycles. Fig. 4. The framework of the modified curvature-based method for battery SOH estimation. To ensure the robustness and steady of the proposed method, here we modified the proposed normal curvature method by fusion curvatures with change rules of IC values. The IC values are normalized in a specific range from 0 to 1. Similarly, the original curvatures also are normalized in the same voltage range. The modified method named weighted curvature method that is calculated through multiply normalized IC values by normalized curvatures. In fact, the peak of the IC curve must be the maximum value of IC values in a limited voltage range. The normalized IC values can be supposed as weight factors to improve the capability of a curvature-based analysis method to capture peak position. The weighted curvature method is applied in this study, which is defined as follows, Kw(V ) = Knorm(V ) · ICnorm(V ) (8) where Knorm and IC norm are normalized curvature and IC values, respectively. Kw denotes the curvature of the proposed modified method. According to the proposed method, the filtered IC curves of battery Y1# are used to illustrate the effectiveness of the curva- ture technique through the prominent results, as shown in Fig. 3. Fig. 3(a) shows that the fundamental example of curvature tech- nique for feature extraction. Obviously, the peak position corre- sponds to the maximum value of curvature, where the maximum value can be easily distinguished in many weighted curvatures. In Fig. 3(b), the filtered IC curves of different health conditions and corresponding maximum curvatures are presented, where the maximum curvatures of these IC curves are at different terminal voltages. In the zoom figure, the relationship between peak volt- ages and battery health levels are established, where the voltage values increase with the battery cycle number. Hereto, the numerical and flexible modified curvature-based method for battery SOH estimation is completed. The entire framework is concluded four parts including IC curves extraction, features extraction, SOH modeling, and error analysis. The two filter methods are used to obtain smooth IC curves. Then he detailed processes of testing and training model are presented 6379 Z. Wang, C. Song, C. Yuan et al. Energy Reports 7 (2021) 6375–6383 Fig. 5. The proposed modified curvature-based model for battery SOH estimation: (a) the proposed numerical model for battery N5#; (b) the results of SOH estimation for battery N5#; (c) the relative error of battery N5#; (d) the proposed numerical model for battery Y1#; (e) the results of SOH estimation for battery Y1#; (f) the relative error of battery Y1#. in this framework. Finally, the results of the offline model are evaluated and analyzed. The specific framework is described in Fig. 4. 4. Battery SOH estimation results and discussion Considering the battery aging has many effect factors, four datasets of lithium batteries are collected from different experi- mental conditions to analyze and conclude the fundamental rules for further modeling battery degradation. According to the tested datasets, the numerical SOH estimation model is established by fitting the relationship between peak voltages and battery avail- able capacities. Here four batteries datasets are collected to verify the proposed method. First, two batteries of different types are used to establish the numerical models for battery SOH esti- mation. Then the established numerical models are migrated to the remaining two batteries are applied to illustrate the effec- tiveness and robustness of proposed numerical models. At last, three different error analysis methods are utilized to discuss the estimation results. 4.1. Construction battery numerical model and results It is well known that the discharging rate and large depth- of-discharging can accelerate battery aging. Hence, the different tested conditions may affect the voltage ranges of peak posi- tions. Meanwhile, the battery type also influences the range of peak positions. Based on the obtained peak positions of two different types of batteries, here two numerical aging models are established for different depth-of-discharging and discharging rates, as shown in Fig. 5. The peak positions of battery N5# are within the range from 3.983 V to 4.045 V in specific low cut-off voltage (2.7 V). The numerical model of battery degradation and corresponding results of SOH estimation are shown in Fig. 5(a) and (b). The relative errors of the proposed method are within 3% and the maximum relative error is 2.8% in Fig. 5(c). The voltage ranges of peak positions for the Y1# start from 3.725 V to 3.785 V and the numerical model as well as model accuracy present in Fig. 5(d). The results and relative errors of battery SOH estimation are described in Fig. 5(e) and (f), respectively. From Fig. 5(f), all relative errors of the proposed method are less than 4% for this type of battery. All in all, the relative errors of the proposed numerical model all within 4%, which also demonstrate the ef- fectiveness and accuracy of the proposed method for different battery types and experimental conditions. 4.2. The generalization of the proposed numerical models To verify the generalization of the proposed method, the es- tablished numerical aging models of different battery types are 6380 Z. Wang, C. Song, C. Yuan et al. Energy Reports 7 (2021) 6375–6383 Fig. 6. The battery SOH estimation and relative errors based on the migrated models: (a) SOH estimation for battery N7#; (b) the relative error of battery N7#; (c) SOH estimation for battery Y2#; (d) the relative error of battery Y2#. migrated to estimate the corresponding batteries and these bat- teries are carried out under different tested conditions. Here, the corresponding batteries are labeled as N7# and Y2#, respectively. The estimation results and relative errors are shown in Fig. 6. From Fig. 6(a) and (b), the results of SOH estimation closely track the real SOH values and some large relative errors are around 4%, which demonstrates that the migrated model has prominent estimation accuracy. It is worth note that the battery N7# has different tested profiles with the initial model of battery N5#. It also prove that the proposed method has excellent generalization ability. Compared with battery Y1#, the Y2# is tested under a bigger discharging load. The proposed method still has battery accuracy of SOH estimation for battery Y2#. As shown in Fig. 6(d), all relative errors are within 5% for the battery Y2# under large discharging C-rate. According to the results of the migrated mod- els for the two types of batteries, the proposed numerical model has excellent capability in generalization. 4.3. SOH estimation error analysis To quantitatively analyze the error of the numerical battery model, three manners named mean absolute error (MAE), root mean square error (RMSE) and boxplot are proposed to com- prehensively evaluate the capability of the proposed model, as shown in Fig. 7. The boxplot can description of the relative error distribution by ignoring the extreme influences, which is constructed through five parameters including maximum, mini- mum, median, and superior and inferior quartiles. In Fig. 7(a), the absolute of maximum and minimum relative errors of the four batteries are all within 5% and the absolute of superior and in- ferior quartiles are between −2% and 3%. Meanwhile, the results of the median are all less than 2% for the four batteries, which indicate that the proposed method can accuracy estimation bat- tery health levels under different aging experimental conditions. Considering the global performances of the proposed method, MAE and RMSE are used to evaluate the rough levels of battery SOH estimation. From Fig. 7(b), the maximum value of four MAEs is within 2% and the maximum RMSE of four batteries is less than 2.5%. From the figure, the minimum MAE and RMSE both occur in the battery 5#, which demonstrate that the proposed method is suitable for normal operation condition. All results of error analysis indicate that the proposed numerical method has promi- nent performances and generalization ability for tracking battery degradation, which also prove that the peak positions of IC curves have a close correlation with battery capacity degradation under any aging conditions. 5. Conclusion The practical and flexible state-of-health method for guaran- teeing the reliability and safety of the battery energy storage system is a significant technique for the future intelligent battery management system. This paper has developed a novel curvature- based method to build numerical aging models for battery SOH estimation. The technical novelties primarily give an ingenious means to pick the peak point from a smooth IC curve. The peak point is related to some significant features of the aging battery. A simplified numerical aging model is established based on these significant features. Then, two types of four batteries with dif- ferent aging experimental protocols and health conditions are applied to verify the accuracy, robustness and reliability of the proposed method with two cases including initial and migrated models. The main contributions are summarized as follows: (1) The datasets are collected from four batteries of two different types that are applied to build and verify the proposed method. (2) The filtered IC curves are used to analyze battery health condi- tion based on the advanced SG filter method. (3) By means of curvature method, the significant feature indicators are extracted from IC curves including peak value and position. Meanwhile, the weighted technique is applied to curvature-based method for accurately capturing the peak point of IC curve. Thereafter, these features are employed to build the battery numerical aging model. (4) The proposed numerical models are comprehensively studied, and the models are verified by their self-data. The nu- merical model is employed to estimate health conditions for 6381 Z. Wang, C. Song, C. Yuan et al. Energy Reports 7 (2021) 6375–6383 Fig. 7. The error analysis of the four SOH estimation results: (a) the boxplot analysis for initial batteries tests and migrated batteries tests of the four batteries; (b) the results of MAE and RMSE analysis for initial batteries tests and migrated batteries tests test of the four batteries. other the same type batteries. Additionally, three error analysis methods are used to deeply analyze the performances of the proposed method in different application scenarios. The absolute of relative errors of the four batteries are all within 5% and the maximum value of the four MAEs is within 2% as well as the max- imum RMSE of four batteries is less than 2.5%, which demonstrate that the proposed numerical model can flexibly apply to state estimation with prominent accuracy and robustness. In the future, the more types of batteries will be tested and used to verify and analyze the proposed approach. With the ever-increasing usage scenarios, the proposed method should be updated and extended to meet more practical applications. CRediT authorship contribution statement Zhenpo Wang: Helped supervise the project, Discussed the results, Contributed to the final manuscript. Changgui Yuan & Chunbao Song: Conceived of the presented idea, Designed the model, The computational framework, Discussed the results, Con- tributed to the final manuscript. Changgui Yuan: Assisted with Xiaoyu Li verification the analytical methods, Discussed the re- sults, Contributed to the final manuscript. Xiaoyu Li: Helped supervise the project, Discussed the results, Contributed to the final manuscript. Declaration of competing interest The authors declare that they have no known competing finan- cial interests or personal relationships that could have appeared to influence the work reported in this paper. Acknowledgments This work was supported by the Graduate Technological Inno- vation Project of Beijing Institute of Technology, China (Grant No. 2019CX20021) in part; Outstanding Doctoral Candidate Cultivat- ing Foundation of Beijing Institute of Technology in part. References Cai, H., Chen, Q., Guan, Z., Huang, J., 2018. Day-ahead optimal charg- ing/discharging scheduling for electric vehicles in microgrids. Protect. Control Modern Power Syst. 3 (1), 9. Chen, Z., Mi, C.C., Fu, Y., Xu, J., Gong, X., 2013. Online battery state of health estimation based on Genetic Algorithm for electric and hybrid vehicle applications. J. Power Sources 240, 184–192. Cleveland, W.S., Grosse, E., Shyu, W.M., 2017. Local regression models. In: Statistical Models in S. Routledge. Deng, J., Bae, C., Marcicki, J., Masias, A., Miller, T., 2018. Safety modelling and testing of lithium-ion batteries in electrified vehicles. Nature Energy 3 (4), 261–266. Gao, Y., Jiang, J., Zhang, C., Zhang, W., Jiang, Y., 2018. Aging mechanisms under different state-of-charge ranges and the multi-indicators system of state-of- health for lithium-ion battery with Li(NiMnCo)O2 cathode. J. Power Sources 400, 641–651. Goebel, K., Saha, B., Saxena, A., Celaya, J.R., i. Christophersen, J.P.J.I, magazine, m., 2008. Prognostics in Battery Health Management, vol. 11(4). Gong, Y., Goksel, O., 2019. Weighted mean curvature. Signal Process. 164, 329–339. Hannan, M.A., Lipu, M.S.H., Hussain, A., Mohamed, A., 2017. A review of lithium-ion battery state of charge estimation and management system in electric vehicle applications: Challenges and recommendations. Renew. Sustain. Energy Rev. 78, 834–854. Hu, X., Feng, F., Liu, K., Zhang, L., Xie, J., Liu, B., 2019. State estimation for advanced battery management: Key challenges and future trends. Renew. Sustain. Energy Rev. 114, 109334. Hu, X., Jiang, J., Cao, D., Egardt, B., 2016. Battery health prognosis for electric vehicles using sample entropy and sparse Bayesian predictive modeling. IEEE Trans. Ind. Electron. 63 (4), 2645–2656. Jokar, A., Rajabloo, B., Désilets, M., Lacroix, M., 2016. Review of simplified pseudo-two-dimensional models of lithium-ion batteries. J. Power Sources 327, 44–55. Li, Y., Abdel-Monem, M., Gopalakrishnan, R., Berecibar, M., Nanini-Maury, E., Omar, N., et al., 2018a. A quick on-line state of health estimation method for Li-ion battery with incremental capacity curves processed by Gaussian filter. J. Power Sources 373, 40–53. Li, J., Adewuyi, K., Lotfi, N., Landers, R.G., Park, J., 2018b. A single particle model with chemical/mechanical degradation physics for lithium ion battery State of Health (SOH) estimation. Appl. Energy 212, 1178–1190. Li, X., Wang, Z., Yan, J., 2019a. Prognostic health condition for lithium battery using the partial incremental capacity and Gaussian process regression. J. Power Sources 421, 56–67. Li, X., Yuan, C., Wang, Z., 2020. Multi-time-scale framework for prognostic health condition of lithium battery using modified Gaussian process regression and nonlinear regression. J. Power Sources 467, 228358. Li, X., Zhang, L., Wang, Z., Dong, P., 2019b. Remaining useful life prediction for lithium-ion batteries based on a hybrid model combining the long short-term memory and Elman neural networks. J. Energy Storage 21, 510–518. Ma, J., Shang, P., Zou, X., Ma, N., Ding, Y., Sun, J., et al., 2021. A hybrid transfer learning scheme for remaining useful life prediction and cycle life test optimization of different formulation Li-ion power batteries. Appl. Energy 282, 116167. Pan, H., Lü, Z., Wang, H., Wei, H., Chen, L., 2018. Novel battery state-of-health online estimation method using multiple health indicators and an extreme learning machine. Energy 160, 466–477. Park, J., Appiah, W.A., Byun, S., Jin, D., Ryou, M.-H., Lee, Y.M., 2017. Semi- empirical long-term cycle life model coupled with an electrolyte depletion function for large-format graphite/LiFePO4 lithium-ion batteries. J. Power Sources 365, 257–265. Patil, M.A., Tagade, P., Hariharan, K.S., Kolake, S.M., Song, T., Yeo, T., et al., 2015. A novel multistage Support Vector Machine based approach for Li ion battery remaining useful life estimation. Appl. Energy 159, 285–297. 6382 Z. Wang, C. Song, C. Yuan et al. Energy Reports 7 (2021) 6375–6383 Richardson, R.R., Osborne, M.A., Howey, D.A., 2017. Gaussian process regression for forecasting battery state of health. J. Power Sources 357, 209–219. Roman, D., Saxena, S., Robu, V., Pecht, M., Flynn, D., 2021. Machine learning pipeline for battery state-of-health estimation. Nature Mach. Intell. 3 (5), 447–456. Wang, L.Y., Chen, W., Lin, F., Yin, G., 2017. Data-driven statistical analysis and diagnosis of networked battery systems. IEEE Trans. Sustain. Energy 8 (3), 1177–1186. Wei, J., Dong, G., Chen, Z., 2018a. Remaining useful life prediction and state of health diagnosis for lithium-ion batteries using particle filter and support vector regression. IEEE Trans. Ind. Electron. 65 (7), 5634–5643. Wei, Z., Xiong, R., Lim, T.M., Meng, S., Skyllas-Kazacos, M., 2018b. Online monitoring of state of charge and capacity loss for vanadium redox flow battery based on autoregressive exogenous modeling. J. Power Sources 402, 252–262. Weng, C., Cui, Y., Sun, J., Peng, H., 2013. On-board state of health monitoring of lithium-ion batteries using incremental capacity analysis with support vector regression. J. Power Sources 235, 36–44. Yang, X.-G., Liu, T., Ge, S., Rountree, E., Wang, C.-Y., 2021. Challenges and key requirements of batteries for electric vertical takeoff and landing aircraft. Joule 5 (7), 1644–1659. Yang, Z., Patil, D., Fahimi, B., 2018a. Online estimation of capacity fade and power fade of lithium-ion batteries based on input–output response technique. IEEE Trans. Transp. Electrification 4 (1), 147–156. Yang, D., Wang, Y., Pan, R., Chen, R., Chen, Z., 2018b. State-of-health estimation for the lithium-ion battery based on support vector regression. Appl. Energy 227, 273–283. Yuan, S., Jiang, L., Yin, C., Wu, H., Zhang, X., 2017. A transfer function type of simplified electrochemical model with modified boundary conditions and Padé approximation for Li-ion battery: Part 2, modeling and parameter estimation. J. Power Sources 352, 258–271. 6383","libVersion":"0.3.1","langs":""}