{"path":"lit/sources/Ortega09scenarioDyn.pdf","text":"A DYNAMIC APPROACH FOR SCENARIO GENERATION IN RISK MANAGEMENT J.-P. ORTEGA, R. PULLIRSCH, J. TEICHMANN, AND J. WERGIELUK Abstract. We provide a new dynamic approach to scenario generation for the purposes of risk management in the banking industry. We connect ideas from conventional techniques – like historical and Monte Carlo simulation – and we come up with a hybrid method that shares the advantages of standard procedures but eliminates several of their drawbacks. Instead of considering the static problem of constructing one or ten day ahead distributions for vectors of risk factors, we embed the problem into a dynamic framework, where any time horizon can be consistently simulated. Additionally, we use standard models from mathematical ﬁnance for each risk factor, whence bridging the worlds of trading and risk management. Our approach is based on stochastic diﬀerential equations (SDEs), like the HJM-equation or the Black-Scholes equation, governing the time evolution of risk factors, on an empirical calibration method to the market for the chosen SDEs, and on an Euler scheme (or high-order schemes) for the numerical eval- uation of the respective SDEs. The empirical calibration procedure presented in this paper can be seen as the SDE-counterpart of the so called Filtered Historical Simulation method; the behavior of volatility stems in our case out of the assumptions on the underlying SDEs. Furthermore, we are able to easily incorporate “middle-size” and “large-size” events within our framework always making a precise distinction between the information obtained from the market and the one coming from the necessary a-priori intuition of the risk manager. Results of one concrete implementation are provided. Key Words: risk management, stochastic (partial) diﬀerential equation, calibration, historical simulation, time series, jump processes 1. Introduction A core part of risk management in the banking industry is the identiﬁcation of risk factors and the generation of scenarios for a one up to ten days time horizon. This task involves dealing with basically three important issues and technical re- quirements. First, the scenarios need to extract the market information from the available time series of the risk factors. Mathematically speaking, this problem is tackled via the identiﬁcation of random variables that describe the risk factors one or ten days ahead and that match the most important stylized facts in the time series. A major complication in this classical statistics (or econometrics) question is that the available time series are extremely short (about 500 business days) in com- parison with the number of risk factors (several thousands). Even if the time series were long enough, standard statistical methods would take an excessively heavy computational eﬀort to come up with reliable solutions for such a high dimensional problem. Second, the shortness of the time series implies that one has to separately model extreme events, or even middle size events, in order to complement the information provided by the time series and to allow for cautious prediction. The third issue The ﬁrst and third author gratefully acknowledge support from the START-project Y 328 funded by the Austrian Science Foundation FWF. 1arXiv:0904.0624v2 [q-fin.RM] 19 Aug 2009 2 J.-P. ORTEGA, R. PULLIRSCH, J. TEICHMANN, AND J. WERGIELUK is that the procedure for scenarios generation should be computationally fast since they have to be generated every (business) day in order to be able to evaluate the risk to which all the portfolios of the institution are exposed. There are two families of ways to deal with the problem of scenario generation in risk management, namely the historical and the distributional approaches. Both strategies produce random variables from which one can sample the scenarios: Distributional or Parametric Approach. The scenarios are constructed by sampling a multivariate parametric distribution that has been calibrated using the historical data. One can also ﬁt certain distributions to vectors of risk factors and then use a copula to put together all these lower dimensional models. There are two major diﬃculties associated to this method: ﬁrst, most statistical estimators of the distribution parameters that need to be calibrated yield excessively wide conﬁdence intervals for the estimated coeﬃcients due to the relative shortness of the historical time series in comparison with the dimensionality of the problem. Second, the available historical data may not correspond to any of the standard frequently used parametric distributions. Historical Approach. The scenarios are obtained by directly sampling the his- torical data (eventually after rescaling). This method is much privileged in practice due to its ease of implementation and because it does not require any assumption on the historical distributions of the risk factors. This does not mean that this method is hypothesis free; indeed, its statistical legitimacy comes from the so called boot- strap method (see for instance [4]), whose requirements are not always satisﬁed, the most important of them being the iid (independent and identically distributed) character of the risk factors returns. Additionally, this method is obviously inca- pable of predicting rare (extreme) phenomena that did not happen before in the past; consequently these rare phenomena need to be added “by hand” (which is not a disadvantage but simply means that the time series is too short to reﬂect all possible risks). Several strategies have been proposed to tackle these problems; a particularly sophisticated and powerful one is the so called ﬁltered historical simula- tion [2], where the historical returns are “ﬁltered” by volatility functions calibrated to each time series using GARCH type processes. Empirical calibration of SDEs. The approach that we present in this article is reminiscent of both the historical and the distributional approaches and tries to “interpolate” between them. It allows us to properly capture the stylized facts on dependence of the given time series and to easily carry out additional distributional tuning. We create the random variable for future scenarios based on stochastic diﬀerential equations, which describe the local dynamics of the respective risk factors (“distributional aspect”). The stochastic diﬀerential equations are standard models from mathematical ﬁnance like the Black-Merton-Scholes, Cox-Ingersoll- Ross, Heath-Jarrow-Morton models, etc, which are adequately chosen for each in- dividual class of risk factors; in particular all these equations are free of arbitrage. The use of risk management models which could also be used for pricing or hedging derivative contracts is a tremendous conceptual advantage. This way we bridge between the worlds of trading and hedging. In particular the approach allows to actually come up with conceptually coherent methods for risk management which could in principle also be used for trading purposes. We calibrate the SDEs not via an optimization process as it is customary, but by directly using the historical data to construct local characteristics that capture the stylized facts of the time series. The method relies on the central limit theorem for covariance processes. Under certain conditions that we specify later on in the paper the calibrated SPDEs converge properly if the observed data stem from SCENARIO GENERATION IN RISK MANAGEMENT 3 an SPDE (which is basically the law of large numbers behind the construction). Heavy tails are generated by distinguishing between “trading time” and “clock time” (randomization of the period of simulation) and by adding extreme events, possibly with heavy tailed distributions. The ﬁrst eﬀect reﬂects that the ﬂow of information runs at diﬀerent speeds under diﬀerent market volatility conditions and is responsible for “middle-size” events; the second eﬀect reﬂects the possibility of the occurrence of rare (extreme) events not present in the historical data. Having the ﬁltered historical simulation approach (FHS) [2] in mind, the em- pirical calibration approach can be seen as the counterpart of FHS on the side of mathematical ﬁnance, i.e., instead of using the GARCH-methodology to capture volatility, we apply standard models from mathematical ﬁnance and random time changes for the same purpose (see Section 3 and 4). To be precise, the issue of cap- turing volatility correctly is addressed by rescaling with respect to realized volatility parameters of the time series via a sliding window method and by imposing speciﬁc assumptions on the dependence of volatility on the underlying risk factors. 2. Risk factors driven by diffusive stochastic differential equations In this section we outline the basic setting of Wiener driven stochastic (partial) diﬀerential equations, which underlie the time evolution of risk factors. For sto- chastic (partial) diﬀerential equations we refer to [3] as main reference. Details on term structure equations can be found in [6]. Our formal setup consists of a ﬁltered probability space (Ω, F, (Ft)t≥0, P ), where (Ft)t≥0 is a complete ﬁltration and P a probability measure. The basis is assumed to carry a d-dimensional standard Brownian motion B. We use as models for the risk factors stochastic diﬀerential equations from mathematical ﬁnance; this leads us to stochastic partial diﬀerential equations of the following general type: let H be the Hilbert space where risk factors take values, then we consider dYt = (µ1(Yt) + µ2(Yt))dt + d∑ i=1 σ(Yt) • λidBi t,(2.1) Y0 ∈ H,(2.2) where (2.3) σ(Y ) : H0 → H0 is an invertible linear map on some closed subspace H0 ⊂ H containing the real span ⟨λ1, . . . , λd⟩ of the set of return directions λ1, . . . , λd ∈ H (see Remark 4.1 for the use of the word return here). Such volatility structures are usually called constant direction volatilities, see for instance [8]. The “volatility factor” σ is chosen appropriately for the respective risk factors in order to exclude immediate arbitrages (like, e.g., negative interest rates). It should be interpreted as an a priori given factor governing the shape of the support of the risk factors; it is hence a geometric factor. The vector ﬁeld µ1 corresponds to appropriately chosen no- arbitrage conditions; µ2 is another vector ﬁeld that lies in the span ⟨λ1, . . . , λd⟩ and corresponds to an appropriate Girsanov type change of measure. We suppose that the usual conditions on the drift µ1 hold, that is, it can be written as (2.4) µ1(Y ) = AY + µ3(Y ) for some Y ∈ dom(A), where A denotes the generator of a strongly continuous semigroup which in our case will always be a shift to the right or the identity semigroup on the Hilbert space of risk factors H. The maps µ3, µ2 : H → H are smooth and all their derivatives are bounded (C ∞-bounded map); they represent 4 J.-P. ORTEGA, R. PULLIRSCH, J. TEICHMANN, AND J. WERGIELUK the no arbitrage conditions. Certainly – in view of existence and uniqueness – we have to assume global Lipschitz properties for the respective vector ﬁelds. 2.1. Example. Our driving example will be a joint interest rate (IR) and foreign exchange (FX) market for p + 1 countries with diﬀerent currencies and interest rate levels (p ≥ 1). The risk factors of this market are the diﬀerent log-exchange rates and forward interest rates. For the basic equations of this market we refer to [8]. Denote by P 0 t (x) and P α t (x), α ≥ 1 the time t prices of the domestic and foreign default-free, zero coupon bonds, where α = 1, . . . , p denotes the diﬀerent economies where exchange rates and zero coupon bonds are observed. The bonds are maturing at T = t + x ≥ 0. We deﬁne the domestic and foreign instantaneous forward rates as (2.5) r0 t = ∂ log P 0 t , rα t = ∂ log P α t . Using the Musiela parametrization and the standard Heath-Jarrow-Morton drift condition we can write down the domestic forward rate dynamics under the domes- tic martingale measure (2.6) dr0 t = ( d dx r0 t + d∑ i=1 σ(r0 t ) • λi ∫ σ(r0 t ) • λi)dt + d∑ i=1 σ(r0 t ) • λi dBi t, Analogously under the foreign martingale measure we obtain a Heath-Jarrow- Morton equation for the foreign forward rate dynamics. If the dynamics of the spot log-exchange rate process with respect to the domestic martingale measure is as follows (2.7) dSα t = (r0 t (0) − rα t (0))dt − ( d∑ i=1 (δα i )2 2 )dt + d∑ i=1 δα i dBi t, we obtain under the domestic martingale measure the foreign forward rate dynamics as drα t = ( d dx rα t + d∑ i=1 σ(rα t ) • λi ∫ σ(rα t ) • λi−(2.8) − d∑ i=1(σ(rα t ) • λi)δα i )dt + d∑ i=1 σ(rα t ) • λi dBi t, for α = 1, . . . , p. Recall the no-arbitrage conditions, namely, the processes exp(− ∫ t 0 r0 t (0)dt)P 0 t (T ), exp(− ∫ t 0 r0 t (0)dt) exp(Sα)P α t (T ) are (local) martingales on [0, T ] for α = 1, . . . , p and T ≥ 0. This system of stochastic partial diﬀerential equations (SPDEs) is of the form (2.1), when we consider a vector of risk factors Y = (r0, r1, . . . , rp, S1, . . . , Sp) forming an element of a large Hilbert space (2.9) H := H 0 × · · · × H p × R × · · · × R. By abuse of notation we use the same letters λ1, . . . , λd and σ for the respective ﬁelds on the Hilbert space of risk factors, such that we obtain an equation of type (2.1). Notice that we can easily perform a change of measure in order to attain the physical measure. This corresponds then to introducing an appropriately modiﬁed drift, denoted by the additional term µ2(Y ). SCENARIO GENERATION IN RISK MANAGEMENT 5 3. Calibrating the diffusive SPDEs to the market In this section we propose a calibration to (diﬀusive parts of) the historical risk factor time series, which does not need neither optimization procedures nor the numerical evaluation of the model in question. Instead of using those standard approaches, which pose serious problems in high dimensions, we will rather con- sider a “layman’s calibration” of the model, where the characteristics of the SPDE are deterministically and directly calculated from the observed time series. This corresponds to the “historical approach”, which is standard for several branches of scenario generation, however, we only apply the historical approach at an inﬁn- itesimal level (thinking of a time-tick, usually from hours up to days in scenario generation, as the inﬁnitesimal element): the global dynamics is then calculated by means of a stochastic diﬀerential equation whose local features are determined by the time series. We suppose that we are in the setting of Section 2 and we assume a time series, i.e. a sample of equation (2.1), on equidistant grid points of distance ∆, denoted by Y1, . . . , YK. Our goal consists of estimating the volatility directions λ1, . . . , λd out of the observations Y1, . . . , YK in a simple way (we regard YK as the last observation, which appeared one time tick ∆ ago). We do really aim for an estimation in the proper sense, i.e., we would like to have a limit theorem for SPDEs that relates the number of observations K, the time-distance ∆ of two contiguous observations, and the number of volatility directions d. We certainly do not want the dimension of the Hilbert space of risk factors to enter into the construction, since it might be inﬁnite. For later use and for the sake of simplicity we state the stochastic partial diﬀer- ential equation of type (2.1) calibrated to the given sample Y1, . . . , YK dX (K) t =(µ (K) 1 (X (K) t ) + µ (K) 2 (X (K) t ))dt+(3.1) + 1 √∆(K − 1) K−1∑ i=1 σ(X (K) t ) • (σ(Yi)−1(Yi+1 − Yi)) dW i t , where σ is a known, non-vanishing geometric function on the risk factors describing the local dynamics. We specify in the sequel the necessary conditions for an appro- priate limit theorem. We denote by X (K) t the dependence of the solution process Xt on the number K of observations (which also determines the distance ∆ between two observations). The calibrated equation is deﬁned on an independent stochastic basis with a K − 1 dimensional Brownian motion (W 1, . . . , W K−1). Notice here that µ (K) 1 is speciﬁed by no-arbitrage conditions from the volatility structure, as given in the equations (2.7) and (2.8). Furthermore we have to assume the following technical assumption, which allows to construct strong solutions and not only mild (respectively weak) ones. For all necessary details see [6] and [1]. 3.1. Assumption. The constant volatility directions λ1, . . . , λd are elements of dom(A∞), which is the domain where all powers of A are deﬁned (see for instance [1]. Furthermore σ : dom(A) → dom(A) is assumed to be a Lipschitz map. 3.2. Theorem. Consider equation (2.1) where σ is a given map and Y0 ∈ dom(A) a given initial value, but the directions λ1, . . . , λd are unknown. We assume As- sumption 3.1. We collect a time series of observations Y1, . . . , YK on an equidistant time grid of width ∆ that cover an interval of length T = K∆. Reﬁning the obser- vations by making ∆ = T K smaller and smaller leads to the following convergence statement: (3.2) lim K→∞ X (K) t = Yt 6 J.-P. ORTEGA, R. PULLIRSCH, J. TEICHMANN, AND J. WERGIELUK in distribution for any t ≥ 0 if X0 = Y0. The underlying limit result is the following Gaussian one, lim K→∞ ∫ t 0 σ(X (K) t )−1dX (K) t − ∫ t 0 σ(X (K) s )−1(µ (K) 1 (X (K) s ) + µ (K) 2 (X (K) s )ds(3.3) = lim K→∞ 1 √∆(K − 1) K−1∑ i=1 (σ(Yi) −1(Yi+1 − Yi))W i t(3.4) = ∫ t 0 σ(Yt) −1dYt − ∫ t 0 σ(Ys)−1(µ1(Ys) + µ2(Ys))ds.(3.5) Proof. Let H be the risk factor Hilbert space and λ ∈ H. Denote by λ ⊗ λ the bilinear operator deﬁned by (λ⊗λ)(v, w) := ⟨λ, v⟩⟨λ, w⟩, for (v, w) ∈ H ×H. Linear combinations of these (one-dimensional) bilinear operators are dense in the set of Hilbert-Schmidt operators (with respect to the Hilbert-Schmidt norm). Let M be a Hilbert space valued Itˆo process given by dMt = atdt + d∑ i=1 bi tdW i t , for a family a, b 1, . . . , bd of square-integrable processes; then, the quadratic covari- ation d∑ i=1 ∫ T 0 (bi t ⊗ bi t) dt is approximated with respect to the Hilbert-Schmidt norm by K−1∑ j=0 (M T (j+1) K − M T j K ) ⊗ (M T (j+1) K − M T j K ) , see for instance [3]. The Gaussian random variable in equation (3.4) has a covariance matrix (3.6) t ∆(K − 1) K−1∑ i=1 (σ(Yi)−1(Yi+1 − Yi)) ⊗ (σ(Yi) −1(Yi+1 − Yi)) which precisely corresponds, up to the factor t/∆, with the standard statistical estimator the returns (see Remark 4.1 for the use of the word return here) of the sample Y1, . . . , YK multiplied by σ(Yi)−1. On the other hand, this estimator converges, as K tends to inﬁnity, to (3.7) lim K→∞ 1 ∆(K − 1) K−1∑ i=1 (σ(Yi) −1(Yi+1 − Yi)) ⊗ (σ(Yi) −1(Yi+1 − Yi)) = d∑ i=1 λi ⊗ λi. This is due to the fact that the quadratic covariation of the stochastic process (3.8) σ(Yt)−1dYt = σ(Yt) −1(µ (K) 1 (Yt) + µ2(Yt))dt + d∑ i=1 λidBi t is given by ∑d i=1(λi ⊗ λi) dt, whence 1 T ∑d i=1(λi ⊗ λi) is approximated with respect to the Hilbert-Schmidt norm by 1 ∆(K − 1) K−1∑ i=1 (σ(Yi) −1(Yi+1 − Yi)) ⊗ (σ(Yi)−1(Yi+1 − Yi)). Notice here that ∆K = T . This proves the equality of (3.3) and (3.5). SCENARIO GENERATION IN RISK MANAGEMENT 7 In order to prove the convergence result (3.2) we will have to apply the follow- ing limit theorem in distribution for a sequence of stochastic partial diﬀerential equations: let X (K) t and Yt be the unique solutions of the equations dX (K) t = (µ (K) 1 (X (K) t ) + µ (K) 2 (X (K) t ))dt + σ(X (K) t ) • dB(K) t , X (K) 0 = X0,(3.9) dYt = (µ1(Yt) + µ2(Yt))dt + σ(Yt) • dBt, Y0 = X0,(3.10) where B(K) t = K−1∑ i=1 σ(Yi) −1(Yi+1 − Yi) W i t ,(3.11) Bt = d∑ i=1 λi Bi t(3.12) for t ≥ 0. Then (3.13) X (K) t −→ Yt in distribution as K → ∞. In order to show (3.13), we start by noticing that, due to the previous consideration we have B(K) −−−−→ K→∞ B in distribution on the Hilbert space H. The limit theorem (3.13) can be concluded from the stability theorems in [5] and the uniqueness in law established in [3]: ﬁrst, by uniqueness in law, the actual Brownian motion in use is not relevant. Hence, we can interpret the convergence of B(K) as K → ∞ with respect to independent Brownian motions G l t, each with a certain volatility κ (K) l and associated to a certain eigendirection e(K) l , that is, we can rewrite in law B(K) t = ∞∑ i=1 κ (K) l e (K) l G l t. This yields, for each l, vector ﬁelds converging to a limit as K → ∞, namely the eigensystem of ∑d i=1 λi ⊗ λi, if one carefully enumerates the volatilities κ (K) l in increasing order and keeps track of multiple eigenvalues. Second, if we reformu- late the stochastic partial diﬀerential equations (2.1) and (3.1) with respect to the sequence of independent Brownian motions G l, we ﬁnd ourselves with a sequence of vector ﬁelds converging to well-speciﬁed limits. Finally, the required statement follows from the stability result in Proposition 9.1 of [5]. □ 3.3. Remark. The methodology in the previous theorem is related to the one in [7] in the sense that we read from the quadratic variation process and its approxima- tions the relevant information for the a posteriori construction of a process which is close in law to the originally observed one. Indeed, in [7] the quadratic variation process and its approximations are – via harmonic analysis methods – investigated in order to reveal information on the non-linear volatility vector ﬁelds. In contrast, we do assume knowledge on the type of non-linearity in the equation and tackle the problem of determining the volatility directions λ1, . . . , λd. The convergence results based on Wiener’s theorem, as stated in [7], could be similarly applied. 3.4. Remark. Notice that we do not need to calculate empirical covariance matrices of the time series in order to to capture the local correlation structure of all risk factors in the calibrated equation (3.1). 3.5. Remark. Up to some technical complications one could also consider d = ∞ here. 8 J.-P. ORTEGA, R. PULLIRSCH, J. TEICHMANN, AND J. WERGIELUK 4. Rare events and Fine-tuning through random time changes Besides the calibration of the risk factor SPDEs proposed in equation (3.1) we have to take into account stochastic volatility. We express stochastic volatility in our setting through the appearance of random times, which can be nicely interpreted as diﬀerence between physical time and trading time. As the spirit of this article is to embed a static sampling problem (in contrast to the distributional approach where only two random variables are described) into a dynamic problem deﬁned by stochastic (partial) diﬀerential equations, we also embed the random time into a random time change, which can then a fortiori be observed through an stochastically changing volatility process. This approach is a continuous time version of GARCH- approaches, which are applied in ﬁltered historical simulation in risk management (see [2]). Here, in contrast, we “calculate” stochastic volatility along the time series as realized volatility and rescale the time series by this realized volatility before we apply those rescaled (“ﬁltered”) returns to calibrate the underlying stochastic diﬀerential equations as proposed in equation (3.1) In this section we therefore introduce the additional methodology, which allows us to include these changing volatility eﬀects of the observed diﬀusion processes and which permits jumps. Both phenomena, stochastic volatility and jumps, are crucial to capture important stylized facts of ﬁnancial time series. For instance, when we model rare (extreme) events we those events as additional jumps added to the diﬀusive setting of equation (2.1). Recall that these additional jumps also change the drift µ1 due to no arbitrage conditions. In this section we assume the existence of a basis {ej} of the respective Hilbert spaces of risk factors in order to speak about the risk factors Y j, which denote the projection of Y onto the j-th basis element. 4.1. Remark. We shall apply in the sequel the notion return for two slightly dif- ferent concepts. When considering a time series Y1, . . . , YK, which is a collection of vectors, then we shall call any diﬀerence Yi+1 − Yi an (observed) return (of risk factors), where we should in fact speak of a vector of returns (Y j i+1 − Y j i ) of single risk factors Y j. Running indices for risk factors are always denoted by j, the index along the time series is usually i. The length of the time series will be always be K. We deﬁne rare events using known time series of the risk factors and by the risk manager’s very own intuition. Let Y1, . . . , YK denote a time series of risk factors. We form a time series of returns Yi+1 − Yi for i = 1, . . . , K − 1 from it and estimate the empirical (co-)variance ̂σ among its diﬀerent components. Additionally we deﬁne local extractions of the time series of length L, i.e. Yk+i+1 − Yk+i, for k = 1, . . . , L and for i = 0, . . . , K − L − 1. The empirical (co-)variance of this extraction is denoted by ̂σ(i+L) and corresponds to the estimation of the volatility looking back L days, usually called (local) realized volatility. We now consider a diﬀusive equation of type (2.1) with jumps and random time change. More precisely, let τ j t = ∫ t 0 Aj sds be a random time change for risk factor j, i.e. Aj is a non-negative, locally integrable previsible stochastic process (with respect to the natural ﬁltration of the Brownian and Poissonian componentes), whence t 7→ τ j t is an almost surely increasing random time. Then the equation to SCENARIO GENERATION IN RISK MANAGEMENT 9 be calibrated looks like dY j τ j t = (µ1(Yτt) + µ2(Yτt))dτ j t + d∑ i=1 (σ(Yτt) • λi) jdBi τ j t + dNτ j t ,(4.1) dτ j t = Aj t dt,(4.2) Y0 ∈ H,(4.3) where N denotes a Poisson process with values in H and jump rate calibrated from the time series. The solution of this random SPDE can be written through the random time change by solving (2.1) up to the time τ j t for the j-th risk factor. It is possible to estimate the volatility levels Aj t from the market up to an (a priori unknown) factor by observing a proper quadratic variation process between two jumps at time a and b, namely ⟨ ∫ (σ(Yt) −1 • dYt) j⟩| b a = ∫ b a Aj sds d∑ i=1 ∫ b a (λj i )2ds. As a second notation we introduce the ratios of local empirical volatility and today’s local volatility, namely ̂Rj i = √̂σ(i) jj √̂σ(K−1) jj , which is deﬁned for each risk factor j separately. We denote this quantity by ̂Rj i at time i in the time series. Notice that this quantity is well-deﬁned, even under the regime of a random time change, since the (unknown) proportionality factor cancels out. 4.2. Deﬁnition. Let Y1, . . . , YK denote a time series of risk factors. We form a time series of returns Yi+1 − Yi for i = 1, . . . , K − 1 from it and denote by (Y j i+1 − Y j i ) ̂Rj i for risk factor j and i = L, . . . , K − 1 the rescaled returns of the time series. 4.3. Remark. In order to make the choice of extreme events more stable along time, one can choose L for re-scaling the returns and for extracting extreme events independently. In the subsequent example this is the case. In order to calibrate the equation in the spirit of (3.1) we start from the set of rescaled returns and separate from it the set of extreme returns. 4.4. Deﬁnition. A return at index L ≤ i ≤ K − 1 is said to be extreme at level η with M violations if η × √̂σ(K−1) jj ≤ |Y j i+1 − Y j i | ̂Rj i holds true for at least M diﬀerent risk factors j. The set of all indices belonging to extreme events at level η with M violations is denoted by Eη,M and is a subset of the set of all indices K = {1, . . . , K − 1}. By means of the set Eη,M we can now deﬁne a jump structure, where with a certain jump rate and jump measure jumps from Eη,M are mixed (in an independent fashion) into the diﬀusion process calibrated with returns from the set K \\ Eη,M . For the purpose of numerical eﬃciency of the simulation we shall most of the time neglect the fact that the random time change depends on each risk factor 10 J.-P. ORTEGA, R. PULLIRSCH, J. TEICHMANN, AND J. WERGIELUK Y j. Actually the simulation time τt is chosen with respect to the distribution of∫ t 0 Asds, which is estimated from an averaged realized variance structure. 5. Evaluating the stochastic differential equations In our case the parameters of the SPDE are speciﬁed by the the empirical cal- ibration method outlined in Section 3 and by an a priori choice of the geometric term σ. Therefore, in order to fully characterize the equation, the following points need to be taken into account: (1) Determine the sets Eη,M and K \\ Eη,M by ﬁxing a level η at which events are considered as extreme and a number M of violations. (2) The number of involved Brownian motions is the cardinality of K \\ Eη,M . (3) The volatility directions are given by rescaled returns using equation (3.1). (4) The semigroup A is the shift semigroup for term structure of the risk factors, otherwise the identity. (5) σ is chosen a priori according to the (geometric) structure of the problem, i.e., some risk factors have to stay positive (like interest rates), others are free (like log-prices). For the evaluation of the SPDE (3.1) we propose an explicit-implicit Euler scheme (see for instance [5]), which has the following one-step Euler structure: • Prepare an initial risk factor Y0. • Trigger a jump (with a speciﬁed jump rate), or not. If a jump is triggered, then sample its size using the jump measure and add it to Y0. • Choose Brownian increments Bi t with variance t along the time increment t. • Evaluate StY0+µ (K) 3 (Y0)t + µ (K) 2 (Y0)t+(5.1) + 1 √∆(K − 1) ∑ i∈K\\Eη,M σ(Y0) • σ(Yi) −1 (Yi+1 − Yi) ˆR. i Bi t.(5.2) • Terminate the Euler step. 5.1. Remark. In our concrete implementations the choice of σ depends on the respective risk factors. For instance, for interest rates we have chosen ﬁelds of linear operators depending via square-root like functions on the level of yield at certain maturities. 6. Results from a concrete implementation In this last section we present results from a concrete implementation of a sce- nario generator for ﬁve foreign currencies (CHF, GBP, JPY, USD, ZAR) and six yield curves, i.e., ﬁve foreign yield curves and one domestic yield curve (Euro zone). For this purpose we use market data from March 2006 to March 2009, including in particular the highly volatile events of the last quarter of 2008. In total, this risk management problem consists of 82 risk factors, even though more points on the yield curve could have been evaluated. In a given day, the available historical time series has a length of K = 500 business days back in time, i.e., in March 2009 we look back up to March 2007, for instance. The implementation is based on Section 2 and the systems of equations presented therein. In the light of Sections 3 and Section 4 the realized variances (with L = 20) and the set of extreme events (for the calculation of extreme events we used L = 40) are calculated: the number of violations M = 4 and the level η = 4 yield a number of extreme events of 32 (for M = 1, i.e. an extreme event occurs if we have one violation for one risk factor, SCENARIO GENERATION IN RISK MANAGEMENT 11 we obtain 162 extreme events). The jump rate is chosen to be 2 percent (yielding about 100 jump events in 5000 scenarios). The random time change has been cho- sen ad-hoc to be 0.9 days in 90 percent of the cases and 1.9 days in 10 percent of the cases for the sake of simplicity. A precise calibration might yield even better results. The following pictures show several single distinguished historical and gener- ated distributions of risk factors. The historical distributions are rescaled by R as described in Deﬁnition 4.2. The last ﬁgure shows the backtesting results for a randomly chosen roll-over portfolio of linear FX- and IR-instruments, i.e., the times to maturity of instruments in the portfolio are kept constant along the backtesting. The distributional plots show on the left hand side the historical distribution of log-returns for one day and on the right hand side the simulated distributions of log-returns for one day. It is apparent that our simulated scenarios resemble the historical distributions by smoothening them in a consistent way along all risk factors and by preserv- ing extreme risks. We obtain backtesting results of four VAR-violations and two portfolio-loss-values beyond the level of expected shortfall in 250 days at a 99% conﬁdence level. In the ﬁrst set, the smoothening is the main visible eﬀect in the simulation results. Also other stylized facts of the distribution like skewness and kurtosis are preserved. 0.040.030.020.010.00-0.01-0.02-0.03 10 20 30 40 50 60 70 80 90 100 0 Historical distribution of FX-CHF 0.050.030.01-0.01-0.03-0.05 0 10 20 30 40 50 60 70 80 90 100 ScenGen distribution of FX-CHF 0.100.050.00-0.05-0.10-0.15-0.20 50 45 40 10 5 Historical distribution of FX-GBP 0.150.100.050.00-0.05 5 -0.10-0.15 10 15 20 25 30 35 0 ScenGen distribution of FX-GBP 0.200.150.100.050.00-0.05-0.10 5 10 15 20 25 30 35 40 0 Historical distribution of FX-JPY 0.200.150.100.050.00-0.05-0.10-0.15 5 10 15 20 25 30 0 ScenGen distribution of FX-JPY 12 J.-P. ORTEGA, R. PULLIRSCH, J. TEICHMANN, AND J. WERGIELUK 0.0030.0020.0010.000-0.001-0.002-0.003-0.004 200 400 600 800 1000 1200 1400 1600 1800 2000 0 Historical distribution of IR-CHF-Y03 0.0030.0020.0010.000-0.001-0.002-0.003-0.004 0 200 400 600 800 1000 1200 1400 1600 1800 2000 ScenGen distribution of IR-CHF-Y03 0.0030.0020.0010.000-0.001-0.002-0.003-0.004 500 1000 1500 0 Historical distribution of IR-CHF-Y05 0.0040.0020.000-0.002-0.004 500 1000 1500 0 ScenGen distribution of IR-CHF-Y05 0.004000.00175-0.00050-0.00275-0.00500 500 1000 1500 0 Historical distribution of IR-CHF-Y07 0.0050.0030.001-0.001-0.003-0.005 200 400 600 800 1000 1200 1400 0 ScenGen distribution of IR-CHF-Y07 In the second set of plots, mass of the historical distributions is transported from the center to middle-size events. 0.01200.00750.0030-0.0015-0.0060 0 100 200 300 400 500 600 700 800 900 1000 Historical distribution of IR-EUR-M03 0.0100.0060.002-0.002-0.006 100 200 300 400 500 600 700 800 0 ScenGen distribution of IR-EUR-M03 0.0120.0080.0040.000-0.004-0.008 700 100 0 Historical distribution of IR-EUR-M06 0.0100.0050.000-0.005 0 100 200 300 400 500 600 700 800 ScenGen distribution of IR-EUR-M06 0.0080.0060.0040.0020.000-0.002-0.004-0.006 100 200 300 400 500 600 700 800 900 0 Historical distribution of IR-EUR-Y01 0.0050.0030.001-0.001-0.003-0.005 100 200 300 400 500 600 700 800 900 0 ScenGen distribution of IR-EUR-Y01 In the third set of plots the mass transport eﬀect is seen in an even more extreme way, since for ZAR a lot of returns have historically been zero. In this sense the constructed scenario generator also has a “repairing” eﬀect on data. SCENARIO GENERATION IN RISK MANAGEMENT 13 0.0250.0200.0150.0100.0050.000-0.005-0.010 500 150 50 0 Historical distribution of IR-USD-Y20 0.0250.0200.0150.0100.005 50 0.000-0.005-0.010 100 150 200 250 300 350 400 450 0 ScenGen distribution of IR-USD-Y20 0.0250.0150.005-0.005-0.015 50 100 150 200 250 300 350 400 450 0 Historical distribution of IR-USD-Y30 0.0250.0150.005-0.005-0.015 50 100 150 200 250 300 350 400 450 0 ScenGen distribution of IR-USD-Y30 0.20.0-0.2-0.4-0.6-0.8-1.0-1.2-1.4-1.6 10 20 30 40 50 60 0 70 Historical distribution of IR-ZAR-D01 0.300.250.200.150.100.050.00-0.05-0.10-0.15 5 10 15 0 ScenGen distribution of IR-ZAR-D01 Finally, we present backtesting results of a two roll-over portfolios during 250 busi- ness days at the 99% conﬁdence level. Returns are in red, VaR in blue and the value of expected shortfall is in green. One can clearly see the increase of the level of VAR (and expected shortfall) during the events of the last quarter 2008. We have omitted the scaling on the y-axis as violations are only a level of relative size. 0 50 100 150 200 250 14 J.-P. ORTEGA, R. PULLIRSCH, J. TEICHMANN, AND J. WERGIELUK 0 50 100 150 200 250 References [1] Fabrice Baudoin and Josef Teichmann. Hypoellipticity in inﬁnite dimensions and an application in interest rate theory. Ann. Appl. Probab., 15(3):1765–1777, 2005. [2] Barone-Adesi, G. and Bourgoin, F. and Giannopoulos. Don’t look back. Risk. 100–103, August 1998. [3] Giuseppe Da Prato and Jerzy Zabczyk. Stochastic equations in inﬁnite dimensions, volume 44 of Encyclopedia of Mathematics and its Applications. Cambridge University Press, Cambridge, 1992. [4] B. Efron and R.J. Tibshirani. Monographs on Statistics and Applied Probability. Chapman and Hall/CRC, 1994. [5] D. Filipovi´c, S. Tappe, and J. Teichmann. Jump-diﬀusions in hilbert spaces: Existence, sta- bility and numerics. (http://arxiv.org/abs/0810.5023). [6] Damir Filipovi´c and Josef Teichmann. On the geometry of the term structure of interest rates. Proceedings of The Royal Society of London. Series A. Mathematical, Physical and Engineering Sciences, 460(2041):129–167, 2004. [7] Paul Malliavin, Maria Elvira Mancino, and Maria Cristina Recchioni. A non-parametric cal- ibration of the HJM geometry: an application of Itˆo calculus to ﬁnancial statistics. Jpn. J. Math., 2(1):55–77, 2007. [8] Irinia Slinko. On ﬁnite dimensional realizations of two-country interest rate models. Mathe- matical Finance, forthcoming, 2009. CNRS, Universit´e de Franche-Comt´e, UFR des Sciences et Techniques, 16, route de Gray, 25030 Besanc¸on, France; RZB, Am Stadtpark 9, A-1030 Wien, Austria; Vienna Uni- versity of Technology, Department of Mathematical Methods in Economics, Wiedner Hauptstrasse 8–10, A-1040 Wien, Austria E-mail address: Juan-Pablo.Ortega@univ-fcomte.fr, rainer.pullirsch@rzb.at, jteichma@math.ethz.ch, julian.wergieluk@rzb.at","libVersion":"0.3.1","langs":""}