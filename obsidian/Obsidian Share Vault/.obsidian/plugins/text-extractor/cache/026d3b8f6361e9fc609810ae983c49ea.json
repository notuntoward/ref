{"path":"lit/lit_sources.backup/papers_to_add/Papers I'm Reviewing Right Now/SplineRgrsn/MultivariateSplinesArbKnots/bspl.pdf","text":"Multivariate B–Splines with (almost) arbitrary knots Thomas Sauer Abstract. The multivariate B–spline scheme, due to Dahmen, Mic- chelli and Seidel [1] imposes some restrictions on the knots which have to be placed such that certain regions have a nonempty interior. Here it will be shown that these conditions can be almost completely dropped without losing the ability to represent piecewise polynomials on all of lR s. As an auxiliary result an evaluation algorithm for the B–spline representation of smooth piecewise polynomials will be obtained. §1. Introduction In their almost classical paper [1], Dahmen, Micchelli and Seidel in- troduced a multivariate B–spline scheme which is based on the so–called “Blossoming principle”. This is a one–to–one correspondence between polynomials F : lR s → lR t of degree n and symmetric multi-aﬃne maps f : (lR s) n → lR t such that F (u) = f (u, . . . , u), while – conversely – the polar form or blossom, associated to F , f (u1, . . . , un), will be obtained by applying one step of the de Casteljeau Algorithm with argument u1, then one step with u2, . . ., and a ﬁnal step using un to the B´ezier representation of F . These facts are pointed out in great detail in [1]. In terms of blossoming, two polynomials F and G of degree n join k times continuously diﬀerentiable along some (possibly lesser dimensional) simplex Λ ⊂ lR s if and only if f (u1, . . . , un−k, v1, . . . , vk) = g(u1, . . . , un−k, v1, . . . , vk) (1) for any choice of u1, . . . , un−k ∈ Λ and v1, . . . , vk ∈ lR s. The construction of the B–spline scheme in [1] is then as follows: let points ti ∈ lR s, i ∈ lN, be given and deﬁne a triangulation T = {∆(I) = [ti0, . . . , tis ] : I = (i0, . . . , im) ∈ I ⊂ lN s+1} Approximation Theory VIII 1 Charles K. Chui and Larry L. Schumaker (eds.), pp. 1–3. Copyright oc 1995 by World Scientiﬁc Publishing Co., Inc. All rights of reproduction in any form reserved. ISBN 0-12-xxxxxx-x 2 T. Sauer of lRs. Next, associate to any of the vertices ti a cloud of knots ti = ti,0, ti,1, . . . , ti,n such that the regions ΩI n := int   ⋂ |λ|≤n ∆I λ   , ∆I λ = [ti0,λ0, . . . , tis,λs ] satisfy vols (ΩI n) > 0, I ∈ I. (2) This “separation” condition for the diﬀerent clouds of knots can be always satisﬁed by taking ti,1, . . . , ti,n suﬃciently close to ti,0 = ti. Then the B–spline N I λ, |λ| = n, is deﬁned by means simplex splines M (u|V I λ ) (see [3]) as N I λ = |d(W I λ )|M (u|V I λ ), |λ| = n, where V I λ = {ti0,0, . . . , ti0,λ0, . . . , tis,0, . . . , tis,λs } and W I λ = {ti0,λ0, . . . , tis,λs } ⊂ V I λ , d(W I λ ) = det ( 1 · · · 1 ti0,λ0 . . . tis,λs ) . Assuming (2), these B–splines can be shown to be all non-negative and to form a partition of unity; hence, any B–spline surface N (u) = ∑ I∈I ∑ |λ| = ncI,λN I λ(u), cI,λ ∈ lR t lies in the convex hull of its control points. Moreover, this surface is globally C n−1 if all the sets W I λ , |λ| ≤ n are aﬃnely independent, which is quite a mild condition. A property of central importance is that the B–splines can represent any polynomial (as shown in [1]) as well as any suﬃciently smooth piecewise polynomial (see [4]), the coeﬃcients, moreover, been explicitly given by entering the knots in the polar form. It is the subject of this paper to point out that one can reduce the condition stated in (2) to a much weaker minimal condition on the ti,j by equipping the B–splines with a diﬀerent sign in certain cases, without loosing representability of piecewise polynomials. Although this also can be obtained from more general principle (see [2]), we present here an el- ementary short proof which applies regardless whether (2) is satisﬁed or not. Multivariate B–Splines 3 §2. Arbitrary selection of knots Giving up the condition that the regions ΩI n satisfy (2), we demand only that vols (∆I λ) > 0 for all I ∈ I and |λ| ≤ n. This is a natural minimal condition since otherwise the values f (ti0,0 · · · ti0,λ0−1 · · · tis,0 · · · tis,λs−1) cannot give full information about the underlying polynomial F . We now deﬁne the B–splines to be N I λ(u) := σI d(W I λ )M (u|V I λ ), σI := sign d(W I 0 ). Two simple observations can be made here: First, it has been shown in [1] that, if (2) holds, then all the determinants d(W I λ ), |λ| ≤ n, have just the same sign; i.e., in the “classical” case this deﬁnition is nothing diﬀerent. On the other hand, for many choices of the knots these determinants will have diﬀerent signs and hence some of the B–splines will become negative. Nevertheless, for any B–spline surface F (u) = ∑ I∈I ∑ |λ|=n cI,λN I λ(u), cI,λ ∈ lR t, built on a triangulation of lR s, there still holds the counterpart of the crucial Lemma 3.1 in [1], namely Lemma 1. Suppose that for any two adjacent simplices ∆(I), ∆(J) ∈ T with common face [ ti0,0, . . . , tip−1,0, tip+1,0, . . . , tis,0] = [ tj0,0, . . . , tjq−2,0, tjq,0, . . . , tjs,0] , and for any λ, µ such that µj = λj, j = 0, . . . , p, j = q, . . . , s, µq−1 = λp = 0, µj = λj+1, j = p, . . . , q − 2, one has cI,λ = cJ,µ. Then ∑ I∈I ∑ |λ|=n cI,λN I λ(u) = ∑ I∈I ∑ |λ|=n−1 c(1) I,λ(u)N I λ(u), 4 T. Sauer where c(1) I,λ(u) = s∑ j=0 τ I λ,j(u)cI,λ+ej . Here τ I λ,j(u), j = 0, . . . , s, denote the barycentric coordinates of u with respect to W I λ = {tij ,λj : j = 0, . . . , s } . Proof: Since the proof is a slight modiﬁcation of the one given in [1], I will just point out the modiﬁcations that have to be applied: Invoking the recurrence relation for the simplex splines M (u|V I λ ) and using the same computations as in [1] we obtain that, for any I ∈ I, the following holds true: ∑ |λ|=n cI,λN I λ(u) = ∑ |λ|=n−1   s∑ j=0 τ I λ,j(u)cI,λ+ej   N I λ(u) + s∑ j=0 RI j,n(u), where RI j,n(u) := ∑ |λ|=n λj =0 σI d(W I λ )τ I λ,j(u)M (u|V I λ−ej ). (3) Hence, the claim is proved if we can show that ∑ I∈I   s∑ j=0 RI j,n(u)   = 0. (4) In order to do so, we ﬁrst remark that, since we are dealing with a trian- gulation for all of lR s, we can ﬁnd for any 0 ≤ p ≤ s, I ∈ I and λ with λp = 0 uniquely determined 0 ≤ q ≤ s, J ∈ I, and µ, satisfying µq−1 = 0, such that ∆(I) and ∆(J) have a common (s − 1)–dimensional face which contains neither tip,0 nor tiq−1,0. This yields V I λ−ep = V J µ−eq−1, hence the respective simplex splines coincide. Thus we obtain twice the sum in (3) if we consider the terms (cI,λσI d(W I λ )τ I λ,p(u) + cJ,µσJ d(W J µ )τ J µ,q−1(u) ) ︸ ︷︷ ︸ =:qI,p(u) M (u|V I λ−ep) and sum them all up with respect to I, λ and p. By inserting the explicit formulae for the barycentric coordinates we ﬁnd that qI,p(u) = cI,λσI dp(W I λ |u) + cJ,µσJ dq−1(W J µ |u), Multivariate B–Splines 5 where both determinants clearly have the same absolute value for any u ∈ lR s. Finally, let σI,λ be the sign of d(W I λ ) and σJ,µ the sign of d(W J µ ). With this notation in hand, we see that τ J µ,q−1(tip,0) = σJ,µdq−1(W J µ |tip,0) σJ,µd(W J µ ) , (5) and, on the other hand, 1 = τλ,p(tip,0) = σI,λdp(W I λ |tip,0) σI,λd(W I λ ) . (6) Considering the hyperplane H, spanned by the points W I λ \\ {tip,0}, there are two cases to be distinguished: ﬁrst, tip,0 and tiq−1,0 may lie on diﬀerent sides of the hyperplane, yielding σI,λ = −σJ,µ and hence σI σI,λ = σJ σJ,µ. Furthermore, the expression in (5) is negative. Since both denominators in (5) and (6) are positive, the numerators must have diﬀerent signs and thus σI dp(W I λ |u) = σJ σJ,µσI,λdp(W I λ |u) = σJ σJ,µ (−σJ,µdq−1(W J µ |u) ) = −σJ σ2 J,µdq−1(W J µ |u); i.e., σI d(W I λ |u) = −σJ d(W J µ |u) (7) for all u ∈ lR s. Second, tip,0 and tiq−1,0 lie on the same side of H, thus σI σI,λ = −σJ σJ,µ. However, the expression in (5) is positive. Hence both numerators have the same sign and the same arguments as above show that (7) again holds. Hence, qI,p = σI dp(W I λ ) (cI,λ − cJ,µ) , and since, due to the assumption, cI,λ and cJ,µ agree, qI,λ(u) vanishes for all u ∈ lR s and therefore (4) holds true, completing the proof. Now, suppose that a C k piecewise polynomial F of degree n on some triangulation T = {∆(I) : I ∈ I} of lRs is given and let fI denote the polar form of FI , the restriction of F to the simplex ∆(I). Taking any vertex ti as a knot of multiplicity n − k, i.e., ti,0 = . . . = ti,n−k−1 = ti, and setting cI,λ = fI (ti0,0 · · · ti0,λ0−1 · · · tis,0 · · · tis,λs−1) 6 T. Sauer we deﬁne the spline function Nn(u) = ∑ I∈I ∑ |λ|=n cI,λN I λ(u). Starting with c(0) I,λ() = cI,λ, I ∈ I, |λ| = n, (8) we recursively deﬁne for 0 ≤ r ≤ k and v1, . . . , vk+1 ∈ lR s, c(r+1) I,λ (v1 · · · vr+1) = s∑ j=0 τ I λ,j(vr+1)c(r) I,λ+ej (v1, . . . , vr), I ∈ I, |λ| = n − r − 1, (9) and the respective spline functions (0 ≤ r ≤ k + 1) Nn−r(u|v1, . . . , vr) = ∑ I∈I ∑ |λ|=n−r c(r) I,λ(v1, . . . , vr)N I λ(u). To simplify notation we will use the abbreviation tI λ = ti0,0 · · · ti0,λ0−1 · · · tis,0 · · · tis,λs−1 in the sequel, implying that c(0) I,λ() = cI,λ = fI (tI λ), I ∈ I, |λ| = n, as well as c(r) I,λ(v1, . . . , vr) = fI (tI λ v1 · · · vr), I ∈ I, |λ| = n − r, the latter being proved by induction as follows: c(r+1) I,λ (v1, . . . , vr+1) = s∑ j=0 τλ,j(vr+1)c(r) I,λ+ej (v1, . . . , vr) = s∑ j=0 τλ,j(vr+1)fI (tI λ tij ,λj v1 · · · vr) = fI (tI λ v1 · · · vr s∑ j=0 τλ,j(vr+1)tij ,λj ) = fI (tI λ v1 · · · vr+1). Multivariate B–Splines 7 Let ∆(I) and ∆(J) be two adjacent simplices sharing the face Λ equaling [ ti0,0, . . . , tip−1,0, tip+1,0, . . . , tis,0] = [ tj0,0, . . . , tjq−2,0, tjq,0, . . . , tjs,0] , and let λ, µ, |λ| = |µ| = n − r, 0 ≤ r ≤ k, satisfy the conditions of Lemma 1. In particular, tI,λ and tJ,µ are just permutations of each other. Since any of the knots has multiplicity n − k, the sequence tI λ contains at least n − k elements of Λ and hence we have, using the C k–continuity of F and (1), c(r) I,λ(v1, . . . , vr) = fI (tI,λ v1 · · · vr) = fJ (tI,λ v1 · · · vr) = fJ (tJ,µ v1 · · · vr) = c(r) J,µ(v1, . . . , vr). Thus we can apply Lemma 1 to substitute (8) into (9) and obtain that for 0 ≤ r ≤ k Nn−(r+1)(u|v1, . . . , vr, u) = Nn−r(u|v1, . . . , vr), v1, . . . , vr ∈ lR s; in particular, Nn−r(u|u, . . . , u) = Nn(u), 0 ≤ r ≤ k + 1. On the other hand, if |λ| = n − k − 1, then the set V I λ just consists of the knots ti0, . . . , tis , with multiplicities λ0, . . . , λs; this allows us to switch to “local evaluation” of the functions, i.e., if we have u ∈ ∆(I), we only have to compute the classical de Casteljeau algorithm with control points c(k+1) I,λ (v1, . . . , vn−k−1), |λ| = n − k − 1, and argument u to obtain the value Nn−k−1(u|v1, . . . , vn−k−1). Since this is nothing but continuing (9) for k + 1 ≤ r ≤ n and since Nn−k−1(u|u, . . . , u) = Nn(u) we have Theorem 2. (Evaluation Algorithm) Let F be a C k piecewise polynomial of degree n on some triangulation T = {∆(I) : I ∈ I} of lR s. Let the set of knots be given by all the vertices ti of T , equipped with multiplicity n − k, i.e., ti,0 = . . . = ti,n−k−1 = ti, and set cI,λ = fI (tI λ), I ∈ I, |λ| = n. Assume that u belongs to ∆(I) for some I ∈ I and compute for 0 ≤ r ≤ n − 1 cr+1 λ (u) = s∑ j=0 τ I λ,j(u)cr λ+ej (u), |λ| = n − r − 1, initialized by c0 λ = cI,λ. Then cn 0 (u) = Nn(u) = ∑ I∈I ∑ |λ|=n cI,λN I λ(u). Now, we can immediately derive the (piecewise) polynomial represen- tation theorem with help of the evaluation algorithm: 8 T. Sauer Corollary 3. (Piecewise Polynomial Representation) Let F be a C k piece- wise polynomial of degree n on some triangulation T = {∆(I) : I ∈ I} of lR s. If the set of knots is given by the vertices ti of T , having multiplicity n − k, i.e., ti,0 = ti0,n−k−1 = ti, then F (u) = ∑ I∈I ∑ |λ|=n fI (tI λ)N I λ(u). If F is a polynomial, then we have F (u) = ∑ I∈I ∑ |λ|=n f (tI λ)N I λ(u). Setting F ≡ 1 immediately implies that 1 = ∑ I∈I ∑ |λ|=n N I λ(u); i.e., the B–Splines again form a partition of unity. Let me ﬁnally remark that similar results can also be obtained for spline functions deﬁned on some ﬁnite triangulation of some bounded do- main as long as the knots associated to vertices on the boundary are chosen in a reasonable way. References 1. Dahmen, W., C.A. Micchelli, and H.P. Seidel, Blossoming begets B– spline bases built better by B–patches. Math. Comp. 59 (1992), 97– 115. 2. H¨ollig, K., Multivariate splines, SIAM J. Numer. Anal. 41 (1982), 1013–1031. 3. Micchelli, C.A., On a numerically eﬃcient method of computing multi- variate B–splines, in Multivariate Approximation Theory, W. Schempp and K. Zeller (eds.), Birkh¨auser, Basel, 1979, 211–248. 4. Seidel, H.P., Representing piecewise polynomials as linear combina- tions of multivariate B–splines, in Mathematical Methods in Computer Aided Geometric Design, T. Lyche and L. L. Schumaker (eds.), Aca- demic Press, 1992, 559–566. Thomas Sauer Mathematical Institute, University Erlangen-Nuremberg, Bismarckstr. 1 1 2 , 91054 Erlangen sauer@mi.uni-erlangen.de","libVersion":"0.3.2","langs":""}