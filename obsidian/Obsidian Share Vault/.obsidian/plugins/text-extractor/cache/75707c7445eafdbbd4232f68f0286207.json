{"path":"lit/lit_sources.backup/Pineda10scenarioRedRiskAvrs.pdf","text":"Published in IET Generation, Transmission & Distribution Received on 15th July 2009 Revised on 21st October 2009 doi: 10.1049/iet-gtd.2009.0376 ISSN 1751-8687 Scenario reduction for risk-averse electricity trading S. Pineda A.J. Conejo Department of Electrical Engineering, University of Castilla-La Mancha, Ciudad Real, Spain E-mail: antonio.conejo@uclm.es Abstract: Stochastic optimisation models used to identify risk-averse decisions in electricity futures markets are usually hard to solve because of the large number of scenarios representing the uncertain parameters involved. A novel scenario reduction technique is proposed to select those scenarios that, considering the risk aversion of the decision maker, best represent the original scenario set and make the optimisation problem tractable. Two case studies illustrate the performance of the proposed technique to reduce scenarios pertaining to both continuous and discrete uncertain parameters. The advantage of the proposed technique against the existing ones is apparent in highly risk-averse cases. 1 Introduction 1.1 Motivation Nowadays, a wide range of electricity derivatives (futures market products) are available in current electricity markets, allowing market agents to hedge their proﬁt risks owing to the high volatility of the pool prices [1]. Among these electricity derivatives, the one considered in this paper is the forward contract, which is by far the commonest in electricity markets. Roughly speaking, a forward contract is a ﬁnancial instrument that allows selling/buying electricity throughout a future period at a certain price. Since decisions related to forward contracts should be made without knowing the actual realisations of some uncertain parameters affecting the time period covered by these contracts, stochastic optimisation is an appropriate mathematical tool to make these decisions. In stochastic programming, plausible realisations of the stochastic processes describing uncertain parameters throughout the decision-making horizon are represented via a set of scenarios [2]. Therefore the higher the number of scenarios representing the stochastic processes involved, the more accurate the solution of the optimisation problem. However, a large number of scenarios may result in high computational times or even intractability. For this reason, a scenario reduction technique is needed to identify a reduced scenario set that keeps, as much as possible, the stochastic properties of the original one. The stochastic optimisation models used by market agents to determine their optimal portfolio of contracts in thefutures market includeanappropriatemodel forthe risk of proﬁt/cost. Basically, a risk-averse agent makes its decisions trying to avoid low-proﬁt/high-cost scenarios. Consequently, the required scenario reduction technique should take into account the risk aversion of the decision maker. 1.2 Literature review In the technical literature, the most used scenario reduction technique deﬁnes the distance between two scenarios as the norm of a vector calculated as the difference between the corresponding two scenario vectors, which contain the two realisations of the stochastic process throughout the decision-making horizon [3 – 6]. For example, let x and y [ Rn be two vectors representing two possible scenarios (realisations) of a stochastic process. The distance between these scenarios, calculated as the Euclidean norm, is equal to \u0002\u0002\u0002\u0002\u0002\u0002\u0002\u0002\u0002\u0002\u0002\u0002\u0002\u0002\u0002\u0002\u0002∑n i=1 (xi − yi)2 √ . This technique is used in [7– 12] to reduce the scenario set representing the uncertainty of the considered models, thus making the corresponding stochastic optimisation problems computationally tractable. 694 IET Gener. Transm. Distrib., 2010, Vol. 4, Iss. 6, pp. 694– 705 & The Institution of Engineering and Technology 2010 doi: 10.1049/iet-gtd.2009.0376 www.ietdl.org An alternative scenario reduction technique based on the values of the objective functions of single-scenario optimisation problems is proposed in [13] for risk-neutral models. However, most electricity market agents are risk averse, that is, they make their decisions taking into account not only the expected proﬁt, but also the proﬁt variability. Recognising this fact, we propose a scenario reduction technique tailored to risk-averse electricity trading. It should be noted that the proposed method is heuristic. However, experimental results show its efﬁcacy for risk-averse electricity trading problems. 1.3 Contribution The contributions of this paper are threefold: 1. To provide an efﬁcient scenario reduction technique for risk-constrained stochastic programming problems involving both continuous and discrete uncertain parameters. 2. To show the good computational performance of the proposed technique using two realistic case studies. 3. To present a complete formulation of the investment portfolio model of a power producer in an electricity market. 1.4 Paper organisation The rest of this document is organised as follows. In Section 2, a generic stochastic optimisation model to identify market agent decisions is presented. Based on this model, the proposed scenario reduction algorithm is explained, emphasising its differences with existing algorithms. Two different case studies related with the risk-averse electricity trading of a producer are used to analyse the performance of the proposed technique in Sections 3 and 4. In Section 3, a large scenario set involving uncertain pool prices throughout one month is reduced using the proposed scenario reduction technique and alternative ones. In Section 4, the proposed scenario reduction technique and others are applied to reduce a scenario set representing the discrete availability of a production unit. Section 5 provides some relevant conclusions. 2 Proposed methodology 2.1 Mathematical formulation In stochastic optimisation models, the uncertain parameters (e.g. the pool price or the availability of a production unit) are represented via a set of scenarios lv. In stochastic recourse models, some of the decisions must be made before information relevant to the uncertainties is available (here-and-now or ﬁrst-stage decisions), whereas some other decisions can be delayed until uncertain parameter values are realised (wait-and-see or second-stage decisions). Therefore these models are the best choice to decide the optimal portfolio in electricity futures markets, since the energy traded through forward contracts should be determined in advance, that is, without knowing the values of the pool prices, whereas the decisions related with the energy traded in the pool are made with precise information on pool prices. In the following, we consider a proﬁt maximisation market agent. Note that the case of a cost minimisation agent can be addressed similarly as the case of a proﬁt maximisation agent. Decision makers are generally risk averse, that is, they make futures market decisions based not only on the expected proﬁt, but also on the possibility of experiencing low proﬁts. The Conditional Value at Risk (CVaR) is a commonly used risk measure in portfolio optimisation models [14] and [15]. The CVaR of a probability distribution with a conﬁdence level a is deﬁned as the mean value of these scenarios with the lowest proﬁts and with an accumulated probability equal to 1 2 a (see Fig. 1). The Value at Risk (VaR) is equal to the proﬁt such that the probability for a proﬁt being less than this value is equal to 1 2 a. Therefore the CVaR can also be deﬁned as the mean value of those proﬁts lower than the VaR, and it Figure 1 Illustration of CVaR IET Gener. Transm. Distrib., 2010, Vol. 4, Iss. 6, pp. 694 – 705 695 doi: 10.1049/iet-gtd.2009.0376 & The Institution of Engineering and Technology 2010 www.ietdl.org is calculated as follows maximise z,hv CVaRa = z − 1 1 − a ∑NV v=1 pvhv (1) subject to −profitv + z − hv ≤ 0, ∀v (2) hv ≥ 0, ∀v (3) where proﬁtv is the proﬁt in scenario v with an associated probability equal to pv. z is an auxiliary variable whose optimal value corresponds to the value of the VaR. From (2) and (3), and taking into account that the optimisation problem seeks to minimise the value of hv for each v, the optimal value of hv is the highest possible value between 0 and z − profitv. Therefore at the optimum hv is the difference between the VaR and the value of the proﬁt for each one of those scenarios with a proﬁt lower than the VaR (shadow area in Fig. 1), and is equal to 0 otherwise. The second term of the objective function is the average value of hv. Since the average is computed over those hv different from 0, the summation needs to be divided by the sum of the probabilities of these cases, that is, 1 2 a. At the optimum, the difference between the VaR and this average value is equal to the so-called CVaR. Fig. 1 represents the probability density function (pdf ) and the cumulative distribution function (cdf ) of a proﬁt distribution, indicating the values of VaR and CVaR for a conﬁdence level a. Note that only proﬁt values smaller than VaR are needed to calculate the value of CVaR. Considering a two-stage stochastic programming model, variable x represents the ﬁrst-stage decisions, that is, the energy traded in the futures market throughout forward contracts; and the variable yv represents the second-stage decisions, that is, the energy traded in the pool as a function of the realisations of the stochastic process lv. PF(·) and PP(·) represent the proﬁt obtained from the futures and pool trading, respectively. Therefore the stochastic optimisation problem including the risk aversion of the decision maker to be solved is [15] maximise x,yv,z,hv z = PF(x) + CVaRa(PP(lv, x, yv), z, hv) (4) subject to (x, yv) [ V, ∀v (5) (z, hv) [ J, ∀v (6) Objective function (4) represents the forward contract revenue plus the CVaR of the pool proﬁt for a conﬁdence level a, calculated according to (1). Equations (5) determine the feasibility region of ﬁrst- and second-stage variables according to the constraints of the futures and pool markets. Equations (6) impose limits on the auxiliary variables needed to calculate the CVaR (see (2) and (3)). As the objective function of the optimisation model is, in part, to maximise the value of the CVaR, the higher the value of a, the higher the risk aversion of the market agent. Note that maximising the CVaR of a proﬁt distribution for a ¼ 1 is equivalent to make the decisions based on the worst-case scenario. On the other hand, the risk-neutral case is achieved for a ¼ 0 since the corresponding value of the CVaR is equal to the expected value of the probability distribution of proﬁt. 2.2 Scenario reduction algorithm The time and memory resources needed to solve model (4) – (6) may increase exponentially if a large set of scenarios is considered to represent the stochastic processes involved. For this reason, a scenario reduction algorithm is needed. Since only scenarios with a proﬁt lower than the VaR are needed to calculate CVaR, the main contribution of the proposed scenario reduction technique consists in reducing the original scenario set considering the values of the variable hv. This way, all scenarios with a proﬁt higher than the VaR (hv = 0) are merged into one single scenario with a probability equal to a, whereas the scenarios with a proﬁt lower than VaR are reduced based on the values of hv. Let lv be the set of scenarios representing the realisations of a stochastic process l. The algorithm to reduce the original scenario set according to the proposed method is presented below. As an example, a set of ﬁve equiprobable scenario vectors containing the pool prices throughout 4 time periods is used to clarify each step of the algorithm. These scenarios are: l1 = {15, 27, 32, 24}, l2 = {19, 26, 30, 25}, l3 = {16, 28, 31, 26}, l4 = {13, 30, 29, 25} and l5 = {14, 29, 28, 23}. 1. Calculate the average scenario (l =E{lv}) and solve the deterministic problem associated with it to compute the values for the ﬁrst-stage variables (x). For the example, we solve a simple investment portfolio optimisation problem with the average pool price scenario (l = {15.4, 28.0, 30.0, 24.6}) obtaining that the ﬁrst stage variable x is equal to 0. In this example, this variable represents the power sold through the available forward contract. 2. Fixing the ﬁrst-stage variables to those values calculated in the previous step (x = x), solve as many single-scenario optimisation problems as scenarios in the original set (lv), obtaining the corresponding values of the objective functions zv. The set of pairs (zv, pv) determines the probability distribution of the proﬁt obtained through the set of deterministic problems. 696 IET Gener. Transm. Distrib., 2010, Vol. 4, Iss. 6, pp. 694– 705 & The Institution of Engineering and Technology 2010 doi: 10.1049/iet-gtd.2009.0376 www.ietdl.org For the example, we solve ﬁve optimisation problems ﬁxing the ﬁrst stage variable to 0 and considering a different pool price scenario for each problem. The set of objective functions and probabilities is provided in Table 1. 3. Calculate the value of the CVaRa of the proﬁt probability distribution obtained in step 2, and compute the values of the auxiliary variables hv associated with all scenarios of the original set. For the example and for a value of a equal to 0.2, the value of the VaR is 6000 because the probability of experiencing a proﬁt lower than or equal to this quantity is equal to 1 2 a (i.e. 0.8). Therefore the values of the variable hv for each scenario are: h1 = 200, h2 = 0, h3 = 0, h4 = 300 and h5 = 600. 4. Compute the distance matrix, c(v, v ′). Each component of this matrix is equal to the absolute value of the difference between the variables hv and h ′ v calculated in the previous step, that is c(v, v ′) =|hv − hv′ | (7) For the example, the distance matrix c is c(v, v ′) = 0 200 200 100 400 200 0 0 300 600 200 0 0 300 600 100 300 300 0 300 400 600 600 300 0 ⎛ ⎜ ⎜ ⎜ ⎜ ⎝ ⎞ ⎟ ⎟ ⎟ ⎟ ⎠ Note that the distance between any two scenarios with a proﬁt higher than the VaR is equal to 0. 5. Use the fast forward algorithm in [3] to select those scenarios for the reduced set and update their probabilities. Roughly speaking, the fast forward algorithm is a heuristic procedure to build a reduced scenario set minimising its so- called probability distance with respect to the original set. In each step of the algorithm, the scenario which minimises the probability distance between the reduced and the original set is added to the former until the required number of selected scenarios is achieved. Once the reduced scenario set is determined, the probability of each non- selected scenario is added to its ‘closest’ selected scenario according to the probability distance. A detailed mathematical description of the fast forward algorithm is provided in the Appendix. For the example, if the fast forward algorithm is used to determine a reduced set of three scenarios, the selected scenarios are l1, l4 and l2, with probabilities 0.2, 0.4 and 0.4, respectively. It is important to note that the proposed scenario reduction technique is based on solving single-scenario problems with ﬁrst-stage decisions ﬁxed to those obtained solving a deterministic average-value problem (step 1 of the proposed algorithm). Thus, the pdf of the proﬁt corresponding to the single-scenario problems may differ from the pdf of the proﬁt obtained solving the stochastic optimisation with the original scenario set. The more the similar these two probability distributions are (e.g. in terms of their moments), the higher the accuracy of the proposed algorithm. Note also that the proposed technique ignores all scenarios with a proﬁt higher than the value of the VaR. Consequently, non-exact values for the ﬁrst-stage variables may cause some relevant scenarios for the calculation of the CVaR to be neglected. For this reason, in the calculation of the variables hv (step 3 of the algorithm), the value of the parameter a is reduced a quantity Da to decrease the possibility of neglecting potentially relevant scenarios (see Fig. 1). The higher the value of Da, the lower the probability of ignoring important scenarios. However, a high value of Da implies a value of a close to 0, and therefore the risk aversion of the decision maker is neglected in the scenario reduction process. Note that the modiﬁcation of the parameter a affects only the scenario reduction stage, whereas its original value is maintained to solve the stochastic problem with the reduced scenario set. 2.3 Comparison The proposed scenario reduction technique is compared with other two techniques. The main difference between these techniques and the proposed one is the deﬁnition of the distance between two scenarios, that is, the calculation of the distance matrix described in step 4 of the proposed algorithm in Section 2.2. † Technique 1: In [3 – 6] the distance between two scenarios is deﬁned as the norm of the difference between the two vectors containing the values of the stochastic process for these two scenarios, that is c(v, v ′) =∥lv − lv′ ∥ (8) † Technique 2: The algorithm proposed in [13] considers the distance between two scenarios as the absolute value of the difference between the objective function of the corresponding single-scenario optimisation problems if the ﬁrst-stage decisions are ﬁxed and those obtained for the Table 1 Example: Objective functions and probabilities of the single-scenario optimisation problems Scenario v ¼ 1 v ¼ 2 v ¼ 3 v ¼ 4 v ¼ 5 Probability 0.2 0.2 0.2 0.2 0.2 Objective function (E) 5800 6000 6100 5700 5400 IET Gener. Transm. Distrib., 2010, Vol. 4, Iss. 6, pp. 694 – 705 697 doi: 10.1049/iet-gtd.2009.0376 & The Institution of Engineering and Technology 2010 www.ietdl.org deterministic average-value problem, that is c(v, v ′) =|zv − zv′| (9) † Technique 3: The algorithm proposed in this paper computes the distance between two scenarios using the auxiliary variable hv, that is c(v, v ′) =|hv − hv′ | (10) Note that Techniques 2 and 3 exploit the particular characteristics of the considered model because they reduce the original scenario set by solving the optimisation problem corresponding to each scenario. The main purpose of these three techniques is to build a reduced scenario set that results in a CVaR value as close as possible to that obtained with the original set. For this reason, these three techniques are compared based on the evolution of the CVaR error with the number of scenarios in the reduced scenario set. The lower the CVaR error value, the more efﬁcient the scenario reduction technique. The evolution of the CVaR error with the number of scenarios is determined according to the following steps: 1. Select the number of scenarios in the reduced scenario set (n). This number is changed between one and the total number of scenarios in the original set to obtain the evolution of the CVaR error with the number of scenarios. 2. Use one of the considered scenario reduction techniques to select n scenarios according to its corresponding distance deﬁnition and the fast forward selection algorithm. 3. Solve the considered stochastic optimisation problem taking into account only the n scenarios selected in the previous step, and obtain the value of ﬁrst-stage decisions. 4. Fix ﬁrst-stage decisions to those calculated in the previous step and solve one single-scenario optimisation problem for each scenario of the original set. 5. Compute the value of the CVaRa of the proﬁt distribution determined in the previous step. 6. Calculate the relative error between the CVaR obtained in the previous step and the CVaR corresponding to the stochastic model solved with the total number of scenarios. Note that the latter value of the CVaR is independent of the scenario reduction technique, and thus it is used for comparison. It is relevant to note that in the simulations presented below, the number of scenarios pertaining to the original set is small enough for the stochastic optimisation problem to be tractable considering all scenarios, and therefore, the CVaR error can be calculated to compare the different scenario reduction techniques. However, in most cases, the stochastic optimisation problem with the original scenario set is intractable. In this case, we may use initially a small reduced scenario set that makes the problem tractable. Then, the cardinality of this initial set is increased until the evolution of the CVaR stabilises. 3 Application 1: producer trading model In this section, we present the formulation of a stochastic optimisation model to determine the optimal forward contract decisions of a power producer [10]. For a producer, a forward contract is an agreement to sell a power quantity throughout a certain future time period and for a certain price agreed at the time of signing the forward contract. In this ﬁrst case study the forced outage rate of the production unit is neglected. Therefore the proposed scenario reduction technique is used to reduce the original scenario set representing the stochastic pool price throughout the planing horizon. Some conclusions about the performance of the proposed algorithm are presented at the end of this section. 3.1 Formulation The considered stochastic programming problem is maximise Pc ,PP tv,z,hv ∑NC c=1 lcPcTc + z − 1 1 − a ∑NW v=1 pvhv (11) subject to P G tvLt = ∑ c[Ft PcLt + PP tvLt, ∀t, ∀v (12) P G tv ≤ utvP max, ∀t, ∀v (13) P G tv ≥ utvP min, ∀t, ∀v (14) Pc ≤ P max c , ∀c (15) − ∑NT t=1 (l P tvPP tvLt − (autv + bP G tv + c(P G tv)2)Lt) + z − hv ≤ 0, ∀v (16) hv ≥ 0, ∀v (17) Pc ≥ 0, ∀c (18) PP tv ≥ 0, ∀t, ∀v (19) utv [ {0, 1}, ∀t, ∀v (20) The notation used in the stochastic optimisation model above is stated next. Continuous variables are described in the following. P G tv and P P tv are, respectively, the power generated by the unit and the power traded in the pool 698 IET Gener. Transm. Distrib., 2010, Vol. 4, Iss. 6, pp. 694– 705 & The Institution of Engineering and Technology 2010 doi: 10.1049/iet-gtd.2009.0376 www.ietdl.org during period t and scenario v (MW), Pc is the power sold through forward contract c (MW), and z and hv are the auxiliary variables related to the CVaR (E). The random variable considered is the pool price in period t, l P t (E/MWh). utv represents a binary variable that is equal to 1 if the unit is online during period t and scenario v, and 0 otherwise. Constants are described in the following. a, b, c are the coefﬁcients of the quadratic production cost function of the unit, Lt is the duration of time period t (h), P max and Pmin are the maximum and minimum power output of the unit (MW), P max c is the maximum power that can be sold through contract c (MW), Tc is the duration of contract c (h), a is the per unit conﬁdence level, lc is the energy price of forward contract c (E/MWh), l P tv is the pool price in period t and scenario v (E/MWh) and pv is the probability of occurrence of scenario v. NC , NT and NW are the number of forward contracts, time periods and scenarios, respectively. Ft represents the set of forward contracts available during period t. The objective function (11) consists of maximising the CVaR of the proﬁt probability distribution. The risk aversion of the decision maker is modelled via the conﬁdence level a. Constraints (12) impose the balance between the energy produced by the unit and energy sold, both in the pool and through forward contracts. Constraints (13) and (14) enforce the generating limits of the production unit in each time period and for each scenario. The maximum power sold through each forward contract is imposed with constraints (15). To calculate the value of the CVaR, the proﬁt of the power producer in scenario v is replaced in (2), obtaining constraint (16) for each scenario v. Constraints (17) – (19) are non-negativity variable declarations and constraints (20) are binary variable declarations. In this stochastic model, the ﬁrst-stage variables are the powers sold through the available forward contracts. Each one of these ﬁrst-stage variables depends mainly on the value of each forward price compared with the pool prices throughout its delivery period. For this reason, a set of prices for each forward contract are considered to analyse the behaviour of the scenario reduction techniques for high, medium and low forward contract prices. For such a purpose, a critical price is calculated as the price for which the optimal objective function value remains invariant whether or not the contract is signed. Therefore if the price of the contract is much higher than the critical price, the contract would be signed by the producer, and it would not if the price is signiﬁcantly smaller. However, if the forward price is close to its critical price, the pool price scenarios belonging to the reduced set can signiﬁcantly change ﬁrst- stage decisions, and, therefore, the scenario reduction technique becomes a very outstanding issue. To calculate the value of the critical price of a given forward contract, two optimisation problems are solved. In the ﬁrst one, the power sold through this contract is ﬁxed to 0 MW (Pc = 0). The value of the objective function is obtained and denoted CVaR1. In the second one, the forward contract price is set to 0 E/MWh (lc = 0) and the power sold is ﬁxed to the maximum power of this particular forward contract (Pc = Pmax c ). The value of the objective functions of this problem is denoted CVaR2. Taking into account that the CVaR is a coherent risk measure [14], and therefore positively homogeneous, if the price of the contract is increased a given value and the power sold through the contract is maintained to its maximum value, CVaR2 increases a quantity equal to the new price times the maximum power sold times the contract duration. Therefore the price for which the CVaR remains invariant whether or not the contract is signed can be computed as follows CVaR1 = CVaR2 + l ∗ c P max c Tc (21) and l ∗ c = CVaR1 − CVaR2 Pmax c Tc (22) where Pmax c , l ∗ c and Tc are the maximum power to be sold, the critical price and the duration of the forward contract c, respectively. 3.2 Problem data The case study reported below considers a planning horizon of one month. Historical data from the Spain zone of the electricity market of the Iberian Peninsula in the year 2000 are used to adjust the parameters of both the autoregressive and moving average part of an ARIMA model [16]. Once these parameters are adjusted, 200 equally probable pool price scenarios are generated by randomly simulating the non-explicable part of the pool price series, which consists of a Gaussian random variable of zero mean and a standard deviation equal to 0.19. For the sake of tractability, 24 pool prices of each day are aggregated in six values per day. The considered production unit has a maximum and minimum power outputs of 450 and 50 MW, respectively. The quadratic production cost of this unit is approximated by the set of four linear blocks characterised in Table 2 [17]. The risk aversion parameter (a) of the producer varies from 0 (neutral-risk case) to 0.9 (highly risk-averse case). IET Gener. Transm. Distrib., 2010, Vol. 4, Iss. 6, pp. 694 – 705 699 doi: 10.1049/iet-gtd.2009.0376 & The Institution of Engineering and Technology 2010 www.ietdl.org Five forward contracts are available during the month: one spans the whole month and the other four span each one of the weeks of the month. The maximum quantity that can be sold through each forward contract is 200 MW for the monthly contract and 150 MW for each weekly one. The forward contract characteristics are given in Table 3. Table 4 provides the critical price for the ﬁve available contracts for the neutral-risk case (a ¼ 0) and for a highly risk-averse case (a ¼ 0.9). Note that the higher the risk aversion of the producer, the lower the critical price of the forward contract. The reason is that a very risk-averse producer is willing to hedge its proﬁts through a forward contract even if its price is low. For each forward contract, ten different uniformly distributed prices between the critical prices for a ¼ 0.9 and a ¼ 0 are considered. These ten sets of contract prices are presented in Table 5. The aim of solving ten different optimisation problems (one for each set of contract prices) for each value of the risk aversion a is to consider a variety of relevant cases. Although the critical prices are calculated only for a ¼ 0 and a ¼ 0.9 (extreme cases), there exists a critical price for each value of a and each contract. However, these values are between the two critical prices in Table 4, and thus they are adequately represented using the ten price sets of Table 5. Six values for the risk aversion parameter (a ¼ 0, 0.2, 0.4, 0.6, 0.8, 0.9) and ten values for contract prices (Table 5)are considered. Therefore the three scenario reduction techniques described in Section 2.3 are used for solving 60 optimisation problems. As explained in Section 2.2, the value of the risk aversion parameter a is reduced to calculate the values of the auxiliary variables hv used in the proposed scenario reduction algorithm. The values of Da used in this case study are Da = 0if 0 , a ≤ 0.1 0.1if 0.1 , a ≤ 0.5 0.2if 0.5 , a ≤ 0.7 0.3if 0.7 , a ≤ 1 ⎧ ⎪⎪⎨ ⎪⎪⎩ 3.3 Results and discussion Fig. 2 compares the evolution of the CVaR error with the number of scenarios obtained for each scenario reduction technique, two values of the risk aversion parameter (a) and two sets of contract prices. Techniques 2 and 3 outperform Technique 1 for both low and high values of the risk aversion parameter (a ¼ 0.2 and a ¼ 0.8), requiring fewer scenarios to reach a low value of the CVaR error. For example, if a ¼ 0.2, the number of scenarios needed by Techniques 1, 2 and 3 to reduce the CVaR error below 1% are 98, 7, and 5, respectively. If the risk aversion parameter is higher (a ¼ 0.8), the difference between these techniques is even higher, being required 185, 21, and 5 scenarios, respectively. Note that for a low value of a, Techniques 2 and 3 perform similarly, whereas for the highly risk-averse case, Technique 3 reduces the error of the CVaR faster than Technique 2. The reason is that the former considers the risk aversion parameter a in the algorithm to select the reduced scenario set. Table 3 Forward contract quantity and duration Contract # Power (MW) Duration 1 200 month 2 150 week 1 3 150 week 2 4 150 week 3 5 150 week 4 Table 4 Critical price of forward contracts (E/MWh) Contract # 12345 a ¼ 0 26.88 24.52 26.98 28.04 27.90 a ¼ 0.9 20.23 20.77 20.58 19.67 20.40 Table 2 Piecewise linear production cost for the production unit Block # 1 2 3 4 Power block (MW) 150 250 350 450 Price (E/MWh) 12.0 12.5 13.0 13.5 Table 5 Price scenario reduction: Sets of prices for forward contracts (E/MWh) Set Contract # 12345 1 19.73 20.27 20.08 19.17 19.90 2 20.58 20.80 20.90 20.21 20.84 3 21.43 21.33 21.72 21.25 21.79 4 22.28 21.85 22.55 22.29 22.73 5 23.13 22.38 23.37 23.33 23.68 6 23.98 22.91 24.19 24.38 24.62 7 24.83 23.44 25.01 25.42 25.57 8 25.68 23.96 25.84 26.46 26.51 9 26.53 24.49 26.66 27.50 27.46 10 27.38 25.02 27.48 28.54 28.40 700 IET Gener. Transm. Distrib., 2010, Vol. 4, Iss. 6, pp. 694– 705 & The Institution of Engineering and Technology 2010 doi: 10.1049/iet-gtd.2009.0376 www.ietdl.org To analyse the performance of the algorithms over the 60 considered problems, a mean value of the CVaR error over the contract price sets is computed for each value of a. Fig. 3 depicts this mean value for three values of the risk aversion parameter (a ¼ 0, 0.6, 0.9). Techniques 2 and 3 produce reduced scenario sets that yield CVaR values closer to that obtained with the original scenario set (200 scenarios). Moreover, the higher the risk aversion parameter, the more the effective Technique 3 as compared with Technique 2. Fig. 4 represents the mean value of the CVaR error over all values of the risk aversion parameter and forward prices for the three techniques. It can be concluded that if risk aversion is considered, Technique 3 results in signiﬁcantly smaller CVaR errors than those obtained using the other two techniques. 4 Application 2: producer trading model revisited In this section, the unexpected forced outages of the production unit are considered by the producer to make its futures market decisions. The availability of the production unit is represented via a large number of 1/0 scenarios, which are reduced using the proposed scenario reduction technique. 4.1 Formulation The equally probable 1/0 scenarios representing the availability of the production unit are generated based on sampling two random variables: the time to the next failure and the time to repair. Historical data of the availability of production units prove that these random variables follow exponential distributions with mean values equal to the mean time to failure (MTTF) and the mean time to repair (MTTR), respectively. Therefore each availability scenario is generated simulating consecutively the time until the next failure occurs (tF), and the time to repair this failure (tR) until the planning horizon is covered according to the following equations tF =−MTTF × ln(u1) (23) tR =−MTTR × ln(u2) (24) Figure 2 CVaR error evolution with the number of scenarios and selected a and contract price values Figure 3 Average CVaR error evolution with the number of scenarios and selected a values Figure 4 Average CVaR error evolution with the number of price scenarios and the three scenario reduction techniques IET Gener. Transm. Distrib., 2010, Vol. 4, Iss. 6, pp. 694 – 705 701 doi: 10.1049/iet-gtd.2009.0376 & The Institution of Engineering and Technology 2010 www.ietdl.org where u1 and u2 are random variables uniformly distributed between 0 and 1. Once a sequence of working and failure periods is simulated, the availability scenario is formed as follows (see equation at the bottom of the page) The percentage of the time that the production unit is unavailable is the forced outage rate (FOR) that can be calculated as FOR(%) = MTTR MTTR + MTTF 100 (25) The random variable kt represents the availability of the unit, that is, the value of ktv is equal to 0 if the production unit has an unexpected failure during the time period t and scenario v, and 1 otherwise. Therefore (13), (14) and (19) are modiﬁed as follows P G tv ≤ ktvutvPmax, ∀t, ∀v (26) PG tv ≥ ktvutvP min, ∀t, ∀v (27) P P tv ≥ 0, ∀t, ∀v : ktv = 1 (28) Note that constraints (26) and (27) impose that if the production unit has an unexpected failure (ktv = 0), the power output is necessarily equal to 0 MW. However, if the production unit is available (ktv = 1), the power output can take any value between P min and P max (utv = 1) or be equal to 0 MW (utv = 0). Constraints (28) allows the producer to buy energy in the pool during those periods and scenarios in which the unit is unavailable. The stochastic optimisation model (11) – (12), (15) – (18), (20) and (26) – (28) is used by a risk-averse producer to determine the power to be sold through forward contracts taking into account the unexpected failures of the production unit [18]. An important issue to apply the proposed algorithm to reduce discrete availability scenarios is the deﬁnition of the average scenario used to compute the ﬁrst-stage decisions associated with the deterministic problem. Selecting an adequate average value scenario is important for the good performance of the proposed technique, because the single- scenario problems that determine the value of hv are solved ﬁxing the ﬁrst-stage decision to those obtained for the deterministic problem associated with the average scenario. An appropriate manner to generate the average availability scenario is to consider that the time between two consecutive failures and the time to repair a failure are equal to their mean values, that is, MTTF and MTTR, respectively. Therefore the average scenario used to solve the deterministic problem is obtained as l = [111 .. . 11︸︷︷︸ MTTF ones 00 0 ... 00︸︷︷︸ MTTR zeros .. . 111 .. . 11︸︷︷︸ MTTF ones ] 4.2 Problem data As in the previous case study, the considered planning horizon expands one month. The scenario reduction technique is used to reduce the set of scenarios representing the availability of one production unit. For this case study, 20 pool price scenarios are used in all cases. Three different values of the FOR are considered: 5, 10 and 20%. The data presented in Table 6 are used to generate 50 availability scenarios for each value of FOR. Once pool price and availability scenarios are generated, the ﬁnal set of scenarios is obtained by combining all possible availability scenarios with all possible price scenarios. Since the 24 hourly pool prices of each day are aggregated in six periods per day, the availability of the production unit in each period and scenario is calculated as the average value of the corresponding hourly availabilities. Note that this average value has to be rounded to 0 or 1. Besides the value of FOR, the rest of the characteristics of the production unit are identical to those presented in Section 3.2. The same ﬁve forward contracts as in Section 3.2 are considered in this case study. However, the values of the critical prices change owing to the FOR of the production unit. Ten uniformly distributed contract prices are determined for each contract between its highest critical price (a ¼ 0and FOR ¼ 5%) and its lowest one (a ¼ 0.9 and FOR ¼ 20%). Table 7 shows the resulting ten forward prices sets. The three scenario reduction techniques are used to reduce the set of scenarios representing the availability of the unit and to compute the CVaR error in 180 optimisation problems (three values of FOR, six risk aversion parameters and ten sets of forward prices). Note that to calculate the ﬁrst-stage decisions associated with a reduced availability scenario set, the original 20 pool price scenario set is always considered. Table 6 Unit availability data FOR (%) MTTF (h) MTTR (h) 5 500 26 10 400 45 20 300 75 lv = [111 .. . 11︸︷︷︸ tF(1) 00 0 .. . 00︸︷︷︸ tR(1) 11 .. . 1︸︷︷︸ tF(2) 0 .. . 00︸︷︷︸ tR (2) .. . 11 1 .. . 11︸︷︷︸ tF(N ) ] 702 IET Gener. Transm. Distrib., 2010, Vol. 4, Iss. 6, pp. 694– 705 & The Institution of Engineering and Technology 2010 doi: 10.1049/iet-gtd.2009.0376 www.ietdl.org 4.3 Results and discussion The evolution of the CVaR error obtained with the three scenario reduction techniques and for three values of forced outage rate, risk aversion parameters and forward price sets are depicted in Fig. 5. Techniques 2 and 3 outperform Technique 1 in all cases. However, as the risk aversion parameter a becomes higher, Technique 3 performs more efﬁciently than Technique 2. Fig. 6 represents for each value of FOR the evolution of the average CVaR error over all values of forward prices Figure 5 CVaR error evolution with the number of availability scenarios and selected a, FOR and contract price values Table 7 Availability scenario reduction: Sets of prices for forward contracts (E/MWh) Set Contract # 12345 1 17.0 15.0 16.8 18.5 19.0 2 18.0 16.0 17.8 19.5 20.0 3 19.0 17.0 18.8 20.5 21.0 4 20.0 18.0 19.8 21.5 22.0 5 21.0 19.0 20.8 22.5 23.0 6 22.0 20.0 21.8 23.5 24.0 7 23.0 21.0 22.8 24.5 25.0 8 24.0 22.0 23.8 25.5 26.0 9 25.0 23.0 24.8 26.5 27.0 10 26.0 24.0 25.8 27.5 28.0 Figure 6 Average CVaR error evolution with the number of availability scenarios for selected FOR values Figure 7 Average CVaR error evolution with the number of availability scenarios for selected a values IET Gener. Transm. Distrib., 2010, Vol. 4, Iss. 6, pp. 694 – 705 703 doi: 10.1049/iet-gtd.2009.0376 & The Institution of Engineering and Technology 2010 www.ietdl.org and risk aversion parameters. For a forced outage rate equal to 5%, the probability of an unexpected failure is so small, that the CVaR error is low even for a small set of availability scenarios (note that the scale of the vertical axis of all plots are identical). Therefore, no conclusions can be drawn regarding the scenario reduction techniques. On the other hand, for higher FOR values (10 and 20%) the CVaR error associated with the reduced availability scenario sets is high enough to compare the three scenario reduction techniques. In this regard, Techniques 2 and 3 yield notably lower values of the CVaR error than Technique 1. Fig. 7 shows, for some values of the risk aversion parameter a, the average CVaR error over all forward prices and FORs. As explained in Section 2.2, Techniques 2 and 3 are equivalent in the neutral-risk case (a ¼ 0). For a ¼ 0.6, Techniques 2 and 3 result in similar values for the CVaR error, presenting a better performance than Technique 1. However, the proposed technique outperforms the other techniques for high values of the risk aversion parameter, as a ¼ 0.9. An average value of the CVaR error is calculated considering the 180 optimisation problems considered. Fig. 8 depicts the evolution of this mean CVaR error with respect to the cardinality of the reduced availability scenario set. Note that the scenario reduction technique proposed in this paper reduces the original availability scenario set more effectively than the other two techniques described in the literature. In fact, the number of availability scenarios needed by Techniques 1, 2 and 3 to reduce the CVaR error below 0.1% are 31, 23 and 16, respectively. 5 Conclusions Electricity market agents use stochastic optimisation models to make informed trading decisions. These models describe uncertain parameters through scenarios. Owing to the large number of scenarios required to represent the uncertain parameters of stochastic optimisation models, a scenario reduction technique is required to make the corresponding problems tractable while keeping as much as possible the information contained in the original set of scenarios. This paper proposes a scenario reduction technique that explicitly considers the risk aversion of the decision maker in reducing the number of scenarios. The proposed technique proves effective to reduce scenarios pertaining to both continuous and discrete stochastic processes. Computational simulations involving decision-making problems in electricity markets allow concluding that the proposed technique is computationally efﬁcient and able to produce reduced scenario sets that result in decisions identical or very close to those pertaining to the original scenario set. 6 References [1] DENG S.J., OREN S.S.: ‘Electricity derivatives and risk management’, Energy, 2006, 31, (6 – 7), pp. 940 – 953 [2] BIRGE J.R., LOUVEAUX F.: ‘Introduction to stochastic programming’ (Springer, 1997) [3] HEITSCH H., RO¨MISCH W.: ‘Scenario reduction algorithms in stochastic programming’, Comput. Optim. Appl., 2003, 24, (2– 3), pp. 187– 206 [4] DUPACˇ OVA´ J., GRO¨ WE-KUSKA N., RO¨ MISCH W.:‘Scenario reduction in stochastic programming: an approach using probability metrics’, Math. Program., 2003, 95,(3), pp. 493– 511 [5] GRO¨ WE-KUSKA N., HEITSCH H., RO¨ MISCH W.:‘Scenario reduction and scenario tree construction for power management problems’. Proc. IEEE Power Tech Conf., Bologna, June 2003 [6] HEITSCH H., RO¨ MISCH W.: ‘A note on scenario reduction for two-stage stochastic programs’, Oper. Res. Lett., 2007, 35, (6), pp. 731– 738 [7] MATEVOSYAN J., OLSSON M., SO¨ DER L.: ‘Hydropower planning coordinated with wind power in areas with congestion problems for trading on the spot and the regulating market’, Electr. Power Syst. Res., 2009, 79,(1), pp. 39– 48 [8] TOPALOGLOU N., VLADIMIROU H., ZENIOS S.A.:‘A dynamic stochastic programming model for international portfolio management’, Eur. J. Oper. Res., 2008, 185,(3), pp. 1501 – 1524 Figure 8 Average CVaR error evolution with the number of availability scenarios for the three scenario reduction techniques 704 IET Gener. Transm. Distrib., 2010, Vol. 4, Iss. 6, pp. 694– 705 & The Institution of Engineering and Technology 2010 doi: 10.1049/iet-gtd.2009.0376 www.ietdl.org [9] PLAZAS M.A., CONEJO A.J., PRIETO F.J.: ‘Multimarket optimal bidding for a power producer’, IEEE Trans. Power Syst., 2005, 20, (4), pp. 2041– 2050 [10] CONEJO A.J., GARCI´A-BERTRAND R., CARRIO´ NM., CABALLERO A´ ., ANDRE´ SA.: ‘Optimal involvement in futures markets of a power producer’, IEEE Trans. Power Syst., 2008, 23,(2), pp. 703– 711 [11] CARRIO´ NM., PHILPOTT A.B., CONEJO A.J., ARROYO J.M.:‘A stochastic programming approach to electric energy procurement for large consumers’, IEEE Trans. Power Syst., 2007, 22, (2), pp. 744– 754 [12] CARRIO´ NM., CONEJO A.J., ARROYO J.M.: ‘Forward contracting and selling price determination for a retailer’, IEEE Trans. Power Syst., 2007, 22, (4), pp. 2105 – 2114 [13] MORALES J.M., PINEDA S., CONEJO A.J., CARRIO´ NM.:‘Scenario reduction for futures market trading in electricity markets’, IEEE Trans. Power Syst., 2009, 24,(2), pp. 878– 888 [14] PFLUG G.CH.: ‘Some remarks on the value-at-risk and the conditional value-at-risk’, in URYASEV S. (ED.): ‘Probabilistic constrained optimization: methodology and applications’ (Springer, 2000) [15] ROCKAFELLAR R.T., URYASEV S.: ‘Optimization of conditional value-at-risk’, J. Risk, 2000, 2, (3), pp. 21– 41 [16] CONEJO A.J., CONTRERAS J., ESPI´NOLA R., PLAZAS M.A.: ‘Forecasting electricity prices for a day-ahead pool-based electric energy market’, Int. J. Forecast., 2005, 21,(3), pp. 435– 462 [17] ARROYO J.M., CONEJO A.J.: ‘Optimal response of a thermal unit to an electricity spot market’, IEEE Trans. Power Syst., 2000, 15, (3), pp. 1098– 1104 [18] PINEDA S., CONEJO A.J., CARRIO´ NM.: ‘Impact of unit failure on forward contracting’, IEEE Trans. Power Syst., 2008, 23, (4), pp. 1768 – 1775 7 Appendix This appendix provides a mathematical description of the fast forward algorithm. Let v [ V be the original set of scenarios. The steps to select those NV∗ S scenarios pertaining to the reduced set V∗ S are as follows: Step 1: Determine the distance between each pair of scenarios belonging to V using either expression (8), (9) or (10) depending on the reduction technique. Step 2: For each scenario in V, calculate the average value of the distance between this scenario and the rest of scenarios. The scenario with the lowest average distance is the ﬁrst scenario selected for the reduced set VS. Mathematically this scenario is determined as follows v1 = arg min v′[V ∑ v[V pvc(v, v ′) {} (29) The set of non-selected scenarios is updated, that is, VJ \b− VJ\\{v1}. Step n: For each non-selected scenario, calculate the distance between the sets of selected and non-selected scenarios if this particular scenario is considered to belong to VS instead of VJ . The scenario that minimises this distance is the new selected scenario, which can be determined from vn = arg min v′[VJ ∑ v[VJ \\{v′} pv min v′′[VS <{v} c(v, v ′′) ⎧ ⎨ ⎩ ⎫ ⎬ ⎭ (30) The sets are updated as follows: VS \b− VS < {vn} and VJ \b− VJ\\{vn}. This step is repeated until the cardinality of the reduced set VS is equal to NV∗ S . Step N + 1: The probability of each non-selected scenario is added to its closest selected scenario according to the distance matrix. Mathematically, the probability redistribution is accomplished as follows p ∗ v = pv + ∑ v′[J (v) pv′ (31) where J (v) is deﬁned as the set of scenarios v ′ [ VJ such that v = arg minv′′[VS c(v ′′, v ′). IET Gener. Transm. Distrib., 2010, Vol. 4, Iss. 6, pp. 694 – 705 705 doi: 10.1049/iet-gtd.2009.0376 & The Institution of Engineering and Technology 2010 www.ietdl.org","libVersion":"0.3.2","langs":""}