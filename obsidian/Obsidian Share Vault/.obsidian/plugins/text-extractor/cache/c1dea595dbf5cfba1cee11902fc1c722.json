{"path":"lit/sources/Yang18OnlineStateofhealthEstimation.pdf","text":"Contents lists available at ScienceDirect Applied Energy journal homepage: www.elsevier.com/locate/apenergy Online state-of-health estimation for lithium-ion batteries using constant- voltage charging current analysis Jufeng Yanga,b, Bing Xiab,c, Wenxin Huanga, Yuhong Fub, Chris Mib,⁎ a Department of Electrical Engineering, Nanjing University of Aeronautics and Astronautics, 29 Jiangjun Street, Nanjing, Jiangsu 211106, China b Department of Electrical and Computer Engineering, San Diego State University, 5500 Campanile Drive, San Diego, CA 92182, USA c Department of Electrical and Computer Engineering, University of California San Diego, 9500 Gilman Dr., La Jolla, CA 92093, USA HIGHLIGHTS • Derived the expression of CV charging current based on ECM. • Introduced time constant of CV charging current to estimate battery SoH. • Established a quantitative correlation between current time constant and battery SoH. • Discovered that current time constant is a logarithmic function of ﬁtted data size. • Employed uncompleted CV charging data to estimate battery SoH. ARTICLE I NFO Keywords: Lithium-ion battery State-of-health (SoH) Constant-current constant-voltage (CCCV) charge Equivalent circuit model (ECM) Current time constant ABSTRACT Battery state-of-health (SoH) estimation is a critical function in a well-designed battery management system (BMS). In this paper, the battery SoH is detected based on the dynamic characteristic of the charging current during the constant-voltage (CV) period. Firstly, according to the preliminary analysis of the battery test data, the time constant of CV charging current is proved to be a robust characteristic parameter related to the battery aging. Secondly, the detailed expression of the current time constant is derived based on the ﬁrst order equivalent circuit model (ECM). Thirdly, the quantitative correlation between the normalized battery capacity and the current time constant is established to indicate the battery SoH. Speciﬁcally, for the uncompleted CV charging process, the logarithmic function-based current time constant prediction model and the reference correlation curve are established to identify the battery capacity fading. At last, experimental results showed that regardless of the adopted data size, the correlation identiﬁed from one battery can be used to indicate the SoH of other three batteries within 2.5% error bound except a few outliers. 1. Introduction Due to the high energy and power density, lithium-ion batteries have proved to be a promising candidate as the energy storage system in electric vehicles (EVs) and consumer electronics [1–3]. To ensure the safety and reliability of battery systems, the basic battery states, i.e., state-of-charge (SoC) [4,5], state-of-power (SoP) [6], and state-of- health (SoH) [7,8], should be monitored continuously by the battery management system (BMS). Hence, the accurate, robust and practical battery state estimation is one of the key functions of a BMS. However, batteries are sophisticated electrochemical devices with various non- linear characteristics. It is diﬃcult to estimate the above states with high accuracy and strong robustness. Especially for the SoH estimation, the complicated aging mechanism and the uncertain external conditions (such as temperature and load proﬁle) make it a more challenging task [9–11]. 1.1. Review of the literature To describe the deterioration of the power and the energy capability of the battery, the quantitative deﬁnition of the SoH is generally based on the impedance growth and/or the capacity loss. Hence, the SoH estimation can be converted to the identiﬁcation of the present im- pedance and/or capacity. Abundant research work has been conducted to seek the accurate impedance identiﬁcation, ranging from oﬄine tests, such as active/ passive impedance spectroscopy [12,13], to online estimation algo- rithms, such as extended Kalman ﬁlter (EKF) based and least squares https://doi.org/10.1016/j.apenergy.2018.01.010 Received 21 August 2017; Received in revised form 30 December 2017; Accepted 3 January 2018 ⁎ Corresponding author. E-mail addresses: nuaayjf@163.com (J. Yang), bixia@eng.ucsd.edu (B. Xia), huangwx@nuaa.edu.cn (W. Huang), YFU@mail.sdsu.edu (Y. Fu), cmi@sdsu.edu (C. Mi). Applied Energy 212 (2018) 1589–1600 0306-2619/ © 2018 Elsevier Ltd. All rights reserved. T based methods [14–17]. The battery capacity can generally be determined by two groups of approaches: the model-based and the correlation-based techniques. According to the employed battery model, the model-based tech- niques can be further classiﬁed into two categories, namely, the black box model-based and the equivalent circuit model (ECM)-based tech- niques. For the black box model-based techniques, artiﬁcial neural networks [18,19], support vector machine [20,21], sample entropy [22,23] and sparse bayesian modeling [24] are generally employed to estimate the capacity fade in batteries. The advantage of these ap- proaches is that the exact knowledge of battery aging mechanism is not considered, and only external behaviors of battery (e.g., voltage, cur- rent, and temperature) are required. Therefore, they are relatively simple and straightforward. However, the accuracy of the black box model is closely dependent on the quantity and quality of training data, which requires extensive oﬄine training investigations [25]. By con- trast, the ECM describes battery behaviors through a series of speciﬁc electric elements such as impedance components and voltage sources. The battery capacity can be estimated alone or together with other model parameters (e.g. impedance parameters, open circuit voltage (OCV)) and SoC through a variety of ﬁlters or observers, such as EKF [26,27], H-inﬁnity ﬁlter [28], and recursive least squares algorithm [29]. These methods can theoretically estimate the capacity and other parameters as precisely as the battery is modeled. However, it has to be noted that three disadvantages exist concerning this type of technique. Firstly, a suﬃcient time is required to ensure the estimated capacity converge to the stable value [26]. Secondly, the accuracy of the esti- mation results strongly depends on the precision of the battery model, while an accurate battery model can signiﬁcantly increase the compu- tational cost [30]. Thirdly, the cross interference terms among the es- timated variables can also compromise the estimation performance in terms of the numerical stability and accuracy [31]. From the perspective of correlation-based techniques, the battery capacity is indirectly determined based on the speciﬁc characteristic parameter, and the mapping relationship between capacity degradation and the related parameter variation should be established in advance. Typically, there exists several methods to derive the characteristic parameter from the dynamic discharging process [32,33]. However, besides the aging state, the battery model parameters are generally changeable with SoC, temperature and C-rate of the load current under the operating condition [12], and the accuracy of SoH estimation will be reduced without considering these inﬂuences. Ref. [32] selected the solid electrolyte interphase (SEI) resistance to predict the battery re- maining capacity by the appropriate correlation function. This ap- proach was found to be insensitive to discharge C-rate and eﬀective in estimating the battery remaining capacity. Speciﬁcally, the average SEI resistance with respect to the speciﬁc SoC range was utilized to reduce the inﬂuence of SoC. However, the battery parameters are generally identiﬁed online from dynamic operating conditions with a random SoC range. Thus, obtaining the average value covering the speciﬁc SoC range in practice is a challenging task. Ref. [33] developed a formula to determine the battery capacity based on the estimated diﬀusion capa- citance. The temperature dependency of diﬀusion capacitance was considered to improve the robustness of the ﬁtting function. None- theless, extensive laboratory investigations were required to obtain an accurate correlation. Some methods were developed based on the re- laxation data after the current interruption. With this kind of methods, the battery capacity can be derived based on the change in the OCV before and after a driving event [34,35]. Since only the SoC-OCV cor- relation was employed as a characteristic parameter, which was nearly unchanged by the battery aging state, these methods enabled a high accuracy of capacity estimation over the battery lifetime. However, the long-time relaxation period is required for the precise OCV measure- ment, which is not suitable for real applications. Recently, many re- searchers have concentrated on predicting the battery capacity based on the characteristic parameter extracted from the constant-current constant-voltage (CCCV) charging data. One of the commonly used methods is based on the incremental capacity (IC) or the diﬀerential voltage (DV) analysis [36–38]. With this type of technique, the battery aging mechanisms (i.e., loss of lithium inventory and loss of active material) can be identiﬁed by analyzing the peaks on the IC or DV curve [39]. However, since all the peaks on the IC or DV curve lie within the plateaus of the OCV curve which is vulnerable to the measurement noise, it is diﬃcult to identify the distinct peaks directly from the measured data set. Meanwhile, the IC and DV curves are generally derived from the pseudo or real OCV curve. It requires completely charging/discharging the battery with micro currents or recording the battery terminal voltage after a long-time relaxation process at SoC points covering the entire range. Both methods are time-consuming and thus are not suitable for the on-board application [39]. Ref. [40] es- tablished a quantitative correlation between battery capacity and IC peak value, and the support vector regression was employed to extract the IC peak value. Ref. [41] considered the normalized location interval of the DV curve as the characteristic parameter, and correlated it with the capacity loss. The improved center least squares method was em- ployed to extract the DV curve. These approaches utilized the battery charging data directly to detect the battery capacity fading, and showed robust performances against the measurement noise and data size. It has to be noted that better results would be expected using the OCV curve to obtain IC and DV curves, instead of the charging data [39,42]. In addition, because of the extensive computational power required, the robust parameter extraction algorithm employed in these methods is generally not applicable for the on-board implementation. Besides the IC or DV based methods, Ref. [43] calculated the battery pack capacity by transforming the charging voltage curve during the constant-current (CC) charging period, and only simple mathematical calculations were needed. However, the authors made the critical assumption that the battery should experience a complete CC charging cycle, which rarely happens in real applications, especially in EVs. Ref. [44] used the vol- tage-capacity rate curve to identify the battery capacity, and the genetic algorithm was carried out to ﬁnd the optimum transformation para- meter. Nevertheless, the performance of the voltage-capacity rate curve is sensitive to the sampling frequency and the measurement noise [40,45]. Moreover, the adopted genetic algorithm is still complicated for the on-board applications. Diﬀerent from the methods described above, Ref. [46] recognized the battery capacity loss according to the constant-voltage (CV) charging data. The simple mathematical function was proposed to simulate the battery current behavior during the CV charging period, and an obvious linear correlation between the model parameter and the battery capacity was exploited. Although the ver- iﬁcation results show that the simulated CV current matches well with the experimental data, the parameters in the developed function had no explicit physical meaning. Besides, a complete CV charging period is required to determine the accurate battery capacity loss, which is in- feasible from a practical point of view. 1.2. Contributions of the paper In this paper, the battery capacity fading is detected through the dynamic characteristic of the charging current during the CV period. The main contributions of this paper are: (1) The time constant of CV charging current is ﬁrstly introduced to indicate the battery aging state. Compared with the CV charging time, the current time constant is a more robust characteristic parameter related to the battery aging. Based on the employed ECM, the CV charging current is expressed in the recursive form to obtain the detailed expression of the current time constant. (2) An online battery SoH estimation method is developed based on the quantitative correlation between the normalized battery capacity and the current time constant. Experimental results show that there exist a strong linear regression between the normalized battery J. Yang et al. Applied Energy 212 (2018) 1589–1600 1590 capacity and the current time constant. Besides, the correlation function extracted from one battery is able to evaluate the SoH of other three batteries with less than 2.5% absolute error except a few outliers. (3) The uncompleted CV charging data is utilized to estimate battery SoH. Firstly, the logarithmic function-based prediction model is established to predict the reference current time constant. Then, the battery SoH can be estimated by substituting the reference time constant into the reference correlation curve. Comparison results demonstrate the superiority of the proposed method in terms of its robustness to data size. 2. Experimental tests and CV charging current analysis 2.1. Experimental setup The battery test bench includes the tested batteries, an Arbin BT2000 cycle-based tester, and a host computer with MITS Pro software for experiment control and data storage, as shown in Fig. 1. Four li- thium iron phosphate (LiFePO4) IFR26650PC batteries from Valence are adopted under test. All four batteries, which are numbered from #1 to #4, are cycled with the same current excitations for comparison and validation. The speciﬁc parameters of the tested battery are listed in Table 1. The Arbin BT2000 cycle-based tester is used to charge and discharge the batteries and collect the test data. The voltage and current measurement ranges are 0–5 V and ± 100 A, respectively. The current measurement error in the battery tester is less than 0.05%, and the initial SoC can be obtained precisely from the test platform. Thus, it is feasible to assume that the accumulative battery capacity calculated through the recorded current can be considered as the reference value for comparison. 2.2. Test procedure The test procedure, as shown in Fig. 2, is designed to generate rich excitations for the tested batteries. It mainly includes two parts: the aging and the characterization tests. All of the tests are conducted at room temperature (the ambient temperature is 25 ± 2 °C), and the measured data sets, including current, voltage and temperature, are recorded with the sampling frequency (fs) of 1 Hz. The aging tests are conducted to explore the aging mechanism of the battery, e.g., loss of lithium inventory, loss of active material and Ohmic resistance increase [9]. It cycles until the battery reaches the end-of-life (EoL) condition (i.e., the battery’s capacity reduces to 80% of its nominal capacity [32]). During each aging cycle, all four batteries are at 1C rate for CCCV charge and at 4C rate for CC discharge with no rest periods. The characterization tests are performed periodically after certain aging cycles, which are aimed to extract battery parameters and acquire the corresponding variation tendency along with aging. As illustrated in Fig. 2, the characterization tests consist of a capacity test, a hybrid pulse power characterization (HPPC) test and an Urban Dynamometer Driving Schedule (UDDS) test. The battery capacity is derived from the capacity test comprising 5 charge-discharge cycles. Each cycle includes a 1/2C rate CCCV charge (CC-CV transition voltage: 3.65 V, cutoﬀ current: 1/20C) and a 1/2C rate CC discharge processes. Finally, the battery capacity is calculated as the mean value of ﬁve cycles. The purpose of the HPPC test is to discharge/charge the battery to a certain SoC and excite the batteries dynamically. In the HPPC test, the battery is discharged/charged at a 5% SoC interval with 1/2C rate, and a 2 h rest is applied after each SoC variation operation. As shown in Fig. 3, the HPPC pulses include one pair of discharge and charge pulses. The magnitude and duration of each current pulse are 2C and 10 s, re- spectively. The rest period between each discharge and charge pulses (T1 in Fig. 3) is 40 s, and the rest period after current pulses (T2 in Fig. 3) is 60 s. The objective of the UDDS test is to validate the Tested batteries Arbin BT2000Host computer Current Voltage Temperature TCP/IP Fig. 1. Conﬁguration of the battery test bench. Table 1 Speciﬁcations of the tested battery. Type LiFePO4 Nominal capacity 2.5 Ah Nominal voltage 3.2 V Charge cutoﬀ voltage 3.65 V Discharge cutoﬀ voltage 2.0 V Aging test CCCV charging test CC discharging test Characterization test Y N Capacity test HPPC test UDDS test Reach certain aging cycles? Reach EoL? N Y End test Fig. 2. Battery aging test procedure. Time (s) 0 1020 304050607080 90 100 110 120Current (A) -7.5 -5 -2.5 0 2.5 5 7.5 T1 T2 Fig. 3. The current proﬁle of HPPC pulses. J. Yang et al. Applied Energy 212 (2018) 1589–1600 1591 eﬀectiveness of identiﬁed model parameters. In the UDDS test, the in- itial SoC is 90% and the cycle is repeated without rest until the SoC reaches 20%. 2.3. Preliminary CV charging current analysis Fig. 4 shows the CV charging time of all four batteries after diﬀerent aging cycles. For this study, all the CV charging data is extracted from the 5th cycle in the capacity test. It can be seen from Fig. 4 that the CV charging time (TCV) generally possesses the increasing tendency with the growing aging cycles. It indicates that the battery aging state can be directly investigated from the CV charging time. In order to quantify the correlation between the battery capacity and TCV, the normalized ca- pacity (Cn) of battery #1 (battery #1 is considered as the reference battery in this paper) is plotted versus the corresponding TCV in Fig. 5. The normalized capacity, as deﬁned in (1), is adopted in this paper due to the inconsistency among diﬀerent batteries. =C C C n actual initial (1) where Cactual is the battery capacity obtained after each characterization test, and Cinitial is the battery capacity derived after the ﬁrst char- acterization test. It can be seen from Fig. 5 that Cn shows a monotonically decreasing relationship with TCV. The solid line in Fig. 5 denotes the ﬁtted linear correlation between Cn and TCV. Fig. 5 demonstrates that with the complete CV charging process, the battery capacity can be obtained by substituting TCV into the correlation established beforehand. However, it has to be noted that some batteries in the practical application cannot reach the cut-oﬀ current value due to the uncompleted charging pro- cess. In addition, the noise disturbance on the current measurement may also cause the battery to ﬁnish the CV period earlier. Compared with the complete CV charging process, the shorter TCV would be ob- tained from either of the above two scenarios, which in turn causes a signiﬁcant SoH estimation error. For example, TCV extracted after 2000 cycles of battery #1 is 1158 s, and the corresponding Cn should be 0.8782 (i.e., point A in Fig. 5). Nevertheless, if the CV charging process is terminated when TCV equals 1000 s, the estimated Cn is 0.9195 when substituting TCV into the correlation curve, as illustrated in Fig. 5. Thus, TCV is highly sensitive to the external interference, and a more robust method is needed. The CV charging current of battery #1 after diﬀerent aging cycles are plotted in Fig. 6. It can be observed from Fig. 6 that with the growing aging cycles, the charging current reduces to the cut-oﬀ value at a slower variation rate, which in turn leads to a longer duration of the CV period. Since the current variation rate is closely associated with the relevant time constant, the current time constant (τI) for the CV char- ging period can thereby be adopted to investigate the battery aging state. Unlike TCV, which should be obtained when the whole CV char- ging process is completed, τI can be extracted from the partial CV charging data, which will be discussed in great detail in Section 4.2. Hence, τI is a more robust characteristic parameter related to the bat- tery aging, in comparison to the CV charging time. 3. Current time constant identiﬁcation 3.1. Battery model and parameter identiﬁcation A proper battery model plays an important role in a high-perfor- mance BMS. Theoretically, the dynamic characteristic of a battery can be accurately described by the ECM with inﬁnite resistor-capacitor (RC) networks [47]. However, this is an impractical battery model because of the heavy computational eﬀort. Hence, considering the tradeoﬀ be- tween the model ﬁdelity and computational complexity, the ﬁrst order ECM is adopted in this paper. The architecture of the ﬁrst order ECM is shown in Fig. 7. It com- prises a voltage source which represents the OCV, an Ohmic resistance (Ro) and an RC network (Rp//Cp). It should be noted that the above model parameters are generally represented as functions of SoC and temperature (T). Besides, the polarization resistance (Rp) and OCV also depend on the C-rate of the load current (CI) [12] and hysteresis eﬀect H [48], respectively, i.e.: == = = V V SoC T H R R SoC T C C C SoC T R RSoC T (, , ), (, , ), (, ), (, ) OC OC p p I p p oo (2) where Cp represents the polarization capacitance. Cycles 150 450 900 1500 1800 2100CV charging time (s) 0 200 400 600 800 1000 1200 1400 Battery #1 Battery #2 Battery #3 Battery #4 Fig. 4. Comparison of CV charging time for all four batteries. A CV charging time (s) 600 700 800 900 1000 1100 1200 1300Normalized capacity 0.84 0.86 0.88 0.9 0.92 0.94 0.96 0.98 1 1.02 Measured capacity Fitted curve Fig. 5. Correlation between Cn and TCV of battery #1. Time (s) 0 200 400 600 800 1000 1200Current (A) 0 0.25 0.5 0.75 1 1.25 0150 cycles 0450 cycles 0900 cycles 1500 cycles 1800 cycles 2100 cycles Fig. 6. Comparison of CV charging current after diﬀerent aging cycles. J. Yang et al. Applied Energy 212 (2018) 1589–1600 1592 The electrical behavior of the ﬁrst order ECM can be expressed as +=C dV dt V R Ip pp p L (3) ++ =V RI V VOC o L p t (4) where Vt represents the battery terminal voltage, Vp represents the voltage across the RC network, VOC represents the OCV, and IL is the load current, a positive value represents the charging scenario and a negative value represents the discharging scenario. Based on (3) and (4), the transfer function of the ﬁrst order ECM in the Laplace domain can be expressed as = − = + ++ Hs Is Vs V s RC s RR R R C s () () () () 1L toc pp op o p p (5) By means of the z-transform, Eq. (5) yields = − = −− −− + −− Hz Iz Vz V z zT R C R z TR C R TR C () () () () exp( / ) [exp( / )] [1 exp( / )] L toc sp p o s pp p s pp (6) where Ts is the sampling period and is equal to 1 s in this paper. This function can be rewritten as =+ − + −−− −II θ V V θ V V θ() ( )Lk Lk t k oc k t k oc k,, 1 1 , , 2 , 1 , 1 3 (7) where =− − − − = =− − θT R C R R T R C θR θR T R C exp( / ) ( / )[1 exp( / )] 1/ (1/ )exp( / ) sp p p o sp p o os p p 1 2 3 (8) The regression form of (7) can be expressed as =Iφ θLk k, (9) where = −− = −− −φ IV V V V θ θθ θ [] [] k Lk t k oc k t k oc k T ,1 , , ,1 ,1 12 3 (10) Among the parameters in (10), IL and Vt can be measured directly, and VOC can be obtained through a lookup table, which is normally identiﬁed by the HPPC test in advance. Besides, the impedance para- meters (Ro, Rp and Cp) can be obtained by solving (9) with the discrete- time least squares (DT LS) method, which is widely implemented in the real applications. The algorithmic procedure of the DT LS method is not detailed in this paper, but can be referred to Ref. [49]. 3.2. Expression of current time constant In order to analyze the kinetic characteristic of the CV charging current, the detailed expression of the load current is needed. Since Vp cannot be measured directly, the removal of Vp term from (3) and (4) is desired in order to obtain the current expression. Hence, substituting (4) into (3), the diﬀerential equation can be rewritten as =∂ + − −R IC R X V V R I()pL p p t t OC oL (11) where vectors ∂t and X are deﬁned as ∂ = ⎡ ⎣ ⎤ ⎦ = −− −X IR, [11 ]t dV dt dV dt dR dt dI dt T Lo tOC o L (12) Since the battery terminal voltage is controlled constant during the CV period, the value of dVt/dt can be considered as 0. Considering (2), the variation of Voc and Ro with respect to time can be further expressed as ⎧ ⎨ ⎩ =+ + =+ ∂ ∂ ∂∂ ∂ ∂ ∂ ∂ ∂ ∂ ·· · ·· dV dt V SoC dSoC dt V T dT dt V H dH dt dR dt R SoC dSoC dt R T dT dt OC OC OC OC oo o (13) In addition, Eq. (13) can be simpliﬁed considering the following assumptions: (1) dSoC/dt can be further express as IL/(3600Ccap) (where Ccap is the capacity of the battery in Ah). Assuming that the battery is charged by a 2C constant current (generally less than this value in most applications [42], especially during the CV period), the value of dSoC/dt is IL/(3600Ccap) = 2/3600 = 0.00056, which is very small. Hence, dSoC/dt ≈ 0 holds for normal charging conditions. (2) Depending on the thermal management in the BMS, the battery temperature should be controlled in a proper range and the relevant variation should be slow, thus dT/dt ≈ 0 can be obtained [50]. (3) Unlike the dynamic discharging process, the charging process is relatively simple and predictable. Hence, the model ﬁdelity can be guaranteed by using the charging SoC-OCV relationship, and thus the hysteresis eﬀect can be neglected, i.e., dH/dt ≈ 0. Based on the aforementioned analysis, dVoc/dt ≈ 0 and dRo/dt ≈ 0 hold for the charging condition, thus (11) can be rewritten as + + = −dI dt RR CR R I VV CR R L po pp o L tOC pp o (14) where Vt − VOC is considered as a constant item during one sampling period, and the impedance parameters (Cp, Rp and Ro) can be identiﬁed in advance through the algorithms mentioned above. Based on the general solution of the ﬁrst order linear diﬀerential equation, IL can be solved as ∫ ∫∫ ∫ =− +− ⎡ ⎣ − ⎤ ⎦ () () ( ) II bdt bdt V V bdt c dt exp exp ( )exp LL t tOC , 0 (15) where ILt, 0 is the initial load current, b =(Rp + Ro)/(CpRpRo), and c = CpRpRo.Deﬁning tk = t0 and tk+1=t0 + Ts, Eq. (15) can be simpli- ﬁed as =− + − − −+II bT V V d bTexp( ) [( )/ ][1 exp( )]Lk Lk s t k OC k s,1 , , , (16) where IL,k and IL,k+1 represent the load current at time tk and tk+1, respectively, and d = Rp + Ro. In the system expressed by (16), Vt-VOC can be regarded as the system input, and the load current IL is considered as the system re- sponse. If the system input is zero, the system response will decrease to 36.79% of its initial value when Ts =1/b. Similarly, for an increasing step input, if the initial current equals 0, the system response will reach 63.21% of its stable value when Ts =1/b. Hence, it can be concluded that the time constant for the CV charging current can be expressed as == + τ b CR R RR 1 I pp o po (17) 3.3. Parametric sensitivity to sampling frequency The sampling frequency is crucial for the performance of DT LS method. Without considering the limitation of on-board storage and OCV Ro Vt IL Rp Cp Vp Fig. 7. The ﬁrst order ECM. J. Yang et al. Applied Energy 212 (2018) 1589–1600 1593 computation capabilities, the rapid sampling is normally desired so that the information on the fast dynamics can be captured [51]. However, the high sampling frequency will result in the eigenvalue being close to the unit circle in the z-domain, which can aﬀect the stability for para- meter identiﬁcation [52]. Hence, the sensitivity of τI to fs is worth in- vestigating. Generally, the location of the eigenvalue in the z-domain can be expressed as =zλTexp( )s (18) where λ is the eigenvalue of the system, and |λ|= 1/τI. Based on (18), the sensitivity of τI with respect to eigenvalue loca- tion in the z-domain is expressed as [49]: = ∂ ∂ ==S z τ τ zλ T τf 1 || z τ I I s I s I (19) It can be inferred from (19) that the higher sampling frequency yields higher sensitivity of identiﬁed τI. In a practical BMS, the sampling frequency can be 100 Hz, and τI identiﬁed after 2300 cycles is 233.8 s. Based on (19), the sensitivity can be as high as 23,380, which indicates that τI estimation is extremely sensitive to the eigenvalue location. Hence, to guarantee a good numerical stability, the sampling frequency in real application is recommended to limit to lower than a certain level. 3.4. Battery model veriﬁcation To verify the accuracy of the identiﬁed model parameters and the derived current expression during the CV charging period, the com- parison results of battery #1 after 150, 1500 and 2200 cycles are shown in Fig. 8. Two evaluation criterions, including the Root Mean-Square Error (RMSE) and the R-square (R2), are employed to evaluate the waveform similarity, as listed in Table 2. The deﬁnitions of RMSE and R2 are described as ∑=− = RMSE n yy 1 () k n kest k1 exp, , 2 (20) =− ∑ − ∑ − = = R yy yy 1 () () k n kest k k n k 2 1 exp, , 2 1 exp, exp 2 (21) where yexp,k and yest,k denote the experimental and the estimated values, respectively, yexp is the mean value of the experimental data, and n is the data size. It can be inferred from (20) and (21) that a lower RMSE (closer to 0) and a larger R 2 (closer to 1) indicate a better ﬁtting performance. It can be concluded from Fig. 8 and Table 2 that the estimated current mat- ches well with the measured charging current, which conﬁrms that the extracted parameter set and the derived current expression can describe the transient behavior of the CV charging current with high ﬁdelity. 4. SoH estimation based on the correlation between Cn and τI 4.1. Correlation identiﬁed from the complete CV charging data Based on (16) and (17), τI can be identiﬁed from the CV charging data. Taking the data of battery #1 as the benchmark, Cn is plotted versus the corresponding τI in Fig. 9. It can be seen from Fig. 9 that Cn shows a monotonically decreasing relationship with τI. To quantita- tively measure the degree of the linear relationship between Cn and τI, the correlation coeﬃcient, or the Pearson product-moment correlation coeﬃcient, is adopted in this paper. It can be described by (22) [38,53]. = ∑ −− ∑ − ∑ − = == r xx y y xx y y ()( ) () ( ) xy k n k k k n k k n k 1 1 2 1 2 (22) where x and y correspond to Cn and τI, respectively, and x and y represent the mean value of Cn and τI, respectively. The range of rxy is [−1, 1], where close to +1 indicates a strong positive correlation, close to −1 indicates a strong negative correlation, and close to 0 indicates a weak or totally missing correlation. The correlation coeﬃcient between Cn and τI of battery #1 is −0.9880, thus the linear function, as shown in (23), is employed to ﬁt the obvious linear relationship between these two values. =+Ca τ bnI1 1 (23) where a1 and b1 are the ﬁtting function coeﬃcients which can be Time (s)Current (A) 0.1 0.3 0.5 0.7 0.9 1.1 1.3 Experiment Estimate (a) 150 cycles Time (s)Current (A) 0.1 0.3 0.5 0.7 0.9 1.1 1.3 Experiment Estimate (b) 1500 cycles Time (s) 0 100 200 300 400 500 600 700 0 200 400 600 800 1000 0 200 400 600 800 1000 1200Current (A) 0.1 0.3 0.5 0.7 0.9 1.1 1.3 Experiment Estimate (c) 2200 cycles Fig. 8. Comparison between measured and estimated CV charging current after diﬀerent cycles. Table 2 Evaluation criterions of estimation performance after diﬀerent cycles. Cycles RMSE R2 0150 0.02812 0.9855 1500 0.02812 0.9870 2200 0.02455 0.9905 J. Yang et al. Applied Energy 212 (2018) 1589–1600 1594 determined through curve-ﬁtting method. The ﬁtted correlation curve is plotted as a solid line in Fig. 9. The detailed ﬁtting function coeﬃcients and two ﬁtting quality criterions, including RMSE and R 2, are listed in Table 3. It can be observed from Table 3 that the value of RMSE is small and the value of R 2 is close to 1, which indicates a good ﬁtting performance. Cn and τI of all four batteries are plotted in Fig. 10. The solid line in the ﬁgure represents the correlation curve ﬁtted through the data of battery #1, and the dotted lines give the error bound of 2.5%. It can be ob- served that most of the points are within the error bonds except one outlier, which conﬁrms that the relationship between Cn and τI can be employed to indicate the battery SoH. In addition, it can be concluded that the linear relationship identiﬁed from the reference battery (bat- tery #1) can also be used to evaluate the capacity degradation of the other three batteries. Hence, for the batteries from the same manu- facturer, only the linear relationship of the reference battery should be established in advance, which can eﬀectively reduce the testing eﬀort. 4.2. Correlation identiﬁed from the partial CV charging data 4.2.1. Reference correlation curve selection In practical applications, some batteries cannot reach the cut-oﬀ current value due to the uncompleted charging process or the mea- surement noise of the current sensors. Thus, only part of the CV char- ging current curve can be obtained in this case. Based on the existing research work [54,55], the identiﬁed time constant of the battery terminal voltage is not a constant value, but a variable as a function of open-circuit time. Similarly, the value of τI should also be a variable with respect to the length of CV charging data. Based on the data of battery #1, Cn is plotted versus the corresponding τI identiﬁed from the partial (the former 300, 400 and 600 sampling data) and the whole CV charging data in Fig. 11. In addition, the relevant correlation curves and the corresponding ﬁtting results are shown in Fig. 11 and Table 4. It can be observed from Fig. 11 that even in the same aging state, τI identiﬁed from the data with diﬀerent lengths shows diverse values, which in turn leads to the various ﬁtted correlation curves. Hence, applying τI corresponds to one speciﬁc data length (ld) to the correlation curve with respect to other ld can cause a signiﬁcant SoH estimation error. For example, τI identiﬁed from the former 400 sampling data is 159.1 s, and the corresponding Cn should be 0.8912 (i.e., point B in Fig. 11). However, the estimated Cn is 0.9404 and 0.9701 when sub- stituting τI into the correlation curve ﬁtted from the former 600 sam- pling data and the whole data size, respectively, as illustrated in Fig. 11. The straightforward way to overcome this problem is to identify the correlation curve covering a wide range of ld with a particular data length interval (Δld) in advance, then store them in the on-board mi- crocontroller as a database. When τI of a speciﬁc ld is identiﬁed, it can be put into the “Cn-τI database” to ﬁnd a correlation curve with respect to a closest ld. The accuracy of the estimated Cn depends on the selected Δld. The smaller Δld yields more details and thus the higher Cn esti- mation accuracy, whereas it requires more storage resources and oﬄine identiﬁcation eﬀorts, especially for the battery with long CV charging period. Besides, it can be concluded from Table 4 that the correlation curve identiﬁed from the data with less ld shows a worse ﬁtting per- formance, which in turn leads to a larger SoH estimation error. An al- ternative method is to predict the speciﬁc τI (τI,ref) corresponding to a predetermined longer ld (ld,ref), based on the uncompleted CV charging data. Then, the battery SoH can be estimated by substituting the pre- dicted τI,ref into the reference correlation curve, which is identiﬁed from the data with size of ld,ref. Although the correlation curve identiﬁed from the whole data size exhibits the best ﬁtting performance, as illu- strated in Table 4, it is impractical to employ it as the reference cor- relation curve, because the complete CV charging time cannot be ob- tained in advance. On the other hand, it can be concluded from Fig. 4 that the shortest complete CV charging time is slightly more than 600 s. Hence, the correlation curve identiﬁed from the former 600 sampling data is selected as the reference correlation curve in this paper. 4.2.2. Current time constant prediction In order to predict τI,ref, the functional relationship between τI and ld Current time constant (s) 120 140 160 180 200 220 240 260Normalized capacity 0.84 0.86 0.88 0.9 0.92 0.94 0.96 0.98 1 1.02 Measured capacity Fitted curve Fig. 9. Correlation between Cn and τI of battery #1. Table 3 Curve ﬁtting results of battery #1. a1 b1 RMSE R2 −0.001063 1.143 0.0113 0.9761 Current time constant (s) 120 140 160 180 200 220 240 260Normalized capacity 0.84 0.86 0.88 0.9 0.92 0.94 0.96 0.98 1 1.02 Battery #1 Battery #2 Battery #3 Battery #4 +2.5% -2.5% Fig. 10. Correlation between Cn and τI of all four batteries. Current time constant (s) 90 110 130 150 170 190 210 230 250 0.86 0.88 0.9 0.92 0.94 0.96 0.98 1Normalized capacityld =300 ld =400 ld =600 whole B Fig. 11. Comparison of correlations between Cn and τI with respect to diﬀerent ld. Table 4 Curve ﬁtting results with respect to diﬀerent ld. Data size a1 b1 RMSE R2 Correlation coeﬃcient ld = 300 −0.002348 1.218 0.01496 0.8912 −0.9440 ld = 400 −0.00222 1.239 0.008814 0.9622 −0.9809 ld = 600 −0.00196 1.252 0.007512 0.9731 −0.9865 Whole −0.001163 1.155 0.00701 0.9761 −0.9880 J. Yang et al. Applied Energy 212 (2018) 1589–1600 1595 should be determined ﬁrstly. Scatter plots of τI versus ld after diﬀerent cycles (600, 1050 and 2300 cycles) are shown in Fig. 12 to illustrate the relationship between these two sets of data. It can be observed from Fig. 12 that τI increases with the increase of ld. Considering the tendency of the related data, the ﬁtting function as shown in (24) is adopted to quantitatively describe the relationship between τI and ld [32]. =+τa l bln( )Id22 (24) where a2 and b2 are the ﬁtting function coeﬃcients. The ﬁtting results, as shown in Fig. 12 (the dotted lines) and Table 5, demonstrate that the employed ﬁtting function can accurately describe the increasing ten- dency of τI. To evaluate the accuracy of the predicted τI,ref estimated from par- tial CV charging data, the identiﬁed ﬁtting curves based on the ﬁrst 300 and 400 sampling data after diﬀerent cycles are given in Fig. 13. The actual τI points covering the former 800 sampling data are also plotted in Fig. 13. It shows that the identiﬁed curves match well with the actual points. This can also be observed in Table 6, where the relative errors between the predicted and the actual τI,ref are all less than 10% in six cases. In addition, compared with the predicted τI,ref based on the former 300 sampling data, the values obtained based on the former 400 sampling data have a lower overall error. This is because more ﬁtted data points yield more information to predict the variation tendency of τI. Considering the accuracy of the predicted τI,ref, at least 300 s of the CV charging period is required for the tested batteries. 4.3. Developed SoH estimation scheme With the established reference quantitative relationship between Cn and τI, an online SoH (mainly on the battery capacity fading) estimation scheme is developed, as shown in Fig. 14. The measured battery voltage and current are recorded in the on-board storage component as soon as the charging process enters the CV charging mode. The recorded data sets are processed when the charging process is ﬁnished. If the recorded data size is no less than the selected ld,ref (e.g., 600 selected in this paper), τI,ref can be identiﬁed directly from the former sampling data with size of ld,ref. Otherwise, the values of τI covering the former data sets with diﬀerent lengths (e.g., 10, 20, … , ld) identiﬁed ﬁrstly. Sec- ondly, the quantitative correlation between τI and ld (expressed as (24)) can be obtained through curve ﬁtting method. Afterwards, τI,ref can be predicted by substituting ld,ref into the identiﬁed ﬁtting function. At last, the battery SoH can be derived using the correlation between Cn and τI,ref, and the present battery capacity can be updated. 5. Veriﬁcation and discussion An online SoH estimation method is proposed in this paper, which is based on the analysis of load current during CV charging period. The developed method can be applied to the uncompleted CV charging process. Data length 0 200 400 600 800 1000 1200Current time constant (s) 0 50 100 150 200 250 0600 cycles 1050 cycles 2300 cycles Fig. 12. Relationship between τI and ld after diﬀerent cycles. Table 5 Curve ﬁtting results after diﬀerent cycles. Cycles a2 b2 RMSE R2 0600 48.33 −163.4 6.1466 0.9722 1050 61.27 −216.7 6.1371 0.9820 2300 71.07 −272.8 5.6040 0.9890 Data length 0 100 200 300 400 500 600 700 800Current time constant (s) 0 40 80 120 160 200 fitted curve (ld=300) fitted curve (ld=400) I ld=300 ld=400 ld,ref = 600 (a) 600 cycles ld=400 Data length 0 100 200 300 400 500 600 700 800Current time constant (s) 0 40 80 120 160 200 fitted curve (ld=300) fitted curve (ld=400) I ld=300 ld,ref = 600 (b) 1050 cycles Data length 0 100 200 300 400 500 600 700 800Current time constant (s) 0 40 80 120 160 200 240 fitted curve (ld=300) fitted curve (ld=400) I ld=300 ld=400 ld,ref = 600 (c) 2300 cycles Fig. 13. Comparison between prediction curves and actual τI points after diﬀerent cycles. Table 6 τI,ref prediction results based on the diﬀerent ld. Cycles τI,ref_actual τI,ref_predict (ld = 300) Relative error (ld = 300) τI,ref_predict (ld = 400) Relative error (ld = 400) 0600 140.0 s 132.2 s −5.571% 135.3 s −3.357% 1050 167.7 s 159.6 s −4.830% 164.2 s −2.087% 2300 183.3 s 179.5 s −2.073% 183.4 s 0.05456% Note: τI,ref_actual is the actual τI,ref identiﬁed based on the former 600 sampling data, and τI,ref_predict is the predicted τI,ref derived based on the prediction model. J. Yang et al. Applied Energy 212 (2018) 1589–1600 1596 Based on the reference correlation curve established upon the data from battery #1 and the logarithmic function-based τI,ref prediction model, all four batteries’ SoH can be derived online from the CV charging data. Speciﬁcally, the deﬁnition of SoH is expressed as [33]: =× = × C C CSoH 100% 100% actual initial n (25) Firstly, to assess the performance of the reference correlation curve established upon the data of battery #1, the SoH estimation results obtained from the former 600 sampling data (ld,ref = 600) of all four batteries are listed in Table 7. It can be concluded from Table 7 that by using the reference correlation curve identiﬁed through the data of battery #1, the aging states of all four batteries can be estimated within 2.5% error bond except a few outliers. Hence, the battery SoH can be estimated by the reference correlation curve successfully. Furthermore, for the batteries from the same manufacturer, the correlation curve can be established by a reference battery in advance. Afterwards, the SoH of all the other batteries can be estimated when τI,ref is derived from the CV charging data. Secondly, to evaluate the performance of the proposed method when ld is less than ld,ref, the SoH estimations based on the τI,ref pre- diction model (method 1) and “Cn-τI database” (method 2) are both conducted to make a comparison. The stored Cn-τI correlations are identiﬁed from the CV charging data ranging from the former 300 s (ld = 300) to former 600 s (ld = 600) with a resolution of 50 s (Δld = 50). Speciﬁcally, the former 320 s (ld = 320) and former 420 s (ld = 420) are employed to test the robustness of two methods in terms of data size. The comparison of SoH estimation results obtained from the former 320 and 420 sampling data of all four batteries are sum- marized in Tables 8 and 9, respectively. The results show that (1) Compared with method 2, method 1 yields the lower overall SoH estimation error in both cases. It indicates the superiority of the τI,ref prediction model in terms of its robustness to the data size. With respect to method 2, better results will be obtained if the stored correlation curves are identiﬁed with shorter Δld. However, more storage resources and oﬄine identiﬁcation eﬀorts are required, especially for batteries with the long-time CV charging period (e.g. more than 30 min for batteries in [46,56,57]). (2) For both methods, the SoH estimated upon the longer ld generally has a better performance, compared with the estimation results based on the shorter ld. Based on the analysis in Section 4.2.2, the improved performance in method 1 is supposed to be caused by the more accurate τI,ref prediction results. For method 2, the improve- ment is supposed to be brought by the better ﬁtting performance of the correlation curve, as has been discussed in Section 4.2.1. (3) The SoH can be estimated by method 1 with less than 2.5% absolute error except a few outliers. Hence, based on the τI,ref prediction model, the battery SoH can be monitored by using the uncompleted CV charging data. 6. Future work In this paper, the simple ﬁrst order ECM is adopted to characterize the battery behavior during the CV charging period. Besides, only LiFePO4 batteries are tested and the charging condition is nearly con- stant through the aging test. Therefore, for the future work, some ex- tensions to the employed model (e.g., the higher order ECM) will be considered to enhance the model performance. In addition, more ex- periments and further study are required to investigate the generality of the proposed method, including its potential to be used for diﬀerent battery chemistries, charging protocols and operating temperatures. 7. Conclusion An online SoH estimation method is proposed in this paper, which is based on the analysis of load current during CV charging period. According to the preliminary analysis of the battery test data, the time constant of CV charging current, which is derived based on the ECM, is considered as a robust characteristic parameter related to the battery capacity fading. The quantitative correlation between Cn and τI is es- tablished to indicate the battery SoH. Speciﬁcally, for the uncompleted Measure and record battery voltage and current during the CV charging period End of charge ld < ld,ref Identify the relationship between I and ld Predict I,ref Identify I,ref corresponds to ld,ref Estimate the battery SoH according to the relationship between Cn and τI Update the present capacity Yes No Yes No Fig. 14. The proposed online SoH estimation scheme. Table 7 SoH estimation results with ld = 600 of all four batteries. Battery #1 Battery #2 SoHref SoHest SoHerr SoHref SoHest SoHerr 98.15% 97.76% −0.3981% 98.07% 96.71% −1.359% 95.87% 96.39% 0.5234% 95.99% 96.34% 0.3485% 94.74% 93.92% −0.8211% 94.91% 92.08% −2.828% 93.77% 92.33% −1.439% 93.01% 90.64% −2.369% 92.78% 93.07% 0.2842% 90.31% 89.77% −0.5444% 90.12% 89.68% −0.4426% 89.23% 87.81% −1.421% 89.12% 89.13% 0.01295% 88.57% 89.03% 0.4585% 87.82% 88.07% 0.2462% 87.02% 88.96% 1.940% Battery #3 Battery #4 SoHref SoHest SoHerr SoHref SoHest SoHerr 98.86% 99.20% 0.3417% 99.46% 99.35% −0.1130% 97.81% 97.95% 0.1451% 96.74% 96.58% −0.1603% 95.27% 96.59% 1.323% 95.80% 95.03% −0.7699% 92.53% 91.56% −0.9770% 94.74% 94.90% 0.1566% 90.51% 89.49% −1.017% 92.94% 90.92% −2.018% 89.91% 88.97% −0.9395% 90.51% 91.07% 0.5538% 89.33% 90.25% 0.9164% 88.19% 89.70% 1.516% 87.94% 86.12% −1.821% 87.72% 86.45% −1.270% Note: SoHref are obtained based on the capacity measurement, and SoHest and SoHerr are obtained based on the reference correlation curve. J. Yang et al. Applied Energy 212 (2018) 1589–1600 1597 CV charging process, the reference correlation curve with respect to the speciﬁc data length is employed to estimate the battery SoH. Besides, the logarithmic function-based prediction model is identiﬁed from the partial CV charging data to predict τI,ref. Four LiFePO4 batteries are employed under test to verify the feasibility of the proposed method. The results demonstrate that the correlation coeﬃcient between Cn and τI can reach −0.9880. Moreover, the correlation function extracted from one battery is able to evaluate the SoH of other three batteries with less than 2.5% absolute error except a few outliers, regardless of the adopted data size. Acknowledgments The authors would like to acknowledge the funding support from the China Scholarship Council (CSC) – China; the US DOE Graduate Automotive Technology Education (GATE) Center of Excellence; the National Science Foundation; and Nanjing Golden Dragon Bus Co., Ltd. Table 8 SoH estimation results with ld = 320 of all four batteries. Battery #1 Battery #2 SoHref SoHest_1 SoHerr_1 SoHest_2 SoHerr_2 SoHref SoHest_1 SoHerr_1 SoHest_2 SoHerr_2 98.15% 99.24% 1.082% 96.33% −1.824% 98.07% 98.24% 0.1745% 95.41% −2.655% 95.87% 98.28% 2.419% 95.07% −0.7923% 95.99% 96.91% 0.9141% 94.62% −1.376% 94.74% 95.56% 0.8257% 92.36% −2.375% 94.91% 95.94% 1.031% 92.69% −2.214% 93.77% 93.64% −0.1323% 91.49% −2.284% 93.01% 92.73% −0.2856% 89.47% −3.546% 92.78% 95.26% 2.478% 92.81% 0.02934% 90.31% 91.15% 0.8382% 88.96% −1.350% 90.12% 90.04% −0.07813% 87.93% −2.189% 89.23% 89.90% 0.6685% 86.43% −2.802% 89.12% 90.20% 1.085% 87.75% −1.370% 88.57% 90.32% 1.747% 88.35% −0.2163% 87.82% 88.93% 1.110% 86.73% −1.091% 87.02% 89.75% 2.729% 87.29% 0.2675% Battery #3 Battery #4 SoHref SoHest_1 SoHerr_1 SoHest_2 SoHerr_2 SoHref SoHest_1 SoHerr_1 SoHest_2 SoHerr_2 98.86% 100.5% 1.641% 97.33% −1.529% 99.46% 99.31% −0.1487% 97.13% −2.333% 97.81% 99.57% 1.767% 96.20% −1.603% 96.74% 98.05% 1.308% 95.15% −1.597% 95.27% 97.45% 2.188% 94.67% −0.5999% 95.80% 96.56% 0.7582% 93.74% −2.055% 92.53% 93.51% 0.9769% 91.23% −1.299% 94.74% 95.80% 1.063% 92.58% −2.158% 90.51% 91.52% 1.012% 88.57% −1.938% 92.94% 92.29% −0.6482% 90.08% −2.857% 89.91% 87.78% −2.127% 87.56% −2.346% 90.51% 90.38% −0.1354% 89.15% −1.363% 89.33% 90.34% 1.007% 88.05% −1.285% 88.19% 90.65% 2.462% 91.03% 2.846% 87.94% 85.81% −2.132% 84.20% −3.740% 87.72% 85.62% −2.099% 82.38% −5.340% Note: SoHest_1 and SoHerr_1 are obtained based on the τI,ref prediction model, and SoHest_2 and SoHerr_2 are obtained based on the Cn-τI correlation curve with respect to ld = 300. Table 9 SoH estimation results with ld = 420 of all four batteries. Battery #1 Battery #2 SoHref SoHest_1 SoHerr_1 SoHest_2 SoHerr_2 SoHref SoHest_1 SoHerr_1 SoHest_2 SoHerr_2 98.15% 98.56% 0.4072% 96.54% −1.616% 98.07% 97.97% −0.09717% 96.06% −2.009% 95.87% 97.05% 1.184% 95.10% −0.7621% 95.99% 96.25% 0.2590% 95.08% −0.9134% 94.74% 95.11% 0.3717% 93.20% −1.535% 94.91% 94.78% −0.1376% 92.92% −1.992% 93.77% 92.98% −0.7898% 91.82% −1.954% 93.01% 91.61% −1.405% 89.58% −3.432% 92.78% 94.27% 1.491% 92.81% 0.02712% 90.31% 90.40% 0.08593% 88.80% −1.513% 90.12% 89.93% −0.1905% 88.60% −1.519% 89.23% 89.45% 0.2200% 86.66% −2.572% 89.12% 89.51% 0.3883% 88.19% −0.9307% 88.57% 88.52% −0.0469% 86.78% −1.790% 87.82% 89.24% 1.422% 87.15% −0.6690% 87.02% 89.43% 2.407% 88.16% 1.145% Battery #3 Battery #4 SoHref SoHest_1 SoHerr_1 SoHest_2 SoHerr_2 SoHref SoHest_1 SoHerr_1 SoHest_2 SoHerr_2 98.86% 100.0% 1.141% 97.97% −0.8868% 99.46% 99.49% 0.02794% 98.20% −1.264% 97.81% 98.96% 1.158% 97.31% −0.4918% 96.74% 97.14% 0.4014% 95.35% −1.390% 95.27% 97.09% 1.820% 95.28% 0.01479% 95.80% 96.37% 0.5701% 94.21% −1.588% 92.53% 92.37% −0.1679% 90.56% −1.971% 94.74% 95.35% 0.6095% 93.63% −1.110% 90.51% 90.75% 0.2417% 88.57% −1.943% 92.94% 91.80% −1.143% 90.42% −2.522% 89.91% 88.99% −0.9155% 86.14% −3.775% 90.51% 90.34% −0.1729% 89.51% −1.002% 89.33% 89.25% −0.07653% 87.85% −1.477% 88.19% 90.91% 2.724% 90.37% 2.183% 87.94% 86.86% −1.081% 85.25% −2.693% 87.72% 85.27% −2.449% 83.93% −3.796% Note: SoHest_2 and SoHerr_2 are obtained based on the Cn-τI correlation curve with respect to ld = 400. J. Yang et al. Applied Energy 212 (2018) 1589–1600 1598 Appendix A. Abbreviations and nomenclature BMS battery management system CC constant-current CCCV constant-current constant-voltage CV constant-voltage DT LS discrete-time least squares DV diﬀerential voltage ECM equivalent circuit model EKF extended Kalman ﬁlter EoL end-of-life EV electric vehicle HPPC Hybrid pulse power characterization IC incremental capacity LiFePO4 lithium iron phosphate OCV and VOC open circuit voltage RMSE Root Mean-Square Error SEI solid electrolyte interphase SoC state-of-charge SoH state-of-health SoP state-of-power UDDS Urban Dynamometer Driving Schedule a1 and b1 ﬁtting function coeﬃcients of the linear relationship a2 and b2 ﬁtting function coeﬃcients of the logarithmic relationship Cactual Battery capacity obtained after each characterization test Ccap battery capacity Cinitial Battery capacity obtained after the ﬁrst characterization test CI C-rate of the load current Cp, Rp Polarization capacitance and resistance Cn normalized capacity H Hysteresis eﬀect ld data length Δld data length interval ld,ref reference data length IL load current rxy correlation coeﬃcient between x and y R 2 R-square Ro Ohmic resistance T temperature T1 rest period between each discharge and charge pulses in the HPPC test T2 rest period after current pulses in the HPPC test Ts and fs sampling period and frequency TCV CV charging time Vp voltage across the RC network Vt battery terminal voltage λ Eigenvalue of the system τI current time constant τI,ref reference current time constant τI,ref_actual actual τI,ref identiﬁed based on the former 600 sampling data τI,ref_predict predicted τI,ref derived based on the prediction model SoHest_1 and SoHerr_1 SoH estimation results based on the τI,ref prediction model SoHest_2 and SoHerr_2 SoH estimation results based on “Cn-τI database” SoHref SoH estimation results based on the capacity measurement SoHest and SoHerr SoH estimation results based on the reference correlation curve References [1] Mi C, Masrur MA, Gao DW. Hybrid electric vehicles: principles and applications with practical perspectives. John Wiley & Sons; 2011. [2] Lu L, Han X, Li J, Hua J, Ouyang M. A review on the key issues for lithium-ion battery management in electric vehicles. J Power Sour 2013;226:272–88. [3] Hosio S, Ferreira D, Goncalves J, van Berkel N, Luo C, Ahmed M, et al. Monetary assessment of battery life on smartphones. In: Proceedings of the 2016 CHI con- ference on human factors in computing systems; 2016. p. 1869–80. [4] Zhang C, Wang LY, Li X, Chen W, Yin GG, Jiang J. Robust and adaptive estimation of state of charge for lithium-ion batteries. IEEE Trans Indust Electron 2015;62:4948–57. [5] Lin C, Mu H, Xiong R, Shen W. A novel multi-model probability battery state of charge estimation approach for electric vehicles using H-inﬁnity algorithm. Appl Energy 2016;166:76–83. [2016/03/15/]. [6] Sun F, Xiong R, He H, Li W, Aussems JEE. Model-based dynamic multi-parameter method for peak power estimation of lithium–ion batteries. Appl Energy 2012;96:378–86. [2012/08/01/]. [7] Shen WX, C CC, Lo EWC, Chau KT. Adaptive neuro-fuzzy modeling of battery J. Yang et al. Applied Energy 212 (2018) 1589–1600 1599 residual capacity for electric vehicles. IEEE Trans Indust Electron 2002;49:677–84. [8] Ouyang M, Feng X, Han X, Lu L, Li Z, He X. A dynamic capacity degradation model and its applications considering varying load for a large format Li-ion battery. Appl Energy 2016;165:48–59. [2016/03/01/]. [9] Vetter J, Novák P, Wagner MR, Veit C, Möller KC, Besenhard JO, et al. Ageing mechanisms in lithium-ion batteries. J Power Sour 2005;147:269–81. [2005/09/ 09/]. [10] Berecibar M, Gandiaga I, Villarreal I, Omar N, Van Mierlo J, Van den Bossche P. Critical review of state of health estimation methods of Li-ion batteries for real applications. Renew Sustain Energy Rev 2016;56:572–87. [2016/04/01/]. [11] Jaguemont J, Boulon L, Dubé Y. A comprehensive review of lithium-ion batteries used in hybrid and electric vehicles at cold temperatures. Appl Energy 2016;164:99–114. [2016/02/15/]. [12] Waag W, Käbitz S, Sauer DU. Experimental investigation of the lithium-ion battery impedance characteristic at various conditions and aging states and its inﬂuence on the application. Appl Energy 2013;102:885–97. [2013/02/01/]. [13] Howey DA, Mitcheson PD, YuﬁtV, Oﬀer GJ, Brandon NP. Online measurement of battery impedance using motor controller excitation. IEEE Trans Veh Technol 2014;63:2557–66. [14] Plett GL. Extended Kalman ﬁltering for battery management systems of LiPB-based HEV battery packs. J Power Sour 2004;134:277–92. [2004/08/12/]. [15] Wei Z, Meng S, Xiong B, Ji D, Tseng KJ. Enhanced online model identiﬁcation and state of charge estimation for lithium-ion battery with a FBCRLS based observer. Appl Energy 2016;181:332–41. [2016/11/01/]. [16] He H, Xiong R, Guo H. Online estimation of model parameters and state-of-charge of LiFePO4 batteries in electric vehicles. Appl Energy 2012;89:413–20. [2012/01/ 01/]. [17] Wei Z, Lim TM, Skyllas-Kazacos M, Wai N, Tseng KJ. Online state of charge and model parameter co-estimation based on a novel multi-timescale estimator for va- nadium redox ﬂow battery. Appl Energy 2016;172:169–79. [2016/06/15/]. [18] Lin HT, Liang TJ, Chen SM. Estimation of battery state of health using probabilistic neural network. IEEE Trans Indust Inf 2013;9:679–85. [19] Bai G, Wang P, Hu C, Pecht M. A generic model-free approach for lithium-ion battery health management. Appl Energy 2014;135:247–60. [2014/12/15/]. [20] Klass V, Behm M, Lindbergh G. A support vector machine-based state-of-health estimation method for lithium-ion batteries under electric vehicle operation. J Power Sour 2014;270:262–72. [2014/12/15/]. [21] You G-W, Park S, Oh D. Real-time state-of-health estimation for electric vehicle batteries: a data-driven approach. Appl Energy 2016;176:92–103. [2016/08/15/]. [22] Widodo A, Shim M-C, Caesarendra W, Yang B-S. Intelligent prognostics for battery health monitoring based on sample entropy. Expert Syst Appl 2011;38:11763–9. [23] Hu X, Li SE, Jia Z, Egardt B. Enhanced sample entropy-based health management of Li-ion battery for electriﬁed vehicles. Energy 2014;64:953–60. 2014/01/01/. [24] Hu X, Jiang J, Cao D, Egardt B. Battery health prognosis for electric vehicles using sample entropy and sparse Bayesian predictive modeling. IEEE Trans Indust Electron 2016;63:2645–56. [25] Waag W, Fleischer C, Sauer DU. Critical review of the methods for monitoring of lithium-ion batteries in electric and hybrid vehicles. J Power Sour 2014;258:321–39. [2014/07/15/]. [26] Wei Z, Tseng KJ, Wai N, Lim TM, Skyllas-Kazacos M. Adaptive estimation of state of charge and capacity with online identiﬁed battery model for vanadium redox ﬂow battery. J Power Sour 2016;332:389–98. [2016/11/15/]. [27] Zou Y, Hu X, Ma H, Li SE. Combined state of charge and state of health estimation over lithium-ion battery cell cycle lifespan for electric vehicles. J Power Sour 2015;273:793–803. [2015/01/01/]. [28] Chen C, Xiong R, Shen W. A lithium-ion battery-in-the-loop approach to test and validate multi-scale dual H inﬁnity ﬁlters for state of charge and capacity estima- tion. IEEE Trans Power Electron 2017. [pp. 1-1]. [29] Plett GL. Recursive approximate weighted total least squares estimation of battery cell total capacity. J Power Sour 2011;196:2319–31. [2011/02/15/]. [30] Hu X, Li S, Peng H. A comparative study of equivalent circuit models for Li-ion batteries. J Power Sour 2012;198:359–67. [2012/01/15/]. [31] Yang J, Xia B, Shang Y, Huang W, Mi CC. Adaptive state-of-charge estimation based on a split battery model for electric vehicle applications. IEEE Trans Veh Technol 2017. [pp. 1-1]. [32] Xiong R, Tian J, Mu H, Wang C. A systematic model-based degradation behavior recognition and health monitoring method for lithium-ion batteries. Appl Energy 2017;207:372–83. [2017/12/01/]. [33] Chen Z, Mi CC, Fu Y, Xu J, Gong X. Online battery state of health estimation based on Genetic Algorithm for electric and hybrid vehicle applications. J Power Sour 2013;240:184–92. [2013/10/15/]. [34] Kessels JTBA, Rosca B, Bergveld HJ, v d Bosch PPJ. On-line battery identiﬁcation for electric driving range prediction. In: 2011 IEEE vehicle power and propulsion conference; 2011. p. 1–6. [35] Einhorn M, Conte FV, Kral C, Fleig J. A method for online capacity estimation of lithium ion battery cells using the state of charge and the transferred charge. IEEE Trans Indust Appl 2012;48:736–41. [36] Weng C, Feng X, Sun J, Peng H. State-of-health monitoring of lithium-ion battery modules and packs via incremental capacity peak tracking. Appl Energy 2016;180:360–8. [2016/10/15/]. [37] Li X, Jiang J, Wang LY, Chen D, Zhang Y, Zhang C. A capacity model based on charging process for state of health estimation of lithium ion batteries. Appl Energy 2016;177:537–43. [2016/09/01/]. [38] Berecibar M, Devriendt F, Dubarry M, Villarreal I, Omar N, Verbeke W, et al. Online state of health estimation on NMC cells based on predictive analytics. J Power Sour 2016;320:239–50. [2016/07/15/]. [39] Han X, Ouyang M, Lu L, Li J, Zheng Y, Li Z. A comparative study of commercial lithium ion battery cycle life in electrical vehicle: aging mechanism identiﬁcation. J Power Sour 2014;251:38–54. [2014/04/01/]. [40] Weng C, Cui Y, Sun J, Peng H. On-board state of health monitoring of lithium-ion batteries using incremental capacity analysis with support vector regression. J Power Sour 2013;235:36–44. [2013/08/01/]. [41] Wang L, Pan C, Liu L, Cheng Y, Zhao X. On-board state of health estimation of LiFePO4 battery pack through diﬀerential voltage analysis. Appl Energy 2016;168:465–72. [2016/04/15/]. [42] Gong X, Xiong R, Mi CC. A data-driven bias correction method based lithium-ion battery modeling approach for electric vehicles application. In: 2014 IEEE trans- portation electriﬁcation conference and expo (ITEC); 2014. p. 1–6. [43] Wang L, Cheng Y, Zhao X. A LiFePO4 battery pack capacity estimation approach considering in-parallel cell safety in electric vehicles. Appl Energy 2015;142:293–302. [2015/03/15/]. [44] Zheng Y, Lu L, Han X, Li J, Ouyang M. LiFePO4 battery pack capacity estimation for electric vehicles based on charging cell voltage curve transformation. J Power Sour 2013;226:33–41. [2013/03/15/]. [45] Petzl M, Danzer MA. Advancements in OCV measurement and analysis for lithium- ion batteries. IEEE Trans Energy Convers 2013;28:675–81. [46] Eddahech A, Briat O, Vinassa J-M. Determination of lithium-ion battery state-of- health based on constant-voltage charge phase. J Power Sour 2014;258:218–27. [2014/07/15/]. [47] Lee J, Nam O, Cho BH. Li-ion battery SOC estimation method based on the reduced order extended Kalman ﬁltering. J Power Sour 2007;174:9–15. [2007/11/22/]. [48] Pérez G, Garmendia M, Reynaud JF, Crego J, Viscarret U. Enhanced closed loop state of charge estimator for lithium-ion batteries based on extended Kalman ﬁlter. Appl Energy 2015;155:834–45. [2015/10/01/]. [49] Xia B, Zhao X, de Callafon R, Garnier H, Nguyen T, Mi C. Accurate Lithium-ion battery parameter estimation with continuous-time system identiﬁcation methods. Appl Energy 2016;179:426–36. [10/1/]. [50] Chiang Y-H, Sean W-Y, Ke J-C. Online estimation of internal resistance and open- circuit voltage of lithium-ion batteries in electric vehicles. J Power Sour 2011;196:3921–32. [2011/04/15/]. [51] Zheng Y, Ouyang M, Li X, Lu L, Li J, Zhou L, et al. Recording frequency optimization for massive battery data storage in battery management systems. Appl Energy 2016;183:380–9. [2016/12/01/]. [52] Garnier H, Mensler M, Richard A. Continuous-time model identiﬁcation from sampled data: implementation issues and performance evaluation. Int J Control 2003;76:1337–57. [53] Xia B, Shang Y, Nguyen T, Mi C. A correlation based fault detection method for short circuits in battery packs. J Power Sour 2017;337:1–10. [2017/01/01/]. [54] Pei L, Wang T, Lu R, Zhu C. Development of a voltage relaxation model for rapid open-circuit voltage prediction in lithium-ion batteries. J Power Sour 2014;253:412–8. [2014/05/01/]. [55] Yang J, Xia B, Shang Y, Huang W, Mi C. Improved battery parameter estimation method considering operating scenarios for HEV/EV applications. Energies 2017;10:5. [56] Williard N, He W, Osterman M, Pecht M. Comparative analysis of features for de- termining state of health in lithium-ion batteries. Int J Prognost Health Manage 2013;4. [57] Ramadass P, Haran B, Gomadam PM, White R, Popov BN. Development of ﬁrst principles capacity fade model for Li-ion cells. J Electrochem Soc 2004;151:A196–203. J. Yang et al. Applied Energy 212 (2018) 1589–1600 1600","libVersion":"0.3.1","langs":""}