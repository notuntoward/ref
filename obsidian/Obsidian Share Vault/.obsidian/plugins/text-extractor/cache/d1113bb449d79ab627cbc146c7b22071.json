{"path":"lit/lit_notes_OLD_PARTIAL/Tan20EstimatingRobustPQ.pdf","text":"IEEE TRANSACTIONS ON POWER SYSTEMS 1 Estimating the Robust P-Q Capability of a Technical Virtual Power Plant under Uncertainties Zhenfei Tan, Student Member, IEEE, Haiwang Zhong, Senior Member, IEEE, Qing Xia, Senior Member, IEEE, Chongqing Kang, Fellow, IEEE, Xuanyuan Wang, Senior Member, IEEE, and Honghai Tang Abstract—The technical virtual power plant (TVPP) is a promising paradigm to facilitate the integration of distributed energy resources (DERs) while incorporating operational con- straints of both DERs and networks. Due to the volatility and limited predictability of DER generation and electric loads, the output capability of the TVPP is uncertain. In this regard, this paper proposes the robust capability curve (RCC) of the TVPP, which explicitly characterizes the allowable range of the scheduled power output that is executable for the TVPP under uncertainties. Implementing the RCC can secure the schedul- ing of the TVPP against unexpected ﬂuctuations of operating conditions when the TVPP participates in the transmission-level dispatch. Mathematically, the RCC is the ﬁrst-stage feasible set of an adjustable robust optimization problem. An uncertainty set model incorporating the variable correlation and uncertainty budget is employed, which makes the robustness and conser- vatism of the RCC adjustable. A novel methodology is proposed to estimate the RCC by the convex hull of several points on its perimeter. These perimeter points are obtained by solving a series of multi scenario-optimal power ﬂow problems with worst-case uncertainty realizations identiﬁed based on a linearized network conﬁguration. Case studies based on the IEEE-13 test feeder validate the effectiveness of the RCC to ensure the scheduling feasibility while hedging against uncertainties. The computational efﬁciency of the proposed RCC estimation method is also veriﬁed based on larger-scale test systems. Index Terms—Virtual power plant, capability curve, adjustable robust optimization, aggregation model, uncertainty set. NOMENCLATURE Indices and Sets m, n Distribution system node indices. Lm Index set of nodes adjacent to node m. Φ Feasible region of transmission system operation. ΩRCC Region encircled by the robust capability curve. ΩDCC Region encircled by the deterministic capability curve. W Uncertainty set. Parameters and Constants P d m, Q d m Active and reactive power demand at node m. P gmin m Lower bound on active power output of DER at node m. This work was supported in part by National Natural Science Foundation of China (No. 51777102), in part by Beijing Natural Science Foundation (No. 3182017), and in part by Chinese Association of Science and Technology Young Elite Scientists Sponsorship Program (2017QNRC001). Z. Tan, H. Zhong, Q. Xia and C. Kang are with the State Key Laboratory of Power Systems, the Department of Electrical Engineering, Tsinghua Univer- sity, Beijing 100084, China. X. Wang is with Jibei Power Exchange Center, Beijing, China. H. Tang is with the Beijing Power Exchange Center, Beijing, China. Corresponding Author: H. Zhong (e-mail: zhonghw@tsinghua.edu.cn) P gmax m Upper bound on active power output of DER at node m. Q gmin m Lower bound on reactive power output of DER at node m. Q gmax m Upper bound on reactive power output of DER at node m. Sl mn, S0 Thermal limit of the feeder and the transformer. vm, ¯vm Lower and upper limits of nodal voltage. gmn, bmn Conductance and susceptance of the feeder between node m and n. ¯w Deterministic prediction of w. Nw Number of uncertain variables. Γ Uncertainty budget. Variables x, y, w Vector of coordination variables, state and con- trol variables, and uncertain variables. ζ Residual uncertainty after removing the ex- pected value and correlation. vm, θm The voltage magnitude and voltage phase angle of node m. um The square of voltage magnitude of node m. P f mn, Q f mn Active and reactive power ﬂow on the feeder between node m and n. P g m, Q g m Active and reactive power output of DER at node m. P0, Q0 Active and reactive power output of the TVPP. ∆x Vector of active and reactive power mismatch of the scheduled power output. Functions Πx,w(·) Projection of a set onto the subspace of x and w. Cov(·) covariance matrix of a random vector. conv(·) Convex hull of a set of vectors. I. INTRODUCTION T HE increasing penetration of the distributed energy re- sources (DERs) has brought both opportunities and chal- lenges to the power system operation and scheduling [1]. To leverage DERs’ potential to improve the system ﬂexibility and reliability while ensuring the operation security, the system- level coordination and management of DERs are of utmost importance [2]. The virtual power plant (VPP) is believed to be an efﬁcient paradigm to facilitate DER integration. By aggregating com- mercial and technical parameters of massive small-scale DERs into a unit portfolio, the VPP may act as a service-concentrated interface between the transmission and distribution system IEEE TRANSACTIONS ON POWER SYSTEMS 2 operators (TSO and DSO, respectively) [3]. The introduction of the VPP endows greater visibility and controllability of DERs and enables the system-wide optimal utilization of ﬂexibility provided by DERs [4]. Several real-world projects have been launched successfully, e.g., the fuel cell-based VPP in the Netherlands [5], and the FENIX project [6]. The concept of the VPP can be typically classiﬁed into two categories, namely the commercial VPP (CVPP) and the technical VPP (TVPP), concerning market participation and system management, respectively [4]. The CVPP aggregates a ﬂeet of DERs (not necessarily within the same distribution system) to participate in wholesale energy and service markets. In the literature, there are extensive studies on the economic behavior of the CVPP, including the least-cost operation [7], bidding strategies [8], and ancillary services participation [9], [10]. The TVPP represents an entitative distribution system containing DERs to contribute to the system management and operation by leveraging the use of DER capacity. Compared to the CVPP that aggregates only DERs, the TVPP incorporates operating characteristics of both DERs and the network. In this paper, we focus on facilitating the utilization of DER capacities at the transmission-level operation while incorpo- rating the security constraints of the local system; hence, the VPP discussed in this paper is limited to the TVPP that represents the primary distribution system. To fully exploit the ﬂexibility and capacity of DERs while securing the system operation, modeling the physical characteristics of the TVPP becomes a crucial issue. The output capability of the TVPP is limited by technical constraints of internal devices, i.e., distribution network and DERs. It is important for the DSO to know and report the allowable range of ﬂexibility that the TVPP can provide when interacting with the transmission- level dispatch. Otherwise, unreasonable scheduling of the TVPP maybe inexecutable for the local system and may lead to security problems, e.g., power imbalance, voltage violation, and feeder and transformer overloading [11], [12]. The active (P) and reactive (Q) power capability curve, also termed as the capability chart or D-curve, was orig- inally used to depict the static operating constraints of a synchronous generator [13], [14]. In [4], for the ﬁrst time, this concept was extended to model the technical operating characteristics of the TVPP on the P-Q plane. The TVPP capability curve can be generally deﬁned as the allowable range of P and Q outputs of the TVPP that can be met by the internal distribution system. This curve can be utilized in optimal power ﬂow (OPF)-based transmission-level system scheduling and dispatch as constraints just in the same way as capability curves of generators are implemented [15]. Dispatch commands satisfying the capability curve are guaranteed to be executable for the TVPP. However, the capability curve of the TVPP is determined by more complicated factors compared to that of the synchronous generator, including power balance, DER operating constraints, voltage limits, and feeder and transformer capacities. In [16], the capability curve of a distribution system is modeled to estimate the permissible reactive power range at different levels of active power exchanging. In [17], the capability curve of a grid- tied microgrid is studied and analyzed numerically concerning different impact factors, e.g., DER models, load condition and voltage regulation. Regarding the solving methodology, a random sampling method is proposed in [18], which runs a signiﬁcant number of power ﬂow calculations with randomly generated DER output scenarios, and then maps feasible power ﬂow results to points in the TVPP capability curve. Approxi- mation approaches, e.g., polyhedron, ellipse [19] and zonotope [20] approximations, have also been studied to depict the TVPP capability curve with different geometrical hypotheses. A more accurate and efﬁcient way is to calculate a set of perimeter points on the TVPP capability curve by solving OPF problems with varying objective functions, see [21], [22]. However, only deterministic models are addressed in the above literature, while uncertainty is neglected. Unlike con- ventional generators, the operation of the TVPP is exposed to many uncertain factors [23]. The volatility and limited predictability of intermittent DERs may lead to overestimating of TVPP output capability and subsequent security problems. Demand forecast errors also aggravate the uncertainty [24], especially when a large amount of behind-the-meter gener- ators are installed, which makes the forecasting of net load much more difﬁcult. Concerning uncertainties, several studies estimate VPP’s energy state, up/down power capabilities [25] and reserve capability [26], but network physics is ignored and the coupling of VPP active and reactive power outputs is not considered. Although it has been recognized as a vital issue in several references [4], [22], the literature is still silent on how to estimate the TVPP output capability under an uncertain circumstance. To ﬁll this gap, this paper proposes the concept of the robust capability curve (RCC), which explicitly characterizes the credible capability of the TVPP taking into account uncer- tainties. The scheduling and operation of the TVPP is a two- stage problem: ﬁrst, the TSO determines the optimal power output of TVPPs incorporating the corresponding capability constraints in the scheduling stage; and second, each DSO disaggregates the scheduled output to DERs in the operation stage. Uncertainties are unknown in the scheduling phase and will be revealed in the operation stage. To hedge against uncertainties, the RCC is mathematically modeled as the ﬁrst- stage feasible set of an adjustable robust optimization (ARO) problem, which closely ﬁts the two-stage system scheduling and operation procedure. Compared to the aforementioned deterministic models, the RCC can ensure the feasibility of the scheduling results incorporating unanticipated DER output variation and unexpected nodal load ﬂuctuation, and thus can facilitate the integration of DERs under uncertainties. However, estimating the RCC is a challenging task due to the nonlinearity of power ﬂow equations. In this paper, we propose a two-step method to address this issue. A pre- liminary approximation of the RCC based on a linearized network conﬁguration is calculated at ﬁrst to identify worst- case uncertainty realizations that protect the robustness and to reveal the geometrical structure of the RCC. This preliminary approximation is a polygon and can be calculated by vertex enumeration and the column-and-constraint generation (CCG) algorithm. Then the vertices of this preliminary approximation are recovered to perimeter points of the real RCC by solving IEEE TRANSACTIONS ON POWER SYSTEMS 3,ffmnmnPQ,mnmngb,mmv,nnv,ddPQ,ggPQ00,PQTVPPTransmission networkDERsPCC Fig. 1. Illustration of a TVPP based on a primary distribution network. The TVPP discussed in this paper is a network-aware representation of both DERs and the distribution system. a set of multi-scenario OPF (MS-OPF) problems satisfying all the identiﬁed worst scenarios. By leveraging the auxiliary of the preliminary approximation, the RCC can be estimated with satisfactory efﬁciency and accuracy. The contribution of this paper is twofold, i.e., 1) The robust capability curve of the TVPP is proposed and modeled, which characterizes the full range of allowable active and reactive power outputs of the TVPP that are robustly feasible. The signiﬁcance of the RCC is to secure the scheduling of TVPPs while hedging against uncertainties. 2) The RCC based on fully modeled AC power ﬂow is estimated by the convex hull of several points on its perimeter. These perimeter points are obtained by solving a series of MS-OPFs with worst-case scenarios identiﬁed based on the linearized network conﬁguration. Case studies show that this method achieves satisfactory efﬁciency and accuracy. II. PROBLEM FORMULATION A. Operation Scheme of TVPP In this paper, the TVPP is implemented based on a primary distribution network that interfaces with the transmission sys- tem at the point of common coupling (PCC), as illustrated in Fig. 1. This TVPP is typically operated by the local DSO [4]. Via the emerging active network management infrastructures and techniques [22], the DSO is aware of the local system information and can manage the controllable DERs that are directly connected to the primary feeder 1 to interact with the transmission system operation. Generally, the TVPP partici- pates in the transmission-level system operation and energy management following a two-stage scheme, i.e., 1) Scheduling stage: On a day-ahead or hour-ahead basis, the TSO schedules the power output of TVPPs and other conventional power plants by running the transmission-level OPF. Before the system scheduling, the TVPP has to estimate the capability curve and submit it to the TSO, which aggre- gates the available capacities of DERs. The capability curve is estimated based on local system parameters, forecasts of load and renewable generation. However, on the day-ahead or hour-ahead basis, the forecasting errors are inevitable, and the capability curve estimated without considering the uncertainty may lead to inexecutable scheduling command of the TVPP. To this end, this paper proposes to estimate the RCC, which 1Small-scale active DERs in secondary networks could possibly be in- tegrated by aggregators; while self-scheduled and uncontrollable DERs in secondary networks can be seen as behind-the-meter devices and are modeled as net loads with uncertainties. ensures that the scheduling result is executable for the TVPP for any realization of the uncertainty. 2) Operation stage: In near real time, the load and supply capacities of intermittent DERs can be forecasted with rela- tively high accuracy, i.e., the uncertainty is revealed [27]. With the revealed uncertainty parameters, the DSO dispatches the local system and disaggregates the scheduling command of the TVPP to DERs. The above scheme is consistent with the existing trans- mission system scheduling. The RCC enables the TVPP to participate in the transmission-level scheduling just in the same way as conventional power plants and protects the system operation feasibility under unanticipated variation. B. Deﬁnition of RCC To estimate the credible output capability of the TVPP under uncertainties, we deﬁne the RCC of the TVPP as the allowable range of active and reactive power outputs of the TVPP that does not violate internal security constraints while hedging against any perturbation in the uncertain variable. In accordance with the aforementioned two-stage TVPP operation scheme, the variables related to the TVPP operation can be classiﬁed into three categories, i.e., 1) Coordination variable: active and reactive power out- puts of the TVPP, denoted by x = (P0, Q0). x is optimized by TSO in the transmission-level scheduling stage and turns out to be a boundary condition for the TVPP operation. 2) Uncertain variable: the active power demand, reac- tive power demand, and active power supply capacities of intermittent DERs within the TVPP, denoted by w = (P d, Q d, P gmax). The load2 and intermittent DER generation can be predicted before the scheduling stage. Due to the limited predictability, however, the prediction may derivate from its real value and thus, w is treated as an uncertian variable. In this paper, we propose to secure the operation of the TVPP in the sense of robustness. Hence, w is considered to take its value in a bounded set W , i.e., the uncertainty set [27]. 3) State and control variable: voltage magnitudes, phase angles of nodes in the TVPP, and active and reactive power outputs of DERs within the TVPP, denoted by y = (v, θ, P g, Q g). For a determined x and a realization of w, y will be optimized by the DSO in the operation stage. Denote the feasible region of (x, y, w) subjected to distri- bution system security constraints as Φ. Then, the RCC can be mathematically formulated as ΩRCC = {x : ∀w ∈ W, ∃y, (x, y, w) ∈ Φ} . (1) In existing studies neglecting uncertainties, the prediction of w is assumed accurate. In this regard, the deterministic capability curve (DCC) is actually a particular case of the RCC with a singleton uncertainty set, i.e., ΩDCC(w∗) = {x : ∃y, (x, y, w∗) ∈ Φ} . (2) 2Reactive load can be predicted independently or based on active load forecasting multiplied by a ﬁxed power factor. Due to forecasting errors, the power factor may also ﬂuctuate. Hence, the uncertainties of active and reactive loads are modeled separately. IEEE TRANSACTIONS ON POWER SYSTEMS 4 For the given w∗, ΩDCC(w∗) is geometrically the projection of Φ(w∗) onto the subspace of x. Compared to the deterministic model, the RCC model proposed in this paper depicts the largest region of x that is executable for the TVPP under any realization of uncertainties. From the deﬁnition in (1), ΩRCC is actually the feasible set of a two-stage ARO problem and is also known as the robust feasible set [28]. III. MATHEMATICAL MODEL A. Uncertainty Set Model Polyhedral uncertainty sets are widely utilized in robust optimization research. Even though the uncertain vector w contains variables inﬂuenced by different factors, the corre- sponding uncertainty set can be generally modeled as the following compact form, W = {w : Gw ≤ g}, (3) where G and g are the coefﬁcient matrix and the right- hand-side vector, respectively. The uncertainty set is assumed bounded. Existing models of the polyhedral uncertainty set include the box uncertainty set, uncertainty budget model [29], correlation incorporated model [27], and polyhedron predictive region [30]. In this paper, the model proposed in [27] is employed as an instance of the polyhedral uncertainty set, which simultaneously models variable correlation and uncertainty budget. This model is introduced as follows. First, based on Cholesky decomposition, the correlated w is represented by an independent random vector ζ with the identity covariance matrix, i.e., w = ¯w + Lζ, (4) where ¯w is the deterministic prediction of uncertainty vari- ables. L is the Cholesky decomposition of the covariance matrix of w, satisfying Cov(w) = LL T. Coefﬁcients of the covariance matrix are autocorrelation and cross-correlation of different uncertain variables, which can be estimated from the historical forecasting performance. ζ is actually the residual uncertainty after removing the expected value and decoupling the correlation. Second, the uncertainty budget constraint is introduced to adjust the conservatism against the robustness. Then, the uncertainty set is formulated as follows, W = {w : w = ¯w + Lζ, −¯ζ ≤ ζ ≤ ¯ζ, ∑Nw k=1 |ζk|/¯ζk ≤ Γ}. (5) Here, [−¯ζ, ¯ζ] is the ﬂuctuation interval of ζ, which can be obtained by interval forecasting [27], [31]. Γ is the uncertainty budget. In this paper, Γ is limited to be an integer taking its value from 0 to Nw; then, it controls the number of uncertainty variables that can reach their bounds. The larger Γ is, the more the uncertain variables are allowed to vary simultaneously, and the resulting RCC becomes more conservative. A smaller Γ, in contrast, leads to a smaller uncertainty set and a more radical RCC. In particular, if Γ = 0, no perturbation is allowed, and the RCC model degenerates to the deterministic model. The probability bounds of constraints violation at different levels of Γ are analyzed and testiﬁed in [29], which provides a guideline for choosing a proper budget level. This uncertainty set model can avoid conservatism of the RCC caused by neglecting correlation. Additionally, by choosing different uncertainty budgets, the conservatism and robustness of the RCC can be controlled according to different application scenarios and risk preferences, which makes the RCC model more adaptive and ﬂexible. B. Operating Constraints of the TVPP The concept, model and the estimation method of the RCC are all derived in compact forms in this paper, hence the detailed network modeling method does not impact the essence of this paper. For ease of analysis, we assume the three-phase balance of the internal distribution system. The extension to unbalanced systems is attainable by employing the fully modeled three-phase power ﬂow equations and corresponding linearization technique (see [32] for example). This paper focuses on the robust feasible region of the TVPP power output, hence only security constraints are modeled below while the bidding strategy and objective function are not included. The derivation is for each single time interval, and the time index is not explicitly exhibited. The nodal power balance and AC power ﬂow equations are as follows, P g m − P d m = ∑ n∈Lm P f mn, P0 = ∑ n∈L0 P f n0, (6) Q g m − Q d m = ∑ n∈Lm Q f mn, Q0 = ∑ n∈L0 Q f n0, (7) P f mn = gmn(v2 m −vmvn cos θmn)−bmnvmvn sin θmn, (8) Q f mn = −bmn(v2 m −vmvn cos θmn)−gmnvmvn sin θmn. (9) The distribution network security constraints are as follows, (P f mn) 2 + (Q f mn) 2 ≤ (Sf mn) 2, (10) (P0)2 + (Q0)2 ≤ (S0)2, (11) vm ≤ vm ≤ ¯vm. (12) Equations (10) and (11) are feeder thermal limits and substa- tion transformer capacity constraints, respectively. Equation (12) represents lower and upper limits on nodal voltage magnitudes. As for DER operating constraints, they are enforced by decoupled P-Q operating limits [33] or by detailed capability curves [34], [35] in the literature. For simplicity, the decoupled P-Q operating limits of DERs are considered in this paper, i.e., P gmin m ≤ P g m ≤ P gmax m , Q gmin m ≤ Q g m ≤ Q gmax m . (13) For the deterministic DER (e.g., distributed generator), the ac- tive power limit P gmax m is a constant. For the intermittent DER, however, its power supply capacity may ﬂuctuate around the output forecast with environmental factors, e.g., temperature, solar irradiation, wind speed and direction. Hence, P gmax m of the intermittent DER is an uncertain variable. IEEE TRANSACTIONS ON POWER SYSTEMS 5 C. Network Model Linearization In the proposed RCC estimating method, the preliminary linear approximation of the RCC is ﬁrst calculated to iden- tify worst-case uncertainty realizations and critical perimeter points that shape the RCC. To do so, the linearized network model proposed in [36] is employed to obtain the preliminary approximation. To distinguish, variables associated with the linearized model are denoted with a hat on the top. Neglecting network losses and regarding the square of nodal voltage magnitudes (u = v2) as independent variables, the active and reactive power ﬂow equations are linearized as follows, ˆP f mn = gmn um − un 2 − bmn (θm − θn) , (14) ˆQ f mn = −bmn um − un 2 − gmn (θm − θn) . (15) For capacity constraints of feeders and the transformer, note that they are all quadratic and convex, which can be linearized piecewisely [36]. Here, we take the thermal limit of a feeder to exhibit the piecewise linear approximation formulation, cos 2kπ Ns · ˆP f mn + sin 2kπ Ns · ˆQ f mn ≤ Sf mn cos π Ns , k ∈ [1, Ns] , (16) where Ns is the number of secant lines that approximate the thermal limit circle of a feeder. With u as independent variable, the bounds on nodal voltage magnitudes are reformulated as v2 m ≤ um ≤ ¯v2 m. (17) As is discussed and testiﬁed in [36], this linearization technique can achieve satisfying accuracy and does not rely on the hypothesis of a small resistance/reactance ratio. Actually, as will be introduced in Section IV, the linearized model is only used to identify extreme scenarios that guarantee the robustness and reveal the geometrical structure of the RCC and thus, the accuracy of this linearization model is acceptable. D. Preliminary Linear Approximation of RCC In the linearized network model, the coordination variable and the state and control variable are denoted as ˆx and ˆy, respectively. Substituting nonlinear constraints (8)–(12) by lin- ear approximations (14)–(17), the TVPP operating constraints become all linear, and the feasible region regarding (ˆx, ˆy, w) is a polyhedron, denoted as ˆΦ. We rewrite ˆΦ in the following compact form, ˆΦ = {(ˆx, ˆy, w) : Aˆx + B ˆy + Cw ≤ d}, (18) where A, B and C are coefﬁcient matrices regarding the linearized TVPP operation constraints, and d is the right-hand side vector. With ˆΦ, the linear approximation of the RCC is formu- lated following the mathematical deﬁnition in (1), denoted as ˆΩRCC; and the DCC for a given realization of uncertainty ˆwl is also linearized, denoted as ˆΩDCC( ˆwl). A geometrical property of the linearized RCC is revealed by the following theorem, whose proof can be found in Appendix A.算法流程示意Algorithm 1. PVEAlgorithm 2. CCGSolving MS-OPF problemsin (26) ˆ,HW(1) Calculate the linearized RCC(2) Recover to the real RCCjˆˆ,jjWv Fig. 2. The process to estimate the RCC. Theorem 1: With a polyhedral uncertainty set as in (3), the linearly approximated RCC is the intersection of a set of linearized DCCs with regard to vertices of the uncertainty set W , i.e., ˆΩRCC = ⋂ ˆwl∈ ˆW ˆΩDCC( ˆwl), where ˆW is a subset of the vertex set of W . The number of vertices of W is ﬁnite and the linearized DCCs are all polyhedron. Also, note that ˆx is actually bounded by the substation capacity limits. Hence, ˆΩRCC is a bounded polyhedron on the P-Q plane, in other words, a polygon. As a polygon, ˆΩRCC can be calculated by identifying all its vertices. In the proposed calculation method, as will be introduced in the following section, each vertex of ˆΩRCC is calculated by solving a two-stage ARO problem based on the CCG algorithm. For each vertex of ˆΩRCC, a set of worst- case scenarios of uncertainty will be generated by the CCG algorithm. And the union set of all the worst scenarios regard- ing different vertices of ˆΩRCC is exactly ˆW , which contains the minimum number of worst-case scenarios that protect the robustness of the linearized RCC. This set of uncertainty realizations will be utilized to ensure the robustness when recovering the linearly approximated RCC to the AC power ﬂow-based real one. IV. METHODOLOGY Direct estimation of the RCC is difﬁcult since the AC power ﬂow-based security constraints are nonlinear and the allowable ranges of active and reactive power outputs are coupled. Therefore, we seek to leverage the linear approximation of the RCC for information on the geometrical structure of the RCC and worst-case realizations of uncertainty that protect the robustness. The process of the proposed RCC estimating method is summarized in Fig. 2. The ﬁrst step is to calculate the linearized RCC by iden- tifying all its vertices. The progressive vertices enumeration (PVE) algorithm proposed in the authors’ previous work [37] is utilized to search for vertices in an efﬁcient sequence, while each vertex is identiﬁed by solving a two-stage ARO problem based on a modiﬁed CCG algorithm. In this step, the value vector ηj and the worst-case scenarios when calculating the jth vertex of ˆΦRCC are recorded and passed to the second step. The second step of the calculation is to recover vertices of ˆΦRCC to some points on the perimeter of the real RCC. This is realized by solving a multi-scenario OPF problem based on the value vectors and worst scenario set obtained in the previous step. The PVE algorithm and the CCG algorithm for calculating the linearized RCC are introduced in Section IV-A and IV- B, respectively. Detailed information for perimeter points recovery is included in Section IV-C. Following this, several IEEE TRANSACTIONS ON POWER SYSTEMS 6 Algorithm 1 Progressive vertex enumeration 1: initialization: V = V0, H = H0, ˆW = ˆW0, i = 0 2: repeat 3: i = i + 1 4: convex hull of identiﬁed vertices: Pi = conv(V ) 5: initialize the set of IR: ∆i = ∅ 6: for fj on Pi do 7: set ηj as the outer normal vector of fj 8: vertex identiﬁcation by solving (19): ˆvj, ∆hj, ˆWj 9: if ∆hj > 0 then 10: V = V ∪ {ˆvj}, ∆i = ∆i ∪ {∆hj}, H = H ∪ {ηj}, ˆW = ˆW ∪ { ˆWj} 11: end if 12: end for 13: until max ∆i ≤ ε 14: return V , ˆW , H accelerating strategies are introduced in Section IV-D and a numerical example is given in Section IV-E. A. PVE Algorithm for Estimating the Linearized RCC The basic idea of the algorithm is to identify the vertices of the linearized RCC progressively by solving a series of optimization problems with different objective functions, i.e., hj = max ˆx { ηT j ˆx : ˆx ∈ ˆΩRCC} . (19) ηj is the value vector of the objective function, which deter- mines the direction to search for a new vertex. The strategy to choose the value of ηj will be introduced in the following part. The algorithm is summarized in the ﬂow chart as shown in Algorithm 1 and is introduced in detail as follows. 1) Initialization To initialize, (19) is solved with ηj equals (1, 1)T, (−1, 1)T, (−1, −1)T, and (1, −1)T. The set of these four initial value vectors is denoted as H0. Each optimal solution, denoted by ˆvj, is a vertex of ˆΩRCC, and the set of initial vertices is V0. The initial approximation polygon is calculated as the convex hull of these initial vertices and ˆv0 is calculated as the center of the initial polygon. When calculating each vertex by solving the ARO problem (19), a set of worst scenarios will be generated. The set of all the worst scenarios when calculating the initial vertices is denoted as ˆW0. 2) Polygon expansion At each iteration, the intermediate approximation of ˆΩRCC is calculated as the convex hull of the identiﬁed vertices. For each facet of the current polygon, a new vertex will be searched along its outer normal direction, i.e., solving (19) with ηj set as the outer normal vector of each facet fj of the polygon. This process can be interpreted as expanding the current polygon until each of its facets reaches a vertex of the linearized RCC. The newly obtained vertex and corresponding ηj and worst scenarios will be recorded. With the newly found vertices, the polygon will be updated. This vertex identiﬁcation and polygon updating process will be repeated until the error tolerance is met. 3) Termination criterion For a newly obtained vertex, the improvement ratio (IR) will be calculated to evaluate the contribution of this vertex to the updating of the polygon. The IR is deﬁned as the relative facet moving distance of the vertex identiﬁcation operation, ∆hj = h ∗ j − ¯hj ∥ηj∥ ∕ ¯hj − ηT j ˆv0 ∥ηj∥ = h ∗ j − ¯hj ¯hj − ηT j ˆv0 . (20) h ∗ j is the optimal value of (19). ¯hj is the right-hand side of the equation of the facet fj. The PVE algorithm will terminate when the maximum IR of a polygon expansion operation is smaller than the preset error tolerance ε. The PVE algorithm is guaranteed to output the accurate ˆΦRCC if ε = 0. If ε is set as a positive value, the algorithm will stop earlier and output a conservative approximation of the linearized RCC. Detailed proofs and discussions can be found in [37]. B. CCG Algorithm for Vertex Identiﬁcation To solve the vertex identiﬁcation problem in Algorithm 1, we rewrite (19) in the following two-stage decision form, min ˆx −ηT ˆx + M0 (max w∈W min (ˆy,s)∈Fˆx,w 1Ts ) , (21) where Fˆx,w = {(ˆy, s) : B ˆy − s ≤ d − Aˆx − Cw, s ≥ 0}. s is the slack variable and 1 is an all-ones vector of the appropriate dimension. We call the maxmin problem of the second term the robust feasibility test. M0 ≫ 1 is introduced to ensure that the optimal ˆx is robust feasible. The CCG algorithm [38] solves the problem (21) by split- ting the optimization of ˆx and the robust feasibility test into a master-subproblem framework, as shown in Algorithm 2. In the master problem, ˆx is optimized with feasibility cuts generated in the subproblem. The subproblem tests the robust feasibility of the master problem solution. If the master problem solution is robust feasible, the subproblem optimum will be zero and the CCG algorithm terminates; otherwise, the worst scenario will be found and the corresponding feasibility cut will be added to the master problem. Further, notice that the objective function of (21) is independent of the second-stage decision; one can therefore make the following simpliﬁcation to the classical CCG algorithm, S1) omitting the optimality cut generation; S2) terminating the algorithm when the optimum of the subproblem is zero rather than waiting for a small enough gap between lower and upper bounds of the master problem. For a given value vector ηj, the outputs of the CCG algorithm are the optimal value of ˆx and a set of associated worst scenarios. The ﬂow chart of the modiﬁed CCG algorithm is summarized in Algorithm 2, and mathematical formulations involved are as follows. 1) Master problem formulation The master problem in the kth iteration is as follows, min ˆx,ˆymp − ηT ˆx s.t. Aˆx + B ˆymp l ≤ d − Cw∗ l , ∀0 ≤ l ≤ k. (22) In the ﬁrst iteration with k = 0, w∗ 0 = 0. IEEE TRANSACTIONS ON POWER SYSTEMS 7 Algorithm 2 Modiﬁed CCG algorithm 1: set k = 0, w∗ 0 = 0, ˆWj = {w∗ 0} 2: repeat 3: solve the master problem in (22) and obtain the optimal solution ˆx∗ k 4: solve the subproblem in (24) with ˆx∗ k; obtain the worst scenario w∗ k+1 and the optimal value q(ˆx∗ k) 5: if q(ˆx∗ k) > 0 then 6: create ancillary decision variable ˆymp k+1 and add the feasibility cut as in (25) 7: ˆWj = ˆWj ∪ {w∗ k+1} 8: k = k + 1 9: end if 10: until q(ˆx∗ k) = 0 11: return ˆvj = ˆx∗ k, ˆWj 2) Subproblem formulation The subproblem is originally q(ˆx∗ k) = max w∈W min ˆy,s {1 Ts : (ˆy, s) ∈ Fˆx∗ k,w}. (23) For the general polyhedral uncertainty set (3), this bilevel op- timization problem can be converted to a mixed integer linear programming problem (MILP) based on KKT conditions, see [38]. For the uncertainty set speciﬁed in (5) in this paper, problem (23) is converted to the following MILP form, which can be solved by MILP solvers. The derivation for obtaining (23) is brieﬂy exhibited in Appendix B. min µ,τ,z µ T(d − Aˆx∗ k − C ¯w) − ¯ζ T(τ+ − τ−) s.t. BTµ = 0, −1 ≤ µ ≤ 0, − M (1 − z+) ≤ τ+ − (CL) Tµ ≤ M (1 − z+), − M z+ ≤ τ+ ≤ M z+, − M (1 − z−) ≤ τ− − (CL) Tµ ≤ M (1 − z−), − M z− ≤ τ− ≤ M z−, 1 T(z+ + z−) ≤ Γ, z+ + z− ≤ 1, z+, z− ∈ {0, 1} Nw . (24) µ is the dual variable of the inner minimization problem of (23). z+ and z− are binary variables introduced to control whether each uncertainty variable is perturbed or not in the worst uncertain scenario. M is a sufﬁciently large constant. Note that µ is bounded; one can derive a lower bound of M to avoid numerical problems caused by improperly setting the value of M . As derived in the Appendix, ∥CL∥1 is a lower bound of M . Let z∗ + and z∗ − denote the optimal integers of (24); then, the worst scenario is w∗ k+1 = ¯w + Ldiag(z∗ + − z∗ −)¯ζ; see the Appendix for the detailed derivation. 3) Feasibility cut formulation For the worst scenario w∗ k+1 obtained by the kth subprob- lem, the following feasibility cut will be added to the (k +1)th master problem, Aˆx + B ˆymp k+1 ≤ d − Cw∗ k+1, (25) where ˆymp k+1 is an ancillary decision variable introduced in this master problem. C. Recovery to the Real RCC The linearized RCC is not accurate due to the approximation of power ﬂow equations and the neglecting of losses. However, it may reveal the general shape and geometrical characteristics of the AC power ﬂow-based real RCC. Additionally, the worst scenarios identiﬁed based on the linearized model can be utilized to ensure the robustness when estimating the real RCC. In this subsection, the vertices of ˆΩRCC will be recovered to perimeter points of the real RCC along the same searching directions and with the same set of worst-case scenarios. Protected by scenarios in ˆW , the jth vertex of the linearized RCC can be recovered to perimeter point vj of the real TVPP by solving the following deterministic MS-OPF problem, max x { ηT j x : (x, yl, wl) ∈ Φ, ∀wl ∈ ˆW } . (26) This problem has the same objective function as the problem (19), meaning that the perimeter point of the real RCC is identiﬁed along the same direction as identifying the vertex of the linearized RCC. This MS-OPF shares a similar structure with the conventional OPF formulation except that security constraints are enforced for multiple scenarios. Existing OPF algorithms, e.g., convex relaxation method, primal-dual inte- rior point method [39], also work for solving this MS-OPF problem. Finally, the convex hull of the identiﬁed perimeter points is the estimation result of the RCC. D. Accelerating Strategies The computational complexity of RCC estimation is de- termined by the number of vertices of ˆΩRCC, the scale of the distribution system and the dimension of the uncertainties. Note that the RCC is a two-dimensional region on the P-Q plane, the number of perimeter points needed to depict the region is limited. The inﬂuence of system scale is neither critical since the TVPP discussed in this work is implemented in the primary distribution network, where numbers of nodes and DERs are usually limited. The dimension of uncertainties may impact the computation costs of solving the problem (21), which is actually a common difﬁculty in fully adjustable robust optimization. The following practical strategies may be useful to further accelerate the RCC calculation: 1) Parallel computation: In the polygon expansion process of the PVE algorithm, new vertices of the linearized RCC are identiﬁed by solving a series of ARO problems. Note that these AROs are independent, and thus, the inner loop of Algorithm 1 can be computed in parallel. Similarly, the RCC perimeter point recovery problems (26) can also be solved in parallel, which may accelerate the calculation procedure. 2) Diversify the value vector of the CCG subproblem: The coefﬁcients of the objective function of (23) are identical for different slack variables, which may lead to multiple solutions of the subproblem and thereby makes it time-consuming for the MILP solver to prove the optimality. Adding some slight perturbation to the value vector of the objective function when modeling the subproblem can avoid multiplicity and accelerate IEEE TRANSACTIONS ON POWER SYSTEMS 8 Initial vertex New vertex New vertices ˆIntermediate result of RCCEstimated RCCGround truth of RCC (a) (b) (c) (d) T(1, 1)  T( 1, 1)  T( 1, 1)    T(1, 1)  T(1, 6.67)  T( 1, 4.44)    T(1, 2.66)  T( 1, 1)   ˆFinal result of RCC Fig. 3. Demonstration of the process of estimating the RCC. Subﬁgure (a), (b) and (c) show the process of the PVE algorithm: (a) i = 0, (b) i = 1 and (c) i = 2. Subﬁgure (d) demonstrates the process of recovering vertices of the linearized RCC to perimeter points of the real RCC. the solution of each MILP problem. For instance, one can replace the value vector of (23) with an arithmetic sequence between 1 and 1.01. 3) Dimension reduction of uncertainties: Under the pres- ence of a large number of intermittent generators and uncertain loads, the high dimension of ζ may aggravate the solving of the ARO problem in (21) since the number of possible combinations of ﬂuctuation will increase. One may reduce the dimension of ζ by principal component analysis, i.e., reconstructing the covariance matrix Cov(w) with its several largest eigenvalues and corresponding eigenvectors. Detailed discussion may be found in [27]. 4) MS-OPF initialization: The optimal values of ˆx and ˆymp l of problem (22) solved in the last iteration of the CCG algorithm can be utilized as initial values of the problem (26). This may lead to higher quality solutions and accelerate the solving of OPF problems. E. Numerical Example A numerical example is exhibited in Fig. 3 to demonstrate the proposed RCC estimation method. The example is based on a TVPP implemented in a 2-node distribution network, where a node with a load and a DER is connected to the root node through a feeder. Active and reactive loads are 2 MW and 1 MVar, respectively. Maximum active and reactive power outputs of the DER are 6 MW and 4 MVar, respectively. Resistance and reactance of the feeder are all 0.2 Ω, and the capacity of the feeder is 4.5 MW. The standard deviations of the three uncertain variables are all assumed 0.08 of the corresponding expected values and the uncertainty budget is set as Γ = 3. Subﬁgure (a)–(c) shows the process of calculating the linearized ˆΩRCC by the PVE algorithm. In (a), the PVE algorithm starts up by searching the initial vertices. In (b), the intermediate approximation of the linearized RCC is constructed as the convex hull of the four initial vertices, and a new vertex is obtained by expanding the polygon. In (c), the intermediate approximation is updated with the newly obtained vertex, and another two vertices are identiﬁed by the polygon expansion operation. The PVE algorithm terminates after the 7 vertices are obtained, and the polygon with these vertices is the ˆΩRCC. Thereafter, the vertices of ˆΩRCC are recovered to perimeter points of the real RCC, and the ﬁnal estimation of the RCC is the convex hull of these perimeter points, as shown in (d). Correspondingly, the estimation result can be represented by the following seven linear inequalities, i.e.,           −0.083 −0.208 −0.035 −0.223 0.038 −0.223 0.105 −0.200 0.377 −0.004 0.003 0.376 −0.533 0.009           [P0 Q0 ] ≤           1 1 1 1 1 1 1           (27) The ground truth of the RCC is also exhibited by evenly sampling 120 points on its perimeter, as the dotted curve shows in (d). As can be seen, the RCC estimated based on the linearized network model may overestimate the output capability while underestimating the input capability of the TVPP, which is an inevitable consequence of neglecting losses. Nevertheless, the overall shape of the linearized RCC is quite similar to the real one, which provides auxiliary to identify worst scenarios that secure the robustness and to identify turning points on the RCC perimeter that determine its overall shape. Based on this, the proposed method obtains a fairly accurate while relatively concise estimation of the RCC, i.e., only 7 perimeter points are identiﬁed and 7 inequalities are needed to represent the RCC. V. CASE STUDIES The effectiveness of the RCC and the computational efﬁ- ciency of the proposed calculation method are veriﬁed based on three IEEE test feeders. Optimizations are solved in the MATLAB 2017a environment with GUROBI V8.1.1 on a computer with an Intel(R) Core(TM) i7-7900X CPU. The CPU has 10 physical cores, and 4 of them are activated to run the parallel computation. A. Illustration of the RCC A TVPP with 6 DERs, as illustrated in Fig. 4, is simulated based on the IEEE-13 test feeder [40] to illustrate and analyze the RCC. Four intermittent generators are placed at nodes 611, 634, 652 and 675, and the predicted output of each generator is 2.4 MW. Two conventional generators are placed at nodes 645 and 680, of which P gmax = 3.6 MW, P gmin = 1 MW and Q gmax = −Q gmin = 1.2 MVar. The total predicted active and reactive power demands of the system are scaled to 7.8 MW and 4.08 MVar, respectively. Prediction errors of intermittent generation and the ﬁrst ﬁve largest nodal loads are considered; IEEE TRANSACTIONS ON POWER SYSTEMS 9650632633671645680692684634646675652611CGCGIGIGIGIGIGIntermittent Gen.Conventional Gen.CG Fig. 4. The TVPP based on the modiﬁed IEEE 13 test feeder. Fig. 5. DCC and RCCs of the TVPP based on the IEEE-13 test feeder. thus, Nw = 4 + 5 × 2 = 14. To simulate the covariance matrix of w, the standard deviations of active and reactive nodal loads and intermittent generators are set as 0.08, 0.12 and 0.15 of the corresponding expected values. The prediction error correlation of the active and reactive power demand at the same node is assumed to be 0.6, while that of different intermittent generators is 0.8. The ﬂuctuation interval of ζ is assumed to be the 0.85 conﬁdence interval of the standard normal distribution, i.e., [−1.44, 1.44]. The estimated RCCs of this TVPP with four different un- certainty budgets are displayed in Fig. 5. When the uncertainty budget Γ = 0, the RCC degenerates to the deterministic model, which is the largest region in Fig. 5. As Γ increases, the RCC shrinks. This result occurs because a larger Γ allows more uncertainty variables to ﬂuctuate away from their prediction and subsequently makes the RCC more conservative. It can also be observed that the RCC with a larger uncertainty budget is a subset of the RCC constrained by a smaller uncertainty budget; this is natural since an uncertainty set with a larger uncertainty budget contains that with a smaller budget. B. Effectiveness of the RCC to Hedge Against Uncertainties The uncertainty hedging ability of the DCC and RCCs with different uncertainty budgets are estimated and com- pared based on the Monte Carlo method. The same TVPP 0 2 4 6 8 1 0 1 2 1 4 1 0 - 4 1 0 - 3 1 0 - 2 1 0 - 1 1 0 0 U n c e r t a i n t y b u d g e t ( b )EPM (MVA) S c n . 1 S c n . 2 S c n . 3 S c n . 4 0 2 4 6 8 1 0 1 2 1 4 1 0 - 4 1 0 - 3 1 0 - 2 1 0 - 1 1 0 0 U n c e r t a i n t y b u d g e tEPM (MVA) S c n . 1 S c n . 2 S c n . 3 S c n . 4 ( a ) Fig. 6. Expected power mismatch of different scheduling scenarios with RCCs with different uncertainty budgets. (a) ζ is sampled in the conﬁdence interval; (b) ζ is sampled in the full state space. setup as introduced in Section V-A is employed. Four typical transmission-level scheduling scenarios (denoted by Scn.1– 4) are considered, where the TSO may want the TVPP to operate in different quadrants on the P-Q plane and exchange the maximum amount of apparent power satisfying the DCC or RCC constraint. The RCCs are enforced with Γ taking values from 0 to 14 every two numbers. Thus, 4 × 8 = 32 scheduling results are simulated in total. These scheduling results, however, may not be executable for the TVPP. In the operation stage, for a scheduled output xScn.k Γ and a realization of w, the TVPP determines the minimum apparent power mismatch at the root node by solving the following problem, δScn.k Γ (w) = min ∆x,y {∥∆x∥2 : (xScn.k Γ −∆x, y, w) ∈ Φ} . (28) The power mismatch will be zero if the scheduled output is feasible under the realization of uncertainty. To measure the uncertainty hedging ability of the DCC and RCC, the expected power mismatch (EPM) is deﬁned as EPM = Ew[δScn.k Γ (w)]. In the case study, 6000 samples of w are generated according to (4) by randomly sampling ζ with a normal distribution hypothesis. Then, EPM is estimated based on the samples of w for each scheduling result. The results are shown in Fig. 6. In subﬁgure (a), ζ is sampled in the conﬁdence interval to estimate the EPM. As seen, if the TVPP is scheduled with only DCC constraints, the EPM reaches up to 0.4 MVA. After enforcing the RCC in the transmission-level scheduling, the EPM of the TVPP decreases dramatically (noting that the y- axis is log-scaled). The maximum EPM is only 0.0017 MVA when Γ = 2, and becomes even less as Γ increases. This is consistent with the deﬁnition of the RCC, which posits that the scheduling result satisfying the RCC is executable under perturbation within the uncertainty set. Since the real RCC based on the AC power ﬂow network model is nonconvex and irregular, the estimation of RCC is not accurate and EPM does IEEE TRANSACTIONS ON POWER SYSTEMS 10 TABLE I COMPUTATION PERFORMANCE OF THE RCC ESTIMATION METHOD. Test system Vertex number Calculation time (s) Linearized RCC MS-OPF Total IEEE-33 6 DERs 8 5.91 0.19 6.10 12 DERs 10 9.76 0.20 9.96 24 DERs 12 14.43 0.68 15.10 IEEE-123 6 DERs 9 11.50 1.61 13.11 12 DERs 9 18.62 1.04 19.66 24 DERs 10 23.18 1.65 24.83 not decrease to zero rigorously. However, the error caused by inaccuracy of estimation is quite inappreciable and the EPM is less than 0.0004 MVA when Γ is larger than 2, which is no more than one percent compared with scenarios with only the DCC. In real-world applications, there is no guarantee that ζ always stays in the predicted conﬁdence interval. The EPM of different scheduling results is also estimated by sampling ζ in the full state space without any limitation, as subﬁgure (b) shows. Compared to the results in (a), the EPM with arbitrarily varying uncertainties increases. However, the RCC model still outperforms the DCC signiﬁcantly by reducing the power mis- match caused by uncertainty-related infeasibility. Additionally, the hedging ability of RCC rises as the uncertainty budget increases. The price of a larger uncertainty budget is resulting in a more conservative RCC, as has been analyzed in Section V-A. However, notice that EPM becomes less than 0.002 MVA when Γ is larger than 4, which indicates that a relatively small Γ is enough to secure the TVPP against uncertainty without excessively cutting down the ﬂexibility of the TVPP. C. Efﬁciency of the RCC Estimation Method The computational efﬁciency of the proposed RCC calcula- tion method is tested based on larger-scale systems with dif- ferent numbers of DERs. In all test systems, 2/3 of DERs are assumed intermittent generators with uncertain power output, while the others are controllable conventional generators. In the case study, error tolerance when estimating the linearized RCC is ε = 0.02. The results are summarized in TABLE I. From the table, it can be seen that at most 12 vertices (and accordingly, linear inequalities) are enough to depict the RCC. That is, only a small number of inequalities have to be reported to the TSO to ensure the robust feasibility of scheduling results, which will not stress the communication burden and the market clearing algorithm. The computational time of the 123-node feeder with 24 DERs is no more than half a minute, which is quite acceptable in applications. VI. CONCLUSION To estimate the output capability of the TVPP incorpo- rating uncertainties, this paper proposes the concept of the robust capability curve (RCC). The RCC explicitly depicts the allowable range of P and Q outputs of the TVPP that is executable while hedging against unanticipated ﬂuctuations. Scheduling the TVPP with RCC constraints guarantees that the scheduled output is feasible without violating the TVPP operating constraints under any realization of uncertainties within the predeﬁned uncertainty set, which may facilitate the utilization of DER capacities at the transmission-level operation while securing the local system. Mathematically, the RCC is modeled as the ﬁrst-stage feasible set of an ARO problem. The uncertainty set model employed in this paper incorporates both variable correlation and uncertainty budget, which makes the robustness and conservatism of the RCC adjustable. A two-step method is proposed to estimate the RCC by the convex hull of several points on its perimeter. Case studies based on several IEEE standard test feeders verify the uncertainty hedging ability of the RCC and the computational efﬁciency of the proposed estimation method. Pricing the conservatism caused by uncertainty hedging will be our future work. Estimating the robust capability curve of a set of hierarchically aggregated TVPPs is also worthy of further study. APPENDIX A. Proof of Theorem 1 Project ˆΦ onto the subspace of (ˆx, w). Since ˆΦ is a polyhedron, the projected region is also a polyhedron and can be represented in the halfspace-form, i.e., Πˆx,w( ˆΦ) = {(ˆx, w) : ˆAˆx + ˆCw ≤ ˆd}. Then, ˆΩRCC can be rewritten as, ˆΩRCC = {ˆx : ˆAˆx ≤ ˆd − ˆCw, ∀w ∈ W } = {ˆx : ˆAl ˆx ≤ ˆdl − min w∈W ˆClw, ∀l} , (29) where subscript l indexes the lth row of the corresponding ma- trix/vector. With the polyhedron uncertainty set, the minimum on the right-hand side can be attained for each single row of the constraints at the vertex of W . Denote the optimal solution of w as ˆwl = arg minw∈W ˆClw and the set of optimal solutions as ˆW . Then, equation (29) is equivalent to the follows, ˆΩRCC = ⋂ ˆwl∈ ˆW {ˆx : ˆAˆx ≤ ˆd− ˆC ˆwl} = ⋂ ˆwl∈ ˆW ˆΩDCC( ˆwl). (30) It can be seen that the linearly approximated RCC is the intersection of a set of linearized DCCs with regard to vertices of the uncertainty set W . B. Derivation of the Equivalent MILP of the Subproblem Dualizing the inner minimization problem, the subproblem (24) can be reformulated as q(ˆx∗ k) = maxw,µ{µ T(d − Aˆx∗ k − Cw) : BTµ = 0, −1 ≤ µ ≤ 0, w ∈ W }. The objective function of this problem is bilinear while the constraints are linear. According to [41], the optimum of such disjoint bilinear problem is attained at a certain extreme point of W . By introducing binary variables, the set of extreme points of W deﬁned in (5) can be expressed as We = {w : w = ¯w + L(ˆz+ − ˆz−)¯v, z+ + z− ≤ 1, 1 T(z+ + z−) ≤ Γ, binary :z+, z−}, (31) IEEE TRANSACTIONS ON POWER SYSTEMS 11 where ˆz+ = diag(z+), ˆz− = diag(z−). Substituting w with elements in We, the objective function of the dualized problem can be converted to the form as in (24) with τ+ = ˆz+(CL) Tµ and τ− = ˆz−(CL) Tµ. Taking τ+ = ˆz+(CL)Tµ, for instance, it is bilinear in z+ and µ and can be slacked to the following linear form, −M (1 − z+) ≤ τ+ − (CL) Tµ ≤ M (1 − z+), (32) −M z+ ≤ τ+ ≤ M z+. (33) Then, the subproblem can be converted to the MILP as in (24). Note that M should always be larger than ∥(CL) Tµ∥∞ to ensure that (32) is slack when zi = 0 and to ensure (33) is slack when zi = 1. Note that for |µ| ≤ 1, we have ∥(CL)Tµ∥∞ = max j ∣ ∣ ∣ ∣ ∣ ∑ i µi(CL)ij ∣ ∣ ∣ ∣ ∣ ≤ max j ∑ i |µi||(CL)ij| ≤ max j ∑ i |(CL)ij| = ∥CL∥1. (34) Thus, a lower bound of M is ∥CL∥1. ACKNOWLEDGMENT The authors would like to thank the reviewers and the editor for their constructive and helpful comments for improving the quality of this paper. The authors would also like to thank the support from Science and Technology Project of State Grid Corporation of China (Research on the electricity market mechanism design and application to promote the accommodation of renewable energy). REFERENCES [1] P. D. F. Ferreira, P. M. S. Carvalho, L. A. F. M. Ferreira, and M. D. Ilic, “Distributed energy resources integration challenges in low-voltage networks: Voltage control limitations and risk of cascading,” IEEE Trans. Sustainable Energy, vol. 4, no. 1, pp. 82–88, Jan 2013. [2] S. Y. Hadush and L. Meeus, “DSO-TSO cooperation issues and solutions for distribution grid congestion management,” Energy Policy, vol. 120, pp. 610–621, 2018. [3] Q. Ai, S. Fan, and L. Piao, “Optimal scheduling strategy for virtual power plants based on credibility theory,” Protection and Control of Modern Power Systems, vol. 1, no. 1, p. 3, Jun 2016. [4] D. Pudjianto, C. Ramsay, and G. Strbac, “Virtual power plant and system integration of distributed energy resources,” IET Renewable Power Generation, vol. 1, no. 1, pp. 10–16, March 2007. [5] “CFCL BlueGen units for virtual power plant project in Netherlands,” Fuel Cells Bulletin, vol. 2012, no. 7, p. 3, 2012. [6] C. Kieny, B. Berseneff, N. Hadjsaid, Y. Besanger, and J. Maire, “On the concept and the interest of virtual power plant: Some results from the European project FENIX,” in 2009 IEEE PES General Meeting, July 2009, pp. 1–6. [7] H. Yang, D. Yi, J. Zhao, and Z. Dong, “Distributed optimal dispatch of virtual power plant via limited communication,” IEEE Trans. Power Systems, vol. 28, no. 3, pp. 3511–3512, Aug 2013. [8] E. G. Kardakos, C. K. Simoglou, and A. G. Bakirtzis, “Optimal offering strategy of a virtual power plant: A stochastic bi-level approach,” IEEE Trans. Smart Grid, vol. 7, no. 2, pp. 794–806, March 2016. [9] A. Baringo, L. Baringo, and J. M. Arroyo, “Day-ahead self-scheduling of a virtual power plant in energy and reserve electricity markets under uncertainty,” IEEE Trans. Power Systems, vol. 34, no. 3, pp. 1881–1894, May 2019. [10] J. Ali, S. Massucco, F. Silvestro, and A. Vinci, “Participation of customers to virtual power plants for reactive power provision,” in 2018 53rd International Universities Power Engineering Conference (UPEC), Sep. 2018, pp. 1–6. [11] R. A. Verzijlbergh, L. J. De Vries, and Z. Lukszo, “Renewable energy sources and responsive demand. Do we need congestion management in the distribution grid?” IEEE Trans. Power Systems, vol. 29, no. 5, pp. 2119–2128, Sep. 2014. [12] Z. Li, J. Wang, H. Sun, F. Qiu, and Q. Guo, “Robust estimation of reactive power for an active distribution system,” IEEE Trans. Power Systems, 2019 (in press). [13] B. Park, L. Tang, M. C. Ferris, and C. L. DeMarco, “Examination of three different ACOPF formulations with generator capability curves,” IEEE Trans. Power Systems, vol. 32, no. 4, pp. 2913–2923, July 2017. [14] X. Cheng, F. C. Huff, and P. Francino, “Optimal load dispatch based on generator reactive capability curve,” in 2006 IEEE PES General Meeting, June 2006, pp. 1–6. [15] J. Silva, J. Sumaili, R. J. Bessa, L. Seca, M. Matos, and V. Miranda, “The challenges of estimating the impact of distributed energy resources ﬂexibility on the TSO/DSO boundary node operating points,” Computers & Operations Research, vol. 96, pp. 294–304, 2018. [16] P. Cuffe, P. Smith, and A. Keane, “Capability chart for distributed reactive power resources,” IEEE Trans. Power Systems, vol. 29, no. 1, pp. 15–22, Jan 2014. [17] A. V. Jayawardena, L. G. Meegahapola, D. A. Robinson, and S. Perera, “Capability chart: A new tool for grid-tied microgrid operation,” in 2014 IEEE PES T&D Conference and Exposition, April 2014, pp. 1–5. [18] M. Heleno, R. Soares, J. Sumaili, R. J. Bessa, L. Seca, and M. A. Matos, “Estimation of the ﬂexibility range in the transmission-distribution boundary,” in 2015 IEEE Eindhoven PowerTech, June 2015, pp. 1–6. [19] E. Polymeneas and S. Meliopoulos, “Aggregate modeling of distribution systems for multi-period OPF,” in 2016 Power Systems Computation Conference (PSCC), June 2016, pp. 1–8. [20] F. L. M¨uller, J. Szab´o, O. Sundstr¨om, and J. Lygeros, “Aggregation and disaggregation of energetic ﬂexibility from distributed energy resources,” IEEE Trans. Smart Grid, pp. 1–1, 2018. [21] J. Silva, J. Sumaili, R. J. Bessa, L. Seca, M. A. Matos, and et al., “Estimating the active and reactive power ﬂexibility area at the TSO- DSO interface,” IEEE Trans. Power Systems, vol. 33, no. 5, pp. 4741– 4750, Sept 2018. [22] F. Capitanescu, “TSO–DSO interaction: Active distribution network power chart for TSO ancillary services provision,” Electric Power Systems Research, vol. 163, pp. 226–230, 2018. [23] S. Yu, F. Fang, Y. Liu, and J. Liu, “Uncertainties of virtual power plant: Problems and countermeasures,” Applied Energy, vol. 239, pp. 454 – 470, 2019. [24] C. Huang, D. Yue, J. Xie, Y. Li, and K. Wang, “Economic dispatch of power systems with virtual power plant based interval optimization method,” CSEE Journal of Power and Energy Systems, vol. 2, no. 1, pp. 74–80, March 2016. [25] M. Amini and M. Almassalkhi, “Trading off robustness and performance in receding horizon control with uncertain energy resources,” in 2018 Power Systems Computation Conference (PSCC), June 2018, pp. 1–7. [26] M. Vrakopoulou and B. Li and J. L. Mathieu, “Chance constrained re- serve scheduling using uncertain controllable loads part I: formula- tion and scenario-based analysis,” IEEE Trans. Smart Grid, vol. 10, no. 2, pp. 1608–1617, March 2019. [27] ´A. Lorca and X. A. Sun, “Multistage robust unit commitment with dynamic uncertainty sets and energy storage,” IEEE Trans. Power Systems, vol. 32, no. 3, pp. 1678–1688, May 2017. [28] A. Ben-Tal, A. Goryashko, E. Guslitzer, and A. Nemirovski, “Adjustable robust solutions of uncertain linear programs,” Mathematical Program- ming, vol. 99, no. 2, pp. 351–376, Mar 2004. [29] D. Bertsimas and M. Sim, “The price of robustness,” Operations Research, vol. 52, no. 1, pp. 35–53, 2004. [30] F. Golestaneh, P. Pinson, and H. B. Gooi, “Polyhedral predictive regions for power system applications,” IEEE Trans. Power Systems, vol. 34, no. 1, pp. 693–704, Jan 2019. [31] C. Wan, Z. Xu, and P. Pinson, “Direct interval forecasting of wind power,” IEEE Trans. Power Systems, vol. 28, no. 4, pp. 4877–4878, Nov 2013. [32] A. Garces, “A linear three-phase load ﬂow for power distribution systems,” IEEE Trans. Power Systems, vol. 31, no. 1, pp. 827–828, Jan 2016. [33] M. J. Dolan, E. M. Davidson, I. Kockar, G. W. Ault, and S. D. J. McArthur, “Reducing distributed generator curtailment through active power ﬂow management,” IEEE Trans. Smart Grid, vol. 5, no. 1, pp. 149–157, Jan 2014. [34] N. R. Ullah, K. Bhattacharya, and T. Thiringer, “Wind farms as reactive power ancillary service providers—technical and economic issues,” IEEE Trans. Energy Conversion, vol. 24, no. 3, pp. 661–672, Sep. 2009. IEEE TRANSACTIONS ON POWER SYSTEMS 12 [35] L. H. Macedo, J. F. Franco, M. J. Rider, and R. Romero, “Optimal operation of distribution networks considering energy storage devices,” IEEE Trans. Smart Grid, vol. 6, no. 6, pp. 2825–2836, Nov 2015. [36] Z. Yang, H. Zhong, A. Bose, T. Zheng, Q. Xia, and C. Kang, “A linearized OPF model with reactive power and voltage magnitude: A pathway to improve the MW-only DC OPF,” IEEE Trans. Power Systems, vol. 33, no. 2, pp. 1734–1745, March 2018. [37] Z. Tan, H. Zhong, J. Wang, Q. Xia, and C. Kang, “Enforcing intra- regional constraints in tie-line scheduling: A projection-based frame- work,” IEEE Trans. Power Systems, vol. 34, no. 6, pp. 4751–4761, Nov 2019. [38] B. Zeng and L. Zhao, “Solving two-stage robust optimization problems using a column-and-constraint generation method,” Operations Research Letters, vol. 41, no. 5, pp. 457 – 461, 2013. [39] H. Wang, C. E. Murillo-Sanchez, R. D. Zimmerman, and R. J. Thomas, “On computational issues of market-based optimal power ﬂow,” IEEE Trans. Power Systems, vol. 22, no. 3, pp. 1185–1193, Aug 2007. [40] K. P. Schneider, B. A. Mather, B. C. Pal, C. W. Ten, G. J. Shirek, and etc., “Analytic considerations and design basis for the ieee distribution test feeders,” IEEE Trans. Power Systems, vol. 33, no. 3, pp. 3181–3188, May 2018. [41] H. Konno, “A cutting plane algorithm for solving bilinear programs,” Mathematical Programming, vol. 11, no. 1, pp. 14–27, Dec 1976. Zhenfei Tan (S’17) received the B.S. degree in elec- trical engineering from Tsinghua University, Beijing, China, in 2017. He is currently working toward the Ph.D. degree in electrical engineering in Tsinghua University. His research interests include power system oper- ations, electricity markets and distributed optimiza- tion algorithms. Haiwang Zhong (M’13-SM’18) received the B.S. and Ph.D. degrees in electrical engineering from Tsinghua University, where he is currently an As- sociate Professor with the Department of Electrical Engineering. He was a recipient of the ProSPER.Net Young Scientist Award in 2014, the Outstanding Ph.D. Graduate and Outstanding Post-Doctor of Tsinghua University. He serves as the Editor for the International Transactions on Electrical Energy Systems, an Associate Editor for the Journal of Modern Power System and Clean Energy, and the CSEE Journal of Power and Energy Systems. He currently serves as the Vice- Chair of the Demand Response Working Group under the IEEE PES Power System Operations, Planning and Economics Committee, the Secretary of the IEEE PES SBLC Architecture Subcommittee. His research interests include smart grids, power system operations, elec- tricity markets, and demand response. Qing Xia (M’01-SM’08) received his Ph.D. degree in electrical engineering from Tsinghua University, Beijing, China, in 1989. He currently works as a professor with Tsinghua University. His research interests include electricity markets, generation scheduling optimization, power system planning. Chongqing Kang (M’01-SM’07-F’17) received his Ph.D. degree from Tsinghua University, Beijing, China, in 1997. He is now a professor with Tsinghua University. His research interests include power system plan- ning, power system operation, renewable energy, low carbon electricity technology and load forecasting. Xuanyuan Sharon Wang IEEE Senior Member, IEC TC8/SC8B/WG4 VPP convener, CIGRE mem- ber, received her B.S. degree, M.Sc. degree and PhD Degree in electrical engineering from in Xi’an Jiao- tong University, China, the University of Waterloo, Canada, and Tsinghua University, China, respec- tively. Her work experiences include Research Assis- tant at University of Waterloo from 2001-2003; Hon- eywell Aerospace in Toronto, Canada from 2003- 2004; ERCOT in Austin, U.S.A. from 2004-2010; State Grid Corporation of China from 2010-present. She is currently Executive Director, General Manager of Jibei Power Exchange Co., Ltd. Her past experiences include power market regulation, electricity market, power system operations, power electronics and renewable energy. Honghai Tang received the B.S. degree in electrical engineering from Wuhan University of Hydraulic and Electrical Engineering, Hubei, China, in 1997, and the M.S. degrees in electrical engineering from Wuhan University in 2001, and the Ph.D. degree in automation from Tsinghua University, Beijing, China. He is currently with Beijing Power Exchange Center Co., Ltd. His research interests include electricity market and power trading organization.","libVersion":"0.3.2","langs":""}