{"path":"lit/sources/tmp_papers/Akbari-Dibavar19stochRobustOptMkts.pdf","text":"Contents lists available at ScienceDirect Sustainable Cities and Society journal homepage: www.elsevier.com/locate/scs A hybrid stochastic-robust optimization approach for energy storage arbitrage in day-ahead and real-time markets Alireza Akbari-Dibavara, Kazem Zarea, Sayyad Nojavanb,⁎ a Faculty of Electrical and Computer Engineering, University of Tabriz, Tabriz, Iran b Department of Electrical Engineering, University of Bonab, P.O. Box 55517-61167, Bonab, Iran ARTIC L E I NF O Keywords: Energy storage arbitrage Day-ahead market Real-time market Price uncertainty Stochastic programming Robust optimization approach ABSTRAC T In recent years energy storage systems (ESSs) have been used widely in most European and American countries because of their economic and technical beneﬁts. One of their most exciting capabilities is the ability to parti- cipate in deregulated power markets. This paper proposes a hybrid stochastic-robust optimization approach, in which an ESS owner can engage in energy arbitrage in the day-ahead market (DAM) and provide extra bids and oﬀers in the real-time market (RTM) to increase his proﬁt. Stochastic programming is used to model DAM price uncertainties, while the robust optimization approach is proposed for more conservative decision making in RTM considering its high volatile prices. The results are optimal price-quantity pairs, which should be submitted to the DAM and RTM by the ESS owner. 1. Introduction From the system perspective ESS can provide peak shaving (Taşcıkaraoğlu, 2018), deal with uncertain nature of RES (Wang, Negash, & Kirschen, 2017), reduce the system losses and the amount of energy curtailment of non-dispatchable RES, and enhance the resiliency (Damavandi, Marti, & Krishnamurthy, 2017; Robert, Sisodia, & Gopalan, 2018). The ESS units have great potential in ﬂexibility enhancement, and they are vital elements envisioned to enable smart grid realization and stable operation of them, which should be addressed adequately (Khani, Zadeh, & Hajimiragha, 2016; O’Dwyer, Ryan, & Flynn, 2017). These units are the basis for zero energy buildings (Del Pero et al., 2018). In addition to network related advantages, the privately owned ESS facilities can participate strategically in power markets, e.g., energy arbitrage, or ancillary services such as reserve and frequency regulation (He, Chen, Kang, Pinson, & Xia, 2016). In this paper, the aim is to provide an optimization framework to maximize the proﬁt of a large-scale ESS participates in DAM and RTM and takes the advantages of the energy arbitrage. 1.1. Literature review The energy arbitrage is deﬁned as purchasing the energy at oﬀ-peak times by low prices, storing in the ESS, and selling it by high prices at peak times to achieve ﬁnancial beneﬁts, and the main base of energy arbitrage is price diﬀerences during periods of a day (Ikeda & Ooka, 2016; Mohd et al., 2008). The revenue of an ESS facility depends on the application of it. In this regard, using a linear regression model and machine-learning algorithms, the expected income of an ESS partici- pates in energy arbitrage services is studied based on real historical market price data in (Vejdan & Grijalva, 2018). It is found that the price dispersion is a critical factor for energy arbitrage services, and in winters there is a great opportunity for energy arbitrage service. Every market participant is categorized as a price-maker or price- taker. The price-maker ESS facility can aﬀect the market prices by its actions (charges and discharges). Considering this fact, paper (Awad, Fuller, EL-Fouly, & Salama, 2014) investigates the impact of the size and placement of an ESS on market prices, and energy arbitrage ben- eﬁts. The cooperative eﬀect of a large-scale price-maker BESS operation on the locational marginal price is studied in (Mohsenian-Rad, 2016a). Reference (Shaﬁee, Zareipour, & Knight, 2017) derives the optimal bidding and oﬀering curves for a price-maker merchant energy storage facility with large capacity participates in a DAM. The impacts of large- scale ESS units on the market prices are investigated using price quota curves. However, if the ESS unit is considered as a price-taker, there is a need to predict the market price, and according to this prediction, the optimal bids and oﬀers will be determined (Qin, Sevlian, Varodayan, & Rajagopal, 2012). From the viewpoint of ESS technology, the BESS, CAES and PHSP https://doi.org/10.1016/j.scs.2019.101600 Received 20 October 2018; Received in revised form 12 April 2019; Accepted 9 May 2019 ⁎ Corresponding author. E-mail addresses: a.dibavar96@ms.tabrizu.ac.ir (A. Akbari-Dibavar), kazem.zare@tabrizu.ac.ir (K. Zare), sayyad.nojavan@bonabu.ac.ir (S. Nojavan). Sustainable Cities and Society 49 (2019) 101600 Available online 09 May 2019 2210-6707/ © 2019 Elsevier Ltd. All rights reserved. T units can eﬃciently participate in energy arbitrage markets, since their operation time is in the rage of a minute to an hour (Yan, Gu, Wyman- Pain, & Li, 2018). Due to their ﬂexibility and scalability, grid-scale BESS are prevalent than the other technologies and provide high potential revenues according to their function in the network (Davies et al., 2019). However, calendar life and cycle life are two main factors de- termine how long the BESS will last in a given application (Fares & Webber, 2018). The embedding of the cycle life calculations into op- eration optimization models is an interesting study (Goebel, Hesse, Schimpe, Jossen, & Jacobsen, 2017; Sarker, Murbach, Schwartz, & Ortega-Vazquez, 2017). For more information, a detailed character- ization of the life cycle cost of the BESS can be found in (Nagarajan & Ayyanar, 2015). The ESS facilitates the integration of RES and deals with the un- certain nature of these resources. The market prices are aﬀected by various factors, including RES behaviors; hence, uncertainty modeling and management should be considered in the scheduling of ESS units (Ding, Pinson, Hu, & Song, 2016; Zou, Chen, Xia, He, & Kang, 2016). From viewpoint of uncertainty management, the stochastic program- ming and robust optimization approach are used widely in the litera- tures. The base of the stochastic programming is the fact that the rea- lizations of an uncertain parameter can be known (or predicted) by looking at the history of that parameter, so the stochastic programming using a set of scenarios gives an appropriate tool to decide in the pre- sence of uncertain parameters (Alipour, Mohammadi-Ivatloo, & Zare, 2015). However, the robust optimization approach provides an optimal solution with two main features. Firstly, the feasibility of a solution is ensured for any realization of the uncertain parameter, while it just needs only the minimum and maximum bands of the uncertain para- meter and does not require a large amount of data (i.e., scenarios). And secondly, by considering the worst-case condition, for all realization and all probabilities of the uncertain parameter, the RO ﬁnds the optimal solution (Nazari-Heris & Mohammadi-Ivatloo, 2018). In this approach, the minimum and maximum limits of the uncertain para- meters are considered for uncertainty modeling, and unlike stochastic programming, it does not need a large database (Nojavan, Zare, & Mohammadi-Ivatloo, 2017). Some references that use uncertainty modeling tools in ESS scheduling are presented in the following. An optimal bidding strategy for a microgrid is presented by (Liu, Xu, & Tomsovic, 2016), in which the stochastic programming considers DAM price uncertainty and the robust optimization is used to deal with RTM price ﬂuctuations. The DAM optimal scheduling of a wind farm coupled with cryogenic storage is studied in (Kalavani, Mohammadi- Ivatloo, & Zare, 2019) using stochastic programming. The solar power production and electricity price uncertainties are considered via bounded intervals in a controllable polyhedral uncertainty set in (Attarha, Amjady, & Dehghan, 2018), to provide a robust bidding strategy for a solar system connected to BESS. A stochastic optimization framework is proposed for BESS scheduling by (Mohsenian-Rad, 2016b) to participate in energy DAM and RTM, while considers diﬀerent parameters, e.g., the size and location of BESSs. Similarly, reference (Krishnamurthy, Uckun, Zhou, Thimmapuram, & Botterud, 2017) pre- sents a stochastic optimization to maximize total proﬁt of BESS parti- cipates in DAM and RTM energy arbitrage considering two perspec- tives: 1) The BESS owner only provides quantity bids, and 2) the BESS owner submits price-quantity pairs. In (Wang, Dvorkin et al., 2017), a risk constraint stochastic programming is proposed to determine stra- tegic bids of a BESS in the DAM, while considers the ﬁnal state of charge of BESS at the end of the trading day to investigates its eﬀects on next day. In (Kazemi, Zareipour, Amjady, Rosehart, & Ehsan, 2017), in ad- dition to the energy market, optimal scheduling of BESS is investigated in DA ancillary services, i.e., spinning reserve and regulation markets, while the uncertain nature of spinning reserve and regulation markets are handled via RO. The optimal bidding and oﬀering curves of a Nomenclature Indices t Index of time (h) s Index of scenario Variables tP ( )DA ch Purchased power from the DAM by storage at time t (MW) tP ( )DA dis Sold power to the DAM by storage at time t (MW) tsP (, )stor ch Energy supplied to storage at time t, in DA price scenario s (MW) tsP (, )stor dis Energy supplied from storage at time t, in DA price sce- nario s (MW) tE() State of charge of BESS in hour t (MWh) tsu( , )ch Binary variable status of BESS at time t and scenario s, equal to 1 if the BESS is charging, otherwise 0 tsu( , )dis Binary variable status of BESS at time t and scenario s, equal to 1 if the BESS is discharging, otherwise 0 tB ( )DA ch Purchase bid price in DAM at time t ($/MWh) tO ( )DA dis Sell bid price in DAM at time t ($/MWh) yt() The auxiliary variable of robust optimization q t( ) Dual variable related to robust optimization Z0 Dual variable related to robust optimization Parameters ηch Loss factor during charging (%) ηdis Loss factor during discharging (%) α Tolerance for the state of charge Pch The maximum rate of charge (MW) Pdis The maximum rate of discharge (MW) Einit The initial state of charge (MWh) E, E Minimum and maximum state of charge (MWh) sρ( ) The probability of DA price forecast under scenario s tsπ (, )DA Hourly forecasted price for DA price scenario s ($/MWh) tπ ()RT Hourly estimated price for RT price ($/MWh) M Big number Γ A parameter for robustness control ttπ (), π ()min RT max RT The minimum and maximum hourly amounts of price for RTM β The interval on RT price deviations Abbreviations BESS Battery energy storage system ESS Energy storage system DA Day-ahead RT Real-time DAM Day-ahead market RTM Real-time market RO Robust optimization GAMS General Algebraic Modeling System MILP Mixed-integer linear programming MCP Market clearing price CAES Compressed air energy storage LAES Liquid air energy storage PHSP Pumped hydro storage plant RES Renewable energy source A. Akbari-Dibavar, et al. Sustainable Cities and Society 49 (2019) 101600 2 merchant CAES is determined by RO approach in (Nojavan, Najaﬁ- Ghalelou, Majidi, & Zare, 2018). In Table 1, a summarized comparison between recently mentioned literatures is presented. As can be seen from Table 1, the most used ESS technology in the literatures is BESS. Although in some references, participation in RTM is not considered, while there is a wonderful opportunity for the BESS owners to maximize their ﬁnancial beneﬁt. In some other references, the RTM is discussed, but stochastic programming has been used for both DAM and RTM, which can be insecure considering a higher level of uncertainty in the RTM. For this reason, in the presented paper, it is assumed that the BESS will participate in RTM, while high volatility in RTM prices is managed by the robust optimization approach to be re- sistant against inaccurate forecasts. Although other references use sto- chastic programming to model the unknown parameters, this kind of uncertainty modeling cannot guarantee the obtained proﬁt unless they use vigorous risk management index. On the other side, the advantage of the robust optimization approach is that it ensures the acquired proﬁt, and it can be declared that under any realization of the uncertain parameters, the proﬁt will always be higher than of that gained by the robust optimization approach. Hence, the proposed approach is a risk- averse technique for the BESS owner participates in the energy market. Finally, it should be noted that the proposed method is not limited to BESS, but can be applied to other ESS technologies by considering their physical constraints. 1.2. Contributions According to the above description, and considering high uncertain RTM prices, the RO method can provide more ﬁrm bids and oﬀers in RTM, so this paper aims to provide a hybrid stochastic-robust optimi- zation framework to maximize the proﬁtability of the BESS owner participates in energy DAM and RTM. Because of speciﬁc features of the DAM bidding and oﬀering, it has been preferred to solve DAM opti- mization as stochastic programming, while the optimal operation of BESS is determined by the RO in the RTM. Due to the authors’ knowledge, this type of BESS scheduling has not been studied in the literatures. To provide a more practical work, the scenarios are gener- ated using real-world market data, which are retrieved from Commonwealth Edison corporation website (ComEd, n.d.). For sum up the following sentences summarize the main contribu- tions of this paper: • DAM optimal price-quantity bidding and oﬀering strategy is in- vestigated while the uncertainty of price forecasts is modeled by stochastic programming. • Additional quantity only biddings and oﬀerings happen in RTM, in which the uncertainty of price is handled by the robust optimization method. 1.3. Paper organization The rest of paper is organized as follow; in Section 2, problem for- mulation of BESS modeling, price uncertainty modeling using stochastic programming for DAM and robust optimization for RTM are presented. In Section 3, the input data and numerical results of the proposed op- timization framework are expressed. Finally, Section 4 summarizes the conclusions and provides directions for future works. 2. Problem formulation Proﬁt maximization of a BESS participates in an energy arbitrage market has been investigated in this section, subject to operational constraints. First of all, the mathematical formulations that model the behaviors of the BESS are presented. 2.1. BESS constraints In the following, by considering energy storage capacity, maximum charging and discharging rates, charging and discharging eﬃciencies, initial and ﬁnal state-of-charge, the BESS is modeled mathematically. = − t ts P () P( , ) (1 η /100) DA ch stor ch ch (1) =× −tt sP ( ) P ( , ) (1 η /100)DA dis stor dis dis (2) ≤×ts tsP (, ) u (, ) Pstor ch ch ch (3) ≤×ts tsP (, ) u (, ) Pstor dis dis dis (4) +≤ts tsu ( ,) u ( ,) 1ch dis (5) = = += −=ts ts tsE(1, ) E P (1, ) P (1, )init stor ch stor dis (6) =− + −ts t s ts tsE( ,) E( 1,) P ( ,) P ( , )stor ch stor dis (7) ≤≤tsE E( , ) E (8) ×− ≤ = ≤ ×+tsE (1 α) E( 24, ) E (1 α)init init (9) Eqs. (1)–(9) are used to model BESS operational constraints. Eqs. (1) and (2) model the eﬀect of charge and discharge eﬃciency of BESS, and show that the purchased/sold powers will not necessarily equal to the input/output powers of BESS. Constraints (3) and (4) limit the charge and discharge powers of BESS and there are two binary variables, i.e., tsu( , )ch and tsu( , )dis , that determine charge and discharge statue of BESS in each scenario and each time. Eq. (5) inhibits BESS from si- multaneous charging and discharging. Eqs. (6) and (7) show the actual amount of stored energy, i.e., the state-of-charge (SOC) of BESS for each hour and each scenario, which is delimited by (8). For the ﬁnal hour, Eq. (9) deﬁnes a tolerance for the SOC of BESS, where α is a constant Table 1 Comparison between related works. Ref. Type of ESS DAM RTM Uncertainty modeling in DAM Uncertainty modeling in RTM (Khani et al., 2016) CAES Yes Yes No No (He et al., 2016) BESS Yes No Stochastic No (Mohsenian-Rad, 2016a) BESS Yes No Stochastic No (Shaﬁee et al., 2017) CAES Yes No Robust No (Ding et al., 2016) BESS Yes Yes Stochastic Stochastic (Mohsenian-Rad, 2016b) BESS Yes Yes Stochastic Stochastic (Krishnamurthy et al., 2017) BESS Yes Yes Stochastic Stochastic (Wang, Dvorkin et al., 2017) BESS Yes No Stochastic No (Kazemi et al., 2017) BESS Yes No Robust No (Nojavan et al., 2018) CAES Yes No Robust No (Barbry, Anjos, Delage, & Schell, 2019) BESS Yes No Robust No (Lin, Wu, Bai, & Xie, 2019) LAES No Yes No No This work BESS Yes Yes Stochastic Robust A. Akbari-Dibavar, et al. Sustainable Cities and Society 49 (2019) 101600 3 value. 2.2. DAM bidding and oﬀering problem In this subsection, the bidding and oﬀering of BESS problem in a DAM are simulated by Eqs. (10)–(17). ∑∑ ×× −st s t tMax ρ( )π ( , )(P ( ) P ( )) ts DA DA dis DA ch (10) −Subject to (1) (9). (11) ≤+ ×tt s t sB () π ( , ) M u ( , )DA ch DA ch (12) ≥− × −tt s t sB () π ( , ) M (1 u ( , ))DA ch DA ch (13) ≥− ×tt s t sO () π ( , ) M u ( , )DA dis DA dis (14) ≤+ × −tt s t sO () π ( , ) M (1 u ( , ))DA dis DA dis (15) ≥≥ ≥≥ ≥≥ tt s tt s tt P ( )0, P ( , )0, P ( )0, P ( , )0, B( ) 0, O ( ) 0 DA ch stor ch DA dis stor dis DA ch DA dis (16) ∈ts tsu( , ), u ( , ) {0, 1}ch dis (17) Eq. (10) deﬁnes the objective function, which aims to maximize the proﬁt gained by energy arbitrage in the DAM. The BESS constraints are aggregated by (11). Probable scenarios are considered to model the price uncertainty of the DAM. Eqs. (12) and (13) are used to ﬁnd the price bids for the BESS to buy energy from the market at lower possible prices and M is a large integer, which determines the price bid when- ever a bid is accepted. Concerning (12),if tsu( , )ch is one then this constraint is no more binding, while (13) is binding and determines the value of the bidding price, i.e., tB ( )DA ch , to be higher than the forecasted market price ( tsπ (, )DA ). In contrast, for oﬀering prices, with a look on Eqs. (14) and (15), it can be concluded that when tsu( , )dis is 1, i.e., BESS sells energy, the oﬀering price will always be greater than or equal to zero, and less than the forecasted market price. This assumption means that the bids and oﬀers in the DAM will always be accepted because they are determined with considering the probable price sce- narios (Krishnamurthy et al., 2017). Finally, Eqs. (16) and (17) show the variables’ limits. It should be noted that the proposed stochastic optimization will be solved for each scenario separately. After considering all scenarios, the scheduling with higher expected proﬁt is selected as the optimal solu- tion. As can be seen, the variables tsu( , )ch , tsu( , )dis , tsE(, ), tsP (, )stor ch and tsP (, )stor dis are dependent on the scenarios. However, the submitted powers and prices to the market should be unique, as are shown by Eqs. (1), (2) and (12)–(15), where the variables tP ( )DA ch , tP ( )DA dis , tB ( )DA ch , tO ( )DA dis are determined scenario-free. 2.3. Complimentary RTM bidding and oﬀering problem After DAM realization and when the accepted bids and oﬀers are identiﬁed, the BESS owner makes additional bids and oﬀers in the RTM to gain extra proﬁt, but it must be taken into consideration that the accepted bids and oﬀers in the DAM should be met. It is assumed that the BESS owners are allowed to make only quantity bids in the RTM. RTM prices are dependent on real-time system operation, which is af- fected by various factors such as demand variation, weather, con- tingencies, and congestions; hence, the electricity prices in the RTM are highly volatile and unpredictable. As a risk-averse technique, the RO can eﬀectively deal with this uncertainty while guarantees a certain amount of proﬁt. In the RO, the variation range of the uncertain parameter, also called conﬁdence interval, is deﬁned assuming that after the fact parameter falls into this interval. Then, the worst case of uncertainties occurrence inside the conﬁdence interval is considered. The decision variables are determined based on the worst-case analysis (Shaﬁee et al., 2017). In the following, the RO is applied to the RTM optimal bidding and oﬀering problem. ∑∑×+ − × − ′′ Γt t P t tMinZ q() π () ( () P ()) tt 0 RT RT dis RT ch (18) −Subject to (1) (9). (19) ≤≤tt tπ () π () π ()min RT RT max RT (20) =− ×ttπ () (1 β) π ( )min RT RT (21) =+ ×ttπ () (1 β) π ( )max RT RT (22) +≥ − ×tt t y tZ q( ) (π ( ) π ( )) ( )0 max RT min RT (23) −≤P tt y t() P () ()RT dis RT ch (24) ≥≥ ≥ty tZ 0, q( ) 0, ( ) 00 (25) Eq. (18) deﬁnes the objective function of the RTM problem, which aims to minimize the negative of proﬁt. To create the standard format of the RO, the objective function, which is the maximization of proﬁt, is multiplied by a negative sign. As can be seen, the objective is similar to that described in the previous Section 2.2. It should be pointed out that the parameter Γ will control the robustness level; in fact, the higher the value of Γ the most conservatism condition is considered. Eq. (19) considers BESS modeling constraints. In the formulation, the market is running for the next day and after DAM closure, so the time indicated by ′t , and moreover, this optimization framework is free from scenarios because of the RO model. As it was mentioned before, in RO, the minimum and maximum bands of the uncertain parameter is required instead of actual forecasted prices, as Eq. (20) shows it, and this concept is accomplished using (21) and (22). Where the parameter β deﬁnes the deviation range of the conﬁdence interval of RTM prices, which is 0.1 in this paper. About RO method, tZ ,q( )0 , and yt() are slack variables produced because of duality theorem and linearizing of the original formulation (Bertsimas & Sim, 2003). Two ﬁrst mentioned variables come from duality, and the third auxiliary variable is used in the lin- earization process. For more information about RO method formula- tion, reference (Bertsimas & Sim, 2003) can be helpful. Eqs. (23)–(25) are used to complete the RO model including decision variables. The ﬂowchart of the proposed hybrid stochastic-robust optimization approach of BESS arbitrage is illustrated in Fig. 1. In fact, in the proposed hybrid optimization, the below steps are done consequently, to ﬁnd the optimal bids and oﬀers.g Step 1: The price scenarios and probabilities are the inputs of the DAM optimization, and the optimization is stochastic programming at this stage. Step 2: The optimal charge and discharge pattern of BESS is de- termined at this level, for the DAM. Eqs. (1)–(9) and (10)–(17) are solved. The optimal scheduling of BESS in DAM is ﬁxed. Step 3: After DAM realization, on the next day, according to the submitted bids and oﬀers (contracted powers) in the DAM, and con- sidering BESS physical constraints, i.e., Eqs. (1)–(9), the BESS owner runs the RO problem, i.e., Eqs. (18)–(25) to ﬁnd additional bids and oﬀers in the RTM. However, the powers of DAM are entered as ﬁxed parameters in RTM and should be met. Step 4: The ﬁnal solution of the proposed optimization consists of hourly price-quantity pairs for the DAM and only quantity bids for the RTM. 3. Numerical study In this section, the obtained results for optimal bids and oﬀers are presented. All of the equations are modeled as mixed-integer linear programming (MILP) which is implemented in GAMS optimization software (Brook, Kendrick, & Meeraus, 1988) and solved via CPLEX A. Akbari-Dibavar, et al. Sustainable Cities and Society 49 (2019) 101600 4 solver (Cplex, n.d.) on a Core i5 2.6 GHz processor and at least 6 GB RAM. Both the DAM and RTM optimizations take less than 1 s. 3.1. Input data The price uncertainty can be modeled by a normal distribution probability density function (PDF) (Kim & Poor, 2011). Hence, in this paper, it is assumed that the random DAM prices follow the normal PDF, in which real-world market prices are used as expected values (mean values), and a standard deviation of 20% is selected because the DAM prices are not highly volatile. For the sake of ease, ten samples are considered from the assumed distribution to determine optimal bidding and oﬀering of BESS in the DAM. These scenarios are shown in Fig. 2. The probabilities of the scenarios are equal. As it was declared previously, RO method is needless of knowing PDFs or scenarios, and by creating a conﬁdence set, reinforces the ro- bustness of optimization problem versus the undesired changes. The real price data of July 14, 2018, is selected as the base price, and the conﬁdence intervals are applied to it, which are taken from (ComEd, n.d.). Fig. 3 shows the RTM price interval. The characteristics of the battery storage are deﬁned as 50 MW nominal power rate and 100 MW h nominal capacity (i.e., a 2-h battery) with 10% charge/discharge losses (or 90% eﬃciency), the initial SOC is ﬁxed at zero, and the variable or ﬁxed operational costs of BESS are not considered. One-day scheduling is done to test and validate the feasi- bility and eﬀectiveness of the proposed model. 3.2. The DAM bidding and oﬀering using stochastic programming The ﬁrst step is to obtain the optimal pairs of prices and quantities submitted to the DAM, which should be submitted by the BESS owner to participate in the energy market. Eqs. (1)–(9) are used to model the BESS behaviors, while (10)–(17) are the main optimization equations determine the optimal bids and oﬀers in the DAM. Since DAM prices are not very volatile, the price-taker BESS owner can make decisions according to the scenarios made using historical data. Fig. 4 shows the submitted bids and oﬀers of the BESS in the DAM. In Fig. 4, the positive and negative quantities indicate the purchased and sold powers of BESS, respectively. Table 2 summarizes the obtained results. In the market clearing process, the price bids equal to or higher than the MCP will always be accepted. On the other hand, the price oﬀers lower than the MCP are always accepted in the market. As can be seen from Table 2, the price bids for purchasing power are higher than the highest hourly price in all scenarios, and the price oﬀers for selling are zero. In a uniform pricing market, the MCP will be paid for accepted oﬀers, so zero oﬀering does not aﬀect the proﬁtability. It should be noted that due to BESS losses, the purchased powers (i.e. 55.55 MW) are always higher than the sold powers (i.e. 45 MW). The total proﬁtof BESS in the DAM is around $ 2223.66. In Table 3, the impact of the number of scenarios in the ﬁnal result is shown. In the following, it will be assumed that the DAM is realized, and the BESS owner would like to submit additional quantity bids to achieve more proﬁt. It should be taken into consideration that accepted bids and oﬀers in the DAM must be met, otherwise the ESS owner would suﬀer an economic loss. So these accepted bids will appear as ﬁxed parameters in RTM clearing to prevent the model from being infeasible. Also, the nominal power charge/discharge rates and capacity of BESS should be considered, with this description only two charging or dis- charging can occur successively, which is clear from Fig. 4. 3.3. The RTM additional bids and oﬀers in the presence of robust optimization approach The RO approach is used in this section to manage the uncertainty of RTM price forecasts. Eqs. (1)–(9) are used to model the BESS and (18)–(25) determine optimal bids and oﬀers in the RTM. The parameter deﬁned as Γ will control the level of robustness in the objective func- tion. If the parameter Γ is set to zero, it means that the variations of price are ignored, and the optimization is treated as a deterministic optimization, while if it takes another positive value the uncertainty of prices will be taken into account. In this work, it is assumed that the parameter Γ changes from zero to 1, and the proﬁt maximization problem is solved for diﬀerent values of Γ . Figure 5 shows diﬀerent bidding and oﬀering strategies due to robust model consideration. In Fig. 5, for example, the results of additional bids and oﬀers in RTM considering three diﬀerent robustness control parameters have been shown. The above plot shows the results for =Γ 0, in which the impact of RO is ignored and a risk-neutral problem is solved. The second one, for =Γ 0.5, considers the half of robustness budget. It is Fig. 1. Flowchart of the hybrid stochastic-robust approach. Fig. 2. DAM price scenarios. A. Akbari-Dibavar, et al. Sustainable Cities and Society 49 (2019) 101600 5 clear that the scheduling is diﬀerent from the ﬁrst plot at hours 8 and 12. The last ﬁgure shows that all price uncertainties in RTM are con- sidered or the most conservative solution is obtained. The last strategy will be selected by a risk-averse decision maker. In this case, the charge and discharge scheduling are diﬀerent from the ﬁrst and second plots at hours 8 and 11. It should be reemphasized that the price uncertainty of the DAM was modeled through stochastic programming in the previous step during obtaining bids and oﬀers for the DAM, and contracted powers in DAM, which should be met in the RTM, are marked with blue in Fig. 5. These contracted powers must remain untouched by changing Γ . From Fig. 5, participating in RTM causes more energy changing of BESS, which may decrease the proﬁtability because of increasing de- gradation rate of BESS, as discussed by (Wankmüller, Thimmapuram, Gallagher, & Botterud, 2017), which is not considered in this paper, and will be paid attention in the future works. However, ignoring the cycle life of BESS, the frequently charging and discharging will increase the proﬁtability of the BESS according to the higher price ﬂuctuations in RTM. Fig. 6 shows the diﬀerent amounts of RTM proﬁts as a function of Γ , for the diﬀerent rate of risk acceptance. It should be noted, Γ raises by 0.1 in each step from zero to 1. As can be seen from Fig. 6 with an increment of Γ , the conservatism is increased and the proﬁt is reduced. However, the proﬁt is higher for the low amount of Γ , but there is a high risk of getting this proﬁt. The higher the values for Γ the more insurance of gained proﬁt. Selecting a proper Γ depends on the decision maker's risk appetite. A risk-seeker decision maker will choose lower amounts of Γ ; however, the risk- averse prefers to choose higher values. When Γ is set to zero, the optimization is considered as a determi- nistic optimization or non-robust model and can be treated as a base- line, in which the proﬁt of RTM is $ 1478.889 in addition to DAM proﬁt (i.e., $ 2223.66). Furthermore, when the Γ is set to 1, the optimization is considered as a robust model to obtain robust scheduling of BESS in the worst condition in RTM. In this case, the proﬁt of RTM is $ 1196.21 in addition to DAM proﬁt (i.e., $ 2223.66). It is clear that the RTM proﬁt is decreased by 19.11% due to RTM price uncertainty modeling via the robust optimization approach, in which the worst condition is considered. The presented optimization framework is not limited to BESS, and can be applied to other ESS technologies by considering their physical constraints. Hence, a pumped hydro storage plant (PHSP) is considered with the total energy stored capacity of 2500 MW h, and lower amount of 2000 MW h. The maximum pumping and generating powers are 100 MW and the round-trip eﬃciency is equal to 0.67. The physical constraints of PHSP are provided in the Appendix A (see Eqs. (A1)–(A8)) which are taken from the paper of (Kazempour, Moghaddam, Haghifam, & Youseﬁ, 2009). These equations should be replaced with the Eqs. (1)–(9), in order to obtain the optimal charging and discharging scheduling of the PHSP. With considering price data presented in Figs. 2 and 3, the problem of providing optimal bids and oﬀers of quantity-price pairs as well as obtained proﬁt in the DAM are reported in Table 4. Also, the optimal quantity bids and oﬀers for =Γ 0 and =Γ 1, as well as the proﬁt of the RTM are presented in Table 5. Table 4 shows that the proﬁt of the PHSP unit from participating in DAM is $ 5923.203. From Table 5, the RTM proﬁt in non-robust mode is $ 5236.716; however, this proﬁt is reduced by $ 3535.229, i.e. 32.5%, in the most conservatism condition. Furthermore, there is a little dif- ference in pumping and generating schedules between both cases, i.e. at hours 9 and 10. The diﬀerence between purchased and sold powers is due to the energy losses of the PHSP. Total proﬁt of the PHSP owner from participation in DAM and RTM for the non-robust scheduling is $ 11159.919. Fig. 3. RTM prices interval. Fig. 4. Submitted optimal quantity bids and oﬀers in the DAM. Table 2 Submitted bids/oﬀers in DAM and total proﬁt. Time (h) Quantity (MW) Price ($/MWh) Purchase bids 3/4 55.55/55.55 18.8/22.81 Sell oﬀers 15/17 45/45 0/0 DAM proﬁt ($) 2223.66 Table 3 DAM proﬁt considering diﬀerent numbers of scenarios. Number of scenarios Total proﬁt ($) 10 2223.66 20 2757.95 50 2359.28 100 2308.83 A. Akbari-Dibavar, et al. Sustainable Cities and Society 49 (2019) 101600 6 4. Conclusion This paper aims to provide a hybrid stochastic-robust optimization framework for privately owned ESS to participate strategically in DAM and RTM. A price-taker BESS is investigated in this paper seeks to maximize his proﬁt by engaging in competitive markets. For the DAM, the uncertainties of the electricity price are modeled by probable sce- narios to obtain optimal bids and oﬀers, while for RTM due to its highly volatile prices, RO is proposed. The BESS physical constraints and proposed optimal bidding and oﬀering problem are mathematically formulated as MILP and solved in GAMS optimization software. Energy arbitrage of a sample day was carried out, and feasibility of the pro- posed model is investigated. It is concluded that participation in RTM can acquire more ﬁnancial proﬁt, while increases the cycling of BESS which leads to fast failure of BESS. Also, it can be found that the stochastic optimization presented in this paper can help to the BESS owner in gaining monetary beneﬁts in DAM, as much as possible. On the other hand, there is an ample op- portunity in RTM with highly volatile prices, which should be managed by strong optimization methods, such as robust optimization approach as investigated in this paper. For diﬀerent levels of robustness, the proposed optimization is run, and the results are reported. Furthermore, the presented optimization framework is applied to a PHSP unit to determine optimal bids and oﬀers in DAM and RTM to show the merit of the presented framework in the large application in the presence of other engrossing ESS technologies. As a future work, the authors are interested in the evolution of ef- fects of cycle life on energy arbitrage proﬁt and modeling the un- certainties with other robust make decision tools, e.g., the information gap decision theory (IGDT) or interval optimization approach. Appendix A In the following the physical constraints of PHSP are expressed. Fig. 5. Submitted optimal bids in RTM using RO approach. Fig. 6. Proﬁt of RTM considering robust optimization approach. Table 4 The optimal quantity and price bids and oﬀers in DAM for PHSP. Time (h) Quantity (MW) Price ($/MWh) Purchase bids 1/2/3/4 149.254/149.25/149.25/149.25 29.23/18.8/22.81/18.93 Sell oﬀers 12/14/15/16 100/100/100/100 0/0/0/0 DAM proﬁt ($) 5923.203 Table 5 The optimal quantity bids and oﬀers in RTM for PHSP. =Γ 0 =Γ 1 Time (h) Quantity (MW) Time (h) Quantity (MW) Purchase bids 5/9 149.254/ 149.254 5/9/10 149.254/104.475/ 44.794 Sell oﬀers 7/17 100/100 7/17 100/100 RTM proﬁt ($) 5236.716 3535.229 A. Akbari-Dibavar, et al. Sustainable Cities and Society 49 (2019) 101600 7 ≤≤ ×ts ts0 P ( ,) u ( ,) Pgg g (A1) ≤≤ ×ts ts P0 P ( ,) u ( ,)pp p (A2) +≤ts tsu ( ,) u ( ,) 1gp (A3) −+ ≤ts t su( 1, ) u ( , ) 1gp (A4) −+ ≤ts t su( 1, ) u ( , ) 1pg (A5) =− − + ×ts t s ts η tsE( ,) E( 1,) P ( ,) P ( ,)gp (A6) ≤≤tsE E( , ) E (A7) ×− ≤ = ≤ ×+tsE (1 α) E( 24, ) E (1 α)init init (A8) where, Eqs. (A1) and (A2) enforce the lower and upper limits of generating and pumping powers of PHSP. Eq. (A3) shows that the simultaneous pumping and generating is prohibited. Eqs. (A4) and (A5) state that changing from pumping mode to generating mode, or vice versa, is a time- consuming process and the PHSP cannot change its mode immediately. Eq. (A6) calculates the energy stored in the upper reservoir according to the amounts of pumped and generated powers and (A7) limits the energy stored in the upper reservoir. Finally, (A8) deﬁnes a tolerance for the ﬁnal amount of energy stored in the upper reservoir, in which α is a minor constant value. References Alipour, M., Mohammadi-Ivatloo, B., & Zare, K. (2015). Stochastic scheduling of re- newable and CHP-based microgrids. IEEE Transactions on Industrial Informatics, 11(5), 1049–1058. https://doi.org/10.1109/TII.2015.2462296. Attarha, A., Amjady, N., & Dehghan, S. (2018). Aﬃnely adjustable robust bidding strategy for a solar plant paired with a battery storage. IEEE Transactions on Smart Grid, 10(3), 2629–2640. https://doi.org/10.1109/TSG.2018.2806403. Awad, A. S. A., Fuller, J. D., EL-Fouly, T. H. M., & Salama, M. M. A. (2014). Impact of energy storage systems on electricity market equilibrium. IEEE Transactions on Sustainable Energy, 5(3), 875–885. https://doi.org/10.1109/TSTE.2014.2309661. Barbry, A., Anjos, M. F., Delage, E., & Schell, K. R. (2019). Robust self-scheduling of a price-maker energy storage facility in the New York electricity market. Energy Economics, 78, 629–746. https://doi.org/10.1016/j.eneco.2018.11.003. Bertsimas, D., & Sim, M. (2003). Robust discrete optimization and network ﬂows. Mathematical Programming, Vol. 98,49–71. https://doi.org/10.1007/s10107-003- 0396-4. Brook, A., Kendrick, D., & Meeraus, A. (1988). GAMS, a user’s guide. ACM Signum Newsletter, 23(3–4), 10–11. ComEd. (n.d.). Live Prices | ComEd’s hourly pricing program. Retrieved 2 September 2018, from https://hourlypricing.comed.com/live-prices/. Cplex, G. (n.d.). The solver manuals. Gams/Cplex, 2014. Damavandi, M. G., Marti, J. R., & Krishnamurthy, V. (2017). A methodology for optimal distributed storage planning in smart distribution grids. IEEE Transactions on Sustainable Energy, PP(99), 1. https://doi.org/10.1109/TSTE.2017.2759733. Davies, D. M., Verde, M. G., Mnyshenko, O., Chen, Y. R., Rajeev, R., Meng, Y. S., & Elliott, G. (2019). Combined economic and technological evaluation of battery energy sto- rage for grid applications. Nature Energy, 4,42–50. https://doi.org/10.1038/s41560- 018-0290-1. Del Pero, C., Aste, N., Paksoy, H., Haghighat, F., Grillo, S., & Leonforte, F. (2018). Energy storage key performance indicators for building application. Sustainable Cities and Society, 40,54–65. https://doi.org/10.1016/j.scs.2018.01.052. Ding, H., Pinson, P., Hu, Z., & Song, Y. (2016). Integrated bidding and operating strategies for wind-storage systems. IEEE Transactions on Sustainable Energy, 7(1), 163–172. https://doi.org/10.1109/TSTE.2015.2472576. Fares, R. L., & Webber, M. E. (2018). What are the tradeoﬀs between battery energy storage cycle life and calendar life in the energy arbitrage application? Journal of Energy Storage, 16,37–45. https://doi.org/10.1016/j.est.2018.01.002. Goebel, C., Hesse, H., Schimpe, M., Jossen, A., & Jacobsen, H. A. (2017). Model-based dispatch strategies for lithium-ion battery energy storage applied to pay-as-Bid markets for secondary reserve. IEEE Transactions on Power Systems, 32(4), 2724–2734. https://doi.org/10.1109/TPWRS.2016.2626392. He, G., Chen, Q., Kang, C., Pinson, P., & Xia, Q. (2016). Optimal bidding strategy of battery storage in power markets considering performance-based regulation and battery cycle life. IEEE Transactions on Smart Grid, 7(5), 2359–2367. https://doi.org/ 10.1109/TSG.2015.2424314. Ikeda, S., & Ooka, R. (2016). Optimal operation of energy systems including energy storage equipment under diﬀerent connections and electricity prices. Sustainable Cities and Society, 21,1–11. Kalavani, F., Mohammadi-Ivatloo, B., & Zare, K. (2019). Optimal stochastic scheduling of cryogenic energy storage with wind power in the presence of a demand response program. Renewable Energy, 130, 268–280. https://doi.org/10.1016/j.renene.2018. 06.070. Kazemi, M., Zareipour, H., Amjady, N., Rosehart, W. D., & Ehsan, M. (2017). Operation scheduling of battery storage systems in joint energy and ancillary services markets. IEEE Transactions on Sustainable Energy, 8(4), 1726–1735. https://doi.org/10.1109/ TSTE.2017.2706563. Kazempour, S. J., Moghaddam, M. P., Haghifam, M. R., & Youseﬁ, G. R. (2009). Risk- constrained dynamic self-scheduling of a pumped-storage plant in the energy and ancillary service markets. Energy Conversion and Management, 50(5), 1368–1375. https://doi.org/10.1016/j.enconman.2009.01.006. Khani, H., Zadeh, M. R. D., & Hajimiragha, A. H. (2016). Transmission congestion relief using privately owned large-scale energy storage systems in a competitive electricity market. IEEE Transactions on Power Systems, 31(2), 1449–1458. https://doi.org/10. 1109/TPWRS.2015.2414937. Kim, T. T., & Poor, H. V. (2011). Scheduling power consumption with price uncertainty. IEEE Transactions on Smart Grid, 2(3), 519–527. Krishnamurthy, D., Uckun, C., Zhou, Z., Thimmapuram, P., & Botterud, A. (2017). Energy storage arbitrage under day-ahead and real-time price uncertainty. IEEE Transactions on Power Systems, 1. https://doi.org/10.1109/TPWRS.2017.2685347. Lin, B., Wu, W., Bai, M., & Xie, C. (2019). Liquid air energy storage: Price arbitrage operations and sizing optimization in the GB real-time electricity market. Energy Economics, 78, 647–655. https://doi.org/10.1016/j.eneco.2018.11.035. Liu, G., Xu, Y., & Tomsovic, K. (2016). Bidding strategy for microgrid in day-ahead market based on hybrid stochastic/robust optimization. IEEE Transactions on Smart Grid, 7(1), 227–237. https://doi.org/10.1109/TSG.2015.2476669. Mohd, A., Ortjohann, E., Schmelter, A., Hamsic, N., Morton, D., Westphalia, S., ... Ring, L. (2008). Challenges in integrating distributed energy storage systems into future smart grid. 2008 IEEE International Symposium on Industrial Electronics, 1627–1632. https:// doi.org/10.1109/ISIE.2008.4676896. Mohsenian-Rad, H. (2016a). Coordinated price-maker operation of large energy storage units in nodal energy markets. IEEE Transactions on Power Systems, 31(1), 786–797. https://doi.org/10.1109/TPWRS.2015.2411556. Mohsenian-Rad, H. (2016b). Optimal bidding, scheduling, and deployment of battery systems in California day-ahead energy market. IEEE Transactions on Power Systems, 31(1), 442–453. https://doi.org/10.1109/TPWRS.2015.2394355. Nagarajan, A., & Ayyanar, R. (2015). Design and strategy for the deployment of energy storage systems in a distribution feeder with penetration of renewable resources. IEEE Transactions on Sustainable Energy, 6(3), 1085–1092. https://doi.org/10.1109/TSTE. 2014.2330294. Nazari-Heris, M., & Mohammadi-Ivatloo, B. (2018). Application of robust optimization method to power system problems. Classical and recent aspects of power system optimi- zation. Elsevier19–32. Nojavan, S., Najaﬁ-Ghalelou, A., Majidi, M., & Zare, K. (2018). Optimal bidding and of- fering strategies of merchant compressed air energy storage in deregulated electricity market using robust optimization approach. Energy, 142, 250–257. https://doi.org/ 10.1016/j.energy.2017.10.028. Nojavan, S., Zare, K., & Mohammadi-Ivatloo, B. (2017). Robust bidding and oﬀering strategies of electricity retailer under multi-tariﬀ pricing. Energy Economics, 68, 359–372. https://doi.org/10.1016/j.eneco.2017.10.027. O’Dwyer, C., Ryan, L., & Flynn, D. (2017). Eﬃcient large-scale energy storage dispatch: Challenges in future high renewables systems. IEEE Transactions on Power Systems, 32(5), 3439–3450. https://doi.org/10.1109/TPWRS.2017.2656245. Qin, J., Sevlian, R., Varodayan, D., & Rajagopal, R. (2012). Optimal electric energy sto- rage operation. IEEE power and energy society general meeting. https://doi.org/10. 1109/PESGM.2012.6345242. Robert, F. C., Sisodia, G. S., & Gopalan, S. (2018). A critical review on the utilization of storage and demand response for the implementation of renewable energy micro- grids. Sustainable Cities and Society, 40(2018), 735–745. https://doi.org/10.1016/j. scs.2018.04.008. Sarker, M. R., Murbach, M. D., Schwartz, D. T., & Ortega-Vazquez, M. A. (2017). Optimal operation of a battery energy storage system: Trade-oﬀ between grid economics and storage health. Electric Power Systems Research, 152, 342–349. https://doi.org/10. 1016/j.epsr.2017.07.007. Shaﬁee, S., Zareipour, H., & Knight, A. M. (2017). Developing bidding and oﬀering curves of a price-maker energy storage facility based on robust optimization. IEEE Transactions on Smart Grid, 10(1), 650–660. https://doi.org/10.1109/TSG.2017. 2749437. Taşcıkaraoğlu, A. (2018). Economic and operational beneﬁts of energy storage sharing for A. Akbari-Dibavar, et al. Sustainable Cities and Society 49 (2019) 101600 8 a neighborhood of prosumers in a dynamic pricing environment. Sustainable Cities and Society, 38, 219–229. https://doi.org/10.1016/j.scs.2018.01.002. Vejdan, S., & Grijalva, S. (2018). The expected revenue of energy storage from energy arbitrage service based on the statistics of realistic market data. 2018 IEEE Texas power and energy conference, 1–6. https://doi.org/10.1109/TPEC.2018.8312055. Wang, Y., Dvorkin, Y., Fernández-Blanco, R., Xu, B., Qiu, T., & Kirschen, D. S. (2017). Look-ahead bidding strategy for energy storage. IEEE Transactions on Sustainable Energy, 8(3), 1106–1127. https://doi.org/10.1109/TSTE.2017.2656800. Wang, Z., Negash, A., & Kirschen, D. S. (2017). Optimal scheduling of energy storage under forecast uncertainties. IET Generation, Transmission & Distribution, 11(17), 4220–4226. Wankmüller, F., Thimmapuram, P. R., Gallagher, K. G., & Botterud, A. (2017). Impact of battery degradation on energy arbitrage revenue of grid-level energy storage. Journal of Energy Storage, 10,56–66. https://doi.org/10.1016/j.est.2016.12.004. Yan, X., Gu, C., Wyman-Pain, H., & Li, F. (2018). Optimal capacity management for multi- service energy storage in market participation using portfolio theory. IEEE Transactions on Industrial Electronics, 66(2), 1598–1607. https://doi.org/10.1109/ TIE.2018.2818670. Zou, P., Chen, Q., Xia, Q., He, G., & Kang, C. (2016). Evaluating the contribution of energy storages to support large-scale renewable generation in joint energy and ancillary service markets. IEEE Transactions on Sustainable Energy, 7(2), 808–818. https://doi. org/10.1109/TSTE.2015.2497283. A. Akbari-Dibavar, et al. Sustainable Cities and Society 49 (2019) 101600 9","libVersion":"0.3.1","langs":""}