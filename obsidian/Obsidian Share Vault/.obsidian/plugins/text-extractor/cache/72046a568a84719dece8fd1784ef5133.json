{"path":"lit/lit_sources/Smith10ModelingLongitudinalData.pdf","text":"Electronic copy available at: http://ssrn.com/abstract=1647530 Modelling Longitudinal Data using a Pair-Copula Decomposition of Serial Dependence Michael Smith 1,★, Aleksey Min 2, Carlos Almeida2 & Claudia Czado2 1. Melbourne Business School, University of Melbourne 2. Zentrum Mathematik, Technische Universit¨at M¨unchen First Version: September 2009 This Version: June 2010 Forthcoming in the Journal of the American Statistical Association, Theory and Methods Section. (Supplementary Materials Also Available) ★ Corresponding author; address for correspondence: Professor Michael Smith, Melbourne Business School, 200 Leicester Street, Carlton, VIC, 3053, Australia. Email: mike.smith@mbs.edu. 1 Electronic copy available at: https://ssrn.com/abstract=1647530Electronic copy available at: http://ssrn.com/abstract=1647530 Modelling Longitudinal Data using a Pair-Copula Decomposition of Serial Dependence Abstract Copulas have proven to be very successful tools for the ﬂexible modelling of cross-sectional dependence. In this paper we express the dependence structure of continuous-valued time series data using a sequence of bivariate copulas. This corresponds to a type of decom- position recently called a ‘vine’ in the graphical models literature, where each copula is entitled a ‘pair-copula’. We propose a Bayesian approach for the estimation of this de- pendence structure for longitudinal data. Bayesian selection ideas are used to identify any independence pair-copulas, with the end result being a parsimonious representation of a time-inhomogeneous Markov process of varying order. Estimates are Bayesian model aver- ages over the distribution of the lag structure of the Markov process. Using a simulation study we show that the selection approach is reliable and can improve the estimates of both conditional and unconditional pairwise dependencies substantially. We also show that a vine with selection out-performs a Gaussian copula with a ﬂexible correlation matrix. The ad- vantage of the pair-copula formulation is further demonstrated using a longitudinal model of intraday electricity load. Using Gaussian, Gumbel and Clayton pair-copulas we identify parsimonious decompositions of intraday serial dependence, which improve the accuracy of intraday load forecasts. We also propose a new diagnostic for measuring the goodness of ﬁt of high-dimensional multivariate copulas. Overall, the pair-copula model is very general and the Bayesian method generalizes many previous approaches for the analysis of longitudinal data. Supplemental materials for the article are also available online. Keywords: Longitudinal Copulas; Covariance Selection; Inhomogeneous Markov Process; D- vine; Bayesian Model Selection; Goodness of Fit; Intraday Electricity Load Electronic copy available at: https://ssrn.com/abstract=1647530 1 Introduction Modelling multivariate distributions using copulas has proven to be highly popular. This is largely due to the ﬂexibility that copula models provide, whereby the marginal distributions can be modelled arbitrarily, and any dependence captured by the copula. Major applica- tions include survival analysis where much early work occurred (Clayton 1978; Oakes 1989), actuarial science (Frees & Valdez 1998) and ﬁnance (Cherubini et al. 2004; Patton 2006); Joe (1997) and Nelsen (2006) provide introductions to copula models and their properties. While there are many copulas from which to choose, only a few are readily applicable to high dimensional problems. Copula built from elliptical distributions, such as the Gaussian (Song 2000) or t (Demarta & McNeil 2005), are most popular in this case. However, these can prove restrictive and in the recent graphical models literature alternative copulas have been proposed that are constructed from series of bivariate copulas (Joe 1996). There are a large number of permutations in which this can be undertaken, and Bedford & Cooke (2002) orga- nize the diﬀerent decompositions in a systematic way. They label the resulting multivariate copulas ‘vines’, while Aas et al. (2009) label the component bivariate copulas ‘pair-copulas’; see Kurowicka & Cooke (2006), Haﬀ et al. (2010) and Czado (2010) for recent overviews. To date copula models have been employed largely to account for cross-sectional de- pendence. Applications to serial dependence in time series and longitudinal data are rare, although the potential is large. Here, the marginal distribution of the process at each point in time can be modelled arbitrarily, while dependence over time is captured by a multivariate copula. Meester & MacKay (1994) and Joe (1997, pp.243-280) provide early examples, while more recent examples include Lambert & Vandenhende (2002), Frees & Wang (2006), Sun et al. (2008) and Domma et al. (2009). However, many of these authors employ multivariate copulas that do not fully exploit the time ordering of the margins. In this paper we aim to show that doing so results in a more ﬂexible representation that is both more insightful and allows for improved estimates for continuous data. We decompose the distribution of a continuous process at a point in time, conditional upon the past, into the product of a sequence of bivariate copula densities and the marginal density. This type of copula is called a D-vine by Bedford & Cooke (2002), where any mix 1 Electronic copy available at: https://ssrn.com/abstract=1647530 of bivariate copulas can be used for the component pair-copulas, resulting in an extremely ﬂexible modelling framework. When the process is Markovian, this can be accounted for by setting appropriate pair-copulas to the independence copula. For longitudinal data this results in a time-inhomogeneous Markov process with order that also varies over time. As we demonstrate here, not only does this produce greater insight into the underlying process, in high-dimensional longitudinal applications this parsimony can also lead to a substantial improvement in the quality of inference. Bedford & Cooke (2002) give the theoretical construction of regular vines, however no estimation of pair-copula parameters is attempted. Kurowicka & Cooke (2006) estimate Gaussian vine copula parameters by minimising the determinant of the correlation matrix. Aas et al. (2009) estimate pair-copula using maximum likelihood for Gaussian and non- Gaussian pair-copulas in both C-vine and D-vines. Min & Czado (2010a) suggest a Bayesian method for the estimation of D-vines using Markov chain Monte Carlo (MCMC). Min & Czado (2010b) use vine copulas to model the dependency among foreign exchange rates using maximum likelihood. In all cases cross-sectional dependence is examined, where the determination of an appropriate ordering of the dimensions for the decomposition remains an open problem. However, for time-ordered data this issue does not arise, and one of the insights of this paper is that a pair-copula decomposition is arguably more appropriate. We suggest a Bayesian approach for the estimation of a pair-copula decomposition for longitudinal data. Indicator variables are introduced to identify which pair-copulas are in- dependence copulas. By doing so, we extend existing Gaussian covariance selection methods to a ﬂexible non-Gaussian framework, both in the longitudinal case (Pourahmadi 1999; Smith & Kohn 2002; Huang et al. 2006; Liu et al. 2009) and more generally. We use a Metropolis-Hastings scheme to generate the indicator variable and dependence parameter(s) of a pair-copula jointly, where the proposal is based on a latent variable representation of the pair-copula parameter(s). The full spectrum of posterior inference is available, including measures of conditional and marginal pairwise dependence. All estimates are model averages over the distribution of the order of the Markov process. We also propose a diagnostic for the quality of ﬁt of a multivariate copula using the distribution of the sum of the transformed 2 Electronic copy available at: https://ssrn.com/abstract=1647530 uniform margins. A simulation study using Gaussian, Gumbel and Clayton pair-copulas highlights the accuracy and reliability of the Bayesian procedure for both the selection and estimation of pair-copulas. The results show that selection can improve the estimated dependence structure, and that the vine copula provides a substantial improvement over the alternative of using a multivariate Gaussian copula; both when the Gaussian copula correlation matrix is unrestricted, or parsimonious in the fashion of Smith & Kohn (2002). We demonstrate the usefulness of the method using a longitudinal model for intraday electricity load in the Australian state of New South Wales. Here, marginal regressions with t disturbances are used with time and weather based covariates and load the previous day. Intraday dependence is captured ﬂexibly using Gaussian, Gumbel and Clayton pair-copulas. A time-varying Markov structure is identiﬁed that is inline with that used in the energy forecasting literature (Cottet & Smith 2003; Soares & Medeiros 2008). We ﬁnd that intraday dependence is nonlinear and better captured using the Gumbel pair-copula model. We demonstrate this using a forecasting study, where the choice of pair-copula type and selection are shown to improve the accuracy of out-of-sample intraday forecasts. The rest of the paper is organised as follows. In Section 2 we outline the pair-copula decomposition of the joint distribution of time-ordered data, along with the resulting likeli- hood for longitudinal data. Section 3 discusses priors, Bayesian estimation and pair-copula selection. Also discussed are measures of conditional and unconditional pairwise dependence, and the diagnostic for the quality of ﬁt. Section 4 contains the simulation study, Section 5 the electricity load example and Section 6 the conclusion. The supplementary materials contain an illustration of a Gaussian D-vine, additional ﬁgures and empirical results for the electricity example and a second empirical example. 2 The Model 2.1 Pair-copula Construction for Time Series Consider a univariate time series X = {X1, . . . , XT } of continuously distributed data ob- served at T possibly unequally-spaced points in time. If the underlying process is Markovian, 3 Electronic copy available at: https://ssrn.com/abstract=1647530 then this can be exploited by selecting models for the conditionals in the decomposition of the joint density of X: f (x) = TY t=2 f (xt∣xt−1, . . . , x1)f (x1) , (2.1) where x = (x1, . . . , xT ). Copulas can be used to construct a general representation for each conditional as follows. For s < t there always exists a density ct,s on [0, 1]2, such that f (xt, xs∣xt−1, . . . , xs+1) = ct,s(F (xt∣xt−1, . . . , xs+1), F (xs∣xt−1, . . . , xs+1); xt−1, . . . , xs+1) × f (xt∣xt−1, . . . , xs+1)f (xs∣xt−1, . . . , xs+1) . (2.2) Here, F (xt∣xt−1, . . . , xs+1) and F (xs∣xt−1, . . . , xs+1) are the conditional distribution func- tions of Xt and Xs, respectively. This is the theorem of Sklar (1959) conditional upon {Xt−1, . . . , Xs+1}. In vine copula models ct,s is simpliﬁed by dropping dependence upon (xt−1, . . . , xs+1) and is called a ‘pair-copula’; see Haﬀ et al. (2010). We adopt this simpliﬁ- cation throughout, and by setting s = 1, application of equation (2.2) gives: f (xt∣xt−1, . . . , x1) = ct,1(F (xt∣xt−1, . . . , x2), F (x1∣xt−1, . . . , x2))f (xt∣xt−1, . . . , x2) . Repeated application with s = 2, 3, . . . , t − 1 leads to the following: f (xt∣xt−1, . . . , x1) = t−2Y j=1 {ct,j(F (xt∣xt−1, . . . , xj+1), F (xj∣xt−1, . . . , xj+1))} × ct,t−1(F (xt), F (xt−1))f (xt) , (2.3) where F (xt) and f (xt) are the marginal distribution function and density of Xt, respectively. We denote ut∣j ≡ F (xt∣xt−1, . . . , xj) and uj∣t ≡ F (xj∣xt, . . . , xj+1), where j < t. They correspond to projections backwards and forwards t − j steps, respectively. By also denoting ut∣t ≡ F (xt), the joint density at equation (2.1) can be written as f (x) = TY t=2 ( t−1Y j=1 \u0000 ct,j(ut∣j+1, uj∣t−1)\u0000 f (xt) ) f (x1) , (2.4) 4 Electronic copy available at: https://ssrn.com/abstract=1647530 which is a product of T marginal densities and T (T − 1)/2 pair-copula densities. Equation (2.4) can be recognised as a ‘D-vine’ and is one of a wider class of vine decom- positions recently discussed in the context of graphical models by Bedford & Cooke (2002) and others. In this literature, the notation used makes the conditioning set explicit; for example, ct,j∣t−1,t−2,...,j+1 would denote the copula density in equation (2.4). This is es- sential for diﬀerentiating between vine decompositions of general vectors X. However, it is not necessary to uniquely identify the pair-copulas of the D-vine decomposition when the elements of X are time-ordered. Throughout the rest of the paper we employ para- metric models for the pair-copulas and write each density as ct,j(u1, u2; \u0000t,j), where \u0000t,j are the parameters. If u = (u1∣1, . . . , uT ∣T ), then c†(u; Θ) = QT t=2 Qt−1 j=1 ct,j(ut∣j+1, uj∣t−1; \u0000t,j) is the density of the multivariate D-vine copula with parameters Θ = {\u0000t,s; (t, s) ∈ ℐ} and ℐ = {(t, s); t = 2, . . . , T, s < t}. In the special case where ct,j are bivariate Gaussian copula densities, Aas et al. (2009) show that c† is the density of a T -dimensional Gaussian copula. The most challenging aspect of the D-vine representation is the evaluation of ut∣j+1 and uj∣t−1 in equation (2.4). The following property (Joe 1996; p.125) proves useful in this regard: Lemma: Let u1 = F (x1∣y) and u2 = F (x2∣y) be conditional distribution functions, and F (x1, x2∣y) = C(u1, u2; \u0000), where C is a bivariate copula function with parameters \u0000, then F (x1∣x2, y) = ℎ(u1∣u2; \u0000) , where ℎ(u1∣u2; \u0000) ≡ ∂C(u1, u2; \u0000) of \u0000t,j, but also of the parameters of other pair-copulas. The recursions give the following algorithm for the evaluation of the values of ut∣j and uj∣t employed in equation (2.4): Algorithm 1 Step (1): For t = 1, . . . , T set ut∣t = F (xt) Step (2): For k = 1, . . . , T − 1 and i = k + 1, . . . , T Backwards Step: ui∣i−k = ℎi,i−k(ui∣i−k+1∣ui−k∣i−1; \u0000i,i−k) Forwards Step: ui−k∣i = ℎi,i−k(ui−k∣i+1∣ui∣i−k+1; \u0000i,i−k) Note that Step (2) involves the evaluation of the T (T −1)/2 functions ℎt,j, for j < t, twice. Table 1 provides analytical expressions of ℎ for some popular bivariate copulas. Figure S1 in the supplementary materials depicts the dependencies between ut∣j, uj∣t resulting from the recursions in Algorithm 1. As an illustration, Part A of the supplementary materials shows how a Gaussian AR(2) can be decomposed into a D-vine using Gaussian pair-copulas and Gaussian margins. 2.2 Conditional Distributions and Simulation From equation (2.5) F (xt∣xt−1, . . . , x1) = ut∣1 = ℎt,1(ut∣2∣u1∣t−1; \u0000t,1), where ut∣2 = F (xt∣xt−1, . . . , x2) is a function of xt, but u1∣t−1 is not. Repeated use of equation (2.5) provides expressions for ut∣2, . . . , ut∣t−1, and by noting that ut∣t = F (xt), the conditional distribution function can be expressed as F (xt∣xt−1, . . . , x1) = ℎt,1 ∘ ℎt,2 ∘ . . . ℎt,t−1 ∘ F (xt) . (2.7) To evaluate ℎt,j(⋅∣uj∣t−1, \u0000t,j), for j = t − 1, . . . , 1, the values u1∣t−1, . . . , ut−1∣t−1 also need computing, which can be obtained by running Algorithm 1, but with T = t. The expression at equation (2.7) can be used to provide the eﬃcient algorithm below for simulating from D-vine via the method of composition. We simulate T independent uniforms w1, . . . , wT , and compute x1 = F −1(w1) and xt = F −1(wt∣xt−1, . . . , x1) for t = 2, . . . , T , so that x has the density at equation (2.4) and u that of c†. Algorithm 2 For t = 1, . . . , T : Step (1): Generate wt ∼ Uniform(0, 1) 6 Electronic copy available at: https://ssrn.com/abstract=1647530 Step (2): If t = 1 set x1 = F −1(w1), otherwise set xt = F −1 ∘ ℎ −1 t,t−1 ∘ . . . ∘ ℎ −1 t,1 (wt) Step (3): Set ut∣t = F (xt), and if t > 1 compute: ut∣j = ℎt,j(ut∣j+1∣uj∣t−1; \u0000t,j) for j = t − 1, . . . , 1 uj∣t = ℎt,j(uj∣t−1∣ut∣j+1; \u0000t,j) for j = 1, . . . , t − 1 The functions ℎ −1 t,j are easily computed either analytically or numerically for commonly used copula; see Table 1. Moreover, Algorithm 2 can be adjusted to produce an iterate from the conditional distribution F (xT , xT −1, . . . , xt0+1∣xt0, . . . , x1) simply by skipping Steps (1) and (2) for t = 1, . . . , t0, but not Step (3). This can be useful in computing forecasts, particularly when the vector is longitudinal as we demonstrate in Section 5. Both Kurowicka & Cooke (2007) and Aas et al. (2009) give algorithms that are equivalent to Algorithm 2, although the former do not provide an expression for the conditional distribution function, while that of the latter is less succinct. 2.3 Longitudinal Data and Pair-Copula Selection While the decomposition at equation (2.4) provides a ﬂexible representation for time series data generally, we focus here on the longitudinal case. That is, where there are n independent observations x = {x1, . . . , xn} on a dependent time series vector xi = (xi,1, . . . , xi,T ). In the case where the number of pair-copulas, T (T − 1)/2, is large compared to the number of scalar observations nT , it can prove hard to obtain reliable estimates without imposing strong restrictions, and thus a data-driven method that allows for parsimony is useful. Following Smith & Kohn (2002) we introduce indicator variables Γ = {\u0000t,s; (t, s) ∈ ℐ}, so that ct,s(u1, u2; \u0000t,s) = 1 iﬀ \u0000t,s = 0 ct,s(u1, u2; \u0000t,s) = c★ t,s(u1, u2; \u0000t,s) iﬀ \u0000t,s = 1. (2.8) In the above c★ t,s is a pre-speciﬁed bivariate copula density, such as a Gaussian, t, Gumbel or Clayton. While there is no reason why the pair-copula cannot vary with (t, s), for simplicity we assume c★ t,s are all of the same form in our empirical work and therefore drop the subscripts of the copula density c★ and corresponding distribution function C ★. When \u0000t,s = 0 the copula is the independence copula Ct,s(u1, u2; \u0000t,s) = u1u2, and implies 7 Electronic copy available at: https://ssrn.com/abstract=1647530 that ℎt,s(u1∣u2; \u0000t,s) = u1. Therefore, Γ determines the form of the time series dependency. For example, if \u0000t,s = 0 for all s ≤ t − p, then f (xt∣xt−1, . . . , x1) = f (xt∣xt−1, . . . , xt−p) and the process is Markov of order p. In general, Γ determines a parsimonious dependence structure that can vary with time t, extending antedependent models for longitudinal data (Gabriel 1962; Pourahmadi 1999; Smith & Kohn 2002) and covariance selection for Gaussian copulas (Pitt et al. 2006). The likelihood f (x∣Θ, Γ) = Qn i=1 f (xi∣Θ, Γ), where f (xi∣Θ, Γ) = TY t=2 (t−1Y j=1 \u0000\u0000c★(ui,t∣j+1, ui,j∣t−1; \u0000t,j)\u0000\u0000t,j \u0000 f (xi,t) ) f (xi,1) . Here, the conditional copula data ui,t∣j+1 = F (xi,t∣xi,t−1, . . . , xi,j+1) and ui,j∣t−1 = F (xi,j∣xi,t, . . . , xi,j+1) are computed using Algorithm 1 applied separately to each observation xi. The following adjustment to Step (2) of Algorithm 1 can be employed: ℎi,i−k(u1∣u2; \u0000i,i−k) = u1 if \u0000i,i−k = 0 ℎi,i−k(u1∣u2; \u0000i,i−k) = ℎ ★(u1∣u2; \u0000i,i−k) ≡ ∂ 3 Bayesian Inference 3.1 Priors The prior on Γ can be chosen to represent a preference for shorter Markov orders by setting the marginal priors \u0000(\u0000t,s = 1) ∝ \u0000(t−s), for 0 < \u0000 < 1. Similarly, an informative prior can be used to ensure that \u0000t,s = 0 if \u0000t,s−1 = 0. However, in our empirical work we do neither and place equal marginal prior weight upon each indicator. As observed by Kohn et al. (2001) such a prior can still prove highly informative when N = T (T − 1)/2 is large. For example, if KΓ = P (t,s)∈ℐ \u0000t,s is the number of non-zero elements of Γ, then assuming the ﬂat prior \u0000(Γ) = 2−N puts very high prior weight on values of Γ which have KΓ ≈ N/2. To avoid this, beta priors can be employed (Kohn et al. 2001; Liu et al. 2009), although we adopt the prior \u0000(Γ) = 1 3.2 Sampling Scheme Given the margins, we generate iterates from the joint posterior f (Γ, Θ∣x) by introducing latent variables ˜\u0000t,s, for (t, s) ∈ ℐ, such that \u0000t,s = ˜\u0000t,s iﬀ \u0000t,s = 1. Following the deﬁnition of the indicator variables in equation (2.8), the pair-copula ct,s is known exactly from (˜\u0000t,s, \u0000t,s). The prior \u0000(˜\u0000t,s∣\u0000t,s = 1) ∝ \u0000(\u0000t,s∣\u0000t,s = 1), and we assume prior independence between the latent and indicator variables, so that \u0000( ˜Θ, Γ) = \u0000(Γ) Q (t,s)∈ℐ \u0000(˜\u0000t,s), with ˜Θ = {˜\u0000t,s; (t, s) ∈ ℐ}. We evaluate the posterior distribution using MCMC. The sampling scheme consists of Metropolis-Hastings (MH) steps that traverse the latent and indicator variable space by generating each pair (˜\u0000t,s, \u0000t,s), one at a time for t = 2, . . . , T and s = 1, . . . , t − 1. In the case where the pair-copula has a single dependence parameter, we adopt a MH pro- posal with density q that is independent in \u0000t,s and ˜\u0000t,s, so that q(˜\u0000t,s, \u0000t,s) = q1(\u0000t,s)q2(˜\u0000t,s). When there are multiple dependence parameters for a pair-copula, we simply generate each parameter independently in the same manner. Kohn et al. (2001) and Nott & Kohn (2005) compare the relative eﬃciency of a number of choices for q1 in the regression variable selection problem. In this paper we consider two choices for q1. The ﬁrst corresponds to the simple proposal q1(\u0000t,s = 1) = q1(\u0000t,s = 0) = 1/2, while the second is Sampling Scheme 2 proposed by Kohn et al. (2001). This was the most computationally eﬃcient scheme suggested by the authors, and employs the conditional prior at equation (3.1) as the proposal. For clarity, we label these two sampling schemes SS1 and SS2, respectively. In both cases we use a random walk proposal for q2, with ˜\u0000t,s generated using a t-distribution with d degrees of freedom and scale \u00002. Dropping the subscripts for notational convenience, the new iterate (˜\u0000new, \u0000 new) is accepted over the old (˜\u0000old, \u0000 old) with probability min(1, \u0000R), where R is an adjustment due to any bounds on the domain of \u0000. We denote the conditional prior at equation (3.1) for the case when \u0000 = 1 as \u00001, and \u00000 = 1 − \u00001. If the likelihood in Section 2.3 is denoted as a function of the element (˜\u0000, \u0000) as L(˜\u0000, \u0000), then \u0000 can be computed for the four diﬀerent combinations of \u0000 old and \u0000 new as: \u000000 ≡ \u0000 \u0000 (\u0000 old = 0, ˜\u0000old) → (\u0000 new = 0, ˜\u0000new)\u0000 = \u0000(˜\u0000new) \u000001 ≡ \u0000 \u0000 (\u0000 old = 0, ˜\u0000old) → (\u0000 new = 1, ˜\u0000new)\u0000 = L(˜\u0000new, \u0000 new = 1)\u0000(˜\u0000new)\u00001results are from SS1. We assess convergence by checking our estimates are invariant to diﬀerent initial conditions, and employ sample sizes between J = 20, 000 and J = 50, 000. Because in our analysis we consider diﬀerent pair-copula families it is important to mea- sure dependence on a common metric. There is an extensive literature on measures of concordance, with a comprehensive summary given by Nelsen (2006; Chapter 5). We mea- sure the level of dependence in each pair-copula using Kendall’s tau. For each pair (t, s) ∈ ℐ this can be expressed (Nelsen 2006; p.159) as \u0000t,s = 4 Z 1 0 Z 1 0 Ct,s(u1, u2; \u0000t,s)dCt,s(u1, u2; \u0000t,s) − 1 . For the independence copula \u0000t,s = 0, while Kendall’s tau can be expressed as a function of \u0000t,s for many common bivariate copula (Embrechts et al. 2003); for the Gaussian \u0000t,s = arcsin \u0000 2 3.4 Diagnostic Currently, there are only a few approaches for judging the adequacy of the ﬁt of a multivariate copula; for example, Glidden (2007) proposes diagnostics based upon pairwise dependence. We consider the sum S(Θ) = PT j=1 Φ −1(Uj), where U has a multivariate copula as a dis- tribution function. The sum S is both highly sensitive to the dependence structure of the copula and comparable across diﬀerent copulas. From a Bayesian perspective, we consider the ﬁtted distribution f (S∣x) = R f (S∣Θ)f (Θ∣x)dΘ, where the parameters are integrated out with respect to their posterior distribution. For a Gaussian copula, f (S∣Θ) can be shown to be a Gaussian density, and f (S∣x) ≈ 1 Model A: The dependence structure of a Gaussian AR(1) with autoregressive coeﬃcient 0.85 and unit variance disturbances. In this case \u0000t,t−1 = 1, \u0000t,s = 0 for t−s > 1, and \u0000t,t−1 = 0.85. Figure 1(a) depicts the resulting values of \u0000t,s for each pair-copula when T = 7. Model B: Clayton pair-copula model with \u0000t,s = 1 for all t − s ≤ 2, and zero otherwise. This corresponds to a second order time-inhomogeneous Markov process, with dependence parameters set so that the values of \u0000t,s for each pair-copula are as depicted in Figure 1(b) when T = 7. Model C: Gumbel pair-copula model with dependence parameters set so that the values of \u0000t,s for each pair-copula are as depicted in Figure 1(c) when T = 7. This speciﬁes a time-inhomogeneous Markov process with varying order. When T = 14 the designs are direct extensions, and Figure S2 in the supplementary materials depicts the values of \u0000t,s for each pair-copula. We ﬁt the following estimators to each dataset: Estimators E1s/E1f: Estimation using the correctly speciﬁed pair-copula type and with/without selection, where the latter corresponds to assuming \u0000t,s = 1 for (t, s) ∈ ℐ. Estimator E2s/E2f: Estimation using an incorrectly speciﬁed pair-copula type (Clayton for Model A; Gumbel for Model B; and Gaussian for Model C) and with/without selection. Estimator E3: Estimation with a Gaussian copula constructed from Gaussian pair-copulas without selection. Estimator E4: Estimation with a Gaussian copula with ﬂexible correlation matrix based upon the prior and method of Smith & Kohn (2002). Estimator E3 employs ﬂat priors on the parameters of the Gaussian pair-copulas. Es- timator E4 corresponds to ﬁtting a N(0, Σ) distribution to the transformed copula data x ★ i,j = Φ −1(ui,j), where ui,j ∈ [0, 1] is the ith observation of the copula data from the jth margin. The covariance selection prior and method outlined in Smith & Kohn (2002) are used, but where the ﬁtted Gaussian copula is based on the posterior mean of the correlation 14 Electronic copy available at: https://ssrn.com/abstract=1647530 matrix diag(Σ)−1 Σ diag(Σ)−1. We note that estimators E1f and E3 coincide for Model A, and E2f and E3 coincide for Model C. Figure 1 provides a summary of the reliability of the pair-copula selection procedure of estimator E1s when T = 7. To quantify this, for each pair-copula we compute the mean posterior probability of being dependent over the simulation ¯Pt,s = 1 The second summary is the width ˆw(\u0000t,s) of the 90% posterior probability interval for \u0000t,s, deﬁned for each dataset as follows. Order the iterates {\u0000t,s(\u0000[1] t,s), . . . , \u0000t,s(\u0000[J] t,s )} from smallest to largest, and then compute the Monte Carlo estimate of the interval by counting oﬀ the lower and upper 5% of the iterates. The mean width, computed across pair-copulas and simulation replicates, is reported over all pair-copulas and also broken down by pair- copula type. Estimator E1s has substantially lower widths than the other estimators, and by at least an order of magnitude for the independence pair-copulas, again suggesting that the selection methodology is working well. For the selection estimators E1s and E2s, the posterior distribution of \u0000t,s has a sizable point mass at 0 for many (t, s) ∈ ℐ. Consequently, posterior intervals of \u0000t,s for diﬀerent probabilities can be indistinguishable, inﬂating the coverage statistics and making them uninformative, so that we do not report them here. To assess the accuracy of the estimation of the unconditional dependence structure we also compute the MAB for the marginal pairwise Spearman’s correlations \u0000s,t. For Model A, estimators E1, E3 and E4 all ﬁt Gaussian copulas, which are the correct parametric form for this model. Nevertheless, the ﬂexible estimators E1s and E4 which employ Bayesian selection methodologies provide the best results. However, selection based on the D-vine decomposition is superior to that based on the Cholesky decomposition employed by Smith & Kohn (2002). Moreover, E1s dominates E4 in all three models. The standard errors in Table 2 show that the diﬀerences between estimator performance are signiﬁcant. Overall, the simulation suggests that the selection method works well, and can improve both the estimated conditional and unconditional dependence structure. In every case, selection with the correct pair-copula family substantially out-performs all alternatives. Throughout, the pair-copula model substantially out-performs the common alternative of ﬁtting a Gaussian copula, with or without a ﬂexible correlation matrix. 5 New South Wales Intraday Electricity Load Modelling and forecasting electricity load at an intraday resolution is an important problem faced by all electricity utilities; see Soares & Medeiros (2008) for a recent overview. When observed intraday, load has both strong periodic behaviour and meteorologically induced 16 Electronic copy available at: https://ssrn.com/abstract=1647530 variation (Pardo et al. 2002). Numerous models have been proposed for intraday load, but some of the most successful are longitudinal (Cottet & Smith 2003) because they allow all aspects of the model to vary diurnally. We model electricity load in New South Wales (NSW) observed between 2 January 2002 and 2 January 2005 in MegaWatt hours (MWh). The data were used previously by Panagiotelis & Smith (2008), who employ a longitudinal model with multivariate Gaussian disturbances over the day. We also use a longitudinal model, but where the intraday dependence is captured by a more ﬂexible pair-copula formulation. For every hour (t = 1, . . . , 24) load Li,t on day i is modelled with the marginal regression Li,t = \u00001 t + \u00002 t i + \u0000′ tzi,t + \u00003 t ∣Ti,t − 18.3∣ + \u0000tLi−1,t + \u0000i,t , (5.1) where {\u00001,t, . . . , \u0000n,t} are t distributed with scale \u00002 t and degrees of freedom \u0000t. The coeﬃcients \u00001 t and \u00002 t measure level and linear time trend, \u0000t captures inter-day linear correlation, and zi,t is a vector containing the 12 seasonal polynomials and 14 day type dummy variables listed in Panagiotelis & Smith (2008). The eﬀect of air temperature 1 Ti,t is nonlinear with a minimum at 18.3C (65F), which is a commonly employed functional form in the demand modelling literature (Pardo et al. 2002). Each of the T = 24 marginal models is estimated using maximum likelihood. Residual plots show that the regressions remove the strong signal in the load data, and quantile plots indicate that the marginal t distribution in equation (5.1) is appropriate. Figure S3 in the supplementary materials plots the estimates of \u0000t and \u0000t. To account for the strong intraday dependence a pair-copula decomposition with xi = (Li,1, . . . , Li,24)′ is used, where the ﬁrst element corresponds to load at 03:30, which is the approximate time of the overnight low in demand. We ﬁrst employ Gaussian pair-copulas and selection, which produces strong positive dependencies between load at times t and t−1, with Pr(\u0000t,t−1 = 1∣x) ≈ 1 throughout, and 0.51 ≤ E(\u0000t,t−1∣x) ≤ 0.78. The dependence structure is sparse, with Pr(\u0000t,s = 1∣x) < 0.5 for 212 of the N = 276 pair-copulas, and Figure S4 in the supplementary materials presents the estimated vine in full. We also employ Gumbel pair-copulas with selection. The Gumbel admits only positive dependence, but has proven particularly successful in modeling the bivariate dependence of ﬁnancial returns. Figure 2 plots the estimates of Pr(\u0000t,s = 1∣x) in panel (a) and E(\u0000t,s∣x) in panel (b). As with the Gaussian pair-copula vine, strong dependencies between loads at time t and t − 1 are captured, although the dependence structure is more sparse, with Pr(\u0000t,s = 1∣x) < 0.5 for 243 of the Gumbel pair-copulas. To judge the adequacy of diﬀerent copulas we employ the diagnostic based on the distri- bution of the sum discussed in Section 3.4. However, as our empirical benchmark we employ the copula data ui,t = T\u0000((Li,t − ˆLi,t; ˆ\u0000t), where T\u0000(⋅; \u0000) is a t distribution function with scale \u0000 and \u0000 degrees of freedom, computed over a 210 day long forecast period 3 January to 31 July 2005, so that i = n, . . . , (n + 210). These are the marginal predictive distributions with parameter values estimated from the in-sample data, but evaluated at the out-of-sample data points. Figure 3 plots KDEs constructed from the thinned Monte Carlo samples of S for vine copulas constructed from Gaussian, Gumbel and Clayton pair-copulas with and without selection. These are the Bayesian estimates of the ﬁtted distribution f (S∣x). Also plotted is the distribution of S based on an assumption of independence, and that observed empirically over the forecast period. Ignoring the intraday dependence in the data leads to substantial under-statement of future variation in the sum. This translates directly into an under-statement in the variation of future daily total load, a quantity that is also important to electricity utilities. All three pair-copula models improve substantially on this benchmark; however, the Gaussian and Gumbel pair-copula models appear to be more inline with the observed load than the Clayton. To further compare the three pair-copula models, we undertake a small intraday fore- casting trial. We use a daily rolling window over the period 3 to 30 January 2005, and set T = 12, so that each margin corresponds observations at two hour intervals. Intraday forecasts are essential for eﬀective system management by electricity utilities. Forecasts for peak periods are typically made at mid-morning, and are much more accurate than those made prior to 09:00 (Cottet & Smith 2003). The forecasts are constructed by evaluating the distribution F (Li,12, . . . , Li,ℎ+1∣Li,ℎ, . . . , Li,1), where Θ is integrated out with respect to f (Θ∣x) and ℎ = 4 in our work, which corresponds to 09:30. To evaluate this conditional 18 Electronic copy available at: https://ssrn.com/abstract=1647530 distribution we append Algorithm 2 to the end of the sampling scheme, but skip Steps (1) and (2) for t ≤ ℎ. Using the predictive means as forecasts, Table 3 reports the mean absolute deviation (MAD) and mean squared error (MSE) for all three vine copulas. The Gumbel pair-copula model produces the most accurate forecasts, and selection improves the forecasts throughout, showing the usefulness of a data-based parsimonious model here. Capturing in- traday dependence is important, with all copula models out-performing the marginal models substantially. The forecasts show there is a substantial diﬀerence between vines constructed from diﬀer- ent pair-copulas. To further illustrate this, Figure 4 plots contours of the marginal bivariate distributions of load at 09:30 along with load at 11:30, 13:30, 15:30 and 17:30 on 3 January 2005. This is estimated by simulating iterates from the Gumbel pair-copula model with Θ integrated out with respect to f (Θ∣x) in a Monte Carlo fashion. The four distributions are highly non-elliptical and pairwise dependence is nonlinear. 6 Discussion We argue in this paper that pair-copula constructions, and in particular the D-vine, are suit- able for the modeling of longitudinal data, where the time-ordering of the data is exploited. This is unlike the graphical models case, where establishing an ordering of the margins is often diﬃcult. Bivariate Archimedean copulas (Genest & Rivest 1993), t copulas (Demarta & McNeil 2005) and skew t copulas (Smith et al. 2010) are promising choices of pair-copula, with the resulting D-vines capturing serial dependence in a more ﬂexible manner than multi- variate elliptical copula. Our approach extends the current literature on covariance modeling for longitudinal data from the Gaussian case (Smith & Kohn, 2002; Huang et al. 2006; Lev- ina et al 2008) to a wide range of non-Gaussian situations. Ibragimov & Lentzas (2008) and Domma et al. (2009) both construct time series models using bivariate copulas to capture serial dependence. However, these are ﬁrst order Markov models, where the resulting multi- variate copula are not recognized as D-vines, and inference for higher order Markov models is not considered. Our method extends the Bayesian selection approach of Pitt et al. (2006) for Gaussian 19 Electronic copy available at: https://ssrn.com/abstract=1647530 copula, and also of Smith & Kohn (2002) when applied to the correlation matrix of a Gaussian copula. We show in our empirical work that the approach is highly reliable in identifying any parsimony in the conditional dependence structure, and provides more eﬃcient estimates of both conditional and marginal pairwise dependencies when such parsimony exists. The practical beneﬁts are demonstrated by the substantial improvement in forecasts that are obtained in the electricity load example. Bayesian selection is particularly appropriate for computing inference when the data have the potential to exhibit Markovian properties, by allowing exploration of the high dimensional model space. We mention here that because Algorithm 1 has to be run in its entirety to evaluate the likelihood, estimation of the D-vine for higher values of T is computationally burdensome. This is particularly the case when the pair-copula densities and corresponding ℎ functions involve more computations to evaluate. However, if the dependence structure is parsimonious, so that \u0000t,s = 0 for many (t, s) ∈ ℐ, estimation can be substantially faster. Alternative shrinkage methods (Huang et al. 2006; Levina et al. 2008) also have potential for the eﬃcient estimation of vine copula models. While modelling serial dependence is our objective, we note here that vine copula models have also been used to model cross-sectional dependence (Aas et al. 2009; Min & Czado 2010a; Czado et al. 2009). Recent work by Haﬀ et al. (2010) suggests that vine copulas can account for a wide range of dependence, including that exhibited by elliptical copulas. Our Bayesian selection method can be used to estimate other vines as well. However, in the cross-sectional case the method identiﬁes a parsimonious multivariate dependence structure, without the interpretation that is possible when using a D-vine to model serial dependence. Acknowledgments The work of Michael Smith was partially supported by Australian Research Council Grant DP0985505. Claudia Czado and Carlos Almeida gratefully acknowledge the ﬁnancial sup- port from the Deutsche Forschungsgemeinschaft (Cz 86/1-3: Statistical inference for high dimensional dependence models using pair-copulas). The authors thank three referees and associate editor, all of whom made comments that improved the paper. 20 Electronic copy available at: https://ssrn.com/abstract=1647530 7 Supplemental Materials Part A An illustration of how a Gaussian AR(2) model can be represented as a D-vine. Part B Second empirical example using cow liveweight data which has a low sample size and uses t pair-copulas. Part C Additional ﬁgures and tables numbered with preﬁx ‘S’. Part D Data ﬁles for the two real data examples. 21 Electronic copy available at: https://ssrn.com/abstract=1647530 References Aas, K., C. Czado, A. Frigessi & H. Bakken, (2009), ‘Pair-copula constructions of multiple dependence’, Insurance: Mathematics and Economics, 44, 2, 182-198. Bedford, T. & R. Cooke, (2002), ‘Vines - a new graphical model for dependent random variables’, Annals of Statistics, 30, 1031-1068. Cherubini, U. Luciano, E. & Vecchiato, W., (2004), Copula methods in ﬁnance, Wiley. Clayton, D., (1978), ‘A model for association in bivariate life tables and its application to epidemiological studies of family tendency in chronic disease incidence’, Biometrika, 65, 141-151. Cottet, R., & M. Smith, (2003), ‘Bayesian modeling and forecasting of intraday electricity load’, Journal of the American Statistical Association, 98, 839-849. Cripps, E., C. Carter & R. Kohn, (2005), ‘Variable Selection and Covariance Selection in Multivariate Regression Models’, in D. Dey & C. Rao, (eds.), Handbook of Statistics 25 Bayesian Thinking: Modeling and Computation, Elsevier: North Holland, 519-552. Czado, C., (2010), ‘Pair-copula constructions of multivariate copulas’ in F. Durante, W. H¨ardle, P. Jaworki & Rychlik, T. (Eds.) Workshop on Copula Theory and its Applications, Springer: Dortrecht, to appear. Czado, C., F. G¨artner & A. Min (2009), ‘Analysis of Australian electricity loads using joint Bayesian inference of D-vines with autoregressive margins’ in Kurowicka, D. & H. Joe (eds.) Dependence Modeling - Handbook on Vine Copulae, to appear. Daniels, M. & M. Pourahmadi, (2009), ‘Modeling covariance matrices via partial autocorre- lations’, Journal of Multivariate Analysis, in press. Demarta, S. & A. McNeil, (2005), ‘The t-copula and related copulas’, International Statistical Review, 73, 111-129. Domma, F., S. Giordano, & P. Perri, (2009), ‘Statistical Modeling of Temporal Dependence in Financial Data via a Copula Function’, Communications in Statistics, 38, 703-728. Embrechts, P., F. Lindskog, A. McNeil, (2003), ‘Modelling dependence with copulas and ap- plications to risk management’, In: S. Rachev (ed.), Handbook of Heavy Tailed Distributions in Finance. North-Holland: Elsevier. Frees, E. & P. Wang, (2006), ‘Copula credibility for aggregate loss models’, Insurance Math- ematics & Economics, 38, 360-373. Frees, E. & E. Valdez, (1998), ‘Understanding Relationships Using Copulas’, North American Actuarial Journal, 2, 1, 1-25. Gabriel, K., (1962), ‘Ante-dependent analysis of an ordered set of variables’, Ann. Math. Statist., 33, 201-212. 22 Electronic copy available at: https://ssrn.com/abstract=1647530 Genest, C. & L.-P. Rivest, (1993), ‘Statistical Inference Procedures for Bivariate Archimedean Copulas’, Journal of the American Statistical Association, 88, 1034-1043. Glidden, D., (2007), ‘Pairwise dependence diagnostics for clustered failure-time data’, Biometrika, 94, 371-385. Haﬀ, I., K. Aas & A. Frigessi, (2010), ‘On the simpliﬁed pair-copula construction- Simply useful or too simplistic?’, Journal of Multivariate Analysis, 101, 1296-1310. Huang, J., N. Liu, M. Pourahmadi & Liu, L. (2006), ‘Covariance matrix selection and estimation via penalised normal likelihood’ Biometrika, 93, 85-98. Ibragimov, R. & G. Lentzas, (2008), ‘Copulas and Long Memory’, Harvard Institute of Economics Research Discussion Paper Number 2160. Joe, H., (1996), ‘Families of m-variate distributions with given margins and m(m-1)/2 bi- variate dependence parameters’, In: L. R¨uschendorf, B. Schweizer & M. Taylor, (Eds.), Distributions with Fixed Marginals and Related Topics. Joe, H., (1997), Multivariate Models and Dependence Concepts, Chapman and Hall. Joe, H., (2006), Generating random correlation matrices based on partial correlations’, Jour- nal of Multivariate Analysis, 71, 2177-2189. Kohn, R., M. Smith & C. Chan, (2001), ‘Nonparametric regression using linear combinations of basis functions’, Statistics and Computing, 11, 313-322. Kurowicka, D. & R. Cooke, (2006), Uncertainty Analysis with High Dimensional Dependence Modelling, Wiley: New York. Kurowicka, D. & R. Cooke, (2007), ‘Sampling algorithms for generating joint uniform dis- tributions using the vine-copula method’, Computational Statistics and Data Analysis, 51, 2889-2906. Lambert, P. & F. Vandenhende, (2002), ‘A copula-based model for multivariate non-normal longitudinal data: analysis of a dose titration safety study on a new antidepressant’, Statistics in Medicine, 21, 3197-3217. Levina, E., A. Rothman & J. Zhu, (2008), ‘Sparse Estimation of Large Covariance Matrices via a Nested Lasso Penalty’, Annals of Applied Statistics, 1, 245-263. Liu, X., M. Daniels & B. Marcus, (2009), ‘Joint Models for the Association of Longitudinal Binary and Continuous Processes with Application to a Smoking Cessation Trial’, Journal of the Americian Statistical Association, 104, 429-438. Meester, S. & J. MacKay, (1994), ‘A Parametric Model for Cluster Correlated Categorical Data’, Biometrics, 50, 954-963. Min, A., & C. Czado, (2010a), ‘Bayesian inference for multivariate copulas using pair-copula constructions’, Journal of Financial Econometrics, in press. 23 Electronic copy available at: https://ssrn.com/abstract=1647530 Min, A., & C. Czado, (2010b), ‘SCOMDY Models based on Pair-copula Constructions with Application to Exchange Rates’, working paper. Nelsen, R., (2006), An Introduction to Copulas, 2nd ed., New York: NY: Springer. Nott, D. & R. Kohn, (2005), ‘Adaptive sampling for Bayesian variable selection’, Biometrika, 92, 747-763. Oakes, D., (1989), ‘Bivariate Survival Models Induced by Frailties’, Journal of the American Statistical Association, 84, 487-493. Panagiotelis, A. & M. Smith, (2008), ‘Bayesian identiﬁcation, selection and estimation of semiparametric functions in high-dimensional additive models’, Journal of Econometrics, 143, 291-316. Patton, A., (2006), ‘Modelling Asymmetric Exchange Rate Dependence’, International Eco- nomic Review, 47, 527-556. Pardo, A., V. Meneu & E. Valor, (2002). ‘Temperature and seasonality inﬂuences on Spanish electricity load’, Energy Economics, 24, 55-70. Pitt, M., D. Chan & R. Kohn (2006), ‘Eﬃcient Bayesian Inference for Gaussian Copula Regression Models’, Biometrika, 93, 537-554. Pourahmadi, M., (1999), ‘Joint mean-covariance models with applications to longitudinal data: Uncontrained parameterisation’, Biometrika, 86, 677-69. Silva, R. & H. Lopes, (2008), ‘Copula, marginal distributions and model selection: a Bayesian note’, Statistics and Computing, 18, 313-320. Sklar, A. (1959), ‘Fonctions de r´epartition `a n dimensions et leurs marges’, Publications de l’Institut de Statistique de L’Universit de Paris, 8, 229-231. Smith, M. & R. Kohn, (2002), ‘Parsimonious Covariance Matrix Estimation for Longitudinal Data’, Journal of the American Statistical Association, 91, 460, 1141-1153. Smith, M., Q. Gan & R. Kohn, (2010), ‘Modeling Dependence using Skew t Copulas: Bayesian Inference and Applications’, working paper. Soares, L. & M. Medeiros, (2008), ‘Modeling and forecasting short-term electricity load: A comparison of methods with an application to Brazilian data’, International Journal of Forecasting, 24, 630-644. Song, P. (2000), ‘Multivariate Dispersion Models Generated from Gaussian Copula’, Scan- dinavian Journal of Statistics, 27, 305-320. Sun, J., E. Frees & M. Rosenberg, (2008), ‘Heavy-tailed longitudinal data modeling using copulas’, Insurance Mathematics and Economics, 42, 817-830. 24 Electronic copy available at: https://ssrn.com/abstract=1647530 (a) 0.65 0 0 0.65 0 0 0.65 0 0 0.65 0 0 0.65 0 0 0.65 1 2 3 4 5 6765432 (b) 0.9 0 0 0.8 0 0 0.7 0 0 0.95 0.4 0 0 0.8 0.75 0 0.3 1 2 3 4 5 6765432 (c) 0.9 0 0 0.8 0 0 0.6 0 0 0.95 0.4 0 0 0.8 0 0 0.3 1 2 3 4 5 6765432 (d) 1 0.14 0 0.16 0 0.14 0 0.14 0 0.15 0 1 2 3 4 5 6765432 (e) 1 0.05 0 0.99 0 0.06 0 0.06 0 0 1 2 3 4 5 6765432 (f) 1 0.94 0 0.01 0 0.02 0 0.02 0 0.01 0 0.97 1 2 3 4 5 6765432 (g) −0.01 0 0 0 −0.01 0 0 −0.01 0 0 −0.01 0 0 −0.01 1 2 3 4 5 6765432 (h) 0 0 −0.01 0 0 −0.01 0 0 0 0 1 2 3 4 5 6765432 (i) 0 −0.02 0 0 0 −0.01 0 0 0 0 1 2 3 4 5 6765432 Figure 1: Simulation design when T = 7 and results for estimator E1s, with the three columns of panels corresponding to Models A, B and C, respectively. Panels (a)-(c) plot the true values of \u0000t,s for the models in each row t and column s of each panel. Panels (d)-(f) plot the values of ¯Pt,s deﬁned in Section 4 in row t and column s of each panel. Panels (g)-(i) plot the estimated bias values ˆb(\u0000t,s) in row t and column s of each panel. Throughout, darker cells correspond to higher absolute values, lighter cells to lower absolute values and transparent cells to zero. 28 Electronic copy available at: https://ssrn.com/abstract=1647530(a)s t0.900.0400.06000.900.20.04000.990.20.0100.01000.9900.0200.0100.0200.90.96000.9900.8600.2100.7100.03000.1900.030.200.8500.7100.2100.2100.02000.9600.0300.02000.9500.0400.0200.1100.9500.08000.36000.90.0200.0100.03000.9600.070.10.09000.9200.09000.9100.92000.9500.01000.0300.93000.93000.9600.91000.95001234567891011121314151617181920212223 24232221201918171615141312111098765432(b)s t0.63000.5700.01000.600.13000.6500.06000.5800.0600.0100.0500.0100.03000.4700.0100.0500.050.10.0600.68000.68000.7100.02000.3500.01000.28000.69000.7200.01000.6500.01000.5800.08000.63000.64000.64000.65000.6500.0200.64000.66000.721234567891011121314151617181920212223 24232221201918171615141312111098765432Figure2:Gumbelpair-copulaestimatesfortheNSWelectricityexample.Panel(a)depictstheprobabilitiesPr(\u0000t,s=1∣x),andpanel(b)theestimatedposteriormeansE(\u0000t,s∣x),inrowtandcolumns.Inbothpanels,higherabsolutevaluescorrespondtodarkercellsandlowerabsolutevaluescorrespondtolightercells. 29 Electronic copy available at: https://ssrn.com/abstract=1647530 -60 -40 -20 0 20 40 600.000.020.040.060.08DensityIndependent Observed Gaussian Clayton Gumbel Figure 3: Distributions of diagnostic S for the NSW electricity load example. The solid line corresponds to an assumption of intraday independence, while the distribution of the em- pirically observed data is given by the dashed (red) line. The distributions corresponding to the three parametric pair-copula models are also shown with line types (colors) as indicated. 30 Electronic copy available at: https://ssrn.com/abstract=1647530 Load at 9:30Load at 11:30 7.2 7.4 7.6 7.8 8.07.67.88.08.28.48.6 Load at 9:30Load at 13:30 7.2 7.4 7.6 7.8 8.07.88.08.28.48.68.8 Load at 9:30Load at 15:30 7.2 7.4 7.6 7.8 8.08.28.48.68.89.0 Load at 9:30Load at 17:30 7.2 7.4 7.6 7.8 8.07.88.08.28.48.68.8 Figure 4: Contour plots of marginal bivariate densities of load (in GigaWatt hours) on 3 January 2005 from the ﬁtted Gumbel pair-copula model. The four panels are for load at (09:30,11:30), (09:30,13:30), (09:30,15:30) and (09:30,17:30). The densities were constructed using KDEs of 19,500 iterates simulated by appending Algorithm 2 to the end of each sweep of the sampling scheme. 31 Electronic copy available at: https://ssrn.com/abstract=1647530","libVersion":"0.3.2","langs":""}