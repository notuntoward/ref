{"path":"lit/lit_notes_OLD_PARTIAL/Gade24LeveragingP90Requirement.pdf","text":"Leveraging P90 Requirement: Flexible Resources Bidding in Nordic Ancillary Service Markets Peter A.V. Gade *†, Henrik W. Bindner*, Jalal Kazempour * *Department of Wind and Energy Systems, Technical University of Denmark, Kgs. Lyngby, Denmark †IBM Client Innovation Center, Copenhagen, Denmark Abstract—The P90 requirement of the Danish transmission system operator, Energinet, incentivizes flexible resources with stochastic power consumption/production baseline to bid in Nordic ancillary service markets with the minimum reliability of 90%, i.e., letting them cause reserve shortfall with the probability of up to 10%. Leveraging this requirement, we develop a dis- tributionally robust joint chance-constrained optimization model for aggregators of flexible resources to optimize their volume of reserve capacity to be offered. Having an aggregator of electric vehicles as a case study, we show how distributional robustness is key for the aggregator when making bidding decisions in a non- stationary uncertain environment. We also develop a heuristic based on a grid search for the system operator to adjust the P90 requirement and the level of conservativeness, aiming to procure the maximum reserve capacity from stochastic resources with least expected shortfall. Index Terms—Stochastic flexible resources, ancillary services, bidding strategy, distributionally robust joint chance-constrained optimization I. INTRODUCTION Flexible resources with stochastic electric power production or consumption have the capability to balance the power grid. Examples of such assets are wind turbines in the supply side and electric vehicles and heat pumps in the demand side. How- ever, their stochastic nature is a barrier to become ancillary service providers like other conventional units. The current requirements of Nordic ancillary service markets technically allow stochastic resources to bid their flexibility. Leveraging such requirements, we develop a bidding decision-making problem for a portfolio of flexible resources, mathemati- cally represented as a Distributionally Robust Joint Chance- Constrained Program (DRJCCP), optimizing the volume of re- serve capacity to be offered. From the perspective of flexibility aggregators, the proposed methodology is general, meaning it can be exploited for bidding decision making irrespective of the type and technology of assets in their portfolio. In addition, we take the perspective of a Transmission System Operator (TSO) and present a trade-off between increased supply of ancillary services from stochastic flexible resources and uncertainty of delivery. Email addresses: pega@dtu.dk (P.A.V. Gade), hwbi@dtu.dk (H.W. Bind- ner), and jalal@dtu.dk (J. Kazempour). The authors would like to thank Trygve Skjøtskift (IBM Client Innovation Center) and Thomas Dalgas Fechtenburg (Energinet) for discussions. The authors would also like to acknowledge the financial support from Innovation Fund Denmark under grant number 0153-00205B. A. Background: Nordic ancillary service market requirements There has been an intention to make Nordic ancillary service markets attractive for stochastic resources to offer their flexibility. This is mainly due to two reasons: First, the Nordic power grid is undergoing a rapid transition towards least fossil-fuel based generation and more intermittent generation from wind and solar power, thus stressing the power grid. Second, the need of Nordic TSOs for frequency-related an- cillary services has been increasing with a particular focus on flexibility procurement from green technologies, e.g., batteries, renewables, and flexible demands [1]. The Danish TSO, Energinet, has recently published an innovative list of requirements [2] that specifically addresses how stochastic resources are pre-qualified for offering their flexibility into Nordic ancillary service markets. Among oth- ers, one requirement takes into account the stochastic nature of flexible resources with respect to their unknown future flexible capacity. Currently, bidding to Nordic ancillary service markets generally occurs in the day-ahead stage when the TSO books certain amounts of various ancillary services. Stochastic resources do not necessarily know with certainty their baseline power consumption/production 12-36 hours in advance. Hence, Energinet allows for a probability of 10% that the submitted bid in the day-ahead stage is not fully available in real time. This means that Energinet allows for reserve shortfall (also called overbidding) with the maximum probability of 10%. Hereafter, we refer to it as “the P90 requirement” as it aims for bids with the reliability of at least 90%. Energinet may check ex-post the realized frequency of reserve shortfall during a certain time period, e.g., three months. In case it goes beyond the allowed threshold, the corresponding flexibility provider may lose its qualification to bid in the market, and therefore should go through again the pre-qualification process of Energinet. A detailed definition of the P90 requirement is provided later in the following section. This requirement naturally leads to a mathematical for- mulation for optimally offering flexible capacity using a chance-constrained program. An aggregator can exploit this requirement to its advantage by maximizing profits within the allowed violation range. However, this might not be in the aggregator’s or the TSO’s best interest as shown later. Any mis-specification of the aggregator’s empirical distribution for offering capacity might cause a violation of the P90 requirement and result in less available flexible capacity for the TSO in reality. We therefore investigate how a distributionallyarXiv:2404.12807v1 [eess.SY] 19 Apr 2024 robust representation of the P90 requirement can benefit aggregators when bidding capacity, while the TSO can use this information to assess how well the P90 requirement functions. For distributional robustness, we use the Wasserstein distance as a metric to represent a given conservativeness when offering flexible capacity. B. Research questions and our contributions From the perspective of an aggregator, the main question is how to develop a DRJCCP complying to the P90 requirement and what level of conservativeness (e.g., in terms of Wasser- stein distance) to be chosen when bidding into the Nordic ancillary service markets. From the the TSO’s perspective, a relevant question is how the P90 requirement and the con- servativeness of aggregators impact the total reserve capacity supply from stochastic resources as opposed to the increased uncertainty of delivery. To answer the first question from an aggregator’s per- spective, we formulate a bidding problem as a DRJCCP, complying to the P90 requirement, with the objective of profit maximization. As an example of a stochastic flexible resource, we consider a portfolio of Electric Vehicles (EVs), whose con- sumption is stochastic. We do not consider the option of EVs injecting to the grid, but rather adjusting their consumption level up and down when charging. Note that the proposed formulation can be applied to any other types of stochastic flexible resources. We show how the conservativeness level directly impacts the aggregator’s security of supply in a non- stationary environment. To answer the second question from a TSO’s perspective, we show how a trade-off exists between increased supply of flexibility and uncertainty of delivery. The find an optimal trade-off, we develop a bi-level optimization problem where the outer problem represents the TSO setting the requirements in terms of allowed rate of shortfall reserve and conserva- tiveness level. The inner problem represents an aggregator maximizing its profit using the proposed DRJCCP. Thus, we assume the TSO is able to not only adjust the P90 requirement, but also demand stochastic flexible resources to consider a certain level of conservativeness for robustness when offering their flexibility. C. Status quo and paper organization A plethora of studies in the literature have investigated how stochastic flexible resources can participate in various ancillary service markets, both with respect to flexible demand [3]–[6] and flexible production from intermittent resources [7]–[10]. However, no studies have looked specifically into the Nordic ancillary service market regulations, i.e., the P90 requirement, when optimizing the bidding decisions of stochastic flexible resources. Reference [11] investigates how distributed energy resources can offer their flexible capacity using a chance-constrained program, but does not consider any market regulation like the P90 requirement. There are also several papers that use distributionally robust optimization for bidding decisions. A distributionally robust bidding strategy for a wind-storage aggregator is proposed in [12]. In addition, [13] develops a distributionally robust optimization for wind energy trading under a two-price imbalance scheme. To the best of our knowledge, this is the first paper in the literature that develops a DRJCCP for optimizing bidding decisions of stochastic flexible resources in ancillary service markets taking into account real market regulations. The rest of the paper is organized as follows. Section II defines the P90 requirement and provides the problem formulation. Section III presents numerical results. Finally, Section IV concludes the paper. II. PROBLEM FORMULATION We first define the P90 requirement of the Danish TSO, Energinet, and describe how stochastic flexible resources can participate in Nordic ancillary service markets with respect to such a requirement. We show how it corresponds to an optimization problem with a single joint chance constraint. We then proceed to make it distributionally robust with respect to the stochastic consumption/production baseline of flexible assets, leading to a DRJCCP, which can be reformulated in an exact manner (i.e., no approximation) to a Mixed-Integer Lin- ear Program (MILP). Lastly, we embed this DRJCCP within a bi-level optimization where the outer problem represents the TSO perspective, and the inner problem represents the aggregator perspective. We will solve this bi-level program with a heuristic since the inner problem includes binary variables and thereby is not convex. A. Definition of the P90 requirement Energinet has introduced the P90 requirement as follows (the text is borrowed from [2]): Definition 1 (The P90 requirement): “[...] This means, that the participant’s prognosis, which must be approved by Energinet, evaluates that the probability is 10% that the sold capacity is not available. This entails that there is a 90% chance that the sold capacity or more is available. This is when the prognosis is assumed to be correct. The probability is then also 10%, that the entire sold capacity is not available. If this were to happen, it does not entail that the sold capacity is not available at all, however just that a part of the total capacity is not available. The available part will with high probability be close to the sold capacity.” Generally, the reservation market for ancillary services in Denmark is cleared the day before delivery. The P90 require- ment in Definition 1 states that the bid (for a given hour) submitted in the day-ahead stage should be feasible in real time at least 90% of the time. Thus, the requirement allows for aggregators to (partially) fail in their forecast of their available flexibility. The second part of Definition 1 states that the magnitude of violations is not allowed to be extreme, thus discouraging severe overbidding (reserve shortfall). Lastly, we note that there are additional requirements for flexible Limited Energy Reservoir (LER) units [2] which we do not consider them here, but they can readily be included in all subsequent formulations. We now show how the interpretation of the P90 requirement naturally leads to an optimization problem for an aggregator maximizing its profit defined as a joint chance-constrained program. B. Bidding problem of an aggregator Hereafter, without loss of generality, we consider a flexibil- ity aggregator in the demand side, where upward flexibility can be obtained by a decrease in consumption. To embed Defini- tion 1 in an optimization problem, we consider the aggregator maximizes its profit by offering flexible capacity into a Nordic ancillary service market with an hourly resolution: max p cap h ∑ h λh p cap h (1a) s.t. ˆP (p cap h ≤ P B m, ∀m ∈ Mh, ∀h ∈ H) ≥ 1 − ϵ, (1b) where h and m are indexes for hours and minutes, respectively. Therefore, H = {1, 2, . . . , 24} represents hours for a given day, whereas M = {1, 2, . . . , 1440} includes all minutes in the same day. Further, Mh = {h×60+m | m ∈ {0, 1, 2, . . . , 59}} represents all minutes in hour h. The objective function (1a) maximizes the profit given deterministic hourly price forecasts λh (in DKK/kW). The variable p cap h is the capacity reservation bid (in kW) to the ancillary service market for hour h. This is consistent with Nordic ancillary service markets where the TSOs procure reservation capacity with an hourly resolution. Note that the capacity bid could either represent symmetrical (i.e., in both up and down directions) or unidirectional flexi- bility, depending on the market in question. The sole uncertainty lies in the forecast for the stochastic baseline power consumption, denoted as uncertain parameter P B m for minute m, governed by the empirical distribution ˆP. Recall that at the time of bidding, the aggregator is uncertain of its future baseline power and therefore its ability to deliver flexibility. For example, for a portfolio of EVs, their future consumption is uncertain, but most likely predictable to some degree. Note that (1b) is a joint chance constraint, which can be interpreted as follows: there is a probabilistic constraint for every minute m within the bid for hour h, enforcing p cap h ≤ P B m. There are 1440 constraints in total in such a form. Constraint (1b) enforces a probability of at least 1 − ϵ for jointly fulfilling all those 1440 constraints. Following the P90 requirement, we set ϵ = 0.10, which is consistent with Definition 1. Note that we implement the P90 requirement for the entire day, meaning we let the aggregator overbid with a probability of up to 10% over a day. Note also that we consider a minute-level resolution for the stochastic baseline, although a finer resolution will be more desirable but it could be more challenging to obtain such a forecast. It could also increase the computational burden. The general way to solve (joint) chance-constrained pro- grams like (1) is to generate samples of P B m by utilizing either historical data or a predictive distribution. Regardless of the method chosen, the resultant distribution may not accurately represent the true underlying uncertainty of the future power baseline. Consequently, the objective in this work is not to generate the most representative sample set or predictions of P B m, but rather to identify optimal decisions based on a given sample set, addressing any potential mis-specification of the sample set. Therefore, instead of assuming a single empirical distribution in (1), we define an ambiguity set of distributions within some distance to the empirical distribution. To do this, inspired by [14], we exploit the well-known type-1 Wasserstein distance between two distributions, defined as dW (P1, P2) = inf P∈P(P1,P2) EP [∥ ∥ ∥˜ξ1 − ˜ξ2∥ ∥ ∥ ] , (2) where ˜ξ1 ∼ P1, ˜ξ2 ∼ P2, ∥ · ∥ denotes a norm, P (P1, P2) represents the set of all distributions with marginals P1 and P2, and dW (P1, P2) gives the distance between two distributions P1 and P2. We can then build our Wasserstein ambiguity set F(θ) as a ball of given radius θ ≥ 0, centered at the empirical distribution ˆP, including any distribution P whose Wasserstein distance to ˆP is not greater than θ: F(θ) = { P ∈ P | dW(P, ˆP) ≤ θ} . (3) When θ ≈ 0, the ambiguity set in (3) contains distributions very close to the empirical distribution ˆP. When θ >> 0, the ambiguity set contains distributions very dissimilar to the empirical distribution ˆP, thus being more conservative. For example, a large θ considers many different baseline consumption profiles of a portfolio of EVs. We now move from the joined chance-constrained program (1) to the following DRJCCP: max p cap h ∑ h λh p cap h (4a) s.t. P (p cap h ≤ P B m, ∀m ∈ Mh, ∀h ∈ H) ≥ 1 − ϵ ∀P ∈ F(θ). (4b) Problem (4) thus optimizes the bidding decision for an aggregator of flexible resources participating in a Nordic ancillary service under Definition 1 using a distributionally robust representation of its baseline power. Note that (4b) can be equivalently re-written as min P∈F (θ) P (p cap h ≤ P B m, ∀m ∈ Mh, ∀h ∈ H) ≥ 1 − ϵ, (5) meaning it picks the worst-case distribution within the ambi- guity set F(θ) and ensures the P90 requirement taking into account that distribution. C. Tractable reformulation of (4) Problem (4) can be reformulated in an exact manner (no approximation) as follows [14, Proposition 2]: max pcap h ,qi,si≥0,t ∑ h λh pcap h (6a) s.t. ϵ|I|t − ∑ i si ≥ θ|I| (6b) P B m,i − pcap h + M qi ≥ t − si, ∀m ∈ Mh, ∀h ∈ H, ∀i ∈ I (6c) M (1 − qi) ≥ t − si, ∀i ∈ I (6d) qi ∈ {0, 1}, ∀i ∈ I, (6e) where i ∈ I is the set of (training) samples, |I| is the number of samples, and P B m,i is the sample i for the realization of uncertain parameter P B m in minute m. Problem (6) in a MILP including a set of auxiliary variables, namely binary variables qi, non-negative continuous variables si, and the free continu- ous variable t. Parameter M is called the Big-M value, which is a large enough positive constant. This reformulation is quite sensitive to the magnitude of M which becomes evident when θ = 0. Here, M constrains the maximum violation of the bid, causing the empirical distribution to lose its significance [14, Theorem 2, Remark 1]. It is not immediately obvious what value the parameter θ should take. Recall, the aggregator should set θ before solving (6). A high value for θ leads to more conservative capacity bids, a lower profit, but more security of delivery. On the contrary, a small value for θ resembles the empirical distribution and finds the highest possible capacity bids and profit, but this might prove sensitive to non-stationarity in the baseline power P B m. An option is to solve (6) for a predefined set of θ values and choose the smallest, feasible value of θ, as suggested by [14, Section 3.2]. Alternatively, the TSO could also prescribe a value for θ according to its needs as discussed in the next subsection. D. Tuning problem of a TSO We discuss how a TSO can tune not only ϵ but also θ. The TSO is primarily interested in procuring sufficient amount of reserve capacity to reliably balance the power grid. This is becoming an increasingly difficult decision-making problem for the TSO with more intermittent renewable generation in the power grid, but also with a pressure to not procure (too much) fossil-fuel based reserve capacity. For these reasons, Definition 1 was invented by Energinet in the first place to allow stochastic flexible resources to bid into ancillary service markets. However, the violation frequency of ϵ = 0.10 in Definition 1 is rather arbitrary and one could imagine a higher value for ϵ may yield more flexible capacity but with less certainty of delivery. Therefore, we formulate an optimization problem for the TSO to determine ϵ in response to how the set of aggregators, indexed by d ∈ D, behaves according to (6). Furthermore, we assume the TSO can prescribe a degree of conservativeness upon the aggregators by pre-setting θ. This ends up in a bi-level program enabling the TSO to jointly determine values for ϵ and θ: max ϵ,θ,νm,h,i,d ∑ h,d pcap h,d − 1 |I| ∑ m,h,i,d νm,h,i,d (7a) s.t. νm,h,i,d = (p cap h,d − P B m,d,i)+ , ∀m ∈ Mh, ∀h ∈ H, ∀i ∈ I, ∀d ∈ D (7b) Problem (6), ∀d ∈ D, (7c) where (.) + = max{., 0}. In the inner optimization problem (7c), each aggregator d maximizes its profits as per (6) and bids hourly reserve capacities pcap h,d. In the outer optimization problem (7a)-(7b), the TSO optimizes over ϵ and θ which are treated as parameters for aggregators in the inner optimiza- tion. The objective of the TSO is to incentivize aggregators to bid reserve capacities as reliable as possible, given that aggregators maximize their profit by imposing distributional robustness on their uncertain baseline power. Variables ν represent unavailable reserve capacity from aggregators and is subtracted (on average over m and i) from the total reserve capacity over a day. Note that (7a) considers reliability only and discards any financial incentive for the TSO. One may re-write this objective function in a way that it minimizes the reserve procurement cost of the TSO accounting for the cost associated to the lack of reliability. Recall the inner problem (7c) for each aggregator d is a MILP and therefore non-convex. This means one cannot solve the bi-level problem (7), as common in the literature [15], by replacing (7c) with its optimality conditions. We therefore solve it in a heuristic way by pre-defining a finite set of potential values for ϵ and θ, solve inner problem for each combination of (ϵ, θ), and find their optimal values within the available options from the TSO’s perspective. III. NUMERICAL RESULTS Through our numerical simulations, we first explore how an aggregator of flexible EVs can offer reserve capacity by using (6). For this, we conduct a sensitivity analysis with respect to θ to explore impacts of the conservativeness level. We then take the TSO perspective and solve (7) to maximize the total reserve capacity offered while minimizing overbidding (reserve shortfall). All source codes are publicly available in [16]. A. Input data Fig. 1 illustrates a simulation for the consumption of a portfolio of 20 EVs over 90 days. Weekend days are simulated to have higher consumptions on average, and the same is the case for evenings. To introduce a degree of non-stationarity, the average charge time grows proportional to the square root of time, consequently making a positive drift in the average portfolio consumption. This scenario could symbolize, for Fig. 1: Input data: Simulation of EV power consumption for 90 days. First day is a burn-in period, green is the in-sample period (constructing the empirical distribution), and yellow is the out-of- sample period. instance, the effect of colder weather, where EVs require longer charging periods due to increased energy demand. We call the first 15 days of Fig. 1, highlighted in green, as in-sample period. We use the consumption data in this period to construct the empirical distribution which is an input data for optimization models (6) and (7). We then use the remaining 75 days, called the out-of-sample period highlighted in yellow, for evaluating the quality of bids obtained by models (6) and (7). This is of course a stylized way of intentionally highlighting the impact of distributional robustness, but it generalizes to any situation where any flexible provider might have mis- specification in its empirical (or predictive) distribution for any technology with stochastic baseline power. B. Optimal reserve capacity bids of the aggregator We aim to derive optimal reserve capacity bids for every hour of the next day using historical consumption data repre- sented in Fig. 1. We use this historical data to represent the hourly uncertain consumption of the next day, illustrated by the blue curve in Fig. 2, where the left (right) plot corresponds to the in-sample (out-of-sample) period. The dark blue curve gives the mean, whereas the light blue shows the 10-90% quantiles. For optimal bidding in every hour, we take |I| = 30 samples from in-sample data. The three dashed line curves in Fig. 2 (identical curves in both plots) show the optimal upward reserve capacity bids for three values of θ = {0.01, 0.1, 0.35} representing different levels of conservativeness. Starting with the in-sample data (left plot), all three curves of hourly bids adhere to Definition 1. For θ = 0.01, the bids almost represent the 90% quantile, i.e., the maximum allowed frequency of reserve shortfall. By increasing the value of θ, the aggregator becomes more conservative and therefore offers comparatively lower reserve quantities. However, as observed from the out- of-sample results (right plot), the bids for θ = 0.35 are the only ones that (barely) adhere to the P90 requirement. This 0 5 10 15 20 0 20 40 60 80 100 120 Hour of DaykW θ=0.01 θ=0.1 θ=0.35 0 5 10 15 20 0 20 40 60 80 100 120 Hour of Day θ=0.01 θ=0.1 θ=0.35 Fig. 2: As input data, the blue curve shows the stochastic con- sumption of the portfolio on 20 EVs over a day, representing the mean (dark blue) and 10-90% quantiles (light blue). The left plot shows the in-sample historical consumption data which are already represented in the green area of Fig. 1. The right plot includes the out-of-sample consumption data coming from the yellow part of that figure. As outputs of model (6) given in-sample data, the three dashed line curves (identical in both plots) show the optimal reserve capacity bids for three values of θ = {0.01, 0.1, 0.35} representing different levels of conservativeness. is obviously due to the non-stationarity introduced in Fig. 1. This highlights how important it is for the EV aggregator to behave conservatively and be ambiguity-averse when bidding in an non-stationary environment. One can argue it could be the case for other technologies as well, e.g., for wind and solar power units or aggregators of other types of stochastic flexible demands who are prone to sudden disturbances. C. Reserve capacity procurement by the TSO Fig. 3 shows the total amount of reserve capacity procure- ment of the TSO over a day from the aggregator of 20 EVs for different values of ϵ and θ. The main observation is that a high ϵ, i.e., allowing a high frequency of reserve shortfall, yields more available flexibility for the TSO only if θ is also high. This is due to the variables ν in (7) which penalize the reserve shortfall. Interestingly, we also observe a path of optimal (ϵ, θ) starting from (0.01, 0.01) to (0.30, 0.05). This demonstrates that reserve shortfall for high ϵ can be compensated by more conservative decision making while maintaining a high reserve capacity procurement for the TSO. IV. CONCLUSION Given the P90 requirement of Energinet, this paper il- lustrated how stochastic flexible resources can participate in Nordic ancillary service markets using a DRJCCP for offering reserve capacity. We showed how a tractable formulation of the model allows for more robust bidding in non-stationary environments of the uncertain baseline power consumption. Furthermore, the perspective of the TSO was investigated with respect to its reserve capacity procurement from such stochastic flexible resources. It was shown how an increased allowance for the probability of reserve shortfall should be offset by a corresponding increase in conservativeness of bidding using the measure of the Wasserstein distance in the DRJCCP. These findings were exemplified using a simulated Fig. 3: Total reserve capacity procurement of the TSO over a day from the aggregator of 20 EVs for different values of ϵ and θ. Each (ϵ, θ) has been solved using (7) using a grid search on in-sample data. The optimal value obtained by this grid search heuristic is (ϵ, θ) = (0.11, 0.2). case study of an aggregator of EVs bidding their flexibility into an ancillary service with negligible energy delivery. For future work, it is of great interest to investigate the impact of a heterogeneous portfolio of stochastic flexible resources with respect to the TSO procurement. As such, one could expect that flexible resources of different technology also respond differently when the TSO prescribes allowed probability of shortfall and conservativeness. Moreover, the TSO procurement model in this work ignores prices for ancil- lary services and penalty prices for reserve shortfall. Both are important from a system and societal perspective and should be included in future work. Lastly, an increase in the volume of flexible resources bidding in ancillary service markets lowers prices which will be offset by more uncertain supply. This trade-off could be interesting from the TSO perspective, and should be further studied. REFERENCES [1] “Energinet: Outlook for ancillary services 2023-2040,” Energinet, 2023, accessed: 2024-04-19. [Online]. Available: https://en.energinet. dk/electricity/ancillary-services/ancillary-services-in-the-future/ [2] “Energinet: Prequalification and test,” Energinet, 2023, accessed: 2024-04-19. [Online]. Available: https://en.energinet.dk/electricity/ ancillary-services/prequalification-and-test/ [3] D. E. Morales Bondy, O. Gehrke, A. Thavlov, K. Heussen, A. M. Kosek, and H. W. Bindner, “Procedure for validation of aggregators providing demand response,” in Power Systems Computation Conference (PSCC), 2016, pp. 1–7, Genoa, Italy. [4] D. E. Morales Bondy, G. T. Costanzo, K. Heussen, and H. W. Bindner, “Performance assessment of aggregation control services for demand response,” in IEEE PES Innovative Smart Grid Technologies (ISGT Europe), 2014, pp. 1–6, Istanbul, Turkey. [5] B. Biegel, M. Westenholz, L. H. Hansen, J. Stoustrup, P. Andersen, and S. Harbo, “Integration of flexible consumers in the ancillary service markets,” Energy, vol. 67, pp. 479–489, 2014. [6] D. S. Callaway and I. A. Hiskens, “Achieving controllability of electric loads,” Proceedings of the IEEE, vol. 99, no. 1, pp. 184–199, 2011. [7] A. D. Hansen, M. Altin, and F. Iov, “Provision of enhanced ancillary services from wind power plants–examples and challenges,” Renewable Energy, vol. 97, pp. 8–18, 2016. [8] N. R. Ullah, K. Bhattacharya, and T. Thiringer, “Wind farms as reactive power ancillary service providers—technical and economic issues,” IEEE Transactions on Energy Conversion, vol. 24, no. 3, pp. 661–672, 2009. [9] M. Morey, N. Gupta, M. M. Garg, and A. Kumar, “A comprehensive re- view of grid-connected solar photovoltaic system: Architecture, control, and ancillary services,” Renewable Energy Focus, vol. 45, pp. 307–330, 2023. [10] F. Alshehri, V. G. Su´arez, J. L. R. Torres, A. Perilla, and M. van der Meijden, “Modelling and evaluation of PEM hydrogen technologies for frequency ancillary services in future multi-energy sustainable power systems,” Heliyon, vol. 5, no. 4, 2019. [11] H. Zhang, Z. Hu, E. Munsing, S. J. Moura, and Y. Song, “Data-driven chance-constrained regulation capacity offering for distributed energy resources,” IEEE Transactions on Smart Grid, vol. 10, no. 3, pp. 2713– 2725, 2018. [12] X. Han and G. Hug, “A distributionally robust bidding strategy for a wind-storage aggregator,” Electric Power Systems Research, vol. 189, p. 106745, 2020. [13] P. Pinson, “Distributionally robust trading strategies for renewable energy producers,” IEEE Transactions on Energy Markets, Policy and Regulation, vol. 1, no. 1, pp. 37–47, 2023. [14] Z. Chen, D. Kuhn, and W. Wiesemann, “Data-driven chance constrained programs over Wasserstein balls,” Operations Research, vol. 72, no. 1, pp. 410–424, 2024. [15] D. Pozo, E. Sauma, and J. Contreras, “Basic theoretical foundations and insights on bilevel models and their applications to power systems,” Annals of Operations Research, vol. 254, pp. 303–334, 2017. [16] “GitHub repository,” 2024. [Online]. Available: https://github.com/ PeterAVG/p90 drjcc","libVersion":"0.3.2","langs":""}