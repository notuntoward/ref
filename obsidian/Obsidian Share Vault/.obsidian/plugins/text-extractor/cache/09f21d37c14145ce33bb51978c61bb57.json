{"path":"lit/lit_sources.backup/Mahler22elecPriceDynStructModel.pdf","text":"HAL Id: hal-03542564 https://hal.science/hal-03542564 Submitted on 4 Feb 2022 HAL is a multi-disciplinary open access archive for the deposit and dissemination of sci- entific research documents, whether they are pub- lished or not. The documents may come from teaching and research institutions in France or abroad, or from public or private research centers. L’archive ouverte pluridisciplinaire HAL, est destinée au dépôt et à la diffusion de documents scientifiques de niveau recherche, publiés ou non, émanant des établissements d’enseignement et de recherche français ou étrangers, des laboratoires publics ou privés. Data-driven structural modeling of electricity price dynamics Valentin Mahler, Robin Girard, Georges Kariniotakis To cite this version: Valentin Mahler, Robin Girard, Georges Kariniotakis. Data-driven structural modeling of electric- ity price dynamics. Energy Economics, 2022, 107, pp.105811. ￿10.1016/j.eneco.2022.105811￿. ￿hal- 03542564￿ Copyright information c\u00002022. This manuscript version is made available under the CC-BY-NC-ND 4.0 license https://creativecommons.org/licenses/by-nc-nd/4.0/ Data-driven Structural Modeling of Electricity Price Dynamics Valentin Mahler a,b,⇤,Robin Girard a, Georges Kariniotakis a aMINES ParisTech, PSL University, Center for processes, renewable energies and energy systems (PERSEE), 1 Rue Claude Daunesse, CS 10207, 06904 Sophia-Antipolis, France bADEME - French agency for ecological transition, 20 avenue du Grésillé - BP 90406, 49004 Angers Cedex 01, France Abstract In many countries, electricity prices on day-ahead auction markets result from amarket clearing designed tomaximizesocial welfare. Foreachhour ofthe day, the market price can be represented as the intersection of a supply and demand curve. Structural market models reﬂect this price formation mecha- nism and are widely used in prospective studies guiding long-term decisions (e.g. investments and market design). However, simulating the supply curve in these models proves challenging since estimating the sell orders it comprises (i.e. oﬀer prices and corresponding quantities) typically requires formulating numerous techno-economic hypotheses about power system assets and the behaviors of market participants. Due to imperfect competition, real mar- ket prices diﬀer from the theoretical optimum, but modeling this diﬀerence is not straightforward. The objective of this work is to propose a model to simulate prices on day-ahead markets that account for the optimal economic dispatch of generation units, while also making use of historical day-ahead market prices. Inferring from historical data is especially important when not all information is made public (e.g. bidding strategies) or due to diﬃculty in accurately accounting for qualitative notions in quantitative models (e.g. market power). In this paper we propose a method for the parameterization of sell orders associated with production units. The estimation algorithm for this parametrization makes it possible to mitigate the requirement for analytic formulation of all of the above-mentioned aspects and to take advantage of the ever-increasing volume of available data on power systems (e.g. technical and market data). Parametrized orders also oﬀer the possibility to account for various factors in a modular fashion, such as the strategic behavior of market participants. The proposed approach is validated using data related to the French day-ahead market and power system, for the period from 2015 to 2018. Keywords: Day-ahead markets, Electricity prices, Structural market model, Prospective studies, Power systems ⇤Corresponding author Email address: valentin.mahler@mines-paristech.fr (Valentin Mahler) Preprint submitted to Energy Economics October 25, 2021 Nomenclature Variables P Production L Load E Energy transmitted between bidding zones P min Minimum production P max Maximum production Lmin Minimum load Lmax Maximum load Emin Minimum transmitted energy Emax Maximum transmitted energy Shydro Hydro stock ⇧ Observed market clearing price ˆ⇧ Simulated market clearing price ˆ⇡ Simulated price of an order ↵ Sell price parameter \u0000 Bias correction term Subscripts i index for a production unit in set I j index for a consumption unit in set J t index for a market time unit in set T z index for a bidding zone in set Z c(i) index for a production class in C of unit i 1. Introduction 1.1. Context Modern societies operate under the assumption that high security of elec- tricity supply is guaranteed [1]. Over the last decades, electricity markets have been seen as a pertinent way to provide the supply necessary for the equilibrium of the system [2]. Studying and anticipating the evolution of wholesale market prices helps private and public stakeholders to better evaluate the opportunities and risks they face [3] [4] [5]. For example, renewable energy sources (RES) power plants, when not under a subsidy regime, generate their revenue through participation in electricity markets. It is useful for the design of the RES investment to have estimates of the evolution of electricity prices to assess the payback and associated risks. Making estimates based on the evolution 2 of electricity prices in the years to come is highly challenging due to uncer- tainties. This calls for the development of numerical models able to account for the eﬀect of factors of diﬀerent natures on prices. Such models can help to gain a better understanding of the mechanisms underlying the formation of prices, resulting in more rational decisions regarding investments, opera- tion and maintenance, more appropriate market designs, and easier market surveillance. In practice, wholesale electricity prices vary according to the supply-demand equilibrium established by market participants, while consid- ering the techno-economic constraints of the power system assets and in com- pliance with a strict regulatory framework that deﬁnes the underlying market mechanism. Thus, the inﬂuencing factors of price dynamics include: evolu- tion of demand, composition of the energy mix, market design, and strategic behavior of market participants. In deregulated energy markets, multiple possibilities are oﬀered to pro- cure or supply electricity. Participants trade on specialized exchange markets where buy and sell orders are pooled, and also trade over-the-counter through bilateral contracts. Each transaction is associated with a price that is not necessarily disclosed. The price observed on day-ahead auction markets is especially interesting as it is typically unique for a given hour and location and, as such, can serve as a common, transparent price signal published by the power exchanges. This price results from the clearing of all buy and sell orders, submitted one day before physical delivery. It is worth noting that this price signal commonly also serves as an indicator for pricing on other markets, such as forward markets (e.g. in [6]). Two main structures can be distinguished for wholesale electricity mar- kets: zonal and nodal [2]. Zonal pricing, which is common in Europe, sets a unique price for a large area called a bidding zone (typically a country or a region). The usual design of this market is presented in [7] and the technical implementation for the case of Europe is described in [8]. Nodal pricing, also known as locational marginal pricing (LMP), is common in North America. These markets feature a higher spatial granularity since a price is set for each bus. As a consequence, transmission constraints are better taken into account and play a greater role in price formation. Also, in some cases, the market power of a few electricity producers over a single node can be more signiﬁcant than it would be over a larger zone with more competing resources; this mar- ket power could impact price formation. The advantages and disadvantages of zonal and nodal models of energy markets are discussed more extensively in [9]. In this paper, we focus on zonal markets, but we propose a discussion 3 on the applicability of our method to nodal markets in subsection 2.2. As mentioned above, in diﬀerent applications like RES investments it is beneﬁcial to have an idea about the evolution of electricity prices. To achieve this requires being able to model the market mechanism and the evolution of the factors inﬂuencing price dynamics. For this purpose, a growing volume of data is available and helps to reveal the eﬀects observed in practice. This is especially true now that power system data (e.g. static data, such as the installed capacity by generation technology, and dynamic data, such as the hourly outages of production units) are more accessible than ever due to supportive regulation (e.g. data available on the ENTSO-E Transparency Platform [10] as speciﬁed by the regulation [11]) and thanks to data sharing initiatives (e.g. Open Power System Data [12]). The availability of market data (e.g. time series of commodity prices, aggregated supply and demand curves) is also improving, but the costs associated with such ﬁnancial data remain a concern in the EU [13] and in the US [14]. For diﬀerent applications in the context of energy transition it is neverthe- less necessary to look beyond global trends in electricity prices and consider their modeling with a high temporal resolution (i.e. hourly) by accounting for techno-economic constraints related to the operation of the power system. This reveals situations where the intraday variations of prices impact the per- formance of the considered solutions; this could for example be the case when studying incentives to develop ﬂexibility both on the supply and demand sides (e.g. storage, demand side response). In the case of less ﬂexible production technologies driven by weather conditions (e.g. solar and wind power) or lim- ited by operational constraints (e.g. start and stop costs or ramp limits for thermal units), being able to simulate their exposure to low or even negative prices helps to assess their ﬁnancial performance from the point of view of an investor. 1.2. Modeling prices on day-ahead markets Various approaches have been proposed in the literature to explore the relation between energy prices and their drivers [7]. Prices can be simulated directly as a function of exogenous regressors (e.g. electricity demand, avail- able capacity) employing time series models, artiﬁcial neural networks and regression trees. These purely statistical models rely on observed correlations between variables and have good forecasting accuracy, especially for short- term horizons [15] when the power system composition remains the same. Nevertheless, to reﬂect a structural change in the system composition, both 4 the supply-demand equilibrium and the associated price formation mechanism have to be explicitly taken into account in the regression models. The equilibrium is usually modeled with an economic dispatch or unit com- mitment approach, which results in a cost-eﬀective use of production assets to meet demand in power systems. The optimization solution provides a model for market prices for a given delivery period, either taking the marginal cost of the most expensive production mean with non-zero production, or equiv- alently, using the Lagrange multiplier associated with the demand constraint [16], also called the shadow price. These types of models are popular among transmission system operators (e.g. ENTSO-E uses ANTARES), political institutions (e.g. the European Commission uses METIS) and consulting companies (e.g. Cornwall Insight uses Plexos). A detailed review of modeling tools is proposed in [17] and a systematic mapping of power system models in [18]. For these models, generation units are typically grouped by technology and clustered in market areas, which are interconnected to partially model grid constraints. The models are used for long-term studies regarding system adequacy to estimate future system costs and to assess the potential beneﬁts of new investments or market design adjustments. Monte Carlo simulations are used to evaluate the impact of diﬀerent demand scenarios and meteoro- logical conditions (temperature, rain, wind speed, solar radiation). However, because the models solve a global optimization problem they implicitly adopt the view of a unique central operator. Also, these models require the con- sideration of numerous techno-economic parameters that are rarely publicly available and that are hard to collect and estimate precisely (however, it is worth noting that the European Commission recently released some data sets used for METIS). Lastly, these models are generally not designed to simulate market prices. To our knowledge, their capacity to mimic real price dynamics is not evaluated. In the case of deviations between simulated and observed prices, the latter are not used for model tuning. The equilibrium can also be studied from a multi-agent perspective, where the interactions between owners of diﬀerent asset portfolios play a key role. Methods to reveal hidden variables related to bids associated with power sup- ply assets can for example rely on a Bayesian approach [19] or on inverse optimization approaches [20], [21]. In these references, real historical data have not been used, but the studies are instead based on simulated test cases. More generally, this class of models is a popular choice for studying qualitative issues rather than for simulating long time series of real market prices [7] and, as such, the objective is usually not to exploit observed market data. Never- 5 theless, in nodal markets, more detailed technical and economic data about individual units and transmission lines can be leveraged through inverse op- timization, as in [22], where the Midcontinent ISO electricity market (MISO) in North America is studied. In [22] learning from historical data primarily enables to infer information about grid usage, whereas our main focus is on supply bids. Alternatively, the system equilibrium can be considered from a more market- oriented perspective by simulating supply curves [23]. In this case, for a given hour, the supply curve corresponds to the aggregation of market orders and not only depends on the merit order (i.e. the ranking of production units according to their short-run marginal cost), but also on the bidding decisions of market participants. The technical constraints that would induce tempo- ral coupling, usually present in unit commitment models, are not included. Merit order models are also used to support business or policy development (e.g. EMMA developed by Neon Neue Energieökonomik and Power2Sim de- veloped by Energy BrainPool). Such models can be classiﬁed as fundamental (or structural) models according to the electricity price forecast taxonomy proposed in [7]. Fundamental models are used for prospective studies as well as for ex post analyses (e.g. [24] and [25]). A survey of structural models is proposed in [26]. For structural models, a key step is supply curve modeling. This is gen- erally obtained as an aggregation of market orders, but it can also result from a statistical model as in [27], where the curve is built as a function of a normalized load and observed market prices. This purely statistical model is then adjusted to account for the evolution of fuel and emission costs for coal. The X-model presented in [28] and used in [29] proposes a piecewise model for the supply curve. Each local model is initially associated with a price level for which a volume of energy is determined through a statistical regression. Regressors at time t include solar and wind production or planned generation. An interpolation is used to build the ﬁnal supply curve. The concept of the X-model has recently been extended in [30], where the sup- ply and demand curves are considered jointly in order to reduce computation time and improve accuracy. While these piecewise models try to mimic the standard merit order approach, they do not include the eﬀects of availability and production costs. On the contrary, a model inspired by [31] is proposed in [6] for coupled electricity markets, where the supply curve is constructed by stacking sell orders for which the price oﬀers are a function of the sup- ply margin (i.e. the diﬀerence between the total available capacity and the 6 demand) and the production cost by technology. An objective of the paper by these authors is the analysis of forward markets, which requires a speciﬁc form of price oﬀer that reduces the realism of the day-ahead price dynamics in simulations. In [32], a clearing market price procedure, which also includes complex orders, is proposed. The bids are not parametrized and no learning algorithm is introduced since the case study is based on the Spanish market, where day-ahead market bids details are disclosed contrary to most European electricity markets. While the approach is relevant for ex post analyses, it would need to be extended to be used for prospective studies. In [33], spe- ciﬁc attention is given to the variability realism of simulations. Their model starts with a description of the supply curve per technology through the short- run marginal cost. Price oﬀers are then reduced in the case of low demand (reﬂecting for example must-run constraints) and increased for high demand (inducing a scarcity rent). The adjustment of bids is still done at the tech- nology level without considering individual production units. References [34] and [25] also propose to model hourly prices using the merit order approach at the technology level to realistically model the price dynamics on the German day-ahead market. Both models make use of real data and linear regressions. The regressions are used in [34] to adjust the output of the merit order model to account for eﬀects such as ramp constraints and strategic bidding, while [25] uses statistics to model the foreign trade balance. These models employ data to enhance realistic simulations, but they do not propose to directly use statistical calibration for the supply curve modeling. 1.3. Key contributions As presented in this introduction, structural models are beneﬁcial for the conduct of prospective studies needed to support long-term decisions. By de- sign, these models aim at capturing the price formation mechanism according to explicit techno-economic hypotheses, and as such, these models enable to simulate electricity prices from various scenarios of evolution of the power systems, even if analogous conditions have not been observed yet. Although purely data-driven approaches (e.g. decision trees and artiﬁcial neural net- works used in machine learning) are fundamentally not robust against major systemic changes and less suitable for such long-term studies, the beneﬁts that data-driven approaches can bring should not be overlooked, since empirical veriﬁcation relying on data from real observations is essential to ensure the validity of the formulated hypotheses. In order words, exploiting real data ensures that the theory is coherent with the market phenomena observed in 7 practice. Although multiple solutions exist to model the full power system and unit constraints in order to perform studies for long-run simulations, few methodologies have been proposed to extract information from observed day- ahead prices in order to tune the internal parameters of such models. The novelty of this approach is that information extracted from in-sample data sets (e.g. past observations) becomes an integral part of the model, which can be used for out-of-sample forecasts (e.g. prospective studies). In light of the scientiﬁc literature and extending [35], we propose a struc- tural model in which the supply curve is constructed with a bottom-up ap- proach. Market orders are associated with production units and their prices are parametrized, which means that we can leverage available market and power system data. To develop this joint statistical and optimization ap- proach, we propose the following main contributions in this paper: 1. We propose a new method to simulate hourly electricity prices on day- ahead markets that meets two objectives: (i) reﬂect the techno-economic constraints imposed by the power system that induce the price formation according to the economic theory of marginal pricing under idealized conditions of perfect competition (ii) exploit market and power system data to calibrate and evaluate the model so that the simulations reﬂect the prices observed in practice. 2. We propose advanced approaches for the calibration of this structural model. The calibration process allows us to determine the value of parameters by production class, to modulate the importance given to market prices depending on their range, and to account for the observed supply curves’ prices. 3. We validate the proposed method using data related to the French day- ahead market and power system, for the period from 2015 to 2018, and we show the beneﬁts that statistical calibration can bring to structural models. 1.4. Paper structure The remainder of this article is structured as follows: in section 2, we present our methodology, then we illustrate the concept on a use case in section 3. The advantages and limitations of the method are discussed in section 4. Finally, conclusions and some perspectives for further work are proposed in section 5. 8 2. Problem statement and methodology 2.1. Market clearing with technical constraints In this section, we present the formulation of the optimization problem that emulates the market clearing mechanism and integrates power system constraints. The considered power system is composed of interconnected mar- ket areas. No assumptions are made on the nature of the energy mix. The link between the technical constraints of the power system and elec- tricity prices is modeled through a simple economic dispatch including a stock constraint for hydro power. This constraint introduces a temporal coupling that independently prevents a resolution for each time step. More technical constraints could be added here, though it is not the purpose of this paper to add too much complexity here. For a more complete formulation and discus- sion on economic dispatch, see e.g. the review paper [36]. The formulation could be further extended to a unit commitment as presented in the review paper [37]. An elastic demand is introduced in the formulation making it closer to a market clearing with technical constraints than a pure economic dispatch. The cost function that is optimized depends on the marginal costs ⇡P t,i of production units, and the marginal utility ⇡L t,j for consumption units. The problem is formulated as a social welfare maximization, i.e. a maximiza- tion of the producer surplus and the consumer surplus: maximize P, L, E X t2T (X j2J ⇡L t,jLt,j \u0000 X i2I ⇡P t,iPt,i) (1a) subject to X i2Iz Pt,i + X z02Z Et,z,z0 = X j2Jz Lt,j 8(t, z) 2 T ⇥ Z, (1b) Emin t,z,z0  Et,z,z0  Emax t,z,z0 8(t, z, z0) 2 T ⇥ Z ⇥ Z, (1c) Lmin t,j  Lt,j  Lmax t,j 8(t, j) 2 T ⇥ J, (1d) P min t,i  Pt,i  P max t,i 8(t, i) 2 T ⇥ I, (1e) X (t,i)2T ⇥I hydro z Pt,i  Shydro T,z 8z 2 Z (1f) where • (1a) is the social welfare maximization objective • (1b) is the power balance constraint 9 • (1c) is the interconnection capacity constraint • (1d) is the consumption unit limits constraint • (1e) is the generating unit limits constraint • (1f) is the hydro stock constraint We denote ⇧ MC t,z as the Lagrange multiplier associated with the constraint (1b). In the case without temporal coupling, the marginal costs ⇡P t,i are sim- ply the sell prices of market participants and ⇧ MC t,z is the result of a market clearing. In a pure market vision, the set of production units I would be the set of orders rather than a set of production means. With a technical con- straint, such as the hydro stock constraint, the sell price of hydro is the sum of the marginal cost ⇡P t,i and the Lagrange multiplier \u0000(1f ) associated with the stock constraint (1f), also called the value of water. The interest of this kind of formulation compared to a pure market clearing is that a sell price taking into account technical constraints is computed internally by the model. In the general case, Lagrange multipliers associated with all internal technical constraints included in the model can be allocated to production means, so that we can write the sell price of production unit i at time t as ⇡P t,i + \u0000IC t,i . This optimization approach is widely used to simulate market prices from marginal costs and considering the technical description of the electric sys- tem (e.g. availability of production units, hydro stock constraint, transmis- sion constraints). By construction, it reﬂects the day-ahead market clearing mechanism. However, it does not account for strategic bidding, information asymmetry and market power that can be observed in practice. In addition, ﬁnancial aspects can also impact the formation of prices, such as the existence of multiple markets, which not only allows participants to sell and buy on the day-ahead market, but makes doing so more interesting for them regarding their proﬁt expectation and risk management policies. 2.2. Parametrization of marginal costs The concluding remark of the previous subsection highlights that, in prac- tice, sell prices are not only inﬂuenced by the well-deﬁned techno-economic constraints IC that are accounted for in Eq. (1), but also by strategic deci- sions of market participants that impact price formation. The contribution of these other factors is denoted ✏t,i. We ﬁnally propose the following additive 10 decomposition of the sell prices ˆ⇡sell t,i , which accounts for the contribution of both \u0000IC t,i and ✏t,i: ˆ⇡sell t,i = ⇡P t,i + \u0000IC t,i + ✏t,i (2) The model’s internal constraints IC are explicit, so the modeler can di- rectly assess the eﬀect that adding or removing constraints has on simulated prices (e.g. adding ramp constraints to the existing ones). The modeler can also easily evaluate the impact of the limits imposed (e.g. by changing the values of the hydro stock constraint or the maximal available production capacity constraint). But this approach is not applicable for ✏i,t since it is not practical to quantify a priori the impact on hourly day-ahead prices of economic factors such as strategic bidding, information asymmetry, market power and the co-existence of multiple wholesale electricity markets. Using adata-driven approach on historical timeserieshelpsus toempirically quan- tify the inﬂuence of these factors. So, we propose to build a statistical linear model ˆ⇡P t,i for ⇡P t,i + ✏t,i. ˆ⇡P t,i is a marginal cost proxy that accounts for both an objective short-run marginal cost of production unit i (⇡P t,i)and thein- ﬂuence of strategic factors (✏t,i). The main drivers of these marginal cost proxies include: fuel prices, emission prices, global supply margins (i.e. the diﬀerence between the available capacity and the demand), and the rank of each production unit within its production class, and thus we propose the parametrization described in Eq. (3). Fuel and emission prices allow us to account for the evolution of operating costs (OPEX). The contribution of the margin term reﬂects an important part of the strategic behavior that can oc- cur during scarcity situations when market participants add a price premium to their bids. The rank of a production unit is introduced to reﬂect the het- erogeneity within a production class since not all units bid the exact same price (e.g. due to various levels of eﬃciency and ﬂexibility). ˆ⇡P t,i = ↵c(i),0 + ↵c(i),F ·Ft,c(i) + ↵c(i),E ·Et + ↵c(i),M ·Mt + ↵c(i),R ·Ri = ↵| c(i)Xt,i (3) where the parameters of the model are only a function of the production unit class c(i): • ↵c(i),x - Calibrated parameters by class c(i) for each price driver x • Ft,c(i) -Fuelpriceattime t for class c(i) • Et - Emission price at time t 11 • Mt -Supply margin at time t • Ri - Proxy variable for the rank of production unit i in class c(i) Since the sell price is obtained by adding \u0000IC t,i to ˆ⇡P t,i,the price that we propose is also a statistical model of sell orders. Using the marginal cost proxy within the optimization problem deﬁned in Eq. (1) results in simulating aday-ahead market price that wedenoteby ˆ⇧ MC t,z . The market clearing with technical constraints and the parametrization of marginal costs presented here is directly applicable for markets with zonal pricing. The main ideas could also be considered for nodal markets, but the approach would have to be adapted to account for the diﬀerences highlighted in the introduction. Here, we succinctly introduce some points to be consid- ered for this adaptation. Since transmission constraints play a greater role, an additional price driver could be considered in the formulation of the marginal cost proxy so that the parameter associated with these restrictions reﬂects the impact of congestion observed in practice. Also, due to the lower number of generation units, the parameter values could be speciﬁc for each unit (as opposed to production classes) in order to better account for bidding strate- gies. Information retrieved at the unit level would then be more precise, but the optimization problem might become unstable due to the high number of variables. 2.3. Bias correction We also introduce a bias correction term \u0000t,z to ﬁnally obtain the simulated market prices ˆ⇧t,z studied in this paper that we deﬁne as follows: ˆ⇧t,z = ˆ⇧ MC t,z + \u0000t,z = ˆ⇧ MC t,z + \u0000| zYt (4) where for each region z, \u0000z 2 R24⇥7 is a parameter, and for each time step t Yt is the 24 ⇥ 7 dimensional vector with Yt[(h, d)] = 1 if hour(t)= h and weekday(t)= d; otherwise Yt[(h, d)] = 0. This bias correction term is similar in spirit to that proposed in [34]. However, we made this part less sophisticated because the correction is applied after the market clearing meaning that it would not be sensitive to technical changes in the electric system or structural changes in the market rules. This allows us to account for additional dependencies not represented in this simpliﬁed market clearing formulation (e.g. additional temporal dependencies) in order to simulate price 12 dynamics more accurately. For further use in prospective applications, we believe this term should be kept as small as possible. 2.4. Metrics To verify the quality of simulations on out-of-sample tests, we primar- ily consider the root mean square error (RM SE) which assesses the global forecast accuracy. In order to also estimate whether the model has accu- rately captured the price dynamics (i.e. the hourly variations), we evaluate the diﬀerence between the standard deviation of the observed time series of prices and the simulated one (\u0000sd). Our algorithm can simultaneously opti- mize RM SE and \u0000sd and generate the associated Pareto front. The metrics used to evaluate the model performance of the forecast ( ˆ⇧t,z)t2T against the observed prices (⇧t,z)t2T are deﬁned as follows: RM SEz = v u u t 1 T TX t=1 (⇧t,z \u0000 ˆ⇧t,z)2 (5) \u0000sdz = sd((⇧t,z)t2T ) \u0000 sd(( ˆ⇧t,z)t2T ) (6) 2.5. Estimation algorithm The parameters of Eq. (3) and Eq. (4) must be estimated from real data. For a time step t for which we know that the production unit i ⇤(t) is marginal, the at-the-money sell price establishes the simulated market price, which can be rewritten as: ˆ⇧t,z =ˆ⇡P t,i⇤(t) + \u0000IC t,i⇤(t) + \u0000t,z = ↵| c(i⇤(t))Xt,i⇤(t) + \u0000IC t,i⇤(t) + \u0000| zYt (7) We start the algorithm with \u0000z = 0,and ↵c(i) = ↵0 c(i) as an initial value. Market Clearing Step. From a set of marginal cost proxies we can solve Eq. (1). This leads to an estimation ˆ⇧t,z of ⇧t,z,and to the identiﬁcation of marginal production units. This allows us to group time steps according to the value of the marginal class c(i ⇤(t)) denoting the associated partition as (Tc)c2C. In more detail, this ﬁrst step of the algorithm consists in simulating prices using the model with the current values of its parameters. Employing the 13 simulation outcome, we identify which generation unit is marginal for each of the simulated hours (i.e. the unit with the highest sell price and a non-zero production value). We can then group time steps according to the marginal class. For example, if a gas unit is marginal at time Tgas = {t1,t12,t25,t28} and a nuclear unit is marginal at time Tnuclear = {t3,t4,t11,t22,t23}, we will create groups of hours accordingly. These groups are then used in the next step of the estimation algorithm. Parameter update through statistical estimation. Residuals ⇧t,z \u0000 ˆ⇧t,z can be used to estimate a new value for \u0000z. Meanwhile, ↵c0 is obtained by a linear regression of (Xt,i)(t,i)2Tc0 ⇥Iz on the observed price (⇧t,z)t2Tc0 . Coming back to the example given above, in order to determine the values of ↵gas,we perform the regression only with the subset of input data corresponding to Tgas and not with the whole data set (and similarly for the other production classes). Constraints can be added at this regression stage, concerning for example the sign of coeﬃcients, or values that are known (and not estimated) such as ↵c(i),E, which is directly obtained from the average class emissions. We iterate until a stable RMSE is obtained. Interpretation of the algorithm. Anaturaljustiﬁcationofthisalgorithmcomes from the following decomposition of the RMSE: RM SE2 z = 1 T X c02C X t2Tc0 \u0000↵| c0Xt,i⇤(t) + \u0000IC t,i⇤(t) + \u0000| zYt \u0000 ⇧t,z\u00002 (8) It is important to note that the error here is not just a quadratic function of ↵ and \u0000z because, when these parameters change, the merit order changes and this aﬀects the partition (Tc)c2C.In the proposed algorithm, we alternate between two steps. The ﬁrst is an estimation of (Tc)c2C from the value of ↵ and \u0000z.It can be interpreted as a computation of the local linearization of the cost function. In the second, we estimate a new value for the parameters ↵ and \u0000z according to this linearization. This shows that our algorithm is similar to a gradient descent on the cost function. 2.6. Introducing variability into the cost function The root mean square error is known to give results that are smoother than observations. This can be an issue for the kind of application we foresee (i.e. analyzing the variability evolution of market prices). We therefore propose a 14 modiﬁcation of the cost function that implicitly approaches a minimization of RM SEz + \u0000\u0000sdz.We propose to introduce weights (!t,z)t2T in the cost function as a variability hyperparameter of the model: RM SEz = 0 @ 1 T X c02C X t2Tc0 !t,z \u0000↵| c0Xt,i⇤(t) + \u0000IC t,i⇤(t) + \u0000| zYt \u0000 ⇧t,z\u000021 A 1 2 (9) such that the price barycenter is not modiﬁed, i.e. so that : 1 |Tc0| X t2Tc0 ⇧t,z = 1 P t2Tc0 !t,z X t2Tc0 !t,z⇧t,z (10) By giving more weight to hours with extreme low or high prices, we decrease the value of \u0000sdz. 2.7. Leveraging information from observed supply curves The estimation algorithm makes use of observed market prices, implying that only the price information given by the at-the-money order is exploited for each time step. However, the supply curves bring valuable information that has not been taken into account in our method so far. As day-ahead auctions are generally blind (i.e. the identity of market participants is not made public, and it is not even possible to determine which of the production units is actually participating in a market), information cannot simply be retrieved by matching orders to production units. We propose a methodology to exploit the information contained in observed supply curves St,z, which translates into an extension of the set of observed prices, called synthetic prices. A small deviation, \u0000,is applied to the real market clearing volume Vt,z in order to generate synthetic prices ⇧\u0000 t,z so that: ⇧ \u0000 t,z = St,z(V \u0000 t,z) (11) The process is illustrated in Fig. 1. 15 Figure 1: Data augmentation principle to generate synthetic prices from supply curves Each relative variation \u0000 creates a new synthetic data set used to estimate model parameters (i.e. the data sets are only used for in-sample training). As we want our synthetic prices to reﬂect realistic counterfactual cases, we consider that the relative variation of the hourly volumes is caused by the same variation of residual demand. Consequently, the supply margin Mt,z is also modiﬁed in the synthetic data set since it depends on the residual demand. Finally, the synthetic data set is composed of the new prices (⇧ \u0000 t,z)t2T ,the new residual demand, and the price drivers (X \u0000 t,i)t2T , where all variables of Xt,i remain unchanged except M\u0000 t,z.In subsection 3.3.2, the historical data set corresponding to the year 2015 is used to generate synthetic data sets, and the historical data set corresponding to the year 2016 is used for out-of-sample testing. 3. Case study We implemented a method following the described approach, with R pro- gramming language, using data relating to the French market from 2015 to 2018. In our case study, all production units present in the power system are included in the optimization problem deﬁned in Eq. (1), i.e. we assume that 16 all units participate in the day-ahead market. There are several reasons for this choice. The ﬁrst is that our aim is to estimate prices with a variabil- ity reﬂecting the composition of the whole production system. In addition, even if only part of the production in the electric system participates in the day-ahead market, the remaining units that do not participate still inﬂuences prices through other markets that we do not want to model explicitly here. Finally, no public data are available on the exact composition of the produc- tion units participating in the market, while production unit participation in the electric system is publicly available information. As we consider a single bidding zone case here, the subscript z will be omitted in this section. Ap- plication to a multizone case would not change the algorithm, but will be the purpose of further research. The simulation results are obtained by out-of-sample testing. To do so, one year is used for training and then we test over each of the remaining years (we repeat this process for the four calendar years in the dataset). In this way, each year is used three times as a testing set. The ﬁnal result for each year, presented throughout the paper, is the average of the ensemble of the three alternative simulations in which this year is used as a testing set (e.g. using the models trained with the 2015, 2016 and 2017 data sets, we simulate three distinct time series of prices for 2018 and then we calculate the hourly average). In this section, we ﬁrst present the method implemented, then the data used, and ﬁnally we show the results obtained. 3.1. Method implementation 3.1.1. Overview For both training (i.e. the estimation of model parameters) and out-of- sample testing, considering a whole calendar year allows us to observe simul- taneously the daily, weekly and seasonal variabilities. In addition, this long timescale allows us to observe the eﬀect of imposing a yearly constraint on the usage of the global hydro stock. We simulate prices in a single bidding zone and incorporate the eﬀect of the neighboring interconnected zones as additional orders in both the supply and demand curves. For the numerical application, we use the observed net transfer capacity values as order quantities (both as P max t,i to account for the possibility to import and as Lmax t,j to account for the possibility to export) and the foreign day-ahead market prices as order prices (⇡P t,i and ⇡L t,j respec- tively for supply and demand). No minimal volumes for import or export are imposed (i.e. P min t,i and Lmin t,j are equal to 0 MWh). 17 Fig. 2 gives an overview of the case study. Figure 2: Case study overview 3.1.2. Supply For the orders that constitute the supply curve, we consider the production units of ﬁve production classes: nuclear, fossil gas, fossil hard coal, fossil oil and hydro water reservoir. Each order corresponds to a production unit with an installed capacity of over 100 MW. The quantities supplied each hour correspond to the available capacity P max t,i , which varies based on the reported planned and forced outages of the production units. For each production class, units with a capacity of less than 100 MW are aggregated into a single order whose quantity only depends on the installed capacity; the potential unavailabilities are not accounted for. P min t,i is set to 0 MWh for all units. In the ENTSO-E taxonomy, hydro is classiﬁed according to three subcat- egories: (i) run-of-river and poundage, (ii) pumped storage, and (iii) water reservoirs. The hourly production of run-of-river and poundage, as well as the hourly production and consumption of pumped storage, are among the components which are subtracted from the hourly day-ahead consumption forecast in order to obtain the aggregated residual demand used as model input in the case study, as detailed in subsection 3.1.4. For the sell orders corresponding to supply, we only consider water reservoirs. 18 The price drivers considered by production class are summarized in Ta- ble 1. Note that the variation in uranium prices over the studied period is neglected compared to the ﬁxed operating costs of nuclear power plants and that the ranks are based on the nominal power of production units. The rank in our model refers to a proxy variable indicative of the merit order place of a unit within its production class. This variable is used to account for dif- ferences in short-run marginal costs between units, which are due to diﬀerent levels of eﬃciency and speciﬁc operational constraints (the lack of publicly available information at the unit level motivates the use of a proxy variable). To deﬁne the variable for the rank of production (Ri)we considereachpro- duction class c(i) separately and we sort its production units i by ascending order of nominal power P max i ,then we compute Ri by recurrence: R0 = P max 0 and Ri = Ri\u00001 + P max i . This construction is motivated by the fact that we consider large power plants to be more eﬃcient than smaller ones (especially for the French nuclear power plants for which the nominal power is correlated to the installation date). Production Unit Supply Fuel Emission class ranking margin cost cost (c) (R) (M) (F) (E) Hydro water reservoir x x Nuclear x x Fossil gas x x x x Fossil hard coal x x x x Fossil oil x x x x Table 1: Price drivers of marginal cost proxies considered by production class 3.1.3. Parameter estimation For each class, we initialize ↵c,0 introduced in Eq. (3) to be constant and equal to an average short-run marginal cost (i.e. the cost associated to the production of additional energy output). To avoid over-ﬁtting, we constrain the regression to impose a sign on the coeﬃcients ↵c,x during calibration, so that an increase in fuel cost or a decrease in supply margin leads to an increase in energy price. We do not calibrate the parameters ↵c(i),E associ- ated with emissions and choose instead to rely on data from RTE, the French transmission system operator. The data used for the estimation of the param- eters associated with the unit ranking, the supply margin and the fuel costs 19 are presented in subsection 3.2. Alternatively, we could have chosen to set the parameters ↵c(i),F associated with fuel prices using public data, since the parameters correspond to the average energy conversion eﬃciency by produc- tion class. We chose instead to estimate the parameters associated with fuel prices in order to mitigate against uncertainty regarding the available data. First, for each class, diﬀerent values of eﬃciencies are published (these values depend on technology, operating points, etc.). Second, the actual cost of fuel procurement depends on undisclosed hedging strategies of electricity produc- ers, so this cost can diﬀer from the variable Ft,c(i), which corresponds to the fuel price on a speciﬁc market and at a speciﬁc time. As both the values of fuel costs and the price parameters (e.g. ↵gas,F )areuncertain, weappliedthe estimation approach to set the values of ↵c(i),F instead of relying on public data. We note that both ↵c(i),E and ↵c(i),F can be predeﬁned or estimated depending on modeling choices and the reliability of available data. For the reference case presented here, we estimate the model parameters with all weights !i equal to 1 and we do not exploit the real supply curves. In asecond step, we alsoassess the impact of weight variations aspresented in subsection 2.6, and of exploiting the supply curves as presented in subsection 2.7. To estimate \u0000 introduced in Eq. (4), we compute the average of the residuals over the training set by hour and day of the week (i.e. 24x7 oﬀset values) and we then apply this correction on out-of-sample tests. 3.1.4. Residual demand We consider an aggregated residual demand for the bidding zone Lmax t,j with a price set to the day-ahead market price cap (i.e. ⇡L t,j is equal to EUR 3,000 per MWh). The price cap value does not set a market price in this case study as no supply shortage was observed. Since this residual demand j is always fulﬁlled in the case study, Lt,j is equal to Lmax t,j for all time steps. For the simulation, we set the value of Lmin t,j to 0 MWh, but the same results would have been obtained for all values between 0 MWh and Lmax t,j . The de- mand Lmax t,j results from the diﬀerence between the day-ahead consumption forecast by RTE and the contribution of supply assumed to be a price-taker for the studied period and location. Here, this supply is composed of fatal power production (solar, wind and run-of-river hydro), co-generation (ob- served production according to a baseload proﬁle), storage (we consider only the contribution of pumped-storage hydroelectricity, not batteries, etc.) and production classes with low installed capacity (biomass). Including storage as 20 aproduction unit intheinitial optimization problem would not changethe algorithm, but as already mentioned, it is not the objective of this paper to include complex technical constraints. 3.1.5. Market clearing We solve Eq. (1) in two steps, which corresponds to dualizing the hydro stock constraint. In the ﬁrst step, we maximize social welfare using the orders for each hour separately and we obtain a time series of market prices. In the second step, we adjust the availability of hydro power plants so that they produce only at higher prices within the limit of the annual hydro stock constraint, then we solve the market clearing anew as in the ﬁrst step. This two-step procedure is reproduced at each iteration of the whole estimation algorithm. 3.2. Data The raw data sets used for the simulation and results analysis are listed in Table 2. Data set Source Installed capacity by production class ENTSO-E transparency platform 1Installed capacity of production units (Pnom > 100MW) Unavailability of production units (Pnom > 100MW) Prices on day-ahead markets Open Power System Data [38] Day-ahead consumption forecast RTE (Eco2Mix platform) 2Hourly production by production class CO2 emissions by production class Net Transfer Capacity to and from neighboring bidding areas (NTC) RTE (Data portal) 3 Operating costs by production class RTE/ADEME study [39] Import costs of coal and oil in France French Ministry for the Ecologi- cal Transition (PEGASE) 4 Gas market prices ERCE 5 CO2 European Emission Allowances Business Insider 6 Hourly supply and demand curves EPEX SPOT Atmospheric temperature Meteo France Table 2: Data sources for the case study 21 The hydro stock Shydro T,z ,computed using the data set \"Hourly produc- tion by production class\", is equal to the sum of the hydro water reservoir production over one year. Two remarks can be made about the data sets: • The UK National Balancing Point (NBP) was used instead of the French Point d’échange de gaz (PEG) for gas prices due to data availability, but these prices are considered to be correlated enough for our modeling purposes. • All data sets were collected from the web, except for EPEX Spot’s supply and demand curves, and Meteo France’s average atmospheric temper- atures, which are not open data but commercially available or under special conditions for research purposes. However, these two data sets are used here to further validate extensions of the core methodology (respectively for data augmentation and error analysis), therefore the core approach proposed can be developed and evaluated using publicly available data only. 3.3. Results 3.3.1. Reference case The results obtained using the method and data described above are shown in Fig. 3. In addition to the model’s output (i.e. time series with hourly resolution), we analyzed its variability by computing the average prices by day of the week and hour of the day. The temporal variations appear to be globally captured by the model. A more detailed analysis relying on the presented metrics features in the next subsection. 1https://transparency.entsoe.eu/ 2https://www.rte-france.com/eco2mix/telecharger-les-indicateurs 3https://www.services-rte.com/ 4http://developpement-durable.bsocom.fr 5https://www.erce.energy/graph/uk-natural-gas-nbp-spot-price 6https://markets.businessinsider.com/commodities/historical-prices/co2-european- emission-allowances/euro/1.12.2014_1.2.2019 22 Figure 3: Time series of prices on the French day-ahead market over four years (top), average prices by day of the week (bottom-left) and average prices by hour of the day (bottom-right) Afocusona periodofonemonthpresentedinFig. 4 givesa moredetailed representation of the dynamics of day-ahead prices. 23 Figure 4: Time series of prices on the French day-ahead market over one month 3.3.2. Advanced calibration Hyperparametrization. In Fig. 5, we show how tuning the variability hyper- parameter of the model during calibration can improve the out-of-sample per- formance as measured by the RM SE and \u0000sd metrics. This hyperparameter is equal to the sum of the weights !i introduced in Eq. (9), which are added to the minimal and maximal price values used for estimating the parameters ↵c0 for each production class. We ensure that the weights are added in a balanced way so that the mean price of the set remains unchanged. In other words, weights are used during the training phase when we esti- mate the ↵ parameters of the sell prices. Let us recall that data sets are split according to the class of the production unit considered to be marginal. For each production class, when considering only the relevant time steps accord- ing to the marginality criterion, we have a subset of observed prices and the corresponding explanatory variables. We identify the time corresponding to the lowest and highest market prices and we assign extra weights only to these two time steps. We call the sum of added weights the variability hyperparam- eter. The weights are shared between these two points so that the average of observed prices remains unchanged after assigning these new weights. 24 Figure 5: Out-of-sample performance for diﬀerent values of the variability hyperparameter We observe in Fig. 5 that hyperparametrization can help to improve the dynamics of the simulation (i.e. the variation of the simulated prices is more similar to the variation of the observed prices) at the expense of lower global accuracy as measured by the RMSE. Data augmentation. Due to data availability issues, we applied the technique presented in subsection 2.7 on the supply curves only for the year 2015. We tested the performance on the year 2016 where more price spikes are observed. In the reference case, the spikes are not fully captured, which lead to degraded performances compared to the other simulated years as measured by our two metrics. As training sets, we consider 12 additional synthetic years with a relative variation of hourly traded energy volumes from -3% to +3% by steps of 0.5%. In Fig. 6, we represent the performance obtained when averaging the simulated prices for 2016 obtained using the models trained with diﬀerent 25 synthetic data sets (e.g. the case \"demand variation 1.0%\" is obtained by averaging the outputs obtained with the models trained using the data sets -1.0%, -0.5%, 0.0%, 0.5% and 1.0%). Figure 6: Out-of-sample performance for diﬀerent augmented data sets (training set: 2015, testing set: 2016) Contrary to the results obtained with diﬀerent variability hyperparameter values, the data augmentation approach tends to increase the global accuracy at the expense of less realistic price variations. The advanced calibration techniques proposed in this subsection impact model performance over the whole test period, but they do not have a sig- niﬁcant impact on simulation outcomes during hours corresponding to price spikes. This is likely due to the linear formulation of the marginal cost proxy. The training phase enables us to estimate parameters that provide a relevant compromise in most cases, but performances are still to be improved for price 26 spikes. The presented calibration techniques allow us to vary the importance of the points in the training data set (hyperparametrization) or to consider alternative training data sets (data augmentation), without modifying the marginal cost proxy formulation. The model could be further extended, for example by introducing non-linear relationships between price oﬀers and mar- ket drivers (piecewise-linear, quadratic, etc.). 3.3.3. Benchmark We aim to (i) assess the beneﬁts of the model calibration to estimate the contribution of statistics to our structural model, and (ii) compare our perfor- mance to purely data-driven methods (i.e. linear regression as a reference for statistical modeling and random forests as a reference for machine learning modeling). The results are summarized in Fig. 7. We observe that model cal- ibration, which corresponds to our reference case, improves the performance for our two metrics. Also, when we consider only a basic data set consisting of power system data as an input for the statistical and machine learning models (i.e. excluding information about prices and costs), our calibrated model tends to perform better. Nevertheless, when considering an extended data set for calibration, which includes power system and market data (fuel costs and day-ahead prices in the neighboring bidding zones), the purely data- driven approaches tend to be better at exploiting correlations between prices on diﬀerent markets. Although purely data-driven approaches perform well in this case study, they are given only as a reference since they do not fulﬁll the objectives set in the introduction of this paper, which is to propose a suitable method for prospective studies. As these methods exploit the outcome of past observed situations and do not intrinsically consider the price formation mechanism, they are less relevant to study the impact in terms of prices of long-term scenarios where major system changes are considered. As requirements for prospective studies, the model must oﬀer the possibility to estimate the po- tential consequences of changes in electricity mix or market design. By con- struction, structural models are well-suited to integrate the technical con- straints imposed by the electricity mix, and the optimization problem can be extended beyond the current formulation if needed. Nevertheless, our data- driven approach would not be suitable for scenarios which radically diﬀer from the training data set (e.g. in the case of 100% renewable energy). First of all, in case of radical changes, the behavior of market participants will diﬀer from the behavior inferred from historical data. In addition, the bias cor- 27 rection term \u0000t,z in Eq. (4) reﬂects a periodicity of spot prices that would also change in case of a major evolution of the energy mix. Regarding the market design, our model represents the price formation induced by a zonal double-sided auction market with uniform pricing. The impact of the design of other electricity markets on the day-ahead market is not the object of this case study, but it could be the focus of additional analyses under the current framework. For example, in the case of France, the ARENH mechanism forces EDF to sell nuclear electricity to competitors in order to mitigate the eﬀect of EDF’s historical monopoly on the French energy supply (up to 100 TWh of electricity at EUR 42 per MWh from 2015 to 2018). Market participants might want to resell a share of this energy at a higher price. To do so, they would only have to bid the ARENH price since the day-ahead market is pay- as-clear (this would correspond to an additional oﬀer in our model and the availability of nuclear plants would then be reduced accordingly). Sensitivity analyses can be performed in order to assess how the ARENH price, the total ARENH volume, or the percentage of ARENH resold could impact prices on the French day-ahead market. 28 Figure 7: Performance comparison of benchmarked models 4. Sensitivity analysis and discussion 4.1. Sensitivity analysis of initial conditions When we initialize the parameters ↵c,0 to a diﬀerent value for each pro- duction class, we make assumptions on the merit order (i.e. the energy is supplied in priority by the production class with the lowest cost, then the second lowest, and so on). This initial choice has an impact on the parameter estimation procedure, since the marginal unit for each hour determined while solving the market clearing problem directly depends on this merit order. In this section, we perform a sensitivity analysis to investigate how alternative cost scenarios aﬀect the initial merit order and as consequence the ﬁnal result of the calibration. To do so, we initially assign ﬁve distinct constant prices to our ﬁve production classes (i.e. nuclear, hydro, gas, coal and oil) and consider 29 all possible permutations, then we analyze the initial merit order for the best decile in terms of RM SE (see Fig. 8). Figure 8: Best initial merit orders (ﬁrst decile) The results illustrate that the model initialization should be consistent (e.g. nuclear to constitute a less expensive baseload and oil for more expen- sive peaks). The place of hydro in the merit order is likely due to the strategic use of stock during high-price hours. Therefore, since the initial merit order impacts the assessment of hourly marginal production classes, the initializa- tion must be considered carefully. 4.2. Impact of unexpected events The occurrence of an unexpected event can inﬂuence selling and procure- ment requirements. Here we assess the impact on simulation errors due to temperature anomalies (i.e. the diﬀerence between the observed atmospheric temperature and the long-term average) and the impact of unexpected un- availability of production units. The hourly temperatures are spatially aver- 30 aged for the French bidding zone in order to consider a single representative temperature for each hour. Regarding the production unavailability published on the ENTSO-E transparency platform, we distinguish between planned out- ages (e.g. maintenance) and forced outages (e.g. plant failure), where only the second category is considered as being unexpected. The evolution of un- availability is shown in Fig. 9. Figure 9: Unavailability of production units We perform regressions between the prediction errors of simulated prices on the out-of-sample data set and our variables quantifying unexpected events using the Loess procedure [40] (i.e. locally estimated scatterplot smoothing). For the univariate cases, a coeﬃcient of determination R2 of 0.10% is obtained for the temperature anomalies and 1.23% for the impact of forced outages. In the bivariate case, the coeﬃcient of determination is not improved compared to considering only forced outages (R2 =1.14%). The results for forced outages are presented in Fig. 10. 31 Figure 10: Impact of forced outages on prediction errors. Hourly values (black dots), their corresponding densities (blue lines) and locally estimated scatterplot smoothing, i.e. Loess (the estimation is shown by the solid red line and the 95% conﬁdence interval by the dashed red lines) 4.3. General remarks The case study illustrates how the method can be implemented to sim- ulate prices on the French day-ahead market. The model makes it possible to simulate price dynamics and calibrate improved performance. Exploiting fundamental data proves interesting to simulate these prices over the long run. We note that the French market is characterized by a dominance of nuclear power plants operated by a single electricity producer (EDF). This makes the French case particular and further analyses of other markets could be the purpose of further work. Moreover, the model captures the main characteristics of price dynamics but underestimates the prices in case of spikes. The formulation of sell order 32 prices could be extended to include non-linear price increases in case of limited supply margins. Finally, for prospective studies, scenarios could be generated to assess the potential impact of the evolution of fundamentals, such as the demand, energy mix or fuel and emission costs. For the French market, an evolution of the energy mix could be considered in light of the studies made by RTE to reach carbon neutrality in 2050 rather by mainly developing nuclear power, or by signiﬁcantly increasing the share of renewable energy, or a balanced combi- nation of both. Results for this distant future have to be studied critically, but analyzing simulated prices during the upcoming transition years leading to these signiﬁcant changes can be informative for decision-makers. For de- tailed studies at the European level, scenarios could for example be based on the Ten-Year Network Development Plans (TYNDP) published every two years by ENTSO-E. When using scenarios, some price-sensitive factors, such as ﬂows in interconnections and storage usage, should be made part of the optimization problem. The aim here is to ensure that these variables remain internal to the model and thus become dependent on spot prices. To do so, multiple bidding zones can be simulated at once in order to compute intercon- nection ﬂows with the model. Moreover, the optimization problem presented by Eq. (1) could be enhanced with additional constraints in order to actively manage storage assets, so that storage management also becomes internal to the model (such constraints typically account for capacity, state of charge, eﬃciency and ramp limits of storage assets). 5. Conclusions Long-term simulations of wholesale electricity prices help to support in- vestment and policy decisions. Structural models of day-ahead markets, which enable to account for both the price formation mechanism and techno- economic constraints of the power system, are commonly used in the indus- try for such prospective studies. These models are built upon theoretical foundations and make it possible to ﬁnd an optimal price corresponding to the maximization of social welfare. Nevertheless, empirical testing of models contributes to verify that the theory reliably accounts for the observations, and data-driven approaches can help to reduce the gap between theory and practice. While many models developed for electricity price forecasting are presented in the academic literature, methods speciﬁcally designed for long- term considerations that propose to combine optimization and statistical ap- proaches are less common. In this paper, we propose a model which meets the 33 aforementioned criteria. Having a bottom-up approach with a high granular- ity starting from production units for the supply side allows us to introduce a detailed and modular formulation of the market orders, which is suitable to properly leverage the power system and market data. We introduced a calibra- tion method of structural model parameters capable of exploiting real data in a diﬀerentiated fashion by considering the production classes separately, emphasizing key market conditions and integrating additional price informa- tion from real supply curves data. The method has been validated using data relating to the French market from 2015 to 2018. The global price dynamics, especially the hourly and weekly variations, has been captured by the cali- brated model on out-of-sample tests. However the amplitude of price spikes is underestimated and could be the focus of future work for the more speciﬁc formulation of the orders’ prices. The case study shows that the calibration of parameters using real data improves the accuracy of the simulations. More- over, the calibrated model reaches performances on historical data that are close to the ones obtained using purely data-driven methods, while also ful- ﬁlling our requirement regarding the possibility to explicitly model changes in the electricity mix or market design. A sensitivity analysis revealed the importance of initially conﬁguring the model with a realistic merit order to ensure that the model parameters are properly calibrated. For future work, the model can be extended by incorporating additional technical constraints, such as ramp rate limits of generation units, and by modelling additional market orders corresponding to the demand side ﬂexibility. Finally, scenar- ios corresponding to the likely or desired evolution of the power system can be formulated and be used with our calibrated model thanks to Monte-Carlo simulations in order to estimate the possible consequences of the considered changes on wholesale electricity prices. Acknowledgements This work was partially supported by a PhD grant from the French agency for ecological transition (ADEME) and the Association pour la Recherche et le Développement des Méthodes et Processus Industriels (ARMINES). The authors would like to thank ENTSO-E, EPEX SPOT, the French Ministry for the Ecological Transition, Meteo France, Open Power System Data and RTE for the provision of data. 34 Declaration of interests The authors declare that they have no known competing ﬁnancial inter- ests or personal relationships that could have appeared to inﬂuence the work reported in this paper. References [1] S. Küfeoğlu, Economic Impacts of Electric Power Outages and Evaluation of Customer Interruption Costs, Ph.D. thesis, Aalto University, iSSN: 1799-4942 (electronic) (2015). URL https://aaltodoc.aalto.fi:443/handle/123456789/17867 [2] K. Mayer, S. Trück, Electricity markets around the world, Journal of Commodity Markets 9 (2018) 77–100. doi:10.1016/j.jcomm.2018. 02.001. URL http://www.sciencedirect.com/science/article/pii/ S2405851318300059 [3] T. W. Parkinson, Market Price Risks of Merchant Generation, The Elec- tricity Journal 17 (4) (2004) 33–48. doi:10.1016/j.tej.2004.01.010. URL http://www.sciencedirect.com/science/article/pii/ S1040619004000399 [4] S. J. Deng, S. S. Oren, Electricity derivatives and risk management, Energy 31 (6) (2006) 940–953. doi:10.1016/j.energy.2005.02.015. URL http://www.sciencedirect.com/science/article/pii/ S0360544205000496 [5] R. Gross, W. Blyth, P. Heptonstall, Risks, revenues and investment in electricity generation: Why policy needs to look beyond costs, Energy Economics 32 (4) (2010) 796–804. doi:10.1016/j.eneco.2009.09.017. URL http://www.sciencedirect.com/science/article/pii/ S0140988309001832 [6] C. Alasseur, O. Féron, Structural price model for coupled electricity markets, Energy Economics 75 (2018) 104–119. doi:10.1016/j.eneco.2018.07.018. URL http://www.sciencedirect.com/science/article/pii/ S0140988318302676 35 [7] R. Weron, Electricity price forecasting: A review of the state-of-the-art with a look into the future, International Journal of Forecasting 30 (4) (2014) 1030–1081. doi:10.1016/j.ijforecast.2014.08.008. URL http://www.sciencedirect.com/science/article/pii/ S0169207014001083 [8] NEMO COMMITTEE, EUPHEMIA Public Description - Single Price Coupling Algorithm (Oct. 2020). URL http://www.nemo-committee.eu/assets/files/ euphemia-public-description.pdf [9] P. F. Borowski, Zonal and Nodal Models of Energy Market in European Union, Energies 13 (16) (2020) 4182. doi:10.3390/en13164182. URL https://www.mdpi.com/1996-1073/13/16/4182 [10] L. Hirth, J. Mühlenpfordt, M. Bulkeley, The ENTSO-E Trans- parency Platform – A review of Europe’s most ambitious elec- tricity data platform, Applied Energy 225 (2018) 1054–1067. doi:10.1016/j.apenergy.2018.04.048. URL http://www.sciencedirect.com/science/article/pii/ S0306261918306068 [11] European Commission, Commission Regulation (EU) No 543/2013 of 14 June 2013 on submission and publication of data in electricity markets and amending Annex I to Regulation (EC) No 714/2009 of the European Parliament and of the Council Text with EEA relevance (Jun. 2013). URL http://data.europa.eu/eli/reg/2013/543/oj/eng [12] F. Wiese, I. Schlecht, W.-D. Bunke, C. Gerbaulet, L. Hirth, M. Jahn, F. Kunz, C. Lorenz, J. Mühlenpfordt, J. Reimann, W.-P. Schill, Open Power System Data – Frictionless data for electricity system modelling, Applied Energy 236 (2019) 401–409. doi:10.1016/j.apenergy.2018.11.097. URL http://www.sciencedirect.com/science/article/pii/ S0306261918318130 [13] ESMA launches consultation on cost of market data and consolidated tape. URL https://www.esma.europa.eu/press-news/esma-news/ esma-launches-consultation-cost-market-data-and-consolidated-tape 36 [14] R. H. Baker, J. Król, Petition for Rulemaking Regarding Market Data Fees and Request for Guidance on Market Data Licensing Practices; In- vestor Access to Market Data (2018). URL https://www.sec.gov/rules/petitions/2018/petn4-728.pdf [15] J. Lago, F. De Ridder, B. De Schutter, Forecasting spot elec- tricity prices: Deep learning approaches and empirical compari- son of traditional algorithms, Applied Energy 221 (2018) 386–405. doi:10.1016/j.apenergy.2018.02.069. URL http://www.sciencedirect.com/science/article/pii/ S030626191830196X [16] P. Vassilopoulos, Les prix des marchés de gros de l’électricité donnent-ils les bons signaux et les bonnes incitations pour l’investissement en capac- ité de production électrique ?, Ph.D. thesis, Université Paris Dauphine, PhD Thesis (Jul. 2007). [17] H.-K. Ringkjøb, P. M. Haugan, I. M. Solbrekke, A review of modelling tools for energy and electricity systems with large shares of variable renewables, Renewable and Sustainable Energy Reviews 96 (2018) 440–459. doi:10.1016/j.rser.2018.08.002. URL http://www.sciencedirect.com/science/article/pii/ S1364032118305690 [18] Joint Research Centre (European Commission), Systematic mapping of power system models, Tech. rep., Publications Oﬃce (2017). URL https://data.europa.eu/doi/10.2760/422399 [19] L. Mitridati, P. Pinson, A Bayesian Inference Approach to Unveil Sup- ply Curves in Electricity Markets, IEEE Transactions on Power Systems 33 (3) (2018) 2610–2620. doi:10.1109/TPWRS.2017.2757980. URL http://ieeexplore.ieee.org/document/8053811/ [20] C. Ruiz, A. J. Conejo, D. J. Bertsimas, Revealing Rival Marginal Oﬀer Prices Via Inverse Optimization, IEEE Transactions on Power Systems 28 (3) (2013) 3056–3064. doi:10.1109/TPWRS.2012.2234144. URL https://ieeexplore.ieee.org/abstract/document/6423235 [21] R. Chen, I. C. Paschalidis, M. C. Caramanis, P. Andrianesis, Learning From Past Bids to Participate Strategically in Day-Ahead Electricity Markets, IEEE Transactions on Smart Grid 10 (5) (2019) 5794–5806, 37 conference Name: IEEE Transactions on Smart Grid. doi:10.1109/ TSG.2019.2891747. [22] J. R. Birge, A. Hortaçsu, J. M. Pavlin, Inverse Optimization for the Recovery of Market Structure from Market Outcomes: An Application to the MISO Electricity Market, Operations Research 65 (4) (2017) 837–855. doi:10.1287/opre.2017.1606. URL http://pubsonline.informs.org/doi/10.1287/opre.2017. 1606 [23] R. Carmona, M. Coulon, D. Schwarz, Electricity price modeling and asset valuation: a multi-fuel structural approach, Mathematics and Financial Economics 7 (2) (2013) 167–202. doi:10.1007/s11579-012-0091-4. URL http://link.springer.com/10.1007/s11579-012-0091-4 [24] L. Hirth, What caused the drop in European electricity prices? A fac- tor decomposition analysis, The Energy Journal 39 (1). doi:10.5547/ 01956574.39.1.lhir. URL http://www.iaee.org/en/publications/ejarticle.aspx?id= 3031 [25] P. Beran, C. Pape, C. Weber, Modelling German electricity wholesale spot prices with a parsimonious fundamental model –Validation &application, UtilitiesPolicy 58(2019) 27–39. doi:10.1016/j.jup.2019.01.008. URL http://www.sciencedirect.com/science/article/pii/ S0957178719300359 [26] R. Carmona, M. Coulon, A Survey of Commodity Markets and Struc- tural Models for Electricity Prices, in: F. E. Benth, V. A. Kholodnyi, P. Laurence (Eds.), Quantitative Energy Finance, Springer New York, New York, NY, 2014, pp. 41–83. doi:10.1007/978-1-4614-7248-3_2. URL http://link.springer.com/10.1007/978-1-4614-7248-3_2 [27] Y. He, M. Hildmann, F. Herzog, G. Andersson, Modeling the Merit Order Curve of the European Energy Exchange Power Market in Germany, IEEE Transactions on Power Systems 28 (3) (2013) 3155–3164. doi: 10.1109/TPWRS.2013.2242497. [28] F. Ziel, R. Steinert, Electricity price forecasting using sale and pur- chase curves: The X-Model, Energy Economics 59 (2016) 435–454. 38 doi:10.1016/j.eneco.2016.08.008. URL http://www.sciencedirect.com/science/article/pii/ S0140988316302080 [29] F. Ziel, R. Steinert, Probabilistic mid- and long-term electricity price forecasting, Renewable and Sustainable Energy Reviews 94 (2018) 251–266. doi:10.1016/j.rser.2018.05.038. URL http://www.sciencedirect.com/science/article/pii/ S1364032118303885 [30] S. Kulakov, X-Model: Further Development and Possible Modiﬁcations, Forecasting 2 (1) (2020) 20–35. doi:10.3390/forecast2010002. URL https://www.mdpi.com/2571-9394/2/1/2 [31] R. Aïd, L. Campi, N. Langrené, A Structural Risk-Neutral Model for Pricing and Hedging Power Derivatives, Mathematical Finance 23 (3) (2013) 387–438. doi:10.1111/j.1467-9965.2011.00507.x. URL https://onlinelibrary.wiley.com/doi/abs/10.1111/j. 1467-9965.2011.00507.x [32] A. A. Sánchez de la Nieta, J. Contreras, Quantifying the ef- fect of renewable generation on day–ahead electricity market prices: The Spanish case, Energy Economics 90 (2020) 104841. doi:10.1016/j.eneco.2020.104841. URL https://www.sciencedirect.com/science/article/pii/ S014098832030181X [33] K. R. Ward, R. Green, I. Staﬀell, Getting prices right in struc- tural electricity market models, Energy Policy 129 (2019) 1190–1206. doi:10.1016/j.enpol.2019.01.077. URL http://www.sciencedirect.com/science/article/pii/ S0301421519300564 [34] C. Pape, S. Hagemann, C. Weber, Are fundamentals enough? Explaining price variations in the German day-ahead and in- traday power market, Energy Economics 54 (2016) 376–387. doi:10.1016/j.eneco.2015.12.013. URL http://www.sciencedirect.com/science/article/pii/ S0140988316000037 39 [35] V. Mahler, R. Girard, S. Billeau, G. Kariniotakis, Simulation of day- ahead electricity market prices using a statistically calibrated structural model, in: 2019 16th International Conference on the European En- ergy Market (EEM), 2019, pp. 1–5, iSSN: 2165-4093. doi:10.1109/ EEM.2019.8916273. [36] X. Xia, A. M. Elaiw, Optimal dynamic economic dispatch of generation: A review, Electric Power Systems Research 80 (8) (2010) 975–986. doi:10.1016/j.epsr.2009.12.012. URL http://www.sciencedirect.com/science/article/pii/ S0378779610000027 [37] S. Y. Abujarad, M. W. Mustafa, J. J. Jamian, Recent approaches of unit commitment in the presence of intermittent renewable energy resources: A review, Renewable and Sustainable Energy Reviews 70 (2017) 215–223. doi:10.1016/j.rser.2016.11.246. URL http://www.sciencedirect.com/science/article/pii/ S1364032116310140 [38] Open Power System Data, Data Package Time series, . Version 2019-06- 05. doi:10.25832/time_series/2019-06-05. [39] RTE, ADEME, Signal prix du CO2, Analyse de son impact sur le système électrique européen (Mar. 2016). URL https://presse.ademe.fr/wp-content/uploads/2016/04/ Signal-prix-du-CO2_finale_29-03-16.pdf [40] W. S. Cleveland, E. Grosse, W. Shyu, Chapter 8 - Local regression mod- els, in: Statistical Models in S, Chapman and Hall/CRC, 1992, p. 624. 40","libVersion":"0.3.2","langs":""}