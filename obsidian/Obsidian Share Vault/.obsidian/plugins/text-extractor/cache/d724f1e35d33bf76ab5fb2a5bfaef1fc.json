{"path":"lit/lit_sources.backup/Giabardo10feedbackElecMkt.pdf","text":"General rights Copyright and moral rights for the publications made accessible in the public portal are retained by the authors and/or other copyright owners and it is a condition of accessing publications that users recognise and abide by the legal requirements associated with these rights.  Users may download and print one copy of any publication from the public portal for the purpose of private study or research.  You may not further distribute the material or use it for any profit-making activity or commercial gain  You may freely distribute the URL identifying the publication in the public portal If you believe that this document breaches copyright please contact us providing details, and we will remove access to the work immediately and investigate your claim. Downloaded from orbit.dtu.dk on: Aug 07, 2023 Feedback, competition and stochasticity in a day ahead electricity market Giabardo, Paolo; Zugno, Marco; Pinson, Pierre; Madsen, Henrik Published in: Energy Economics Link to article, DOI: 10.1016/j.eneco.2009.09.006 Publication date: 2010 Document Version Early version, also known as pre-print Link back to DTU Orbit Citation (APA): Giabardo, P., Zugno, M., Pinson, P., & Madsen, H. (2010). Feedback, competition and stochasticity in a day ahead electricity market. Energy Economics, 32(2), 292-301. https://doi.org/10.1016/j.eneco.2009.09.006 Feedback, competition and stochasticity in a day-ahead electricity market I Paolo Giabardoa, Marco Zugnoa, Pierre Pinson∗,a, Henrik Madsena aDTU Informatics, Technical University of Denmark, Richard Petersens Plads 321 DK-2800 Kgs. Lyngby, Denmark Abstract Major recent changes in electricity markets relate to the process for their deregulation, along with increasing participation of renewable (stochastic) generation e.g. wind power. Our general objective is to model how feedback, competition and stochasticity (on the production side) interact in electricity markets, and eventually assess what their eﬀects are on both the participants and the society. For this, day-ahead electricity markets are modeled as dy- namic closed loop systems, in which the feedback signal is the market price. In parallel, the Cournot competition model is considered. Mixed portfolios with signiﬁcant share of renewable energy are based on stochastic threshold cost functions. Regarding trading strategies, it is assumed that generators are looking at optimizing their individual proﬁts. The point of view of the society is addressed by analyzing market behavior and stability. The performed simulations show the beneﬁcial eﬀects of employing long term bidding strategies for both generators and society. Sensitivity analyses are performed in order to evaluate the eﬀects of demand elasticity. It is shown that increase in demand elasticity reduces the possibility for the generators to exploit their market power. Furthermore, the results suggest that intro- duction of wind power generation in the market is beneﬁcial both for the generators and the society. IPaolo Giabardo and Marco Zugno contributed to this work at a similar level and should both be seen as main contributor and main author. ∗Corresponding author. DTU Informatics, Technical University of Denmark, Richard Petersens Plads, bg. 321(020), DK-2800 Kgs. Lyngby, Denmark. Tel. +45 4525 3428. Fax. +45 4588 2673 Email addresses: paolo.giabardo@gmail.com (Paolo Giabardo), marco.zugno@gmail.com (Marco Zugno), pp@imm.dtu.dk (Pierre Pinson), hm@imm.dtu.dk (Henrik Madsen) Preprint submitted to Energy Economics September 7, 2009 Key words: JEL: Q 41, electricity markets, strategic bidding, renewable energy, stochastic control theory, optimization 1. Introduction Power markets worldwide have been monopolistic for the most part of the 20th century, but in the recent years they have undergone a signif- icant restructuring process. In fact, since the 1980s, the trend in many countries has been to reshape the traditional regulated power industry in a more open way, with the aim of encouraging competition and increasing its eﬃciency. Several structures for deregulated energy markets have been proposed over the years in diﬀerent countries. Among these, the power pool (poolco type, see Garber et al. (1994)) has been the most successful one. It is also the structure of the electricity market that is addressed by this work, in which emphasis is on the NordPool day-ahead market (NordPoolSpot website, 2009). The existing literature on the subject underlines two distinctive features of day-ahead electricity markets: they are dynamic and stochastic. Addi- tionally to these two aspects, competition exists as the central mechanism for market eﬃciency. The ﬁrst feature is basically due to the non-storability of energy in big amounts. As a result, demand and oﬀer of energy must be balanced at ev- ery instant. The cost function for the GENCOs is usually increasing with respect to the quantity produced: hence, the higher the demand, the higher the cost. The demand has large variations over time, both on a daily and on a seasonal scale, so will do the cost. This also holds for the case of the NordPool day-ahead market, whose dynamic characteristics have been well acknowledged, for instance in Erzgr¨aber et al. (2008) and Bask et al. (2007). The predominant approach in the literature so far has been to con- sider the auctioning periods as independent of each other. The techniques used span from stochastic optimization either through Markov decision pro- cess (among the many, Song et al. (2000)) or genetic algorithm (Richter and Sheble (1998)), to Lagrangian relaxation (Guan et al. (2001)), stochastic dynamic programming (Ni et al. (2004)) and game theory based algorithms (Park et al. (2001)). Generally, this approach has led to the development of strategies that overlook the market dynamics. As a matter of fact, the period to period interrelation between the bids and the periodicity in the demand characteristic represent just two straightforward arguments substantiating 2 the importance of modeling the energy market as a dynamic system. Never- theless, as of now, little of the existing work has undertaken this direction; among the few exceptions Alvarado (1997), Liu (2006) and Conejo et al. (2002). The second important characteristic of energy markets, besides the in- herent dynamics, is the presence of uncertainty. This is not a brand new issue, and has already been analyzed in the literature (among the many Singh (2008), Liu (2006), Wen and David (2001), Swider and Weber (2006)) whose approaches can be divided into two main branches. The ﬁrst one con- siders systems in which the demand function is stochastic, as in Liu (2006). The second approach, instead, emphasizes the diﬃculty of estimating pre- cisely the competitors’ behavior and, hence, models their bids as stochastic, as in Wen and David (2001). However, especially in the recent years, the trend has been to increase the share of electricity generated from renewable energy sources, as a result of the growing attention paid to environmental issues. Renewable energy generation is by nature uncertain, although to diﬀerent extents depending on the diﬀerent sources. Indeed, it turns out (see J´onsson et al. (2009)) that its inclusion in the market on a signiﬁcant scale pushes the eﬀect of the two aforementioned sources of uncertainty into the background. In this article a dynamic and stochastic model of energy markets pene- trated by wind power production is presented. Our objective is to investigate the unexplored topic stemming from the combination of dynamic modeling and stochasticity in the production. We focus on the interrelation between the bids placed for the same auctioning periods in following days, since it represents the most relevant dynamic feature of power markets, as shown, for instance, by the daily periodic pattern of the demand function. Regarding the stochasticity, ideally, all sources of uncertainty should be accounted for. Here it is decided to focus speciﬁcally on the supply side, which, as men- tioned above, represents the dominant source of uncertainty for markets signiﬁcantly penetrated by renewable energy production e.g. wind energy. The accounting of both these features renders our work relevant insofar as it gives a particularly faithful description of the real markets as they have evolved in the recent years. The feature that makes our approach innovative is represented by the fact that stochastic cost functions are considered for the generators. Then, stochastic optimal control theory is used in the derivation of the dynamic model. Our belief is that control theory represents an eﬀective tool for describing and modeling electricity markets. This conﬁdence springs mainly from two observations. Firstly, modeling the electricity market as a closed 3 loop dynamic system permits developing further insight into the market e.g. on its stability properties, which cannot be obtained through static models. In parallel, optimal control theory allows for the development of advanced strategies which are not conceivable in a static framework. The second advantage of using control theory lies in the fact that it allows accounting for the stochastic features of electricity markets, which leads to the derivation of optimal bids in a stochastic sense, based on e.g. maximizing revenue expectation. This ﬁnally results in implementing the interaction between the competitive behavior of the participants, feedback and uncertainty and how they inﬂuence the functioning of deregulated power markets. Following a common trend in the literature (Andersson and Bergman (1995), Kahn (1998), Hogan (1997), Willems (2002)), the Cournot com- petition model is used. In this framework, the bid of a generator is the quantity of energy it is willing to deliver to the market in a given auctioning period. The popularity of this model in the existing literature has sound motivations. On the one hand, it provides a more realistic description of the mechanisms of electricity markets than the Bertrand competition model (Hobbs (1986), Aghion and Bolton (1987)), in which players bid the price of the energy they sell. On the other hand, it is relatively simple if compared to the supply function model (studied in Klemperer and Meyer (1989), Green and Newbery (1992), Bolle (1992), Rudkevich (1999), Baldick et al. (2002)), fact that in the case of this work allows an analytical solution of the prob- lem. Although not presented here, the supply function competition model has been considered as well in our study. The interested reader is referred to Giabardo and Zugno (2008) for a complete treatment. The present paper is organized as follows. Section 2 presents the devel- opment of the mathematical model for energy markets and introduces the day ahead strategy, that is the simplest of the optimal strategies consid- ered. In a second stage, Section 3 is dedicated to the derivation of the more advanced bidding strategy, called long term. The implementation of the system is subsequently presented in Section 4, along with comments on the main results of its simulation. Conclusions are ﬁnally gathered in Section 5, along with perspectives regarding further work. 2. Problem formulation as a dynamic stochastic system With Alvarado (1999) and Liu (2006) as sources of inspiration, the Cournot competition is modeled as a closed loop system, where the feed- back signal is the price (which is always made public in restructured energy markets) while the control signals are the individual bids of the generators, 4 that is quantities. The structure of the energy market, which is divided into hourly bidding rounds, suggests discrete time as the straightforward framework. A GENCO that sells energy in a deregulated market usually acts with the objective of maximizing its proﬁts. A ﬁrm behaving this way is said to be rational. Rationality is a key concept in classical game theory; the interested reader is referred to Binmore (2008) for further reading. Possible exceptions to the pure rational behavior are found in cases in which the GENCO’s strategy is constrained by governmental regulations. The basic assumption in this article is that all the competitors are rational and the collusion between them, which is forbidden by antitrust laws, is excluded. At ﬁrst, the day ahead strategy is developed, aimed to optimize the proﬁts of a GENCO in the successive bidding round. The main idea behind this strategy is that each rational generator will keep on increasing its bid over time as long as the system price is higher than its marginal cost. The system price, in turn, is determined by the combined eﬀect of both demand and supply, so it is a function of the bids of the generators. Therefore, this kind of competition is a closed loop system, in which the publicized information (the output) is fed back to each GENCO before the next bidding round, and used to formulate the next bid. Figure 1 gives a sketch of the system. !\"#\"$%&'$()( *+,(,-.+/+01( !\"#\"$%&'$(#( *+,(,-.+/+01( 2( 3)( 34( 3#( 5(6(6(6( !\"#\"$%&'$(4( *+,(,-.+/+01( 78'( 9:;<-=( >?-:;+1@( 8A8&\"9(B\"9%#B( Figure 1: Closed loop dynamic model for the energy market. Let us now introduce the notation that is employed below in the formu- lation of the problem as a dynamic system. The Cournot competition can be modeled by a state space whose variables are the quantities bid by each generator. For generator i, the amount of bid energy is indicated with xi. In order to determine the behavior of a generating company, its cost function must be deﬁned. As a matter of fact, the cost function for a GENCO depends 5 on its production mix. Basically, two production technologies dominate the Danish electricity market, which is the main focus of this article: conven- tional thermal production and wind power, which account for, respectively, about 85% and 15% of the market. Generally, the existing literature on the subject (for instance see Martini et al. (2001), Yu et al. (1998), Alvarado (1997)) considers quadratic cost functions as a good approximation of the costs of a generator using thermal plants. Furthermore, it is known that for wind production plants the running cost is basically null with the exception of the maintenance and the startup costs. Therefore, the cost function turns out to be piecewise deﬁned (the symbol ˜ denotes a stochastic variable): Cp i =    aw,i(t), ˜xi,t(t) ≤ ˜xi,w(t) aw,i(t) + ai(t) + bi(t)˜xi(t) + 1 2 ci(t)˜xi(t)2, ˜xi,t(t) > ˜xi,w(t) (1) where ˜xi,t(t) is the quantity of energy produced in total by the i-th genera- tor, ˜xi,w(t) is the quantity of wind energy and ˜xi(t) = ˜xi,t(t) − ˜xi,w(t) is the quantity of energy produced with other technologies. It is straightforward from the chosen notation that the cost of producing ˜xi,w(t) is aw,i(t), which is independent of the amount of wind energy, while the cost of producing ˜xi(t) is the quadratic function ai(t) + bi(t)˜xi(t) + 1 2 ci(t)˜xi(t)2. The coef- ﬁcients aw,i(t), ai(t), bi(t) and ci(t) are generally time dependent, though later in this article they will be assumed constant. Such assumption is motivated by the fact that the time scale of signiﬁcant changes (e.g. ﬂuctu- ations in the cost of fuel) is much longer than the time window considered in the optimization process. An example of a possible cost function and the corresponding marginal cost can be found in Figure 2. As one can see, both the functions are characterized by two properties: they are piecewise deﬁned and the threshold ˜xi,w(t) is a stochastic process. In practice for mar- ket participants with mixed portfolios, the successive cost functions could be estimated based on forecasts of wind power production for each market time unit in the coming period. This is the situation that will be considered in the simulation test case below. In further developments however, it would be an additional value to also account for uncertainty in those wind power forecasts — a review of the state of the art in wind power forecasting is available in Giebel et al. (2003) and Costa et al. (2008), scenarios of succes- sive cost functions could be based on scenario forecasts of short-term wind power production, see discussion by Pinson et al. (2009). Both the features described above target at being a realistic description of the cost for the generators. In fact, the cost function is seldom just a 6 !\"#$%&'( )*+&( #,-.( /,-.( !\"#$%&'( 0#12,$#3( )*+&( /,-.( Figure 2: Example of a stochastic threshold cost function (left) for a port- folio with signiﬁcant share of stochastic generation e.g. wind power and the corresponding marginal cost function (right). quadratic (or constant) function of the produced quantity, as the generators rarely employ only thermal (or wind) production but generally a mix of these and other techniques. Furthermore, one must take care of the fact that gen- eration technologies that are stochastic by nature (for example, again, wind or hydro power) introduce stochastic quantities in the deﬁnition of the cost function, such as the threshold in the case of wind production. As a matter of fact, very little work exist in the literature in which cost functions of this kind have been considered, although it is clear that a realistic description of the generation costs is paramount if one aims at developing an eﬃcient bidding policy. The virtues of this approach extend, with null or little ef- fort, to basically all the cases in which producers have to deal with mixed portfolio generation, especially when one or more production technologies involving uncertainty are used, which is the latest trend in the industry as renewable sources are being encouraged more and more by the international environmental policies. Other issues, such as the stochastic cost of fuel on a long term scenario planning, can be covered with a similar approach. The described setup leads to a high complexity in the development of the long term strategy, insofar as the solution to the optimization problem requires the deﬁnition of a tree including all the possible cases and the eval- uation of the proﬁts in each branch of the tree. Therefore, a simpliﬁcation has been introduced, consisting in assuming that the bid of a producer is always greater or equal to the wind energy that it reckons it is going to produce: ˜xi,t(t) ≥ ˜xi,w(t). This assumption is realistic since the wind, along with hydro, is the cheapest source of energy available. Therefore, in the 7 real market, the bids corresponding to wind energy are the most likely to be accepted. Hence, the cost function of a producer becomes Ci(˜xi(t)) = aw,i(t) + ai(t) + bi(t)˜xi(t) + 1 2 ci(t)˜xi(t)2 (2) The optimization procedure, thus, can be carried out on the amount ˜xi(t) of energy produced with technologies other than wind power, since the quantity ˜xi,w(t) is going to be bid anyway by the producer. As far as the demand is concerned, the existing literature (for instance see Powell (1993) and Songa et al. (2003)) suggests to model it by means of the linear inverse demand function p(t) = e(t) − f (t)D(t) (3) where p(t) is the system price, D(t) is the total demand. By deﬁnition, the parameters e(t), f (t) are both positive, since this function is positive valued at D(t) = 0 and decreasing. It is to be noticed that the demand function is given by D(t) = α(t) − β(t)p(t) (4) where α(t) = e(t)/f (t) and β(t) = 1/f (t). The instantaneous balance of supply and demand due to the non-storability of energy requires ˜D(t) = N∑ i=1 ˜xi,t(t) (5) Hence, (3) becomes ˜p(t) = e(t) − f (t) N∑ i=1 ˜xi,t(t) = e(t) − f (t) N∑ i=1 (˜xi(t) + ˜xi,w(t)) (6) The price is now itself a stochastic quantity, along with the proﬁt, which is given by ˜πi(t) = ˜p(t) (˜xi(t) + ˜xi,w(t)) − Ci(˜xi(t)) (7) which is simply the subtraction of the production costs Ci(˜xi(t)) from the total revenues of the ﬁrm ˜p(t) (˜xi(t) + ˜xi,w(t)). A rational ﬁrm, in order to maximize the level of proﬁts, should place the quantity bid ˜xi(t) such that 8 the following ﬁrst order condition is satisﬁed d˜πi(t) d˜xi(t) = 0 (8) This condition expressing the optimal behavior of a competitive producer in a deregulated market is customarily used in the literature (see Alvarado (1999) and Liu (2006)). Collaborative bidding and network eﬀects could also aﬀect the players’ decisions, thus leading to a diﬀerent condition for optimality. Nevertheless they have been ruled out in this work, the former one because it is forbidden by antitrust laws and the latter one for the sake of simpliﬁcation. Actually, it is diﬃcult for a ﬁrm to satisfy this condition in every bidding round since this would require it to change its energy produc- tion level with an inﬁnite velocity. A more realistic strategy for a GENCO is instead based on repeated adjustments of the bid quantity ˜xi(t) in successive bidding rounds. A suitable model could be developed supposing that the i-th generator adjusts its bid depending on the derivative of the proﬁt ˜πi at the next bidding round with respect to the bid quantity ˜xi ˜xi(t + 1) − ˜xi(t) = ki(t + 1) ∂ ˜πi(t + 1) ∂ ˜xi(t + 1) ∣ ∣ ∣ ∣˜xi(t+1)=˜xi(t) , ki(t + 1) > 0 (9) where ˜xi(t) is the quantity bid for a certain hour of the current day and ˜xi(t + 1) is the quantity to be bid for the same hour of the next day, so that the adjustment process is split into 24 diﬀerent hourly calculations. This split is justiﬁed by the fact that the consumption of energy, and thus the characteristics of the demand, are basically constant at the same hour of two successive days. Actually, the consumption during the weekend days is lower than the consumption during the weekdays, so another split of the model should be done, resulting in 48 distinct adjustment calculations (24 for the weekdays, one for each hour, and 24 for the weekend days). This makes sense since the production adjustment is most proper when calculated on the quantity produced at the same hour of the most recent day of the same type. The rationale for such a model consists in the fact that the energy production is adjusted in the direction of increasing proﬁts. The parameter ki in the previous equation indicates a sort of speed of adjustment with which the i-th generator alter its energy production according to the possibility of an increase/decrease in the proﬁt. After some algebra, which is described in Appendix A, the day ahead 9 bidding strategy can be expressed by the following equation: ¯xi(t + 1) = [1 − ki(t + 1)(2f (t + 1) + ci)] ¯xi(t) − ki(t + 1)f (t + 1)     N∑ j=1 j̸=i (¯xj(t) + ¯xj,w(t)) + 2¯xi,w(t + 1)     + ki(t + 1) (e(t + 1) − bi) (10) which actually models a strategy aimed to optimize the proﬁts in the next round for a producer having both conventional thermal and wind production plants. It is beneﬁcial to specify here that the next round, in this frame- work, actually means the same hour for the successive day of the same type (weekend day or weekday). The amount of conventional energy ¯xi(t + 1) to be bid for the subsequent day by the i-th generator is thus a function of the quantity bid by itself ¯xi(t) and by the other generators ¯xj(t), j ̸= i at the previous bidding round, as well as of the estimated wind production ¯xi(t + 1) and ¯xj(t). The i-th producer can have estimates on its future wind production, while for the competitors’ this is generally not an easy task. As far as the bids for the conventional production are concerned, while ¯xi(t) is perfectly known by the i-th generator, ¯xj(t), j ̸= i are not, since the quantities assigned to the various generators at each round are known only to the respective producer, and not disclosed to any competitors by NordPool. Fortunately, since as one can see in (10) only the sum of the aggregate of the conventional and wind production for all the competitors is needed, one can determine it as N∑ j=1 j̸=i xj(t) + xj,w(t) = D(t) − (xi(t) + xi,w(t)) (11) where D(t) indicates the total production at time t, information that is made available by NordPool. Furthermore, as it is apparent in the equation above, the decision of the bid ¯xi(t + 1) involves the estimation of the coeﬃcients e(t + 1) and f (t + 1) at the next round, which can be calculated making use of historical data. Furthermore, Appendix A shows that the behavior of the competitors on the electricity market can be modeled by the following stochastic state space model: ˜x(t + 1) = F(t)˜x(t) + ˜ϵex(t) (12) 10 where ˜x(t) = [˜x1(t) ˜x2(t) . . . ˜xN (t) ]T Fii(t) =1 − ki(t + 1)(2f (t + 1) + ci), i = 1, 2, . . . , N Fij(t) = − ki(t + 1)f (t + 1), i, j = 1, 2, . . . , N , i ̸= j ˜ϵex,i(t) = − ki(t + 1)f (t + 1)    2˜xi,w(t + 1) + N∑ j=1 j̸=i ˜xj,w(t)     + ki(t + 1) (e(t + 1) − bi) (13) It is to be noticed that the uncertainty connected with the presence of stochastic production technologies, such as wind power, is modeled this way as an Additive White Gaussian Noise (AWGN), included in the ˜ϵex,i(t) term in (13). The additivity and the Gaussianity are implicit in the derivation of the linear state space system, which is described step by step in Appendix A. Furthermore, the assumption of whiteness (i.e. independence of succes- sive residuals) is a simpliﬁcation needed in order to carry out the multi-step optimization described in the following section. As a future development it could be interesting to introduce a more realistic description of the stochas- ticity, dropping the assumption of Gaussianity and whiteness that are known to not exactly model the wind power production. 3. Optimal control: long term strategy Let us now assume that a GENCO is interested in developing a new strat- egy, able to maximize its proﬁts over a longer time window than the single next bidding round. In order to develop this strategy, some assumptions must be made on the behavior of the competitors for which the state space model presented above is a good starting point. The procedure followed in this section resembles that of Liu (2006), but with a diﬀerent approach re- garding the inclusion of uncertainties in the model. Basically, in Liu (2006) a state space is deﬁned to model the market dynamics, and then optimal control theory is employed to obtain the long term strategy. However, while in Liu (2006) uncertainty is included in the demand side, in this work a stochastic cost function is considered, thus leading to a diﬀerent optimiza- tion problem. The key points in the derivation of the optimal strategy are described in Appendix B; for a more complete treatment the reader is re- ferred to Giabardo and Zugno (2008). 11 Let us assume, without loss of generality, that the generator interested in pursuing a long period optimization is the N -th generator. Hence its amount of bid energy becomes the input to the system, that means performing the substitution ˜xN = u. This results in the loss of the stochastic character of the variable, since it becomes the decision variable of the producer, and thus deterministic. Denoting with Nh the number of days (or steps) included in the optimization horizon, the index to be maximized is the expectation of the sum of the proﬁts1 JN (t) = E { t+Nh−1∑ τ =t πN (τ ) } = E { t+Nh−1∑ τ =t ˜p(τ ) (u(τ ) + ˜xN,w(τ )) − CN (u(τ )) } (14) Redeﬁning the state space as ˜x(t) = [˜x1(t) ˜x2(t) . . . ˜xN −1(t)]T (15) The input and the output of the system are, respectively, the quantity bid by the N -th generator and the system price u(t) = xN (t) , ˜y(t) = ˜p(t) Now the state space is described by the following set of equations ˜x(t + 1) = F(t)˜x(t) + G(t)u(t) + ˜ϵex(t) (16) ˜p(t) = C(t)˜x(t) + D(t)u(t) + ˜ep(t) (17) where the state space matrices are deﬁned as follows Fii(t) = 1 − ki(t)(2f (t + 1) + ci), i = 1, 2, . . . , N − 1 (18) Fij(t) = −ki(t)f (t + 1), i, j = 1, 2, . . . , N − 1, i ̸= j (19) 1The optimization index could alternatively be deﬁned in order to reﬂect the risk- aversion of market participants, by accounting for the variance of the distribution of potential proﬁts, or with value-at-risk principles. 12 G(t) =      −k1(t)f (t + 1) −k2(t)f (t + 1) ... −kN −1(t)f (t + 1)      (20) C(t) = [−f (t) −f (t) . . . −f (t)] (21) D(t) = −f (t) (22) ˜ϵex,i(t) = ki(t)f (t + 1)    2˜xi,w(t + 1) + N∑ j=1 j̸=i ˜xj,w(t)     + ki(t) (e(t + 1) − bi) , i = 1, 2, . . . , N − 1 (23) ˜ep(t) = e(t) − f (t) ( N∑ i=1 ˜xi,w(t) ) (24) After some calculations, which follow the general theory of maximization on a dynamic system with the inclusion of stochastic terms, as described in Appendix B, one gets the following optimal control rule: u(t) = GT (t)S(t + 1)F(t) + C(t) cN − 2D(t) − G(t)T S(t + 1)G(t) · (F(t − 1)¯x(t − 1) + G(t − 1)u(t − 1) + ¯ϵex(t − 1) ) + GT (t)(S(t + 1)¯ϵex(t) + M(t + 1)) − b1 + en p (t) cN − 2D(t) − G(t)T S(t + 1)G(t) (25) where S(t) and M(t) are auxiliary matrices that can be calculated through the following backward relations: S(t) =C T (t) C(t) cN − 2D(t) + ( CT (t)GT (t) cN − 2D(t) + FT (t)) · S(t + 1)[(cN − 2D(t)) − G(t)G T (t)S(t + 1)]−1 · [(cN − 2D(t))F(t) + G(t)C(t) ] (26) 13 and M(t) = C T (t) [ −bN + en p (t) cN − 2D(t) + ¯xN,w(t) ] + ( CT (t)GT (t) cN − 2D(t) + FT (t) ) · { M(t + 1) + S(t + 1) [(cN − 2D(t)) − G(t)G T (t)S(t + 1)]−1 · [(cN − 2D(t))¯ϵex(t) + G(t) (G T (t)M(t + 1) − bN + en p (t) )] } (27) The ﬁnal conditions S(t+Nh) = 0 and M(t+Nh) = 0 can be imposed, mean- ing that the ﬁnal state of the system has no inﬂuence on the optimization index. 4. Implementation and simulation of the system This section presents the main results obtained with the simulations performed after the implementation of the system described above. As a matter of fact, the implementation of these strategies requires some knowledge of the market, that means having a good estimation of the pa- rameters describing the dynamic model introduced above. Indeed, the co- eﬃcients of both the inverse demand function and the cost function appear in the equations regulating both the Cournot and the long term optimiza- tion strategies. As a matter of fact, an estimation of these parameters is very diﬃcult due to the understandable conﬁdentiality policies of both the producers and NordPool. As far as concerns the cost function of the producers, the values ai = 10, bi = 1.5, ci = 0.0001 are a slight modiﬁcation of the ones used in Liu (2006) and should be realistic in modeling the cost function of a pro- ducer employing conventional energy sources whose output is around 20000− 30000 MW, which is, on average, about half of the consumption in the Scan- dinavian market. The coeﬃcient aw,i(t) accounting for the energy produced with wind has been set to the value 10, without any loss of generality in the optimization procedure. As a simpliﬁcation, only two generators with equal cost functions have been included in the simulation. As far as concerns the inverse demand function, this work simulates the system with three diﬀerent values of its slope β, in accordance to what has been done in Oca˜na and Romero (1998). In order to obtain a realistic demand curve, an approach similar to the one used in the MARS model2 2The MARS model is a market simulation tool developed by Energinet.dk, which is the Danish ISO. A description of it can be found in Donslund and Kristoﬀersen (2006). 14 has been followed: the passage of the linear demand function for the point (qm,i, py) is imposed, where py is the yearly mean price and qm,i is the monthly average consumption of energy in NordPool at the i-th hour of the day (data on price and consumption have been provided by NordPool). The coeﬃcient β in the demand function is then set to a value close to, respectively, 1000, 1500 or 2000. Figure 3 presents an explanatory sketch of the three cases. !\"#$%& '()#& *%(+,*& !-& ./0111& !\"#$%& '()#& *%(+,*& !-& ./2111& !\"#$%& '()#& *%(+,*& !-& ./0311& Figure 3: Sketch of three possible linear demand functions passing by the point (qm,i, py). On the left, the least elastic one, obtained with β ≈ 1000. In the center, the medium elasticity linear demand, obtained with β ≈ 1500. On the right, the most elastic demand function (β ≈ 2000). The time window considered in all the simulations performed is the whole month of April 2007. This choice avoids the extrema, namely the cold- est/darkest and the warmest/brightest weeks of the year, so that it is more representative of an average behavior of the market. Furthermore, the pres- ence of sudden spikes in the price due to unpredictable events (e.g. failure of an interconnection in the grid), which of course also aﬀect the consumption of energy, was very limited in the selected period. A further investigation and analysis of these issues can be found in Giabardo and Zugno (2008). Figure 4 shows the dynamics of the spot price in NordPool and the wind power production in Denmark during the considered period. It has been deemed convenient to simulate the system in two diﬀerent conditions: the ideal one, in which the producers know exactly the quantity of wind power they will have in the future (perfect information), and the real one, in which the producers can only estimate this quantity by forecasting. Power measurements and forecasts aggregated for two diﬀerent groups of wind farms in western Denmark representing geographically spread wind portfolios have been used. In this work, WPPT (Wind Power Prediction Tool, see Nielsen et al. (2002) and Nielsen (2002)) is employed to provide estimates at every hour of the day up to 43 hours ahead. Every day, the available forecasts at noon are used. This actually means that the ﬁrst 12 forecasts have to be discarded, since they cover the hours from the 13th to 15 100 200 300 400 500 600 700 0 5 10 15 20 25 30 time [h]price [EUR] (a) NordPool spot price 100 200 300 400 500 600 700 0 0.5 1 1.5 2 2.5 time [h]quantity [GWh] Wind Power DK−West Wind Power DK−East (b) Wind power production in Denmark Figure 4: NordPool spot price and wind power production in both the Dan- ish market areas during April 2007. the 24th of the current day, for which the bids have already been placed (on the previous day). Therefore, only 31 values of forecasts are available for use. In cases in which longer forecasts are needed, namely the simulations involving the long term strategy, the forecast vector has been prolonged keeping the values from the 32nd to the end equal to the 31st value, that is the last available forecast. Figure 5 shows a possible forecast used in the system. Measurements and values forecasted by the WPPT are given as numbers in the range [0 1], which indicate the quantity of wind power as a fraction of the total installed capacity. These values have been scaled in the simulations in order to ensure a percentage of wind power included in the range 10−20% of the total production, which is approximately the share of power produced by wind plants in Denmark as of now (see NordPoolSpot website (2009)). In order to obtain such ﬁgures with the wind proﬁle used in the simulations, 16 Figure 5: Example of WPPT forecast issued at noon. The shaded area in the ﬁgure covers the ﬁrst 12 hours ahead, which are discarded. The horizontal line on the right side of the ﬁgure is due to the fact that WPPT predictions reach out to 43 hours ahead: the forecasts needed in excess are kept constant to the last predicted value. the nominal wind power capacity for each generator has been set equal to 12000 MW. The results of the simulations will be evaluated by means of diﬀerent in- dices, averaged over the simulation period: the produced quantity (measured in M W h), the daily proﬁt, the system price and the daily social welfare (all measured in e). The deﬁnition of these indices is straightforward, excep- tion made for the daily social welfare. Following the argument in Amelin (2004), this is deﬁned as the integral of the diﬀerence between the inverse demand function and the aggregate marginal cost of all the producers over the quantity from the origin to the total quantity cleared by the ISO, which is the (both light and dark) gray shaded area in Figure 6. The social welfare thus represents the overall beneﬁt of the society, being it the summation of the consumers’ beneﬁt in purchasing the energy at the system price pISO (light gray shaded area in Figure 6) and the producers’ proﬁt in selling the energy at the clearing price (dark gray shaded area the ﬁgure). It is to notice that such a deﬁnition of the daily social welfare leaves one degree of freedom, that is the constant term resulting from the integration. Ideally, this term should account for the ﬁxed installation costs of the gener- ation plants, of the grid etc., all scaled by the ratio between the simulation 17 time and the lifetime of each asset. This term represents a constant bias if comparing simulations of the same system in diﬀerent conditions (e.g. dif- ferent demand elasticity), so it is obvious that it can be discarded. On the other hand, when comparing simulations involving diﬀerent systems (e.g. with a diﬀerent production mix), all the ﬁxed installation costs should be accounted for by this constant term for a realistic assessment of the social welfare. One can see that this task is particularly challenging, since not only the installation costs of the plants should be determined, but even the installation costs of a grid able to support the decentralized production through wind power and other less tangible issues, such as the reduction of CO2 emissions. Although interesting, this analysis goes beyond the scope of this paper and the deﬁnition of social welfare with null constant term is used hereafter.quantitypriceISO cleared quantityinversedemand functionaggregate marginal costpISO Figure 6: The social welfare (light and dark gray shaded area) is deﬁned as the integral between the inverse demand function and the aggregate marginal cost of all the producers. 4.1. Bidding strategies The simulations described in this subsection have been carried out in order to evaluate the introduction of the strategies developed in Section 2 as models for the generators’ bidding. 18 Another strategy, named “naive”, is to be deﬁned in order to model the behavior of a generator that does not bid strategically. This simple strategy presupposes that the total bid at a certain hour of the day is kept constant: xi(t + 1) + ¯xi,w(t + 1) = xi(t) + ¯xi,w(t). Therefore, assuming that the market needs a certain amount of energy, a producer following the naive strategy will bid τ percentage of the total energy needed, where τ is equal to its percentage of the total installed capacity (in this simpliﬁed case: τ = 50%). The aim is to show that, in contrast to the “naive” strategy, which represents a non strategic way of bidding, the day ahead and the long term optimization strategies model a more and more strategic behavior of the generators. With regards to the discussion of the previous part of this section, the only coeﬃcients left to be set in the model are the speeds of adjustment ki(t) of the generators. It is assumed that the coeﬃcients ki(t) are constant, since we can assume that each GENCO will develop experience and ﬁnd a steady optimal value for it. The thorough derivation of the chosen values, which follow, can be found in Giabardo and Zugno (2008): • ki = 500, i = 1, 2 for β ≈ 1000; • ki = 700, i = 1, 2 for β ≈ 1500; • ki = 900, i = 1, 2 for β ≈ 2000. As far as the long term optimal strategy is concerned, the number Nh of days in the horizon has been set to 3. One reason for this is that the wind predictions are provided for less than two entire days ahead, and kept constant to the last given value when longer forecasts are needed. Although this prolongation is reasonable on a short term basis, its sense is lost when the horizon extends signiﬁcantly. Another reason is that the long term strategy requires the estimation of the demand function. With an horizon Nh > 3, the estimation of the demand would reach out to two weeks ahead in the weekend day case. Although the weekday case is less strict, the horizon is kept to Nh = 3 for the sake of consistency. Table 1 summarizes the results of the simulations carried out in the case of medium elasticity of demand (β ≈ 1500) and with generators using fore- casts, hence the most realistic case. Qualitatively similar results could be shown for the case of perfect prediction and can be found, once again, in Giabardo and Zugno (2008). The trend, conﬁrmed also by other simula- tions performed with diﬀerent values of demand elasticity, is that the switch from the naive to the day ahead strategy is encouraged by the possibility of achieving higher proﬁts. In turn, the competitor is also encouraged to 19 Table 1: Main results of the simulations that compare the strategies de- scribed in Section 2. The ﬁgures represent the average values over April 2007. Strategy Gen.1 Naive Day ahead Day ahead Long term Long term Gen.2 Naive Naive Day ahead Day ahead Long term Mean Quantity 20.94 27.27 25.27 34.80 34.87 Gen.1 (GWh) Mean Wind % 18.18 13.78 14.86 10.89 10.87 Gen.1 Mean Quantity 20.94 20.94 25.23 20.46 34.90 Gen.2 (GWh) Mean Wind % 16.15 16.15 13.24 17.58 9.67 Gen.2 Daily Proﬁt 12.17 12.87 11.07 12.16 4.05 Gen.1 (mln e) Daily Proﬁt 12.14 10.03 11.02 7.42 4.01 Gen.2 (mln e) Mean Price 26.18 21.98 20.47 17.28 7.55 (e) Daily Social 38.29 41.43 42.41 43.96 46.93 Welfare (mln e) switch from the naive strategy to the more advanced one by the possibility to increase its proﬁts. This result is not trivial, since the day ahead strategy is optimal only in the case in which the opponent holds its bid constant from day to day (naive). The switch from the day ahead to the long term strategy by the ﬁrst generator also leads to an increase in its proﬁts. The second generator in turn suﬀers noticeable losses but, in this case, it would not gain from an eventual switch to the more advanced strategy. This result is not in disagreement with the fact that the long term strategy is optimal, since the optimality is guaranteed only if the competitor sticks with the day ahead strategy. In the case in which both the producers follow the long term strategy, they both bid optimally but with respect to a model of the competitor that is not consistent, and, thus, the outcomes cannot be those that were expected. What happens is the following: when adopting the 20 long term strategy a generator (let us call it A) assumes that the opponent (B) is bidding according to the day ahead strategy. This implies that A takes for granted that B is marking up the price by retaining generation capacity. Therefore A will try to sell more energy to the market, in order to exploit the high prices. This high level of production of the generator adopting the long term strategy is evident looking at Table 1. Hence, when both the generators adopt the long term strategy, they reach such a high energy output that the price gets extremely low, thus driving down their proﬁts. The ability of the generators to increase their individual proﬁts by adopting more advanced strategies can be evaluated in Figure 7(a), where the three bidding policies are compared in their behavior against the day ahead strategy. Besides, one can notice how the long term strategy performs particularly well during the second and the third day, period during which the system price rises, thus exploiting the dynamic features of the system. Let us consider for a moment only the ﬁrst three columns of Table 1. It can be noticed that the proﬁts are higher when both the generators follow the naive strategy than in the case where they both follow the day ahead strategy. This behavior clearly resembles the so called “prisoner dilemma” (see Binmore (2008)) in game theory: one generator is encouraged to switch from the naive to the day ahead strategy by the possibility of obtaining higher gains; at this point the second generator, which notices the decrease in its proﬁts, is also encouraged to switch to the day ahead strategy; though, in the end, they would be better oﬀ if they both stuck with the naive strategy. Two ﬁnal remarks must be done. The ﬁrst one is about the price, which decreases as the generators adopt more and more advanced strategies. This is basically due to the higher energy output of the generators as they become more strategic. This growth in the production is evident if looking at Figure 7(b), which shows the quantities produced by a generator when adopting the three diﬀerent strategies. In turn, the social beneﬁt increases, since more demand is met by the generators. 4.2. Sensitivity analysis A sensitivity analysis has been performed on this system in order to assess the eﬀect on the market of diﬀerent conditions in the elasticity of demand. The main results are shown in Table 2. Only the outcomes of the simulations in which both the generators adopt the day ahead strategy are shown. Nevertheless, the simulations of the other setups show the same pattern and are omitted here for the sake of compactness. As it is possible to see, a low elasticity of demand allows the ﬁrms to exploit their market power by withholding some of their production capacity in order to mark up the 21 20 40 60 80 100 120 3 3.5 4 4.5 5 5.5 6 6.5 7x 10 5 time [h]profits [EUR] naive day ahead long term (a) Proﬁts 20 40 60 80 100 120 1.5 2 2.5 3 3.5 4 4.5 5x 10 4 time [h]quantity [MWh] naive day ahead long term (b) Quantity Figure 7: Proﬁts obtained and quantity delivered by a generator adopting subsequently the three diﬀerent strategies when the opponent uses the day ahead strategy. The demand elasticity is set by β ≈ 1500 and forecasts are used. The plotted period is the second week of April 2007 (5 weekdays). system price and obtain more proﬁts. An increase in the elasticity of demand causes the market to beneﬁt both in terms of increased energy production and of decreased average system price. The proﬁts of the GENCOs in turn decrease. These results conﬁrm the ﬁndings in Oca˜na and Romero (1998), according to which the market power exercised by the producers is inversely coupled with the elasticity of demand. 22 Table 2: Results of three simulations where both the generators employ the day ahead strategy using forecasts, with three diﬀerent conditions of demand elasticity. The ﬁgures represent the average values over April 2007. β ≈ 1000 ≈ 1500 ≈ 2000 Mean Quantity Gen.1 (GWh) 21.91 25.27 28.52 Mean Wind % Gen.1 17.20 14.86 13.14 Mean Quantity Gen.2 (GWh) 21.88 25.23 28.48 Mean Wind % Gen.2 15.33 13.24 11.71 Daily Proﬁt Gen.1 (mln e) 12.23 11.07 10.80 Daily Proﬁt Gen.2 (mln e) 12.18 11.02 10.75 Mean Price (e) 25.28 20.47 18.17 Daily Social Welfare (mln e) 47.40 42.41 40.93 4.3. Deterministic vs stochastic models The development of a stochastic model for the electricity market allows for a very interesting analysis: the evaluation of the eﬀects of the introduc- tion of wind power production. In this section three simulation setups are considered: a deterministic one, in which production is from conventional sources of energy, and two stochastic ones, where wind production is intro- duced and the generators have either perfect information or forecasts on the future wind proﬁle. Table 3 shows the results of the simulations performed with a demand elasticity set by β ≈ 1500 and when both the players follow the day ahead strategy. The simulations of the cases in which the generators adopt diﬀerent combinations of bidding strategies show a pattern similar to the one described in the previous section. As such, they are omitted in this article; the interested reader is referred to Giabardo and Zugno (2008). A comparison between the ﬁrst and the second column of this table shows that, with the addition of wind power production, there is a slight increase in the quantity of energy dispatched by each of the producers. This small rise in the production is the optimal compromise between two contrasting facts: on one side, the lower costs due to the abundance of wind power stimulate the generators to produce more energy; on the other side, strong increases in the energy output are discouraged by the consequential drop in the price. At the same time, the proﬁts of the producers increase, which is expected since 23 Table 3: Results of three simulations where both the generators employ the day ahead strategy in the following cases: deterministic case (no wind power), perfect prediction case, WPPT prediction case. The ﬁgures repre- sent the average values over April 2007. Case Deterministic Perfect WPPT (no wind power) prediction prediction Mean Quantity Gen.1 (GWh) 25.07 25.27 25.27 Mean Wind % Gen.1 0.00 14.85 14.86 Mean Quantity Gen.2 (GWh) 25.07 25.21 25.23 Mean Wind % Gen.2 0.00 13.24 13.24 Daily Proﬁt Gen.1 (mln e) 10.80 11.08 11.07 Daily Proﬁt Gen.2 (mln e) 10.80 11.02 11.02 Mean Price (e) 20.70 20.48 20.47 Daily Social Welfare (mln e) 41.63 42.41 42.41 the generators now have cheaper production techniques at their disposal. The increment in the produced quantity also causes a decrease in the price, which represents a beneﬁt for the consumers. As far as the overall eﬀects for the society are concerned, one can notice that the daily social welfare increases, both due to an heightened beneﬁt for the consumers (who can now buy more energy at a lower price) and for the producers (who increase their proﬁts due to lower production costs). The same considerations hold also if comparing the ﬁrst and third row of Table 3. This is due to the aforementioned fact that the outcomes of the simulations using forecasts or perfect information are qualitatively similar. The fact that the wind power covers around 13-14% of the total gen- eration while the increase in production amounts to about 1% means that a signiﬁcant share of the production switches from traditional technologies to wind power, when the latter is available. This fact is evident if looking at Figure 8, which shows the quantity produced by the ﬁrst generator in the case when it adopts the day ahead strategy while the second generator employs the naive one. As already mentioned, the results presented in this section are very gen- eral. In fact, for each of the cases considered in the previous Subsections 24 10 20 30 40 50 60 70 80 90 100 110 120 0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5x 10 4 time [h]quantity [MWh] q 1,tot q 1 q 1,w Figure 8: Quantity produced by the ﬁrst generator adopting the day ahead strategy when the second generator employs the naive one. The demand elasticity is set by β ≈ 1500 and forecasts are used. q1,tot is the total production, q1,w is the wind power and q1 is the power produced with other technologies. The plotted period is the second week of April 2007. 4.1 and 4.2, it could be shown that the inclusion of wind power production causes lower system prices, increased quantity of energy dispatched to the market, higher proﬁts for the producers and welfare for the society. There- fore the analysis of these cases has been omitted in this paper for the sake of brevity, the interested reader is referred to Giabardo and Zugno (2008). 5. Conclusions This article addresses the functioning of oligopolistic day ahead electric- ity markets and the issue of strategic bidding. Stochastic optimal control theory is the main tool used for this analysis. Generator competition, aimed at proﬁt maximization, is in fact modeled as a dynamic feedback system, which includes stochastic features connected with production from renew- able energy sources. The quantity bidding, or Cournot competition model, has been consid- ered. In such a market, the generators tend to withhold generation capacity in order to mark up the price and, therefore, earn more proﬁts. The in- troduction of advanced strategies encourages the producers to bid higher quantities in the market while exploiting the price mark up caused by the competitors. The simulations have proved the superiority of the long term optimal strategy, which has the advantage of being able to take into account 25 the dynamics of the system. Furthermore, the simulations performed have highlighted an important feature that is peculiar to the Cournot competi- tion model: the adoption of more advanced strategies by the generators has a beneﬁcial eﬀect not only for the producers but also for the society. This appears both in a decrease of the average system price and in an increase of the social welfare, as more demand is met by the producers. A sensitivity analysis has been carried out by simulating the model under diﬀerent conditions of demand elasticity. The resulting trend is that an increase in the demand elasticity limits the possibility for the producers to exploit their market power and, generally, leads to decreased proﬁts. In turn, the society gains in terms of lower prices and increased social beneﬁt. These results are in complete accordance with the literature on the subject (for instance see Oca˜na and Romero (1998)). An evaluation of the market behavior as the wind production penetrates electricity markets has been made possible by the development of a stochas- tic model. It has been shown that the introduction of wind power is ad- vantageous both for the producers and the society, in terms of, respectively, higher proﬁts and increased social welfare. The model has been simulated in the cases of both perfect and estimated information on the wind power future proﬁle. In order to test the system in a realistic framework, a state-of-the-art forecasting tool (WPPT) has been employed. The simulations show analogous results on both cases. This is because accuracy of wind power prediction tools mainly has an eﬀect on the need for intra-day corrections, and real-time regulation. The role of forecast- ing has shown to be crucial however in the development of stochastic models for energy markets signiﬁcantly penetrated by stochastic renewable genera- tion. Therefore, the availability of accurate forecasting tools is paramount if such models intend to realistically describe the behavior of actual markets. This work shows that control theory represents an eﬀective tool for de- scribing and modeling electricity markets, which by their nature are closed loop systems, characterized by strong dynamic and stochastic properties. Nevertheless there is room for future developments in many directions. Dif- ferent kinds of markets could be included, such as the continuous trading (e.g. Elbas, for the case of Scandinavia) and real-time markets, as well as other related issues, e.g. regulation costs and transmission constraints. Fur- thermore, the modeling of the wind dynamics, the inclusion of sources of uncertainty diﬀerent from those in the supply side and the incorporation of other renewable energy sources all represent potential interesting enhance- ments to the present work. 26 Acknowledgements We thank Energinet.dk, in particular Jonas C. Villumsen and Michael P. G. Simonsen Nielsen, and NordPool for providing us with data on the Scandinavian energy market; Klaus Skytte and Arndt von Schemde of Econ P¨oyry for sharing their professional counseling with us; Youfei Liu for being a source of inspiration through his work, as well as for his openness to discussion; the Editor of the journal and two anonymous referees who oﬀered constructive comments that signiﬁcantly improved the quality of this ﬁnal document. References Aghion, P., Bolton, P., 1987. Contracts as a barrier to entry. The American Economic Review 77, 388–401. Alvarado, F., 1997. The dynamics of power system markets. Technical report PSerc-97-01, The University of Wisconsin. Alvarado, F., 1999. The stability of power system markets. IEEE Transac- tions on Power Systems 14 (2), 505–511. Amelin, M., 2004. On Monte Carlo simulation and analysis of electricity markets. Ph.D. thesis, Royal Institute of Technology. Andersson, B., Bergman, L., 1995. Market structure and the price of elec- tricity: an ex-ante analysis of the deregulated Swedish electricity markets. The Energy Journal 16, 97–110. Baldick, R., Grant, R., Kahn, E., 2002. Linear supply function equilibrium: generalizations, applications and limitations. University of California En- ergy Institute POWER Pater PWP-078. Bask, M., Liub, T., Widerberg, A., 2007. The stability of electricity prices: estimation and inference of the Lyapunov exponents. Physica A, Statisti- cal Mechanics and its Applications 376, 565–572. Binmore, K., 2008. Game theory: a very short introduction. Oxford Univer- sity Press, Oxford. Bolle, F., 1992. Supply function equilibria and the danger of tacit collusion. the case of spot markets for electricity. Energy Economics 14, 94–102. Conejo, A. J., Contreras, J., Arroyo, J. M., de la Torre, S., 2002. Optimal response of an oligopolistic generating company to a competitive pool- based electric power market. IEEE Transactions on Power Systems 17 (2). Costa, A., Crespo, A., Navarro, J., Lizcano, G., Madsen, H., Feitosa, E., 2008. A review on the young history of the wind power short-term pre- diction. Renewable & Sustainable Energy Reviews 12, 1725–1744. 27 Donslund, B., Kristoﬀersen, B., 2006. A brief description of energinet.dk’s market model MARS. www.energinet.dk. Erzgr¨aber, H., Strozzi, F., Zald´ıvar, J.-M., Touchette, H., Guti´errez, E., Arrowsmith, D. K., 2008. Time series analysis and long range correlations of Nordic spot electricity market data. Physica A, Statistical Mechanics and its Applications 387 (26), 6567–6574. Garber, D., Hogan, W. W., Ruﬀ, L., 1994. An eﬃcient electricity market: using a pool to support real competition. The Electricity Journal 7 (7), 48–60. Giabardo, P., Zugno, M., 2008. Competitive bidding and stability analysis in electricity markets using control theory. Master’s thesis, Informatics and Mathematical Modelling, Technical University of Denmark, DTU, Richard Petersens Plads, Building 321, DK-2800 Kgs. Lyngby, supervi- sors: Henrik Madsen and Pierre Pinson. Giebel, G., Kariniotakis, G., Brownsword, R., 2003. The state-of-the-art in short-term prediction of wind power - a literature overview. Deliverable report, EU Project Anemos. Green, R., Newbery, D., 1992. Competition in the British electricity spot market. Journal of Political Economy 100 (5), 929–953. Guan, X., Ho, Y. C., Lai, F., 2001. An ordinal optimization based bidding strategy. IEEE Transactions on Power Systems 16, 788–797. Hobbs, B. F., 1986. Mill pricing versus spatial price discrimination under Bertrand and Cournot spatial competition. Journal of Industrial Eco- nomics 35, 173–191. Hogan, W. W., 1997. A market power model with strategic interaction in electricity networks. The Energy Journal 18, 107–142. J´onsson, T., Pinson, P., Madsen, H., 2009. On the market power of wind energy (forecasts). Energy Economics, (submitted). Kahn, E. P., 1998. Numerical techniques for analyzing market power in electricity. The Electricity Journal 11, 34–43. Klemperer, P., Meyer, M., 1989. Supply function equilibria in an oligopoly under price uncertainty. Econometrica 57, 1243–1277. Liu, Y., 2006. Network and temporal eﬀects on strategic bidding in electric- ity markets. Ph.D. thesis, University of Hong Kong. Martini, A., Pelacchi, P., Pellegrini, L., Cazzol, M., Garzillo, A., Innorta, M., 2001. A simulation tool for short term electricity markets. Power Industry Computer Applications. PICA 2001, 112–117. Ni, E., Luh, P. B., Rourke, S., 2004. Optimal integrated generation bidding and scheduling with risk management under a deregulated power market. 28 IEEE Transactions on Power Systems 19 (1), 600–609. Nielsen, T., 2002. Online prediction and control in nonlinear stochastic sys- tems. Ph.D. thesis, Informatics and Mathematical Modelling, Technical University of Denmark, DTU, Richard Petersens Plads, Building 321, DK-2800 Kgs. Lyngby. Nielsen, T., Nielsen, H., Madsen, H., 2002. Prediction of wind power using time-varying coeﬃcient functions. In: Proceedings of the 15th IFAC World Congress, Barcelona, Spain. NordPoolSpot website, 2009. www.nordpoolspot.com. Oca˜na, C., Romero, A., 1998. A simulation of the Spanish electricity pool. Technical report, Comisi´on Nacional del Sistema El´ectrico. Park, J. B., Kim, B. H., Kim, J. H., Jung, M. H., Park, J. K., 2001. A continuous strategy game for power transactions analysis in competitive electricity markets. IEEE Transactions on Power Systems 16 (4), 847–855. Pinson, P., Papaefthymiou, G., Kl¨ockl, B., Nielsen, H. A., Madsen, H., 2009. From probabilistic forecasts to statistical scenarios of short-term wind power production. Wind Energy 12, 51–62. Powell, A., 1993. Trading forward in an imperfect market: the case of elec- tricity in Britain. The Economic Journal 103 (417), 444–453. Ravn, H. F., 1999. Discrete time optimal control. Technical University of Denmark. Richter, C. J., Sheble, G. B., 1998. Genetic algorithm evolution of utility bidding strategies for the competitive marketplace. IEEE Transactions on Power Systems 13 (1), 256–261. Rudkevich, A., 1999. Supply function equilibrium in power markets, learning all the way. TCA Technical Paper, 1299–1702. Singh, S. N., 2008. Strategies for wind power trading in competitive elec- tricity markets. IEEE Transactions on Energy Conversion 23, 249–256. Song, H., Liu, C. C., Lawarre´e, J., Dahlgren, R. W., 2000. Optimal elec- tricity supply bidding by Markov decision process. IEEE Transactions on Power Systems 15 (2), 618–624. Songa, Y., Ni, Y., Wenb, F., Houa, Z., Wu, F. F., 2003. Conjectural variation based bidding strategy in spot markets: fundamentals and comparison with classical game theoretical bidding strategies. Electric Power Systems Research 67 (1), 45–51. Swider, D., Weber, C., 2006. An electricity market model to estimate the marginal value of wind in an adapting system. Proceedings of the Power Engineering Society General Meeting, 2006. IEEE. Taylor, J. W., McSharry, P., 2008. Short-term load forecasting methods: an 29 evaluation based on European data. IEEE Transactions on Power Systems 22, 2213–2219. Wen, F., David, A., 2001. Optimal bidding strategies and modeling of im- perfect information among competitive generators. IEEE Transactions on Power Systems 16 (1). Willems, B., 2002. Modeling Cournot competition in an electricity market with transmission constraints. The Energy Journal 23, 95–125. Yu, Z., Sparrow, F., Bowen, B., 1998. A new long-term hydro production scheduling method for maximizing the proﬁt of hydroelectric systems. IEEE Transactions on Power Systems 13 (1), 66–71. 30 A. Derivation of the day-ahead strategy In this section the analytical derivation of the day-ahead strategy is presented by making use of the same notation used in the paper. In Section 2 the most important economic quantities have been intro- duced: the cost and the proﬁt for the producers and the market demand function. These are reported here for the sake of clarity. The cost function for a producer is deﬁned as: Ci(˜xi(t)) = aw,i(t) + ai(t) + bi(t)˜xi(t) + 1 2 ci(t)˜xi(t)2 (28) where aw,i(t) is the cost coming from the production of wind energy (which is indicated ˜xi,w(t) in the paper), while ai(t)+bi(t)˜xi(t)+ 1 2 ci(t)˜xi(t)2 represents the (quadratic) cost of producing ˜xi(t), which is the quantity of energy produced from sources other than the wind. The proﬁt for a producer is given by: ˜πi(t) = ˜p(t) (˜xi(t) + ˜xi,w(t)) − Ci(˜xi(t)) (29) which is simply the subtraction of the production costs Ci(˜xi(t)) from the total revenues of the ﬁrm ˜p(t) (˜xi(t) + ˜xi,w(t)). It must be remembered, in fact, that the total amount of energy produced by the i-th generator is ˜xi,t(t), which represents the sum of the quantity of wind energy (i.e. ˜xi,w(t)) and the quantity of energy produced with other technologies (i.e. ˜xi(t)). The market demand is described by: D(t) = α(t) − β(t)p(t) (30) It may help to recall here the assumption of non-storability of energy re- quired the instantaneous balance of supply and demand, which translates into: ˜D(t) = N∑ i=1 ˜xi,t(t) (31) Substituting in order (28), (29), (3) and (31) and carrying out the derivative 31 on the right side of (9), after some calculations one gets ˜xi(t + 1) − ˜xi(t) = ki(t + 1)[ − f (t + 1) ∂ ˜D(t + 1) ∂ ˜xi(t + 1) ˜xi,t(t + 1) + e(t + 1) − f (t + 1) N∑ j=1 ˜xj,t(t + 1) − bi − ci ˜xi(t) ] ˜xi(t+1)=˜xi(t) = ki(t + 1)[ − f (t + 1) ∂ ˜D(t + 1) ∂ ˜xi(t + 1) (˜xi(t + 1) + ˜xi,w(t + 1)) − f (t + 1) N∑ j=1 (˜xj(t + 1) + ˜xj,w(t + 1)) + e(t + 1) − bi − ci ˜xi(t)] ˜xi(t+1)=˜xi(t) (32) where ˜xi,w(t + 1) is the amount of wind power and e(t + 1), f (t + 1) are the coeﬃcients of the demand function, all calculated at time t + 1. This makes sense since the purpose of the equation is deciding the update of ˜xi(t), given the most recent estimates of the wind power and of the demand function. As far as the estimates are concerned, forecasts of the wind power available to the individual generator and to its competitors are used. As a matter of fact, current forecasting tools are designed in order to provide the user with the conditional expectation of wind power production, which makes them appropriate for this kind of problems. For the interested reader, reviews of state-of-the-art forecasting techniques can be found in Giebel et al. (2003) and Costa et al. (2008). Of course, the issue of having accurate forecasts for wind power is critical in the development of eﬃcient bidding strategies. From now on, it is assumed that wind power forecasts are always available and perfect, although it is known that they have a limited level of accuracy. This issue has been discussed in Taylor and McSharry (2008), which assesses the accuracy for wind power forecasts to 2%-4%. A realistic assumption is that each ﬁrm believes that the total quan- tity produced by its competitors will approximately be the same as in the previous period, which means the i-th producer considers ˜xj(t + 1) + ˜xj,w(t + 1) = ˜xj(t) + ˜xj,w(t) , j = 1, 2, . . . , N, j ̸= i (33) The reason for this assumption lays in the fact that the change in one single period can be neglected, since the demand function remains practically un- changed at the same hour of two successive days (of the same type: there is 32 a noticeable change between Friday and Saturday for the demand function considered at the same hour). This once again motivates the fact that the system should be divided in 48 subsystems, one for each hour of weekdays and weekend days. At this point of the discussion, it might be useful to point out that t + 1 does not indicate the next hour, but the bidding round at the same hour of the following day of the same type. As an example, if the current day and time is Friday at 11am, t + 1 indicates Monday at 11am, which is the closest following weekday. The assumption above also implies ∂ ˜xj,t(t + 1) ∂ ˜xi(t + 1) = 0 , j = 1, 2, . . . , N, j ̸= i (34) which from the balance of supply and demand, see (31), gives ∂ ˜D(t + 1) ∂ ˜xi(t + 1) = 1 (35) Substituting the equations above in (32), rearranging the terms and impos- ing ˜xi(t + 1) = ˜xi(t) on the right side of the equation leads to the following expression ˜xi(t + 1) = [1 − ki(t + 1)(2f (t + 1) + ci)] ˜xi(t) − ki(t + 1)f (t + 1)     N∑ j=1 j̸=i (˜xj(t) + ˜xj,w(t)) + 2˜xi,w(t + 1)     + ki(t + 1) (e(t + 1) − bi) (36) Once the state variable is deﬁned ˜x(t) = [˜x1(t) ˜x2(t) . . . ˜xN (t)]T (37) it is possible to deﬁne the following state update model ˜x(t + 1) = F(t)˜x(t) + ˜ϵex(t) (38) 33 where Fii(t) =1 − ki(t + 1)(2f (t + 1) + ci), i = 1, 2, . . . , N Fij(t) = − ki(t + 1)f (t + 1), i, j = 1, 2, . . . , N , i ̸= j ˜ϵex,i(t) = − ki(t + 1)f (t + 1)    2˜xi,w(t + 1) + N∑ j=1 j̸=i ˜xj,w(t)     + ki(t + 1) (e(t + 1) − bi) (39) In the state space model (38) the variable ˜ϵex(t) has been introduced to model all the exogenous terms, including the sources of uncertainty. The decision of the i−th generator is based on the expectation, so that (36) becomes ¯xi(t + 1) = [1 − ki(t + 1)(2f (t + 1) + ci)] ¯xi(t) − ki(t + 1)f (t + 1)     N∑ j=1 j̸=i (¯xj(t) + ¯xj,w(t)) + 2¯xi,w(t + 1)     + ki(t + 1) (e(t + 1) − bi) (40) which actually represents the one step bidding strategy of interest in Section 2 of the paper. B. Derivation of the long term strategy In this section the analytical derivation of the long term strategy is presented; again the same notation introduced in the paper will be used. In order to do that, some expressions introduced in Section 3 are needed. Therefore let us recall the equations of the state space model, in the form derived in the beginning of the aforementioned section: ˜x(t + 1) = F(t)˜x(t) + G(t)u(t) + ˜ϵex(t) (41) ˜p(t) = C(t)˜x(t) + D(t)u(t) + ˜ep(t) (42) 34 Furthermore, the optimization index introduced at the beginning of the same section is needed: JN (t) = E { t+Nh−1∑ τ =t πN (τ ) } = E { t+Nh−1∑ τ =t ˜p(τ ) (u(τ ) + ˜xN,w(τ )) − CN (u(τ )) } (43) Now, substituting (42) into (43) and assuming that the coeﬃcients of the cost function are constant (the reasonableness of this assumption has already been discussed in Section 2), after some calculations one achieves JN (t) = E { t+Nh−1∑ τ =t [(C(τ )˜x(τ ) + D(τ )u(τ ) + ˜ep(τ ) + D(τ )˜xN,w(τ ) )u(τ ) + C(τ )˜x(τ )˜xN,w(τ ) + ˜ep(τ )˜xN,w(τ ) − (aw,N + aN + bN u(τ ) + 1 2 cN u(τ )2) ] } (44) Letting the expectation inside the summation, and remembering that E {˜x˜y} = ¯x¯y + Cov(x, y), one gets JN (t) = t+Nh−1∑ τ =t [ (C(τ )¯x(τ ) + D(τ )u(τ ) + e n p (τ ) ) u(τ ) − (an N (τ ) + bN u(τ ) + 1 2 cN u(τ )2)] (45) where an N (t) = aw,N + aN − C(t)¯x(t)¯xN,w(t) − Cov(C(t)˜x(t), ˜xN,w(t)) − ¯ep(t)¯xN,w(t) − Cov(˜ep(t), ˜xN,w(t)) e n p (t) = ¯ep(t) + D(t)¯xN,w(t) (46) The optimization problem can now be deﬁned as the maximization of the index (45), constrained by the state update equation for the mean of the state. In fact, it is the mean that appears in (45) rather than the state itself. The update equation for the mean ¯x is obtained by taking the expectation 35 on both sides of the equal sign in (41) ¯x(t + 1) = F(t)¯x(t) + G(t)u(t) + ¯ϵex(t) (47) The Hamiltonian for this problem is then given by the following expression H(x(t), λ(t + 1), u(t), t) = [ (C(t)¯x(t) + D(t)u(t) + en p (t) ) u(t) − ( an N (t) + bN u(t) + 1 2 cN u(t)2) ] + λT (t + 1)(F(t)¯x(t) + G(t)u(t) + ¯ϵex(t)) (48) From now on, the substitution H(x, λ, u, t) = H(x(t), λ(t+1), u(t), t) is per- formed for the sake of readability. The ﬁrst order condition for stationarity ∂H(¯x, λ, u, t) ∂u(t) = 0 (49) has to be imposed. Solving this equation for the input u(t) leads to u(t) = GT (t)λ(t + 1) − bN + en p (t) + C(t)¯x(t) cN − 2D(t) (50) The second order derivative of the Hamiltonian turns out to be ∂2H(¯x, λ, u, t) ∂2u(t) = 2D(t) − cN = −2f (t) − cN < 0 (51) which ensures that the stationarity point is a maximum point, being both f (t) and cN positive. Following the development of the classical maximum principle for discrete systems, see for instance Ravn (1999), one can derive the costate equation λ(t) = dH(¯x, λ, u, t) d¯x(t) = C T (t)u(t) + C T (t)¯xN,w(t) + FT (t)λ(t + 1) (52) Let us assume a linear relation between the Lagrangian multiplier λ(t) and the mean state vector ¯x(t) λ(t) = S(t)¯x(t) + M(t) (53) After some calculations involving the substitution of (50) and (53) into the state update (47), one can achieve the update equation for the Lagrangian 36 multiplier λ(t), which is given by λ(t + 1) = S(t + 1) [ (cN − 2D(t)) − G(t)G T (t)S(t + 1)]−1 · [ (cN − 2D(t))F(t)¯x(t) + (cN − 2D(t))¯ϵex(t) + G(t) (G T (t)M(t + 1) − bN + en p (t) + C(t)¯x(t) ) ] + M(t + 1) (54) The update equations for the matrices S(t) and M(t) deﬁned in (53) are still to be determined. By combining (52) and (53), one gets λ(t) = S(t)¯x(t) + M(t) = C T (t)(u(t) + ¯xN,w(t)) + FT (t)λ(t + 1) (55) The expressions (50) and (54) have to be substituted into the rightmost side of (55). Grouping together all the elements multiplied by ¯x(t), the equal sign on the right of (55) is always true if S(t) =C T (t) C(t) cN − 2D(t) + ( CT (t)GT (t) cN − 2D(t) + FT (t)) · S(t + 1)[(cN − 2D(t)) − G(t)G T (t)S(t + 1)]−1 · [(cN − 2D(t))F(t) + G(t)C(t) ] (56) and M(t) = C T (t) [ −bN + en p (t) cN − 2D(t) + ¯xN,w(t) ] + ( CT (t)GT (t) cN − 2D(t) + FT (t) ) · { M(t + 1) + S(t + 1) [(cN − 2D(t)) − G(t)G T (t)S(t + 1)]−1 · [(cN − 2D(t))¯ϵex(t) + G(t) (G T (t)M(t + 1) − bN + en p (t) )] } (57) The sequences S(t) and M(t) can be calculated backwardly using (56), (57) and imposing the ﬁnal conditions S(t + Nh) = 0, M(t + Nh) = 0. With the values of S(t) and M(t), (53) and (47) are substituted into (50). The resulting equation is then solved in the variable u(t) to obtain the optimal 37 control rule u(t) = GT (t)S(t + 1)F(t) + C(t) cN − 2D(t) − G(t)T S(t + 1)G(t) · (F(t − 1)¯x(t − 1) + G(t − 1)u(t − 1) + ¯ϵex(t − 1) ) + GT (t)(S(t + 1)¯ϵex(t) + M(t + 1)) − b1 + en p (t) cN − 2D(t) − G(t)T S(t + 1)G(t) (58) 38","libVersion":"0.3.2","langs":""}