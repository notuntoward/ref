{"path":"lit/sources/Munshi18evChrgFlexDefExtrct.pdf","text":"1551-3203 (c) 2017 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See http://www.ieee.org/publications_standards/publications/rights/index.html for more information. This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/TII.2017.2724559, IEEE Transactions on Industrial Informatics TII-17-0494.R2 1  Abstract—The popularization of electric vehicles raises concerns about their negative impact on the electrical grid. Extracting electric vehicle charging load patterns is a key factor that allows smart grid operators to make intelligent and informed decisions about conserving energy and promoting the stability of the electrical grid. This paper presents an unsupervised algorithm to extract electric vehicle charging load patterns non-intrusively from the smart meter data. Furthermore, a method to define flexibility for the collective electric vehicle charging demand by analyzing the time-variable patterns of the aggregated electric vehicle charging behaviors is presented. Validation results on real residential loads have shown that the proposed approach is a promising solution to extract electric vehicle charging loads and that the approach can effectively mitigate the interference of other appliances that have similar load behaviors as electric vehicles. Further, a case study on real residential data to analyze electric vehicle charging trends and quantify the flexibility achievable from the aggregated electric vehicle load in different time periods is presented. Index Terms—Dynamic demand response, energy disaggregation, electric vehicle, smart grid, smart meter NOMENCLATURE ALP Aggregated load pattern ECS Extracted charging session EEVCL Extraction of electric vehicle charging load EV Electric vehicle EVCL Electric vehicle charging load FP False positives FPL Flexibility percentage level FIEVAD Flexibility index of EV aggregate demand ICA Independent component analysis NILM Non-intrusive load monitoring a Index of error1 b Index of error2 c Solution vector g Index of the overall minimum error m Probability of success for prior n Number of successes for prior  Number trials for likelihood s Vector template of maximum charging amplitude The authors are with the Electrical and Computer Engineering Department, University of Alberta, Edmonton, AB, T6G 2V4 Canada (e-mail: aamunshi@ualberta; yasser_rady@ieee.org).  Outcome of Bernoulli trail  t Probability of increase in EV charging demand t , t Upper and lower limits for  t  VPL ,  VPL Maximum increase/decrease in demand variation X Original aggregated load pattern Z Extracted signal from independent component analysis Be Base load C Matrix of solution vectors D Vector of start and end couple D Matrix for start and end couples Error# Error between reconstructed and original signal ESTx Reconstructed load pattern ESTx2 Reconstructed load pattern to improve estimated amplitude f Final extracted EV signal f Vector of variation in EVCLs  f , f  Mean values of load variations for increase/decrease in demand F Matrix of extracted EVCLs P Components that precede F Components that follow starte Index start time of charging session ende Index end time of charging session M Number of templates N Window size of sequence to be extracted P Counts of non-zero extracted signals S Matrix of templates s Y Number of success for likelihood Z Matrix of independent component analysis extracted signals I. INTRODUCTION HE growth of electric vehicles (EVs) poses a challenge to electricity systems, but also a promising opportunity to reduce petroleum use. Accordingly, many economic and environmental issues can be overcome. For this purpose, EVs have received increasing attention recently. The U.S. electric power research institution (EPRI) projects that 62% of the entire U.S. vehicle fleet will consist of EVs by 2050 [1]. Those EV loads bring large impacts on smart grids, including an increase in system peak demand, transformer and feeder Extracting and Defining Flexibility of Residential Electrical Vehicle Charging Loads Amr A. Munshi, Student Member, IEEE, and Yasser Abdel-Rady I. Mohamed, Senior Member, IEEE T 1551-3203 (c) 2017 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See http://www.ieee.org/publications_standards/publications/rights/index.html for more information. This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/TII.2017.2724559, IEEE Transactions on Industrial Informatics TII-17-0494.R2 2 overloads, and voltage unbalances, especially at the electric power distribution level [2]. The gravity of this impact depends on the EV charging behaviors. Therefore, it is necessary to solicit the prominence of monitoring EV charging loads. Many utilities are transferring to smart meters and smart grids as part of long range planning to improve the reliability of power supply, incorporate distributed generation resources, develop storage solutions, use the power plants efficiently, and enable smart metering programs. To accomplish this, smart meter systems are being deployed as a first step. This leads to amounts of data that, if managed properly, can provide better understanding of customer behavior and assist in stabilizing the grid. Appliance load monitoring (ALM) is an essential solution for energy management that allows obtaining appliance-specific energy consumption statistics that can further be used to devise load scheduling strategies for optimal energy utilization. There are two major approaches to ALM, namely intrusive load monitoring (ILM) and non-intrusive load monitoring (NILM). ILM can be achieved by deploying smart power outlets on every device of interest; however, it is impractical and incurs extra hardware cost and installation complexity. In addition, ILM methods are not desirable by ordinary households. NILM is an attractive method for appliance disaggregation; it can extract certain load patterns from the aggregated data acquired from a single point of measurement, typically a smart meter. The extracted data can be used for load monitoring and scheduling strategies for optimal energy utilization. Different approaches have been used for disaggregating loads non-intrusively [3]-[8]. Most methods require smart meter data with high sampling rates higher than 1-Hz. Also, different combinations of electrical measurements are used to disaggregate appliances, such as the active power (P), reactive power (Q) and current (I) [9]-[11]. Recent research [7],[9],[12] propose methods that utilize the real power measurements. The main reason for using only the real power measurements is because it is the type of data recorded and communicated by most smart meters. EVs are a hot topic in research, and methods to extract EV charging loads (EVCL) are recently emerging. In [13], a method for extracting EVCLs is presented. However, it cannot extract the EVCLs if other appliances were operating at the time the EV was plugged in. Also, it requires a sampling rate of one-second and, requires the active and reactive power measurements, which is not the reality of most deployed smart meters. In [14], an algorithm to extract EVCLs with amplitudes from 3 kW to 4 kW, from the aggregated signal is presented. The algorithm does not require training and was able to disaggregate the EVCLs non-intrusively. The rapid popularization of EVs introduces many new load peaks to the electrical grid. Extracting and aggregating those EVCLs is essential to allow smart grid operators to make intelligent and informed decisions about conserving energy and promoting the stability of the electrical grid. Hence, a huge amount of research was conducted on EVs and their upcoming challenges to the grid in recent years. Due to the instability that EVs introduce to the grid, research studies were focusing mainly on smart charging of EVs [15],[16]. Also, investigating the effects of EVs on distribution networks [17] and allocating of optimal capacity and location of commercial and residential EV charging stations [18]-[22]. To promote the stability of the grid and minimize infrastructural changes, many utilities use a time-of-use (TOU) based electricity demand response (DR) programs, which can potentially promote the stability of the grid by shifting EV load demand from peak load periods to off-peak load periods. In a TOU-DR system, the price of electricity differs during peak and off- peak hours. This encourages customers to charge EVs during off-peak hours [23],[24]. However, currently only 1% of residential customers in North America are billed with TOU rates, and 5% of utilities provide TOU pricing to residential customers [25], Although the number of utilities adopting TOU-DR programs for residential customers is increasing [23], the coordination of DR resources is a challenging task due to the lack of communication with each individual load. The current terminology has presented the term flexibility to indicate the capacity to adapt across temporal, range, intention and area of application [26]. For the applications to the electrical grid, flexibility refers to the possibility of deploying the resources to respond in a reliable manner to the load and generation variations at acceptable costs. One of the current challenges is to address the quantification of the flexibility amount. Recent works focus on obtaining flexibility from the generation and demand side [27]-[35]; however, no works address the extraction and quantification of the flexible amount of the aggregate demand of EVs. For this purpose, in this paper, an unsupervised algorithm to extract EVCLs from the aggregated residential loads is presented. The algorithm requires no training and is able to extract EVCLs of various types of EVs, including high- voltage Tesla EVs. The extracted EVCLs are aggregated. Then the quantification of the flexibility amount of the aggregated EVCL demand is presented by investigating the probability to change the collective behavior of the aggregated EVCLs. This can assist grid operators in smart charging strategies of EVs. The remainder of this paper is structured as follows. Section II, recalls the theoretical background, including the independent component analysis (ICA) method that is used in the extraction of EV charging loads (EEVCL) algorithm. Section III illustrates the formation of the EEVCL algorithm. Section IV and V, present the modeling of the EVCLs using the Bayesian maximum likelihood method and defining the flexibility of residential EVCLs, respectively. The application and verification of the proposed methods for extracting and defining flexibility are presented in Section VI. Finally, the conclusions are drawn in Section VII. II. THEORETICAL BACKGROUND OF ICA FOR EXTRACTING EVCLS In this section, the general independent component analysis (ICA) method is presented. Further, the preprocessing steps that make the problem of ICA estimation simpler and better conditioned are presented. In the last subsection, an explanation on how the ICA can be utilized for extracting the EVCLs is highlighted. 1551-3203 (c) 2017 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See http://www.ieee.org/publications_standards/publications/rights/index.html for more information. This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/TII.2017.2724559, IEEE Transactions on Industrial Informatics TII-17-0494.R2 3 A. Independent Component Analysis (ICA) ICA [36],[37] is a signal processing technique whose goal is to express a set of random variables as linear combinations of statistically independent component variables. One of the main applications of ICA is in blind source separation [37]. In the basic form of ICA [36], x = [x1, . . ., xm] is a random time- varying observed signal vector, and likewise s = [s1, . . ., sm] is a random vector with the original signal elements. Then the linear relationship is given by: x As (1) where A is an unknown m×n mixing matrix to be estimated. The statistical model in (1) is called the ICA model. The ICA model is a generative model, which means that it describes how the observed data are generated by a process of mixing the components s. The independent components are latent variables that cannot be directly observed. Also, the mixing matrix A is assumed to be unknown. The only observation is the random vector x, and it is desired to estimate A and s using it. To obtain this, it is assumed that the components si are statistically independent. Also, the independent component has non-gaussian distributions. However, in the basic model, these distributions are not known (if they are known, the problem is considerably simplified). For simplicity, it is assumed that the unknown mixing matrix A is square. Then, after estimating the matrix A the inverse can be computed (W), and the independent components are obtained by: s Wx (2) Before applying the ICA algorithm on data, it is useful to do some preprocessing, to make the problem of ICA estimation simpler and better conditioned. The used preprocessing techniques including centering and whitening are presented in Appendix A. Although ICA separates the signals, the exact amplitude and sign of the independent components cannot be determined. This is considered to be a drawback in applications where the amplitudes of the signals are desired. B. ICA for Extracting EVCLs In the context of applying the ICA for extracting the EVCLs, x is the observed aggregated signal composed of two mixed signals. The first is the aggregated signal without the EVCL signal, and the other is the EVCL signal. Here it is assumed that the amplitude of the EV signal is known (Table I). This means that one independent distribution is known and, hence, this simplifies the problem. Accordingly, the ICA model can act as extracting the distribution pattern of the EV load from the observed aggregated signal. To achieve this, EV charging profile loads have been collected. Table I presents some of the collected EVCL signals for existing EVs in global markets [39], including 100% EVs and plug-in hybrid vehicles. The EV signal that the ICA needs to extract is a called a template. A template is a row vector that contains N replicates of the EV charging amplitude. The EVs can be grouped into categories based on their charging amplitudes. For example, EVs that have charging amplitudes of 3xxxW are grouped in the same category and EVs that have charging amplitudes of 6xxxW are in the same category, and so on. It should be noted that Table I can be updated when EVs with different amplitudes arise. In cases where the amplitude does not exist in Table I, the proposed algorithm will extract the EVCL but, the amplitude of the extracted EVCL will be under estimated. For example, if the actual amplitude of the extracted EVCL is 7.4 kW (does not exist in Table I), the proposed algorithm will estimate the amplitude as 7.2 kW. Although the EVCL can be extracted from the aggregated signal using the ICA method, the amplitude and sign of the extracted EVCL cannot be determined. This is due to the unavoidable ambiguities of ICA. For that, the grouping of EVs in categories will assist in estimating the amplitude of the extracted EVCL signal in Section III-B. III. EEVCL ALGORITHM This section illustrates the general EEVCL algorithm. The initial data is the aggregated load pattern (ALP) vector x = [xt, . . ., xT], for t = 1,. . ., T. The ALP contains T observations with a time series resolution of one minute. The mathematical formulation presented here is described by considering all vectors as row vectors. 1) General Aspects The vector s = [snm, . . ., sNm] represents the m-th template to be extracted from the ALP x. The whole set S of templates is represented by the matrix S = [sm, . . ., sM] for m = 1,. . ., M. From Table I, the number of templates M=7. Each template sm contains N points of charging power amplitudes to be extracted. In this illustration, the ICA is applied with a time frame window size of N=10. The window is then shifted progressively to the next frame until the entire ALP (x) is covered. For example, if x contains the daily ALP with one- minute time-steps (T=1440), accordingly, the ICA will be applied T/N = 144 times to cover the whole sequence of x. The templates are grouped into categories based on their charging amplitude. For example, EVs that have charging amplitudes of 3xxxW are in the same category and EVs that have charging amplitudes of 6xxxW are in the same category, and so on. This assumption will assist in the estimation of the amplitude of the extracted EVCL in the iterative process. The extracted EVCL can include more than one extracted charging session (ECS). An ECS consists of the index time t when the EV starts charging (starte) and the index time t when the EV ends its charging session (ende). The ECSs are registered as couples in a vector De = [starte, ende] and the entire couples of ECSs for an extracted EVCL are represented in the matrix D = [De,…, DE]. As mentioned previously, in the context of applying the TABLE I THE CHARGING AMPLITUDES OF EVS IN GLOBAL MARKETS Model Max Charge Category# Porsche Panamera S 3 kW 1 Audi A3 e-tron, Cadillac ELR, Chevy Spark, Chevy Volt, Ford Fusion, Hyundai Sonata, Mercedes S550, Mitsubishi i-MiEV, Nissan LEAF 3.3 kW Porsche Cayenne S, Volkswagen e-Golf 3.6 kW Tesla 6 kW 2 Fiat 500e, Ford Focus, Honda Accord, Kia Soul, Nissan LEAF 6.6 kW BMW i3, Volkswagen e-Golf 7.2 kW 3 Tesla Model S, Tesla Model X 10 kW 4 1551-3203 (c) 2017 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See http://www.ieee.org/publications_standards/publications/rights/index.html for more information. This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/TII.2017.2724559, IEEE Transactions on Industrial Informatics TII-17-0494.R2 4 ICA for extracting the EVCL, the observed signal vector is x and one of the sources s is assumed to be known. This means that one independent distribution is known and, hence, this simplifies the problem. Accordingly, the ICA model can act as extracting the distribution pattern of the template sm from the aggregated power x. B. Iterative Process 1) Initialization: The initialization includes the setting up of the number of the minimum desired sequence of EVCL to be extracted at each window (N), and the amplitudes and number of templates (M). 2) Successive Iteration: Step1: The ICA is applied with a window size of N=10 on the entire sequence of x to extract the m-th EVCL (sm). The result is a vector zn = [znt, . . ., znT], for t = 1,. . ., T that represents the extracted EVCL from x. The vector zn will contain detections of EVCLs if the whole sm template window matches. This will lead to missing EVCLs that have not started at the beginning of the window. For this purpose, the ICA is repeatedly applied N times. At the beginning of every repetition n, the window is shifted one position to the right. Thus, ten extracted EVCLs are obtained and stored in an N×T matrix Z = [zn, . . ., zN], for n = 1,. . ., N. Step2: Here a variable p for p = 1,…, N/2 is introduced. This variable represents the number of non-zero extracted EVCL occurrences in the t-th column of matrix Z. From each column t of matrix Z, a solution component ct, for t = 1,. . ., T is generated. The component ct is zero unless there are p non- zero occurrences then ct becomes: tc = { 1 / N nt n pZ       , of occurancenumbe spr  0 , otherw ise (3) The result is an extracted EVCL solution vector cp = [cp1,…, cpT] and the set of solutions C is represented with the matrix C = [c1,…, cp], for p = 1,…, 5. Step3: Due to appliances that may have similar operation cycles and amplitudes as EVs (e.g., A/C units and dryers) the generated solution cp may contain false positive (FP) detections of EVCLs. It is desired to shave or at least mitigate these FP extractions. To achieve this, the signatures of household appliances that may cause FP detections are studied to take advantage of their behavior in reducing the FP detections rate. It was observed that most of the FPs occur from dryers, especially, when s is from Category#1. The following steps were generated after studying the appliances that interfere, and have similar amplitudes and patterns to EVs. 1- If the length between two consecutive couples of ECSs is: 1 11 ( ) 18 ( ) 120 AND OR ( ) 120 ee ee ee abs start end abs start end abs start end       (4) then remove both couples of ECSs from cp and update the ECS matrix D. 2- If the length of a couple ECS is: ( ) 20eeabs start end , remove the ECS couple from cp and update the ECS matrix D. The latter will lead the proposed algorithm to not extract EVCLs that have charging sessions < 20-minutes. Such short charging sessions can be neglected when there is a trade-off between accuracy and detecting shorter charging sessions. The state-of-the-art algorithms [14] can only extract EVCLs that have charging sessions > 30-minutes. The result from this step is an updated matrix C that has zero/reduced FP detections of EVCLs. Step 4: As mentioned in Section II, the ICA algorithm is unable to detect the sign and estimate the amplitude of the separated signal. In the context of EV charging, the sign of the extracted EVCL must always be positive as it consumes power. Accordingly, this drawback of ICA can be overcome. However, the remaining issue of estimating the amplitude of the extracted EVCL needs to be addressed. For this purpose, four estimation methods will be introduced to estimate the amplitude of the extracted EVCLs. It should be noted that, for EV templates (s) that have greater amplitude than the ALP (x), there will be no ECS detected. For example, if s7 (from Category#4) is selected as a template, where the amplitude is 10 kW, and the entire ALP (x) has amplitude less than 10 kW, there will be no extracted EVCL (cp). Accordingly, there is no reason to estimate the amplitude and the algorithm will return zero EVCLs. In this algorithm, it is assumed that the amplitude can be estimated from the components of x that precede (P) and/or follow (F) a De charging couple: ( ( ) ,..., ( ) )e e e eP x D start ps D start fs   (5) ( ( ) ,..., ( ) )e e e eF x D end ps D end fs   (6) where a duration of 10-minutes that precede and/or follow are considered, ps = 5 and fs = 15. In a second formation of the algorithm, ps = 10 and fs = 20. This means that 10-minutes that precede and/or follow the ECS are used to estimate the amplitude of the ECS of the extracted EVCL. The reason behind skipping the components that directly precede and follow the ECS is due to the gradient nature of EVs charging pattern behavior during the plugging and unplugging, which could penalize the results of the amplitude estimation methods. In the following methods the amplitude is estimated by computing the load before and/or after an ECS occurs (baseload). The baseload is then added to the extracted EVCL to reconstruct the original ALP (x). Then the amplitude of the ECS can be the one that has a reconstructed load pattern (ESTx) closest to the original x. This estimation of the amplitude using the baseload ensures that the best-chosen EV template sm does not overestimate the actual EV amplitude. For example, if the ALP exceeds 10 kW and the actual EV charging amplitude is 7 kW (Category#3), the amplitude estimation using the baseload will ensure that the extracted EVCL will not be overestimated and assigned to Category#4 with an amplitude of 10 kW. Following is the estimation method: For each ECS couple, the baseload (Be ) is computed: 1551-3203 (c) 2017 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See http://www.ieee.org/publications_standards/publications/rights/index.html for more information. This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/TII.2017.2724559, IEEE Transactions on Industrial Informatics TII-17-0494.R2 5 eB = { 1max{max( ), max( )} mP F s , ( ) AND ( ) ee ee D start fs T D end fs   max( )F , ()eeD start fsmax( )P , ()eeT D end fs (7) Then the baseload (Be) is used to reconstruct an estimation of the original ALP (x). 1(( ) / ) , for max( ( ,..., ))        t m e t pt e e ee ESTx x x s B ESTx C start t end x start end (8) where ESTx is a reconstruction of x. Then the baseload (Be) is used to reconstruct the original ALP (x): 1(( ) / ) , for t t m e pt e e ESTx x ESTx x S B C start t end       (9) where ESTx is a reconstruction of x. Now the error between the original x and the reconstructed ALP (ESTx) is computed: 1 0 ()tt t pm T x ESTxError    (10) where p represents the extracted EVCL solution cp and m represents the EV template sm. For the remaining solution vectors C = [c2,…, cp], the same operations of Step3 and Step4 are performed with the shaving of FP extractions, the reconstruction of ESTx, and the computation of Error0pm. After the Error0 has been computed for each p, the minimum error (Error1m) of the extracted EVCL solution vectors C for iteration m is computed: m1 ( 0in( ))mmError abs Error (11) arg min( ( ))0mmabs Errora  (12) and the related extracted EVCL solution vector cp and index are stored in matrix C and vector a , respectively. The corresponding cp is interpolated as the best-extracted EVCL c for iteration m, m1[ ,..., ] mma a Tc c c . For the successive iterations m=1,…, M, the group of operations are the same as the ones described in Step2 to Step4, this includes the application of ICA, the generation of extracted EVCL solution vectors C, the shaving of FP extractions, the reconstruction of ESTx, the computation of Error1m, and storing the best estimations of the extracted EVCLs in C . Before the final best-extracted EVCL and amplitude template are obtained the next stage is an attempt to improve the accuracy of the extracted EVCL amplitudes. 3) Local Estimation Improvement: In this stage, an attempt to improve the accuracy of the amplitude of the extracted EVCL is presented. From the vector Error1, the minimum index is located: arg m )in( ( )1abs Errorb  (13) then the corresponding best EVCL bc and the EVCLs that exist in the same category, if any, are of interest for further processing. For example, if b=2 then the EVCLs 1c and 2c are involved as they fall in the same category (Category#1). For each one of these bc , the ECSs matrix D is computed. Then similar to the reconstruction of the original ALP (x) part in Step4, for each couple De, the reconstructed load pattern ESTx2 is computed by: 2ESTx x (14) 2 ( ) /( 1) e e end e t t e e t start B x ESTx end start          (15) 2 2 , for t t e e eESTx ESTx B start t end    (16) Now the error between the original x and the reconstructed ALP (EST2x) is computed: 1 2 ( 2 )tt T b t xError EST x    (17) The final extracted EVCL ( f ) with the best-estimated amplitude can be obtained by:  arg min min ( mi (1), 2)nabs Error abs Erg ror (18) f gc (19) The final extracted EVCL ( f ) is the gc vector that has the minimum error between the reconstructed load pattern and the original ALP (x). As mentioned previously, this step was to improve the selection of the best estimate from the templates (S). IV. MODELING DEMAND VARIATIONS USING BAYESIAN MAXIMUM LIKELIHOOD From the previous section, each extracted EVCL pattern is represented by f 1[ ,..., ] Tff , for t = 1,. . ., T. The matrix of all extracted EVCLs is represented by the matrix kF , for k = 1,. . ., K. The EV load variations referring to increase or decrease from one-time observation to the following one is computed for all extracted EVCLs f : ( 1) , for 2,...,kt kt k tf f f tT    (20) The extracted EVCL and its variation can be represented by the following vectors: fk 1[ ,..., ] Tff (21) fk 1[ ,..., ] Tff   (22) A. Binomial Representation of Variations For the particular problem in this paper, the variations in EVCL may be positive or negative. Accordingly, the demand variations can be modeled with the binomial distribution with two response variables: 1) increasing in EVCL demand, 2) decreasing in EVCL demand. Each observation can be considered as a Bernoulli trial with two outcomes. The outcome of each trial at a particular time observation t is: kt = { 1 ktUPos  , 0 ktf 1 ktUNeg  , 0 ktf (23) B. Bayesian Maximum Likelihood Estimation From the binomial model presented in the previous subsection, the probability of an increase ( t ) is unknown, 1551-3203 (c) 2017 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See http://www.ieee.org/publications_standards/publications/rights/index.html for more information. This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/TII.2017.2724559, IEEE Transactions on Industrial Informatics TII-17-0494.R2 6 and a suitable estimation method is needed. The Bayesian maximum likelihood estimation method [40] is used. The reason for using such method is due to it providing a natural and principled way of combining prior information about EV charging behaviors with data, within a solid decision theoretical framework. In addition, it incorporates past information about the increase in EVCLs and forms a prior distribution for future increase in EVCLs analysis. All inferences logically follow from Bayes’ theorem. Bayes formula is presented by [40]:         | |    data data data p f p pf pf (24) This formula can be expressed informally in English by: likelihood prior posterior evidence   (25) The Bayes formula converts the prior information about the increase in EVCLs into a posterior probability  | data pf by using the likelihood function  |  data pf . To compute the probability of an increase ( t ) using the Bayesian maximum likelihood estimation method, first, the prior probability is computed. To compute the prior probability of EVCL increase, EVCL pattern data is needed. This data can be extracted by the EEVCL algorithm (Section III) for past years for the same location where the posterior probability is desired. If prior historical data is unavailable for that location, data for another location can be used instead to compute the prior. For example, if historical EVCLs data for Texas is available, the prior probability of an increase in EVCLs can be computed, and recent data from Texas can be used to compute the likelihood. However, if it is desired to compute the likelihood of EVCL increase for California were historical data (prior) is unavailable, the computed Texas prior probability can be used. Following are the steps to compute the Bayesian likelihood estimation for the increase in EVCL. Step1 (Prior): Previous aggregated residential load patterns that include EVCLs are obtained. The EEVCL algorithm is applied (Section III) then the variations are modeled with the binomial distribution (Section IV-A). The number of trials (increase/decrease) is computed: 1 T tt t n U Pos U N eg   (26) The probability of success (increase in EVCL) is computed: 1 / T t t m U Pos n    (27) Step2 (Likelihood): Recent residential load patterns that include EVCLs are obtained. Then similar to Step1, the EEVCL algorithm is applied, and the variations are modeled with the binomial distribution. The number of trials from this data is computed: 1 T tt t UPos UNeg     (28) The number of successes (increase in EVCL) is computed: 1   T t t Y UPos (29) Step3 (Posterior): In this step (24) converts our prior belief about the increase in EVCL (before seeing data) into a posterior probability by using the likelihood function (Step2). The posterior probability of increase for this binomial process can be computed by: ( ) 1a Y n m    (30) ( (1 )) 1b N Y n m      (31) t a mean ab    (32) and, the confident intervals are computed by: 2 var ( ) / ( ) ( 1)a b a b a b     (33) var t mean  (34) var t mean  (35) The probability of an increase in EVCL and its upper and lower limits can be represented by the following vectors: 23[ , ,..., ]  Tt w w w (36) 23[ , , ..., ]  Tt w w w (37) 23[ , , ..., ]  Tt w w w (38) V. FLEXIBILITY DEFINITIONS FOR EVCLS In the previous section the probability of demand increase in EVCL at each time observation was modeled using the Bayesian maximum likelihood method. In this section, the probability of demand increase in EVCL ( t ) is used to define a flexibility index of EV aggregated demand (FIEVAD). Further, the flexibility percentage level (FPL), that expresses the percentage of flexible demand associated with the flexibility index (FIEVAD), is defined. A. Flexibility Index of EV Aggregated Demand (FIEVAD) Let  f and f  be mean values of the load variations for increase and decrease in demand, respectively, and can be computed by: tf  1 /   T t t fY , 0 tfr fo (39) tf  1 /( )   T t t Yf , 0 tfr fo (40) Now, the minimum between the probability of an increase in demand and the complementary probability is computed: min ( ,1 )      t ttt (41) By definition, the value of each entry  t is in the range of [0, 0.5]. In fact the minimum complementary value of entries  t and (1 ) t is equal to 0.5 when 0.5  t , and is equal to zero when 1  t . In order to obtain the formulation of the FIEVAD in a range of [0, 1] in line with the probabilistic limits, the probability values of  t are multiplied by two, which are the number of variations (increase and decrease in demand) of the binomial probability distribution: 2 ttFIEVAD , with [0,1]FIEVAD (42) It can be noted from the formation of the FIEVAD value that it gives information about the possible probabilistic change to the nearest optimum, 0 or 1, for each binomial category (increase or decrease in demand). Also, by definition, the 1551-3203 (c) 2017 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See http://www.ieee.org/publications_standards/publications/rights/index.html for more information. This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/TII.2017.2724559, IEEE Transactions on Industrial Informatics TII-17-0494.R2 7 FIEVAD values are symmetric with respect to 0.5. This corresponds to that any change in  t determines opposite changes in  f and f  . The flexibility index (FIEVAD) is not a quantitative margin expressed in watts, but reflects EV charging behavioral interpretation in terms of collective trend. Also, the FIEVAD incorporates both the possibility of increasing/decreasing in the aggregated EVCL and accepting variations. If the FIEVAD value is close to 1, this indicates that the EV charging behavior is very random and there is no collective trend in the corresponding observation time. Accordingly, the flexibility to change the behavior is high, and there is a high chance to obtain DR benefits. This information can assist operators and researchers to improve the stability and economical operation of the grid by managing supply and demand flexibilities. FIEVAD values close to zero, indicate that there is a collective behavior (trend) in EV charging. Accordingly, the aggregated demand is rigid to accept DR changes. B. Flexibility Percentage Level (FPL) The flexibility percentage level (FPL) expresses the percentage of flexible demand associated with the flexibility index (FIEVAD). This indicator represents what percentage of aggregated demand can be reduced or increased without affecting the average change in the collective demand. The FPL can be computed by: 100 2      t t t t t f f FIEVAD FPL f (43) where tf is the mean value of the extracted EVCLs f at time observation t. The FPL increases as customers change their EV charging behavior from an increase in EVCL demand towards a decrease in EVCL demand and vice versa. However, increasing the FPL is challenging when customers follow a trend behavior (i.e.,  t is close to 0 or 1). For example, if  t =0.9, which means there is a trend in EV charging behavior, it is hard to reverse this trend by reducing  t to zero. Also, when  t =0.1, which means there is no trend in EV charging, it is more reasonable to reduce  t to zero than increasing it to 1. This is one of the reasons to define the FIEVAD as the minimum of the two binomial probabilities of increase and decrease in EV charging demand in (42). The FPL takes into account the increase and decrease in collective demand together. Separate information for the maximum increase (  VPL ) and decrease (  VPL ) in aggregate demand can be obtained by: (1 ) 100       tt tt t ff VPL w f (44) ( ) 100     tt tt t ff VPL w f (45) These indicators represent the maximum demand variation that may be obtained in the case were all the increasing EV charging demand changes to decreasing in EV charging demand, and vice versa. It should be noted that (  VPL ) and (  VPL ) refer to load variability and not to the flexibility in collective EV load demand. The FPL,  VPL and  VPL can be expressed in watts by: ( / 100) t t tFPLwatt f FPL (46) ( / 100)  t t tVPLwatt f VPL (47) ( / 100)  t t tVPLwatt f VPL (48) VI. APPLICATIONS AND DISCUSSIONS In this section the application of the above-mentioned algorithms to extract EVCLs and define flexibility for the extracted aggregated EVCLs is presented. In the first subsection, the EEVCL algorithm is verified and compared to a state-of-the-art algorithm on extracting residential EVCLs. In the following subsection, a second verification of the EEVCL algorithm on extracting EVCLs and comparing the aggregated EVCLs to the aggregated ground truth is presented. The resulted data is used in a case study in the last subsection, in order to quantify the flexibility achievable from the aggregate EV load in different time periods. It should be noted that the proposed approach is applied off-line in the following verifications. A. Verification of the EEVCL algorithm The EEVCL algorithm was tested by using data from the Pecan Street Inc. [41], which contains up to 1-minute time- steps of circuit-level and house-level electricity data from 1391 households in Texas, Colorado, and California. It should be noted that not all households have EVs. To verify the proposed approach, the available dataset used by [14] was used as a benchmark. This dataset includes the daily aggregated power signals for 23 households and the ground truth of the EVCLs from [41]. The EVs considered in this dataset have amplitudes that fall in Category#1. It should be noted that houses#4, 5, 13 and 23, do not include any EVCLs, to test the extraction of FPs from the EVCLs. In the first run, the duration of 10-minutes that precede and/or follow an extracted EVCL to estimate its amplitude was ps = 5 and fs = 15. In the second run, ps = 10 and fs = 20. Fig. 1, illustrates how the extracted EVCL was obtained for house#2 using the EEVCL algorithm with estimation and ps = 10 and fs = 20. The results of the algorithm are evaluated using a modified F- score and accuracy error and are measured only when EVCLs are present either in the EVCL ground truth or the extracted EVCL. The utilized evaluation measures are presented in [42] and the formula to compute the modified F-score is presented in Appendix B. Table II presents the accuracy measures of the proposed method. It was observed that the EEVCL algorithm achieved relatively high F-scores, except for house#19. The resulted EVCL when ps = 5 and fs = 15, was unable to detect the actual EVCLs. This suggests that considering observations of ALP that are closer to an ECS to estimate the amplitude may extract FPs or not extract any EVCLs. It should be noted that extracting the EVCL for house#19 is a challenging task due to the high degree of overlapping of other appliances that have similar EV load patterns. Although their algorithm performed better on house#19, it has failed to extract the EVCLs for houses#2 and 17 and overestimated house#3. A drawback of [14] is introducing definitions such as the 1551-3203 (c) 2017 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See http://www.ieee.org/publications_standards/publications/rights/index.html for more information. This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/TII.2017.2724559, IEEE Transactions on Industrial Informatics TII-17-0494.R2 8 effective width and effective height. Those definitions restrict the detection of EVCLs to certain charging patterns. In house#17, their algorithm failed because it can only extract EVCLs that have durations longer than 30-minutes and shorter than 200-minutes. To extract EVCLs that have less than a period of 30-minutes, FPs extractions may appear. On the other hand, the algorithm proposed in this work can extract EVCLs that have durations as low as 20-minutes. From this, there is a trade-off between detecting shorter EVCLs and extracting FPs that occur from other appliances. B. Extracting and comparing the aggregated EVCLs In this verification of the EEVCL algorithm, data from the Pecan Street Inc. [41] for each month of 2015 and 2016 are considered. Each month is divided into weekdays and weekends. The reason for this separation is because EV charging behaviors vary between weekdays and weekends. For each month, the EEVCL algorithm is applied to extract the EVCLs ( F matrix). Fig. 2 shows the daily residential loads for weekdays and weekends of July 2016. The extracted EVCLs from the daily residential loads of Fig. 2, using the EEVCL algorithm, are presented in Fig. 3. Those extracted EVCLs are aggregated and compared with the actual aggregated EVCL demand pattern in Fig. 4. The error between the actual and extracted aggregated EVCL demand for weekdays and weekends for July 2016 was -3.12% and - 4.75%, respectively. C. Case Study on Defining Flexibility In this case study, it is intended to define the flexibility for a certain time frame. For this purpose, the time observation duration is 15-minutes. Each time observation is the sum of EVCLs in that 15-minute period. The general layout of the procedure of this case study is presented in Fig. 5. The demand variations for the extracted EVCLs ( F ) for TABLE II PERFORMANCE COMPARISON EEVCL with ps = 5 and fs = 15 EEVCL with ps = 10 and fs = 20 [13]’s Algorithm Car Category Error% Precision Recall F-score Category Error% Precision Recall F-score Category Error% Precision Recall F-score 1 1 0.99 89.29 100 94.34 1 19.02 90.91 100 95.24 1 25.71 89.29 100 94.34 2 1 -100 0.00 0.00 0.00 1 5.20 90.38 95.92 93.07 0 -100 0.00 0.00 0.00 3 1 3.37 83.58 95.73 89.24 1 7.23 84.17 100 91.41 1+ 49.84 0.00 0.00 0.00 4 0 0.00 - - - 0 0.00 - - - 0 0.00 - - - 5 0 0.00 - - - 0 0.00 - - - 0 0.00 - - - 6 1 -9.99 98.21 98.21 98.21 1 -9.99 98.21 98.21 98.21 1 0.46 98.25 100 99.12 7 1 -9.78 99.00 99.00 99.00 1 -2.75 100 98.00 98.99 1 1.58 99.01 100 99.50 8 1 -5.39 95.45 100 97.67 1 1.71 97.67 100 98.82 1 13.41 95.45 100 97.67 9 1 -3.62 99.05 96.30 97.65 1 -4.87 100 87.96 93.60 1 4.64 99.08 100 99.54 10 1 -10.7 99.54 98.64 99.09 1 -1.40 99.54 99.09 99.32 1 -0.55 98.65 100 99.32 11 1 -9.25 98.85 99.61 99.23 1 -0.94 99.61 99.61 99.61 1 -0.55 98.85 100 99.42 12 1 -9.58 99.54 100 99.77 1 -9.58 99.54 100 99.77 1 3.90 99.08 100 99.54 13 0 0.00 - - - 0 0.00 - - - 0 0.00 - - - 14 1 0.25 90.00 100 94.74 1 10.28 90.00 100 94.74 1 14.58 86.54 100 92.78 15 1 -7.87 97.92 100 98.95 1 1.34 100 93.62 96.70 1 0.80 97.92 100 98.95 16 1 -7.06 97.10 100 98.53 1 -9.75 98.51 98.51 98.51 1 1.72 97.10 100 98.53 17 1 -4.46 94.29 100 97.06 1 1.55 96.77 90.91 93.75 0 -100 0.00 0.00 0.00 18 1 -6.65 96.67 100 98.31 1 0.97 98.31 100 99.15 1 2.14 96.67 100 98.31 19 2 -100 0.00 0.00 0.00 1 53.32 64.62 100 78.50 1 -8.97 99.47 89.05 93.97 20 1 -11.5 99.10 97.36 98.22 1 4.29 100 96.48 98.21 1 6.46 98.66 97.36 98.00 21 1 -9.94 98.91 98.91 98.91 1 -9.94 98.91 98.91 98.91 1 -0.32 98.92 100 99.46 22 1 -8.46 98.49 100 99.24 1 7.09 100 98.98 99.49 1 18.36 97.00 98.98 97.98 23 0 0.00 - - - 0 0.00 - - - 0 0.00 - - - (a) (b) (c) Fig. 1. The result of the proposed algorithm with estimation Method 3. (a) the EVCL after applying ICA. (b) EVCL after removing the FPs. (c) final EVCL (yellow) vs. the actual EVCL (red). 1551-3203 (c) 2017 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See http://www.ieee.org/publications_standards/publications/rights/index.html for more information. This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/TII.2017.2724559, IEEE Transactions on Industrial Informatics TII-17-0494.R2 9 each month are first modeled using the Bayesian maximum likelihood method (Section IV). In this illustration, we continue with presenting the results of July. To compute the probability of an increase in EVCL (  t ): 1- First, the prior probability of an increase in EVCLs is computed using (26) and (27). This corresponds to data of July 2015. However, as mentioned in Section IV-B if prior historical data is unavailable for a certain location, data for another location can be used instead to compute the prior. 2- The likelihood of the recent data is computed using (28) and (29). This corresponds to the extracted EVCLs for July 2016 (Fig. 4). 3- The posterior probability, which corresponds to  t can now be achieved by (30)-(32). Fig. 6 presents the probability of increase in EVCL and its upper and lower limits for July. It can be observed that there is a high probability of increase in EV charging around hour 11:00 and hour 17:00 in weekdays. The same effect can be observed between hour 7:00 and 8:00 in weekends. The EV charging behavior between hour 5:00 and hour 7:00 is similar for weekdays and weekends. The flexibility index (FIEVAD) is computed using (39)- (42). Fig. 7 presents the FIEVAD values. It can be noted that lower FIEVAD values appear during the morning and evening periods in weekdays, where there is a collective tend, and the aggregated demand becomes more unlikely to induce DR changes. The same effect can be observed between hour 7:00 and 8:00 in weekends. As mentioned previously, FIEVAD closer to one indicates that the EV charging behavior is random and there is no collective trend, accordingly, there is more chance for inducing DR changes. This effect can be observed more in weekends. The flexibility percentage (FPL) is presented in Fig. 8. This represents the percentage of the aggregated EV charging demand that can be reduced or increased without affecting the average change in the collective EV charging. It can be observed that when trend periods arise, the probability to achieve higher FPL values is low (discussed in Section V- B). The variability  VPL and  VPL are presented in Fig. 9. As mentioned previously, these indicators represent the maximum demand variation that could be obtained when all the increase in demand changes to decrease in demand, and vice versa. The yellow bars represent the maximum decrease in collective demand if all the increase in demand, for that time period, changes to decrease in the collective EV charging demand. Whereas, the red bars represent the maximum increase in demand for a time period if all the decrease in demand changes to increase in the collective EV charging demand. This can be useful for grid operators to make decisions on which time periods can be selected to establish EV DR programs. The grid operators may involve other inputs for effective decision-making such as, peak loads and electricity price. However, it should be noted that DR and decision- making is outside the scope of this paper. The procedure followed in this application is useful for system operators to identify how flexible the aggregated EVCL in different periods of time. This can assist the operators in deciding whether or not it can be viable to incentivize EV charging customers to change their charging demand patterns, taking into account the flexibility information identified to represent the collective behavior of the aggregated EV charging. On the basis of the flexibility (a) (b) Fig. 2. The daily residential loads for July 2016. (a) weekdays. (b) weekends. (a) (b) Fig. 3. The daily EVCLs for July 2016. (a) weekdays. (b) weekends. 1551-3203 (c) 2017 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See http://www.ieee.org/publications_standards/publications/rights/index.html for more information. This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/TII.2017.2724559, IEEE Transactions on Industrial Informatics TII-17-0494.R2 10 indices, the expected response to DR programs can be higher in some time periods and lower in other time periods; accordingly, it may be useless for the operators to propose incentives to customers in time periods where the EV aggregate demand has low flexibility. In particular, in the time periods where the values of the FIEVAD and FPL indicators are low, the decisions aiming to reshape the aggregate EV charging demand is unlikely to be effective. This is because the collective EV charging behavior is following a trend in these time periods, which limits the overall demand flexibility. In other time periods where the FIEVAD and FPL values are higher, the collective behavior of the consumers is random and there is no clear trend in the changing demand. This suggests that consumers are more available to accept changes, leading to better ability to reshape the aggregated EV charging demand. The operators could use the FPL as an indicator to represent the percentage of the aggregated EV charging demand that can be reduced or increased without affecting the average change in the collective EV charging. Then, the (a) (b) Fig. 4. Comparison between the aggregated actual and extracted EVCLs. (a) weekdays. (b) weekends. Fig. 5. General layout of the procedure. Compute prior prob. of increase in EVCLs Aggregated residential load for past years Extract EVCLs using the EEVCL algorithm Aggregated residential load of on-hand data Compute Likelihood prob. of increase in EVCLs Extract EVCLs using the EEVCL algorithm Bayesian maximum likelihood of increase in EVCLs Compute the percentage fexibility index of EV aggregatred demand (FIEVAD) Compute FPL, and in KW prior Likelihood posterior Stage1 Stage2 Stage3 Stage4 (a) (b) Fig. 6. The probability of increase in EVCL and its upper and lower limits. (a) weekdays. (b) weekends. (a) (b) Fig. 7. The FIEVAD values. (a) weekdays. (b) weekends. 1551-3203 (c) 2017 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See http://www.ieee.org/publications_standards/publications/rights/index.html for more information. This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/TII.2017.2724559, IEEE Transactions on Industrial Informatics TII-17-0494.R2 11 variability  VPL and  VPL can be used to represent the maximum variation limits when all the increase in demand changes to decrease in demand, and vice versa. This can assist operators in the reshaping of the EV charging demand at the selected time periods, as decreasing the aggregated EV charging demand at one time period may imply an increase in another. D. Extracting EVCLs of Different Categories In this application, it is desired to extract EVCLs for households that have more than one EV. In cases where the EVs have the same charging amplitudes, the proposed algorithm can extract the EVCL at one run. However, in cases where the EVs have different charging amplitudes, the algorithm is run twice. In the first run, the algorithm will extract the EV that has higher charging amplitude. The extracted EVCL is subtracted from the ALP. Then, in the second run, the algorithm extracts the EV having the lower amplitude. In order to verify this, the actual EVCL of house#1 (has an EV of Category#1) is added to the ALP of a house that has an EV of Category#3. The actual EVCL of house#1 was added during the operation of other appliances (Fig.10 (a)) to further test the extraction during overlapping with other appliances. The EVCL from the first run and second run are shown in Fig.10 (b) and (c), respectively. Once the EVCLs are extracted, they are aggregated and the procedure of Fig. 5 can (a) (b) Fig. 8. The FPL percentage. (a) weekdays. (b) weekends. (a) (b) Fig. 9. The 15-min aggregated EV load (blue),  VPL in kW (red) and  VPL in kW (yellow). (a) weekdays. (b) weekends. (a) (b) (c) Fig. 10. Extracting EVCLs of different categories. (a) The actual EVCL of house#1 added to an actual ALP. (b) The resulted EVCL of the first run of the algorithm. (c) The resulted EVCL of the second run of the algorithm. 1551-3203 (c) 2017 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See http://www.ieee.org/publications_standards/publications/rights/index.html for more information. This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/TII.2017.2724559, IEEE Transactions on Industrial Informatics TII-17-0494.R2 12 be used to define flexibility for the collective EV charging demand. VII. CONCLUDING REMARKS This paper has introduced a method related to extracting EVCLs and quantifying the flexibility achievable from the aggregated EVCL demand. The algorithm to extract the ECVLs (EEVCL) is unsupervised and only requires the real power smart meter measurement, which is the type of data recorded and communicated by most smart meters. The algorithm utilizes a signal processing method ICA to extract the EVCLs from the aggregated load pattern (ALP) of households. The amplitude and sign of the extracted EVCLs obtained by applying the ICA method has been addressed by introducing an amplitude estimation method. In addition, the presented algorithm can effectively mitigate the interference of other appliances that have similar load behaviors as EVs. Further, the extracted EVCLs are aggregated. Then a method to model the probability of an increase in EVCLs, using the Bayesian maximum likelihood, and quantify the flexibility of the aggregated EVCL demand is presented. To verify the effectiveness of the approach, the EEVCL algorithm was applied off-line on real residential datasets and compared with the state-of-the-art algorithms. The results of extracting the EVCLs from the daily ALP of households were satisfactory. The extracted EVCLs were segmented into weekdays and weekends, and the flexibility achievable from the collective EV charging behavior was analyzed. The work presented in this paper promotes the stability and economical operation of smart grids and can be useful for grid operators to plan for smart charging decisions on which time periods can be selected to establish DR programs. Also, the utilized indicators based on statistical analysis can assist operators and researchers in understanding time periods where trends in EV charging behaviors may arise and act accordingly. APPENDIX A. Preprocessing of ICA Before applying the ICA algorithm on data, it is useful to do some preprocessing, to make the problem of ICA estimation simpler and better conditioned. The used preprocessing techniques are: 1) Centering: A common and necessary preprocessing step is to center x. This is achieved by subtracting its mean vector {}m E x : cx x m (A1) This implies that s is a zero-mean vector as well, by taking expectations on both sides of (2): () cs W x m (A2) From this, all observation vectors are assumed to be centered, whereas, the mixing matrix remains unaffected after this centering step. 2) Whitening: Another useful step in the preprocessing is to whiten the observed vector (x). Whitening involves linearly transforming the observation vector x, such that a new whitened vector xw that has components that are uncorrelated and have their variances equal unity is obtained: {} T wwE x x I (A3) A simple method to perform the whitening transformation is to use the eigenvalue decomposition (EVD) [38] of the covariance matrix: {} TT E xx EDE (A4) where E is the orthogonal matrix of eigenvectors of {} T E xx and D is the diagonal matrix of its eigenvalues 1diag( ,..., ) nD d d . The observation vector can be whitened by the following transformation: 0.5 T wx ED E x   (A5) where the matrix 0.5 D  is computed by a simple component- wise operation: 0.5 0.5 0.5 1diag( ,..., ) nD d d     (A6) Whitening transforms the mixing matrix into Aw. From (1) and (7): 0.5 T wwx ED E As A s   (A7) hence, { } { } T T T w w w wE x x A E ss A T wwAA (A8) I The main purpose of whitening is to reduce the number of parameters to be estimated. Instead of having to estimate the n2 elements of the original matrix A, we only need to estimate the new orthogonal mixing matrix, where an orthogonal matrix has n(n−1)/2 degrees of freedom. B. Modified F-score 2 score precision recall F precision recall    (B1) REFERENCES [1] M. Duvall and E. Knipping, “Environmental assessment of plug-in hybrid electric vehicles,” EPRI Jul. 2007. [2] A. Dubey, and S. Santoso, “Electric vehicle charging on residential distribution systems: impacts and mitigations,” IEEE Access, vol. 3, pp. 1871-1893, 2015. [3] M. –S. Tsai, and Y. –H. Lin, “Modern development of an adaptive non- intrusive appliance load monitoring system in electricity energy conservation,” Applied Energy, vol. 96, pp. 55-73, 2012. [4] H. –H. Chang, C. –L. Lin, and J. –K. Lee, “Load identification in nonintrusive load monitoring using steady-state and turn-on transient energy algorithms,” in Proc. CSCWD, Shanghai, China. 2010, pp. 27-32. [5] M. Figueiredo, A. de Almeida, and B. Ribeiro, “Home electrical signal disaggregation for non-intrusive load monitoring (nilm) systems,” Neurocomputing, vol. 96, pp. 66-73, 2012. [6] J. Kolter, S. Batra, and A. Ng, “Energy disaggregation via discriminative sparse coding,” in Proc. Neural Information Processing Systems, 2010. [7] M. E. Berges, E. Goldman, H. S. Matthews, and L. Soibelman, “Enhancing electricity audits in residential buildings with nonintrusive load monitoring,” Journal of Ind. Eco., vol. 14, no. 5, pp. 844-858, 2010. [8] C. Laughman, K. Lee, R. Cox, S. Shaw, S. Leeb, L. Norford, and P. Armstrong, “Power signature analysis,” IEEE Power and Energy Magazine, vol.1, no. 2, pp. 56-63, 2003. [9] M. Zeifman, “Disaggregation of home energy display data using probabilistic approach,” IEEE Trans. Consumer Electronics, vol. 58, no. 1, pp. 23-31, 2012. [10] R. Fisera, and K. Macek, “Virtual sub-metering via combined classifiers,” in Proc. IDAACS, vol. 1, pp. 126-131, 2011. 1551-3203 (c) 2017 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See http://www.ieee.org/publications_standards/publications/rights/index.html for more information. This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/TII.2017.2724559, IEEE Transactions on Industrial Informatics TII-17-0494.R2 13 [11] H. -H. Chang, C. –L. Lin, and J. –K. Lee, “Load identification in nonintrusive load monitoring using steady-state and turn-on transient energy algorithms,” in Proc. CSCWD, pp. 27-32, 2010. [12] M. J. Johnson, and A. S. Willsky, “Bayesian nonparametric hidden semi-markov models,” Journal of Machine Learning Research, vol. 14, no. 1, pp. 673-701, 2013. [13] P. Zhang, C. Zhou, B. G. Stewart, D. M. Hepburn, W. Zhou, and J. Yu, “An improved non-intrusive load monitoring method for recognition of electric vehicle battery charging load,” Energy Procedia, vol. 12, pp. 104-112, 2011. [14] Z. Zhang, J. H. Son, Y. Li, M. Trayer, Z. Pi, D. Y. Hwang, and J. K. Monn, “Training-free non-intrusive load monitoring of electric vehicle charging with low sampling rate,” in Proc. IEEE IECON, Dallas, 2014. pp. 5418-5425. [15] M. A. Ortega-Vazquez, “Optimal scheduling of electric vehicle charging and vehicle-to-grid services at household level including battery degradation and price uncertainty,” IET Gener. Transm. Distrib., vol. 8, no. 6, pp. 1007–1016, Jun. 2014. [16] T. Zhang, W. Chen, Z. Han, and Z. Cao, “Charging scheduling of electric vehicles with local renewable energy under uncertain electric vehicle arrival and grid power price,” IEEE Veh. Technol., vol. 63, no. 6, pp. 2600–2612, Jan. 2013. [17] V. Aravinthan and W. Jewell, “Controlled electric vehicle charging for mitigating impacts on distribution assets,” IEEE Trans. Smart Grid, vol. 6, no. 2, pp. 999–1009, Jan. 2015. [18] M. Moradijoz, M. Parsa Moghaddam, M. R. Haghifam, and E. Alishahi, “A multi-objective optimization problem for allocating parking lots in a distribution network,” Int. J. Elect. Power Energy Syst., vol. 46, pp. 115– 122, Mar. 2013. [19] M. R. Aghaebrahimi, M. M. Ghasemipour, and A. Sedghi, “Probabilistic optimal placement of EV parking considering different operation strategies,” in Proc. 17th IEEE Mediterr. Electrotech. Conf. (MELECON), Apr. 2014, pp. 108–114. [20] Z. Hu, Y. Song, and Z. Luo, “Optimal siting and sizing of electric vehicle charging stations,” in Proc. IEEE Int. Elect. Veh. Conf., 2012, pp. 1–6. [21] A. El-Zonkoly, H. Ashour, and A. Ahmed, “Optimal allocation, sizing and energy management of PHEV parking lots in distribution system,” in Proc. 5th Int. Renew. Energy Congr. (IREC), 2014, pp. 1–5. [22] M. Moradijoz, A. Ghazanfarimeymand, M. P. Moghaddam, and M. R. Haghifam, “Optimum placement of distributed generation and parking lots for loss reduction in distribution networks,” in Proc. 17th Conf. Elect. Power Distrib. Netw. (EPDC), 2012, pp. 1–5 [23] ‘‘2012 assessment of demand response and advanced metering,’’ U.S. Federal Energy Regulatory Commission, Washington, DC, Dec. 2012. [24] I. Sulyma, K. Tiedemann, M. Pedersen, M. Rebman, and M. Yu, ‘‘Experimental evidence: A residential time of use pilot,’’ in Proc. ACEEE Summer Study Energy Efficiency Buildings, 2008, pp. 292–304 [25] P. L. Joskow and C. D. Wolfram, ‘‘Dynamic pricing of electricity,’’ Amer. Econ. Rev., vol. 102, no. 3, pp. 381–385, 2012. [26] W. Golden and P. Powell, “Towards a definition of flexibility: In search of the Holy Grail?,” Omega, vol. 28, no. 4, pp. 373–384, 2000. [27] E. Lannoye, D. Flynn, and M. O’Malley, “Evaluation of power system flexibility,” IEEE Trans. Power Syst., vol. 27, no. 2, pp. 922–931, 2012. [28] J. Ma, V. Silva, R. Belhomme, D. S. Kirschen, and L. F. Ochoa, “Evaluating and planning flexibility in sustainable power systems,” in Proc. IEEE Power Energy Soc. Gen. Meeting (PES), Vancouver, BC, Canada, 2013, pp. 1–11. [29] A. Papavasiliou and S. S. Oren, “Large-scale integration of deferrable demand and renewable energy sources,” IEEE Trans. Power Syst., vol. 29, no. 1, pp. 489–499, Jan. 2014. [30] I. A. Sajjad, G. Chicco, and R. Napoli “Demand flexibility time intervals for aggregate residential load patterns,” Power Tech, 2015. [31] I. A. Sajjad, and G. Chicco, “Definitions of demand flexibility for aggregate residential loads,” IEEE Trans. Smart Grid, vol. 7, no. 6, pp. 2633-2643, 2016. [32] R. Stamminger et al., “Synergy potential of smart appliances,” Fed. Ministry Environ., Nat. Conserv., Nuclear Safety, Bonn, Germany, Tech. Rep. Project Smart, 2008. [33] A. Safdarian, M. Fotuhi-Firuzabad, and M. Lehtonen, “Benefits of demand response on operation of distribution networks: A case study,” IEEE Syst. J., vol. 10, no. 1, pp. 189–197, Mar. 2016. [34] B. Kladnik, A. Gubina, G. Artac, K. Nagode, and I. Kockar, “Agent- ˇ based modeling of the demand-side flexibility,” in Proc. IEEE Power Energy Soc. Gen. Meeting, San Diego, CA, USA, 2011, pp. 1–8. [35] M. Alizadeh, A. Scaglione, A. Applebaum, G. Kesidis, and K. Levitt, “Reduced-order load models for large populations of flexible appliances,” IEEE Trans. Power Syst., vol. 30, no. 4, pp. 1758–1774, Jul. 2015. [36] P. Comon, “Independent component analysis: a new concept?,” Signal Processing, pp. 287-314, 1994,. [37] C. Jutten, and J. Herault, “Blind separation of sources, part I: an adaptive algorithm based on neuromimetic architecture,” Signal Processing, vol. 24, no. 1, pp. 1-10, 1991. [38] C. D. Meyer, Matrix Analysis and Applied Linear Algebra. Cambridge, UK, 2000. [39] EVObsession, (2015). Electric car charging 101 – types of charging, charging networks, apps and more!”. [40] R. Duda, P. E. Hatt, and D. G. Stork, Pattern Classification, Wiley, 2000. [41] Pecan Street Inc. Dataport (2015). http://www.pecanstreet.org [42] H. Kim, M. Marwah, M. F. Arlitt, G. Lyon, and J. Han, “Unsupervised disaggregation of low frequency power measurements,” in Proc. SIAM, pp. 747-758, 2011. Amr A. Munshi (S'08) received his B.Sc. degree in computer engineering from Umm Al-Qura University, Saudi Arabia, in 2008, and the M.Sc. degree in computer engineering from the University of Alberta, Edmonton. AB, Canada, in 2014, where he is currently working towards the Ph.D degree in computer engineering. He is a member of the Golden Key International Honor Society and currently serves as an Editor in the Alberta Academic Review journal. His research interests include machine learning, data mining and big data. Yasser Abdel-Rady I. Mohamed (M’06, SM’011) was born in Cairo, Egypt, on November 25, 1977. He received the B.Sc. (with honors) and M.Sc. degrees in electrical engineering from Ain Shams University, Cairo, in 2000 and 2004, respectively, and the Ph.D. degree in electrical engineering from the University of Waterloo, Waterloo, ON, Canada, in 2008. Since September 2009, he has been the Department of Electrical and Computer Engineering, University of Alberta, Edmonton, Canada, where now he holds the rank of Full Professor. His research interests include dynamics and controls of power converters; grid integration of distributed generation and renewable resources; microgrids; modeling, analysis and control of smart grids; and electric machines and motor drives. Dr. Mohamed is an Associate Editor of the IEEE Transactions on Industrial Electronics and IEEE Transactions on Power Electronics, and an Editor of the IEEE Transactions on Power Systems and IEEE Transactions on Smart Grid. Dr. Mohamed is a registered Professional Engineer in the Province of Alberta.","libVersion":"0.3.1","langs":""}