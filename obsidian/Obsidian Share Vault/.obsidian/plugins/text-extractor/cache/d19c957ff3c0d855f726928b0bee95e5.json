{"path":"lit/sources/Stainsby20pvEstGenNetMtrInstDate.pdf","text":"Contents lists available at ScienceDirect Applied Energy journal homepage: www.elsevier.com/locate/apenergy A method to estimate residential PV generation from net-metered load data and system install date Wendell Stainsby, Daniel Zimmerle⁎, Gerald P. Duggan Department of Systems Engineering, Colorado State University, United States HIGHLIGHTS • Time periods paired by weather provide solid before/after load change estimates. • Large AMI data (850 premises/4 yrs) drive PV estimates to ±20% of physical models. • Method identifies PV impacts that are difficult to model with physical models. • Generalizable to other load changes, such as tariff changes or efficiency programs. ARTICLE INFO Keywords: PV generation Advanced metering infrastructure Disaggregation Behind-the-meter ABSTRACT In the USA, residential photovoltaic (PV) systems are often configured for net metering “behind-the-meter”, where PV energy generation and building energy demand are reported as a combined net load to advanced metering infrastructure (AMI) meters, impeding estimates of PV generation. This work presents a methodology for modeling individual array and system-wide PV generation using only weather data, premise AMI data, and the approximate date of PV installation – information available to most distribution utilities. The study uses 36 months of data spanning nearly 850 homes with installed PV systems in Fort Collins, Colorado, USA. The algorithm estimates building energy consumption by comparing time periods before PV installation with similar periods after PV installation that have common weather and activity characteristics. Estimated building energy consumption is then compared with AMI meter data to estimate otherwise unobservable solar generation. To assess accuracy, modeled outputs are compared with directly metered PV generation and white-box physical models of PV production. Considering aggregate, utility-wide, generation estimates for the three year study period, the proposed method estimates over 75% of all days to within ± 20% of established physical models. The method estimates more effectively in summer months when PV generation peaks and is of most interest to utilities. The model often outperforms physical models for days with snow cover and for arrays with shading or complex multi-roof implementations. The model also supports day-ahead PV prediction using forecasted weather data. 1. Introduction By 2019, the U.S. had 70 GWDC of solar capacity [1] with around 20% of that being residential rooftop photovoltaic (PV) systems [2]. Between 2014 and 2018, the compound annual growth rate of small scale (under 1 MW) photovoltaic (PV) generation in the United States was 28.2% [3]. The 2 millionth solar array was installed in early 2019 [4] and within 5 years over 2.5% of all U.S. homes will have PV[5]. Additionally, the National Renewable Energy Laboratory has found that the technical solar potential of suitable residential buildings was over 700 GWDC , which could generate 926 TWh/year, a quarter of the United States’ total annual electricity consumption [6]. The growth of solar has increased interest in better estimates of real- time generation from PV systems for use by distribution utilities [7]. Larger commercial and utility-scale solar deployments are usually di- rectly metered, providing actual generation, typically at high time re- solution and with minimal latency. Thus, both system owners and electrical system operators know the actual energy produced by large solar arrays. These data can be used to forecast expected generation. However, residential solar systems in the USA are typically net- metered by the distribution operator, with 38 states having net-me- tering policies by 2019 [8]. In traditionally metered systems with PV, https://doi.org/10.1016/j.apenergy.2020.114895 Received 7 November 2019; Received in revised form 12 March 2020; Accepted 24 March 2020 ⁎ Corresponding author at: 430 N. College Avenue, Fort Collins, CO, United States. E-mail address: Dan.Zimmerle@colostate.edu (D. Zimmerle). Applied Energy 267 (2020) 114895 Available online 07 April 2020 0306-2619/ © 2020 Elsevier Ltd. All rights reserved. T system operators have access only to net load for the billing period, obscuring any information about the PV generation. When available, digital smart meter data generally reports only net-load or net-gen- eration (generation net of load) for each meter reading. Since generated PV offsets concurrent load in a net-metered building, it is difficult to separate behind-the-meter (BTM) generation from load. Therefore, distribution utilities are essentially blind to PV production at the vast majority of residential solar sites. This lack of insight into solar gen- eration complicates solar forecasting and the balancing of dispatchable generation with demand [9]. Directly estimating generation for residential arrays is also complex. Modeling requires numerous variables, including weather, physical orientation of the array, system size and electrical characteristics. In addition, ever-changing external factors such as seasonal tree shading, snow coverage, ground reflectance, and panel soiling also impact power output. If these data are available, there are well established physical models that utilize these inputs and current or forecasted weather to estimate solar generation [10]. These tools are often utilized for esti- mating the output of large solar arrays and have achieved accuracy to within ± 10% of the actual generation of the array [11,12]. However, as noted in [13], distribution utilities often do not have access to this specific data for each residential array, either because the data were not collected during the permitting process or because the as installed configuration of the system does not match the reported con- figuration. In addition, system or site modifications over time may also impact PV production. Shaker et al. [14] suggest using the output from a small number of known PV arrays to extrapolate power production across a greater number of PV systems within the same area. However, this type of modeling requires the utility to know the total capacity of residential systems within the area, and implicitly assumes that the small number of monitored arrays represent all variation in system configurations for the unmonitored arrays. Several authors have proposed machine learning methods to esti- mate PV production [15]. These methods rely on training a model using separately metered PV and load on residences [16], specific system/site data [17], or use PV production from nearby metered arrays as a sur- rogate for residential PV production [13]. The key challenges with these proposed methods include a) ac- quiring long time series of local generation data for training, b) un- derstanding if the solar resource used for training is representative of current and future PV installations, c) acquiring the skills to train the model - likely a challenge for most distribution utilities, and d) de- pending upon the method, having reasonably accurate records of the location, size and as-built physical characteristics of individual PV ar- rays. Many of the models described above were developed and tested using only small data sets, including a single 5-kW array [16], 8 houses over the span of 10 days [7], 15 days of training data from one PV system [18], or only superficially describe training methods and data sets [17]. Another method requires metered PV output from over 300 sites [19], an arduous data set to replicate. These approaches report an root mean squared errors of between 20% and 50%, and usually require access to data from representative systems where PV is metered in- dependently from load. Because these works use uncommonly available data sets and typically only train and/or model from a few PV systems over short periods of time, further work to improve net-metered PV modeling is appropriate. The difficulty of modeling a portfolio of residential assets using physical models stimulated interest in estimating PV output based on smart meter (AMI) data. This type of estimate is essentially an effort to disaggregate PV generation from the net-generation/net-load mea- surements reported by the smart meter. This work proposes an alter- native method that will estimate PV production using open-source py- thon software and three data sources that are commonly accessible by distribution utilities: a) historical and, if desired, forecasted, weather data, b) net-metered, sub-hourly, AMI data, and c) the approximate month of PV system installation. Contact the corresponding author for software examples. This method does not require training using known PV generation, nor does it attempt to estimate array-specific parameters [20] or a re- presentative system’s geometry, as attempted by other work [21]. We use this method to estimate individual system and aggregated genera- tion using 1–4 years of AMI data from nearly 850 net-metered re- sidential systems. By using the known basic configurations of these systems, the method’s performance is tested against a physical model to compare generation estimates. The paper is organized as follows: Section 2 discusses data sources, Sections 3 and 4 discuss the methodology and testing of the AMI model against known generation, and Section 5 provides an overview of the physical model used for model comparisons. Sections 6 and 7 present results, discussion and conclusions. Throughout this work, we designate the mean of any quantity using a bar (e.g. P ), and the median using a caret (e.g. P ). 2. Description of data sources For this analysis, we utilize data from Fort Collins, Colorado, USA, a high-elevation community in the central USA with highly variable weather conditions. Electricity service is provided by the City of Fort Collins Utilities (FCU), a city-owned municipal distribution company with a sole-provider contract with Platte River Power Authority. 2.1. AMI data from Fort Collins utilities Beginning in 2014, FCU installed AMI meters on existing premises, and the AMI system became operational at the beginning of 2015 [22]. FCU had approximately 76,000 premise meters in mid-2019. The AMI meters report on 15-min intervals, and all residential PV systems are net-metered. FCU provided all AMI data to Colorado State University (CSU) researchers - a total of approximately 11 billion meter readings. Four data fields are of interest for this research: premise ID number, which can be tied to geospatial and housing data, timestamp, delivered energy, and received energy. Delivered energy refers to en- ergy supplied to the building by the distribution grid during a 15-min interval. Received energy refers to self-generated energy (in this case from PV) exported by the building back to the distribution grid during a time interval. The power balance for a single premise is: =d l gi i i (1) where di is the power delivered to the premise at any instant i l, i is the premise load, and gi is the PV output power. During one meter reporting period, the meter samples d many times, and d may be both positive – energy delivered to the premise – or negative – generation received by the utility. The meter integrates these individual measurements over the meter’s reporting period and reports two quantities to the utility, delivered energy: = d dtmax , 0 ·t i t i (2) and received energy: = d dtmin , 0 ·t i t i (3) where the subscript t refers to one meter reporting period – 15 min in this study – and dt refers to the (unknown) internal sampling period of the meter. Energy quantities for load ( =P l dt·t i ) and generation () are similarly defined. Fig. 1 schematically illustrates the recorded AMI data. Solid boxes W. Stainsby, et al. Applied Energy 267 (2020) 114895 2 represent metered readings and dotted boxes represent unknown va- lues. 2.2. Weather data Weather data from a weather station located on the main campus of CSU [23] – a reasonably central location to FCU’s distribution system – was used for this study. The weather station provides 10-min mea- surements of temperature (°C), wind speed (m/s), and solar irradiance (watts/m2). Fort Collins snowfall data was obtained from the National Oceanic and Atmospheric Administration’s Climate Data online portal [24]. The database provided daily snowfall (inches) and accumulated snowfall (inches). 2.3. Solar assets in Fort Collins FCU provided records of each photovoltaic system installed in the city’s distribution network. This dataset provided the following in- formation: premise ID, installed capacity ( kWDC ), date of installation, inverter manufacturer, inverter model and quantity, array azimuth and tilt, and the electric service rate class of the premise. Between 1987 and April 2019, 1,389 PV systems were installed within the City, totaling a capacity of 13.1 MWDC . Approximately 93% of PV systems were installed on residential premises, with an average installed capacity of 5.5 kWDC . Residential premises accounted for 7.3 MWDC , or approximately 55% of total installed capacity. Around 285 older systems, mostly installed before 2015 are missing array tilt and/or azimuth values in the City’s records; these values were estimated using satellite and street-level imagery. 2.4. Confidentiality This analysis utilized the full data set including per-premise AMI readings. This type of data is available to most utilities but is seldom made publicly available. Interested researchers can contact the corre- sponding author for aggregated and/or anonymized data similar to that used here. 3. AMI model methodology 3.1. Framework The underlying assumption behind this model is that, given similar weather conditions, building load (i.e. li ) does not change due to PV system installation. Using this assumption, estimates of load from pre- PV periods can be used to estimate behind-the-meter PV generation for post-PV periods. We find this assumption works well for the study area. However, some caution should be used when applying to other systems. Some recent behavioral research has observed an increase in energy usage (termed the ‘solar rebound effect’) after PV is installed in a household [25]. These observations were made in a region with high cooling/low heating building energy needs (the opposite of Fort Collins), and also found that solar consumers in liberal areas (like Fort Collins) experience lower rebound. Using this assumption and referring to the notation in Fig. 1, the basic approximation from this model for PV generation, G, is = +G P for any time period. The values and are measured and recorded in the AMI data. The model’s algorithm matches similar timestamps from pre- and post-PV periods to estimate P, the total load for the building. While applied here to PV production, reconstructing this baseline building consumption from net-metered AMI data can be utilized to estimate demand changes for a wide range of changes in customer behavior, and represents the core contribution this work. Weather impacts both building energy demand and solar genera- tion. Buildings exhibit temperature-dependent demand driven by heating or cooling [26] – periods of similar temperature should have similar heating/cooling loads [27]. Solar irradiance is also correlated with temperature and is the input energy for PV. For these reasons, temperature and global horizontal irradiance (GHI) are considered in the pairing of timestamps for reconstructing building load. Using this guide, we pair every timestamp t, with a set of comparable timestamps, , i.e. each period t maps to a set of comparable timestamps, = { }t t . These sets are the same for all premises. As each premise, k, has a unique date of PV installation, time stamps are split into before- and after- PV installation sets. Denoting the in- stallation time as t ,k I, includes all time stamps before PV installation, i.e. where <t tk I, and includes all time stamps after installation, i.e. >t tk I, . We also avoid time stamps immediately before or after the in- stallation date, to allow for differences between the actual and the re- ported dates to activate the PV system. Using a buffer of b days before, and a days after (in this work = =b a 20 days), the definitions of and are defined for each premise, k, as = <t t t t b{ : ( )}k k I, (4) For each kk i, we identify the set of comparable timestamps after installation: = t{ : }k i t k i, ( ) , (5) Similarly the set of times after PV install: = > +t t t t a{ : ( )}k k I, (6) have a similar mapping, = t{ : }k i t k i, ( ) , (7) where the parenthetical superscripts indicate all time stamps in the in- dicated set for premise k. These form two 2D data structures, diction- aries where each time stamp in k and k holds a set of comparable timestamps, k i, . Weather information is used to create t for all timestamps, t, (Section 3.2 below) and then this set is divided into subsets to populate the dictionaries as described in Eqn. (4)–(7). Similarly, two AMI read- ings (recieved and delivered) are also attached to each time stamp in each set for each premise. Finally, the algorithm estimates building consumption by comparing AMI data for one time stamp with the set of AMI data identified by the before- or after- installation comparable timestamps. Once building consumption is estimated, PV generation can be estimated. Fig. 2 below depicts the block diagram of this methodology. Fig. 1. AMI Data Visualization. Box P represents the delivered energy to the premise before PV installation, which is the total building load when no gen- eration assets are present. Box represents energy delivered to the premise when some load is offset by unmeasured PV generation (dashed green boxes). Box represents excess generated energy received by the distribution grid from the premise when generation exceeds load. W. Stainsby, et al. Applied Energy 267 (2020) 114895 3 3.2. Paired timestamps After interpolating the 10-min weather data to 15-min granularity, each timestamp has measured, average, GHI, wind speed, and tem- perature for the 15-min interval. For computational efficiency, PV modeling is performed only for periods when the sun is at least one degree above the horizon, as determined by standard solar positioning algorithms [28]. Comparable timestamps must be within 15 days of the day-of-year of the target timestamp. This creates a 30-day range to identify com- parable timestamps, and emphasizes days that are similar in seasonal weather, with similar day length, shading, and solar patterns. From this 30-day subset, the following requirements are added: 1. Comparable timestamps must match the same portion of the week - weekday or weekend - as the target timestamp. 2. Major American holidays are removed since much of the population deviates from daily routines on these dates and likely make any premise’s energy usage non-comparable to other non-holiday time- stamps with similar weather/temporal conditions. Removed holi- days are: New Year’s, Memorial, Independence, and Labor Days; Thanksgiving, Black Friday, Christmas Eve & Day, and Boxing Day (day after Christmas). 3. Comparable timestamps must be within ± 4 h of the target time- stamp’s hour-of-day. 4. The standard deviation of the temperature ( temp ) and irradiance ( irr ) of this remaining set are calculated and timestamps within 30% of temp and 40% of irr are included in the set. This criteria removes weather outliers from the sets. The specific parameters described above were developed qualita- tively. Differences in load between weekend, weekday, and holiday periods are well documented in the literature, and utilized here as well. The remaining criteria were set qualitatively by comparing model accuracy to known PV generation sources mentioned discussed in Section 4. The 4-h window limits comparison to similar parts of the day. Tests indicated that ranges larger than ± 4 h increased error between the model and recorded data. While wider windows may select similar weather, solar irradiation angle and other model conditions change markedly over longer periods and negatively impact model perfor- mance. The time range and the 30% and 40% temperature and irra- diance standard deviations were selected qualitatively by iterating the model and observing its performance. Similar tuning could be com- pleted in other localities, if necessary. The period of analysis from 1/1/2015 to 3/31/2019 contains over 72,000 timestamps. Upon completion of the comparable timestamp algorithm, the median and mean number of similar timestamps for each target timestamp was 118 and 129, respectively, with a range of 0 to 460. 3.3. Calculating baseline energy load The baseline equation for estimated energy generation in kilowatt- hours (kWh) is: = +G Pk t k t k t k t, , , , (8) in reference to Fig. 1, where Gk t, and Pk t, are the unknown generation and building load, respectively, and k t, and k t, are the known deliv- ered energy and received energy, from premise k for each timestamp, t. Before PV is installed, there is no generation, thus = P( ) ( ) and = 0( ) . ( ) should always be zero before PV was installed because there is no generation at the premise; a non-zero value is an error, ty- pically an incorrectly recorded date of installation or a malfunctioning smart meter. After PV is installed, either or both k t, ( ) or k t, ( ) could be non-zero for a timestamp with non-zero load; both can be nonzero if the reporting period saw two-way power flow during the timestamp. The fundamental assumption behind the algorithm is that the load for any timestamp after PV is installed will be similar to the load for comparable timestamps before PV was installed – i.e. P Pk t k t, ( ) , ( ) for each timestamp in . In practice, the algorithm uses the mean ( Pk t, ) or median ( Pk t, ) of Pk t, ( ) as a central estimate of the load for any given timestamp. Additionally, if an individual timestamp in k was tethered to a ( )k t, set of fewer than three timestamps, the central estimate of the prior timestamp is used. Application of Eq. 8 must account for several special conditions. Typically, overall premise demand drops after a premise has installed PV. However, for short durations (such as 15-min timestamp periods) consumption may increase, leading to a negative first term in Eq. (8), and potentially an artificially low or even negative estimate for PV generation. To understand this irregularity, an analysis identified the timestamps where delivered energy ( k t, ) exceeded estimated building load ( Pk t, ). Of calculations from 846 residential premises spanning 1–3.25 years, this irregular condition occurs, on average, in 8.3% of timestamps. To control for these irregularities, the following corrective actions were taken, in order, stopping when the irregularity was handled, i.e. when an equation was satisfied. Starting from an assumption of esti- mated energy output of 0 kWh, and dropping the subscripts for con- venience, generation is estimated to be: = + > + > + > > G P P P P P P P P : : : : 0 ( ) ( ) (9) Because mean values are influenced by outliers to a greater degree than the median value, the median and mean will usually differ within P . Because of outlier influence, P is the preferred measure of building load, with P used in cases in which P is less than (in Eq. (9)). When both P and P are less than (thus not satisfying the first two re- quirements in the equation set above), P ( ) (the median delivered en- ergy from the after-install readings) is used. Finally, a last resort cal- culation is to solely use the received ( ) value at the timestamp as estimated generation. 4. Comparison to actual generation Recorded generation from four net-metered PV systems was used to Fig. 2. Block diagram of AMI model. W. Stainsby, et al. Applied Energy 267 (2020) 114895 4 validate the accuracy and robustness of the AMI model. Table 1 details these net-metered systems. These premises are a diverse and representative mix of net-metered solar assets, spanning a range of installed capacity and building types, with different usages and load profiles. Residential buildings typically have two daily peaks; a small morning peak and a more substantial peak in late afternoon and early evening. They also exhibit different energy needs during the work week and on weekends. The Timberline Recycling Facility is a city-owned building that is open 360 days a year and is served by a general service net-metered electricity connection. The load profile at this premise is likely be characterized by consistent energy usage during business hours every day of the week, with major fluctuations driven by HVAC needs. In contrast, the energy needs of the Church are likely low during the week and vary on weekends de- pending on the different services and one-off events that the site hosts. We use absolute percentage error, , to compare modeled to actual output. Error on each timestamp is: = G A A s s s s (10) where Gs is the AMI model’s generation, and As is the actual recorded generation, for each time period s. We compute k as the mean of s and k as the median of s over the set of s k , or for daily and hourly subtotals taken from k . Time-series of modeled and actual generation from three of the four premises are shown in Figs. 3 (House G), 4 (House Z) and 5 (Timber- line). Comparison is hourly for Timberline and House Z, and daily for House G and the Church, which were only reported daily. The re- sidential test cases were characterized by daily between −4% to −26%, meaning that the AMI model underestimates generation re- lative to actual recordings. Hourly generation was not available for House G, but for House Z the hourly was −26.5%. Estimations agreed better over periods longer than daily intervals. Over the course of one year at House G, the total actual generation was 6,570 kWh while the AMI model estimated 6,492 kWh, a difference of −1.2%. For the two months analyzed for House Z, the actual genera- tion (885 kWh) was higher than the AMI model estimate (673 kWh), a difference of −23.8%. However, it is known that the occupant of House Z, an energy engineer affiliated with this research, was also aggressively shifting and minimizing loads for time-of-day pricing (TOD) periods that started coincident with the PV install at this premise. Therefore, the two impacts are difficult to separate. This represents a limitation to the model, but also indicates that the model can be used for purposes other than PV output estimation, such as estimating the impact of TOD pricing on customer behavior. Finally, weather during winter months has higher variability and present more challenges to the model when estimating short time periods for an individual premise (installed Feb. 2019). The model performed best at Timberline at both hourly and daily resolution, as shown in Fig. 5. This suggests that consumption patterns are very consistent at this municipally-operated commercial site and did not diverge after PV system commissioning. Over the course of the eight months analyzed, actual generation was 16,607 kWh, while the AMI model estimated 16,735 kWh, a difference of +0.8%. 5. Physical model used for validation FCU does not have access to actual generation data for the nearly 1,300 residential PV systems in Fort Collins, but does have basic array characteristics recorded when the systems were installed. This type of data may be unavailable to many distribution utilities, due to record keeping processes or other policies. A key strength of the proposed model is that it can estimate PV production without this data. However, for the purposes of this study, access to physical model data allows a bulk comparison of the proposed model to physical models to build confidence in the approach. The physical model is based upon PV performance models devel- oped by Sandia National Laboratory [12] and the PV Performance Modeling Collaborative (PVPMC) [29], as well as NOAA [30], and NREL open-source online resources [31]. The model, “PV-STEM” [28], is specifically designed to utilize inputs that are readily available to utilities: Array nameplate capacity, tilt and azimuth of the array, and, possibly, inverter make and model to lookup inverter efficiency. While more complex models utilize several components of solar radiation (typically direct normal and diffuse horizontal irradiance), PV-STEP uses only GHI, which is readily accessible from many weather stations. To assess its accuracy, PV-STEM was tested using the recorded data described previously, and several longer recordings on systems that were not connected to AMI [28]. Using as a reference a commercial array with three years of data – a similar duration to the AMI data set used here – results indicate the model is accurate to with ± 6% for average annual production, to within [+6%/−15%] for daily ag- gregations, and to within ± 35% for hourly aggregations. While the physical model is based upon recorded system char- acteristics, it is subjected to similar errors as other physical models, including inaccurate system characteristics, differences between as de- signed and as installed systems, and post-installation changes, such as shading changes, soiling, or aging effects. Table 1 Actual generation data sources. Site Name Capacity ( kWDC ) Premise Type Granularity Duration House G 5.04 Residential Daily 13 months House Z 6.00 Residential Hourly 2 months Timberline 20.59 Non-residential Hourly 8 months Church 53.5 Non-residential Daily 12 months Fig. 3. House G Daily Generation – 3 months of estimated daily generation aligned with recorded generation. Daily = −3.9%, i.e. the AMI model underestimated daily generation by around 4%. W. Stainsby, et al. Applied Energy 267 (2020) 114895 5 6. Results Since both the AMI and PV-STEM models are production estimates there is no baseline on which to calculate relative error. Therefore comparison is based upon the difference in the estimates normalized by the mean magnitude of the estimates: = + r G M G M 2s s s s s (11) where s is an element of G,k s is the AMI model’s generation estimate, and Ms is the PV-STEM model’s generation estimate, during s. Differences aggregated over a specified duration (such as hourly, daily, monthly) are presented as the mean ( rk ) and median ( rk ) for premise k. A positive rs equates to the AMI estimate being greater than the PV- STEM estimate. All premises were modeled through March 31, 2019. Fig. 6 provides an example of PV-STEM and AMI models plotted to- gether, and is a representative example of the generally close agreement seen for most systems; G M( )s s is the difference between the two lines in the figure at each point. 6.1. Monthly aggregation For individual premises, a useful modeling duration for analysis is “monthly generation”. Most utility customers in the U.S. receive a monthly bill with a total kWh of consumed energy during approxi- mately the previous 30 days, and the Energy Information Administration reports monthly electricity usage statistics [32]. This kWh total is converted to a dollar amount through a single or multi- tiered billing structure. A residential customer may want to compare their actual monthly generation with predicted monthly generation to understand system performance and expectations for the payback period of the array. The AMI model joins with other physical models as a tool to draw conclusions about expected monthly performance. For insight into the monthly agreement, the monthly average error, rk , was calculated from the all available individual monthly errors for each premise, and a 90% empirical confidence interval (CI) was Fig. 4. One Week of Hourly Generation Comparison for House Z – hourly modeled and recorded hourly PV generation. The model underestimates during both sunny and cloudy (days 2,8,9) periods = −26.5% at hourly, and = −25.8% at daily, granularity. Fig. 5. Timberline Hourly Generation – An hourly = 1.7%, a daily = 0.4%. Fig. 6. Example of agreement between PV-STEM and AMI models. 11 days of hourly data for residential premise with a 3.9-kW array installed in February 2017. W. Stainsby, et al. Applied Energy 267 (2020) 114895 6 calculated for the distribution of monthly errors. Fig. 7 shows results for all 861 premises – 536 premises had negative monthly r while 325 premise each had positive monthly r , indicating a slight tendency for the PV-STEM model to estimate more generation than the AMI model. The figure indicates broad agreement across the majority of pre- mises, while a smaller number of premises, intentionally placed at each end of the curve, indicate large relative disagreements for a minority of premises. These larger disagreements may be attributed to several factors. First, the PV-STEM model mis-estimates output on numerous systems because system information, such as recorded array char- acteristics (size, tilt, and azimuth) are incorrect. Further, changes to the system such as array modifications or upgrades may not have been recorded in the FCU’s records. Using satellite photography and some street level observations, the study team confirmed that numerous systems with large disagreements had an installed panel configuration that did not match the data recorded in FCU records. Second, PV-STEM and other physical models only partially account for snow coverage reductions. While physical models readily model the reduced insolation occurring during snowfall, these models have diffi- culty modeling the reduction in PV output after snow events when solar insolation is high but the panels are covered by accumulated snow. These modeling reductions are complex and irregular across events. While a general reduction has been built into the PV-STEM model (and most other physical models) these reductions have only limited sensi- tivity to different snow and array conditions. Finally, physical models typically have little-to-no knowledge of array shading from buildings or trees, which may also change over time. Accounting for variable shading at hundreds of premises is not feasible for most utilities. Both the snow- and shading-reductions cause PV-STEM to overestimate production, while errors in physical para- meters may cause over- or under-estimation of production. In contrast, the AMI model uses comparisons of building con- sumption, which intrinsically captures reduced generation from struc- tural factors – incorrect physical parameters or shading – and provides some insight into the snow reductions. Using these differences, a utility that has physical parameters for all installed systems could identify and update flawed data by comparing physical and AMI estimates. 6.2. System-wide residential aggregation Distribution operators are primarily interested in the aggregate PV production from residential systems. This section discusses the relative agreement of the two models aggregated across all premises at daily and hourly granularity. Data is presented monthly and color-coded to highlight seasonal variation. Data from January, February, and March 2016 are not shown because these months had fewer than 30 premises, the threshold set to produce credible statistics on a monthly basis. In comparison, months in 2018 include over 500 premises. Fig. 8 summarizes daily and hourly system-wide aggregations. While this analysis is retroactive – looking at historical values – the analysis provides insights into how the proposed method could be coupled with weather forecasts for planning utility operations. In that context, daily values are primarily of interest for day-ahead planning and hourly analysis provides insights for intra-day operations. Daily Aggregation: In every month of analysis, the two models agreed to within ± 20% for at least 50% of days in the month, and in 10 months, at least 50% of days agreed to within ± 10%. Further, in 21 of 36 months the 90% CI – a measure of the variation between daily estimates – lies within ± 20% relative difference. Critically, 9 of the 10 highest producing months were within this group, the months likely of most interest to a distribution utility. Overall, the agreement between the proposed model and accepted physical models builds confidence in the proposed approach to PV estimation. Even at good precision, on most days PV-STEM estimates higher generation than AMI – 25 months contained at least 75% of days when PV-STEM estimated greater generation than the AMI model. Among these 25 months were the 12 most-productive solar months. The red line of total relative error represents the system-wide sum of all AMI estimated generation relative to the sum of all PV-STEM estimated generation. The total relative error is (−7.6%), meaning that total generation across applicable premises was skewed toward the PV-STEM model estimating more generation than the AMI model. Winter months show less agreement between the two models than other seasons – 8 of 12 winter months have a CI that exceeds ± 20% and, in the 14 the months where the CI exceeded ± 20%, eight were winter months, four were in the fall or spring, and two were summer months. Winter months also include the periods with the lowest PV production – 8 of the 12 lowest producing months are winter months. Possible rea- sons for model disagreement and PV-STEM overestimation are explored in the next subsection. Hourly Aggregation: The smaller period for hourly aggregations produces greater disagreement between models (as is typical for sta- tistical estimates at higher temporal resolution). Hourly aggregations (lower panel, Fig. 8 display larger disagreements in the median and wider CIs than daily aggregations (top panel, Fig. 8). However, the median disagreement and wider CIs indicate different disagreements: Quartiles are skewed positive, indicating that the AMI model’s hourly estimates are higher than the PV-STEM model’s hourly estimates when differences are largest. In contrast, all months have a negative hourly medians, meaning that the central estimate of each month tends in- dicates PV-STEM overestimating relative to the AMI model. This di- chotomy is due to higher absolute errors when the AMI model is overestimating relative to PV-STEM (positive values) coupled with a higher frequency of smaller overestimates by PV-STEM relative to the AMI model (negative values). Months such as March 2017 and Sep- tember 2016 have clear visual representations of this occurrence. Explanations for this type of disagreements could include: (a) the physical model consistently overestimates on some fraction of the premises, due to shading, incorrect system parameters or similar issues which “feed” the physical model incorrect assumptions; (b) episodic reductions in PV production, such snow on PV panels, that are captured by the AMI model, but not by the physical model; (c) small but Fig. 7. Average Monthly Error Between Models. The x-axis is ordered by ascending average monthly error. Positive error represents the AMI model esti- mating more generation than the PV-STEM model. The green shaded area is the 90% empirical con- fidence interval of monthly error for each premises. 846 residential premises are evaluated. W. Stainsby, et al. Applied Energy 267 (2020) 114895 7 persistent changes in customer load behavior are not well represented by the fundamental assumptions in the AMI model. 6.3. Snow losses The inherent nature of the AMI model positions it to be well-suited at predicting generation reduction due to snow coverage. Unlike phy- sical PV models, the AMI data describes what is happening within the building’s load, and is not restricted to the behavior of the PV system. Net-load/generation is inclusive of panel snow coverage and other losses, by-passing the various physical model external variables that must be factored in (often with high difficulty). Because the AMI model utilizes similarities in building energy load before and after PV installation, a lack of generation from snow is captured within the AMI data. Referring to Eq. (8), if snow is covering the array and no generation is offsetting building consumption, the delivered energy ( ) should then be similar to the delivered energy from the comparable periods before the premise had PV (P). The difference in these terms would be small; adding the near-zero grid-received ( ) energy would result in a low, and reasonably accurate, estimate for PV generation. Fig. 9 below displays model performance in the days during and following a heavy snow event. The AMI model does not use precipitation in the timestamp matching process. When rain or snow occurs the irradiance will sig- nificantly decrease, thus matching periods of precipitation with other high-cloudiness/precipitation periods. The AMI model is responsive to the effects of snow coverage during and after the snowfall event. While by no means perfect, the AMI model’s structure produces generation estimates that are not “fooled” by high irradiance periods while an array lies under snow. Thus the proposed model provides a competent alternative to prior snowfall modeling approaches discussed in [33–35]. 6.4. Limitations By design, the proposed model relies on only AMI and weather data - two data streams that are readily accessible to any utility. However, the total reliance on AMI data requires that a premise be excluded from analysis if it lacks 12 months of pre-installation data. Therefore, older systems installed before or during the first year of AMI data collection (2015), or systems on newly constructed buildings cannot be analyzed without extensions to the proposed method. Possibilities include using post-installation data to develop a proxy for pre-installation data or using AMI data from similar premises. These methods were not in- vestigated for this study and could potentially required substantial additional software or human control. Uncertainty is also derived from sources external to the model. The model operates under the assumption that energy consumption habits do not significantly change once PV is installed. While this work identified no significant behavioral changes, some social science re- search suggests that this assumption may fail in some cases. Changes in the premise itself (e.g. efficiency upgrades or changes in appliances) or use of the premise (e.g. different owners or different activities onsite) also impact the load patterns of the premise. Further, the utility is unlikely to know about these events. For these changes, model accuracy is assisted by three factors. First, PV system output ( 5 kW on average) is large, relative to other, common, daytime per- formance changes. For example, EV charging is of similar size (1–6 kW typical), but is more likely to occur during lower nighttime electricity rates, when vehicles are at home. Many other efficiency changes are Fig. 8. Comparison of the physical and AMI models. The top plot shows daily re- lative errors between the two models and the bottom plot contains hourly relative er- rors; both are grouped by calendar month. The y-axis shows the relative error (r in %). Positive errors indicate a higher estimate from the proposed AMI model relative to the physical (PV-STEM) model. The boxes show the 25th, median, and 75th quartile of each month’s set of relative errors. The bold numbers between are the number of pre- mises available for analysis during that month. The right y-axis shows the estimate of energy production, normalized by in- stalled capacity during the month. The boxes are ordered left to right from least to highest normalized monthly production. The red horizontal line represents the total relative error between the models for all data included in the chart. Fig. 9. AMI model performance at House Z during snow event. On March 2, 2019, Fort Collins received over 7 inches of snow. W. Stainsby, et al. Applied Energy 267 (2020) 114895 8 typically small ( < 1 kW) relative to PV system output, split between daytime and nighttime load, and often preferentially occur during the evening peak load. Second, aggregated across a distribution system, changes in premise ownership produce relatively unbiased aggregate impacts on load (as is demonstrated by the performance results pre- sented earlier, which do not control for premise ownership.) For ex- ample, new owners may increase or decrease load, and aggregated across the distribution system, these changes are likely to cancel out. Finally, with the exception of large changes, such as the purchase of an EV, efficiency upgrades tend to happen incrementally over time, as appliances are added or replaced in a household. This continuous, in- cremental change, is swamped by the sudden, daytime-only, introduc- tion of PV production to a household. However, it is possible that widespread changes, such as a widely-adopted efficiency upgrade oc- curring in a short period of time, could produce biased changes which would impact the accuracy of the proposed model’s results. Finally, changes in the utility operation itself may have the largest – and intended – impact on load patterns. In October 2018, FCU im- plemented time-of-use electricity rates in Fort Collins, which included a greater than 3:1 differential between on- and off-peak electricity pri- cing. For systems installed near the time of the TOD implementation, the rate structure change significantly impacts the fundamental as- sumption in the AMI model – i.e. that consumption does not change after PV is installed. While too little data exists at the time of this study, early evidence suggests that daily aggregation of estimated generation from AMI data is more resilient to the effects of inter-hour pricing than hourly modeling. Understanding the behavioral impact of this price change provides numerous other areas of future work with the City of Fort Collins. 7. Discussion and conclusion The use of AMI data provides another method for estimating PV production in distribution systems. This method requires minimal data about the PV systems in question (approximate installation date) and readily accessible AMI and weather data. As a result, it represents a robust estimate of PV production that is independent of physical models driven by either specific system information or estimated system-wide system information. Comparing estimates provides a method of iden- tifying problems and raising the confidence of all estimates. High-confidence estimates of renewable generation are needed in the delicate and dynamic balancing of load with intermittent and dis- patchable generation by grid operators. Estimating PV generation from thousands of small, behind-the-meter systems, is an important and non- trivial task using existing physical models or algorithms that require actual generation data. Thus, as rooftop solar deployment increases, the ability to disaggregate invisible generation and total load from net- metered AMI data will be necessary for better management of the dis- tribution of electricity. The “matching timestamp” methodology proposed here allows comparisons of between sets of load data by correcting for weather- driven and time-driven loads, which often account for a large portion of load variation within one premise. As a result, this method can be used to analyze any intervention expected to have an impact on load beha- vior, such as rate changes or efficiency incentive programs. The caveat to these applications is that the load changes must be large enough, and/or the sample size (number of premises) large enough, to make load profile changes statistically significant. Regarding sample size, modern AMI systems provide large quantities of data – an ongoing analysis of FCU’s time-of-day rates has access to over 18,000 residential premises, even after eliminating those with occupancy changes, pre- mises with PV, premises with electric heat, and premises that have participated in efficiency or demand response programs. Utilizing AMI data for these purposes extracts additional, largely hidden, value from these crucial systems. CRediT authorship contribution statement Wendell Stainsby: Software, Formal analysis, Writing - original draft, Investigation. Daniel Zimmerle: Funding acquisition, Investigation, Supervision, Writing - review & editing. Gerald P. Duggan: Software, Supervision, Resources. Declaration of Competing Interest The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influ- ence the work reported in this paper. Acknowledgment We thank the City of Fort Collins Utilities for the large amount of time and data that they provided to our team. John Bleem was in- strumental in the development of the PV-STEM model. This work is supported by the National Science Foundation Sustainability Research Networks award number 1444745 “Integrated Urban Infrastructure Solutions for Environmentally Sustainable, Healthy, and Livable Cities”. References [1] Mayes F. More than half of small-scale PV generation comes from residential rooftops. U.S. Energy Information Administration; 2016. [2] Wood Mackenzie Power & Renewables. U.S. Solar market insight, executive sum- mary: 2018 year in review; March 2019. [3] U.S. Energy Information Administration. Electric power monthly with data for february 2019; April 2019. [4] Solar Energy Industries Association. United States surpasses 2 million solar in- stallations; May 9, 2019. https://www.seia.org/news/united-states-surpasses-2- million-solar-installations. [5] Roselund C. Room for residential solar to reach 41 GW by 2025. [6] Gagnon P, Margolis R, Melius J, Phillips C, Elmore R. Rooftop solar photovoltaic technical potential in the United States. A detailed assessment. National Renewable Energy Laboratory; 2016. [7] Tabone M, Kiliccote S, Kara EC. Disaggregating solar generation behind individual meters in real time. In: Proceedings of the 5th conference on systems for built en- vironments, BuildSys ’18. New York, NY, USA: ACM; 2018, p. 43–52. [8] Cleveland M, Andersen G. State net metering policies. http://www.ncsl.org/ research/energy/net-metering-policy-overview-and-state-legislative-updates.aspx. [9] Tarroja B, Mueller F, Eichman JD, Samuelsen S. Metrics for evaluating the impacts of intermittent renewable generation on utility load-balancing. Energy 2012;42(1):546–62. [10] Dobos AP. PVWatts version 5 manual, report. National Renewable Energy Laboratory; 2014. [11] Menicucci D. PVFORM: A new approach to photovoltaic system performance modeling. In: Presented at the 18th IEEE photovoltaic specialists conference, Las Vegas, Nevada; 21 Oct. 1985. [12] King DL, Boyson WE, Kratochvill JA. Photovoltaic array performance model; December 2004. [13] Iyengar S, Sharma N, Irwin D, Shenoy P, Ramamritham K. A cloud-based black-box solar predictor for smart homes. ACM Trans Cyber-Phys Syst 2017;1(4):21:1–21:24. [14] Shaker H, Zareipour H, Wood D. Estimating power generation of invisible solar sites using publicly available data. IEEE Trans Smart Grid 2016;7(5):2456–65. [15] Chen D, Irwin D. Black-box solar performance modeling: comparing physical, ma- chine learning, and hybrid approaches. SIGMETRICS Perform Eval Rev 2017;45(2):79–84. [16] Yang H, Huang C, Huang Y, Pai Y. A weather-based hybrid method for 1-day ahead hourly forecasting of PV power output. IEEE Trans Sustainable Energy 2014;5(3):917–26. [17] Mohan R, Cheng T, Gupta A, Garud V. Solar energy disaggregation using whole- house consumption signals; 2014. [18] Chow S, Lee E, Li D. Short-term prediction of photovoltaic energy generation by intelligent approach. Energy Build 2012;55:660–7. [19] DeBenedictis A, Hoff T, Price S, Woo C. Statistically adjusted engineering (SAE) modeling of metered roof-top photovoltaic (PV) output: california evidence. Energy 2010;35(10):4178–83. [20] Chen D, Irwin D. SunDance: black-box behind-the-meter solar disaggregation. Proceedings of the Eighth International Conference on Future Energy Systems, e- Energy ’17. 2017. p. 45–55. [21] Wang Y, Zhang N, Chen Q, Kirschen DS, Li P, Xia Q. Data-driven probabilistic net load forecasting with high penetration of behind-the-meter pv. IEEE Trans Power Syst 2018;33(3):3255–64. [22] U.S. Department of Energy. Recovery act selection for smart grid investment grant awards; May 22, 2019. https://www.energy.gov/sites/prod/files/edg/media/ SGIGSelections_Category.pdf. W. Stainsby, et al. Applied Energy 267 (2020) 114895 9 [23] Colorado State University. Fort Collins weather station; May 22, 2019. https://ccc. atmos.colostate.edu/autowx/. [24] NOAA National Centers for Environmental Information. Climate data online; June 3, 2019. https://www.ncdc.noaa.gov/cdo-web/. [25] Qiu Y, Kahn ME, Xing B. Quantifying the rebound effects of residential solar panel adoption. J. Environ. Econ. Manage. 2019;96:310–41. [26] Haas R, Auer H, Biermayr P. The impact of consumer behavior on residential energy demand for space heating. Energy Build 1998;27(2):195–205. [27] Yuan S, Stainsby W, Li M, Xu K, Waite M, Zimmerle D, et al. Future energy scenarios with distributed technology options for residential city blocks in three climate re- gions of the United States. Appl Energy 2019;237:60–9. [28] Bleem JR, Duggan GP, Stainsby W, Zimmerle D. PV Modeling as a community re- source. In: Proceedings – American solar energy conference; August 2019. [29] Stein JS, Holmgren WF, Forbess J, Hansen CW. Pvlib: Open source photovoltaic performance modeling functions for matlab and python. In: 2016 IEEE 43rd Photovoltaic Specialists Conference (PVSC); 2016, p. 3425–30. [30] NOAA Global Monitoring Division. General solar position calculations; 2019. [31] Reda I, Andreas A. Solar position algorithm for solar radiation applications. Sol Energy 2004;76(5):577–89. [32] U.S. Energy Information Administration. Electric sales, revenue, and average price; October 12, 2018. [33] Marion B, Schaefer R, Caine H, Sanchez G. Measured and modeled photovoltaic system energy losses from snow for Colorado and Wisconsin locations. Sol Energy 2013;97:112–21. [34] Brench BL. Snow-covering effects on the power output of solar photovoltaic arrays, report. U.S. Department of Energy; December 1979. [35] Freeman JM, Ryberg DS. Integration, validation, and application of a PV snow coverage model in SAM, report. National Renewable Energy Laboratory; August 2017. W. Stainsby, et al. Applied Energy 267 (2020) 114895 10","libVersion":"0.3.1","langs":""}