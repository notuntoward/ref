{"path":"lit/sources/papers_added.SAVE/papers/Zhang17DataMiningSmart.pdf","text":"Sustainable Energy, Grids and Networks 10 (2017) 92–103 Contents lists available at ScienceDirect Sustainable Energy, Grids and Networks journal homepage: www.elsevier.com/locate/segan Data mining of smart meters for load category based disaggregation of residential power consumption✩ Guanchen Zhang a,∗, G. Gary Wang a, Hassan Farhangi b, Ali Palizban b a Simon Fraser University (SFU), Surrey, BC, Canada b British Columbia Institute of Technology (BCIT), Burnaby, BC, Canada h i g h l i g h t s • A disaggregation algorithm is proposed to identify load categories by power factors. • A top-down unsupervised structure is proposed to learn and model load signatures. • Hourly active and reactive power consumptions are disaggregated into categories. • The proposed solution applies to general households on single-house and block levels. • The algorithm could achieve over 80% accuracy for major load categories. a r t i c l e i n f o Article history: Received 19 September 2016 Received in revised form 18 March 2017 Accepted 22 March 2017 Available online 3 April 2017 Keywords: Load disaggregation Smart meter Data mining Planning Microgrid a b s t r a c t Non-Intrusive Load Monitoring (NILM) techniques have been leveraged by new instrument and machine learning algorithms to provide customers the breakdown of their energy usage. The state-of-art indicates a large amount of high-frequency measurement (>1 Hz) can lead to accurate disaggregation. This paper, however, proposes a disaggregation algorithm relies on hourly smart meter readings, aiming to extend the application of the low-frequency data that is accessible by both utilities and customers. The output of the disaggregation includes the breakdown of energy into load-category-based components that have different average power factors. The disaggregated data will support small-scale planning, e.g., in microgrid, by revealing the variance and patterns in different load categories. Our approach is built on a top-down structure that requires no prior knowledge or general models of individual loads. Using clustering and optimization techniques, we infer the load signatures of each category based on the active and reactive power from smart meters. The signatures are updated periodically using the most recent smart meter data. The results show that our disaggregation approach could be applied to random houses in different seasons and to single house and small neighborhood in both offline and quasi-real-time context. © 2017 Elsevier Ltd. All rights reserved. 1. Introduction The Non-Intrusive Load Monitoring (NILM) of residential electric loads provides new opportunities for energy efficiency ✩ This work is supported in part by the Natural Sciences and Engineering Research Council of Canada (NSERC) (grant nos. NETGP 397814-10 and G-RGPIN04291) under Project 3.4 - Integrated Data Management and Portals of the NSERC Smart Microgrid Network (NSMG-Net) program. ∗ Corresponding author. E-mail addresses: gza10@sfu.ca (G. Zhang), gary_wang@sfu.ca (G.G. Wang), hassan_farhangi@bcit.ca (H. Farhangi), ali_palizban@bcit.ca (A. Palizban). URL: http://ca.linkedin.com/in/gza10 (G. Zhang). and Demand Response (DR) that benefit both utilities and cus- tomers [1,2]. NILM (also referred as NALM or NIALM) is an ap- proach for inferring the consumption of individual end-uses based on a single-point measurement of the total consumption of a house [3]. Recently, NILM has been leveraged by advanced elec- trical measurement that enable adaptive load disaggregation in granular levels [4], and by machine learning techniques. The ad- vanced measurement typically include high-frequency transient signatures such as current waveform, harmonics, instantaneous admittance waveform, instantaneous power waveform [5], and V–I trajectory [6,7]. Machine learning based approaches, including su- pervised and unsupervised learning, rely on load models trained by high-resolution measurement [8,9]. Although machine learning models such as Hidden Markov Models (HMMs) have been proved http://dx.doi.org/10.1016/j.segan.2017.03.006 2352-4677/© 2017 Elsevier Ltd. All rights reserved. G. Zhang et al. / Sustainable Energy, Grids and Networks 10 (2017) 92–103 93 effective [10–12], they typically require a large amount of train- ing data measured at less than 15-min frequency, and the accu- racy may decay as the number of appliances increases [11]. Also, as pointed in [13], the HMM approach is not compatible with DR pro- grams due to its dependency on uncontrolled load patterns. Never- theless, most existing disaggregation approaches attempt to solve the disaggregation problem at the individual load level which ap- peals to either high-frequency measurement or machine-learning models trained by large amount of data. Extra devices other than smart meters or upgrades of infrastructure are most likely needed to meet the signature requirement [8,14]. As a result, most dis- aggregation approaches are mainly customer oriented, whereas fewer studies have been focusing on the utility side. Moreover, the privacy of customers is also a major concern in term of information sharing among utilities, customers, and third-party disaggregation vendors [15]. This paper studies the disaggregation problem from the utility’s perspective, where the target loads in a household are not known in advance, and smart meters are the only available sensors. The disaggregation algorithm for utilities needs to be adaptive to general households, to work with low-frequency measurement, and not to violate customer privacy. Although smart meters are capable of high-frequency measurement (<15-min), useful information could still be retrieved at low frequency with existing Advanced Metering Infrastructure (AMI). In fact, utilities such as BC Hydro only collect hourly electricity usage data [16]. This is due to government regulation that protects customer privacy. The disaggregation granularity in this paper is enlarged to load categories that group end-uses with comparable power factors (PFs). The purposes of PF categories are to: • identify load categories that are recognizable across general households in an unsupervised context with available data (active and reactive power), • disaggregate to a low-frequency compatible aggregation level, instead of to individual load level, to satisfy the low-frequency constraint faced by certain utilities, • avoid inferring appliance-level information which may expose customers’ privacy, • analyze the variance and patterns in different load categories featured by power factors. The proposed algorithm first infers the signatures of potential load categories based on hourly aggregate active (P) and reactive power (Q) measured by real-world smart meters. The algorithm then separates each load category in each hour through the weighted least squares (WLS) method constrained by the inferred signatures. The outcome includes the separation of meter readings into sub-readings of high, medium, and low power factor load categories. Utilities could use the results in: • analyzing load variance in different categories on various aggregation levels (single house or neighborhood), • scrutinizing loads that affect the power quality, • infer emerging loads that are critical to infrastructure planning, e.g. electric vehicle (EV) charging, • planning for power supply, power factor (PF) correction, residential DR, and Volt-VAR control. These benefits are particularly useful in small scales such as microgrid, in which traditional planning methods may under- perform with less averaged data and more abrupt variance seen in small scales. The remainder of the paper is organized as follows. Section 2 briefly reviews related works. Section 3 provides the theoretical analysis of the overall algorithm. Section 4 analyzes the disaggre- gation results. Section 5 summarizes the paper. 2. Related works Conventional bottom-up disaggregation techniques require known or generalized load signatures as the bases. For exam- ple, pattern recognition requires individual load profiles in an op- erational cycle. Machine learning approaches may need typical transitional probabilities and consumption of each load to build general load models [17]. For approaches that learn load signatures from aggregate measurement, the required frequency is much higher than one hour [9]. The disaggregation for utilities requires a generic algorithm that provides the right granularity of informa- tion with less supervised training. Most previous works related to low-frequency disaggregation for utilities appeal to general prior knowledge of load components or temperature and time correla- tion. Xu et al. propose a disaggregation algorithm for substation- level measurement [18]. Loads perceived at the substation are categorized as component-based models with unique voltage- dependent exponential powers. From Monte Carlo simulation, the weight of each load model contributing to the total load with respect to active and reactive power and voltage is derived from an Artificial Neural Network (ANN). Our work is similar to [18] in term of disaggregating broad categories of loads. However, the estimation of component-based models in [18] may not be generalized across different locations in the grid or at different aggregation levels, similar to other bottom-up approaches. Birt et al. disaggregate hourly smart meter data into base, activity, heating and cooling loads [19]. The authors focus on the piece-wise linear relation between power consumption and temperature, and model the heating and cooling gradients of different temperature frames based on the average measurement. The base load is identified during the night when other loads are not active, and the activity load is the remaining portion that sums up to the aggregate measurement. The disaggregation algorithm is used for improving demand side management (DSM). The heating and cooling gradient models provide good estimation of the temperature-dependent loads. The overall approach, however, may not apply to moderate weather condition or households without heating/cooling equipment. Wytock and Kolter suggest a contextually supervised disag- gregation scheme in which loads are categorized as temperature dependent loads such as A/C and heating, base load, and appli- ances [20]. The contextually dependent loads are modeled as ra- dial basis functions (RBFs) of temperature with delayed response. The base load is modeled as a function of the hour of day, and ap- pliances are treated as the remaining composition of the aggregate measurement. The benefit of their approach is that the dynamic portion of aggregate load can be accurately captured and disaggre- gated, and their approach is scalable to thousands of houses. The limitation of their algorithm is the insight into the appliance load category. Our work is similar to [19,20] in term of using low-frequency data to distinguish load categories that have various impact on the grid. Armel et al. in [21] point out that the low-frequency data (15 min–1 h) is useful in classifying loads into temperature and time dependent and base categories. In this paper, the proposed approach is another type of load-category based disaggregation, and it applies to similar scenarios in [18–20] when load-category based disaggregation is used for DR, DSM and load studies. For example, the cooling load category in [18,19], in our approach, falls into the low-PF group. In case of DR, the low-PF group can be targeted instead. The application and motivation of load-category based disaggregation generally apply to the PF based alternative. The main difference in the PF based approach is it largely reduces the amount of supervised training for generalization and further utilizes the hourly smart meter data. 94 G. Zhang et al. / Sustainable Energy, Grids and Networks 10 (2017) 92–103 A Fig. 1. Top-level disaggregation structure. 3. Description of the method 3.1. Problem overview The disaggregation of active power (P) and reactive power (Q) could be described generally in (1) as an under-determined linear system finding the consumption and power angle of each load category, given only the aggregate consumption of all the loads at time t. P (t) = N i=1 x(t) i + ϵP , for x (t) i ∈ [xmin i , xmax i ], (1a) Q (t) = N i=1 x(t) i tan(θi) + ϵQ , (1b) where x (t) i is the real power (source signal) of the i’th load category at time t; θi is the typical power angle of the load category; N is the number of load categories; ϵP and ϵQ are the errors; and xmin i and xmax i are the lower and upper bound of x(t) i . Unlike the typical bottom-up approach that uses fixed bases as source signals and finds the activation matrix that recovers the measurement P (t), we define x(t) i in (1) as the base of the i’th load category with varying magnitude in [xmin i , xmax i ]. Neglecting the error terms in (1), we separate (1) in R 2NT into a sub problem in RN and another in R NT , where T is the length of the disaggregation window. The problem in RN infers θi prior to the new disaggregation in RNT . The structure of our disaggregation approach is illustrated in Fig. 1. The hourly power data and timestamps in this paper are available through utility meters. The load signature inference step generates signatures of potential load categories based on historical P–Q data. The disaggregation step then separates each category by the parallel matching of P and Q. The disaggregation results are able to re- adjust the signatures through the feedback in Fig. 1. 3.2. Load categories from clustering Load categories in this paper are defined as the clusters of loads that exhibit similar power factors. Fig. 2 shows a clustered P–Q scatter plot of the data from a real-world smart meter. We infer the power angle and power range that best represent each cluster as signatures, and use these signatures in the disaggregation step. The agglomerative clustering method with weighted-average linkages is used to create clusters with various sizes. The size of cluster here means the ‘weight’ of each cluster, i.e. the number of data points and their magnitude. 3.3. Load signature inference The idea of load signature inference from aggregate P & Q comes from the observation of the hourly smart meter data (Fig. 3). For Fig. 2. Demonstration of load clustering for one month of real-world smart meter data. different dwell and heating types, the scatters of hourly P–Q form linear patterns in radial directions. Based on this observation, an important assumption in this paper is made as that each individual load, regardless of multi-state or single-state, has a fixed power factor (PF) over one-hour periods. Hence, if a radial line in Fig. 3 represents the true consumption of a single load and the average consumption of the load in each operation cycle is consistent, the variance along the line will indicate its ON duration (e.g. lighting). However, each radial line may not represent an individual load because of the aggregation effect (e.g. multiple loads turned on at the same time). In this case, each radial line in Fig. 3, if regarded as vector, is the addition of multiple load vectors. Goncalves et al. use a matching pursuit approach to synthesize component vectors and find matching on–off events to validate the synthesis [22]. However, because each load may have various active states over one hour (due to active duration or multiple states), vector synthesis with matching pursuit will yield a large number of ON–OFF matches without correct labeling. Therefore, within the 1-hour time frame, it is challenging to find signatures at single-load level, or to represent a load by a state model without prior knowledge. The solution in this paper is to apply clustering on the aggregate data regarding the power angles, which allows us to represent each load cluster as: ˆvi = ˆPi̸ ˆθi, (2) where vector ˆvi is the signature vector of the i’th cluster with inferred typical power angle ˆθi and active power ˆPi ∈ [0, ˆP max i ], for a maximum possible active power, ˆP max i . The signature vector, ˆvi, represents the typical power char- acteristics of the cluster. In disaggregation, ˆθi is fixed while ˆPi G. Zhang et al. / Sustainable Energy, Grids and Networks 10 (2017) 92–103 95 Fig. 3. Real-world AMI data at one-hour frequency in BC, Canada from Mar. 24 to Apr. 23, 2013. is allowed to vary in range. Eq. (2) relies on the assumption that the PF of each cluster averages to a constant in the hourly context. Sec- tion 3.3.1 explains how to derive ˆθi for each cluster. Section 3.3.2 describes how to derive ˆPi. Sections 3.3.1 and 3.3.2 combined de- rive the signature vector in (2) which will be used in disaggregation in Section 3.4. 3.3.1. Inferring power angles The challenge of finding the typical angle of a cluster of loads is the interference from other clusters due to the aggregation effect. If each cluster is represented by a signature vector and we are given the addition results of all the vectors, then our goal is to resolve the addition and recover ˆθi. In this paper, an optimization-based method of resolving vector addition is applied to find ˆθi in (3). The symbols in (3) are explained in Table 1 and (4). The problem in (3) mainly depends on the constraints to shrink the search space. Note that (3)–(4) generally apply to less than three load clusters. For more clusters, (3)–(4) need to be adjusted. Nevertheless, disag- gregation into more than three clusters may not apply to residen- tial context with smaller power factor range (e.g. 0.90–0.99). More clusters will cause sparsity in cluster and effectively lead to disag- gregating single loads instead of groups. For example, if a cluster has a range of 0.93–0.95, only several or even no load will fall into this category. min : f ( ˆθi) = ( ˆΘ − ¯Θ)2, (3a) s.t. : lbi < ˆθi < ubi, (3b) SR ˆθ = ¯θ, (3c) ˆθi+1 − ˆθi ≥ ¯θi+1 − ¯θi, (3d)  lbθ < | ˆvθ| − | ¯vθ| < 0, if Wlow > Whigh 0 < | ˆvθ| − | ¯vθ| < ubθ , if Wlow ≤ Whigh, (3e) where : ˆΘ = arctan( ˆQ / ˆP), (3f) ¯Θ = n arctan(q/p)/n, (3g) ˆQ = N i=1 Qi, ˆP = N i=1 Pi, (3h) Qi = Pi tan( ˆθi), Pi = LiWi, (3i) Li = ni k=1 p (k) i /ni, (3j) |vθ| =  N i=1 θ 2 i 1/2, (3k) lbθ ∈ [|lb| − | ¯vθ|, 0), ubθ ∈ (0, |ub| − | ¯vθ|]. (3l) The concept of blindly resolving vector additions is based on the estimation of the mean active (turn-on) power, Li ∈ L, and the weight, Wi ∈ W , of each cluster. The objective is to find L and W that generate the weighted-summed angle, ˆΘ, of all the clusters close to the direct observation, ¯Θ, from the aggregate P–Q data (3a). Eq. (3i), based on L and W , shows the P–Q components of each cluster in ˆΘ. The problem in (3a) could also be described in (3c) as finding the rotational matrix R that rotates the inferred vector, ˆθ, to the observed vector, ¯θ about an arbitrary axis through origin in a Cartesian coordinate system formed by the power angle of each cluster, subject to a uniform scaling defined by S (Fig. 4). R can be derived from (4) given in Box I. Based on our test data, the diagonal entries of SR are typically larger than 0.95, so 0.95( ˆθi+1 − ˆθi) ≥ ¯θi+1 − ¯θi. A more conservative constraint would be (3d). Constraint (3e) denotes that if the low-PF clusters have less weight, ˆvθ will be longer than ¯vθ due to the square in (3k) and that ˆθlow > ¯θlow, and vice versa. lbθ and ubθ in (3l) belong to discrete sets of possible values dependent on the angle boundaries from clustering. The minimum value of lbθ depends on the lower bound angle of each cluster, lbi, in (3b). Similarly the maximum value of ubθ depends on each ubi. In a high-level loop, lbθ or ubθ is incremented in the range in (3l) until ˆθ is solved. For each step in the loop over lbθ or ubθ , ˆθ is solved multiple times in a nested iteration. The high-level loop over lbθ or ubθ breaks when at least two ˆθi converge at the same time (changes in two ˆθi reduce close to 96 G. Zhang et al. / Sustainable Energy, Grids and Networks 10 (2017) 92–103 R =   u2 x (1 − cos φ) + cos φ uxuy(1 − cos φ) − uz sin φ uxuz(1 − cos φ) + uy sin φ uxuy(1 − cos φ) + uz sin φ u2 y(1 − cos φ) + cos φ uyuz(1 − cos φ) − ux sin φ uxuz(1 − cos φ) − uy sin φ uyuz(1 − cos φ) + ux sin φ u2 z (1 − cos φ) + cos φ   , (4a) where : ⃗r = (ux, uy, uz) = ˆθ × ¯θ |ˆθ × ¯θ| , (4b) φ = arccos  ˆθ · ¯θ |ˆθ| · |¯θ|  . (4c) Box I. Fig. 4. Power angle vector rotation concept. Table 1 Notation for symbols in (3). Variables & dependents Description ˆθi Inferred average power angle of the i’th cluster ˆΘ Inferred average power angle of all loads in a house R Rotation matrix in 3D about arbitrary axis through the origin ˆθ ( ˆθ1, ˆθ2, . . .) as the inferred power angles of each cluster ˆvθ Vector in the coordinate system formed by ˆθ ˆQ Inferred reactive power of all loads in a house Parameters Description lbi Lower bound of the inferred power angle of the i’th cluster (derived as cluster boundaries in Fig. 2) ubi Upper bound of the i’th cluster ¯Θ The mean power angle of all loads from the aggregate P–Q data S Scaling matrix in 3D ¯θ ( ¯θ1, ¯θ2, . . .) as the observed (mean) power angles of each cluster lbθ Lower bound of the vector length difference ¯vθ Vector in the coordinate system formed by ¯θ | · | Length operator of a vector ubθ Upper bound of the vector length difference Wlow Weight of low-PF clusters Whigh Weight of high-PF clusters ˆP Inferred active power of all loads in a house n Total number of P–Q data points q Reactive component of a single P–Q point p Active component of a single P–Q point N Number of load clusters Qi Reactive power of the signature for the i’th cluster Li Power base denoting the active power of the i’th cluster Wi Weight of the i’th cluster, considering only the active states of the cluster Pi Active power of the signature for the i’th cluster considering the weight ni Number of P–Q points in the i’th cluster p(k) i Active power of the k’th P–Q point in the i’th cluster lb (lb1, . . . , lbi, . . . , lbN ) as the lower boundaries of clusters (e.g. Fig. 2) ub (ub1, . . . , ubi, . . . , ubN ) as the upper boundaries of clusters zero), that is, the loop finds the interval that contains the solution for ˆθ. For demonstration purposes, we choose the convergence of two ˆθi instead of all to avoid lengthy iterations. One of the future works would be refining the initial value of lbθ or ubθ for faster G. Zhang et al. / Sustainable Energy, Grids and Networks 10 (2017) 92–103 97 Fig. 5. Power angle solver flow. Fig. 6. Hourly average power factor of a sample house over a month. convergence. Because of nonlinearity and non-convexity, (3) is solved multiple times for each value of lbθ or ubθ . As a result, the overall calculation speed depends on the selected range of lbθ or ubθ and the number of iterations for each value in lbθ or ubθ . Fig. 5 illustrates the overall flow of finding the power angles. 3.3.2. Power magnitude This section aims to find the upper bound, ˆP max i , of ˆPi in (2). Our estimator is based on a PF filter, an addition filter, and statistical analysis. The two filters reduce the aggregation effect caused by simultaneous load events. The PF filter is based on the hourly average PF of the whole house. It locates separate time frames Ti for high-, medium-, and low-PF periods (Fig. 6) based on the boundaries from clustering. Each Ti corresponds to the period when the aggregate PF falls into the range of a cluster. For each load cluster identified in, e.g. Fig. 2, only the data points that are within the corresponding Ti are preserved. The preserved points are more likely to contain true data points from the corresponding cluster, thus the following statistical analysis will be less affected by the aggregation effect. The addition filter further removes points in the medium-PF cluster that are close to the sum of the points from the high-PF and low-PF clusters (5). That is, remove : υj :  d(υj, υi + υk) ≤ δ d(υj, υi + υj + υk) ≤ δ (5) where d(·) is the Euclidean distance operator, υj = (pj, qj) is any P–Q point in the medium-PF cluster, i, j, and k represent the high-, medium-, and low-PF cluster, and δ is the cut-out threshold. The remaining points that pass the two filters are used in the final statistical analysis. At hourly frequency, each load cluster typically shows a Gamma distribution with a single peak (e.g. low- PF cluster in Fig. 7). If a large load exists, two or more peaks may be possible or the peak may be located at a large P (e.g. high and medium-PF clusters in Fig. 7). In this case, the peak with higher P represents ˆP max i of the cluster. Points with higher P than ˆP max i are possible results of aggregation effect. If the disaggregation result of each cluster show different peak power, ˆP max i will be updated (input d in Fig. 1). 3.4. Load disaggregation 3.4.1. Formulation Since the disaggregation granularity is reduced to load clusters instead of individual loads, the disaggregation problem could be simplified as a weighted least square (WLS) problem in (6). min : f (xi) = E2 P + E2 Q , ∀t, (6a) EP = P − ˆP, (6b) ˆP = N i=1 wixi, (6c) EQ = Q − ˆQ , (6d) ˆQ = N i=1 wixi tan( ˆθi), (6e) s.t. : 0 ≤ xi ≤ ˆP max i , (6f) where EP and EQ denotes the error in matching the aggregate active and reactive power at time t, respectively, P and ˆP are the actual and inferred aggregate active power at t, wi ∈ w is the weight of the i’th cluster at t, xi is the active power of the i’th cluster at t, N is the number of clusters, Q and ˆQ are the actual and inferred aggregate reactive power at t. 3.4.2. Finding the weights The main error in (6) is that a false active detection of a cluster will lead to inaccurate active states of other clusters while the aggregate power is still equal to the aggregate measurement. False active detection refers to a load is not turned on but the solver mistakenly computes that it is on. The weights w provide a supervisory solution to this problem. We estimate w based on: • the sparsity of a cluster, • the possible activation threshold of the i’th cluster (ai ∈ RN [kW]), • the aggregate power at time t (P [kW]), • the aggregate PF at t (ϕ), and • the temporal probability of activation of each cluster at t (Pi). The sparsity of a cluster in this paper is defined as that the cluster is only turned on occasionally over a month, resulting in a Gamma distribution (Γ ) with small shape and scale parameters, κ and ϑ (e.g. low-PF cluster in Fig. 7). If sparsity is detected in the 98 G. Zhang et al. / Sustainable Energy, Grids and Networks 10 (2017) 92–103 Fig. 7. Distribution of P in each cluster. (a) High-PF cluster with EV. (b) Medium-PF cluster with dryer. (c) Low-PF cluster. Fig. 8. Sample decision metric for finding the weights. i’th cluster, the activation threshold, ai, is defined in (7) as the most frequent power. ai =  argmax ˆpi∈ ˆpi ({P( ˆpi) : P( ˆpi) ≥ γ }), if ai > κϑ ˆP max i /2, if ai ≤ κϑ, (7) where P(·) denotes the probability function, ˆpi denotes all the active components of the filtered P–Q points in the i’th cluster, ˆpi is any point in ˆpi, γ denotes the cut-off threshold, and κϑ represents the mean of Γ . The activation of the i’th cluster depends on P. For example, if P > ai at t, the cluster will have a higher probability of being active. However, the power of non-sparse clusters will also affect the inference. Therefore, ϕ and Pi are also considered to derive wi in (6a). A sample inference algorithm for wi is provided in Fig. 8, where ϕi is the PF range of the i’th cluster, Pon is the activation probability threshold, woff is the weight for possible OFF states, and won is the weight for possible ON states. The active probability Pi at t is derived from historical data as (8). Note that the process of finding w only applies to cases when at least one sparse load cluster exists. For other cases without sparsity, w are set to ones. Pi = max(ˆp t i )/ai, if max(ˆpt i )/ai ≤ 1 1, otherwise, (8) where ˆp t i includes all the power over the training period of the i’th cluster grouped by hour. 3.5. Updating signatures The overall signature inference relies on the historical smart meter data. In this paper, the signatures are updated every month in a rolling window, which reduces seasonal effect by periodi- cally updating the signatures. The seasonal effect can be further accounted for by updating the signatures when major changes in the correlation between clusters and the ambient temperature are detected. 4. Results and discussion The optimization problem in (3) is solved using the Genetic Algorithm in MATLAB 2015b with both linear and nonlinear constraints. The problem in (6) is solved using the fmincon function in MATLAB with default settings. All the calculations are performed on a computer with 2.26 GHz Intel Core 2 Duo processor and 8G RAM. 4.1. Test data The test data used in this paper is from the Pecan Street database collected from real households in Austin, TX [23]. The database contains sub-metered data over several years. Disaggregation algorithms can be developed and validated with such data. Power factor of each load is assumed based on [24,25]. Note that the Pecan Street data of each house may not include all the loads inside the house, so some load clusters may be sparse. The test objectives of this paper are to examine the performance of the disaggregation algorithm: • on different houses, • in different seasons, • in larger scale such as residential blocks, • in real time with signatures derived from historical data. 4.2. Load signature inference This paper tests the performance of the algorithm on houses with typical data shapes observed in the test data (Fig. 9). Each shape is explained in Table 2. 4.2.1. Ground truth The clustering process creates a PF range (ϕi) for each cluster. The true load clusters are derived by grouping the individual loads that have PFs within each ϕi. The true signatures are derived in (9)–(10) where NL is the number of loads in each cluster with PF G. Zhang et al. / Sustainable Energy, Grids and Networks 10 (2017) 92–103 99 Fig. 9. P–Q scatter plots of the test data over two month. Fig. 10. Signature inference results for a Type-IV house. ∈ ϕi, θ k i is the angle of the k’th load in the i’th cluster, and pk L is the time-based load profile of the k’th load over the training period. θi = NL k=1 (θ k i )/NL. (9) P max i = max  NL k=1 p k L  . (10) 4.2.2. Power angles We demonstrate the results for a type-IV single-family house in Austin, TX. Fig. 10 shows the inferred signature vector ˆvi of each cluster, indicating that ˆθi of each cluster is close to the actual angle θi of the actual signature, vi. The details are provided in Table 3. 4.2.3. Maximum power In Fig. 10, the length of the vectors in solid lines indicates true P max i , and that of the vectors in dashed lines shows the inferred ˆP max i . Note that slightly larger ˆP max i helps relax the bounds of the disaggregation problem in the later stage to avoid infeasible solutions. Due to the simplicity of our algorithm, ˆP max i can be adjusted based on the disaggregation results by comparing ˆP max i and the resulted maximum values after disaggregation. If a large discrepancy is detected, we adjust ˆP max i and re-do the disaggregation (feedback in Fig. 1). 4.3. Load disaggregation 4.3.1. Evaluation metrics The modified F -measure in [11] and the Mean Absolute Error (MAE) are used in this paper. The modified F -measure approach in [11] accounts for both binary events and power matching. However, due to that load clusters in this paper have various ON states, we adjust the threshold ρ in [11] as (11). In some cases when a less frequent event with large P occurs (e.g. pool pump), the F -measure approach may exaggerate the accuracy if σ (p+ i ) > µ(p+ i ). Therefore, the MAE approach is additionally considered as a supplementary measure of performance. F -measure = 2 · Precision · Recall Precision + Recall , (11a) Precision = ATP ATP + ITP + FP , (11b) Recall = ATP ATP + ITP + FN , (11c) ATP ⇔ x > 0, x0 > 0, |x − x0| /x0 ≤ ρ, (11d) ITP ⇔ x > 0, x0 > 0, |x − x0| /x0 > ρ, (11e) FP ⇔ x > 0, x0 = 0, (11f) FN ⇔ x = 0, x0 > 0, (11g) p + i = {pi : pi > P f i }, (11h) ρi = σ (p + i )/µ(p + i ), (11i) where ATP, ITP, FP, and FN refer to the number of classifications that are accurate true positive, inaccurate true positive, false positive, and false negative, x denotes the power of a cluster at a given time from disaggregation, x0 denotes the corresponding true power, ρ denotes the threshold for determining ATP and 100 G. Zhang et al. / Sustainable Energy, Grids and Networks 10 (2017) 92–103 Table 2 Typical P–Q shapes. Shape Indication Type I Loads with high or low PF are small, or turned on in similar time periods Type II Loads with high and low PF are both high, possibly turned on very often at the same time. Very large resistive loads are possible (e.g. EV charging) Type III Large high-PF loads and/or large low-PF loads, possibly turned on at different time Type IV Loads with different PF have similar power consumption and usage patterns Table 3 Detailed results of signature inference. Cluster 1 Cluster 2 Cluster 3 θi (degree) 2.6 11.7 14.9 ˆθi (degree) 2.6 11.8 14.6 Error in ˆθi (degree) 0.0 0.1 0.3 True P max i (kW) 4.4 2.4 3.5 Inferred ˆP max i (kW) 5.6 3.3 4.2 Li (kW) 1.1 0.8 0.7 Wi (%) 32 16 53 Table 4 Disaggregation evaluation for Type-I and III data (from high to low-PF). Type-I data Type-III data MAE (kW) [0.06, 0.08, 0.06] [0.04, 0.07, 0.05] F -measure (%) [90.2, 80.5, 74.7] [95.9, 45.4, 95.3] ITP, p+ i denotes the points with P higher than P f i , P f i denotes the most frequent non-base power of the i’th true cluster, σ (·) is the standard deviation operator, and µ(·) is the mean operator. Compared to ρ in [11], directly using the mean and variance of load cluster will result in exaggerated F -measure score because of larger variance in load cluster than in single load. The new definition of ρ targets the upper tail of the histogram of pi, which represent relatively rare events. Eq. (11) is calculated based on the dispersion of power in these rare events. 4.3.2. Test on typical profiles For conciseness, this section provides the disaggregation results for two scenarios-households without EV (Type I) and with EV (Type III)-in this section (Figs. 11–12). Note that because of the nature of the test data, only the data of some of the loads in a household are available, thus resulting sparse load clusters (e.g. medium-PF cluster in Fig. 11) and low-power clusters (e.g. medium-PF in Fig. 12). Figs. 11–12 indicate that sparse clusters do not necessarily cause large error, but the overlap of peaks and the typical turn- on power of a cluster do. For example, in Fig. 11, both the medium and low-PF clusters are sparse. If both clusters have high turn-on probabilities at time t (condition (c) in Fig. 8), it will be uncertain which cluster should be ON if P > ai. The medium-PF cluster in Fig. 12, due to low power, is affected by the small errors in the other two clusters. On the other hand, clusters with large resistive power could be more easily retrieved (e.g. EV load at 3-kW level in Fig. 12). The disaggregation performance on Type-I and Type-III data are evaluated in Table 4. 4.3.3. Seasonal effect This section studies a set of data that contains heater and A/C (Figs. 13–14, Table 5). Based on Figs. 13–14, large A/C load in summer and large heating load in winter lead to better disaggregation performance on the corresponding clusters (low-PF cluster in Fig. 13 and high-PF in Fig. 14). However, for example, a small error in the low-PF cluster in Fig. 13 may cause large error in the medium-PF cluster (sparse). Our solution is to remove the peaks in the medium-PF cluster that correlate to the peaks in the other clusters after disaggregation. Fig. 11. Disaggregation results for Type-I data (no EV load). Fig. 12. Disaggregation results for Type-III data (with EV in High-PF cluster). The raw results from disaggregation in the medium-PF cluster may contain peaks that are the residuals of the other two, thus strongly correlated to their peaks. For example, the raw results of the medium and high-PF clusters have correlation coefficient (r) of 0.74. After removing the erroneous peaks in the medium- PF cluster, r is reduced to 0.08 (true r = 0.03). Note that the mitigation is only intended to demonstrate a potential solution on improving disaggregation performance. Future work will be required to improve general performance in disaggregating sparse clusters in single houses. Fig. 14 further shows that the main errors reside in the non- resistive loads. Especially for sparse loads with various active states (low peaks and high peaks in the medium-PF in Fig. 14), the disaggregator is not able to differentiate between the medium and G. Zhang et al. / Sustainable Energy, Grids and Networks 10 (2017) 92–103 101 Fig. 13. Disaggregation results in summer. Fig. 14. Disaggregation results in winter. Table 5 Disaggregation evaluation in summer and winter (from high to low-PF). Summer Winter MAE (kW) [0.07, 0.08, 0.11] [0.08, 0.08, 0.09] F -measure (%) [82.9, 46.5, 95.3] [94.9, 44.4, 89.9] low-PF clusters with available information. Nevertheless, in the context of hourly frequency and single house, the disaggregation algorithm is able to identify the major seasonal loads without referring to temperature data. The drawbacks seen in Figs. 13–14 can be avoided if dealing with an aggregation of houses (discussed in the next section). 4.3.4. Aggregation of houses The key advantage of the disaggregation algorithm in this paper is the scalability beyond single houses. A scenario in the microgrid context in [26] is considered, in which each node in the microgrid may connect to 10–12 houses. The aggregated consumption of 10–12 houses typically has less sparsity compared to the single- house cases. Hence, it is expected the errors due to sparsity Fig. 15. Disaggregation results for a group of 10 houses. Fig. 16. Online disaggregation over two weeks using the signatures derived from the previous month. (Fig. 14) can be reduced, and the disaggregation can be simplified by eliminating the steps in Fig. 8. An example of 10-house aggregation is provided in Fig. 15. The results show the MAEs are [0.25, 0.44, 0.46] kW and the F -measure scores are [96.0, 84.3, 93.5]%. Note that because each cluster is always ON, we regard P max i as the threshold for separating the true negative, false negative, and false positive events in the F -measure metric. Depending on application, combining the disaggregation re- sults of the medium and low-PF clusters can offset the error and result in one larger load cluster with smaller error. For instance, if we combine the medium and low-PF clusters in Fig. 15, we can achieve an F -measure score of 99.9% and MAE of 0.4 kW for the combined cluster. 4.3.5. Real-time capability The real-time potential of our algorithm is studied for the 10-house aggregation. The real-time implementation uses the signatures derived from the historical data in a real-time receding window with one-month length. In this way, the load signatures will be more accurate thanks to the most recent data. Fig. 16 and Table 6 show the results for a period of two weeks following the 102 G. Zhang et al. / Sustainable Energy, Grids and Networks 10 (2017) 92–103 Table 6 Disaggregation evaluation for real-time implementation (from high to low-PF). Offline (over a month in Mar.) Online (over two weeks in Apr.) MAE (kW) [0.23, 0.44, 0.28] [0.19, 0.42, 0.30] F -measure (%) [94.9, 78.1, 99.0] [90.0, 72.9, 96.0] Fig. 17. Four-cluster disaggregation results for 10-house group. last day of March in Fig. 15. The online performance is comparable with the offline results. 4.3.6. More clusters This section shows the disaggregation into four clusters using the true power angles (skipping Eqs. (3)–(4)). As mentioned in 3.3.1, disaggregation into more than three clusters is not suggested. The results in Fig. 17 yield F -scores of [92.0, 49.0, 69.0, 89.2]%. Despite that the true angles are used, the disaggregation performance degrades at granular level when clusters have similar PFs. 4.4. Sensitivity The model for deriving the power angles in (3) is more complicated than directly using the average angles after clustering. This section compares the disaggregation performance with these two options. In addition, the benefit of using the PF and addition filters in finding the power magnitude (Section 3.3.2) will also be discussed. Table 7 shows the comparison between using (3) and the av- erage power angle of each cluster for disaggregating the 10-house aggregation. The average angle denotes the average from the raw P–Q points in each cluster. Model (3) generally improves the per- formance in all evaluation methods. The improvement is more sub- stantial for larger scale as (3) is more consistent when dealing with less sparse load clusters. For single houses, the maximum improve- ment in F -score in the studied data is about 12%. Figs. 18 and 19 show the analysis in parallel coordinates. We simulate 100 scenarios with random errors in each power angle. For each cluster, the absolute error evenly distributes between 0% and 30% as the deviation from the true angle (model (3) is skipped). Fig. 18 shows that large errors in the medium- and low-PF cluster result in low disaggregation performance (59%–68% average F -score). Lower errors, on the other hand, result in 81% average F -score. Fig. 19 shows individual results in low-performance disaggregation (<68%F -score). Errors in medium- and low-PF angles particularly degrade disaggregation performance due to that the medium- and low-PF clusters are more sparse in our test data. Fig. 18. Average disaggregation performance with various errors in power angles. Fig. 19. Error distribution in medium and low disaggregation performance. The PF and addition filters in Section 3.3.2 affect the MAE in disaggregation. For the 10-house aggregation, these filters improve the MAE by an average of 5%. For single houses, the improvement in single clusters could reach 30%. These filters have more impact on clusters containing fewer individual loads. 4.5. Test in real-world application The disaggregation approach is applied to a set of real-world aggregate data from a BC Hydro smart meter in Kootenay, BC, Canada (bottom-left in Fig. 2). The available data is the hourly measurement of P and Q for a single house with electric heating. Sub-metered data of individual loads are not available. The disaggregation results are illustrated in Fig. 20. We validate the results based on our previous work in [27]. It infers the usage frequency and power consumption of typical residential loads. Fig. 20 shows that the medium-PF cluster only occasionally consumes large power in a weekly pattern (March 27 and April 4), indicating possible dishwasher load (Table II in [27]). The low- PF cluster corresponds to clothes washer and dryer because of G. Zhang et al. / Sustainable Energy, Grids and Networks 10 (2017) 92–103 103 Table 7 Model (3) vs. average power angles (data as improvement by (3) for 10-house aggregation). F -measure (%) MAE on P (%) MAE on Q (%) High-PF cluster 3.79 22.56 23.15 Medium-PF cluster 18.15 10.16 0.00 Low-PF cluster 7.81 18.31 16.37 Fig. 20. Disaggregation of a single house in Kootenay, BC. its more frequent turn-ons (clothes washer, used 5–9 times a week [27]) and occasional peaks (dryer, used for some but not all loads of clothes washer [27]). The high-PF cluster correlating to space heating, water heating, and range consumes the majority of power during off-work hours, evenings, weekends, and holidays. For example, the long duration of high-PF load started on March 28 (March 29 was Good Friday) and April 5 (Friday). Fig. 15 also demonstrates that our algorithm could possibly reveal the consumption of typical loads that consume large active or reactive power. This could be achieved without the survey data or assumptions made in [27]. 5. Conclusions This paper proposes an unsupervised residential disaggregation algorithm that requires minimal prior knowledge of loads. The algorithm is able to detect possible load signatures on load-cluster level directly from the aggregate P–Q measured by smart meters at hourly frequency. Disaggregation of both P and Q are implemented by an optimization approach bounded by the inferred signatures. The results show that the algorithm is able to disaggregate load clusters categorized by power factors. The algorithm is adaptive to various composition and types of loads regardless of controlled loading (e.g. DR and direct load control). We further examine the seasonal effect on the disaggregation accuracy and find that large cooling or heating loads have no adverse effect on our algorithm. Real-time capability of our algorithm can be achieved by updating load signatures with the most recent historical data. The algorithm could yield improved results for small aggregation of houses, thus extending its application in microgrids for local grid planning and dispatch with enhanced data utilization. References [1] E.T. Mayhorn, G.P. Sullivan, R.S. Butner, H. Hao, M. Baechler, Characteristics and performance of existing load disaggregation technologies, Tech. Rep., PNNL, Richland, Washington, 2015. [2] K. Ehrhardt-Martinez, K.A. Donnelly, S. Laitner, et al., Advanced metering initiatives and residential feedback programs: a meta-review for household electricity-saving opportunities, Tech. Rep., American Council for an Energy- Efficient Economy, Washington, DC, 2010. [3] G.W. Hart, Nonintrusive appliance load monitoring, Proc. IEEE 80 (12) (1992) 1870–1891. [4] S. Gupta, M.S. Reynolds, S.N. Patel, Electrisense: single-point sensing using emi for electrical event detection and classification in the home, in: Proceedings of the 12th ACM International Conference on Ubiquitous Computing, ACM, 2010, pp. 139–148. [5] J. Liang, S.K. Ng, G. Kendall, J.W. Cheng, Load signature study-part i: Basic concept, structure, and methodology, IEEE Trans. Power Deliv. 25 (2) (2010) 551–560. [6] H.-y. Lam, Voltage-current trajectory: a 2-dimensional approach to under- stand electrical load signatures (Ph.D. thesis), The University of Hong Kong, Pokfulam, Hong Kong, 2007. [7] T. Hassan, F. Javed, N. Arshad, An empirical investigation of vi trajectory based load signatures for non-intrusive load monitoring, IEEE Trans. Smart Grid 5 (2) (2014) 870–878. [8] S. Makonin, Real-time embedded low-frequency load disaggregation (Ph.D. thesis), Simon Fraser University, Burnaby, BC, Canada, 2014. [9] Z. Guo, Z.J. Wang, A. Kashani, Home appliance load modeling from aggregated smart meter data, IEEE Trans. Power Syst. 30 (1) (2015) 254–262. [10] J.Z. Kolter, T.S. Jaakkola, Approximate inference in additive factorial hmms with application to energy disaggregation, in: AISTATS, vol. 22, 2012, pp. 1472–1482. [11] H. Kim, M. Marwah, M.F. Arlitt, G. Lyon, J. Han, Unsupervised disaggregation of low frequency power measurements, in: SDM, Vol. 11, SIAM, 2011, pp. 747–758. [12] D. Egarter, V.P. Bhuvana, W. Elmenreich, Paldi: Online load disaggregation via particle filtering, IEEE Trans. Instrum. Meas. 64 (2) (2015) 467–477. [13] A. Gabaldón, M. Ortiz-García, R. Molina, S. Valero-Verdú, Disaggregation of the electric loads of small customers through the application of the Hilbert transform, Energ. Effic. 7 (4) (2014) 711–728. [14] S. Kong, Y. Kim, R. Ko, S.-K. Joo, Home appliance load disaggregation using cepstrum-smoothing-based method, IEEE Trans. Consum. Electron. 61 (1) (2015) 24–30. [15] D. Egarter, C. Prokop, W. Elmenreich, Load hiding of household’s power demand, in: Smart Grid Communications (SmartGridComm), 2014 IEEE International Conference on, IEEE, 2014, pp. 854–859. [16] Understanding your electricity use, https://www.bchydro.com/content/ BCHydro/en/accounts-billing/rates-energy-use/rates-energy-use.html (ac- cessed: 2015-11-01). [17] O. Parson, S. Ghosh, M. Weal, A. Rogers, Non-intrusive load monitoring using prior models of general appliance types, in: Proceedings of the Twenty-Sixth AAAI Conference on Artificial Intelligence, AAAI Press, 2012, pp. 356–362. [18] Y. Xu, J.V. Milanović, Artificial intelligence based methodology for load disaggregation at bulk supply point, IEEE Trans. Power Syst. 30 (2) (2015) 795–803. [19] B.J. Birt, G.R. Newsham, I. Beausoleil-Morrison, M.M. Armstrong, N. Saldanha, I.H. Rowlands, Disaggregating categories of electrical energy end-use from whole-house hourly data, Energy Build. 50 (2012) 93–102. [20] M. Wytock, J.Z. Kolter, Contextually supervised source separation with application to energy disaggregation, in: Proceedings of the Twenty-Eighth AAAI Conference on Artificial Intelligence, AAAI Press, 2014, pp. 486–492. [21] K.C. Armel, A. Gupta, G. Shrimali, A. Albert, Is disaggregation the holy grail of energy efficiency? The case of electricity, Energy Policy 52 (2013) 213–234. [22] H. Goncalves, A. Ocneanu, M. Berges, R. Fan, Unsupervised disaggregation of appliances using aggregated consumption data, in: The 1st KDD Workshop on Data Mining Applications in Sustainability, SustKDD, 2011. [23] Pecan street inc. — about, http://www.pecanstreet.org/about (accessed: 2015- 11-03). [24] M. Fitta, S. Biza, M. Lehtonen, T. Nieminen, G. Jacucci, Exploring techniques for monitoring electric power consumption in households, in: Proceedings of the 4th International Conference on Mobile Ubiquitous Computing, Systems, Services and Technologies, UbiComm, 2010, pp. 471–477. [25] R. Bacurau, A. Dante, L. Duarte, E. Ferreira, Experimental investigation on the load signature parameters for non-intrusive load monitoring, Prz. Elektrotech. 91 (8) (2015) 86–90. [26] M. Manbachi, M. Nasri, B. Shahabi, H. Farhangi, A. Palizban, S. Arzanpour, M. Moallem, D.C. Lee, Real-time adaptive vvo/cvr topology using multi-agent system and iec 61850-based communication protocol, IEEE Trans. Sustainable Energy 5 (2) (2014) 587–597. [27] G. Zhang, G. Wang, H. Farhangi, A. Palizban, Residential electric load disaggregation for low-frequency utility applications, in: 2015 IEEE Power & Energy Society General Meeting, IEEE, 2015, pp. 1–5.","libVersion":"0.3.1","langs":""}