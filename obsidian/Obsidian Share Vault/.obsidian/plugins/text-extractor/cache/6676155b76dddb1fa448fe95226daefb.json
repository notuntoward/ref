{"path":"lit/lit_sources.backup/Dolara15cmprPhysPVmodels.pdf","text":"Comparison of diﬀerent physical models for PV power output prediction Alberto Dolara ⇑, Sonia Leva, Giampaolo Manzolini Politecnico di Milano – Dipartimento di Energia, Via Lambruschini 4, 20156 Milano, Italy 1 Received 6 February 2015; received in revised form 29 May 2015; accepted 10 June 2015 Available online 10 July 2015 Communicated by: Associate Editor Mario Medina Abstract The electricity produced from renewable energy, in particular from wind and photovoltaic plants, has seen exponential rise in the last decade. Consequently, the prediction of power produced from these plants is fundamental for the reliability, safety and stability of the grid. This paper compares three physical models describing the PV cell (corresponding to three-, four- and ﬁve-parameter equivalent electric circuit) and two thermal models for the cell temperature estimation (NOCT and Sandia). The models were calibrated and tested towards ten monocrystalline and eight polycrystalline modules installed at SolarTechLab at Politecnico di Milano. The hourly error of the forecasted power output is usually lower than 15 Wh, while NMAE% and WMAE% are in the range of 0.5% and 10%. Low errors, calculated with actual weather conditions, suggest that the implemented models are accurate, but they cannot be directly compared with other approaches which adopt weather forecasts. Results show that there is no clear advantage of using complex models, but the data used for the model calibration mostly aﬀect the model accuracy. It was found that forecasted power output are more accurate using experimental data and Sandia’s thermal model in monocrystalline cells type, while for the polycrystalline the data from the manufacturer and NOCT have lower errors. Keywords: PV forecast power production; PV equivalent electrical circuit; NMAE; WMAE; SolarTechlab 1. Introduction The electricity produced by renewable energy sources (RES) is constantly increasing world-wide thanks to gov- ernment policies and technological advancements. Europe has experienced one of the largest RES growths: in the last ﬁve years the electricity generation by RES, and in partic- ular by photovoltaic and wind plants, has doubled. Challenges of controlling and maintaining energy from inherently intermittent sources and of the grid-connected RES penetrating the distribution systems involves many aspects: eﬃciency, reliability, safety, stability of the grid and ability to forecast energy production. Forecasting of PV/wind electricity production, as an estimation from expected power production, is very impor- tant to help the grid operators managing the electric bal- ance between power demand and supply, and to improve embedding of distributed renewable energy sources and, in stand-alone hybrid systems, for the optimum size of all its components and to improve the reliability of the iso- lated systems. In order to make energy supply planning rational, pre- diction of RES production have to be made based on the consideration of weather conditions and forecasts. Any ⇑ 1 Corresponding author. Tel.: +39 02 23993829. E-mail address: alberto.dolara@polimi.it (A. Dolara). www.solartech.polimi.it output from the weather models must then be converted into electric energy output. The existing solutions can be classiﬁed into the categories of physical, statistical and hybrid methods (Ulbricht et al., 2013). In physical models the ability of a RES plant to convert the introduced mete- orological resources into electrical power are summarized by a physical model. These models can be very simple, based only on the global irradiance on the solar cell, or more complex if they include additional parameters. As a matter of fact, it is not easy to predict PV module energy production since it depends on several parameters as ambi- ent and cells conditions. For example, the conversion pro- cess is aﬀected by solar irradiance and uniformity (i.e. shadowing), soiling, aging, cell temperature, the solar inci- dence angle and the load condition. Moreover, information provided by manufacturers are usually limited and referred only at nominal operating conditions. Statistical methods are based on the concept of persis- tence, or stochastic time series. Nowadays the most com- mon approach to forecast a time series’ future values approach is the use of machine learning methods. Reviewed literature shows that artiﬁcial neural networks (ANN) have been successfully applied for forecasts of ﬂuc-tuating energy supply (Hocaoglu et al., 2008; Izgi et al., 2012; Mellit and Massi Pavan, 2010). These methods learn to recognize patterns in data using training data sets. This is the main drawback: historical data about weather fore-cast and the real power production and environmental quantities are necessary to training the ANN and start the forecast of energy production by RES. Any combination of two or more of the previously described methods leads to a hybrid model. The idea is to combine diﬀerent models with unique features to over-come the single negative performance and ﬁnally improve the forecast (Ogliari et al., 2013). In this paper, the comparison of diﬀerent physical mod- els for the prediction of PV performances is performed. Previous works investigated the accuracy of PV physical models mainly focusing on the diﬀerent methods for the parameters derivation (Celik and Acikgoz, 2007; Ciulla Nomenclature a experimental coeﬃcient for high radiation and no wind in the Sandia thermal model a solar azimuth angle (\u0003) aISC temperature coeﬃcient for short-circuit current b experimental coeﬃcient accounting for the wind in the Sandia thermal model b solar panel tilt (\u0003) bVOC temperature coeﬃcient for open-circuit voltage c panel azimuth angle (\u0003) h incidence angle between solar beam and surface (\u0003) s glass transmittance C capacitor of the measurement system (F) CN net capacity of the plant (W) DAT calibration from datasheet eh hourly error (Wh) eh;abs absolute hourly error (Wh) EXP calibration from experimental measurements G normal irradiance on PV cell (W/m2) GTOT solar irradiation on PV array (W/m2) GDIFF diﬀuse irradiance (W/m2) GREFL ground reﬂected irradiance (W/m2) GDNI direct normal irradiance (W/m2) K glass extinction factor (m\u00021) I current (A) ID current across the PN junction (A) I0 reverse saturation current (A) IMPP current at maximum power point (A) IPV light-generated current (A) ISC short circuit current (A) L glass thickness (m) nair air refraction factor nglass glass refraction factor N number of daylight hours Ns number of cells in series NOCT nominal operating cell temperature (\u0003C) n diode ideality factor nRMSE normalized root mean square error NMAE% normalized mean absolute error P m;h average power produced (measured) in the hour (W) P p;h average power predicted in the hour (W) R resistance (X) ref reference value RS,c cell series resistance (X) RSH,c cell shunt resistance (X) RS,m module series resistance (X) RSH,m module shunt resistances (X) Rdis discharge resistor of the measurement system (X) Rshunt shunt resistor of the measurement system (X) S1, S2 switches of the measurement system T temperature (\u0003C) Tamb ambient temperature (\u0003C) TC cell temperature (\u0003C) V voltage (V) VMPP voltage at maximum power point (V) VOC open circuit voltage (V) Vt thermal voltage (V) WMAE% weighted mean absolute error based on total energy production WS wind speed in Sandia thermal model (m/s1) z solar zenith angle (\u0003) et al., 2014; De Blas et al., 2002; Lineykin et al., 2014; Lo Brano et al., 2010; Ma et al., 2013, 2014; Shongwe and Hanif, 2015; Tossa et al., 2014). In particular, (Ciulla et al., 2014; de Blas et al., 2002; Lineykin et al., 2014; Ma et al., 2013) compared the I–V curve obtained by diﬀerent approaches based on manufacturer data and eval-uated the accuracy of each at several solar radiations and operating temperature. The comparison was carried out in terms of power and errors in the range of 1% were achieved. (Shongwe and Hanif, 2015) also evaluated diﬀer-ent modeling methods (equations) taken from diﬀerent authors in the literature in terms of I–V curve. Compared to previous work, the calibration was carried out both by manufacturer datasheet and experimental results based on 80 W panel. (Tossa et al., 2014) applied ﬁve diﬀerent electric models (one on four-parameter, one on ﬁve-, one on seven- parameter and two including recombination cur-rents) in terms of energy production of three diﬀerent solar ﬁelds of about 5 MW each. Results showed that the simpler models (four- and ﬁve-parameter) were the more accurate with errors in the range of 10%. (Ma et al., 2014) applied a ﬁve- parameter model to experimental measurements on single panel, string and array in terms of short-circuit cur-rent, open-circuit voltage and maximum power point. It was found the model valid for the single panel can be extended to string and array through a derating factor. Finally, (Celik and Acikgoz, 2007)) compared four- and ﬁve-parameter analytical models to calculate the operating current of a 120 W monocrystalline photovoltaic module under real working conditions. The cell temperature is measured on the PV panel and used as an input. This work brings about the following novelties: \u0002 Three diﬀerent electrical models were compared in terms of energy production in six diﬀerent days. Previous works mainly focused on few conditions and the three- parameter model was not considered. \u0002 The PV cell temperature is determined through two ther- mal models: the ﬁrst is based on Nominal Operating Cell Temperature (NOCT) and the second by using the Sandia model. Previous work based their calculations on measured temperature hence neglecting the impact of this operating parameter on the power prediction which was identiﬁed as the most signiﬁcant by (Rus-Casas et al., 2014). \u0002 The models were calibrated using both I–V curve pro- vided by manufacturer and measured data. The compar- ison of the obtained results indicates whether for European region the information from datasheet is accurate for the model calibration or actual measure- ment of PV module performances are necessary. For example, experimental measurements takes into account the impact of dust and aging on module performances. \u0002 Models were applied to both monocrystalline and polycrystalline PV panels in order to outline diﬀerences in the prediction due to PV cell type. The comparison is based on an experimental activities carried out at the SolarTechLab, Politecnico di Milano (SolarTech Lab, 2013) where both monocrystalline and polycrystalline modules are installed. Since the aim of the work is the comparison of models accuracy, the power predictions are based on actual weather measurements, hence neglecting weather forecast errors. The paper is organized as follows: In Section 2 we review and classify PV cell models proposed in the litera-ture to predict the output of solar energy production. In Section 3, the experimental set-up and tests are described. In Section 4 we evaluate the performance of the diﬀerent PV module models in term of I–V curve. In Section 6 the performance prediction comparison of the diﬀerent mod-els, in term of hourly error and normalized mean absolute error discussed in Section 5, is presented. Finally, we conclude and outline additional research directions for our future work in Section 7. 2. PV cell models As discussed in the introduction section, it is becoming more and more important to improve the precision in the prediction of PV plants power production in order to increase their penetration in the electrical grid. The PV plants power production can be calculated start- ing from suitable equivalent electrical circuits. The models of a single PV cell can be used to develop models that rep- resents a PV module, as well as a PV string, consisting of several modules connected in series, and PV array, consist- ing of several strings connected in parallel. In this work, several PV cell equivalent circuits are described and PV module equivalent circuits are further derived (see Section 2.1). Both monocrystalline and polycrystalline technologies are taken into account. Several PV cell equivalent circuits are reported in litera- ture (Celik, 2011; De Soto et al., 2006; Durgadevi et al., 2011; Farret et al., 2011; Luque and Hegedus, 2013; Nelson, 2003; Rodrigues et al., 2011), diﬀering by the num-bers of parameters required to characterize them. In partic-ular, models are characterized by three parameters (Luque and Hegedus, 2013; Nelson, 2003), four parameters (Luque and Hegedus, 2013; Nelson, 2003; Rodrigues et al., 2011), ﬁve parameters (Celik, 2011; De Soto et al., 2006; Houabes, 2010), six parameters (Dobos, 2012) and seven parameters (Luque and Hegedus, 2013; Nelson, 2003). The precision of the phenomena occurring in the PV cell increases with the number of parameters, as well as its com-plexity, the computational load and the amount of infor-mation required to deﬁne its parameters. Usually, the best tradeoﬀ in accuracy and in ease of use is to adopt an equivalent circuit characterized by a halfway number of parameters. In this work, the three-, four- and ﬁve-parameter PV module electrical models will be discussed and they will be applied in order to assess the performances of a PV-facility. The accuracy of the models is evaluated con- sidering the actual production measured by an energy meter. 2.1. PV cell equivalent circuits The simplest PV cell equivalent circuit is characterized by three parameters and it is shown in Fig. 1. The circuit includes a current generator with a diode connected in par- allel, representing the light-generated current and the elec- trical behavior of the PN junction, respectively. The current–voltage characteristic for the PV cell is deﬁned by Eq. (1). I ¼ I PV \u0002 I D ¼ I PV \u0002 I 0 \u0003 e V n\u0003V t \u0002 1 \u0002\u0003 ð1Þ The three parameters that characterize this model are IPV, I0 and n which represent the light-generated current, the reverse saturation current of the PN junction and the diode ideality factor, respectively. This model of the PV cell is the simplest and accounts only for the diode behavior of the PN junction. Ohmic losses occurring in the PV cells are not taken into account, making the assessment of the energy production not very accurate. The most complex model here considered is the one based on ﬁve parameters. The equivalent circuit (see Fig. 2) includes two resistances: the ﬁrst one (RSH,c), also named cell shunt resistance, is connected in parallel to the current generator and second one (RS,c), also named cell series resistance, is connected in series to the cell terminals. The ﬁve-parameter model, based on Ipv, I0, n and the two resistances RS,c and RSH,c, is described in Eq. (2): I ¼ I PV \u0002 I 0 \u0003 e V þRS;c\u0003I n\u0003V t \u0002 1 \u0002\u0003 \u0002 V þ RS;c \u0003 I RSH ;c ð2Þ The introduction of the resistance RS,c, makes the equa- tion implicit. Moreover, the cell I–V characteristic is signif- icantly aﬀected by these resistance values. The impact of RS,c is at high cell voltages, where the cell behavior is sim- ilar to an ideal voltage source, while the impact of RSH,c occurs at low cell voltages, where the cell behavior is simi- lar to an ideal current source. Since the shunt resistance typically assumes very high values, its impact on the cell I–V characteristic is very low. Therefore, a simpler cell equivalent circuit can be developed neglecting its contribution: this assumption leads to the four-parameter model (Luque and Hegedus, 2013; Nelson, 2003; Rodrigues et al., 2011). The equivalent circuit of the four parameters model is shown in Fig. 3 and the I–V characteristic is described in Eq. (3). I ¼ I PV \u0002 I 0 \u0003 e V þRS;c \u0003I n\u0003V t \u0002 1 \u0002\u0003 ð3Þ The cell I–V characteristic depends on solar irradiance and PN junction temperature. Open circuit voltage and short circuit current variation as function of T and G are taken into account as follows (IEC60891, 2010): I SC ¼ I SC;ref \u0003 GTOT Gref \u0003ð1 þ aISC \u0003ðT C \u0002 T C;ref ÞÞ ð4Þ V OC ¼ V OC;ref \u0003ð1 þ bVOC \u0003ðT C \u0002 T C;ref ÞÞ þ A \u0003 ln GTOT Gref \u0004\u0005 ð5Þ The subscript ref stands for reference conditions; aISC and bVOC are the temperature coeﬃcients for short-circuit current and open-circuit voltage, respectively. In most cases, reference values are measured at standard test condi- tions (STC), that is with Gref equal to 1000 W/m2, cell tem- perature TC,ref equal to 25 \u0003C and Air Mass equal to 1.5. A is the product of the number of cells, Ns, the ideality factor of the diode and the Vt. The short circuit current ISC is proportional to the irra- diance on the cell GTOT, while GTOT has limited impact on the open circuit voltage VOC. On the contrary, the cell tem- perature TC aﬀects more VOC than ISC. Variation of the PV cell electric models parameters (I0, RSH, IPV) with irradiance on the cell GTOT and its temper- ature TC is made according to (De Soto et al., 2006). IPV ID I V Fig. 1. Equivalent circuit representing the three-parameter circuit. IPV ID ISH I VRSH,c RS,c Fig. 2. Equivalent circuit representing the ﬁve-parameter model. IPV ID I V RS,c Fig. 3. Equivalent circuit representing the four-parameter model. n ¼ nref ð6Þ RS ¼ RS;ref ð7Þ I PV ¼ GTOT Gref \u0003½I PV ;ref \u0003ð1 þ aISCðT C \u0002 T ref ÞÞ\u0004 ð8Þ I 0 ¼ I 0;ref \u0003 T C T ref \u0004\u00053 \u0003 e Eg;ref n\u0003k\u0003T ref \u0002 Eg n\u0003k\u0003T C \u0002\u0003 ð9Þ RSH ¼ RSH ;ref \u0003 Gref G ð10Þ In (9), k is the Boltzmann constant (8.6173324 \u0003 10\u00025 eV/K) and Eg is the bandgap energy of the silicon, that is temperature dependent and it is given, in eV, as: Eg ¼ 1:17 \u0002 4:73 \u0003 10\u00024 \u0003 T 2 C T C þ 636 ð11Þ Variation of the ideality factor of the cell (n) and the ser- ies resistance (RS) with GTOT and TC are neglected (De Soto et al., 2006). 2.2. Irradiance model The PV array irradiance and incidence angle modiﬁer are calculated according to (De Soto et al., 2006; Duﬃe and Beckman, 1991). The irradiance GTOT is the sum of the solar direct nor- mal irradiance (GDNI), the diﬀuse irradiance (GDIFF) and the ground reﬂected irradiance (GREFL) as expressed by Eq. (12): GTOT ¼ GDNI \u0003 cosðhÞþ GDIFF \u0003 1 þ cosðbÞ 2 \u0004\u0005 þ GREFL \u0003 1 \u0002 cosðbÞ 2 \u0004\u0005 ð12Þ As for h, it is solar incidence angle on the cell, and it is calculated by: cosðhÞ¼ cosðzÞ\u0003 cosðbÞþ sinðzÞ\u0003 sinðbÞ\u0003 sinða \u0002 cÞð13Þ being, (i) z the zenith angle, (ii) b the PV module tilt, (iii) a the azimuth angle and (iv) c the angle between the module and the south direction as shown in Fig. 4. The reﬂectivity factor commonly taken into account was neglected since PV panels considered in this work are placed on a welded steel bar grating. Experimental mea-surements in the laboratory assessed that the reﬂectance of this surface can be neglected. The irradiance on the cell surface (G) takes into account the transmittance of the glass, which depends on the beam incidence angle. It is obtained multiplying the two compo- nents of irradiance on PV array (i.e. the reﬂected irradiance is neglected as already pointed out) by the transmittances of the glass at the beam incidence angle and at the average angle for isotropic irradiance, respectively, as reported in (14): G ¼ sb \u0003 GDNI \u0003 cosðhÞþ sd \u0003 GDIFF \u0003 1 þ cosðbÞ 2 \u0004\u0005 ð14Þ Eq. (14) is usually represented in terms of incidence angle modiﬁers (Ks) and transmittance of the glass for nor- mal incidence (s0): G ¼ s0 \u0003 K s;b \u0003 GDNI \u0003 cosðhÞþ K s;d \u0003 GDIFF \u0003 1 þ cosðbÞ 2 \u0004\u0005\u0006\u0007 ð15Þ Eq. (15) takes into account also the transmittance of the glass, which depends on the beam incidence angle. Transmittance is characterized at normal incidence angle (s0) and with the incidence angle modiﬁers (Ks) which are calculated as s0 ¼ e\u0002K\u0003L \u0003 1 \u0002 nglass \u0002 1 nglass þ 1 \u0004\u00052 \"# ð16Þ K s ¼ s s0 ð17Þ Concerning the calculation of the incidence angle mod- iﬁer for direct irradiance (Ks,b), the numerator of Eq. (17) is calculated using an optical model of the air-glass interface that takes into account both the reﬂective losses at the interface and absorption within glass, as: s ¼ e\u0002 K\u0003L cos hr \u0003 1 \u0002 1 2 sin 2ðhr \u0002 hÞ sin 2ðhr þ hÞ þ tan2ðhr \u0002 hÞ tan2ðhr þ hÞ !\"# ð18Þ where K is the glass extinction factor, L is the glass thick- ness, h and hr are the angles of incident and refracted beams measured with respect to the normal at the surface; the latter are related by the Snell’s law Fig. 4. Solar characteristics angles. sinðhrÞ¼ nair nglass \u0003 sinðhÞð19Þ Concerning the calculation of the incidence angle mod- iﬁer for diﬀuse irradiance (Ks,d), in Eqs. (18) and (19) the average angle for isotropic irradiance is considered as the incidence angle h. Incidence angle modiﬁer is close to 1 for incidence angles till 50\u0003 degrees, then it quickly drops. As it is possi-ble to note in Eqs. (16) and (18), transmittance depends on the physical characteristics of the glass which are barely available in datasheet and whose measure requires speciﬁc tests on glass samples. In this work, typical values for the glass refractive index and extinction factor are taken into account (De Soto et al., 2006). Anyway, a sensitivity analysis has been performed taking into account the typical range of glass thickness in PV appli- cations, varying the extinction factor between 0.1 times to 10 times the value reported in (De Soto et al., 2006), and the refractive index from 1.4 to 1.7. The sensitivity analysis shows that the impact of extinction factor and refractive index on the incidence angle modiﬁer is limited. The irradiance on the cell surface is aﬀected by the amount of airborne dust accumulated on the glass surface, reducing glass transmittance; this phenomenon is referred as “soiling”. From the electrical point of view, soiling can cause a degradation of short circuit current, while open cir- cuit voltage remains mostly unchanged. Soiling is site- speciﬁc and dust accumulation occurs at diﬀerent rates across geographic regions. Chemical composition of dust and the size of particles, as well as wind speed, the amount and the time interval of rainfalls and the tilt angle of the glass surface, play a key role on the dust accumulation pro- cess (Sarver et al., 2013). Moreover, the degradation in the PV performances depends also on the distribution of dust on the glass surface. Several studies reported in (Sarver et al., 2013) show that in desert areas, characterized by high soiling conditions and high airborne dust concentrations, the PV performances can reduce up to some percentage points a day, while in the more temperate areas the reduc- tion is usually between 1% and 10% a year. Studies on sev- eral PV plants located in Europe (Stridh, 2011) and in North America (Brooks et al., 2013; Cano et al., 2014) point out that average soiling loss in energy yield are little and tilt- dependant: about 6% a year for horizontal or low tilted PV generators and 2% a year for PV generators tilted at optimum angle (about 30\u0003). Despite soiling depends on several environmental and technical factors, models for predicting photovoltaic energy generation including dust eﬀects have been developed (Qasem et al., 2011). When soiling has a signiﬁcant impact on PV power production, dust eﬀects can be added to the models to forecast energy production. In this work, soiling is not included because the PV modules installed in SolarTechLab are self-cleaning and it was veriﬁed that no signiﬁcant amount of dust was accumulated during the whole measurement campaign. 2.3. PV cell thermal models Junction temperature depends on several parameters as actual irradiance on the cell (GTOT), ambient temperature (Tamb), wind speed and direction. In the PV cell perfor- mance testing, the modeling of the cell itself is the easiest part, while the measurement of the actual irradiance and the cell temperature is the most diﬃcult task. Actual irradi-ance, and also its components, can be measured with sen-sors like reference cells or pyranometers. The temperature measurement of a cell cannot be done directly, especially if it is in a PV module and it is incorporated in the Ethyl Vinyl Acetate (EVA). Actual cell temperature can be accu-rately estimated by using a thermocouple on the back side of the module (IEC60891, 2010), and/or by using a thermal imaging camera suitably calibrated. Actually, in the exper- imental measurements carried out in this work, both have been used. Cell temperature can also be evaluated starting from the measurement ambient parameters. Two diﬀerent models are available: the easiest one is based on the NOCT which is the cell operating temperature at given conditions (Tamb@NOCT = 20 \u0003C, GNOCT = 800 W/m 2, wind speed = 1 m/s and module placed on a surface, then in the absence of thermal convection on the back); typical NOCT are in the range of 40–50 \u0003 C. The calculation of the actual cell temperature (TC) is based assuming that the diﬀerence between cell and ambient temperature (TC \u0002 Tamb) is pro- portional with the irradiance (GTOT) (Luque and Hegedus, 2013; Nelson, 2003). This correlation is reported in Eq. (20) T C ¼ T amb þ ðNOCT \u0002 T amb@NOCT Þ GNOCT \u0003 GTOT ð20Þ A more complex model based on experimental measure- ments, which takes into account module installation and wind cooling eﬀect, was developed by Sandia (Fuentes, 1985). The equation of the Sandia thermal model is as follows: T C ¼ T amb þ GTOT \u0003 eaþb\u0003WS ð21Þ where WS (m/s) is the wind speed at a standard attitude of 10 m, a is an experimental coeﬃcient which correspond to the module temperature with high irradiance and no wind, while b indicates the impact of the wind over the cell tem- perature. This model has an accuracy of 95%, which corre- sponds to an error on the energy production prediction of 3% (Fuentes, 1985). These two empirical coeﬃcients were calculated with a linear regression of thousands of experi- mental measurements. Since a and b showed a strong dependence on several parameters (see Table 1), they must be determined for each plant in order to make a reliable prediction. In this work, the coeﬃcients used correspond to a Glass/silicon cells/polymeric layer and an open rack as for the model installed. In the future, a control experi-ment will be performed, however this is beyond the aim of this work. 3. Experimental set-up The experimental activities were carried out at the labo- ratory SolarTechLab SolarTech Lab, 2013), Politecnico di Milano, whose geographical coordinates are latitude 45.502941 \u0003 N and longitude 9.156577 \u0003 E. Fig. 5 shows a panoramic image of the PV modules installed at the SolarTechLab. A total of 29 photovoltaic modules are installed: ten monocrystalline, eleven polycrystalline (from three diﬀer- ent manufactures) and ﬁve hybrids (photovoltaic and ther- mal, PVT). The rated power of the module ranges from 75 to 300 Wp. The I–V curve construction and power predic- tion have been carried out on one monocrystalline and one polycrystalline module by diﬀerent manufacturer both of nominal power equal to 245 Wp. The two modules have been installed for two years, therefore a certain decay in performances compared to datasheet values might be present. All modules are oriented as the structure with c equal to \u0002 6\u0003300 (assuming that 0\u0003 is the south direction and angles increase towards west). The connection to the grid is car- ried out by micro inverters, one for each module. This con- ﬁguration allows the electrical independence of each module and it results in the optimization of the production. The operating parameters of each micro inverter are trans-ferred in real time, using wireless connection, to a PC to store them. The energy ﬂows between the PV system and the electrical grid are measured by an energy meter whose accuracy class is 0.5 for the active power; its ratings and metrological characteristics are reported in Table 2. The environmental conditions are monitored with a meteorological station equipped with a solar irradiance sensor, temperature-humidity sensors, wind speed/direc- tion sensor and rain collector. For the development of PV predictive models, the solar irradiance, the wind speed and ambient temperature measures are necessary. Solar irradiance is measured with three diﬀerent sensors: a net radiometer for the measurement of the Direct Normal Irradiance (DNI) and two pyranometers for the measure- ment of the total and diﬀuse irradiance on horizontal plane. The main characteristics of the sensors together with the temperature measuring equipment are reported in Table 3. The meteorological station performs ambient con- ditions measurements every few seconds. The average, maximum, minimum and standard deviation of the mea- sured values by the sensors are calculated every ten minutes and these values are stored into a database. These average values are used for the evaluation of PV performances. Table 1 a and b coeﬃcients for diﬀerent modules and installations (Fuentes, 1985). Type of module Installation ab Glass/silicon cells/glass Open rack \u00020.35 \u00020.0594 Glass/silicon cells/glass Close roof mount \u00022.98 \u00020.0471 Glass/silicon cells/polymeric layer Open rack \u00023.56 \u00020.0750 Glass/silicon cells/polymeric layer Insulated back \u00022.81 \u00020.0455 Polymeric layer/thin ﬁlm/stainless steel Open rack \u00023.58 \u00020.1130 Fig. 5. Panoramic image of the Solar Tech facility. Table 2 Energy meter ratings and metrological characteristics. Nominal voltage Vn 3 \u0005 230/400 Vac (direct insertion) Current ratings Maximum current Imax: 60 Aac (direct insertion) Measurement channels impedance: Voltage inputs: 1 MOhm Current inputs: negligible 50/60 Hz networks measures Phase-neutral/phase-phase voltages Phase currents Active, reactive and apparent power cosU and PF Consumed and generated active energy Consumed and generated reactive energy: four quadrants Frequency Accuracy: Active energy: class 1 (class 0.5 on request) Reactive energy: class 2 The characterization of PV modules is carried out by the measurement of their I–V characteristic and the module temperature. Electric measurements were performed using prototype and market-available measuring equipment, coordinated by a PC. The operating principle of the mea- surement instrument is illustrated through the block dia- gram shown in Fig. 6. Before the beginning of the test, the capacitor C is kept uncharged by connecting them with the resistor Rdis, through S2. The test starts by opening S2 and just after closing S1. The current produced by the PV module charge the capacitor until voltage reaches the open circuit voltage of the PV module. The test stops about 0.5 s after the closing of S1. The capacitance is sized to ensure that the test duration is about 0.2 s when the irradiance is 1000 W/m2 and the PV module short circuit current is about 8 A, allowing completing the test even if the irradiance is less than 1000 W/m2. At the end of the test, S1 opens and S2 closes, discharging the capacitor on the dissipation resistor Rdis and bringing the hardware in the conditions necessary to start a new test. The control unit automatically manages the switching devices. During test, the pairs of voltage and current are mea- sured and stored by a network analyzer. The analyzer is equipped with 12-bit A/D converters that simultaneously sample the voltage and current signals at the rate of 12.5 kSamples/s. The voltage measurement is direct, while current measurement is through the shunt resistor Rshunt. Table 4 reports the accuracy of the network analyzer input channels. The PC, interfaced with the instrument management software, coordinates the measuring systems: it controls Table 3 Solar irradiance and temperature sensor characteristics. Net radiometer (LSI, DPD504) Pyranometer (LSI, DPA253) Irradiance sensors Measurements range (W/m 2) <2000 <2000 Spectral range 0.3–60 lm 305–2800 nm Total achievable daily uncertainty <5% <5% Non-linearity <1.5% <4% Thermal drift <2% <1.2% Temperature and humidity sensor (LSI, DMA 875) Temperature sensor Pt100 1/3 DIN B Measurements range \u000230 to +70 \u0003C Uncertainty 0.2 \u0003C(0 \u0003C) Resolution 0.04 \u0003C Response time (T90) 3 min: with ﬁlter; 20 s: without (air speed 0.2 m/s) Fig. 6. Measurement equipment recording the PV characteristics. Table 4 Characteristic data of the measurement equipment. Full scale (FS) Accuracy 1–10% of FS 10–130% of FS 130–150% of FS Voltage input 100 V 1 V 100 mV 1 V Current input 3 V 30 mV 3 mV 30 mV 90 A. Dolara et al. / Solar Energy 119 (2015) 83–99 the on/oﬀ sequence of the switches and the download and store of the measured data at the end of each test. At the beginning and at the end of the measurement campaign, the calibration of the network analyzer was ver- iﬁed with a voltage and current source whose accuracies are 0.25% + 10 mV and 0.25% + 10 mA, respectively. During the I–V characteristic measurement, the cell tem- perature was measured using both a thermal imaging cam- era previously calibrated and four thermocouples placed on the back of the PV panels. The four thermocouples have been placed according to the normative (IEC60891, 2010) on the back of the panel in the center, at the top-center, mid-right and bottom-left. 4. VI module parameter The aim of this work is the comparison of three diﬀerent physical models to forecast the power produced by PV sys- tem based on monocrystalline and polycrystalline silicon. Therefore, the abovementioned models were calibrated on data reported in the datasheet or with experimental measurements carried out at SolarTech Lab at Politecnico di Milano (SolarTech Lab, 2013). The number of equations required to calibrate the model depends on the number of parameters. The following description will deal on the calibration of the ﬁve-parameter model; the other two models are subsets of this. The approaches adopted for the derivation of the parameters follow the methodology presented in (Cubas et al., 2014). It can be outlined that several other proce- dures are available in literature to determine the ﬁve-parameter (Blair et al., 2013; De Soto et al., 2006; Laudani et al., 2013; Lejeune and Mermoud, 2010). In (Laudani et al., 2013), the ﬁve-parameter model is derived from the De Soto’s approach (De Soto et al., 2006), improving the eﬃciency of the solution algorithm. Latest, (Blair et al., 2013) presented a comparison of diﬀerent pho- tovoltaic model options and the results obtained with them. Out of all these procedures, the calibration method adopted in this work has good accuracy for the considered PV modules with fast computation. Moving to the parameters calculation, when the model- ing is applied to a module composed by more than one cells, Eq. (2) slightly changes into Eq. (22) I ¼ I PV \u0002 I 0 \u0003 e V þRS;m \u0003I n\u0003NS \u0003V t \u0002 1 \u0004\u0005 \u0002 V þ RS;m \u0003 I RSH ;m ð22Þ being Ns the number of cells in series, RS,m and RSH,m the module series and shunt resistances, respectively, that are obtained by multiplying by Ns the cell series (RS,c) and shunt (RSH,c) resistances. In this particular case, the num- ber of cells in series is equal to 60 for both the monocrys- talline and polycrystalline modules. This equation can be evaluated in the three characteris- tics point of the I–V curve (Ahemd El Tayyan, 2011; Villalva et al., 2009): open circuit voltage (0, VOC), short circuit current (ISC, 0) and maximum power point (IMPP, VMPP)asin (23)–(25). 0 ¼ I PV \u0002 I 0 \u0003 e V OC n\u0003N S \u0003V t \u0002 1 \u0002\u0003 \u0002 V OC RSH ;m ð23Þ I SC ¼ I PV \u0002 I 0 \u0003 e RS;m \u0003ISC n\u0003NS \u0003V t \u0002 1 \u0004\u0005 \u0002 RS;m \u0003 I SC RSH ;m ð24Þ I MPP ¼ I PV \u0002 I 0 \u0003 e V MPP þRS;m \u0003IMPP n\u0003N S \u0003V t \u0002 1 \u0004\u0005 \u0002 V MPP þ RS;m \u0003 I MPP RSH ;m ð25Þ The values VOC, ISC, VMPP and IMPP in (23)–(25) are derived from the measured I–V characteristic, reporting the measured values to STC. In case of the experimental curves, they are calculated as the average of ten diﬀerent measurements performed in few minutes to reduce errors related to sun irradiance measurements (pyranometer is the less accurate instrument). The calibration of the three-parameter model consist in the calculation of the parameters IPV,I0, and n, which is carried out by solving the system of Eqs. (23)–(25) consid- ering RS,m = 0 and RSH,m = 1. The calibration of the series resistance RS,m can be per- formed by setting the derivative of the power at maximum power point equal to zero (see Eq. (26)) @P @V \b \b \b \bMPP ¼ 0 ð26Þ While the previous four equations are used to calibrate the models by all the authors, there are diﬀerent equations, which can be used to calculate the Shunt resistance. In this work, the slope of the I–V curve at short circuit current conditions (Sera et al., 2007) is assumed as dependent only on RSH,m as in (27): @I @V \b \b \b \bSC ¼\u0002 1 RSH ;m ð27Þ Another equation, which can be considered, focuses on the derivative of the open voltage with respect to the tem- perature (De Soto et al., 2006). The calibration of the parameters based on the experi- mental measurements was also performed with a ﬁtting approach: instead of using only ﬁve conditions, the whole I–V curve is used leading to results which should be more reliable. The comparison between datasheet values of VOC, ISC, VMPP, IMPP and the ones PMPP obtained by experimental measurements and reported to STC is shown in Table 5. While monocrystalline suﬀer of ISC decay and power loss of about 3%, the polycrystalline have lower VOC and power loss of about 5%. Therefore, the calculated parameters from experimental measurements will include the real per- formance decay of the PVs due to the exposure to solar radiation, while it will not be the case starting from the datasheet case. For consistency, the decay will be applied A. Dolara et al. / Solar Energy 119 (2015) 83–99 91 also in the datasheet case applying the information avail- able in the datasheet itself. The resulting predicted power will be determined as expressed in Eq. (28): P p ¼ P model \u0003ð1 \u0002 decayyear \u0003 yearsÞð28Þ where Pp is the predicted power, Pmodel is the outcome of the forecast model, decayyear comes from the information available from datasheet 2 and years is the number of panel operating years. Table 6 summarizes the parameters to be adopted in the models previously described, both for monocrystalline and polycrystalline silicon modules. They are calculated in two ways: starting from the I–V measured characteristic (EXP.) and considering nominal values given in the datasheet (DAT.). In case of I–V measured characteristic, the cell parameters are derived both by ﬁtting and equations from (23)–(27) even if the former is considered more reliable using more points. Therefore, only the ﬁtting cases will be presented. In the characterization of the ﬁve-parameter model, sev- eral approaches are considered. Regarding the calculation of parameters from the measured I–V curve, case A shows the results where the whole parameters are derived by ﬁt- ting, while case B shows the results where Rsh is previously estimated as the negative reciprocal of the I–V slope at Isc and the remaining parameters are derived by ﬁtting. The calculation of the parameters from the values published on the datasheet takes into account the methodologies pre- sented in (Cubas et al., 2014). In case A, n is taken equal to 1.3 and the remaining parameters are calculated, while in case B, Rsh was initialized by an empirical estimation, and then the whole parameters are calculated. It can be noted that the characterization of the four-parameter model starting from the nominal values leads to values that have no physical meaning (monocrys- talline case) and/or the solution of the system of equations does not converge to the proximity of the expected values (polycrystalline case). Moreover the characterization of the ﬁve-parameter model of polycrystalline module starting from the datasheet values leads to parameters that have no physical meaning (case A) or that are far from the expected magnitude (case B). Only the parameters calculated with the latter approach are used to forecast the power produced. A sensitivity analysis showed that the calculated param- eters are strongly aﬀected by the set of data used to cali- brate the model. Fig. 7 shows, for comparison purposes, I–V curves for the three-, four- and ﬁve-parameter models based on exper- imental data (EXP.) and datasheet (DAT.). It shows that the PV cell models and the set of data used for their cali- bration aﬀect the resulting I–V curve. In addition, the parameters using the numerical approach starting from the experimental measurements Table 5 Measured and data sheet values of VOC, ISC, VMPP, IMPP and PMPP of the monocrystalline and polycrystalline silicon modules in STC. Monocrystalline Polycristalline Datasheet Measured Datasheet Measured VOC (V) 37.10 37.15 37.56 36.79 ISC (A) 8.48 8.37 8.27 8.25 VMPP (V) 31.3 30.4 31.38 30.25 IMPP (A) 7.84 7.84 7.81 7.71 PMPP (W) 245 238 245 233 Table 6 Calculated parameters for diﬀerent models and PV modules based on experimental data (EXP.) and datasheet (DAT.) @ STC. Three-parameter Four-parameter Five-parameter EXP. DAT. EXP. DAT. EXP. A EXP. B DAT. A DAT. B Monocrystalline Ipv (A) 8.521 8.480 8.689 8.480 8.642 8.659 8.481 8.485 ID (nA) 245.7 562.5 22.80 6621 22.44 15.60 75.07 4.261 n 1.395 1.457 1.233 1.712 1.233 1.208 1.300 1.126 RS,m (mX) – – 318 \u0002129.7 317 325 19.1 87.8 RSH,m (X) – – – – 82112 1054 215.5 150.8 Polycrystalline Ipv (A) 8.313 8.270 8.508 – 8.510 8.525 8.269 8.289 ID (nA) 501.3 195.7 2.330 – 4.133 1.658 59.83 144\u000310 \u00029 n 1.438 1.388 1.095 – 1.125 1.078 1.3000 0.6322 RS,m (mX) – – 400 – 388 405 75.6 363.3 RSH,m (X) – – – – 72123 1148 \u0002610.3 156.3 2 In datasheet, the decay is given for the expected lifetime of the PV panel (i.e. 20% in 25 years). For simplicity, the decayyear assumed is determined as simple ratio between the overall decay and over the lifetime. Other approaches can be adopted as well, but they require additional information/assumptions. 92 A. Dolara et al. / Solar Energy 119 (2015) 83–99 were also calculated. However, the values were less reliable (i.e. negative shunt resistance or ideality factor below one), therefore the calibration of the model starting from exper- imental data and equation approach will not be discussed further. 5. Error deﬁnition The aim of this paper is to compare diﬀerent physical models in forecasting PV energy production and determine their accuracy. The comparison is performed using actual weather information (ambient temperature and solar irra- diance) measured by the weather station at SolarTech Lab. This decision was kept to neglect the weather forecast- ing error, hence comparing only the model accuracy. In order to correctly deﬁne the accuracy of the predic- tion and the relative error, it is necessary to deﬁne the error deﬁnition to be adopted. There is wide variety of error deﬁnitions and it is not easy to select the correct one. Also among the scientiﬁc Table 7 Calculated NMAE% and WMAE% for diﬀerent PV models of monocrystalline module. For each day the smallest error (green) and the highest error (red) are highlighted. NMAE (%) WMAE (%) NMAE (%) WMAE (%) DAT. 2.18% 5.39% 1.20% 2.96% EXP. 0.89% 2.21% 1.93% 4.78% 4P EXP. 1.19% 2.95% 1.15% 2.84% DAT. A 1.77% 4.37% 1.17% 2.89% DAT. B 1.32% 3.28% 1.18% 2.93% EXP. A 1.31% 3.24% 1.06% 2.63% EXP. B 1.36% 3.36% 1.01% 2.49% DAT. 1.42% 9.88% 1.29% 8.96% EXP. 0.83% 5.76% 0.75% 5.23% 4P EXP. 0.53% 3.66% 0.59% 4.09% DAT. A 1.15% 7.98% 1.03% 7.11% DAT. B 0.77% 5.32% 0.71% 4.89% EXP. A 0.52% 3.63% 0.57% 3.95% EXP. B 0.52% 3.60% 0.57% 3.93% DAT. 2.64% 6.37% 1.24% 2.99% EXP. 0.98% 2.37% 1.43% 3.45% 4P EXP. 1.78% 4.28% 0.77% 1.85% DAT. A 2.23% 5.37% 0.94% 2.27% DAT. B 1.81% 4.37% 0.77% 1.86% EXP. A 1.92% 4.62% 0.79% 1.90% EXP. B 1.98% 4.77% 0.83% 2.01% DAT. 2.35% 5.86% 1.22% 3.05% EXP. 0.97% 2.43% 1.59% 3.98% 4P EXP. 1.37% 3.43% 0.76% 1.89% DAT. A 1.94% 4.85% 1.05% 2.63% DAT. B 1.51% 3.78% 0.93% 2.32% EXP. A 1.51% 3.77% 0.70% 1.75% EXP. B 1.57% 3.91% 0.68% 1.70% DAT. 2.25% 6.30% 1.95% 5.47% EXP. 1.83% 5.13% 2.30% 6.44% 4P EXP. 1.43% 4.00% 1.78% 4.99% DAT. A 1.97% 5.51% 1.89% 5.29% DAT. B 1.66% 4.65% 1.86% 5.20% EXP. A 1.53% 4.27% 1.71% 4.79% EXP. B 1.56% 4.36% 1.67% 4.68% DAT. 2.12% 5.66% 1.38% 3.68% EXP. 1.07% 2.85% 1.66% 4.45% 4P EXP. 1.04% 2.79% 0.99% 2.65% DAT. A 1.72% 4.61% 1.22% 3.27% DAT. B 1.28% 3.42% 1.08% 2.89% EXP. A 1.17% 3.13% 0.93% 2.48% EXP. B 1.22% 3.25% 0.89% 2.37% 09/07/2014 1489.9 3P 5P 11/07/2014 1558.5 3P 5P 30/06/2014 1728.2 3P 5P 03/07/2014 1668.2 3P 5P 19/06/2014 1682.8 3P 5P 26/06/2014 635.8 3P 5P Day Energy produced (Wh) Model Source Monocrystalline NOCT SANDIA A. Dolara et al. / Solar Energy 119 (2015) 83–99 93 community there is no consensus and a lot of these indexes are adopted. Here we report some of the most common error deﬁnitions. The base of all the deﬁnitions is the hourly error eh, deﬁned as reported by (Ogliari et al., 2013): eh ¼ P m;h \u0002 P p;h ð29Þ where Pm,h is the average power produced (measured) in the hour and Pp,h is the given prediction provided by the forecasting model. Although Pm,h and Pp,h are deﬁned as a power, their numerical values also represent the energy, expressed in Wh, produced and forecasted in the hour. Therefore, the hourly error in (29) can be deﬁned consider- ing either W or Wh as measurement unit. Starting from the hourly error, the following deﬁnitions are available in literature (Monteiro et al., 2013; Ulbricht et al., 2013): \u0006 Absolute hourly error eh,abs, which is the absolute value of the previous deﬁnition (eh can give both positive and negative values): eh;abs ¼jehjð30Þ \u0006 Normalized mean absolute error NMAE%, based on net capacity of the plant (CN): NMAE% ¼ 1 N XN h¼1 jP m;h \u0002 P p;hj CN \u0003 100 ð31Þ where CN is the “net capacity of the plant”. N is the number of daylight hours. During nighttime, the forecast is meaningless. \u0006 Weighted mean absolute error WMAE%, based on total energy production: Table 8 Calculated NMAE% and WMAE% for diﬀerent PV models and days of polycrystalline module. For each day the smallest error (green) and the highest error (red) are highlighted. DAT. 0.91% 2.33% 1.58% 4.04% EXP. 1.41% 3.59% 1.35% 3.46% 4P EXP. 1.14% 2.92% 1.05% 2.68% DAT. B 1.58% 4.03% 2.98% 7.63% EXP. A 1.19% 3.05% 1.00% 2.56% EXP. B 1.11% 2.85% 1.07% 2.73% DAT. 0.81% 5.85% 0.71% 5.14% EXP. 0.94% 6.81% 0.83% 5.99% 4P EXP. 0.60% 4.32% 0.74% 5.34% DAT. B 1.24% 8.96% 1.37% 9.95% EXP. A 0.56% 4.05% 0.70% 5.08% EXP. B 0.61% 4.44% 0.75% 5.45% DAT. 1.14% 2.86% 1.39% 3.48% EXP. 1.67% 4.18% 1.11% 2.76% 4P EXP. 1.67% 4.18% 0.73% 1.82% DAT. B 1.41% 3.52% 2.93% 7.34% EXP. A 1.72% 4.31% 0.66% 1.66% EXP. B 1.65% 4.11% 0.76% 1.89% DAT. 1.03% 2.65% 1.41% 3.64% EXP. 1.52% 3.94% 1.14% 2.96% 4P EXP. 1.35% 3.50% 0.82% 2.12% DAT. B 1.53% 3.96% 2.90% 7.50% EXP. A 1.41% 3.63% 0.76% 1.96% EXP. B 1.33% 3.42% 0.85% 2.19% DAT. 1.63% 4.61% 1.10% 3.11% EXP. 2.06% 5.82% 1.18% 3.33% 4P EXP. 1.74% 4.91% 1.20% 3.41% DAT. B 1.62% 4.59% 2.28% 6.45% EXP. A 1.78% 5.03% 1.18% 3.34% EXP. B 1.73% 4.88% 1.21% 3.43% DAT. 1.10% 3.02% 1.51% 4.16% EXP. 1.50% 4.13% 1.42% 3.89% 4P EXP. 1.07% 2.95% 0.91% 2.50% DAT. B 1.70% 4.67% 2.77% 7.61% EXP. A 1.15% 3.15% 0.88% 2.41% EXP. B 1.04% 2.87% 0.92% 2.53% 09/07/2014 1473.7 3P 5P 11/07/2014 1513.8 3P 5P 30/06/2014 1665.8 3P 5P 03/07/2014 1612.3 3P 5P 19/06/2014 1628.8 3P 5P 26/06/2014 608.2 3P 5P NMAE (%) WMAE (%) NMAE (%) WMAE (%) Day Energy produced (Wh) Model Source Polycrystalline NOCT SANDIA 94 A. Dolara et al. / Solar Energy 119 (2015) 83–99 WMAE% ¼ PN h¼1jP m;h \u0002 P p;hj PN h¼1P m;h \u0003 100 ð32Þ \u0006 Normalized root mean square error nRMSE, based on the maximum produced power Pm,h: nRMSE ¼ ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 1 N \u0003 PN h¼1jP m;h \u0002 P p;hj 2 q maxðP m;hÞ \u0003 100 ð33Þ In this work, the results of the models will be expressed in terms of hourly error, NMAE% and WMAE%. 6. Performance prediction and results comparison Fig. 8 summarizes the overall methodology adopted for the comparison of the diﬀerent models. The methodology requires three diﬀerent types of input: (i) date and time of the measurements to determine the sun position, (ii) the meteorological conditions (ambient tem- perature, wind speed and solar irradiance) and (iii) the characteristics of the PV panel based on either experimen- tal measurements or datasheets. With these inputs and using the equations described in previous sections, the power output of PV panels can be forecasted. As already pointed out, the aim of the work is to com- pare diﬀerent forecast models, therefore the calculation is performed using actual weather measurements so that weather forecast errors can be neglected and errors can be appointed only to the adopted approaches. Obviously, the resulting NMAE% and WMAE% will be signiﬁcantly lower than other works (Monteiro et al., 2013; Ulbricht et al., 2013) where the weather forecast were used. The predicted power produced is then compared with the actual power output delivered by the modules, mea- sured by the inverters. Therefore, the diﬀerent accuracy of each model can be determined. This procedure is applied for six summer days: 19th,26th and 30th of June, 3rd,9th and 11th of July. Results will be presented in detail for the 26th of June (day characterized by low radiation) and 3rd of July (sunny day), while for the remaining only NMAE% and WMAE% will be reported. Fig. 9 shows the actual solar irradiance and average power produced by the modules for the two considered days. The sunny day have a peak power of 220 W, slightly lower for the polycrystalline modules, while in the cloudy day the peak power is about half of it. In the sunny day, it can be noted a quick drop in the power production at about 8:30 in the morning. This is because of a shadowing related to a tower crane located close to the lab. This is the typical case where the forecast based on physical model will fail, while it can be forecasted by statis- tical and artiﬁcial neural network methods after enough training period. Comparing the solar irradiance and DC power, ﬂuctuations in the latter are more frequent than solar irradiance just because of diﬀerent sampling time (one min- ute for the inverter and ten minutes for the weather station). Figs. 10–13 show the hourly errors for the investigated cases. Fig. 7. Comparison between I–V curves derived from experimental (EXP.) and nominal parameters (DAT.) for three- and ﬁve-parameter models (left mono, right poly) @STC. Table 9 Overall NMAE% and WMAE% for diﬀerent PV models applied in diﬀerent days and PV modules. For each day the smallest error (green) and the highest error (red) are highlighted. DAT. 2.15% 6.20% 1.38% 3.97% EXP. 1.10% 3.15% 1.60% 4.62% 4P EXP. 1.22% 3.50% 1.00% 2.89% DAT. A 1.79% 5.16% 1.22% 3.50% DAT. B 1.39% 4.00% 1.08% 3.12% EXP. A 1.32% 3.80% 0.96% 2.75% EXP. B 1.36% 3.91% 0.94% 2.70% DAT. 1.10% 3.26% 1.28% 3.79% EXP. 1.51% 4.49% 1.17% 3.46% 4P EXP. 1.26% 3.73% 0.91% 2.69% DAT. B 1.51% 4.48% 2.53% 7.51% EXP. A 1.30% 3.84% 0.86% 2.56% EXP. B 1.24% 3.67% 0.92% 2.74% 3P 5P 3P 5P NMAE (%) WMAE (%) NMAE (%) WMAE (%) Model Source NOCT SANDIA Monocrystalline Polycrystalline A. Dolara et al. / Solar Energy 119 (2015) 83–99 95 Fig. 8. Overview of the model comparison methodology adopted in this work. Fig. 9. Actual solar irradiance and average measured DC power produced on July 3 rd (left side) and June 26 th (right side). Fig. 10. Hourly error for monocrystalline module with diﬀerent PV models, July 3 rd. NOCT thermal model (left side) and Sandia (right side). 96 A. Dolara et al. / Solar Energy 119 (2015) 83–99 In general, all the models provide a reasonable accuracy in the forecasted power being the error below 15 W at any conditions. Results show that there is an inﬂuence on the accuracy of the forecast of the model adopted, the thermal model, the type of silicon cell and the set of data used for its cali- bration as follows. \u0006 The three-parameter accuracy for monocrystalline mod- ule strongly depend on the calibration data. In the sunny days, the calibration with datasheet leads to an underes- timation of the power produced, while it is the opposite with the experimental data. With low irradiance, even the calibration with experimental data leads to an underestimation. On the contrary, in the polycrystalline modules results are slightly aﬀected by the calibration method. \u0006 The ﬁve-parameter approach for monocrystalline mod- ules is more aﬀected by the thermal model rather than the calibration approach. Errors among the four cases presented (5PA-EXP, 5PA-DAT, 5PB-EXP, 5PB-DAT) are very small. In polycrystalline modules, on the contrary, the calibration with datasheet can lead to signiﬁcant errors. 5PA-DAT has the highest error among all cases particularly with Sandia thermal model. \u0006 The four-parameter model behave like the ﬁve-parameter with the same error trends. The addition of Rsh to the electric model (i.e. moving from Fig. 11. Hourly error for monocrystalline module with diﬀerent PV models, June 26 th. NOCT thermal model (left side) and Sandia (right side). Fig. 12. Hourly error for polycrystalline module with diﬀerent PV models, July 3 rd. NOCT thermal model (left side) and Sandia (right side). Fig. 13. Hourly error for polycrystalline module with diﬀerent PV models, June 26 th. NOCT thermal model (left side) and Sandia (right side). A. Dolara et al. / Solar Energy 119 (2015) 83–99 97 four-parameter to ﬁve-parameter) has very limited inﬂu- ence on forecasted power. \u0006 The forecasted power output assuming Sandia thermal model is higher than the NOCT one, because of the lower cell temperature forecasted by the former (see Fig. 14). The inﬂuence on the forecasted power output of the cell temperature can be seen comparing the cen- tral hours of the two investigated days when the temper- ature diﬀerence by the two models is the largest. \u0006 The three-parameter model calibrated from datasheet can perform better than ﬁve-parameter depending on the accuracy of the information adopted for the calibra- tion. The datasheet information could be not enough accurate to calibrate the ﬁve-parameter model (polycrys- talline case) leading to higher errors. \u0006 Simple models (three-parameter) can be as accurate as more complex ones (four- or ﬁve-parameter). \u0006 In July 3rd, at eight, all the models show a quick error variation (i.e. reduction) suggesting a power produced lower than forecasted. This is because of the shadowing issue mentioned above. Moving to the overall daily error calculated with NMAE% and WMAE%, it can be noted that the error is small in every case (see Tables 7 and 8). This is because cal- culations are performed from actual weather conditions measured at the facility, therefore neglecting weather fore- cast errors which are usually signiﬁcant. Typical values of NMAE% and WMAE% for accurate forecasting models are 15% and 30% respectively (Monteiro et al., 2013; Ulbricht et al., 2013). As general considerations, no signif- icant advantages of an increasing PV cell model complexity can be outlined and the best thermal approach depends on the type of panel as well as electrical model considered (see Table 9). It cannot be drawn a line about the best approach also considering that most of the error in the forecast models is related to the weather forecast rather than the PV perfor- mances. Therefore, diﬀerences in accuracy among the model can disappear when real weather information are taken into account. 7. Conclusions This paper investigated diﬀerent physical models to forecast the power produced by monocrystalline and poly- cristalline PV panels. Three models, based on three, four and ﬁve parameters, were considered together with two dif- ferent approaches to determine the PV cell temperature. Models calibration was both performed using available data from the module datasheet as well as experimental measurements at the SolarTechLab. The comparison was performed using actual weather data measured by a meteorological station in the facility, therefore the analysis neglected weather forecast errors and focused only on the accuracy of the electrical models. Results showed that rather than its complexity, the accuracy of the model depends on (i) the data used for its calibration and (ii) the approach adopted for the calcu- lation of the cell temperature. In general, the adoption of ﬁve-parameter model requires a detailed set of information for its calibration which is usually not available in actual datasheets. Focusing on the normalized mean absolute error and weighted mean absolute error, they can be even lower than 1% and 2% respectively, which is a good result; neglecting weather errors, the physical approach proposed in this work can predict the power produced by PV panels with high accuracy (<2% of error). Moreover, this approach does not need any training per- iod as for artiﬁcial neural network based forecast models, making it suitable for the initial period of a plant. If these physical models are used to forecast the production for sev- eral years, recalibration of the parameters every one or two years should be taken into account to consider the actual PV performance decay. Compared to neural based forecast models, this will never predict power decay as consequence of shadowing, as at half past eight in SolarTechLab facility, in this case corrections must be implemented as corrective coeﬃcients on the resulting power output. Future works will deal on the comparison of this model with neural based ones. Fig. 14. Module temperature prediction with NOCT and Sandia model for July 3 rd (left side) and June 26 th (right side). 98 A. Dolara et al. / Solar Energy 119 (2015) 83–99 References Ahemd El Tayyan, A., 2011. PV system behavior based on datasheet. J. Electron. Dev. 9, 335–341. Blair, N.J., Dobos, A.P., Gilman, P., 2013. Comparison of Photovoltaic Models in the System Advisor Model Preprint, (August). Brooks, A.E., DellaGiustina, D.N., Patterson, S.M., Cronin, A.D., 2013. The consequence of soiling on PV system performance in Arizona; Comparing three study methods. In: 2013 IEEE 39th Photovoltaic Specialists Conference (PVSC), pp. 0754–0758. http://dx.doi.org/10. 1109/PVSC.2013.6744259. Cano, J., John, J.J., Tatapudi, S., TamizhMani, G., 2014. Eﬀect of tilt angle on soiling of photovoltaic modules. In: 2014 IEEE 40th Photovoltaic Specialist Conference (PVSC), pp. 3174–3176. http:// dx.doi.org/10.1109/PVSC.2014.6925610. Celik, A.N., 2011. Artiﬁcial neural network modelling and experimental veriﬁcation of the operating current of mono-crystalline photovoltaic modules. Sol. Energy 85 (10), 2507–2517. http://dx.doi.org/10.1016/ j.solener.2011.07.009. Celik, A.N., Acikgoz, N., 2007. Modelling and experimental veriﬁcation of the operating current of mono-crystalline photovoltaic modules using four- and ﬁve-parameter models. Appl. Energy 84 (1), 1–15. http://dx.doi.org/10.1016/j.apenergy.2006.04.007. Ciulla, G., Lo Brano, V., Di Dio, V., Cipriani, G., 2014. A comparison of diﬀerent one-diode models for the representation of I–V characteristic of a PV cell. Renew. Sustain. Energy Rev. 32, 684–696. http:// dx.doi.org/10.1016/j.rser.2014.01.027. Cubas, J., Pindado, S., Victoria, M., 2014. On the analytical approach for modeling photovoltaic systems behavior. J. Power Sources 247, 467– 474. http://dx.doi.org/10.1016/j.jpowsour.2013.09.008. De Blas, M., Torres, J., Prieto, E., Garcı´a, A., 2002. Selecting a suitable model for characterizing photovoltaic devices. Renewable Energy 25 (3), 371–380. http://dx.doi.org/10.1016/S0960-1481(01)00056-8. De Soto, W., Klein, S.A., Beckman, W.A., 2006. Improvement and validation of a model for photovoltaic array performance. Sol. Energy 80 (1), 78–88. http://dx.doi.org/10.1016/j.solener.2005.06.010. Dobos, A.P., 2012. An improved coeﬃcient calculator for the california energy commission 6 parameter photovoltaic module model. J. Sol. Energy Eng. 134 (2), 021011. http://dx.doi.org/10.1115/1.4005759. Duﬃe, J.A., Beckman, W.A., 1991. Solar Engineering of Thermal Processes, second ed. New York: John Wiley & Sons Inc. Durgadevi, A., Arulselvi, S., Natarajan, S.P., 2011. Photovoltaic modeling and its characteristics. In: 2011 International Conference on Emerging Trends in Electrical and Computer Technology, pp. 469–475. http:// dx.doi.org/10.1109/ICETECT.2011.5760162. Farret, F.A., Lenz, J.M., Trapp, J.G., 2011. New methodology to determinate photovoltaic parameters of solar panels. In: XI Brazilian Power Electronics Conference, pp. 275–279. http://dx.doi.org/10.1109/ COBEP.2011.6085281. Fuentes, K., 1985. A simpliﬁed thermal model of photovoltaic modules. Albuquerque, NM, US. Hocaoglu, F., Gerek, O., Kurban, M., 2008. Hourly solar radiation forecasting using optimal coeﬃcient 2-D linear ﬁlters and feed-forward neural networks. Sol. Energy 8, 714–726. Houabes, M., 2010. PV cell 5P modeling with shunt resistance correction. In: EFEEA 10th International Symposium on Environment Friendly Energies in Electrical Applications, pp. 1–5. IEC60891, 2010. Photovoltaic Devices. Procedures for Temperature and Irradiance Corrections to Measured IV Characteristics. IEC 60891. Izgi, E., Oztopal, A., Yerli, B., Kaymak, M., Sahin, A., 2012. Short-mid- term solar power prediction by using artiﬁcial neural networks. Sol. Energy 86 (2), 725–733. Laudani, A., Mancilla-David, F., Riganti-Fulginei, F., Salvini, A., 2013. Reduced-form of the photovoltaic ﬁve-parameter model for eﬃcient computation of parameters. Sol. Energy 97, 122–127. http:// dx.doi.org/10.1016/j.solener.2013.07.031. Lejeune, T., Mermoud, A., 2010. Performance assessment of a simulation model for pv modules of any available, (September), pp. 6–10. Lineykin, S., Averbukh, M., Kuperman, A., 2014. An improved approach to extract the single-diode equivalent circuit parameters of a photo- voltaic cell/panel. Renew. Sustain. Energy Rev. 30, 282–289. http:// dx.doi.org/10.1016/j.rser.2013.10.015. Lo Brano, V., Orioli, A., Ciulla, G., Di Gangi, A., 2010. An improved ﬁve-parameter model for photovoltaic modules. Sol. Energy Mater. Sol. Cells 94 (8), 1358–1370. http://dx.doi.org/10.1016/j.solmat. 2010.04.003. Luque, A., Hegedus, S., 2013. Handbook of Photovoltaic Science and Engineering. (Wiley, Ed.). Ma, J., Man, K.L., Ting, T.O., Zhang, N., Guan, S.-U., Wong, P.W.H., 2013. Approximate single-diode photovoltaic model for eﬃcient I–V characteristics estimation. Sci. World J. 2013, 230471. http:// dx.doi.org/10.1155/2013/230471. Ma, T., Yang, H., Lu, L., 2014. Development of a model to simulate the performance characteristics of crystalline silicon photovoltaic mod- ules/strings/arrays. Sol. Energy 100, 31–41. http://dx.doi.org/10.1016/ j.solener.2013.12.003. Mellit, A., Massi Pavan, A., 2010. A 24-h forecast of solar irradiance using artiﬁcial neural network: Application for performance prediction of a grid-connected PV plant at Trieste, Italy. Solar Energy 84 (5), 807–821. Monteiro, C., Fernandez-Jimenez, A., Ramirez-Rosadoc, I., Munoz- Jimenez, A., Lara-Santillan, P., 2013. Short-term forecasting models for photovoltaic plants: analytical versus soft-computing techniques. Mathematical Problems in Engineering, Article ID, 9. Nelson, J., 2003. The Physics of Solar Cells. Imperial college press, London. Ogliari, E., Grimaccia, F., Leva, S., Mussetta, M., 2013. Hybrid predictive models for accurate forecasting in PV systems. Energies 6 (4), 1929–2013. Qasem, H., Betts, T.R., Mullegans, H., Al Busairi, H., Gottschaig, R., 2011. Dust eﬀect on PV modules. In: Proceedings of the 7th photovoltaic science application and technology conference (PVSAT- 7), Edinburgh, UK. <http://www.pvsat.org.ukS>. Rodrigues, E., Melı´cio, R., Mendes, V., Catala˜o, J., 2011. Simulation of a solar cell considering single-diode equivalent circuit model. In: International Conference on Renewable Energies and Power Quality. Spain, 13–15 April 2011. Rus-Casas, C., Aguilar, J.D., Rodrigo, P., Almonacid, F., Pe´rez-Higueras, P.J., 2014. Classiﬁcation of methods for annual energy harvesting calculations of photovoltaic generators. Energ. Convers. Manage. 78, 527–536. http://dx.doi.org/10.1016/j.enconman.2013.11.006. Sarver, T., Al-Qaraghuli, A., Kazmerski, L.L., 2013. A comprehensive review of the impact of dust on the use of solar energy: history, investigations, results, literature, and mitigation approaches. Renew. Sustain. Energy Rev. 22, 698–733. http://dx.doi.org/10.1016/j.rser. 2012.12.065. Sera, D., Teodorescu, R., Rodriguez, P., 2007. PV panel model based on datasheet values. In: IEEE International Symposiums on Industrial Electronics, pp. 2392–2396. Shongwe, S., Hanif, M., 2015. Comparative analysis of diﬀerent single- diode PV modeling methods. IEEE J. Photovoltaics 5 (3), 938–946. http://dx.doi.org/10.1109/JPHOTOV.2015.2395137. SolarTech Lab, 2013. <www.solartech.polimi.it>. Stridh, B., 2011. Evaluation of economical beneﬁt of cleaning of soiling and snow in PV plants at three European locations, pp. 1448–1451. Tossa, A.K., Soro, Y.M., Azoumah, Y., Yamegueu, D., 2014. A new approach to estimate the performance and energy productivity of photovoltaic modules in real operating conditions. Sol. Energy 110, 543–560. http://dx.doi.org/10.1016/j.solener.2014.09.043. Ulbricht, R., Fisher, F., Lehner, W., Donker, H., 2013. First Steps Towards a Systematical Optimized Strategy for Solar Energy Supply Forecasting. In European Conference on Machine Learning and Principles and Practice of Knowledge Discovery in Databases. Prague, September 23th to 27 th. Villalva, M., Gazoli, J., Filho, E., 2009. Comprehensive approach to modeling and simulation of photovoltaic arrays. IEEE Trans. Power Electron. 24, 5. A. Dolara et al. / Solar Energy 119 (2015) 83–99 99","libVersion":"0.3.2","langs":""}