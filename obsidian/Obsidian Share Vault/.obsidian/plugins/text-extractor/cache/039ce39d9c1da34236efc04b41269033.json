{"path":"lit/lit_sources.backup/Yu23BatterySOHPrediction.pdf","text":"Citation: Yu, Z.; Liu, N.; Zhang, Y.; Qi, L.; Li, R. Battery SOH Prediction Based on Multi-Dimensional Health Indicators. Batteries 2023, 9, 80. https://doi.org/10.3390/ batteries9020080 Academic Editor: Federico Baronti Received: 22 December 2022 Revised: 16 January 2023 Accepted: 20 January 2023 Published: 24 January 2023 Copyright: © 2023 by the authors. Licensee MDPI, Basel, Switzerland. This article is an open access article distributed under the terms and conditions of the Creative Commons Attribution (CC BY) license (https:// creativecommons.org/licenses/by/ 4.0/). batteries Article Battery SOH Prediction Based on Multi-Dimensional Health Indicators Zhilong Yu 1, Na Liu 1,*, Yekai Zhang 1, Lihua Qi 1 and Ran Li 2 1 College of Automation, Harbin University of Science and Technology, Harbin 150080, China 2 System Integration Engineering Research Center, School of Electrical and Electronic Engineering, Harbin University of Science and Technology, Harbin 150080, China * Correspondence: liuna202211@163.com; Tel.: +86-188-4515-5632 Abstract: Battery capacity is an important metric for evaluating and predicting the health status of lithium-ion batteries. In order to determine the answer, the battery’s capacity must be, with some difﬁculty, directly measured online with existing methods. This paper proposes a multi-dimensional health indicator (HI) battery state of health (SOH) prediction method involving the analysis of the battery equivalent circuit model and constant current discharge characteristic curve. The values of polarization resistance, polarization capacitance, and initial discharge resistance are identiﬁed as the health indicators reﬂective of the battery’s state of health. Moreover, the retention strategy genetic algorithm (e-GA) selects the optimal voltage drop segment, and the corresponding equal voltage drop discharge time is also used as a health indicator. Based on the above health indicator selection strategy, a battery SOH prediction model based on particle swarm optimization (PSO) and LSTM neural network is constructed, and its accuracy is validated. The experimental results demonstrate that the suggested strategy is accurate and generalizable. Compared with the prediction model with single health indicator input, the accuracy is increased by 0.79%. Keywords: lithium-ion batteries; health indicator; state of health; long short-term memory 1. Introduction Under the burden of the energy crisis, the hunt for safe, clean, and efﬁcient energy conversion and storage technologies has risen to the forefront of the scientiﬁc research com- munity. As a storage and conversion carrier of electrical energy [1], lithium-ion batteries are extensively employed in electronic devices and systems because of their advantages of high safety, many-cycle lifespan, low pollution, and low self-discharge rate. However, during the cycling process, the battery’s internal structure will change with the accumulation of battery uses, increasing the battery’s internal resistance [2] and the capacity decay degradation. Aging lithium-ion batteries can cause a decline in the functionality of electronic devices and bring safety hazards. Battery health status is an important indicator that reﬂects the degree of battery deterioration and aging and that may be used as a reference indicator for the replacement and recycling of deteriorated batteries so that the system can continue to work properly and avoid incidents [3]. Current lithium-ion battery health state prediction research has made signiﬁcant strides, and several novel methodologies and techniques have been developed that can effectively improve the accuracy of lithium-ion battery health state prediction. Battery health state prediction methods are divided into two major categories [4], namely, model- based prediction methods [5–7] and data-driven prediction methods [8–10]. Data-driven prediction methods for lithium-ion battery SOH are the most widely used prediction methods at home and abroad; the data-driven methods include Support Vector Machine (SVM) [11,12], Gaussian Process Regression (GPR) [13–15], Relevance Vector Machine (RVM) [16–18], and neural network methods [19–21], etc. The data-driven prediction Batteries 2023, 9, 80. https://doi.org/10.3390/batteries9020080 https://www.mdpi.com/journal/batteries Batteries 2023, 9, 80 2 of 20 methods based on the complicated chemical processes occurring within the battery do not need to be considered and are more generic. The degradation of lithium-ion batteries is often expressed by a drop in battery capacity as the number of charge/discharge cycles increases, and the remaining battery capacity can serve as an indicator of the battery’s health. However, battery capacity data is typically impossible to collect directly online; hence, indirect health indicators are derived to predict the battery’s remaining capacity and reﬂect the battery’s health status. Wei et al. [22] selected battery capacity as the variable indicating the battery’s health status and used a support vector regression-based method to estimate the battery’s SOH. However, battery capacity is difﬁcult to measure directly, and the metric lacks real-time capability. Hu et al. [23] selected the sample entropy of discharge, voltage sample entropy, as the health indicator and Huang et al. [24] selected equal voltage rise interval as the health indicator, but extracting the health indicator only from a single scale does not reﬂect the different battery health states well and is insufﬁcient to predict complex capacity changes. The data-driven prediction method does not need to consider complex electrochemical characteristics but instead pulls health parameters that indicate the deterioration trend from raw data, learns through intelligent algorithms, and predicts SOH. Li et al. [25] extracted characteristic parameters from the capacity increment curve and established a model for estimate and prediction using the Gaussian process regression technique. However, the hyperparameter adjustment of the GPR algorithm is more complicated and involves many matrix inversion operations. The algorithm’s complexity is quite high and its size is huge; there is a limit to the quantity of training samples, and modeling is challenging. Zhang et al. [26] proposed using the accelerated particle swarm optimization algorithm to extract six new features from the cyclic charge and discharge cycle and develop an adaptive multi-core correlator SOH prediction model. However, due to the high sparsity of RVM, the prediction method based on RVM is often not stable enough; limited by its structure, the model is only good in short-term prediction. Tian et al. [27] proposed a method for extracting the temperature difference curve in the constant charging process as a health factor and using the SVM to establish a SOH model, but the SVM algorithm has limitations, in that it is difﬁcult to select a kernel function, and it is difﬁcult to handle when the data scale is too large. With the rapid advancement of machine learning and deep learning, neural networks are increasingly employed to predict battery SOH. Guo et al. [28] proposed a deep-learning- based lithium-ion battery capacity estimation method using recurrent neural network (RNN) to learn to predict the discharge voltage sequence of the battery. However, RNN suffers from intractable long-term reliance and restricted data input. Yin et al. [29] proposed a technique for a combined online estimate of battery SOC and SOH based on long- and short-term memory neural networks, the construction of LSTM neural network models, and the incorporation of stage SOH averages into the calculation of SOC to accomplish joint esti- mation. However, the LSTM prediction parameters are too many, and empirical parameter selection makes it difﬁcult to properly leverage the LSTM’s prediction capabilities. In the existing ﬁeld of battery health state prediction, the selection strategy of health factors greatly impacts the prediction model’s accuracy. In the current research, however, there are issues such as single health factor indications and long-term dependence on the algorithm. The battery’s intricate internal construction makes it difﬁcult to measure SOH directly. Therefore, this paper proposes a method for analyzing constant current discharge characteristics to extract multi-dimensional health indicators, including the extraction of health factors through the equivalent model of lithium-ion batteries and constant current discharge curves and the application of the e-GA algorithm to optimize the voltage drop segment of the TAB. Finally, four health factors are obtained as model input, and the hyperparameters of the LSTM model are optimized to predict the health status of the lithium-ion battery. Batteries 2023, 9, 80 3 of 20 2. PSO Algorithm and LSTM Neural Network 2.1. LSTM Neural Network [30] The decline of Li-ion batteries is a long-term continuous process, the state of the battery is correlated with between each charge/discharge cycle, and the relationship between the changes in the time series during the decline of battery should be fully considered when data-driven methods are used. Some existing methods only rely on the measurement data under the current cycle of the battery to evaluate the state of battery, without considering the change of battery state. Differently, LSTM recurrent neural network is a kind of neural network that takes the sequence data as input and recurs in the evolution direction of the sequence. Also, the model can be used to make prediction for long sequence data, which solves the problem that RNN is prone to gradient explosion or disappearance. The key for LSTM neural network to solve the long-term dependence problem is to add a complex “gate” structure to the normal RNN neural network to ﬁlter the redundant information and decide to perform an update or discard operation for each data. The sigmoid function is used as the activation function, and the output data in the sigmoid ranges between “1” and “0” (1 means complete retention and 0 means complete discard). The basic structure of LSTM is shown in Figure 1. A typical LSTM neuron consists of a forgetting gate ft, input gate it, and output gate ot. Batteries 2023, 9, x FOR PEER REVIEW 3 of 21 2. PSO Algorithm and LSTM Neural Network 2.1. LSTM Neural Network [30] The decline of Li-ion batteries is a long-term continuous process, the state of the bat- tery is correlated with between each charge/discharge cycle, and the relationship between the changes in the time series during the decline of battery should be fully considered when data-driven methods are used. Some existing methods only rely on the measure- ment data under the current cycle of the battery to evaluate the state of battery, without considering the change of battery state. Differently, LSTM recurrent neural network is a kind of neural network that takes the sequence data as input and recurs in the evolution direction of the sequence. Also, the model can be used to make prediction for long se- quence data, which solves the problem that RNN is prone to gradient explosion or disap- pearance. The key for LSTM neural network to solve the long-term dependence problem is to add a complex \"gate\" structure to the normal RNN neural network to filter the redundant information and decide to perform an update or discard operation for each data. The sig- moid function is used as the activation function, and the output data in the sigmoid ranges between \"1\" and \"0\" (1 means complete retention and 0 means complete discard). The basic structure of LSTM is shown in Figure 1. A typical LSTM neuron consists of a forgetting gate 𝑓𝑓𝑡𝑡, input gate 𝑖𝑖𝑡𝑡, and output gate 𝑜𝑜𝑡𝑡. σ σ σ tanh tanh Ct-1 ht-1 σ Ct σ σ tanh ht σ σ σ tanh tanh Ct+1 ht+1C t-1 ft it gt ot Ct tanh Input gate Forgetting gate Output gate Figure 1. LSTM structure diagram. The forgetting gate determines how much of the cell state from the previous moment is retained to the current moment cell state, and this information is processed by the sig- moid function. The forgetting gate is calculated as follows: 1( [ ,] )t f t t ff Wh x bσ −= + (1) The input gate is capable of selecting the key information to be stored in the internal state. The key information consists of two parts, and the first part determines the infor- mation to be updated. 1( .[ , ] )t it t ii Wh x bσ −= + (2) The second part adds the new information generated by the current input to the cell status and then updates the cell status. ~ 1tanh( .[ , ] )t ct t cC Wh x b−= + (3) ~ 1** t tt ttC f C iC−= + (4) The output gate calculates the current moment’s information output and retains the next hidden information. 1( .[ , ] )t ot t oo Wh x bσ −= + (5) Figure 1. LSTM structure diagram. The forgetting gate determines how much of the cell state from the previous moment is retained to the current moment cell state, and this information is processed by the sigmoid function. The forgetting gate is calculated as follows: ft = σ(Wf [ht−1, xt] + b f ) (1) The input gate is capable of selecting the key information to be stored in the inter- nal state. The key information consists of two parts, and the ﬁrst part determines the information to be updated. it = σ(Wi.[ht−1, xt] + bi) (2) The second part adds the new information generated by the current input to the cell status and then updates the cell status. ∼ Ct = tanh(Wc.[ht−1, xt] + bc) (3) Ct = ft ∗ Ct−1 + it ∗ ∼ Ct (4) The output gate calculates the current moment’s information output and retains the next hidden information. ot = σ(Wo.[ht−1, xt] + bo) (5) ht = ot ∗ tanh(ct) (6) Batteries 2023, 9, 80 4 of 20 where xt is the input at moment t; ht−1 is the output of the hidden layer at moment t − 1; ̃Ct is the amount of information brought by the new input; Wf , Wi, Wc, and Wo are the weight matrices of ft, it, ̃Ct, and ot, respectively; and b f , bi, bc, and b f are bo their bias terms, respectively. 2.2. Particle Swarm Optimization Algorithm [31] The particle swarm optimization algorithm is a typical swarm intelligence optimization algorithm. Similar to most swarm intelligence optimization algorithms, this algorithm initializes a group of solutions (particles) randomly and then updates them iteratively. This makes the whole population develop in the direction of better adaptive value, so as to ﬁnd the optimal solution to the problem in a limited number of iterative steps. PSO initializes its state as a group of randomly generated particles, and then the position of the particles is iteratively changed to ﬁnd the optimal solution. The math- ematical model of the particle swarm is as follows: Let the search space of the par- ticle swarm be D-dimensional, and the number of particles is n. A population X = (x1, x2, . . . , xm) is constituted, and any one Xid = (xi1, xi2, . . . , xiD) is selected in this population; at this time, the velocity vector is Vi = {vi1, vi2, . . . viD) ; the individual optimal position is Pid,pbest = (pi1, pi2, . . . piD); and the population optimal position is Pd,gbest = (p1,gbest, p2,gbest, . . . pD,gbest). The velocity and position change of each particle are shown as follows. vij(k + 1) = w.vij(k) + c1r1[pij(k) − xij(k)] − c2r2[pgj(k) − xij(k)] (7) xij(k + 1) = xij(k) + vij(k+1) (8) where c1 and c2 are learning factors as well as positive constants; w is the inertia weight; k is the number of iterations; and pij and pgj are the current particle population local optimal position and global optimal position, respectively. Since the decline of the lithium battery’s lifetime is a continuous process as well as a time series data, the LSTM model produces excellent results in time series prediction. However, the hyperparameters in the LSTM algorithm have a signiﬁcant impact on the accuracy of load prediction. Therefore, PSO is used to optimize the hyperparameters of LSTM. 3. SOH Prediction Feature Health Factor Extraction The internal chemical reaction of lithium battery aging and aging will be accompanied by the changes in capacitance and resistance, while the changes in resistance and capac- itance are often not quantiﬁable. Therefore, in practice, the battery capacity is reﬂected by direct or indirect health indicators. The health indicator can be the battery capacity, resistance, and other inherent parameters of the battery. Alternatively, it can be the time variation of the iso-voltage difference, the capacity increment curve, and the time when the battery temperature reaches its peak. In this paper, the selected health indicator is used as the input of the battery prediction model to build the battery SOH prediction model. 3.1. First-Order RC Equivalent Model for Lithium Batteries The lithium battery equivalent circuit consists of an ideal voltage source, a resistor and n RC loops. The ﬁrst-order and second-order RC equivalent circuit models are more accurate and reliable than other models. When the HPPC experimental environment is not needed, the ﬁrst-order RC equivalent circuit is advantageous in speed and in the outcome of identiﬁcation. The MAE and RMSE of terminal voltage and open circuit voltage as estimated by different models are shown in Table 1 [32]. Batteries 2023, 9, 80 5 of 20 Table 1. The correlation between different health indicators and capacity. First-Order RC Model Second-Order RC Model MAEV 0.00034 0.00033 RMSEV 0.00059 0.00057 MAEOCV 0.02176 0.02728 RMSEOCV 0.04258 0.07310 The ﬁrst-order RC equivalent circuit model of a lithium battery is shown in Figure 2 [33]. This model consists of a resistor, an ideal voltage source, and an RC loop. Batteries 2023, 9, x FOR PEER REVIEW 5 of 21 Table 1. The correlation between different health indicators and capacity. First-Order RC Model Second-Order RC Model MAEV 0.00034 0.00033 RMSEV 0.00059 0.00057 MAEOCV 0.02176 0.02728 RMSEOCV 0.04258 0.07310 The first-order RC equivalent circuit model of a lithium battery is shown in Figure 2 [33]. This model consists of a resistor, an ideal voltage source, and an RC loop. Figure 2. Equivalent circuit model. According to the equivalent model shown in Figure 2, the equivalent equation of the circuit can be obtained according to the Kirchhoff voltage and current law and other rele- vant knowledge: 01d ocvV V IR V= − − (9) 1 1 11 1 1 1 V VI RC C • = − + (10) where 𝑅𝑅0 is the battery ohmic internal resistance, 𝑅𝑅1 is the battery polarization internal resistance, 𝐶𝐶1 is the battery polarization capacitance, 𝑉𝑉𝑖𝑖 is the battery terminal voltage, 𝑉𝑉𝑜𝑜𝑐𝑐𝑜𝑜 is the battery open circuit voltage, 𝑉𝑉1 is the battery polarization voltage, and I is the battery charge and discharge current. By analyzing the change of terminal voltage in the three stages of discharge, it can be established that the discharge of lithium battery is the zero-step response stage when the terminal voltage 𝑉𝑉𝑖𝑖 changes over time, as shown in Equation (11). 11 01(1 ) t RC d ocvV V IR IR e − = − − − (11) The static stage after the discharge is the zero-input response stage. At this time, the formula of terminal voltage calculation is shown in Formula (12) and Formula (13), from which it can be seen that it will gradually decay to 0 after a period of time as the polariza- tion reaction diminishes [34]. 11 1(0) t RC d ocvV V V e − = − (12) 11(0)V IR= (13) 3.2. Selection of Health Indicators Based on the equivalent circuit model of the lithium battery, the external character- istics of the lithium battery, as indicated by the discharge curve of the terminal voltage, are analyzed and fitted. The polarization reaction of the lithium battery is closely related to the SOH of the battery, and the polarization resistance and capacitance of the battery will change with the cycle. The increase in the number of times shows a regular change. Figure 2. Equivalent circuit model. According to the equivalent model shown in Figure 2, the equivalent equation of the circuit can be obtained according to the Kirchhoff voltage and current law and other relevant knowledge: Vd = Vocv − IR0 − V1 (9) • V1 = − 1 R1C1 V1 + 1 C1 I (10) where R0 is the battery ohmic internal resistance, R1 is the battery polarization internal resistance, C1 is the battery polarization capacitance, Vd is the battery terminal voltage, Vocv is the battery open circuit voltage, V1 is the battery polarization voltage, and I is the battery charge and discharge current. By analyzing the change of terminal voltage in the three stages of discharge, it can be established that the discharge of lithium battery is the zero-step response stage when the terminal voltage Vd changes over time, as shown in Equation (11). Vd = Vocv − IR0 − IR1(1 − e− t R1C1 ) (11) The static stage after the discharge is the zero-input response stage. At this time, the formula of terminal voltage calculation is shown in Formula (12) and Formula (13), from which it can be seen that it will gradually decay to 0 after a period of time as the polarization reaction diminishes [34]. Vd = Vocv − V1(0)e− t R1C1 (12) V1(0) = IR1 (13) 3.2. Selection of Health Indicators Based on the equivalent circuit model of the lithium battery, the external characteris- tics of the lithium battery, as indicated by the discharge curve of the terminal voltage, are analyzed and ﬁtted. The polarization reaction of the lithium battery is closely related to the SOH of the battery, and the polarization resistance and capacitance of the battery will change with the cycle. The increase in the number of times shows a regular change. The initial discharge internal resistance, polarization internal resistance, and polarization capac- itance of the battery are taken as important indicators to map the SOH of the lithium battery, Batteries 2023, 9, 80 6 of 20 so as to predict the actual capacity of the battery according to its partial discharge charac- teristics. Therefore, the initial discharge internal resistance, polarization internal resistance, and polarization capacitance of the battery are regarded as the health indicators of the battery’s capacity. Also, the initial discharge internal resistance value TAB as an important manifestation of battery degradation is also regarded as one of the health indicators. 3.2.1. Using Parameter Identiﬁcation to Extract R1 and C1 According to the constant current discharge characteristics of the battery, the primary discharge process is divided into three parts: before discharge (before point a), during discharge (from point b to point c) and after discharge (after point d). It can be seen that after the completion of discharge, there will be a period of voltage rise when the battery is left standing for a short period of time. The reason for this phenomenon is that the battery’s discharge is accompanied by a polarization reaction. The polarization reaction is manifested as a voltage change of the battery. In case of high-current discharging, the voltage drop will be large. When the discharging stops, the battery polarization stops, and the battery’s voltage will rise signiﬁcantly. According to Equations (12) and (13), the rebound curve after discharge at point d is a function curve expressed as IR1(1 − e− 1 R1C1 ) in Figure 3, which provides a basis for the next round of parameter identiﬁcation. In this paper, the curve parameter identiﬁcation and the least squares method are used. Batteries 2023, 9, x FOR PEER REVIEW 6 of 21 The initial discharge internal resistance, polarization internal resistance, and polarization capacitance of the battery are taken as important indicators to map the SOH of the lithium battery, so as to predict the actual capacity of the battery according to its partial discharge characteristics. Therefore, the initial discharge internal resistance, polarization internal re- sistance, and polarization capacitance of the battery are regarded as the health indicators of the battery’s capacity. Also, the initial discharge internal resistance value 𝑇𝑇𝐴𝐴𝐴𝐴 as an im- portant manifestation of battery degradation is also regarded as one of the health indica- tors. 3.2.1. Using Parameter Identification to Extract R1and C1 According to the constant current discharge characteristics of the battery, the primary discharge process is divided into three parts: before discharge (before point a), during discharge (from point b to point c) and after discharge (after point d). It can be seen that after the completion of discharge, there will be a period of voltage rise when the battery is left standing for a short period of time. The reason for this phenomenon is that the bat- tery’s discharge is accompanied by a polarization reaction. The polarization reaction is manifested as a voltage change of the battery. In case of high-current discharging, the voltage drop will be large. When the discharging stops, the battery polarization stops, and the battery’s voltage will rise significantly. According to Equations (12) and (13), the re- bound curve after discharge at point d is a function curve expressed as 𝐼𝐼𝑅𝑅1(1 − 𝑒𝑒− 1 𝑅𝑅1𝐶𝐶1) in Figure 3, which provides a basis for the next round of parameter identification. In this paper, the curve parameter identification and the least squares method are used. Vocv IR0 IR1 IR0 a b c d Figure 3. Variation curve of terminal voltage discharge process. The B0005 battery data of a NASA lithium battery is selected as the research object. This is the most used public dataset in the current research in this field. A constant tem- perature box is used to eliminate the influence of external temperature. However, there are only a few battery samples in this data set, each battery sample corresponds to a single battery, and the sample points of each battery sample are relatively small. Also, the battery capacity degradation curve will show a phenomenon of short-term capacity regeneration. Among them, the B0005 battery data provided by NASA has a total of 168 cycles. In order to identify health factors through the discharge recovery phase, the terminal voltage re- covery curve during 168 discharges is sorted out as shown in Figure 4. The starting point in the figure is point c in Figure 3. Since the terminal voltage values have time intervals, the actual voltage curve shows a certain distortion. Therefore, curve fitting is performed to infer the position of point d in the theoretical curve, which is the work of the subsequent preparation for identification. Figure 3. Variation curve of terminal voltage discharge process. The B0005 battery data of a NASA lithium battery is selected as the research object. This is the most used public dataset in the current research in this ﬁeld. A constant temperature box is used to eliminate the inﬂuence of external temperature. However, there are only a few battery samples in this data set, each battery sample corresponds to a single battery, and the sample points of each battery sample are relatively small. Also, the battery capacity degradation curve will show a phenomenon of short-term capacity regeneration. Among them, the B0005 battery data provided by NASA has a total of 168 cycles. In order to identify health factors through the discharge recovery phase, the terminal voltage recovery curve during 168 discharges is sorted out as shown in Figure 4. The starting point in the ﬁgure is point c in Figure 3. Since the terminal voltage values have time intervals, the actual voltage curve shows a certain distortion. Therefore, curve ﬁtting is performed to infer the position of point d in the theoretical curve, which is the work of the subsequent preparation for identiﬁcation. In order to ﬁnd the position of point d, the polyﬁt function in MATLAB is used to ﬁt the remaining points in each cycle recovery voltage curve except the ﬁrst point based on the ﬁfth degree polynomial ﬁtting through the least square method, where the polyﬁt function is the minimum used in MATLAB. The function of quadratic method parameter estimation for curve ﬁtting can be called by command statement, and the output is the coefﬁcient line. The ﬁtting results are shown in Figure 5. For each cycle, point d is taken as the origin of the coordinate axis, and the recovery curve of the polarization reaction is drawn, as shown in Figure 6. Batteries 2023, 9, 80 7 of 20Batteries 2023, 9, x FOR PEER REVIEW 7 of 21 Figure 4. Rising voltage curve of each cycle. In order to find the position of point d, the polyfit function in MATLAB is used to fit the remaining points in each cycle recovery voltage curve except the first point based on the fifth degree polynomial fitting through the least square method, where the polyfit function is the minimum used in MATLAB. The function of quadratic method parameter estimation for curve fitting can be called by command statement, and the output is the coefficient line. The fitting results are shown in Figure 5. For each cycle, point d is taken as the origin of the coordinate axis, and the recovery curve of the polarization reaction is drawn, as shown in Figure 6. Figure 5. Fitting the recovery curve to find the d point. 0 50 100 150 200 250 300 350 400 450 500 Time /s 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1Voltage/ V 0 50 100 150 200 250 300 350 400 450 500 Time /s 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1Voltage/ V actual voltage value fitted curve Figure 4. Rising voltage curve of each cycle. Batteries 2023, 9, x FOR PEER REVIEW 7 of 21 Figure 4. Rising voltage curve of each cycle. In order to find the position of point d, the polyfit function in MATLAB is used to fit the remaining points in each cycle recovery voltage curve except the first point based on the fifth degree polynomial fitting through the least square method, where the polyfit function is the minimum used in MATLAB. The function of quadratic method parameter estimation for curve fitting can be called by command statement, and the output is the coefficient line. The fitting results are shown in Figure 5. For each cycle, point d is taken as the origin of the coordinate axis, and the recovery curve of the polarization reaction is drawn, as shown in Figure 6. Figure 5. Fitting the recovery curve to find the d point. 0 50 100 150 200 250 300 350 400 450 500 Time /s 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1Voltage/ V 0 50 100 150 200 250 300 350 400 450 500 Time /s 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1Voltage/ V actual voltage value fitted curve Figure 5. Fitting the recovery curve to ﬁnd the d point. Batteries 2023, 9, x FOR PEER REVIEW 8 of 21 Figure 6. Rising voltage curve of each cyclic polarization reaction. According to Equations (12) and (13) after the end of the discharge polarization reac- tion formula, it can be deduced that the polarization reaction formula in Figure 4 is as follows: 11 11(1 ) t RCV IR e − = − (14) where the values of the parameters are unknown. The process of identifying curve pa- rameters by using the least squares method is shown in Figure 7. Specifically, Figure 7a shows the identification result of the entire cycle, the blue points represent the actual volt- age values, and the red curve represents the identification curve of the polarization for- mula, while Figure 7b present the identification results of several cycles. Time/sVoltage/V (a) (b) Figure 7. Results of parameter identification of polarization response curve. (a) All loops; (b) Par- tial loop. Finally, the polarization internal resistance and polarization capacitance are identi- fied as shown in Figure 8. It can be seen from the figure that the polarization resistance and capacitance change regularly with the increase in the number of cycles [35], and 𝑅𝑅1and 𝐶𝐶1 are feasible as the health factors of the battery to map the battery SOH. 0 50 100 150 200 250 300 350 400 Time / s 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7Voltage / V 1th cycle actual value 1th cycle fitted curve 40th cycle actual value 40th cycle fitted curve 80th cycle actual value 80th cycle fitted curve 100th cycle actual value 100th cycle fitted curve Figure 6. Rising voltage curve of each cyclic polarization reaction. According to Equations (12) and (13) after the end of the discharge polarization reaction formula, it can be deduced that the polarization reaction formula in Figure 4 is as follows: V1 = IR1(1 − e− t R1C1 ) (14) Batteries 2023, 9, 80 8 of 20 where the values of the parameters are unknown. The process of identifying curve parame- ters by using the least squares method is shown in Figure 7. Speciﬁcally, Figure 7a shows the identiﬁcation result of the entire cycle, the blue points represent the actual voltage values, and the red curve represents the identiﬁcation curve of the polarization formula, while Figure 7b present the identiﬁcation results of several cycles. Batteries 2023, 9, x FOR PEER REVIEW 8 of 21 Figure 6. Rising voltage curve of each cyclic polarization reaction. According to Equations (12) and (13) after the end of the discharge polarization reac- tion formula, it can be deduced that the polarization reaction formula in Figure 4 is as follows: 11 11(1 ) t RCV IR e − = − (14) where the values of the parameters are unknown. The process of identifying curve pa- rameters by using the least squares method is shown in Figure 7. Specifically, Figure 7a shows the identification result of the entire cycle, the blue points represent the actual volt- age values, and the red curve represents the identification curve of the polarization for- mula, while Figure 7b present the identification results of several cycles. Time/sVoltage/V (a) (b) Figure 7. Results of parameter identification of polarization response curve. (a) All loops; (b) Par- tial loop. Finally, the polarization internal resistance and polarization capacitance are identi- fied as shown in Figure 8. It can be seen from the figure that the polarization resistance and capacitance change regularly with the increase in the number of cycles [35], and 𝑅𝑅1and 𝐶𝐶1 are feasible as the health factors of the battery to map the battery SOH. 0 50 100 150 200 250 300 350 400 Time / s 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7Voltage / V 1th cycle actual value 1th cycle fitted curve 40th cycle actual value 40th cycle fitted curve 80th cycle actual value 80th cycle fitted curve 100th cycle actual value 100th cycle fitted curve Figure 7. Results of parameter identiﬁcation of polarization response curve. (a) All loops; (b) Par- tial loop. Finally, the polarization internal resistance and polarization capacitance are identiﬁed as shown in Figure 8. It can be seen from the ﬁgure that the polarization resistance and capacitance change regularly with the increase in the number of cycles [35], and R1 and C1 are feasible as the health factors of the battery to map the battery SOH. Batteries 2023, 9, x FOR PEER REVIEW 9 of 21 (a) (b) Figure 8. Polarization identification results. (a)Polarization resistance vs. cycle number; (b)Polari- zation capacitance vs. cycle number. 3.2.2. Modified Discharge Curve Extraction R01 The initial stage of discharge is the ohmic polarization stage, the voltage drop is caused by the internal resistance of each part of the battery connection, and the value of voltage drop follows Ohm’s law. Since the terminal voltage curve is not displayed in real time, the position of point b in Figure 9 on the actual voltage curve can be estimated by calculation. Also, the value of 𝑅𝑅1and 𝐶𝐶1 can be obtained, while Equation (11) can be used to estimate the position of point b. Then, the value of corresponding discharge initial in- ternal resistance 𝑅𝑅01 can be obtained through the ratio of the voltage difference and the discharge current between point a and point b as shown in Figure 9. Figure 10 shows the curve of discharge initial resistance changing with cycle. 0 500 1000 1500 2000 2500 3000 3500 Time/s 2.8 3 3.2 3.4 3.6 3.8 4 4.2 discharge curve modified discharge curve a secondVoltage/V Figure 9. Position of point b in discharge curve. 0 20 40 60 80 100 120 140 160 180 cycle number 0.16 0.18 0.2 0.22 0.24 0.26 0.28 0.3 0.32resistance/Ω 0 20 40 60 80 100 120 140 160 cycle number 150 200 250 300 350 400capacitance/F Figure 8. Polarization identiﬁcation results. (a) Polarization resistance vs. cycle number; (b) Polariza- tion capacitance vs. cycle number. 3.2.2. Modiﬁed Discharge Curve Extraction R01 The initial stage of discharge is the ohmic polarization stage, the voltage drop is caused by the internal resistance of each part of the battery connection, and the value of voltage drop follows Ohm’s law. Since the terminal voltage curve is not displayed in real time, the position of point b in Figure 9 on the actual voltage curve can be estimated by calculation. Also, the value of R1 and C1 can be obtained, while Equation (11) can be used to estimate the position of point b. Then, the value of corresponding discharge initial internal resistance R01 can be obtained through the ratio of the voltage difference and the discharge current between point a and point b as shown in Figure 9. Figure 10 shows the curve of discharge initial resistance changing with cycle. Batteries 2023, 9, 80 9 of 20Batteries 2023, 9, x FOR PEER REVIEW 9 of 21 (a) (b) Figure 8. Polarization identification results. (a)Polarization resistance vs. cycle number; (b)Polari- zation capacitance vs. cycle number. 3.2.2. Modified Discharge Curve Extraction R01 The initial stage of discharge is the ohmic polarization stage, the voltage drop is caused by the internal resistance of each part of the battery connection, and the value of voltage drop follows Ohm’s law. Since the terminal voltage curve is not displayed in real time, the position of point b in Figure 9 on the actual voltage curve can be estimated by calculation. Also, the value of 𝑅𝑅1and 𝐶𝐶1 can be obtained, while Equation (11) can be used to estimate the position of point b. Then, the value of corresponding discharge initial in- ternal resistance 𝑅𝑅01 can be obtained through the ratio of the voltage difference and the discharge current between point a and point b as shown in Figure 9. Figure 10 shows the curve of discharge initial resistance changing with cycle. 0 500 1000 1500 2000 2500 3000 3500 Time/s 2.8 3 3.2 3.4 3.6 3.8 4 4.2 discharge curve modified discharge curve a secondVoltage/V Figure 9. Position of point b in discharge curve. 0 20 40 60 80 100 120 140 160 180 cycle number 0.16 0.18 0.2 0.22 0.24 0.26 0.28 0.3 0.32resistance/Ω 0 20 40 60 80 100 120 140 160 cycle number 150 200 250 300 350 400capacitance/F Figure 9. Position of point b in discharge curve. Batteries 2023, 9, x FOR PEER REVIEW 10 of 21 Figure 10. Curve of the relationship between 𝑅𝑅01 and cycle times 3.2.3. Extracting 𝑇𝑇𝐴𝐴𝐴𝐴 under Constant Current Working Condition Under the context of constant current, the discharge capacity 𝐶𝐶𝐴𝐴𝐴𝐴 is obtained by mul- tiplying the equal voltage drop discharge time series 𝑇𝑇𝐴𝐴𝐴𝐴 by the discharge current, and the comparison curve between 𝐶𝐶𝐴𝐴𝐴𝐴 and actual capacity of B0005 lithium battery is ob- tained by selecting a fixed voltage drop range of 3.8–3.5 V. As can be seen clearly from Figure 11, the connection with the actual capacity of the battery is very close. The feasibil- ity of equal pressure drop discharge time as an indirect health indicator is verified. Among them, the actual capacity of the battery is measured by the ampere-hour method from the current curve of the battery in the process of discharging from the fully charged state to the cut-off voltage. Figure 11. 𝐶𝐶𝐴𝐴𝐴𝐴 and battery capacity comparison curve. According to Equation (11), the effect of the polarization reaction on the end voltage will gradually decline or even disappear rapidly as the discharge process proceeds. There- fore, the end voltage can be taken as a simple internal resistance model equation, as shown in Equation (15) for most of the time in the discharge process [36]. 11 01 01(1 ) t RC d ocv ocvV V IR IR e V IR IR − = − − − ≈ − − (15) 3.3. Optimization of Health Indicator Based on e-GA 0 20 40 60 80 100 120 140 160 180 cycle number 0.09 0.095 0.1 0.105 0.11 0.115resistance /Ω 0 20 40 60 80 100 120 140 160 180 cycle number 0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 2capacity/Ah CAB real capacity of B0005 Figure 10. Curve of the relationship between R01 and cycle times. 3.2.3. Extracting TAB under Constant Current Working Condition Under the context of constant current, the discharge capacity CAB is obtained by multiplying the equal voltage drop discharge time series TAB by the discharge current, and the comparison curve between CAB and actual capacity of B0005 lithium battery is obtained by selecting a ﬁxed voltage drop range of 3.8–3.5 V. As can be seen clearly from Figure 11, the connection with the actual capacity of the battery is very close. The feasibility of equal pressure drop discharge time as an indirect health indicator is veriﬁed. Among them, the actual capacity of the battery is measured by the ampere-hour method from the current curve of the battery in the process of discharging from the fully charged state to the cut-off voltage. According to Equation (11), the effect of the polarization reaction on the end voltage will gradually decline or even disappear rapidly as the discharge process proceeds. There- fore, the end voltage can be taken as a simple internal resistance model equation, as shown in Equation (15) for most of the time in the discharge process [36]. Vd = Vocv − IR0 − IR1(1 − e− t R1C1 ) ≈ Vocv − IR0 − IR1 (15) Batteries 2023, 9, 80 10 of 20Batteries 2023, 9, x FOR PEER REVIEW 10 of 21 Figure 10. Curve of the relationship between 𝑅𝑅01 and cycle times 3.2.3. Extracting 𝑇𝑇𝐴𝐴𝐴𝐴 under Constant Current Working Condition Under the context of constant current, the discharge capacity 𝐶𝐶𝐴𝐴𝐴𝐴 is obtained by mul- tiplying the equal voltage drop discharge time series 𝑇𝑇𝐴𝐴𝐴𝐴 by the discharge current, and the comparison curve between 𝐶𝐶𝐴𝐴𝐴𝐴 and actual capacity of B0005 lithium battery is ob- tained by selecting a fixed voltage drop range of 3.8–3.5 V. As can be seen clearly from Figure 11, the connection with the actual capacity of the battery is very close. The feasibil- ity of equal pressure drop discharge time as an indirect health indicator is verified. Among them, the actual capacity of the battery is measured by the ampere-hour method from the current curve of the battery in the process of discharging from the fully charged state to the cut-off voltage. Figure 11. 𝐶𝐶𝐴𝐴𝐴𝐴 and battery capacity comparison curve. According to Equation (11), the effect of the polarization reaction on the end voltage will gradually decline or even disappear rapidly as the discharge process proceeds. There- fore, the end voltage can be taken as a simple internal resistance model equation, as shown in Equation (15) for most of the time in the discharge process [36]. 11 01 01(1 ) t RC d ocv ocvV V IR IR e V IR IR − = − − − ≈ − − (15) 3.3. Optimization of Health Indicator Based on e-GA 0 20 40 60 80 100 120 140 160 180 cycle number 0.09 0.095 0.1 0.105 0.11 0.115resistance /Ω 0 20 40 60 80 100 120 140 160 180 cycle number 0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 2capacity/Ah CAB real capacity of B0005 Figure 11. CAB and battery capacity comparison curve. 3.3. Optimization of Health Indicator Based on e-GA Although equal pressure drop discharge time is widely used as a health indicator for battery health state prediction, the TAB obtained by selecting different discharge voltage drop fragments varies, and the accuracy of prediction results produced by using them often varies signiﬁcantly. To select a suitable health indicator, three discharge voltage drop segments (3.8–3.5 V, 3.5–3.2 V, and 3.0–2.7 V) are selected for comparison by exam- ining the correlation between the iso-voltage drop and the actual capacity for different intervals. In the existing studies, there is a gray correlation analysis conducted to analyze the relationship between the extracted equal voltage drop discharge time and the actual discharge capacity [37], but the algorithm is computationally intensive. Therefore, the Pearson product distance correlation coefﬁcient is used to verify the correlation between the different iso-voltage drop discharge time and the actual capacity. The calculation equation is shown as Equation (16). r = n ∑ i=1 (xi − ˆx)(yi − ˆy) √ n ∑ i=1 (xi − ˆx)2√ n ∑ i=1 (yi − ˆy)2 (16) where x and y are the comparison sequences with the sequence length n, and r is the Pearson correlation coefﬁcient between the two sequences. The sequences generated by the R01, R1, C1, and TAB with the number of cycles are x, and the battery capacity sequence is y. When r > 0, the x and y sequences show positive correlation. When r < 0, the x and y sequences show negative correlation. The correlation relationship between the four health indicators and the actual capacity is obtained as follows. As shown in Table 2, the correlations of the health indicators R01, R1, and C1 are moderate or weak, but the correlation coefﬁcient of TAB is related to the selection of the pressure drop interval. Therefore, the commonly used voltage interval for battery discharge is delineated, and the span of the voltage drop interval is constrained. The genetic algorithm based on the elite selection model is used to optimize the voltage drop segment. With the Pearson correlation as the ﬁtness function of the e-GA algorithm, the pressure drop segment with the best correlation of TAB is selected. Batteries 2023, 9, 80 11 of 20 Table 2. The correlation between different health indicators and capacity. Sequence Correlation Coefﬁcient R01 0.4101 R1 0.2561 C1 −0.3071 TAB (3.8–3.5 V) 0.9962 TAB (3.5–3.2 V) −0.6221 TAB (3.0–2.7 V) −0.9833 The elite retention strategy is adopted to optimize GA. The individual with the highest level of ﬁtness in the current generation is retained as an elite individual, and the remaining individuals are subjected to genetic operations such as random selection, crossover, and mutation. The steps of the algorithm include population initialization, ﬁtness function setting, selection, crossover and mutation, and elite retention strategies. The voltage drop interval selected by the model ranges between 0.1 V and 0.2 V. Considering that the commonly used SOC range is from 80% to 30%, the search range for the optimal voltage drop interval of the B0005 battery VA is 3.85–3.10 V, e-GA. The algorithm has a step size of 0.01 V and 0.05 V. The model parameters are set as follows: the number of individuals in the initial population n = 20, the number of evolution k = 100, the crossover rate Pc = 0.4, and Pm = 0.1. The ﬂowchart of model algorithm is as follows: Step 1: Population initialization, which is to randomly generate the initial population P(t) of n individuals through binary coding of the selected pressure drop sequence. Step 2: Fitness function, where the Pearson product-distance correlation coefﬁcient is used to calculate individual ﬁtness. Step 3: Selection operator, which is used to obtain the individual ﬁtness according to the ﬁtness function, with n individuals randomly selected from the population (each indi- vidual has the same probability of being selected) for the population individual gambler. Step 4: Crossover operator, with single-point crossover used and population individ- uals randomly paired. After successful pairing, a crossover bit is randomly selected by single-point crossover according to the crossover probability, the binary code exchange of the crossover bit is performed, and two new individuals will be obtained. Then, the new individual is tested. If the test is successful, the mutation operator is entered; otherwise, the cross position is re-selected until the test is successful. Step 5: Mutation operator, where the individual is a binary coded string and the basic mutation method is used to mutate the individual. According to the mutation rate Pm, the compiled bit is randomly selected, the binary character corresponding to the bit is reversed, and the ﬁtness of the compiled individual is veriﬁed. If the veriﬁcation is successful, then we proceed to get a new generation of individuals; otherwise, they will be re-selected and compiled until the veriﬁcation is successful. Step 6: Elite retention strategy, where the optimal individual with the optimal ﬁtness value searched in the evolution of the population is saved as an elite individual. Also, the individual with the lowest ﬁtness is replaced in the next generation, so as to avoid the loss and destruction of the best genes in the current population. Step 7: It is determined whether the termination condition is satisﬁed. If the evolu- tionary count is reached, the pressure drop fragment with the optimal ﬁtness is outputted; otherwise, the evolutionary count is increased by one before returning to step 2. The optimized adaptation curve is obtained using the e-GA model, as shown in Figure 12. A total of 168 cycles of the B0005 cell correlation optimal correlation correspond to the interval of equal pressure drop ranging from 3.65 V to 3.45 V, and the optimal individual adaptation is 0.9989, which improves the correlation coefﬁcient by 0.0027 compared to the interval of 3.8 V–3.5 V. Also, the measurement time is reduced by about 200 s according to the comparative test. Batteries 2023, 9, 80 12 of 20Batteries 2023, 9, x FOR PEER REVIEW 12 of 21 Step 1: Population initialization, which is to randomly generate the initial population P(t) of n individuals through binary coding of the selected pressure drop sequence. Step 2: Fitness function, where the Pearson product-distance correlation coefficient is used to calculate individual fitness. Step 3: Selection operator, which is used to obtain the individual fitness according to the fitness function, with n individuals randomly selected from the population (each in- dividual has the same probability of being selected) for the population individual gam- bler. Step 4: Crossover operator, with single-point crossover used and population individ- uals randomly paired. After successful pairing, a crossover bit is randomly selected by single-point crossover according to the crossover probability, the binary code exchange of the crossover bit is performed, and two new individuals will be obtained. Then, the new individual is tested. If the test is successful, the mutation operator is entered; otherwise, the cross position is re-selected until the test is successful. Step 5: Mutation operator, where the individual is a binary coded string and the basic mutation method is used to mutate the individual. According to the mutation rate 𝑃𝑃𝑚𝑚, the compiled bit is randomly selected, the binary character corresponding to the bit is re- versed, and the fitness of the compiled individual is verified. If the verification is success- ful, then we proceed to get a new generation of individuals; otherwise, they will be re- selected and compiled until the verification is successful. Step 6: Elite retention strategy, where the optimal individual with the optimal fitness value searched in the evolution of the population is saved as an elite individual. Also, the individual with the lowest fitness is replaced in the next generation, so as to avoid the loss and destruction of the best genes in the current population. Step 7: It is determined whether the termination condition is satisfied. If the evolu- tionary count is reached, the pressure drop fragment with the optimal fitness is outputted; otherwise, the evolutionary count is increased by one before returning to step 2. The optimized adaptation curve is obtained using the e-GA model, as shown in Fig- ure 12. A total of 168 cycles of the B0005 cell correlation optimal correlation correspond to the interval of equal pressure drop ranging from 3.65 V to 3.45 V, and the optimal indi- vidual adaptation is 0.9989, which improves the correlation coefficient by 0.0027 com- pared to the interval of 3.8 V–3.5 V. Also, the measurement time is reduced by about 200 s according to the comparative test. Figure 12. Optimization process of e-GA algorithm. 4. PSO-LSTM Network Model Although the LSTM network can be used to solve the long-term dependence problem that RNN cannot handle, the introduction of the gate structure increases the number of 0 20 40 60 80 100 iteration number 0.9978 0.998 0.9982 0.9984 0.9986 0.9988 0.999fitness Figure 12. Optimization process of e-GA algorithm. 4. PSO-LSTM Network Model Although the LSTM network can be used to solve the long-term dependence problem that RNN cannot handle, the introduction of the gate structure increases the number of hyperparameters. If the selection of hyperparameters is unreasonable, the accuracy of prediction will be insufﬁcient. Therefore, PSO is used to optimize the hyperparameters of the LSTM network and to build a PSO-LSTM lithium-ion capacity prediction model. Considering the training time of the neural network and the need for the PSO algorithm to repeatedly obtain the error of the veriﬁcation set as the ﬁtness value, the LSTM network with a single-layer structure is selected. Thus, there are three hyperparameters to be conﬁgured: learning rate ε, training times k and hidden layer neuron number L1. The structure of the PSO-LSTM algorithm model is shown in Figure 13. The three hyperparameters of LSTM are used as the parameters to be optimized for PSO, and the ﬁtness function is the mean absolute percentage error (MAPE) outputted by the model, as shown in Equation (17): F(X) = min(MAPE) (17) where MAPE is calculated as shown in (18). MAPE = 1 n n ∑ i=1 | ˆyn − yn| yn (18) where yn is the actual value of the remaining capacity, ˆyn is the predicted value of the remaining capacity, and n denotes the number of predicted load points. The combined model algorithm process is as follows: Step 1: Data processing, where the battery degradation data is obtained from the NASA Li-ion battery data set, with the B0005 battery data divided into training set, validation set, and test set at a ratio of 6:1:3. Speciﬁcally, the ﬁrst 100 cycles comprise the training set data, cycles 101 to 118 comprise the validation set, and cycles 119 to 168 comprise the test set. The health indicators (R1, C1, R01, TAB), as described in the previous section, are extracted and normalized. Step 2: Optimization of the LSTM hyperparameters through PSO. (1) With the learning rate, the number of training times, and the number of neurons in the hidden layer in the LSTM model as the optimization objects, their search ranges are determined. Based on the actual training volume and experience, the learning rate range of the solvable space is selected as [0,0.2], the range for the number of neurons in the hidden layer is [1,50], and the range of training time is [100,500] (2) The PSO parameters are initialized, with the particle dimension set as 20, the population set as 100, the minimum value of particle velocity Vmin = [0.001,1,10], the Batteries 2023, 9, 80 13 of 20 maximum value Vmax = [0.05,10,50], the number of iterations M = 100, the learning factor is c1 = c2 = 1.2, and the inertia weight is w = 0.8, taking into account the variation of neural network hyperparameters, randomly generated search point velocity and position in the search range and position, where the randomly generated particle position is a multiple of Vmin. (3) The ﬁtness value of PSO is calculated. The ﬁtness value of each particle is calculated, the LSTM model is constructed with the corresponding parameters of each particle, the LSTM model is built using the training set, the veriﬁcation set data are predicted, and the error of the veriﬁcation set prediction result is calculated as the ﬁtness value of each particle. The ﬁtness formula is shown in Equation (17), and the particle individual extremum pbest and global extremum gbest are updated. (4) Position and speed are updated. The search speed and position of hyperparameters are updated according to Equations (7) and (8). In order to prevent the particles from exceeding the search range and jumping out of the solution space at the time of search, it is replaced with the boundary value if the speed exceeds the boundary. (5) It is judged whether the algorithm meets the criterion of termination. If this criterion is met, the population history optimal solution is ended and outputted; otherwise, we return to step 3. Step 3: Model training, with the global optimal parameters searched in step 2 con- ﬁgured into the LSTM network model. Besides, four health indicators obtained from the ﬁrst 118 cycles are used as input for model training, so as to obtain the PSO-LSTM battery capacity prediction model. Step 4: Model testing, with the standardized data of the health indicator of the 50 cycles inputted into the prediction model after the test set to obtain the capacity prediction results. Batteries 2023, 9, x FOR PEER REVIEW 13 of 21 hyperparameters. If the selection of hyperparameters is unreasonable, the accuracy of pre- diction will be insufficient. Therefore, PSO is used to optimize the hyperparameters of the LSTM network and to build a PSO-LSTM lithium-ion capacity prediction model. Consid- ering the training time of the neural network and the need for the PSO algorithm to re- peatedly obtain the error of the verification set as the fitness value, the LSTM network with a single-layer structure is selected. Thus, there are three hyperparameters to be con- figured: learning rate 𝜀𝜀, training times 𝑘𝑘 and hidden layer neuron number 𝐿𝐿1. The struc- ture of the PSO-LSTM algorithm model is shown in Figure 13. The three hyperparameters of LSTM are used as the parameters to be optimized for PSO, and the fitness function is the mean absolute percentage error (MAPE) outputted by the model, as shown in Equa- tion (17): ( ) min( )F X MAPE= (17) where MAPE is calculated as shown in (18). ^ 1 1 nnn i n yy MAPE ny= − = ∑ (18) where 𝑦𝑦𝑛𝑛 is the actual value of the remaining capacity, 𝑦𝑦𝑛𝑛� is the predicted value of the remaining capacity, and n denotes the number of predicted load points. Data normali zation ... ... PSO t1 tn LSTM neural network model Fitness function Actual capacity Polarization resistance Polarized capacitance Initial discharge resistance Isobaric drop time series Number of neurons Number of trainings Learning rate Model output (forecast capacity) ... Figure 13. PSO-LSTM algorithm model. The combined model algorithm process is as follows: Step 1: Data processing, where the battery degradation data is obtained from the NASA Li-ion battery data set, with the B0005 battery data divided into training set, vali- dation set, and test set at a ratio of 6:1:3. Specifically, the first 100 cycles comprise the training set data, cycles 101 to 118 comprise the validation set, and cycles 119 to 168 com- prise the test set. The health indicators (𝑅𝑅1, 𝐶𝐶1, 𝑅𝑅01, 𝑇𝑇𝐴𝐴𝐴𝐴), as described in the previous section, are extracted and normalized. Step 2: Optimization of the LSTM hyperparameters through PSO. Figure 13. PSO-LSTM algorithm model. 5. Example Results and Analysis 5.1. Experimental Data and Pre-Processing The experiments conducted in this paper will use the lithium-ion battery data set published by NASA PCoE, and select the B0005 and B0018 battery data describing constant Batteries 2023, 9, 80 14 of 20 current charge and discharge cycles at room temperature. The experimental equipment of NASA PCoE mainly includes commercial 18,650 lithium-ion batteries, programmable four-channel DC electronic load, programmable four-channel DC power supply, voltmeter, ammeter, thermocouple sensor kit, custom EIS equipment, thermostat, PXI chassis-based data collection and test console, and MATLAB-based test control. The positive electrode material of the 18,650 lithium-ion battery is potassium cobaltate, the negative electrode material is graphite, and the main material of the electrolyte is potassium hexaﬂuorophos- phate. The preparation method of the electrode is as follows: the active material phosphoric acid lithium iron, conductive agent, and binder are uniformly mixed in a certain proportion to make a slurry which is evenly coated on the current-collector, and the electrode sheet is obtained after drying, rolling, and shearing. Table 3 shows an overview of properties of the electrodes and separator built into 18,650 cells [38]. Table 3. Overview of properties of the electrodes and separator built into 18,650 cells. Anode Cathode Active material graphite LiXNi0.33Co0.33O2 Electrode thicknesses (double side coat) 126 µm 125 µm Current collector foil thicknesses 10 µm (Cu) 20 µm (Al) Areal capacity 5.00 m Ah/cm2 4.12 m Ah/cm2 N/P 1.21 Separator thickness 16 µm The battery cycle experiment of NASA PCoE is detailed as follows: (1) Charge the battery with a constant current of 1.5 A until the voltage of the battery rises to 4.2 V, then switch to constant voltage charging, and end the charging phase when the current drops to 20 mA. (2) Put the battery aside, conduct EIS impedance measurement during the period, and measure the internal resistance parameters of the battery with an electrochemical impedance tester at a frequency of 0.1 HZ~5 Hz. (3) Discharge the battery with a current of 2 A, and end the discharge stage after the battery discharge cut-off voltage is reached. The discharge cut-off voltage of B0005 is 2.7 V, the electrical cut-off voltage of B1008 is 2.5 V, and the discharge cut-off voltage is 2.5 V. (4) Put the battery on hold, and perform the EIS impedance measurement at the same time. The above steps are repeated until the actual capacity of the battery drops to 70% of the rated capacity, from 2 Ah to below 1.4 Ah. In the experiment, B5 obtained a total of 168 sets of experimental data, and B1008 obtained 132 sets of data. Since the two batteries belong to the same model and are charged and discharged at a constant current, the SOH prediction model trained by the B0005 battery data is applied to the B0018 battery with different cut-off voltages, thereby verifying the accuracy and generalization of the model. According to the discharge data of 132 cycles of B0018, the proposed HI selection strategy and method, the voltage curves of the post-discharge stage and the initial discharge stage, as well as curve ﬁtting and parameter identiﬁcation, the four health factor curves shown in Figure 14 are obtained. Figure 14a shows a CAB of 3.65–3.45 V. The discharge range is selected using e-GA for optimization, and the discharge amount obtained by multi- plying TAB and the discharge current is CAB. Figure 14b shows the results of initial internal resistance identiﬁcation. By correcting the discharge curve, the position of the end point of the ohmic polarization phase is obtained. Then, the corresponding discharge initial internal resistance value R01 can be obtained through the ratio of the voltage difference between the start and end points of the ohmic polarization phase and the discharge current. Fig- ure 14c,d shows the polarization resistance and polarization capacitance. The time-domain expression of the discharge process is obtained through the analysis of the equivalent circuit, and the curve ﬁtting is carried out in combination with the discharge curve of the Batteries 2023, 9, 80 15 of 20 external characteristics of the lithium battery, that is, the terminal voltage. Also, parameter identiﬁcation is performed to obtain polarization resistance and polarization capacitance. Batteries 2023, 9, x FOR PEER REVIEW 16 of 21 20 40 60 80 100 120 140 cycle number 0.35 0.4 0.45 0.5 0.55 0.6 0.65 0.7 0.75capacity/Ah B0018CAB 0 20 40 60 80 100 120 140 cycle number 0.096 0.098 0.1 0.102 0.104 0.106 0.108 0.11 0.112Resistance/Ω B0018R01 (a) (b) 0 20 40 60 80 100 120 140 cycle number 0.15 0.2 0.25 0.3 0.35 0.4resistance/ΩB0018R1 0 20 40 60 80 100 120 140 cycle number 130 140 150 160 170 180 190 200 210 220 230capacitance/F B0018C1 (c) (d) Figure 14. Four HIs of B0018 battery(a) CAB (3.65–3.45); (b) Initial internal resistance identification results; (c) Polarization resistance identification results; (d) Polarized capacitance identification results. Based on the discharge data of 132 cycles of B0018, the proposed HI selection strategy and method, the voltage curves of the post-discharge stage and the initial discharge stage, as well as curve fitting and parameter identification, four health indicator curves as shown in Figure 14 are obtained. It is also necessary to normalize the four health indicators extracted through the above process, and the normalization equation is expressed as follows: min max min ' xx x x x − = − (19) where 𝑥𝑥, is the normalized value, 𝑥𝑥 is the data value, 𝑥𝑥𝑚𝑚𝑖𝑖𝑛𝑛is the minimum value of the data, and 𝑥𝑥𝑚𝑚𝑚𝑚𝑚𝑚 is the maximum value of the data. 5.2. Experimental Results and Analysis 5.2.1. Model Evaluation Indicators To evaluate the accuracy of the Li-ion battery SOH prediction model based on the extraction of multidimensional health indicators, the mean absolute percentage error and mean-square error (MSE) are used to assess the prediction effect of the model, and the MAPE and MSE are calculated, as shown in Equations (18) and (20). 2 ^ 1 1 () n nn i MSE y y n = = −∑ (20) Figure 14. Four HIs of B0018 battery (a) CAB (3.65–3.45); (b) Initial internal resistance identiﬁcation results; (c) Polarization resistance identiﬁcation results; (d) Polarized capacitance identiﬁcation results. Based on the discharge data of 132 cycles of B0018, the proposed HI selection strategy and method, the voltage curves of the post-discharge stage and the initial discharge stage, as well as curve ﬁtting and parameter identiﬁcation, four health indicator curves as shown in Figure 14 are obtained. It is also necessary to normalize the four health indicators extracted through the above process, and the normalization equation is expressed as follows: x′ = x − xmin xmax − xmin (19) where x′ is the normalized value, x is the data value, xmin is the minimum value of the data, and xmax is the maximum value of the data. 5.2. Experimental Results and Analysis 5.2.1. Model Evaluation Indicators To evaluate the accuracy of the Li-ion battery SOH prediction model based on the extraction of multidimensional health indicators, the mean absolute percentage error and Batteries 2023, 9, 80 16 of 20 mean-square error (MSE) are used to assess the prediction effect of the model, and the MAPE and MSE are calculated, as shown in Equations (18) and (20). MSE = 1 n n ∑ i=1 ( ˆyn − yn) 2 (20) where n indicates the length of the test sample, yn denotes the true value and ˆyn denotes the predicted value. MAPE and MSE have smaller values, indicating that the model performs better in prediction. 5.2.2. Analysis of Results Since the LSTM used in this paper is an improved neural network, the BP neural network model is introduced for comparison. The basic idea of the BP algorithm is as follows. The learning process consists of two steps: the forward propagation of the signal and the reverse propagation of the error. The error output is calculated in the direction from input to output, and the weight and threshold are adjusted from the output-to-input direction. The PSO-BP model optimizes the BP neural network for the PSO algorithm, and selects the optimal hyperparameters. However, based on the modiﬁcation to the weight principle based on the error gradient descent, the result inevitably suffers problems such as local minima, slow convergence speed, and shocks. Consequently, there are certain defects in the prediction of the remaining capacity of the battery. As an effective method of time series analysis, LSTM produces a better effect in the prediction of remaining capacity. The cyclic charge/discharge data of two types of batteries are extracted from the NASA dataset, while single health indicator (TAB), multiple health indicators (R1, C1, R01, TAB) and optimized multiple health indicators (R1, C1, R01, TAB) are selected as model inputs. Then, two algorithm models, PSO-BP and PSO-LSTM, are built for comparison. Among them, the unoptimized TAB voltage drop range is 3.8–3.5 V, and the optimized TAB voltage drop range is 3.65–3.45 V. The amount of charge and discharge data of NASA lithium batteries is small. The B0005 lithium battery contains 168 charging cycles. The ﬁrst 100 cycles are used as the training set, and the last 68 cycles are used as the test set. While B0018 contains only 132 charging cycles, with the ﬁrst 80 cycles used as the training set and the last 52 cycles used as the test set. The SOH prediction results of the 18,650 Li-ion battery for B0005 and B0018 are shown in Figures 15–17. Batteries 2023, 9, x FOR PEER REVIEW 17 of 21 where 𝑛𝑛 indicates the length of the test sample, 𝑦𝑦𝑛𝑛 denotes the true value and 𝑦𝑦𝑛𝑛� de- notes the predicted value. 𝑀𝑀𝑀𝑀𝑃𝑃𝑀𝑀 and 𝑀𝑀S𝑀𝑀 have smaller values, indicating that the model performs better in prediction. 5.2.2. Analysis of Results Since the LSTM used in this paper is an improved neural network, the BP neural network model is introduced for comparison. The basic idea of the BP algorithm is as follows. The learning process consists of two steps: the forward propagation of the signal and the reverse propagation of the error. The error output is calculated in the direction from input to output, and the weight and threshold are adjusted from the output-to-input direction. The PSO-BP model optimizes the BP neural network for the PSO algorithm, and selects the optimal hyperparameters. However, based on the modification to the weight principle based on the error gradient descent, the result inevitably suffers problems such as local minima, slow convergence speed, and shocks. Consequently, there are certain de- fects in the prediction of the remaining capacity of the battery. As an effective method of time series analysis, LSTM produces a better effect in the prediction of remaining capacity. The cyclic charge/discharge data of two types of batteries are extracted from the NASA dataset, while single health indicator (𝑇𝑇𝐴𝐴𝐴𝐴), multiple health indicators (𝑅𝑅1, 𝐶𝐶1, 𝑅𝑅01, 𝑇𝑇𝐴𝐴𝐴𝐴) and optimized multiple health indicators (𝑅𝑅1, 𝐶𝐶1, 𝑅𝑅01, 𝑇𝑇𝐴𝐴𝐴𝐴) are selected as model in- puts. Then, two algorithm models, PSO-BP and PSO-LSTM, are built for comparison. Among them, the unoptimized 𝑇𝑇𝐴𝐴𝐴𝐴 voltage drop range is 3.8–3.5 V, and the opti- mized 𝑇𝑇𝐴𝐴𝐴𝐴 voltage drop range is 3.65–3.45 V. The amount of charge and discharge data of NASA lithium batteries is small. The B0005 lithium battery contains 168 charging cy- cles. The first 100 cycles are used as the training set, and the last 68 cycles are used as the test set. While B0018 contains only 132 charging cycles, with the first 80 cycles used as the training set and the last 52 cycles used as the test set. The SOH prediction results of the 18,650 Li-ion battery for B0005 and B0018 are shown in Figures 15–17. (a) (b) (c) Figure 15. Prediction results of three HI strategies in the PSO-BP network. (a) Single health indica- tor; (b) Multiple health indicator; (c) Optimized multi-health indicator. (a) (b) (c) Figure 15. Prediction results of three HI strategies in the PSO-BP network. (a) Single health indicator; (b) Multiple health indicator; (c) Optimized multi-health indicator. Batteries 2023, 9, 80 17 of 20Batteries 2023, 9, x FOR PEER REVIEW 17 of 21 where 𝑛𝑛 indicates the length of the test sample, 𝑦𝑦𝑛𝑛 denotes the true value and 𝑦𝑦𝑛𝑛� de- notes the predicted value. 𝑀𝑀𝑀𝑀𝑃𝑃𝑀𝑀 and 𝑀𝑀S𝑀𝑀 have smaller values, indicating that the model performs better in prediction. 5.2.2. Analysis of Results Since the LSTM used in this paper is an improved neural network, the BP neural network model is introduced for comparison. The basic idea of the BP algorithm is as follows. The learning process consists of two steps: the forward propagation of the signal and the reverse propagation of the error. The error output is calculated in the direction from input to output, and the weight and threshold are adjusted from the output-to-input direction. The PSO-BP model optimizes the BP neural network for the PSO algorithm, and selects the optimal hyperparameters. However, based on the modification to the weight principle based on the error gradient descent, the result inevitably suffers problems such as local minima, slow convergence speed, and shocks. Consequently, there are certain de- fects in the prediction of the remaining capacity of the battery. As an effective method of time series analysis, LSTM produces a better effect in the prediction of remaining capacity. The cyclic charge/discharge data of two types of batteries are extracted from the NASA dataset, while single health indicator (𝑇𝑇𝐴𝐴𝐴𝐴), multiple health indicators (𝑅𝑅1, 𝐶𝐶1, 𝑅𝑅01, 𝑇𝑇𝐴𝐴𝐴𝐴) and optimized multiple health indicators (𝑅𝑅1, 𝐶𝐶1, 𝑅𝑅01, 𝑇𝑇𝐴𝐴𝐴𝐴) are selected as model in- puts. Then, two algorithm models, PSO-BP and PSO-LSTM, are built for comparison. Among them, the unoptimized 𝑇𝑇𝐴𝐴𝐴𝐴 voltage drop range is 3.8–3.5 V, and the opti- mized 𝑇𝑇𝐴𝐴𝐴𝐴 voltage drop range is 3.65–3.45 V. The amount of charge and discharge data of NASA lithium batteries is small. The B0005 lithium battery contains 168 charging cy- cles. The first 100 cycles are used as the training set, and the last 68 cycles are used as the test set. While B0018 contains only 132 charging cycles, with the first 80 cycles used as the training set and the last 52 cycles used as the test set. The SOH prediction results of the 18,650 Li-ion battery for B0005 and B0018 are shown in Figures 15–17. (a) (b) (c) Figure 15. Prediction results of three HI strategies in the PSO-BP network. (a) Single health indica- tor; (b) Multiple health indicator; (c) Optimized multi-health indicator. (a) (b) (c) Figure 16. Prediction results of three HI strategies in the PSO-LSTM network. (a) Single health indicator; (b) Multiple health indicator; (c) Optimized multi-health indicator. Batteries 2023, 9, x FOR PEER REVIEW 18 of 21 Figure 16. Prediction results of three HI strategies in the PSO-LSTM network. (a) Single health indicator; (b) Multiple health indicator; (c) Optimized multi-health indicator. Figure 17. SOH prediction results of the B0018 battery. According to Figures 15–17, the prediction results obtained from the multidimen- sional health index combined with the PSO-LSTM algorithm model as proposed in this paper are more accurate than the other five groups of comparative experiments, and the prediction results almost match the actual results. Among them, the black solid line indi- cates the actual capacity of the battery, and the blue dashed line indicates the prediction result of the model, together with the number of cycles. Also, the single health indicator prediction shows a trend of degradation with the increase of training times. Tables 4–5 show that, overall, the prediction effect of the LSTM network is better than that of the BP network, while in the same network, the optimized multi-HI strategy has the best predic- tion effect. Also, the multi-HI strategy with fixed pressure drop fragment 𝑇𝑇𝐴𝐴𝐴𝐴 and the single-HI strategy perform slightly worse in prediction. The prediction model achieves a 99.76% accuracy in B0005 with high precision, and the model achieves a 98.65% accuracy in B0018 with good generalization ability. Table 4. Hyperparameter configuration results and error table. Algorith m HI Selection Strategy Number of Trainings Number of Neurons Learning Rate MSE (e-05) MAPE (%) PSO--BP Single health indicator 390 49 0.04 44.5980 1.558756 Multiple health indicator 200 34 0.08 43.6870 1.535629 Optimized multi- health indicator 170 18 0.14 20.8990 0.993734 PSO- LSTM Single health indicator 320 12 0.18 25.8590 1.024413 Multiple health indicator 300 20 0.20 8.57237 0.636016 Figure 17. SOH prediction results of the B0018 battery. According to Figures 15–17, the prediction results obtained from the multidimensional health index combined with the PSO-LSTM algorithm model as proposed in this paper are more accurate than the other ﬁve groups of comparative experiments, and the prediction results almost match the actual results. Among them, the black solid line indicates the actual capacity of the battery, and the blue dashed line indicates the prediction result of the model, together with the number of cycles. Also, the single health indicator prediction shows a trend of degradation with the increase of training times. Tables 4 and 5 show that, overall, the prediction effect of the LSTM network is better than that of the BP network, while in the same network, the optimized multi-HI strategy has the best prediction effect. Also, the multi-HI strategy with ﬁxed pressure drop fragment TAB and the single-HI strategy perform slightly worse in prediction. The prediction model achieves a 99.76% accuracy in B0005 with high precision, and the model achieves a 98.65% accuracy in B0018 with good generalization ability. The method as studied in this paper compares other health factors combined with data-driven SOH prediction methods. The comparison of prediction models is shown in Table 6. According to the comparison of prediction result errors of multi-dimensional health factors combined with PSO-LSTM algorithm in Table 4, the estimated error based on GWO-LSTM algorithm is 1.86%, the estimated error based on EKF-GPR algorithm is 0.26%, and the error based on GA-SVR algorithm is 0.71%. The prediction error based on Batteries 2023, 9, 80 18 of 20 Elman algorithm is 0.89%, and the error based on CNN-LSTM algorithm is 0.33%. It can be concluded that the multidimensional health factor combined with PSO-LSTM method has higher accuracy and better effect. Table 4. Hyperparameter conﬁguration results and error table. Algorithm HI Selection Strategy Number of Trainings Number of Neurons Learning Rate MSE (e-05) MAPE (%) PSO–BP Single health indicator 390 49 0.04 44.5980 1.558756 Multiple health indicator 200 34 0.08 43.6870 1.535629 Optimized multi-health indicator 170 18 0.14 20.8990 0.993734 PSO-LSTM Single health indicator 320 12 0.18 25.8590 1.024413 Multiple health indicator 300 20 0.20 8.57237 0.636016 Optimized multi-health indicator 470 50 0.17 1.47469 0.231071 Table 5. SOH prediction error analysis of the B0018 battery. Battery Serial Number MSE (e-05) MAPE (%) B0018 67.846 1.35178 Table 6. Prediction effect of SOH model established by other models. Network Models Built in the Literature HI Selection Strategy MAPE (%) GWO-LSTM [39] Battery capacity for the previous cycle 1.86 EKF-GPR [40] Fragment charging time 0.26 GA-SVR [41] Average discharge voltage and average temperature 0.71 Elman [42] TAB (3.7–3.5 V) 0.89 CNN-LSTM [43] TAB (3.8–3.5 V) 0.33 6. Conclusions To address the problems like the insufﬁcient ﬁtting of a single health indicator and the difﬁculty in online measurement of a battery’s internal resistance, this paper proposes a method to extract multidimensional health indexes based on constant current discharge characteristics. Firstly, polarization resistance and capacitance are extracted based on the least squares method for discharge curve parameter identiﬁcation. Secondly, initial discharge resistance is extracted by correcting the discharge curve, and then the equal voltage drop time series is taken as an indirect health indicator by e-GA. Finally, the e- GA is used as the indirect health indicator to optimize the time series, and a combined PSO-LSTM neural network SOH prediction model is established based on the extracted health indicators. The experimental results show that the optimized multidimensional health indicator represents an improvement of 0.79% compared with the single health indicator in the prediction of the SOH prediction model, as established for the PSO-LSTM neural network. In addition, for the B0005 lithium-ion battery, the accuracy of the PSO-LSTM model as established based on the extraction of multidimensional health indexes for constant current conditions reaches 99.76%, and the mean square error is 0.0000147, which veriﬁes that the model has high accuracy and is more accurate for the B0018 battery. Author Contributions: Conceptualization, Z.Y.; methodology, R.L.; writing—original draft prepara- tion, N.L.; writing—review and editing, N.L.; supervision, Y.Z. and L.Q.; funding acquisition, R.L. All authors have read and agreed to the published version of the manuscript. Funding: This work was supported by the Joint Fund Project of the Ministry of Education of China (No. 8091B022133), the Natural Science Foundation of Heilongjiang Province, China (No. LH2022E08)”. Batteries 2023, 9, 80 19 of 20 Data Availability Statement: The data that support the ﬁndings of this study are available from the corresponding author upon reasonable request. Conﬂicts of Interest: The authors declare no conﬂict of interest. References 1. Bruno, S.; Jürgen, C. Lithium batteries: Status, prospects and future. J. Power Sources 2010, 195, 2419–2430. 2. Liu, D.T.; Song, Y.C.; Wu, W.; Yang, C.; Peng, Y. Review of estimation of state of health of lithium-ion battery packs. Chin. J. Sci. Inst. 2020, 41, 1–18. 3. Tian, H.X.; Qin, P.L.; Li, K.; Zhao, Z. A review of the state of health for lithium-ion batteries: Research status and suggestions. J. Clean. Prod. 2020, 261, 120813. [CrossRef] 4. Ding, X.; Xue, J.H.; Chen, Z.Y.; Ma, Q. Research on performance decline and capacity prediction model of lithium iron phosphate battery. Chin. J. Power Sources 2019, 43, 1013–1016. 5. Liu, F.; Shao, C.; Su, W.X.; Liu, Y. Online joint estimator of key states for battery based on a new equivalent circuit model. Journal of Energy Storage. J. Energy Storage 2022, 52, 104780. [CrossRef] 6. Bian, X.L.; Liu, L.C.; Yan, J.Y.; Zou, Z.; Zhao, R.K. Online joint estimator of key states for battery based on a new equivalent circuit model. J. Power Sources 2020, 448, 227401. [CrossRef] 7. Xiong, R.; Tian, J.P.; Mu, H.; Wang, C. A systematic model-based degradation behavior recognition and health monitoring method for lithium-ion batteries. Appl. Energy 2017, 207, 372–383. [CrossRef] 8. Shen, S.; Sadoughi, M.; Li, M.; Wang, Z.D.; Hu, C. Deep convolutional neural networks with ensemble learning and transfer learning for capacity estimation of lithium-ion batteries. Appl. Energy 2020, 260, 114296. [CrossRef] 9. Shu, X.; Li, G.; Shen, J.; Lei, Z. A uniform estimation framework for state of health of lithium-ion batteries considering feature extraction and parameters optimization. Energy 2020, 204, 117957. [CrossRef] 10. Zenati, A.; Desprez, P.; Razik, H.; Rael, S. A Methodology to Assess the State of Health of Lithium-Ion Batteries Based on the Battery’s Parameters and a Fuzzy Logic System. In Proceedings of the 2012 IEEE International Electric Vehicle Conference, Greenville, SC, USA, 4–8 March 2012. 11. Chen, Z.; Sun, M.; Shu, X.; Xiao, R.; Shen, J. Online state of health estimation for lithium-ion batteries based on support vector machine. Appl. Sci. 2018, 8, 925. [CrossRef] 12. Deng, Y.W.; Ying, H.J.; Er, J.Q.; Zhu, H.; Wei, K.X.; Chen, J.W.; Zhang, F.; Liao, G.L. Feature parameter extraction and intelligent estimation of the State-of-Health of lithium-ion batteries. Energy 2019, 176, 91–102. [CrossRef] 13. Yu, J. State of health prediction of lithium-ion batteries: Multiscale logic regression and Gaussian process regression ensemble. Reliab. Eng. Syst. Saf. 2018, 174, 82–95. [CrossRef] 14. Richardson, R.R.; Osborne, M.A.; Howey, D.A. Gaussian process regression for forecasting battery state of health. J. Power Sources 2017, 357, 209–219. [CrossRef] 15. Wang, P.; Fan, L.F.; Cheng, Z.; Cheng, Z. A Joint State of Health and Remaining Useful Life Estimation Approach for Lithium-ion Batteries Based on Health Factor Parameter. Proc. IEEE Inst. Electr. Electron. Eng. 2022, 42, 1523–1534. 16. Song, Y.C.; Liu, D.T.; Hou, Y.D.; Yu, J.X.; Peng, Y. Satellite Lithium-Ion Battery Remaining Useful Life Estimation with An Iterative Updated RVM Fused with the KF Algorithm. Chin. J. Aeronaut. 2015, 31, 31–40. [CrossRef] 17. Hu, X.; Che, Y.; Lin, X.; Onori, S. Battery Health Prediction Using Fusion-Based Feature Selection and Machine Learning. IEEE Trans. Transp. Electrif. 2021, 7, 382–398. [CrossRef] 18. Li, H.; Pan, D.; Chen, C.L.P. Intelligent prognostics for battery health monitoring using the mean entropy and relevance vector machine. IEEE Trans. Intell. Transp. Syst. 2014, 44, 851–862. [CrossRef] 19. Khumprom, P.; Yodo, N. A Data-Driven Predictive Prognostic Model for Lithium-ion Batteries based on a Deep Learning Algorithm. Energy. 2019, 12, 660. [CrossRef] 20. Ren, L.; Dong, J.B.; Wang, X.K.; Meng, Z.H.; Zhao, L.; Deen, M.J. A data-driven auto-cnn-lstm prediction model for lithium-ion battery remaining useful life. Int. J. Elec. Power 2020, 17, 3478–3487. [CrossRef] 21. Chu, Y.; Chen, Y.F.; Mi, Y. A CNN-LSTM lithium battery health state estimation based on attention mechanism. J. Power Sources 2022, 46, 634–637+651. 22. Wei, J.W.; Dong, G.Z.; Chen, Z.H. Remaining useful life prediction and state of health diagnosis for lithium-ion batteries using particle ﬁlter and support vector regression. IEEE Trans. Ind. Electron. 2017, 65, 5634–5643. [CrossRef] 23. Hu, X.S.; Jiang, J.C.; Cao, D.P.; Egardt, B. Battery health prognosis for electric vehicles using sample entropy and sparse Bayesian predictive modeling. IEEE Trans. Ind. Electron. 2015, 63, 2645–2656. [CrossRef] 24. Huang, Y.S.; Qin, L.L.; Wu, G. State of Health Estimation Based on Constant Current Charging Proﬁles. In Proceedings of the 2021 40th Chinese Control Conference (CCC), Shanghai, China, 26–28 July 2021. 25. Li, X.; Wang, Z.; Yan, J.; Egardt, B. Prognostic health condition for lithium battery using the partial incremental capacity and Gaussian process regression. J. Power Sources 2019, 421, 56–67. [CrossRef] 26. Zhang, Y.; Guo, B. Online capacity estimation of lithium-ion batteries based on novel feature extraction and adaptive multi-kernel relevance vector machine. Energies 2015, 8, 12439–12457. [CrossRef] Batteries 2023, 9, 80 20 of 20 27. Tian, J.P.; Xiong, R.; Shen, W.X. State-of-health estimation based on differential temperature for lithium ion batteries. Energies 2015, 8, 12439–12457. [CrossRef] 28. Guo, B.J.; Li, J.Q.; Ma, X.L.; Wang, F. Capacity estimation of power lithium-ion battery based on deep learning. Batteries 2022, 52, 517–521. 29. Yin, C.J.; Wang, Y.N.; Li, P.F.; Xiao, D.; Zhao, Q. Joint online estimation of SOC and SOH of energy storage battery based on LSTM. J. Power Sources 2022, 46, 541–544. 30. Zhang, Y.Z.; Xiong, R.; He, H.W.; Wang, M.G. Long short-term memory recurrent neural network for remaining useful life prediction of lithium-ion batteries. IEEE Trans. Veh. Technol. 2018, 67, 5695–5705. [CrossRef] 31. Yu, Z.H.; Xiao, L.J.; Li, H.Y.; Zhu, X.L.; Huai, R.T. Model parameter identiﬁcation for lithium batteries using the coevolutionary particle swarm optimization method. IEEE Trans. Ind. Electron. 2017, 64, 5690–5700. [CrossRef] 32. Chen, Y.S. State of Charge Estimation of Lithium Iron Phosphate Power Battery Cells. Master’s Thesis, University of Science and Technology of China, Hefei, China, 24 May 2021. 33. He, H.W.; Xiong, R.; Guo, H.Q.; Li, S.C. Comparison study on the battery models used for the energy management of batteries in electric vehicles. Energy Convers. Manag. 2012, 64, 113–121. [CrossRef] 34. Li, Y.; Zhu, H.; Zhu, J.; Zheng, J.; Chen, Y. A Multivariate Regression Method for Battery Remaining Capacity Based on Model Parameter Identiﬁcation. In Proceedings of the 2021 3rd International Academic Exchange Conference on Science and Technology Innovation (IAECST), Guangzhou, China, 10–12 December 2021. 35. Sun, T.; Gong, G.Q.; Chen, Y. Lithium battery Simscape model analysis based on parameter identiﬁcation. J. Power Sources 2019, 43, 1316–1318+1362. 36. Huang, W.N.; Song, Y.F.; Zhang, W.G.; Chen, A.C.; Ding, P.R. A Thermal Co-simulation Framework Based on Temperature Correction for Lithium-ion Battery. Proc. CSEE 2020, 60, 4013–4024. 37. Pang, J.Y.; Ma, Y.T.; Liu, D.T.; Peng, Y. Indirect prediction method of remaining life of lithium-ion battery. Sci. China Technol. SC 2014, 9, 28–36. 38. Waldmann, T.; Scurtu, R.G.; Richter, K.; Margret, W.M. 18650 vs. 21700 Li-ion cells–A direct comparison of electrochemical, thermal, and geometrical properties. J. Power Sources 2020, 472, 228614. [CrossRef] 39. Shi, M.Z. Research on Lithium-ion Battery Remaining Useful Life Prediction Method Based on Improved LSTM Network. Master’s Thesis, Shaanxi University of Science and Technology, Xi’an, China, May 2021. 40. He, Y.J.; Shen, J.N.; Shen, J.F.; Ma, Z.F. State of Health Estimation of Lithium-Ion Batteries: A Multiscale Gaussian Process Regression Modeling Approach. AIChE J. 2015, 61, 1589–1600. [CrossRef] 41. Liu, H.; Hu, M.X.; Zhu, Y.H.; Yu, D.J. Prediction for state of health of lithium-ion batteries by genetic algorithm and support vector regression. J. Nanjing Univ. Sci. Technol. 2018, 42, 329–334+351. 42. Li, L.B.; Zhu, Y.Z.; Tian, Y.J.; An, Z.T.; Wang, L.L. RUL indirect prediction of lithium-ion battery based on Elman neural network. J. Power Sources 2019, 43, 1027–1031. 43. Chen, C.Y.; Chen, D.W. Research on indirect prediction of lithium battery RUL based on CNN-LSTM. J. Power Sources 2021, 45, 589–594. Disclaimer/Publisher’s Note: The statements, opinions and data contained in all publications are solely those of the individual author(s) and contributor(s) and not of MDPI and/or the editor(s). MDPI and/or the editor(s) disclaim responsibility for any injury to people or property resulting from any ideas, methods, instructions or products referred to in the content.","libVersion":"0.3.2","langs":""}