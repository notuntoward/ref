{"path":"lit/lit_sources/Elkholy19OptimalParametersEstimation.pdf","text":"Optimal parameters estimation and modelling of photovoltaic modules using analytical method A. Elkholy a, *, A.A. Abou El-Ela b a Electronics Research Institute, Photovoltaic Cells Department, Egypt b Electrical Engineering Department, Faculty of Engineering, Menouﬁa University, Egypt AR T I C L E I NF O Keywords: Applied mathematics Computational mathematics Computer science Energy Solar cells Solar irradiance Least-squares algorithm Photovoltaic modules characteristic Optimal parameters estimation Shunt resistance of PV cell Photovoltaics AB S T RA C T This paper introduces a proposed approach to estimate the optimal parameters of the photovoltaic (PV) modules using in-ﬁeld outdoor measurements and manufacturers' datasheet as well as employing the nonlinear least- squares ﬁtting algorithm. The main goal is to determine the optimal parameter values of the implemented model which are: series resistance, reverse saturation current, photocurrent, ideality factor and shunt resistance in case of the ﬁve parameters model. A Microsoft Excel spreadsheet is developed in order to perform modeling and analysis of the parameters analytical initial values using manufacturer datasheet speciﬁcations regarding to the changing in solar irradiance and ambient temperature. Then, the sum of the squared residuals between in-ﬁeld measured and simulated data are calculated and minimized using Excel solver in order to obtain the optimal values of the parameters simultaneously, to describe the best ﬁt for the outdoor measured data. The proposed approach is used to ﬁnd the optimal parameters of the PV module TRINA TSM-295 using an array tester. The convergence conﬁdences of the estimated parameters are presented and assessed in an easy way. This approach allows all parameters to be optimized, simultaneously. The results are veriﬁed and compared with other research studies for different PV cell technologies. The obtained results are useful for the tested PV module manufacturer and assess the performance of the products in different weather conditions. 1. Introduction Appropriate circuit modeling and optimal parameters estimation of the photovoltaic (PV) modules are critical topics for different activities such as: simulation, design, assessing efﬁciency computations, perfor- mance evaluation under various conditions and control of PV systems [1, 2, 3]. Also, it is useful for monitoring operation of PV systems, forecasting produced power, developing fault detection methods, calculating losses, developing and testing maximum power point tracking (MPPT) algo- rithms [4] and reproducing the references of PV simulators as a function of real time variation of irradiance and temperature values to test the commercial PV inverters [5]. The PV cells are usually characterized using current-voltage (I-V) and power-voltage (P-V) curves. The manufacturers present the datasheet speciﬁcations at the standard test conditions (STC) for open circuit voltage (Voc), short circuit current (Isc) and maximum power point (mpp) i.e. current (Impp) voltage (Vmpp) and power (Pmpp) [6]. For some man- ufacturers, the values of the temperature coefﬁcients for open circuit voltage (βoc) and short circuit current (αsc) are also tabulated. The PV cell equivalent circuit is conventionally represented using current source and one diode without any hint to series resistance (Rs) and parallel resis- tance (Rp) in the ideal PV cell model. Various studies have been presented for development the PV cell models. However, these models have different levels of the complexity. The differences between these models are based on the employed diodes numbers, ﬁnite or inﬁnite shunt resistance, ﬁxed or variable ideality factor and the utilized algorithms to ﬁnd required parameters. So far, a comparison between the presented PV cell models is an important topic in the scientiﬁc community [7]. The model of the PV cell characteristic is obtained based on physical principles. The equivalent model of single diode parameters is based on the employed circuit, such as photocurrent current (Iph), saturation cur- rent (Io), diode ideality factor (n), Rs and Rp resistances. However, these parameters are neither always explicitly nor completely provided by the manufacturers of PV modules. Consequently, choice of electrical PV cells model and the method of parameters extraction are based on different principles such as estimation speed, PV technology, complexity and ac- curacy [8].In [8], the authors discussed ﬁve PV cells mathematical models of varying complexity, such as lumped four parameters (L4P) and * Corresponding author. E-mail address: elkholy.aly@gmail.com (A. Elkholy). Contents lists available at ScienceDirect Heliyon journal homepage: www.heliyon.com https://doi.org/10.1016/j.heliyon.2019.e02137 Received 30 October 2018; Received in revised form 21 March 2019; Accepted 18 July 2019 2405-8440/© 2019 The Authors. Published by Elsevier Ltd. This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by- nc-nd/4.0/). Heliyon 5 (2019) e02137 lumped ﬁve parameters (L5P) methods in order to investigate the long term performance of direct coupled PV systems. The authors concluded that, the L4P model of the multicrystalline PV module presented the best match to the experimental measured data, at low irradiance of 200 W/m 2 [9]. Authors in [10] referred to an iterative method proposed by [11] based on ﬁtting the theoretical curve to the experimental points (the voltage and slope at the open circuit point, the maximum power point (Vmpp,Impp), the current and slope at the short circuit point) as 5-points method. This method did not ﬁt the model to every point of the curve, but achieved good ﬁtting with experimental measured data. However, there are practical difﬁculties in measuring the slopes, specially the short cir- cuit slope. Authors in [12] presented a direct analytical extraction of 5-points method using experimental data based on least square tech- nique. The authors employed an iterative procedure in order to deter- mine the equation of a silicon solar array from empirical data measured at 21 points, where all points were considered. Finally, the authors in [10], presented a comparison between curve-ﬁtting, iterative 5-points and analytical 5-points methods for estimating the parameters of the single-diode model. As stated in [13], there is a need for analytical expression to deter- mine the parameters Iph,n,Io,Rs and Rp, directly. A comparison between an analytical expression and an iterative method for parameters esti- mation was presented in [13]. Analytical methods are derived for simple and fast procedures by simplifying the assumptions without sacriﬁcing accuracy [13, 14, 15]. Numerical methods employ a set of equations and ﬁnd a solution using iterative algorithms [16, 17]. Several techniques have been presented to ﬁnd the optimal parameters of the PV modules using analytical or iterative techniques based on the manufacturers data sheet information only [18, 19, 20, 21, 22]. In [14], six prevalent analytical methods for modeling and extracting parameters of the PV modules were evaluated. The authors concluded that, the analytical methods can compete in terms of accuracy with the numerical methods. In [23], the authors presented a set of analytical solutions, which can be used as initial values for estimating L5P double-diode model for nu- merical solutions based on Newton–Raphson method. There are many databases of research publications under the topic of PV modelling and the parameter estimation. A review on the important research works on modelling and parameters estimation of the PV cells can be found in [24]. The authors discussed three PV cell models, namely the single diode Rs,Rp and the two diodes. Also, the authors covered both the analytical and the soft computing approaches for parameters esti- mation. Finally, the review in [24] recommended hybrid approach be- tween soft computing and analytical methods. Most of the used PV cell parameters extraction methods are graphical, analytical, numerical, heuristics or from artiﬁcial intelligence as presented in [9]. As stated in a review can be found in [2] that, the PV cell parameters can be evaluated using manufacturer data sheet information and exper- imentally measured I-V curves. Also, the author classiﬁed the PV cell parameters estimation methodologies into three main approaches as: analytical, metaheuristic optimisation and hybrids of analytical and metaheuristic. The nonlinear least square ﬁtting is widely used to ﬁnd parameters of PV modules. The nonlinear least squares approach extracts parameters of PV cells by reducing least squared error between simulated target variables and experimentally measured data. However, the current and voltage in PV cell equation (Ipv,Vpv) takes the form of an implicit function, which includes dependent and independent variables in both sides of the equation at the same time. Such implicit nature of the PV module equation increases the complexity and the difﬁculty of parame- ters extraction [25]. A modiﬁed non-linear least error square optimization approach was presented in [26] based on Newton's method to extract ﬁve illuminated PV cell parameters using the experimentally measured data. The authors introduced an initialization routine of two parameters in order to over- come the difﬁculty in initializing the parameters. In [27], the authors presented an analytical solution technique based on Co-content function, which was expressed in terms of the Lambert W function to extract the PV cell parameters by numerical ﬁtting of the equations. Similar analytical solution methods were presented in [28, 29, 30]. In [31, 32, 33, 34], the authors employed the pattern search optimization technique [31], Bac- terial Foraging Algorithm [32], harmony search-based algorithms [33] and bird mating optimizer [34] for extracting the parameters of different PV cell models. In [35], an approach to determine the required parameters of the PV cell using a single I-V curve under constant illumination value was pre- sented. The authors used Lambert W function and reduced the estimated parameters, So that, the expression for Ipv was depending only on n, Rs, and Rp. Then, the PV cell parameters were directly extracted by ﬁtting the analytical expression with the experimentally measured data. In [36], the authors presented a technique for determining the PV cell parameters using the light generated I-V curve based on an assumption for different technologies of the PV cells. This technique neither involved an initial approximations nor included an iteration processes. This approach was programmed and implemented on C platform. The determination of PV module parameters using experimentally measured data is important for designing and sizing of PV systems [10]. An accurate model of PV cells is useful to predict performance of the system [6]. The PV systems designers select between different PV mod- ules. The optimization of such systems is the main goal for designers in order to select PV module with the best performance based on available information. But, the manufacturers do not provide sufﬁcient data in order to get an accurate analysis [37]. The objectives of this paper are Fig. 1. I-V characteristic curve of a PV cell. A. Elkholy, A.A. Abou El-Ela Heliyon 5 (2019) e02137 2 modeling and estimating the optimal parameters of PV modules using the proposed approach. A Microsoft Excel spreadsheet is employed to simulate the I-V curve of the PV modules and determine the initial values of parameters based on analytical expressions and ﬁnally to estimate the optimal values of parameters based on the curve ﬁtting to measured data using the Excel solver. This paper proposes an approach to estimate the PV module parameters using outdoor test data and simulated data. A simple and rapid procedure is proposed to ﬁnd the optimal parameters of the PV module. The paper is organized as follows: Section 2 discusses the mathematical model of PV modules and reviews the different approaches of analytical initial conditions and parameter estimation studies. Section 3 presents the proposed approach to estimate the optimal parameters of the PV modules. Section 4 contains the experimental measurements data of the case studied and the implementation of least squares data ﬁtting using the Excel solver. Section 5 afﬁrms on the proposed approach validation and its accuracy. Results and discussions are declared in sec- tion 6. Finally, the conclusions can be found in Section 7. 2. Background 2.1. Background of the solar cell mathematical modeling There are different approaches for modeling and simulating the PV cells. In [38], the authors used artiﬁcial neural network and Lambert W function for modeling the PV cells characteristics and estimating the model parameters using real experimentally measured data. Most com- mon approaches are employing the equivalent electrical circuit model of PV cells [2]. However, Authors in [39], focused on multi-junction PV cells to improve the conversion efﬁciency based on an electrical equiv- alent circuit of the multi-junction cells. The electrical characteristics of the PV modules are deﬁned by I-V characteristic curves as shown in Fig. 1. The manufacturer's data sheet presents information about the PV module such as open circuit voltage (Voc), short circuit current (Isc), peak power (Pmax), voltage and current at maximum peak point (Vmpp,Impp)at different indoor conditions such as the standard test condition (STC) as well as the nominal operating cell temperature (NOCT). The different weather conditions, types of the used materials and manufacturing technologies are the main items which affect on the PV module param- eters. The PV systems installations environment are different from the STCs. Parameters determination using only the manufacturers data sheet leads to an inaccurate result of the estimated parameters. The equivalent circuit of the single diode L5P is shown in Fig. 2 [1]. Ipv ¼ Iph \u0002 ID \u0002 Ip (1) where, Ipv is the generated current by the PV cell, ID is the Shockley diode current and Ip is parallel resistance current. The Shockley diode (ID) equation can be expressed as follows [40]: ID ¼ Io 0 B B @exp \u0002 q*ðVpv þRs *IpvÞ nKTc \u0003 \u0002 1 1 C C A (2) where; Io is the dark saturation current (A), n is the diode ideality factor (unitless), K is the Boltzmann's constant (1.38066\u000310–23 J/K), q is the elementary charge (1.60218\u000310–19 coulomb), Rs is the series resistance (Ω), Tc is the module temperature (oC) Finally, by developing the terms ID,Ip and Iph, the I-V characteristic can be calculated using Eq. (3), which presents the single diode Rp model [2, 40]: Ipv ¼ Iph \u0002 Io 2 6 6 4exp \u0002 qðVpv þRs Ipv Þ nKTc \u0003 \u0002 1 3 7 7 5 \u0002 Vpv þ RsIpv Rp (3) The single diode L5P model seeks about ﬁve parameters values, i.e. Iph,Io,n, Rs and Rp. There are different methods to solve Eq. (3) using the different approximation mathematical models. The different models generally employ the manufacturers data sheet information. The L4P model assumes that the shunt resistance has inﬁnite value and can be neglected. Eq. (3) can be rewritten using the following equation: sR pRphI DI pI D pvI pvV Fig. 2. Equivalent circuit for a single diode model. Table 1 Different approaches of the parameters estimation studies. Additional information Iteration Initial parameters Single diode L5P model [22] Slope at OC and SC points No No [43] No Yes (Iph,Io,Rs,Rp and a) [21] Yes, for the convergence of Rs Yes (Rs) [16] None Yes to compute Rp and Rs Yes (a) [46] None Optimization algorithm to solve for all parameters Yes (Iph,Io,Rs,Rp and a) [17] M (Air mass modiﬁer) Nonlinear equation solver Yes (Iph,Io,Rs,Rp and a) [31] I-V curve non-linear least error Yes (Rp,a) [52] A piecewise curve-ﬁtting method Yes (Iph,Io,Rs,Rp and a) [53] Optimization algorithm to solve for Rs and Rp Yes (a) [54] Nonlinear equation solver Yes (Iph,Io,Rs,Rp and a) [55] non-linear least error to solve for Iph,Io and Rp Yes (Rs,Rp,a) A. Elkholy, A.A. Abou El-Ela Heliyon 5 (2019) e02137 3 Ipv ¼ Iph \u0002 Io 2 6 6 4exp \u0002 ðVpv þRs Ipv Þ nVt \u0003 \u0002 1 3 7 7 5 (4) where, Vt is the thermal voltage of a cell given by the following approximation [37]: Vt ¼ KTc q Authors in [40] identiﬁed the product of n*Vt in Eq. (4) as a single parameter denoted as (a). So, Eq. (4) can be written using the following equation. Ipv ¼ Iph \u0002 Io 2 6 6 4exp \u0002 ðVpv þRs Ipv Þ a \u0003 \u0002 1 3 7 7 5 (5) The L4P model needs the calculation of four parameters values, i.e. Iph,Io, a and Rs. The one diode model is widely used within speciﬁc software tool- boxes for estimating and predicting the produced power by PV systems and the algorithms of MPPT [41]. Different approaches of the single diode L5P model estimation studies are presented in Table 1. Several research studies presented different equations or approaches in order to be used for estimating L5P using manufacturer data sheet information [20, 21, 22, 42, 43, 44]. It can be found that, the L5P model demands extra information due to its complexity as presented in the second col- umn of Table 1, in addition to the data presented by the manufacturers datasheet at STC, i.e. Pmax,STC,Voc,STC,Isc,STC,Vmpp,STC,Impp,STC, αsc and βoc. Additional information about slopes at short circuit and open circuit points are needed as in [21, 22, 42, 43]. In the context of the PV simulator and array tester devices, this can be considered as a disadvantage because the PV module manufacturers do not provide these data readily. When the I-V curve and the slopes information are obtained, its passage to the simulator is not convenient. Extraction of PV module parameters using analytical methods can be achieved using data in manufacturers datasheet. In [45], the authors employed an empirical model of PV array based on an initial value of the Shockley diode ideality factor equal 2. Many authors discussed ways to estimate the correct value for this constant, but usually it is selected as 1 < a <1.5 according to [16, 37, 46]. There are other perspectives for estimating ideality factor because of the higher values are affecting on the curvature of I-V characteristics and values of resistances. According to [37], the most accurate value is near to operating point and provides good agreement with the experimental measured values. In [16], the authors used the manufacturer data sheet in order to estimate Rs and Rp initial values to ﬁt the maximum power point of theoretical and experi- mental measured curves. Many approaches of optimization techniques have been presented in order to extract ﬁve parameters of the PV model using experimentally measured I-V curves only [31, 32, 33, 34, 47]. This approaches in gen- eral, execute the ﬁtting methods to the experimental measured data without taking into account any theoretical values of the manufacturer data sheet. In the resolution of this uncertainty, several computing techniques have been presented recently. Authors in [48, 49], presented adaptive differential evolution algorithm for the extraction of L5P using synthetic and the experimentally measured I-V curve. In [50],an analytical method for the parameters extraction based on the manufac- turers data sheet only was presented. In [51], the authors modiﬁed the four parameters model in order to ﬁt the I-V curve by employing an equation to describe the Voc. The author in [52] proposed complex method to ﬁnd the L5P of the PV model. The author presented an analytical method to estimate the L4P using the manufacturer data sheet. Then, piecewise ﬁtting algorithm and L4P have been used in order to obtain two differential values for short circuit and open circuit points at STC. Finally, an explicit method was used to extract L5P at STC and to revise the ﬁve parameters with the experimentally measured data at the in-ﬁeld operating conditions. Authors in [53] employed an analytical method to calculate the initial values of series resistance and shunt resistances using manufactures data sheet. Then, Rs and Rp were estimated by means of ﬁtting to measured I-V characteristic using MATLAB based on Newton Raphson method opti- mization technique. By this way, the author avoided the negative values of Rs and Rp. It can be noticed that Rs and Rp were not affected by the irradiance and temperature. The author used the LabVIEW software to acquire the environmental conditions which affect on the photocurrent by means of sensors which measure the irradiance and temperature of the PV panel surface. Only Iph and Io were estimated considering the envi- ronmental conditions, while a, Rs, and Rp, were counted as constants for different weather conditions. To obtain accurate results, the effects of the various environmental conditions should be considered [24]. In [36], the authors presented analytical technique in order to esti- mate all parameters without any initial approximations or iterations. Also, this analytical technique was employed for estimating parameters of different PV cells technologies. This technique was programmed and implemented using C platform. The author in [54], presented hybrid approach of numerical and analytical methods. The obtained values of the analytical approach were used as an initial values for solving the nonlinear equations of the parameters in MATLAB. The author validated this approach using indoor and outdoor experimental measurements. A hybrid approach of numerical and analytical solution was presented by [55]. The author estimated Rs and the ideality factor n using analytical formulations based on the available data in the manufacturer's datasheet. The other three parameters of Iph,Io and Rp were extracted using measured I-V curves of PV module using the linear least squares method. But, the author appended the ideality factor equal to 1.3. Other model as in [17] required additional information such as air mass modiﬁer. Au- thors in [19] presented analytical equations to estimate the initial values of Rp,Rs and n using the available data in the manufacturer datasheet. Then, the model parameters were computed by solving the equations in the MATLAB environment by using the Newton Raphson method. The author highlighted that, the use of proper initial values leads to decrease the maximum number of iterations to 12. 2.1.1. Parameters for real outdoor weather conditions Generally, the PV modules are operating in different weather condi- tions consequently the required parameters are dependent on the envi- ronmental conditions such as solar radiation and temperature. Therefore, it is necessary to relate all parameters to outdoor conditions [2, 9, 40, 54]. The Iph values depend on the cell temperature and the irradiance. Iph can be calculated as the following equation [2, 52, 54]: Iph ¼ G GSTC \u0004Iph;STC þ αscðTc \u0002 TSTCÞ \u0005 (6) where, GSTC,Iph,STC, and TSTC are solar irradiance, photocurrent and cell temperature at STC conditions, respectively. G, Iph, and Tc are the rele- vant parameters at the real outdoor conditions, αsc is the current tem- perature coefﬁcient of the PV module. Reverse saturation current (Io) changes with PV cell temperature and can be computed using the following equation [52, 54]: Io ¼ Io;STC \u0002 Tc TSTC \u00033 exp \u0006 q Ka \u0002 Eg;STC TSTC \u0002 Eg Tc \u0003\u0007 (7) where, Io,STC and TSTC are the reverse saturation current and the PV cell temperature at STC conditions, respectively. Io and Tc are dependent on parameters at real outdoor condition. Eg,STC is the material band gap energy and equal to 1.121 eV for silicon PV cell at STC. The band gap energy (Eg) is slightly dependent on the PV cell A. Elkholy, A.A. Abou El-Ela Heliyon 5 (2019) e02137 4 temperature at outdoor conditions and can be expressed as follows [9, 52]: Eg ¼ Eg;STCð1 \u0002 0:0002677ðTc \u0002 TSTCÞÞ (8) Also, authors in [9] presented the formula of Eg as in Eq. (9), which is suitable for the silicon cells technology and the two diode model. Eg ¼ 1:17 \u0002 0:000473 T 2 c Tc þ 636 (9) The factor (a) can be estimated using the following equation [43, 52, 56]: a ¼ aSTC \u0006 Tc=TSTC \u0007 (10) The inﬂuence of Rs parameter cannot be neglected because it is responsible about the shape of I-V curve at maximum power point and depends on PV cell temperature and solar irradiance [52]. So, It is rational to determine Rs and Rp values corresponding to thermal pa- rameters of the material. The formula of Rs can be described as follows [2, 9, 52, 54, 56, 57]: Rs ¼ Rs;STC Tc TSTC \u0002 1 \u0002 βoc ln \u0006 G GSTC \u0007\u0003 (11) where, Rs,STC is the series resistance at STC conditions and Rs is the resistance value at the real outdoor weather condition. The value of βoc approaches 0.217. Concerning the parallel resistance, the high values of Rp lead to ﬂat slope of the short circuit point [52]. Authors in [9, 17, 56, 57] reported that, the Rp value is inversely proportional to the solar irradiance as follows: Rp ¼ Rp;STCGSTC G (12) where Rp,STC is the parallel resistance at STC conditions. Rp is the parameter values at the real outdoor weather condition. It can be noticed that the PV cell temperature Tc has signiﬁcant value for estimating other parameters at outdoor conditions. Tc can be repre- sented as a function of ambient temperature Ta and G using the following expression [9, 52]: Tc ¼ Ta þ G 800 ðTNOCT þ 293:15Þ (13) where, TNOCT is the nominal temperature of the PV cells at 800 W/m 2,an ambient temperature of 20 \u0004C and a wind speed of 1 ms -1. The PV module L4P can be obtained at the operating temperature and solar irradiance using Eq. (14) [40]: 8 >>>>>>>>>>>>>>< >>>>>>>>>>>>>>: Iph ¼ G Gref * \b Iph;STC þ αsc*ðTc \u0002 Tc;STCÞ \t Io ¼ Io;STC*exp \u0002\u0006 Eg a \u0007\u00061 \u0002 Tc;STC Tc \u0007\u0003 * \u0006 Tc Tc;STC \u00073 Rs ¼ Rs;STC a ¼ aSTC* \u0006 Tc Tc;STC \u0007 (14) These four parameters (Iph,Io,Rs, a) are corrected to the environ- mental conditions changes using Eq. (14) to be used in Eq. (5) 2.1.2. Analytical initial conditions of parameters extraction An unsuitable choice of bad initial parameters leads to increase the iteration number and sometimes leads to a divergence of the optimal solution [9, 36, 54]. In this section, literature on the analytical solutions are discussed to obtain the initial values for the numerical employed algorithm. The photocurrent (Iph,STC) was estimated as the short circuit current in many research studies. This assumption was considered as the best initial point in various reﬁned iterative algorithms [9]. But, authors in [54] presented the following equation to obtain Iph,STC at the standard test conditions: Iph;STC ¼ Io;STC* \u0002 exp \u0006 qðVoc;STCÞ NsaSTCKTc \u0007 \u0002 1 \u0003 þ Voc;STC Rp;STC (15) where, Io,STC is the dark saturation current at standard test conditions, aSTC is the diode ideality factor at standard test conditions and Ns is the number of series cells. Many authors as in [16] set the diode ideality equals 1. These values are accepted only for the ideal cell and cannot be accurate for a real diode. As reported and adopted by [9], real solar cells present high values of ideality factor (1 \u0005 n \u0005 2). Consequently, authors in [54] presented the following equation at the standard test conditions: aSTC ¼ q \u00042Vmpp;STC \u0002 Voc;STC\u0005 NsKT \" ln \u0006 1 \u0002 Impp;STC Isc;STC \u0007 þ Impp;STC ðIsc;STC \u0002Impp;STCÞ # (16) The saturation current is dependent on the cell temperature rise and it is a function of cell temperature, short circuit current and open circuit voltage. According to [53] and [9], the initial value of the saturation current can be expressed as follow: Io;STC ¼ Isc;STC exp \u0006 \u0002 qðVoc;STCÞ NsaSTC KTc \u0007 (17) Consequently, in [54], the authors used Eq. (18) in the ﬁnal calcu- lations, but it can be noted that the equation is function in Rs,STC,aSTC and Rp,STC.. So, the authors used Eq. (17) ﬁrstly to calculate the series and shunt resistances in order to avoid the rotating references. The main idea is that, the values of Iph,STC and Io,STC can be calculated, if the values of Rs, STC,aSTC and Rp,STC are known. Io;STC ¼ Isc;STC\u0004Rp;STC þ Rs;STC\u0005 \u0002 Voc;STC Rp;STC \u0002 exp \u0006 qðVoc;STCÞ NsaSTC KT \u0007 \u0002 exp \u0006 qðIsc;STC Rs;STCÞ NsaSTC KT \u0007\u0003 (18) When the Rs,STC value is set to a very low, this parameter can be neglected sometimes. However, many researchers assumed that the initial value of the Rs,STC is ﬁxed to zero. Authors in [9], used the following expression to compute Rs,STC: Rs;STC ¼ no* Vt I2 \u0002 I1*log \u0006 Iph \u0002 I2 Iph \u0002 I1 \u0007 \u0002 V2 \u0002 V1 I2 \u0002 I1 (19) where, (V2,I2) and (V1,I1) are two points on measured I-V curve, which are closed to the open circuit voltage point. Concerning the shunt resis- tance, the following formula can be used to calculate initial value of Rp,STC as: Rp;STC ¼ Vmpp;STC Isc;STC \u0002 Impp;STC \u0002 Voc;STC \u0002 Vmpp;STC Impp;STC (20) On the other hand in [54], The authors presented the following equation to calculate Rs,STC and Rp,STC as: Rs;STC ¼ Vmpp;STC Impp;STC \u0002 2Vmpp;STC \u0002 Voc;STC \u0004Isc;STC \u0002 Impp;STC\u0005\" ln \u0006 1 \u0002 Impp;STC Isc;STC \u0007 þ Impp;STC ðIsc;STC \u0002Impp;STCÞ # (21) A. Elkholy, A.A. Abou El-Ela Heliyon 5 (2019) e02137 5 Rp;STC ¼ ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ Rs;STC qIo;STC NsKTcaSTC exp \u0006 qðIsc;STC Rs;STCÞ NsKTcaSTC \u0007 v u u u t (22) In [19], the authors presented the following equations in order to calculate Rs,STC and Rp,STC as: Rs;STC ¼ VOC;STC \u0002 \u0002ln \u0006 Iph;STC \u0002Impp;STC Io;STC \u0007 NsVt \u0003 Impp;STC (23) Rp;STC ¼ Vmpp;STC þ Rs;STCImpp;STC Iph;STC \u0002 Io;STC \u0002 exp \u0006 Vmpp;STC þRs;STC Impp;STC NsVt aSTC \u0007 \u0002 1 \u0003 \u0002 Impp;STC (24) Authors in [20], presented a procedure to estimate the L5P of one diode model using performance tabular data that have the minimal data provided by PV manufacturers data sheet. The resistances Rs,STC and Rp, STC are extracted using the graphical data given by the manufacturers. Also, three analytical correlations are deﬁned based on the performance data for more than one hundred PV modules. Reciprocal for slope of I-V curve is dependent on the short circuit and the open circuit points cor- responding to Rp,STC and Rs,STC, respectively. Finally, The authors rep- resented Rs,STC and Rp,STC using the following empirical equation: Rs;STC ¼ CsVoc Isc ; Rp;STC ¼ CshVoc Isc (25) where, Cs ¼ 0.11175 and Cp ¼ 34.49692. The following analytical expressions are used as a start point for a numerical solution. The following approximations as in Eq. (26) are used to determine the initial values of the L4P at the standard test conditions as [40]: 8 >>>>>>>>>>>>>>< >>>>>>>>>>>>>>: Iph;STC ¼ Isc;STC aSTC ¼ βoc*Tc;STC \u0002 Voc;STC þ Eg\u0004Tc;STC*αsc Iph;STC\u0005 \u0002 3 Io;STC ¼ Iph;STC exp½ðVoc;STC aSTCÞ\u0002 1\u0006 Rs;STC ¼ aSTC*ln \b 1 \u0002 \u0004Impp;STC Iph;STC\u0005\t \u0002 Vmpp;STC þ Voc;STC Impp;STC (26) 3. Methodology 3.1. Methodology of the proposed approach To estimate the performance of PV systems, reliable and effective predictive tools are important and must be sensitive to all the physical parameters. Predictive performance tools are used by designers of the PV systems to optimize the system performance and to maximize the cost effectiveness of the systems. It is better to use less accurate predictive tool that is suitable to represent the electrical behavior of PV cell by means of minimum technical data which is provided by the manufacturer data sheet [20]. An accurate performance estimation is dependent on the accurate estimation of the PV cell parameters. In [17], the authors presented a model to predict the energy pro- duction and compared with the developed model by Sandia National Laboratory. The author used an external computational (commercial) software i.e. the engineering equation solver (EES). The integration of this software to stand-alone PV simulator, which is coded in LabView and C, may leads to incompatibility issues. The computational speed of this simulator is expected to be compromised in case of more data points on the I-V curve, which are utilized [24]. The authors in [36] presented an analytical technique which was programmed and implemented using C platform. Authors in [20] presented a simple BASIC routine to determine the parameters. This routine was easily used, like Visual Basic (VB) macros in Microsoft Excel. Complex mathematical software packages such as SPICE, Mathema- tica and Matlab can carry out the nonlinear least squares ﬁtting (NLSF). These programs have built in additional features such as the statistical tests to determine the conﬁdence of the best ﬁt and the advanced pro- cedures such as the automated global ﬁts [58]. Although such tools are used in the power electronics and for engineering applications, it might be beneﬁcial to use Microsoft Excel, which is widely used for diverse calculations. Excel solver has been used in numerous and different ap- plications. The authors in [58], introduced and described all details about the Excel solver. Using Excel, a wider class of students can be enabled to become more interested in studying PV systems. Thus, this work presents a proposd approach using Microsoft Excel, where Microsoft Excel is used to model and estimate the optimal parameters of PV modules. Output values of solar simulator and array tester devices are used as input to the devel- oped Excel worksheet. It is noted that, Eq. (5) is implicit and involves the Start Read G, T and manufactures datasheet parameters Read experimental values of measured I-V curve Calculate real time values of Io,Iph,a ,Rs and Rp Solve implicit equation of current (Eq.(4)) Update optimal solution Calculate statistical errors RMS or NRMS Check stopping criteria End No Yes Calculate initial values using analytical solutions Io,STC,Iph,STC,astc ,Rs,STC and Rp,STC Using nonlinear least square fitting in Excel Print optimal values of estimated parameters Superimpose I-V curves Simulated current Is local sol. < optimal sol. Yes No Fig. 3. Parameters' estimation ﬂow chart using the proposed approach. A. Elkholy, A.A. Abou El-Ela Heliyon 5 (2019) e02137 6 overall output current generated by the PV module in both sides at the same time. Furthermore, the parameters Iph,Io,Rs, a and Rp are varied with the solar irradiance and ambient temperature depending on the manufacturing tolerance [31]. The presented approach, to extract the optimal parameters of the PV module, is based on the least-squares ﬁtting (LSF), i.e. by minimizing the difference between measured data point (Imeasured) and its calculated counterpart (Imodel). The evaluation is going on all data points which are considered in the regression analysis. This evaluation is used to guar- antee the accuracy of the model using the real data [59]. Many references used the standard error analysis like the root mean squared error (RMSE) and mean absolute error (MAE) to determine the accuracy of their methods [24]. The employed objective function is to minimize the sum squared residuals between the measured data and simulation results and employ the relative weighting based on the measured data. The per- centage RMS errors are presented as follows [51]: RMSð%Þ¼ \" 1 nPn i¼1ðIi;measured \u0002 Ii;modelÞ 2#1 2 Pn i¼1Ii;measured \u0003 100 (27) Statistical analysis was performed to represent the accuracy using the normalized root mean square error (NRMSE), given by [55]: NRMSE ¼ \" 1 nPn i¼1ðIi;measured \u0002 Ii;modelÞ 2#1 2 1 nPn i¼1Ii;measured (28) This approach is practically straightforward and applicable whenever the error scales employ the measured variable as relative weight. The implementation of the proposed approach to ﬁnd the optimal parameters of the PV modules using the measured data and the simulated data is shown in the ﬂow chart as in Fig. 3. The simplicity of this approach makes it handy for power electronics engineers, assists the designers with an effective tool for accurate analysis and simulation of the PV modules. 4. Experimental 4.1. Experimental measurements of the studied case 4.1.1. Characteristics of PV module In order to validate the PV model using in-ﬁeld measurements, an experimental setup using the PV module TRINA-295 PC14 (Poly- crystalline cells) and the array tester is established for detailed modeling. The PV module provides 295 W of nominal power and consists of 72 cells connected in series. The measurements of the I-V and P-V characteristic Table 2 Electrical data of TSM-295 PV module at stan- dard test conditions. Parameters Values Isc (A) 8.55 Voc (V) 45.2 Vmpp (V) 36.6 Impp (A) 8.07 βoc (%/K) - 0.33 αsc (%/K) 0.046 0 2 4 6 8 10 0 5 10 15 20 25 30 35 40 45 50 Voltage (V)Current (A) Measured Excel worksheet model Fig. 4. PV module TSM-295 I-V curves for the experimental measurements and the L4P Excel worksheet model. 0 50 100 150 200 250 300 0 5 10 15 20 25 30 35 40 45 50 Voltage (V) Power (W) Measured Excel worksheet model Fig. 5. PV module TSM-295 P-V curves for the experimental measurements and the L4P Excel worksheet model. A. Elkholy, A.A. Abou El-Ela Heliyon 5 (2019) e02137 7 curves of the considered PV module technology are performed with the array tester 550 at the Electronics Research Institute, Egypt. Experi- mental evaluation and characterization for power quality parameters of 8 kW grid connected system and all details about the considered ﬁeld location in this paper can be found in [60, 61]. The solar irradiance and the ambient temperature as well as the I-V, P-V curves are all measured by the array tester 550, which is a reference cell and array tester. The tester contains a data acquisition card connected to a personal computer, and the output data can be collected using LabVIEW software. The manufacturer speciﬁcations of the PV module at the standard test con- ditions are presented in Table 2. The importance of parameters estimation are presented using the measured actual data at the real outdoor conditions rather than the in- formation given by the datasheet only. Developed Excel worksheet is constructed using the parameters given in the datasheet at the STC for PV module TRINA TSM-295 PC14. Firstly, by using Eq. (26) and the manufacture template data, the analytical solution of the four parameters initial values at STC conditions can be calculated. Then, the four pa- rameters of the L4P model (Iph,Io,Rs, a) are corrected to the real time measurement values of solar irradiance and ambient temperature using Eq. (14) and to be used in Eq. (5). The simulation results of the I-V and P-V curves are compared to the 0 2 4 6 8 10 0 5 10 15 20 25 30 35 40 45 50 Voltage (V)Current (A) Measured Excel worksheet model Fig. 6. PV module TSM-295 I-V curves for the experimental measurements and the ﬁtted L4P model using Excel worksheet at 999.5 W/m2 and 29 \u0004C. 0 50 100 150 200 250 300 0 5 10 15 20 25 30 35 40 45 50 Voltage (V) Power (w) Measured Excel worksheet model Fig. 7. PV module TSM-295 P-V curves for the experimental measurements and the ﬁtted L4P model using Excel worksheet model at 999.5 W/m2 and 29 \u0004C. 0 2 4 6 8 10 0 5 10 15 20 25 30 35 40 45 50 Voltage (V)Current (A) Measured Excel worksheet model Fig. 8. PV module TSM-295 I-V curve for the experimental measurements and the ﬁtted L4P model using Excel worksheet at 801.8 W/m2 and 30 \u0004C. A. Elkholy, A.A. Abou El-Ela Heliyon 5 (2019) e02137 8 measurement results as provided in Figs. 4 and 5. These results show the difference between the analytical solution output obtained from the datasheet values at STC and the outdoor measured data. These results conﬁrm that, estimated parameters which are dependent on the infor- mation given by the manufacturer data sheet only, have drawbacks and not more accurate to be applied for performance analysis. 4.1.2. Implementation of least squares data ﬁtting The importance of the algorithm is to ﬁt the PV module current as in Eq. (3) for each measured I-V points. For each I-V curve, set of parameter values (i.e., Iph,Io,Rs,Rp, a) are obtained. Parameter values of the PV model are estimated by ﬁtting the simulated I-V curve at the irradiance and temperature conditions with the measured I-V curve. The imple- mentation of the nonlinear least-squares technique, to ﬁnd the parame- ters of the PV module is shown in details in ﬂow chart presented in Fig. 3. To relieve the effects of cabling connections on the calculated values of Rs, currents and voltages measurements are obtained at the PV module terminals. The proposed approach of data ﬁtting with the aid of Excel worksheet and solver can be divided into the following steps: (i) The RMS or NRMSE 0 50 100 150 200 250 300 0 5 10 15 20 25 30 35 40 45 50 Voltage (V)Power (W) Measured Excel worksheet model Fig. 9. PV module TSM-295 P-V curves for the experimental measurements and the ﬁtted L4P model using Excel worksheet model at 801.8 W/m2 and 30 \u0004C. 0 2 4 6 8 10 0 5 10 15 20 25 30 35 40 45 50 55 60 65 70 75 80 85 90 Voltage (V)Current (A) Measured Excel worksheet model Fig. 10. Two series TSM-295 modules I-V curve for experimental measurements and Excel worksheet model at 694 W/m2 and 31 \u0004C. 0 80 160 240 320 400 0 5 10 15 20 25 30 35 40 45 50 55 60 65 70 75 80 85 90 PV Module Voltage (V) Power (W) Measured Excel worksheet model Fig. 11. Two series TSM-295 module P-V curve for experimental measurements and Excel worksheet model at 694 W/m2 and 31 \u0004C. A. Elkholy, A.A. Abou El-Ela Heliyon 5 (2019) e02137 9 0 2 4 6 8 10 0 20 40 60 80 100 120 140 160 180 Voltage (V)Current (A) Measured Excel worksheet model Fig. 12. Four series TSM-295 modules I-V curve for experimental measurements and Excel worksheet model at 653.8 W/m2 and 30 \u0004C. 0 120 240 360 480 600 720 0 20 40 60 80 100 120 140 160 180 Voltage (V) Power (W) Measured Excel worksheet model Fig. 13. Four series TSM-295modules P-V curve for experimental measurements and Excel worksheet model. 653.8 W/m2 and 30 \u0004C. 0.2 0.35 0.5 0.65 0.8 0.95 1.1 1.25 0.27 0.29 0.31 0.33 0.35 0.37 0.39 Rs (Ohm)RMS (a)Rs 0.2 0.35 0.5 0.65 0.8 0.95 2.615 2.62 2.625 aRMS (c)a 0.4 0.44 0.48 0.52 0.56 0.6 0.64 8.06 8.08 8.1 8.12 8.14 Iph (A)RMS (b) I ph 0 0.3 0.6 0.9 1.2 1.5 3.6 3.7 3.8 3.9 4 4.1 Io (10^-7 A)RMS (d)Io Fig. 14. Convergence characteristics L4P. A. Elkholy, A.A. Abou El-Ela Heliyon 5 (2019) e02137 10 between the measured and calculated data are computed using an Excel worksheet. (ii) The Solver add-in is adopted with the help of visual basic. The objective function is to minimize RMS or NRMSE. Excel worksheet cells, which contain the values of the required parameters are speciﬁed. (iii) The ﬁtting procedure is repeated many times using the estimated values of the adjustable parameters at each step. (iv) The conﬁdence of the estimated parameter value is assessed by ﬁxing the investigated parameter at a value, which is slightly different from the optimal one. Figs. 6 and 7 show the PV module I-V and P-V characteristics obtained using the implemented model after the curve ﬁtting with the obtained experimentally measured curve at solar radiation 999.5 W/m 2 and ambient temperature 29 \u0004C. These ﬁgures illustrate an excellent agree- ment between the measurements and the developed model output. Further, as shown in Figs. 8 and 9, the developed Excel worksheet model of I-V and P-V characteristics show excellent agreement with the similar measurements of solar radiation value 801.8 W/m 2 and ambient tem- perature value 30 \u0004C. These ﬁgures show the capability, efﬁciently and accurately of the estimated parameters using the proposed approach. 5. Analysis 5.1. Analysis of the proposed approach validation The characteristics of two and four series connected PV modules are simulated using the proposed approach and their response are ﬁtted to the experimental measurements as shown in Figs. 10, 11, 12, and 13. The proposed Excel worksheet approach for I-V and P-V curves show excel- lent agreement with the experimental measurements of various PV modules connections at different weather conditions. In case of double series modules, as shown in Figs. 10 and 11, the solar radiation value is 694 W/m 2 and the ambient temperature value is 31 \u0004C. Finally, in the case of four series modules as shown in Figs. 12 and 13, the solar radi- ation value is 653.8 W/m 2 and the ambient temperature value is 30 \u0004C. The conﬁdence of the estimated parameter values are assessed by ﬁxing the parameter to be inspected at a value which is somewhat different from the optimal one. The convergence characteristics of the estimated L4P parameters of polycrystalline PV module TSM-295 are presented in Table 3 PV module TSM-295 estimated four parameters. Parameters One Module Two series modules Four series modules 999.5 W/ m2 29 \u0004C 800 W/ m2 31 \u0004C 694.6 W/m2 29 \u0004C 653.8W/m2 30 \u0004C Iph (A) 8.10563 6.39638 5.40645 4.78159 Io (μA) 0.3838 0.0412 1.4277 2.0224 Rs (Ω) 0.32828 0.36944 0.5137 0.753788 a 2.62166 2.39017 2.785 2.8136 RMS 0.45409 0.47955 1.46412 1.31754 Table 4 PV module TSM-295 estimated ﬁve parameters. Parameters One Module Two series modules Four series modules 999.5 W/m2 29 \u0004C 800 W/m 2 31 \u0004C 694.6 W/m 2 29 \u0004C 653.8W/m2 30 \u0004C Iph (A) 8.17229 6.48199 5.57698 4.89626 Io (A) 9.626*10\u000208 5.2983*10 \u000209 2.9813*10\u000209 3.61186E-08 Rs (Ω) 0.35709 0.417502 0.89404 1.31563 Rp (Ω) 275.394 246.5277 204.15651 519.56788 a 2.42461 2.15729 3.96764 8.8544 RMS 0.36762 0.35286 0.63126 0.69288 Table 5 Estimated parameters of different PV modules. Estimated parameters SST 230 Polycrystalline Shell SP75 Monocrystalline Shell SQ150 Monocrystalline Shell ST40 Thin-ﬁlm [51] Proposed Method [51] Proposed Method [51] Proposed Method [51] Proposed Method Estimated parameters of L4P Iph (A) 8.52 8.53589 4.8 4.80384 4.8 4.79774 2.68 2.64875 Io (μA) 3.6230 2.7625 1.4356 1.26706 1.4356 1.25554 0.44734 0.81055 Rs (Ω) 0.1293 0.15548 0.2524 0.28763 0.5048 0.52452 1.3582 1.29649 a 1.6230 2.46294 1.5619 1.43433 1.5619 2.86493 1.6144 1.55947 Estimated parameters of L5P Iph (A) 8.52 8.53831 4.8 4.84726 4.8 4.85293 2.68 2.72079 Io (μA) 0.094629 1.56212 0.06957 1.44837 0.06975 1.4953 0.010264 1.0189 Rs (Ω) 0.2 0.16864 0.33 0.25283 0.67 0.50448 1.52 1.28792 Rp (Ω) 152.6382 2029.069 236.768 200.9878 466.46 402.153 284.1 373.1949 a 1.3 1.5382 1.3 1.5635 1.3 1.567 1.3 1.7078 Fig. 15. Polycrystalline module SST230 I-V characteristics using the proposed approach. A. Elkholy, A.A. Abou El-Ela Heliyon 5 (2019) e02137 11 Fig. 14. The estimated L4Ps are obtained and listed in Table 3. Firstly, by using Iph,STC ¼ Isc,STC and aSTC as in Eq. (26) as well as Eqs. (17), (19), and (20) and the manufacture template data, the parameters, Io,STC,Rs,STC, Rp,STC at STC conditions are determined, correspondingly. According to the real-time measurement values of solar irradiance and ambient tem- perature, the ﬁve parameters of the L5P model are calculated using Eqs. (6), (7), and (11) of Iph,Io,Rs corresponding, Rp ¼ Rp,STC and a ¼ aSTC. Also, Eg can be calculated using Eq. (8), While Eg,STC ¼ 1.17. The esti- mated parameters are obtained and listed in Table 4 as method 1. Fig. 16. Monocrystalline module SQ150 I-V characteristics using the proposed approach. Fig. 17. Thin-ﬁlm module ST40 I-V characteristics using the proposed approach. Table 6 RMS Errors four parameter model calculated for SQ150, ST40 and SST230 modules (at T ¼ 25 \u0004C). Irradiance (W/m 2) SST 230 SQ150 ST40 [51] Proposed Method [51] Proposed Method [51] Proposed Method RMS error four parameter model (%) 1000 0.1082 0.13706 0.3125 0.30373 1.7421 1.43279 800 1.6553 0.2455 0.3005 0.25849 1.8300 1.03668 400 0.9864 0.1494 0.3827 0.21219 1.6951 1.43343 RMS error ﬁve parameter model (%) 1000 0.3313 0.07695 0.3313 0.50679 2.2239 0.96499 800 0.8523 0.20318 0.8523 0.73614 2.1550 1.11751 400 1.5111 0.17984 1.5111 1.35779 2.2515 0.87807 Table 7 PV module KC-200GT estimated parameters. Calculated parameters Kyocera KC-200GT [16] Proposed Method [50] [19] [14] [55] [41] Iph (A) 8.214 8.1542 8.2132 - 8.2119 8.211 8.2252 Io (μA) 0.09825 1.9113 0.097631 - 0.17097 0.00212 0.0076324 Rs (Ω) 0.221 0.0759 0.221 0.2198 0.2172 0.233 0.1958 Rp (Ω) 415.405 750.2459 597.3855 991.5159 951.3267 132.88 106.0344 a 1.3 1.551 1.3 1.3370 1.3405 1.0758 1.1833 NRMSE 0.0251 0.00808 0.0269 - - 0.0086 0.0124 A. Elkholy, A.A. Abou El-Ela Heliyon 5 (2019) e02137 12 6. Results and discussion In this section, the estimated L4P and L5P are compared with other research studies. The estimated L4P and L5P described in this paper are validated by estimating the parameters of three different modules such as polycrystalline, amorphous, and thin ﬁlm as presented in Table 5. The identiﬁed parameters are compared with previously reported study given in [51]. The Iph,STC and Io,STC can be computed after obtaining the values of aSTC,Rs,STC and Rp,STC using Eqs. (15), (18), (16), (21), and (22) for L5P of the single diode PV model. Io,STC is computed ﬁrstly using Eq. (17) in order to facilitate the calculations of Rs,STC and Rp,STC, then Iph,STC can be computed using Io,STC. as in Eq. (18) to avoid the rotating references. According to real-time measurement values of solar irradiance and ambient temperature, the ﬁve parameters of L5P are calculated depen- dent on Eqs. (6), (7), (11), and (12) of Iph,Io,Rs and Rp, respectively, and a ¼ aSTC.Eg can be calculated using Eq. (8), while Eg,stc ¼ 1.17. Finally, The estimated parameters are obtained and listed in Table 5 as method 2. Figs. 15, 16, and 17 present comparison for some of the results that are obtained at different operating conditions using the proposed L5P approach. The obvious conclusion from these ﬁgures is that the I-V curves generated by the L5P model are accurate in ﬁtting with the measured data which are given by the corresponding module manufacturers for different PV cell technologies. Table 6 exhibits the RMS errors that are obtained using the proposed approach of L4P and L5P for three types of PV cells with different tech- nologies. It can be noticed that, the proposed approach provides the best match with the experimental data compared with the results by [51]. Also, the proposed approach can be integrated into the sun simulator and array tester devices. The extracted ﬁve parameters of Kyocera KC-200 GT PV module are shown in Table 7. The identiﬁed model parameters and NRMSE per- centage of the proposed method of Kyocera KC-200 GT PV module are compared with [16, 41, 50, 55]. The authors in [55], presented an analytical expression for estimating the series resistance and the ideality factor using datasheet information and employed the least squares method for solving the three equations of saturation current, photocur- rent and shunt resistance. Authors in [41, 55] presented lower than ex- pected values of the ideality factor and the saturation current and consequently, led to the low value of the shunt resistance. The differences between these parameter values using these researches and the proposed approach are due to the lack of accurate initial conditions. The proposed approach using Excel worksheet employs ﬁve analytical equations to estimate initial values and solves for the optimal values of ﬁve parame- ters, simultaneously, based on the least squares method. The authors in [14], reviewed and evaluated six analytical methods for modeling and extracting circuit parameters of KC200GT PV module. The authors compared the results with an iterative method as in [19] and the Nu- merical method, Newton-Raphson as in [16]. Also, the authors in [14], concluded that the analytical methods can compete in terms of accuracy with their numerical counterparts. In [19], the authors used Newton Raphson method in order to solve the equations of Rs,Rp and ideality factor by starting from the presented analytical initial values. Results in [14] were presented based on the presented method by [19]. It can be noticed that the difference between results of Kyocera KC-200 GT PV module are due to the impact of initial values as well as the main effect of the employed formula for the ideality factor and the saturation current. 7. Conclusions This paper presents a proposed approach to estimate the parameters of PV module using the experimental measurements based on the nonlinear least-squares algorithm. This approach has been implemented to estimate parameters of 295W polycrystalline TRINA TSM-295 PC14 PV module using the single diode models. Good agreement has been obtained between the simulation output with the calculated parameters and the experimental measurements at different environmental conditions. The developed Excel worksheet can facilitate to study PV system performance, design and analysis of various technologies of PV cells. In this way, the proposed approach is expected to be useful in the development of the solar cells simulator, degradation analysis and for development of MPP tracking algorithms, employing few steps and few milliseconds execution times using a simple notebook. Finally, It is concluded that the proposed approach can be employed as an easy tool for the PV power converter designers and the circuit simulator de- velopers. In the future work, the impact of different operating conditions such as the dynamic shading of PV modules can be studied. Finally, the proposed Excel worksheet approach for PV module modeling can be implemented in an optimization toolbox with the aid of visual basic and presented handy method for power electronics engineers and designers. Declarations Author contribution statement A. Elkholy: Conceived and designed the experiments; Performed the experiments; Analyzed and interpreted the data; Contributed reagents, materials, analysis tools or data; Wrote the paper. A. A. Abou El-Ela: Conceived and designed the experiments; Contributed reagents, materials, analysis tools or data; Wrote the paper. Funding statement This research did not receive any speciﬁc grant from funding agencies in the public, commercial, or not-for-proﬁt sectors. Competing interest statement The authors declare no conﬂict of interest. Additional information No additional information is available for this paper. References [1] E.I. Batzelis, S.A. Papathanassiou, A method for the analytical extraction of the single-diode PV model parameters, IEEE Trans. Sustain. Energy 7 (2) (2016) 504–512. [2] A.R. Jordehi, Parameter estimation of solar photovoltaic (PV) cells: a review, Renew. Sustain. Energy Rev. 61 (2016) 354–371. [3] W. Kim, W. Choi, A novel parameter extraction method for the one-diode solar cell model, Sol. Energy 84 (6) (2010) 1008–1019. [4] S. Vergura, A.M. Pavan, On the photovoltaic explicit empirical model: operations along the current-voltage curve, in: 2015 International Conference on Clean Electrical Power (ICCEP), IEEE, 2015. [5] A.M. Pavan, S. Castellan, G. Sulligoi, An innovative photovoltaic ﬁeld simulator for hardware-in-the-loop test of power conditioning units, Clean Electrical Power, in: International Conference on. 2009, IEEE, 2009. [6] F. Rasool, et al., PV panel modeling with improved parameter extraction technique, Sol. Energy 153 (2017) 519–530. [7] S. Bana, R. Saini, A mathematical modeling framework to evaluate the performance of single diode and double diode based SPV systems, Energy Rep. 2 (2016) 171–187. [8] T.U. Townsend, The Long-Term Performance of Direct-Coupled Photovoltaic Systems, University of Wisconsin-Madison, 1989. [9] A.K. Tossa, et al., A new approach to estimate the performance and energy productivity of photovoltaic modules in real operating conditions, Sol. Energy 110 (2014) 543–560. [10] D. Chan, J. Phillips, J. Phang, A comparative study of extraction methods for solar cell model parameters, Solid State Electron. 29 (3) (1986) 329–337. [11] J. Charles, et al., A practical method of analysis of the current-voltage characteristics of solar cells, Sol. Cells 4 (2) (1981) 169–178. [12] A. Braunstein, J. Bany, J. Appelbaum, Determination of solar cell equation parameters from empirical data, Energy Convers. 17 (1) (1977) 1–6. [13] J. Phang, D. Chan, J. Phillips, Accurate analytical method for the extraction of solar cell model parameters, Electron. Lett. 20 (10) (1984) 406–408. [14] H. Ibrahim, N. Anani, Evaluation of analytical methods for parameter extraction of PV modules, Energy Procedia 134 (2017) 69–78. A. Elkholy, A.A. Abou El-Ela Heliyon 5 (2019) e02137 13 [15] E. Saloux, A. Teyssedou, M. Sorin, Explicit model of photovoltaic panels to determine voltages and currents at the maximum power point, Sol. Energy 85 (5) (2011) 713–722. [16] M.G. Villalva, J.R. Gazoli, E. Ruppert Filho, Comprehensive approach to modeling and simulation of photovoltaic arrays, IEEE Trans. Power Electron. 24 (5) (2009) 1198–1208. [17] W. De Soto, S. Klein, W. Beckman, Improvement and validation of a model for photovoltaic array performance, Sol. Energy 80 (1) (2006) 78–88. [18] D. Sera, R. Teodorescu, P. Rodriguez, PV panel model based on datasheet values, Industrial Electronics, in: ISIE 2007. IEEE International Symposium on. 2007, IEEE, 2007. [19] H. Can, D. Ickilli, Parameter estimation in modeling of photovoltaic panels based on datasheet values, J. Sol. Energy Eng. 136 (2) (2014), 021002. [20] A. Orioli, A. Di Gangi, A procedure to calculate the ﬁve-parameter model of crystalline silicon photovoltaic modules on the basis of the tabular performance data, Appl. Energy 102 (2013) 1160–1177. [21] M. De Blas, et al., Selecting a suitable model for characterizing photovoltaic devices, Renew. Energy 25 (3) (2002) 371–380. [22] A.H. Arab, F. Chenlo, M. Benghanem, Loss-of-load probability of photovoltaic water pumping systems, Sol. Energy 76 (6) (2004) 713–723. [23] M. Hejri, et al., On the parameter extraction of a ﬁve-parameter double-diode model of photovoltaic cells and modules, IEEE J. Photovolt. 4 (3) (2014) 915–923. [24] V.J. Chin, Z. Salam, K. Ishaque, Cell modelling and model parameters estimation techniques for photovoltaic simulator application: a review, Appl. Energy 154 (2015) 500–519. [25] A.A. El Tayyan, A simple method to extract the parameters of the single-diode model of a PV system, Turk. J. Phys. 37 (1) (2013) 121–131. [26] T. Easwarakhanthan, et al., Nonlinear minimization algorithm for determining the solar cell parameters with microcomputers, Int. J. Sol. Energy 4 (1) (1986) 1–12. [27] A. Ortiz-Conde, F.J.G. S\u0002anchez, J. Muci, New method to extract the model parameters of solar cells from the explicit analytic solutions of their illuminated I–V characteristics, Sol. Energy Mater. Sol. Cells 90 (3) (2006) 352–361. [28] H. Saleem, S. Karmalkar, An analytical method to extract the physical parameters of a solar cell from four points on the illuminated $ J {-} V $ curve, IEEE Electron. Device Lett. 30 (4) (2009) 349–352. [29] D.S. Chan, J.C. Phang, Analytical methods for the extraction of solar-cell single-and double-diode model parameters from IV characteristics, IEEE Trans. Electron Devices 34 (2) (1987) 286–293. [30] A. Jain, A. Kapoor, Exact analytical solutions of the parameters of real solar cells using Lambert W-function, Sol. Energy Mater. Sol. Cells 81 (2) (2004) 269–277. [31] M. AlHajri, et al., Optimal extraction of solar cell parameters using pattern search, Renew. Energy 44 (2012) 238–245. [32] N. Rajasekar, N.K. Kumar, R. Venugopalan, Bacterial foraging algorithm based solar PV parameter estimation, Sol. Energy 97 (2013) 255–265. [33] A. Askarzadeh, A. Rezazadeh, Parameter identiﬁcation for solar cell models using harmony search-based algorithms, Sol. Energy 86 (11) (2012) 3241–3249. [34] A. Askarzadeh, A. Rezazadeh, Extraction of maximum power point in solar cells using bird mating optimizer-based parameters identiﬁcation approach, Sol. Energy 90 (2013) 123–133. [35] C. Zhang, et al., A simple and efﬁcient solar cell parameter extraction method from a single current-voltage curve, J. Appl. Phys. 110 (6) (2011), 064504. [36] G. Kumar, A.K. Panchal, A non-iterative technique for determination of solar cell parameters from the light generated IV characteristic, J. Appl. Phys. 114 (8) (2013), 084904. [37] C. Carrero, J. Amador, S. Arnaltes, A single procedure for helping PV designers to select silicon PV modules and evaluate the loss resistances, Renew. Energy 32 (15) (2007) 2579–2589. [38] H. Fathabadi, Novel neural-analytical method for determining silicon/plastic solar cells and modules characteristics, Energy Convers. Manag. 76 (2013) 253–259. [39] N. Das, H. Wongsodihardjo, S. Islam, Modeling of multi-junction photovoltaic cell using MATLAB/Simulink to improve the conversion efﬁciency, Renew. Energy 74 (2015) 917–924. [40] D. Rekioua, E. Matagne, Optimization of Photovoltaic Power Systems: Modelization, Simulation and Control, Springer Science & Business Media, 2012. [41] A. Laudani, F.R. Fulginei, A. Salvini, High performing extraction procedure for the one-diode model of a photovoltaic panel from experimental I–V curves by using reduced forms, Sol. Energy 103 (2014) 316–326. [42] G. Walker, Evaluating MPPT converter topologies using a MATLAB PV model, J. Electr. Electron. Eng. Aust. 21 (1) (2001) 49. [43] A. Chouder, et al., Modeling and simulation of a grid connected PV system based on the evaluation of main PV module parameters, Simul. Model. Pract. Theory 20 (1) (2012) 46–58. [44] A. Laudani, et al., Reduced-form of the photovoltaic ﬁve-parameter model for efﬁcient computation of parameters, Sol. Energy 97 (2013) 122–127. [45] S. Chowdhury, et al., Modelling, simulation and performance analysis of a PV array in an embedded environment, in: Universities Power Engineering Conference, 2007. UPEC 2007, IEEE, 2007, 42nd International. [46] A.H. ALQahtani, A simpliﬁed and accurate photovoltaic module parameters extraction approach using matlab, Industrial Electronics (ISIE), in: IEEE International Symposium on. 2012, IEEE, 2012. [47] M. AlRashidi, K. El-Naggar, M. AlHajri, Heuristic approach for estimating the solar cell parameters, Recent Res. Appl. Inf. Sci. (2012) 80–83. [48] L.L. Jiang, D.L. Maskell, J.C. Patra, Parameter estimation of solar cells and modules using an improved adaptive differential evolution algorithm, Appl. Energy 112 (2013) 185–193. [49] R. Tamrakar, A. Gupta, Extraction of solar cell modelling parameters using differential evolution algorithm, Int. J. Innov. Res. Elec., Electron., Instrument. Contr. Engineering 3 (11) (2015). [50] J. Cubas, S. Pindado, M. Victoria, On the analytical approach for modeling photovoltaic systems behavior, J. Power Sources 247 (2014) 467–474. [51] R. Khezzar, M. Zereg, A. Khezzar, Modeling improvement of the four parameter model for photovoltaic modules, Sol. Energy 110 (2014) 452–462. [52] J. Bai, et al., Development of a new compound method to extract the ﬁve parameters of PV modules, Energy Convers. Manag. 79 (2014) 294–303. [53] F. Adamo, et al., Parameters estimation for a model of photovoltaic panels, in: XIX IMEKO World Congress Fundamental Applied Metrology, Portugal, Lisbon, September. 2009. [54] M. Kumar, A. Kumar, An efﬁcient parameters extraction technique of photovoltaic models for performance assessment, Sol. Energy 158 (2017) 192–206. [55] N. Maouhoub, Photovoltaic module parameter estimation using an analytical approach and least squares method, J. Comput. Electron. 17 (2) (2018) 784–790. [56] M. Siddiqui, M. Abido, Parameter estimation for ﬁve-and seven-parameter photovoltaic electrical models using evolutionary algorithms, Appl. Soft Comput. 13 (12) (2013) 4608–4621. [57] T. Ma, H. Yang, L. Lu, Development of a model to simulate the performance characteristics of crystalline silicon photovoltaic modules/strings/arrays, Sol. Energy 100 (2014) 31–41. [58] G. Kemmer, S. Keller, Nonlinear least-squares data ﬁtting in Excel spreadsheets, Nat. Protoc. 5 (2) (2010) 267. [59] A.M. Humada, et al., Modeling and characterization of a grid-connected photovoltaic system under tropical climate conditions, Renew. Sustain. Energy Rev. (2017). [60] A. Elkholy, et al., Experimental evaluation of 8 kW grid-connected photovoltaic system in Egypt, J. Electric. Syst. Inf. Technol. 3 (2) (2016) 217–229. [61] A. Elkholy, Harmonics assessment and mathematical modeling of power quality parameters for low voltage grid connected photovoltaic systems, Sol. Energy 183 (2019) 315–326. A. Elkholy, A.A. Abou El-Ela Heliyon 5 (2019) e02137 14","libVersion":"0.3.2","langs":""}