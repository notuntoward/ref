{"path":"lit/sources/Jin19physInvNN.pdf","text":"A Physics-Driven Deep Learning Network for Subsurface Inversion Yuchen Jin, Xuqing Wu, Jiefu Chen University of Houston Houston, TX, United States Yueqin Huang Cyentech Consulting LLC Cypress, TX, United States Abstract—Subsurface inversion is an essential technique for many applications including seismic processing, oilﬁeld well logging an geosteering. Conventional inverse methods based on optimization are time-consuming and sensitive to initial values. The traditional lookup table approach which is limited by the table size could reduce the computational time but only achieves low accuracy. To solve these issues, we propose a physics-driven Deep Neural Network (PhDNN) for solving non-linear inverse problems. In this framework, the physical forward model is utilized to produce a data misﬁt. Both the model misﬁt and data misﬁt are used to train the network. As an example, we use this framework to solve a geosteering problem which enables the drilling direction adjusted by collected resistivity well logging measurements. Numerical tests indicate that the proposed network could improve the quality of the prediction signiﬁcantly. I. INTRODUCTION The act of adjusting the well trajectory on the ﬂy in directional and horizontal drilling is named geosteering. In geosteering using electromagnetic measurements, a set of logging data (also called curves) are collected by the azimuthal resistivity logging-while-drilling (LWD) tool (Fig. 1(a)) to infer the values of unknown earth model parameters [1]. Solving a geosteering inverse problem is not trivial, as in general it is a nonlinear and ill-posed problem [2]. (a) (b) Fig. 1. (a) Schematic of an azimuthal resistivity tool. T1, T2, T3 and T4 are z-direction transmitting antennas, T5 and T6 are x-direction transmitting antennas. R1 and R2 are z-direction receiving antennas, and R3 and R4 are x-direction receiving antennas. (b) A 3-layer geosteering earth model deﬁned by the electrical resistivity of each layer (R1, R2, R3), distance-to-boundary (Dup, Ddn) and relative dip angle of the logging tool (Dip). Experiments and observations suggest physical theories, which in turn are used to predict the outcome of experiments. Solving a forward problem is to calculate the output (y)ofa physical model (f ) given its parameter set x, i.e., y = f (x) and x ∈D. Here F : X → Y is a nonlinear operator between Banach spaces (X, || · ||) and (Y , || · ||) with domain D.For the general case, the inverse relationship can be written as x = f −1(˜y), where f −1 deﬁnes the inverse mapping and ˜y is the observed output. In the ill-posed case where no additional information is available, the solution for x is either highly unstable, highly undetermined or both. One practical method adopted by the production for fast computation is to use the lookup table [3] which is aimed to ﬁnd the best matched samples in a predeﬁned table. Some other algorithms like Levenberg-Marquardt algorithm [4] and Markov Chain Monte Carlo algorithm [5] [6] could reach an accurate solution but are time-consuming. Machine learning approaches have also achieved limited success in the cases of geoacoustic model [7] and geosteering earth model [8]. More recently, as the deep learning technique gains its popularity in function approximation, the Deep Neural Network (DNN) enabled end- to-end mapping has been used to solve inverse problems [9]. However, most deep learning based approaches are data driven and the inverse mapping is learned on a massive dataset for training. Some researches have proved that some simple physical transformation, e.g. afﬁne transform [10], could be used in deep learning. Consequently, in this paper, we suggest that, by incorporating the forward model explicitly in the network, the end-to-end mapping is better regulated with a fast convergence rate in the learning cycle. II. PHYSICS-DRIVEN DEEP NEURAL NETWORK The relationships among the well logging measurements, the sources and the media are essentially governed by the physics. Generally we deﬁne the mean square loss (MSE) between the prediction of the earth model and the ground truth as “model misﬁt”, and the MSE between the synthesis measurements from the predicted model and the observed measurements as “data misﬁt”. In this paper, we propose a novel physics-driven deep neural network (PhDNN) for solving the inverse problem by involving both the model misﬁt and the data misﬁt (Fig. 2). Fig. 2. The diagram of the PhDNN. (a) Ground truth. (b) Inverted earth model by data-driven network. (c) Inverted earth model by PhDNN. Fig. 3. Predicted earth models from different methods. In Fig. 2, y denotes observed measurements. x is the real earth mode. N is the network with trainable param- eters Θ. The predicted earth model can be represented as N (y, Θ). The synthesis measurements could be deﬁned as F(N (y, Θ)), where F is the forward model. Let Lml be the model misﬁt and Ldl be the data misﬁt. The training process of the network could be formulated as: arg min Θ β1Lml(y, Θ)+ β2Ldl(y, F, Θ), (1-1) Lml(y, Θ)= ∥x − N (y, Θ)∥ 2 2, (1-2) Ldl(y, F, Θ)= ∥y −F(N (y, Θ))∥2 2, (1-3) We use β1, β2 to balance the contributions from two different misﬁts. Note that calculate the data misﬁt requires us to estimate the Jacobian matrix of F so that the gradients from (1-3) could be back propagated correctly. 10−3 10−2 10−1 100 101 102 Model misﬁt 10−4 10−3 10−2 10−1 100 101 102Datamisﬁt PhDNN Data driven Lookup table Fig. 4. The numerical testing results of different methods. The results from different samples are marked differently. III. EXPERIMENTS The training for the network is divided into two phases. In the ﬁrst phase, we only use Lml to train the network. Then we apply both Lml and Ldl to train the network. The resistivities of subsurface formation layeres are restricted in the range of [0.1, 1000] [Ω · m], the upper boundary is restricted in [−35, 0] [ft] and the lower boundary is restricted in [0, 35] [ft] (assuming pointing down is the positive vertical direction, and the vertical depth of the tool center is 0 [ft]). During training, β1 = β2 = 1 2 and the network is trained for 80,000 steps. We test the network with more than 100 3-layer models of 80 observed points. All model samples are tested by a traditional lookup table, a data-driven network and our PhDNN. The testing results are drawn in Fig. 4, where Lml is the x-axis and Ldl is the y-axis, and each point represents the average misﬁts of a model sample. With our proposed network, both the model misﬁt and data misﬁt are lower than that of the other methods statistically. Fig. 3 compares inversion results obtained through different approaches. IV. CONCLUSION In this work, we proposed a novel PhDNN to solve the sub- surface inversion problem using resistivity geosteering data. The inversion accuracy is signiﬁcantly improved by introduc- ing a data misﬁt that measures the disagreement between the observed measurement and the synthesized measurements by forward modeling. The test results also demonstrate superior inversion accuracy with much less storage resources required than the widely adopted lookup table method. REFERENCES [1] S. Li, J. Chen, and T. L. Binford, “Using new LWD measurements to evaluate formation resistivity anisotropy at any dip angle.” SPWLA 55th Annual Logging Symposium, 2014. [2] Q. Shen, X. Wu, J. Chen, Z. Han, and Y. Huang, “Solving geosteering inverse problems by stochastic Hybrid Monte Carlo method,” Journal of Petroleum Science and Engineering, vol. 161, no. 2, pp. 9–16, 2018. [3] G. B. Itskovich and M. N. Nikitenko, “Fast inversion of mwd transient em data excited by a pulse of an arbitrary shape,” Feb. 7 2017, uS Patent 9,562,990. [4] K. Levenberg, “A method for the solution of certain non-linear problems in least squares,” Quarterly of applied mathematics, vol. 2, no. 2, pp. 164–168, 1944. [5] C. Dong, C. Dupuis, C. Morriss, E. Legendre, E. Ettore, G. Kutiev, J. Denichou, M. Viandante, J. Seydoux, N. Bennett, Q. Zhu, and X. Zhong, “Application of Automatic Stochastic Inversion for Multilayer Reser- voir Mapping while Drilling Measurements.” Abu Dhabi International Petroleum Exhibition and Conference, Society of Petroleum Engineers, 2015. [6] Q. Shen, X. Wu, J. Chen, and Z. Han, “Distributed markov chain monte carlo method on big-data platform for large-scale geosteering inversion using directional electromagnetic well logging measurements.” Applied Computational Electromagnetics Society Journal, vol. 32, no. 5, 2017. [7] J. Benson, N. R. Chapman, and A. Antoniou, “Geoacoustic model inver- sion with artiﬁcial neural networks,” in IEEE Symposium on Advances in Digital Filtering and Signal Processing. IEEE, 1998, pp. 121–125. [8] Y. Xu, “Borehole resistivity measurements modeling by using machine learning techniques,” in SPWLA 2018 Spring Topical Conference. So- ciety of Petrophysicists and Well-Log Analysts, 2018. [9] K. Fan, Q. Wei, L. Carin, and K. A. Heller, “An inner-loop free solution to inverse problems using deep neural networks,” in Advances in Neural Information Processing Systems, 2017, pp. 2370–2380. [10] M. Jaderberg, K. Simonyan, A. Zisserman et al., “Spatial transformer networks,” in Advances in neural information processing systems, 2015, pp. 2017–2025.","libVersion":"0.3.1","langs":""}