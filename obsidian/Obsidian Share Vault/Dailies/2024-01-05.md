---
modified date: 2024-07-31T18:47:36-07:00
created date: 2024-12-17T08:51:31-08:00
---
# Talk: Conformal inference in 2022: Emmanuel Candes
[Conformal inference in 2022 - YouTube](https://www.youtube.com/watch?v=dmZBxW7oY1o)  This talk is very similar to the author's talk in another conference: [[2024-01-04#Talk A Taste of Conformal Prediction]]

### Introduction
[This](https://youtu.be/dmZBxW7oY1o?t=133) clarified some definitions, which I put in [[2024-01-04#^c78ebb|here]].
### Conformalized Quantile Regression (QCR)

[For this talk, the conformity score](https://youtu.be/dmZBxW7oY1o?t=1011) is something kind like -- but not the same as -- the pinball loss between of predicted upper and lower quantile of an interval at a certain alpha, and the true measurement:

![[2024-01-05-20240105185629987.webp|304]]

Then, the upper and lower intervals are shrunk or expanded so that the *marginal* scores fit within the desired alpha probability.  You can see how calibration points would tend to modify the confidence interval limits in this [figure from the talk](https://youtu.be/dmZBxW7oY1o?t=1101):
![[2024-01-05-20240105192236182.webp|243]]
This theory must be explained in the author's paper: [Conformalized Quantile Regression, 2019](zotero://select/library/items/8YZPSX2G)  It's still a bit disappointing, though.  The quantiles estimated via quantile regression are conditional upon x, but the adjustments done in this kind of QCR are not; they're marginal, not conditional.  Still, their [conditional coverage and "length" (similar to "sharpness"?) is better](https://youtu.be/dmZBxW7oY1o?t=1235) than the simpler method where the conformity score is the deterministic regression absolute-value residual quantile.

There are also many other QCR conformal scores, for example:
- the [MAPIE package conformity scores](https://mapie.readthedocs.io/en/latest/theoretical_description_conformity_scores.html#theoretical-description-for-conformity-scores), some of which are conditional (adapt to) the inputs, X.
	- also [[Taquet22modelAgnostIntervMAPIE|MAPIE]]
- [Conformalized temporal convolutional quantile regression networks for wind power interval forecasting](zotero://select/library/items/UGCZGWWG)
- and [many other papers](https://scholar.google.com/scholar?q=Improved%20conformalized%20quantile%20regression)
### Full Conformal Regression
Just like in the last lecture of his that I watched, I don't get it.  Maybe if I would if replayed [this slide](https://youtu.be/dmZBxW7oY1o?t=1762) enough times.  Or maybe if I read the conformal regression paper, or if I read this author's paper on Jackknife+.
### Conformal Transfer Learning and Adaptation
[Beyond exchangeability: what if ...?](https://youtu.be/dmZBxW7oY1o?t=2252)

Examples are
- Transfer Learning: deploying a model trained in America on French patients
- Adaptation to non-stationarity: stock market response to world events
#### Temporal adaptation
Idea is to [shift quantiles in a learned distribution](https://youtu.be/dmZBxW7oY1o?t=2422).  Looks a lot like online gradient descent.  

In the US election example, in which the conformal quantile probability is 0.9, the error of this simple method is about the same as that of a random Bernoulli variable with probability of 0.9: kind of a theoretical best possible result.

In the US stock market example, adaptation works about as well as another Bernoulli RV.  (Corrected model is some "fancy model trained to predict returns")

The size of the shift coefficient, *lambda*, can be [estimated with set of agents](https://youtu.be/dmZBxW7oY1o?t=2802), with different reactivity.  It's kind of like boosted learners.

# Talk: Discussion of "Conformal inference in 2022" by Emmanuel Candes
[Discussion of "Conformal inference in 2022" by Emmanuel Candes - YouTube](https://youtu.be/dmZBxW7oY1o?t=73)
This was by Aldo Solari and Davide Riso, not Emmanuel Candes.  It's about the statistical roots and limitations of the methods just discussed in Candes's talk in the same conference.  It didn't add much to Candes's talk.

